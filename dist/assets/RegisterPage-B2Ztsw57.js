import{r,j as e,L as P,b as C,c as E,l as A}from"./index-BWRs-o60.js";import{s as L}from"./supabaseClient-DLv9Iivt.js";import{G as R,A as U,b as n,c as q,d as z}from"./AuroraButton-DhSuxBFn.js";import{A as B}from"./AuroraSelect-thE5CfqJ.js";import{m as F}from"./proxy-D_ZAlsMg.js";import"./utils-CKXzwFwe.js";import"./clsx-B-dksMZM.js";import"./createLucideIcon-C8xEK6Q3.js";function K(){const[l,b]=r.useState(""),[i,v]=r.useState(""),[s,y]=r.useState(""),[d,j]=r.useState(""),[c,w]=r.useState("student"),[m,t]=r.useState(""),[f,g]=r.useState(!1),[N,p]=r.useState(!1),S=async a=>{var h,x;if(a.preventDefault(),t(""),p(!1),s!==d){t("Passwords do not match");return}if(s.length<8){t("Password must be at least 8 characters");return}g(!0);try{const{data:o,error:u}=await L.auth.signUp({email:i,password:s,options:{emailRedirectTo:`${C.siteUrl()}/verify-complete`,data:{role:c,name:l}}});if(u){u.message.includes("fetch")?t("Unable to connect to Supabase. Please check your frontend environment variables."):t(u.message||"Registration failed");return}if(o.user){p(!0);try{await E.createLocalUser({email:i,password:s,role:c,name:l})}catch(k){A.warn("Failed to create local user (non-blocking):",k)}}}catch(o){(h=o.message)!=null&&h.includes("fetch")||(x=o.message)!=null&&x.includes("Failed to fetch")?t("Network error: Unable to connect to Supabase. Please check your internet connection and Supabase configuration."):t(o.message||"Registration failed. Please check your Supabase configuration.")}finally{g(!1)}};return e.jsxs("div",{className:"min-h-screen flex",children:[e.jsxs("div",{className:"w-full lg:w-[55%] flex items-center justify-center p-8 relative",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-background via-background to-aurora-cyan/5"}),e.jsxs(R,{className:"w-full max-w-md p-8 relative z-10",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx(U,{size:"md",showText:!0,glowing:!1}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"Create your account"})]}),e.jsxs("form",{onSubmit:S,className:"space-y-4",children:[m&&e.jsx("div",{className:"bg-destructive/20 border border-destructive/40 text-destructive-foreground px-4 py-3 rounded",children:m}),N&&e.jsx("div",{className:"bg-safe/20 border border-safe/40 text-foreground px-4 py-3 rounded",children:"Verification email sent. Please check your inbox."}),e.jsx(n,{label:"Name",type:"text",placeholder:"Enter your name",value:l,onChange:a=>b(a.target.value),required:!0}),e.jsx(n,{label:"Email Address",type:"email",placeholder:"Enter your email",value:i,onChange:a=>v(a.target.value),required:!0}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"role",className:"block text-sm font-medium text-muted-foreground mb-2",children:"Role"}),e.jsx(B,{value:c,onChange:a=>w(a),options:[{value:"student",label:"Student"},{value:"security",label:"Security"}],className:"w-full",buttonClassName:"w-full px-4 py-3 bg-card/50 border border-border rounded-lg backdrop-blur-sm hover:bg-card/60 focus:ring-primary/50"})]}),e.jsx(n,{label:"Password",type:"password",placeholder:"Enter your password",value:s,onChange:a=>y(a.target.value),required:!0,minLength:8}),e.jsx(n,{label:"Confirm Password",type:"password",placeholder:"Confirm your password",value:d,onChange:a=>j(a.target.value),required:!0,minLength:8}),e.jsx(q,{type:"submit",className:"w-full mt-2",size:"lg",loading:f,children:f?"Registering...":"Register"})]}),e.jsx("div",{className:"mt-6 text-center",children:e.jsxs("p",{className:"text-muted-foreground text-sm",children:["Already have an account?"," ",e.jsx(P,{to:"/login",className:"text-aurora-cyan hover:opacity-80 transition-opacity",children:"Log In"})]})})]})]}),e.jsx(F.div,{className:"hidden lg:flex flex-1 relative overflow-hidden items-center justify-center",initial:{opacity:0},animate:{opacity:1},transition:{duration:.8,delay:.2},children:e.jsx(z,{interactive:!1})})]})}export{K as default};
