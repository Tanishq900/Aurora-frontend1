var J7=Object.defineProperty;var Q7=(e,t,r)=>t in e?J7(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var gs=(e,t,r)=>Q7(e,typeof t!="symbol"?t+"":t,r);function eK(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const o in n)if(o!=="default"&&!(o in e)){const l=Object.getOwnPropertyDescriptor(n,o);l&&Object.defineProperty(e,o,l.get?l:{enumerable:!0,get:()=>n[o]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const l of o)if(l.type==="childList")for(const h of l.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&n(h)}).observe(document,{childList:!0,subtree:!0});function r(o){const l={};return o.integrity&&(l.integrity=o.integrity),o.referrerPolicy&&(l.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?l.credentials="include":o.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function n(o){if(o.ep)return;o.ep=!0;const l=r(o);fetch(o.href,l)}})();var zy=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function mn(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var m4={exports:{}},g1={},g4={exports:{}},$r={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var C_=Symbol.for("react.element"),tK=Symbol.for("react.portal"),rK=Symbol.for("react.fragment"),nK=Symbol.for("react.strict_mode"),iK=Symbol.for("react.profiler"),oK=Symbol.for("react.provider"),sK=Symbol.for("react.context"),aK=Symbol.for("react.forward_ref"),lK=Symbol.for("react.suspense"),cK=Symbol.for("react.memo"),uK=Symbol.for("react.lazy"),ZL=Symbol.iterator;function hK(e){return e===null||typeof e!="object"?null:(e=ZL&&e[ZL]||e["@@iterator"],typeof e=="function"?e:null)}var y4={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},v4=Object.assign,_4={};function gm(e,t,r){this.props=e,this.context=t,this.refs=_4,this.updater=r||y4}gm.prototype.isReactComponent={};gm.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};gm.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function x4(){}x4.prototype=gm.prototype;function mO(e,t,r){this.props=e,this.context=t,this.refs=_4,this.updater=r||y4}var gO=mO.prototype=new x4;gO.constructor=mO;v4(gO,gm.prototype);gO.isPureReactComponent=!0;var XL=Array.isArray,b4=Object.prototype.hasOwnProperty,yO={current:null},w4={key:!0,ref:!0,__self:!0,__source:!0};function S4(e,t,r){var n,o={},l=null,h=null;if(t!=null)for(n in t.ref!==void 0&&(h=t.ref),t.key!==void 0&&(l=""+t.key),t)b4.call(t,n)&&!w4.hasOwnProperty(n)&&(o[n]=t[n]);var f=arguments.length-2;if(f===1)o.children=r;else if(1<f){for(var s=Array(f),y=0;y<f;y++)s[y]=arguments[y+2];o.children=s}if(e&&e.defaultProps)for(n in f=e.defaultProps,f)o[n]===void 0&&(o[n]=f[n]);return{$$typeof:C_,type:e,key:l,ref:h,props:o,_owner:yO.current}}function dK(e,t){return{$$typeof:C_,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function vO(e){return typeof e=="object"&&e!==null&&e.$$typeof===C_}function fK(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var YL=/\/+/g;function mE(e,t){return typeof e=="object"&&e!==null&&e.key!=null?fK(""+e.key):t.toString(36)}function ob(e,t,r,n,o){var l=typeof e;(l==="undefined"||l==="boolean")&&(e=null);var h=!1;if(e===null)h=!0;else switch(l){case"string":case"number":h=!0;break;case"object":switch(e.$$typeof){case C_:case tK:h=!0}}if(h)return h=e,o=o(h),e=n===""?"."+mE(h,0):n,XL(o)?(r="",e!=null&&(r=e.replace(YL,"$&/")+"/"),ob(o,t,r,"",function(y){return y})):o!=null&&(vO(o)&&(o=dK(o,r+(!o.key||h&&h.key===o.key?"":(""+o.key).replace(YL,"$&/")+"/")+e)),t.push(o)),1;if(h=0,n=n===""?".":n+":",XL(e))for(var f=0;f<e.length;f++){l=e[f];var s=n+mE(l,f);h+=ob(l,t,r,s,o)}else if(s=hK(e),typeof s=="function")for(e=s.call(e),f=0;!(l=e.next()).done;)l=l.value,s=n+mE(l,f++),h+=ob(l,t,r,s,o);else if(l==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return h}function gx(e,t,r){if(e==null)return e;var n=[],o=0;return ob(e,n,"","",function(l){return t.call(r,l,o++)}),n}function pK(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var zo={current:null},sb={transition:null},mK={ReactCurrentDispatcher:zo,ReactCurrentBatchConfig:sb,ReactCurrentOwner:yO};$r.Children={map:gx,forEach:function(e,t,r){gx(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return gx(e,function(){t++}),t},toArray:function(e){return gx(e,function(t){return t})||[]},only:function(e){if(!vO(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};$r.Component=gm;$r.Fragment=rK;$r.Profiler=iK;$r.PureComponent=mO;$r.StrictMode=nK;$r.Suspense=lK;$r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=mK;$r.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=v4({},e.props),o=e.key,l=e.ref,h=e._owner;if(t!=null){if(t.ref!==void 0&&(l=t.ref,h=yO.current),t.key!==void 0&&(o=""+t.key),e.type&&e.type.defaultProps)var f=e.type.defaultProps;for(s in t)b4.call(t,s)&&!w4.hasOwnProperty(s)&&(n[s]=t[s]===void 0&&f!==void 0?f[s]:t[s])}var s=arguments.length-2;if(s===1)n.children=r;else if(1<s){f=Array(s);for(var y=0;y<s;y++)f[y]=arguments[y+2];n.children=f}return{$$typeof:C_,type:e.type,key:o,ref:l,props:n,_owner:h}};$r.createContext=function(e){return e={$$typeof:sK,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:oK,_context:e},e.Consumer=e};$r.createElement=S4;$r.createFactory=function(e){var t=S4.bind(null,e);return t.type=e,t};$r.createRef=function(){return{current:null}};$r.forwardRef=function(e){return{$$typeof:aK,render:e}};$r.isValidElement=vO;$r.lazy=function(e){return{$$typeof:uK,_payload:{_status:-1,_result:e},_init:pK}};$r.memo=function(e,t){return{$$typeof:cK,type:e,compare:t===void 0?null:t}};$r.startTransition=function(e){var t=sb.transition;sb.transition={};try{e()}finally{sb.transition=t}};$r.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};$r.useCallback=function(e,t){return zo.current.useCallback(e,t)};$r.useContext=function(e){return zo.current.useContext(e)};$r.useDebugValue=function(){};$r.useDeferredValue=function(e){return zo.current.useDeferredValue(e)};$r.useEffect=function(e,t){return zo.current.useEffect(e,t)};$r.useId=function(){return zo.current.useId()};$r.useImperativeHandle=function(e,t,r){return zo.current.useImperativeHandle(e,t,r)};$r.useInsertionEffect=function(e,t){return zo.current.useInsertionEffect(e,t)};$r.useLayoutEffect=function(e,t){return zo.current.useLayoutEffect(e,t)};$r.useMemo=function(e,t){return zo.current.useMemo(e,t)};$r.useReducer=function(e,t,r){return zo.current.useReducer(e,t,r)};$r.useRef=function(e){return zo.current.useRef(e)};$r.useState=function(e){return zo.current.useState(e)};$r.useSyncExternalStore=function(e,t,r){return zo.current.useSyncExternalStore(e,t,r)};$r.useTransition=function(){return zo.current.useTransition()};$r.version="18.2.0";g4.exports=$r;var re=g4.exports;const Ce=mn(re),gK=eK({__proto__:null,default:Ce},[re]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yK=re,vK=Symbol.for("react.element"),_K=Symbol.for("react.fragment"),xK=Object.prototype.hasOwnProperty,bK=yK.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,wK={key:!0,ref:!0,__self:!0,__source:!0};function T4(e,t,r){var n,o={},l=null,h=null;r!==void 0&&(l=""+r),t.key!==void 0&&(l=""+t.key),t.ref!==void 0&&(h=t.ref);for(n in t)xK.call(t,n)&&!wK.hasOwnProperty(n)&&(o[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)o[n]===void 0&&(o[n]=t[n]);return{$$typeof:vK,type:e,key:l,ref:h,props:o,_owner:bK.current}}g1.Fragment=_K;g1.jsx=T4;g1.jsxs=T4;m4.exports=g1;var W=m4.exports,QA={},E4={exports:{}},ks={},A4={exports:{}},P4={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(ze,De){var ut=ze.length;ze.push(De);e:for(;0<ut;){var ht=ut-1>>>1,at=ze[ht];if(0<o(at,De))ze[ht]=De,ze[ut]=at,ut=ht;else break e}}function r(ze){return ze.length===0?null:ze[0]}function n(ze){if(ze.length===0)return null;var De=ze[0],ut=ze.pop();if(ut!==De){ze[0]=ut;e:for(var ht=0,at=ze.length,Lt=at>>>1;ht<Lt;){var $t=2*(ht+1)-1,Tr=ze[$t],Br=$t+1,cn=ze[Br];if(0>o(Tr,ut))Br<at&&0>o(cn,Tr)?(ze[ht]=cn,ze[Br]=ut,ht=Br):(ze[ht]=Tr,ze[$t]=ut,ht=$t);else if(Br<at&&0>o(cn,ut))ze[ht]=cn,ze[Br]=ut,ht=Br;else break e}}return De}function o(ze,De){var ut=ze.sortIndex-De.sortIndex;return ut!==0?ut:ze.id-De.id}if(typeof performance=="object"&&typeof performance.now=="function"){var l=performance;e.unstable_now=function(){return l.now()}}else{var h=Date,f=h.now();e.unstable_now=function(){return h.now()-f}}var s=[],y=[],b=1,w=null,A=3,k=!1,M=!1,R=!1,j=typeof setTimeout=="function"?setTimeout:null,L=typeof clearTimeout=="function"?clearTimeout:null,z=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function B(ze){for(var De=r(y);De!==null;){if(De.callback===null)n(y);else if(De.startTime<=ze)n(y),De.sortIndex=De.expirationTime,t(s,De);else break;De=r(y)}}function Z(ze){if(R=!1,B(ze),!M)if(r(s)!==null)M=!0,Ye(F);else{var De=r(y);De!==null&&tt(Z,De.startTime-ze)}}function F(ze,De){M=!1,R&&(R=!1,L(te),te=-1),k=!0;var ut=A;try{for(B(De),w=r(s);w!==null&&(!(w.expirationTime>De)||ze&&!Ee());){var ht=w.callback;if(typeof ht=="function"){w.callback=null,A=w.priorityLevel;var at=ht(w.expirationTime<=De);De=e.unstable_now(),typeof at=="function"?w.callback=at:w===r(s)&&n(s),B(De)}else n(s);w=r(s)}if(w!==null)var Lt=!0;else{var $t=r(y);$t!==null&&tt(Z,$t.startTime-De),Lt=!1}return Lt}finally{w=null,A=ut,k=!1}}var H=!1,Y=null,te=-1,pe=5,ue=-1;function Ee(){return!(e.unstable_now()-ue<pe)}function Oe(){if(Y!==null){var ze=e.unstable_now();ue=ze;var De=!0;try{De=Y(!0,ze)}finally{De?je():(H=!1,Y=null)}}else H=!1}var je;if(typeof z=="function")je=function(){z(Oe)};else if(typeof MessageChannel<"u"){var Ge=new MessageChannel,Ze=Ge.port2;Ge.port1.onmessage=Oe,je=function(){Ze.postMessage(null)}}else je=function(){j(Oe,0)};function Ye(ze){Y=ze,H||(H=!0,je())}function tt(ze,De){te=j(function(){ze(e.unstable_now())},De)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(ze){ze.callback=null},e.unstable_continueExecution=function(){M||k||(M=!0,Ye(F))},e.unstable_forceFrameRate=function(ze){0>ze||125<ze?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):pe=0<ze?Math.floor(1e3/ze):5},e.unstable_getCurrentPriorityLevel=function(){return A},e.unstable_getFirstCallbackNode=function(){return r(s)},e.unstable_next=function(ze){switch(A){case 1:case 2:case 3:var De=3;break;default:De=A}var ut=A;A=De;try{return ze()}finally{A=ut}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(ze,De){switch(ze){case 1:case 2:case 3:case 4:case 5:break;default:ze=3}var ut=A;A=ze;try{return De()}finally{A=ut}},e.unstable_scheduleCallback=function(ze,De,ut){var ht=e.unstable_now();switch(typeof ut=="object"&&ut!==null?(ut=ut.delay,ut=typeof ut=="number"&&0<ut?ht+ut:ht):ut=ht,ze){case 1:var at=-1;break;case 2:at=250;break;case 5:at=1073741823;break;case 4:at=1e4;break;default:at=5e3}return at=ut+at,ze={id:b++,callback:De,priorityLevel:ze,startTime:ut,expirationTime:at,sortIndex:-1},ut>ht?(ze.sortIndex=ut,t(y,ze),r(s)===null&&ze===r(y)&&(R?(L(te),te=-1):R=!0,tt(Z,ut-ht))):(ze.sortIndex=at,t(s,ze),M||k||(M=!0,Ye(F))),ze},e.unstable_shouldYield=Ee,e.unstable_wrapCallback=function(ze){var De=A;return function(){var ut=A;A=De;try{return ze.apply(this,arguments)}finally{A=ut}}}})(P4);A4.exports=P4;var SK=A4.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var C4=re,Cs=SK;function At(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var k4=new Set,gv={};function Pd(e,t){Dp(e,t),Dp(e+"Capture",t)}function Dp(e,t){for(gv[e]=t,e=0;e<t.length;e++)k4.add(t[e])}var uc=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),eP=Object.prototype.hasOwnProperty,TK=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,JL={},QL={};function EK(e){return eP.call(QL,e)?!0:eP.call(JL,e)?!1:TK.test(e)?QL[e]=!0:(JL[e]=!0,!1)}function AK(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function PK(e,t,r,n){if(t===null||typeof t>"u"||AK(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Bo(e,t,r,n,o,l,h){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=o,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=l,this.removeEmptyString=h}var io={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){io[e]=new Bo(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];io[t]=new Bo(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){io[e]=new Bo(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){io[e]=new Bo(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){io[e]=new Bo(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){io[e]=new Bo(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){io[e]=new Bo(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){io[e]=new Bo(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){io[e]=new Bo(e,5,!1,e.toLowerCase(),null,!1,!1)});var _O=/[\-:]([a-z])/g;function xO(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(_O,xO);io[t]=new Bo(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(_O,xO);io[t]=new Bo(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(_O,xO);io[t]=new Bo(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){io[e]=new Bo(e,1,!1,e.toLowerCase(),null,!1,!1)});io.xlinkHref=new Bo("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){io[e]=new Bo(e,1,!1,e.toLowerCase(),null,!0,!0)});function bO(e,t,r,n){var o=io.hasOwnProperty(t)?io[t]:null;(o!==null?o.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(PK(t,r,o,n)&&(r=null),n||o===null?EK(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):o.mustUseProperty?e[o.propertyName]=r===null?o.type===3?!1:"":r:(t=o.attributeName,n=o.attributeNamespace,r===null?e.removeAttribute(t):(o=o.type,r=o===3||o===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var _c=C4.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,yx=Symbol.for("react.element"),Jf=Symbol.for("react.portal"),Qf=Symbol.for("react.fragment"),wO=Symbol.for("react.strict_mode"),tP=Symbol.for("react.profiler"),O4=Symbol.for("react.provider"),M4=Symbol.for("react.context"),SO=Symbol.for("react.forward_ref"),rP=Symbol.for("react.suspense"),nP=Symbol.for("react.suspense_list"),TO=Symbol.for("react.memo"),au=Symbol.for("react.lazy"),I4=Symbol.for("react.offscreen"),ej=Symbol.iterator;function py(e){return e===null||typeof e!="object"?null:(e=ej&&e[ej]||e["@@iterator"],typeof e=="function"?e:null)}var ti=Object.assign,gE;function By(e){if(gE===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);gE=t&&t[1]||""}return`
`+gE+e}var yE=!1;function vE(e,t){if(!e||yE)return"";yE=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(y){var n=y}Reflect.construct(e,[],t)}else{try{t.call()}catch(y){n=y}e.call(t.prototype)}else{try{throw Error()}catch(y){n=y}e()}}catch(y){if(y&&n&&typeof y.stack=="string"){for(var o=y.stack.split(`
`),l=n.stack.split(`
`),h=o.length-1,f=l.length-1;1<=h&&0<=f&&o[h]!==l[f];)f--;for(;1<=h&&0<=f;h--,f--)if(o[h]!==l[f]){if(h!==1||f!==1)do if(h--,f--,0>f||o[h]!==l[f]){var s=`
`+o[h].replace(" at new "," at ");return e.displayName&&s.includes("<anonymous>")&&(s=s.replace("<anonymous>",e.displayName)),s}while(1<=h&&0<=f);break}}}finally{yE=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?By(e):""}function CK(e){switch(e.tag){case 5:return By(e.type);case 16:return By("Lazy");case 13:return By("Suspense");case 19:return By("SuspenseList");case 0:case 2:case 15:return e=vE(e.type,!1),e;case 11:return e=vE(e.type.render,!1),e;case 1:return e=vE(e.type,!0),e;default:return""}}function iP(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Qf:return"Fragment";case Jf:return"Portal";case tP:return"Profiler";case wO:return"StrictMode";case rP:return"Suspense";case nP:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case M4:return(e.displayName||"Context")+".Consumer";case O4:return(e._context.displayName||"Context")+".Provider";case SO:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case TO:return t=e.displayName||null,t!==null?t:iP(e.type)||"Memo";case au:t=e._payload,e=e._init;try{return iP(e(t))}catch{}}return null}function kK(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return iP(t);case 8:return t===wO?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Ru(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function R4(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function OK(e){var t=R4(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var o=r.get,l=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return o.call(this)},set:function(h){n=""+h,l.call(this,h)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(h){n=""+h},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function vx(e){e._valueTracker||(e._valueTracker=OK(e))}function D4(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=R4(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function kb(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function oP(e,t){var r=t.checked;return ti({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function tj(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=Ru(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function L4(e,t){t=t.checked,t!=null&&bO(e,"checked",t,!1)}function sP(e,t){L4(e,t);var r=Ru(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?aP(e,t.type,r):t.hasOwnProperty("defaultValue")&&aP(e,t.type,Ru(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function rj(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function aP(e,t,r){(t!=="number"||kb(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var Ny=Array.isArray;function _p(e,t,r,n){if(e=e.options,t){t={};for(var o=0;o<r.length;o++)t["$"+r[o]]=!0;for(r=0;r<e.length;r++)o=t.hasOwnProperty("$"+e[r].value),e[r].selected!==o&&(e[r].selected=o),o&&n&&(e[r].defaultSelected=!0)}else{for(r=""+Ru(r),t=null,o=0;o<e.length;o++){if(e[o].value===r){e[o].selected=!0,n&&(e[o].defaultSelected=!0);return}t!==null||e[o].disabled||(t=e[o])}t!==null&&(t.selected=!0)}}function lP(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(At(91));return ti({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function nj(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(At(92));if(Ny(r)){if(1<r.length)throw Error(At(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:Ru(r)}}function j4(e,t){var r=Ru(t.value),n=Ru(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function ij(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function z4(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function cP(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?z4(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var _x,B4=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,o){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,o)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(_x=_x||document.createElement("div"),_x.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=_x.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function yv(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var Hy={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},MK=["Webkit","ms","Moz","O"];Object.keys(Hy).forEach(function(e){MK.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Hy[t]=Hy[e]})});function N4(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||Hy.hasOwnProperty(e)&&Hy[e]?(""+t).trim():t+"px"}function $4(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,o=N4(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,o):e[r]=o}}var IK=ti({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function uP(e,t){if(t){if(IK[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(At(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(At(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(At(61))}if(t.style!=null&&typeof t.style!="object")throw Error(At(62))}}function hP(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var dP=null;function EO(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var fP=null,xp=null,bp=null;function oj(e){if(e=M_(e)){if(typeof fP!="function")throw Error(At(280));var t=e.stateNode;t&&(t=b1(t),fP(e.stateNode,e.type,t))}}function F4(e){xp?bp?bp.push(e):bp=[e]:xp=e}function U4(){if(xp){var e=xp,t=bp;if(bp=xp=null,oj(e),t)for(e=0;e<t.length;e++)oj(t[e])}}function V4(e,t){return e(t)}function G4(){}var _E=!1;function W4(e,t,r){if(_E)return e(t,r);_E=!0;try{return V4(e,t,r)}finally{_E=!1,(xp!==null||bp!==null)&&(G4(),U4())}}function vv(e,t){var r=e.stateNode;if(r===null)return null;var n=b1(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(At(231,t,typeof r));return r}var pP=!1;if(uc)try{var my={};Object.defineProperty(my,"passive",{get:function(){pP=!0}}),window.addEventListener("test",my,my),window.removeEventListener("test",my,my)}catch{pP=!1}function RK(e,t,r,n,o,l,h,f,s){var y=Array.prototype.slice.call(arguments,3);try{t.apply(r,y)}catch(b){this.onError(b)}}var Ky=!1,Ob=null,Mb=!1,mP=null,DK={onError:function(e){Ky=!0,Ob=e}};function LK(e,t,r,n,o,l,h,f,s){Ky=!1,Ob=null,RK.apply(DK,arguments)}function jK(e,t,r,n,o,l,h,f,s){if(LK.apply(this,arguments),Ky){if(Ky){var y=Ob;Ky=!1,Ob=null}else throw Error(At(198));Mb||(Mb=!0,mP=y)}}function Cd(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function q4(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function sj(e){if(Cd(e)!==e)throw Error(At(188))}function zK(e){var t=e.alternate;if(!t){if(t=Cd(e),t===null)throw Error(At(188));return t!==e?null:e}for(var r=e,n=t;;){var o=r.return;if(o===null)break;var l=o.alternate;if(l===null){if(n=o.return,n!==null){r=n;continue}break}if(o.child===l.child){for(l=o.child;l;){if(l===r)return sj(o),e;if(l===n)return sj(o),t;l=l.sibling}throw Error(At(188))}if(r.return!==n.return)r=o,n=l;else{for(var h=!1,f=o.child;f;){if(f===r){h=!0,r=o,n=l;break}if(f===n){h=!0,n=o,r=l;break}f=f.sibling}if(!h){for(f=l.child;f;){if(f===r){h=!0,r=l,n=o;break}if(f===n){h=!0,n=l,r=o;break}f=f.sibling}if(!h)throw Error(At(189))}}if(r.alternate!==n)throw Error(At(190))}if(r.tag!==3)throw Error(At(188));return r.stateNode.current===r?e:t}function H4(e){return e=zK(e),e!==null?K4(e):null}function K4(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=K4(e);if(t!==null)return t;e=e.sibling}return null}var Z4=Cs.unstable_scheduleCallback,aj=Cs.unstable_cancelCallback,BK=Cs.unstable_shouldYield,NK=Cs.unstable_requestPaint,ai=Cs.unstable_now,$K=Cs.unstable_getCurrentPriorityLevel,AO=Cs.unstable_ImmediatePriority,X4=Cs.unstable_UserBlockingPriority,Ib=Cs.unstable_NormalPriority,FK=Cs.unstable_LowPriority,Y4=Cs.unstable_IdlePriority,y1=null,vl=null;function UK(e){if(vl&&typeof vl.onCommitFiberRoot=="function")try{vl.onCommitFiberRoot(y1,e,void 0,(e.current.flags&128)===128)}catch{}}var Fa=Math.clz32?Math.clz32:WK,VK=Math.log,GK=Math.LN2;function WK(e){return e>>>=0,e===0?32:31-(VK(e)/GK|0)|0}var xx=64,bx=4194304;function $y(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Rb(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,o=e.suspendedLanes,l=e.pingedLanes,h=r&268435455;if(h!==0){var f=h&~o;f!==0?n=$y(f):(l&=h,l!==0&&(n=$y(l)))}else h=r&~o,h!==0?n=$y(h):l!==0&&(n=$y(l));if(n===0)return 0;if(t!==0&&t!==n&&!(t&o)&&(o=n&-n,l=t&-t,o>=l||o===16&&(l&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-Fa(t),o=1<<r,n|=e[r],t&=~o;return n}function qK(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function HK(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,o=e.expirationTimes,l=e.pendingLanes;0<l;){var h=31-Fa(l),f=1<<h,s=o[h];s===-1?(!(f&r)||f&n)&&(o[h]=qK(f,t)):s<=t&&(e.expiredLanes|=f),l&=~f}}function gP(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function J4(){var e=xx;return xx<<=1,!(xx&4194240)&&(xx=64),e}function xE(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function k_(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Fa(t),e[t]=r}function KK(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var o=31-Fa(r),l=1<<o;t[o]=0,n[o]=-1,e[o]=-1,r&=~l}}function PO(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-Fa(r),o=1<<n;o&t|e[n]&t&&(e[n]|=t),r&=~o}}var pn=0;function Q4(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var e5,CO,t5,r5,n5,yP=!1,wx=[],wu=null,Su=null,Tu=null,_v=new Map,xv=new Map,hu=[],ZK="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function lj(e,t){switch(e){case"focusin":case"focusout":wu=null;break;case"dragenter":case"dragleave":Su=null;break;case"mouseover":case"mouseout":Tu=null;break;case"pointerover":case"pointerout":_v.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":xv.delete(t.pointerId)}}function gy(e,t,r,n,o,l){return e===null||e.nativeEvent!==l?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:l,targetContainers:[o]},t!==null&&(t=M_(t),t!==null&&CO(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,o!==null&&t.indexOf(o)===-1&&t.push(o),e)}function XK(e,t,r,n,o){switch(t){case"focusin":return wu=gy(wu,e,t,r,n,o),!0;case"dragenter":return Su=gy(Su,e,t,r,n,o),!0;case"mouseover":return Tu=gy(Tu,e,t,r,n,o),!0;case"pointerover":var l=o.pointerId;return _v.set(l,gy(_v.get(l)||null,e,t,r,n,o)),!0;case"gotpointercapture":return l=o.pointerId,xv.set(l,gy(xv.get(l)||null,e,t,r,n,o)),!0}return!1}function i5(e){var t=Zh(e.target);if(t!==null){var r=Cd(t);if(r!==null){if(t=r.tag,t===13){if(t=q4(r),t!==null){e.blockedOn=t,n5(e.priority,function(){t5(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function ab(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=vP(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);dP=n,r.target.dispatchEvent(n),dP=null}else return t=M_(r),t!==null&&CO(t),e.blockedOn=r,!1;t.shift()}return!0}function cj(e,t,r){ab(e)&&r.delete(t)}function YK(){yP=!1,wu!==null&&ab(wu)&&(wu=null),Su!==null&&ab(Su)&&(Su=null),Tu!==null&&ab(Tu)&&(Tu=null),_v.forEach(cj),xv.forEach(cj)}function yy(e,t){e.blockedOn===t&&(e.blockedOn=null,yP||(yP=!0,Cs.unstable_scheduleCallback(Cs.unstable_NormalPriority,YK)))}function bv(e){function t(o){return yy(o,e)}if(0<wx.length){yy(wx[0],e);for(var r=1;r<wx.length;r++){var n=wx[r];n.blockedOn===e&&(n.blockedOn=null)}}for(wu!==null&&yy(wu,e),Su!==null&&yy(Su,e),Tu!==null&&yy(Tu,e),_v.forEach(t),xv.forEach(t),r=0;r<hu.length;r++)n=hu[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<hu.length&&(r=hu[0],r.blockedOn===null);)i5(r),r.blockedOn===null&&hu.shift()}var wp=_c.ReactCurrentBatchConfig,Db=!0;function JK(e,t,r,n){var o=pn,l=wp.transition;wp.transition=null;try{pn=1,kO(e,t,r,n)}finally{pn=o,wp.transition=l}}function QK(e,t,r,n){var o=pn,l=wp.transition;wp.transition=null;try{pn=4,kO(e,t,r,n)}finally{pn=o,wp.transition=l}}function kO(e,t,r,n){if(Db){var o=vP(e,t,r,n);if(o===null)OE(e,t,n,Lb,r),lj(e,n);else if(XK(o,e,t,r,n))n.stopPropagation();else if(lj(e,n),t&4&&-1<ZK.indexOf(e)){for(;o!==null;){var l=M_(o);if(l!==null&&e5(l),l=vP(e,t,r,n),l===null&&OE(e,t,n,Lb,r),l===o)break;o=l}o!==null&&n.stopPropagation()}else OE(e,t,n,null,r)}}var Lb=null;function vP(e,t,r,n){if(Lb=null,e=EO(n),e=Zh(e),e!==null)if(t=Cd(e),t===null)e=null;else if(r=t.tag,r===13){if(e=q4(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Lb=e,null}function o5(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch($K()){case AO:return 1;case X4:return 4;case Ib:case FK:return 16;case Y4:return 536870912;default:return 16}default:return 16}}var mu=null,OO=null,lb=null;function s5(){if(lb)return lb;var e,t=OO,r=t.length,n,o="value"in mu?mu.value:mu.textContent,l=o.length;for(e=0;e<r&&t[e]===o[e];e++);var h=r-e;for(n=1;n<=h&&t[r-n]===o[l-n];n++);return lb=o.slice(e,1<n?1-n:void 0)}function cb(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Sx(){return!0}function uj(){return!1}function Os(e){function t(r,n,o,l,h){this._reactName=r,this._targetInst=o,this.type=n,this.nativeEvent=l,this.target=h,this.currentTarget=null;for(var f in e)e.hasOwnProperty(f)&&(r=e[f],this[f]=r?r(l):l[f]);return this.isDefaultPrevented=(l.defaultPrevented!=null?l.defaultPrevented:l.returnValue===!1)?Sx:uj,this.isPropagationStopped=uj,this}return ti(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Sx)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Sx)},persist:function(){},isPersistent:Sx}),t}var ym={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},MO=Os(ym),O_=ti({},ym,{view:0,detail:0}),eZ=Os(O_),bE,wE,vy,v1=ti({},O_,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:IO,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==vy&&(vy&&e.type==="mousemove"?(bE=e.screenX-vy.screenX,wE=e.screenY-vy.screenY):wE=bE=0,vy=e),bE)},movementY:function(e){return"movementY"in e?e.movementY:wE}}),hj=Os(v1),tZ=ti({},v1,{dataTransfer:0}),rZ=Os(tZ),nZ=ti({},O_,{relatedTarget:0}),SE=Os(nZ),iZ=ti({},ym,{animationName:0,elapsedTime:0,pseudoElement:0}),oZ=Os(iZ),sZ=ti({},ym,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),aZ=Os(sZ),lZ=ti({},ym,{data:0}),dj=Os(lZ),cZ={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},uZ={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},hZ={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function dZ(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=hZ[e])?!!t[e]:!1}function IO(){return dZ}var fZ=ti({},O_,{key:function(e){if(e.key){var t=cZ[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=cb(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?uZ[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:IO,charCode:function(e){return e.type==="keypress"?cb(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?cb(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),pZ=Os(fZ),mZ=ti({},v1,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),fj=Os(mZ),gZ=ti({},O_,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:IO}),yZ=Os(gZ),vZ=ti({},ym,{propertyName:0,elapsedTime:0,pseudoElement:0}),_Z=Os(vZ),xZ=ti({},v1,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),bZ=Os(xZ),wZ=[9,13,27,32],RO=uc&&"CompositionEvent"in window,Zy=null;uc&&"documentMode"in document&&(Zy=document.documentMode);var SZ=uc&&"TextEvent"in window&&!Zy,a5=uc&&(!RO||Zy&&8<Zy&&11>=Zy),pj=" ",mj=!1;function l5(e,t){switch(e){case"keyup":return wZ.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function c5(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var ep=!1;function TZ(e,t){switch(e){case"compositionend":return c5(t);case"keypress":return t.which!==32?null:(mj=!0,pj);case"textInput":return e=t.data,e===pj&&mj?null:e;default:return null}}function EZ(e,t){if(ep)return e==="compositionend"||!RO&&l5(e,t)?(e=s5(),lb=OO=mu=null,ep=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return a5&&t.locale!=="ko"?null:t.data;default:return null}}var AZ={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function gj(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!AZ[e.type]:t==="textarea"}function u5(e,t,r,n){F4(n),t=jb(t,"onChange"),0<t.length&&(r=new MO("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var Xy=null,wv=null;function PZ(e){b5(e,0)}function _1(e){var t=np(e);if(D4(t))return e}function CZ(e,t){if(e==="change")return t}var h5=!1;if(uc){var TE;if(uc){var EE="oninput"in document;if(!EE){var yj=document.createElement("div");yj.setAttribute("oninput","return;"),EE=typeof yj.oninput=="function"}TE=EE}else TE=!1;h5=TE&&(!document.documentMode||9<document.documentMode)}function vj(){Xy&&(Xy.detachEvent("onpropertychange",d5),wv=Xy=null)}function d5(e){if(e.propertyName==="value"&&_1(wv)){var t=[];u5(t,wv,e,EO(e)),W4(PZ,t)}}function kZ(e,t,r){e==="focusin"?(vj(),Xy=t,wv=r,Xy.attachEvent("onpropertychange",d5)):e==="focusout"&&vj()}function OZ(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return _1(wv)}function MZ(e,t){if(e==="click")return _1(t)}function IZ(e,t){if(e==="input"||e==="change")return _1(t)}function RZ(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Va=typeof Object.is=="function"?Object.is:RZ;function Sv(e,t){if(Va(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var o=r[n];if(!eP.call(t,o)||!Va(e[o],t[o]))return!1}return!0}function _j(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function xj(e,t){var r=_j(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=_j(r)}}function f5(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?f5(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function p5(){for(var e=window,t=kb();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=kb(e.document)}return t}function DO(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function DZ(e){var t=p5(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&f5(r.ownerDocument.documentElement,r)){if(n!==null&&DO(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var o=r.textContent.length,l=Math.min(n.start,o);n=n.end===void 0?l:Math.min(n.end,o),!e.extend&&l>n&&(o=n,n=l,l=o),o=xj(r,l);var h=xj(r,n);o&&h&&(e.rangeCount!==1||e.anchorNode!==o.node||e.anchorOffset!==o.offset||e.focusNode!==h.node||e.focusOffset!==h.offset)&&(t=t.createRange(),t.setStart(o.node,o.offset),e.removeAllRanges(),l>n?(e.addRange(t),e.extend(h.node,h.offset)):(t.setEnd(h.node,h.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var LZ=uc&&"documentMode"in document&&11>=document.documentMode,tp=null,_P=null,Yy=null,xP=!1;function bj(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;xP||tp==null||tp!==kb(n)||(n=tp,"selectionStart"in n&&DO(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Yy&&Sv(Yy,n)||(Yy=n,n=jb(_P,"onSelect"),0<n.length&&(t=new MO("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=tp)))}function Tx(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var rp={animationend:Tx("Animation","AnimationEnd"),animationiteration:Tx("Animation","AnimationIteration"),animationstart:Tx("Animation","AnimationStart"),transitionend:Tx("Transition","TransitionEnd")},AE={},m5={};uc&&(m5=document.createElement("div").style,"AnimationEvent"in window||(delete rp.animationend.animation,delete rp.animationiteration.animation,delete rp.animationstart.animation),"TransitionEvent"in window||delete rp.transitionend.transition);function x1(e){if(AE[e])return AE[e];if(!rp[e])return e;var t=rp[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in m5)return AE[e]=t[r];return e}var g5=x1("animationend"),y5=x1("animationiteration"),v5=x1("animationstart"),_5=x1("transitionend"),x5=new Map,wj="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function zu(e,t){x5.set(e,t),Pd(t,[e])}for(var PE=0;PE<wj.length;PE++){var CE=wj[PE],jZ=CE.toLowerCase(),zZ=CE[0].toUpperCase()+CE.slice(1);zu(jZ,"on"+zZ)}zu(g5,"onAnimationEnd");zu(y5,"onAnimationIteration");zu(v5,"onAnimationStart");zu("dblclick","onDoubleClick");zu("focusin","onFocus");zu("focusout","onBlur");zu(_5,"onTransitionEnd");Dp("onMouseEnter",["mouseout","mouseover"]);Dp("onMouseLeave",["mouseout","mouseover"]);Dp("onPointerEnter",["pointerout","pointerover"]);Dp("onPointerLeave",["pointerout","pointerover"]);Pd("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Pd("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Pd("onBeforeInput",["compositionend","keypress","textInput","paste"]);Pd("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Pd("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Pd("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Fy="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),BZ=new Set("cancel close invalid load scroll toggle".split(" ").concat(Fy));function Sj(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,jK(n,t,void 0,e),e.currentTarget=null}function b5(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],o=n.event;n=n.listeners;e:{var l=void 0;if(t)for(var h=n.length-1;0<=h;h--){var f=n[h],s=f.instance,y=f.currentTarget;if(f=f.listener,s!==l&&o.isPropagationStopped())break e;Sj(o,f,y),l=s}else for(h=0;h<n.length;h++){if(f=n[h],s=f.instance,y=f.currentTarget,f=f.listener,s!==l&&o.isPropagationStopped())break e;Sj(o,f,y),l=s}}}if(Mb)throw e=mP,Mb=!1,mP=null,e}function Mn(e,t){var r=t[EP];r===void 0&&(r=t[EP]=new Set);var n=e+"__bubble";r.has(n)||(w5(t,e,2,!1),r.add(n))}function kE(e,t,r){var n=0;t&&(n|=4),w5(r,e,n,t)}var Ex="_reactListening"+Math.random().toString(36).slice(2);function Tv(e){if(!e[Ex]){e[Ex]=!0,k4.forEach(function(r){r!=="selectionchange"&&(BZ.has(r)||kE(r,!1,e),kE(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Ex]||(t[Ex]=!0,kE("selectionchange",!1,t))}}function w5(e,t,r,n){switch(o5(t)){case 1:var o=JK;break;case 4:o=QK;break;default:o=kO}r=o.bind(null,t,r,e),o=void 0,!pP||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(o=!0),n?o!==void 0?e.addEventListener(t,r,{capture:!0,passive:o}):e.addEventListener(t,r,!0):o!==void 0?e.addEventListener(t,r,{passive:o}):e.addEventListener(t,r,!1)}function OE(e,t,r,n,o){var l=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var h=n.tag;if(h===3||h===4){var f=n.stateNode.containerInfo;if(f===o||f.nodeType===8&&f.parentNode===o)break;if(h===4)for(h=n.return;h!==null;){var s=h.tag;if((s===3||s===4)&&(s=h.stateNode.containerInfo,s===o||s.nodeType===8&&s.parentNode===o))return;h=h.return}for(;f!==null;){if(h=Zh(f),h===null)return;if(s=h.tag,s===5||s===6){n=l=h;continue e}f=f.parentNode}}n=n.return}W4(function(){var y=l,b=EO(r),w=[];e:{var A=x5.get(e);if(A!==void 0){var k=MO,M=e;switch(e){case"keypress":if(cb(r)===0)break e;case"keydown":case"keyup":k=pZ;break;case"focusin":M="focus",k=SE;break;case"focusout":M="blur",k=SE;break;case"beforeblur":case"afterblur":k=SE;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":k=hj;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":k=rZ;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":k=yZ;break;case g5:case y5:case v5:k=oZ;break;case _5:k=_Z;break;case"scroll":k=eZ;break;case"wheel":k=bZ;break;case"copy":case"cut":case"paste":k=aZ;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":k=fj}var R=(t&4)!==0,j=!R&&e==="scroll",L=R?A!==null?A+"Capture":null:A;R=[];for(var z=y,B;z!==null;){B=z;var Z=B.stateNode;if(B.tag===5&&Z!==null&&(B=Z,L!==null&&(Z=vv(z,L),Z!=null&&R.push(Ev(z,Z,B)))),j)break;z=z.return}0<R.length&&(A=new k(A,M,null,r,b),w.push({event:A,listeners:R}))}}if(!(t&7)){e:{if(A=e==="mouseover"||e==="pointerover",k=e==="mouseout"||e==="pointerout",A&&r!==dP&&(M=r.relatedTarget||r.fromElement)&&(Zh(M)||M[hc]))break e;if((k||A)&&(A=b.window===b?b:(A=b.ownerDocument)?A.defaultView||A.parentWindow:window,k?(M=r.relatedTarget||r.toElement,k=y,M=M?Zh(M):null,M!==null&&(j=Cd(M),M!==j||M.tag!==5&&M.tag!==6)&&(M=null)):(k=null,M=y),k!==M)){if(R=hj,Z="onMouseLeave",L="onMouseEnter",z="mouse",(e==="pointerout"||e==="pointerover")&&(R=fj,Z="onPointerLeave",L="onPointerEnter",z="pointer"),j=k==null?A:np(k),B=M==null?A:np(M),A=new R(Z,z+"leave",k,r,b),A.target=j,A.relatedTarget=B,Z=null,Zh(b)===y&&(R=new R(L,z+"enter",M,r,b),R.target=B,R.relatedTarget=j,Z=R),j=Z,k&&M)t:{for(R=k,L=M,z=0,B=R;B;B=jf(B))z++;for(B=0,Z=L;Z;Z=jf(Z))B++;for(;0<z-B;)R=jf(R),z--;for(;0<B-z;)L=jf(L),B--;for(;z--;){if(R===L||L!==null&&R===L.alternate)break t;R=jf(R),L=jf(L)}R=null}else R=null;k!==null&&Tj(w,A,k,R,!1),M!==null&&j!==null&&Tj(w,j,M,R,!0)}}e:{if(A=y?np(y):window,k=A.nodeName&&A.nodeName.toLowerCase(),k==="select"||k==="input"&&A.type==="file")var F=CZ;else if(gj(A))if(h5)F=IZ;else{F=OZ;var H=kZ}else(k=A.nodeName)&&k.toLowerCase()==="input"&&(A.type==="checkbox"||A.type==="radio")&&(F=MZ);if(F&&(F=F(e,y))){u5(w,F,r,b);break e}H&&H(e,A,y),e==="focusout"&&(H=A._wrapperState)&&H.controlled&&A.type==="number"&&aP(A,"number",A.value)}switch(H=y?np(y):window,e){case"focusin":(gj(H)||H.contentEditable==="true")&&(tp=H,_P=y,Yy=null);break;case"focusout":Yy=_P=tp=null;break;case"mousedown":xP=!0;break;case"contextmenu":case"mouseup":case"dragend":xP=!1,bj(w,r,b);break;case"selectionchange":if(LZ)break;case"keydown":case"keyup":bj(w,r,b)}var Y;if(RO)e:{switch(e){case"compositionstart":var te="onCompositionStart";break e;case"compositionend":te="onCompositionEnd";break e;case"compositionupdate":te="onCompositionUpdate";break e}te=void 0}else ep?l5(e,r)&&(te="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(te="onCompositionStart");te&&(a5&&r.locale!=="ko"&&(ep||te!=="onCompositionStart"?te==="onCompositionEnd"&&ep&&(Y=s5()):(mu=b,OO="value"in mu?mu.value:mu.textContent,ep=!0)),H=jb(y,te),0<H.length&&(te=new dj(te,e,null,r,b),w.push({event:te,listeners:H}),Y?te.data=Y:(Y=c5(r),Y!==null&&(te.data=Y)))),(Y=SZ?TZ(e,r):EZ(e,r))&&(y=jb(y,"onBeforeInput"),0<y.length&&(b=new dj("onBeforeInput","beforeinput",null,r,b),w.push({event:b,listeners:y}),b.data=Y))}b5(w,t)})}function Ev(e,t,r){return{instance:e,listener:t,currentTarget:r}}function jb(e,t){for(var r=t+"Capture",n=[];e!==null;){var o=e,l=o.stateNode;o.tag===5&&l!==null&&(o=l,l=vv(e,r),l!=null&&n.unshift(Ev(e,l,o)),l=vv(e,t),l!=null&&n.push(Ev(e,l,o))),e=e.return}return n}function jf(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Tj(e,t,r,n,o){for(var l=t._reactName,h=[];r!==null&&r!==n;){var f=r,s=f.alternate,y=f.stateNode;if(s!==null&&s===n)break;f.tag===5&&y!==null&&(f=y,o?(s=vv(r,l),s!=null&&h.unshift(Ev(r,s,f))):o||(s=vv(r,l),s!=null&&h.push(Ev(r,s,f)))),r=r.return}h.length!==0&&e.push({event:t,listeners:h})}var NZ=/\r\n?/g,$Z=/\u0000|\uFFFD/g;function Ej(e){return(typeof e=="string"?e:""+e).replace(NZ,`
`).replace($Z,"")}function Ax(e,t,r){if(t=Ej(t),Ej(e)!==t&&r)throw Error(At(425))}function zb(){}var bP=null,wP=null;function SP(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var TP=typeof setTimeout=="function"?setTimeout:void 0,FZ=typeof clearTimeout=="function"?clearTimeout:void 0,Aj=typeof Promise=="function"?Promise:void 0,UZ=typeof queueMicrotask=="function"?queueMicrotask:typeof Aj<"u"?function(e){return Aj.resolve(null).then(e).catch(VZ)}:TP;function VZ(e){setTimeout(function(){throw e})}function ME(e,t){var r=t,n=0;do{var o=r.nextSibling;if(e.removeChild(r),o&&o.nodeType===8)if(r=o.data,r==="/$"){if(n===0){e.removeChild(o),bv(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=o}while(r);bv(t)}function Eu(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function Pj(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var vm=Math.random().toString(36).slice(2),pl="__reactFiber$"+vm,Av="__reactProps$"+vm,hc="__reactContainer$"+vm,EP="__reactEvents$"+vm,GZ="__reactListeners$"+vm,WZ="__reactHandles$"+vm;function Zh(e){var t=e[pl];if(t)return t;for(var r=e.parentNode;r;){if(t=r[hc]||r[pl]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=Pj(e);e!==null;){if(r=e[pl])return r;e=Pj(e)}return t}e=r,r=e.parentNode}return null}function M_(e){return e=e[pl]||e[hc],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function np(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(At(33))}function b1(e){return e[Av]||null}var AP=[],ip=-1;function Bu(e){return{current:e}}function Dn(e){0>ip||(e.current=AP[ip],AP[ip]=null,ip--)}function En(e,t){ip++,AP[ip]=e.current,e.current=t}var Du={},Eo=Bu(Du),es=Bu(!1),md=Du;function Lp(e,t){var r=e.type.contextTypes;if(!r)return Du;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var o={},l;for(l in r)o[l]=t[l];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=o),o}function ts(e){return e=e.childContextTypes,e!=null}function Bb(){Dn(es),Dn(Eo)}function Cj(e,t,r){if(Eo.current!==Du)throw Error(At(168));En(Eo,t),En(es,r)}function S5(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var o in n)if(!(o in t))throw Error(At(108,kK(e)||"Unknown",o));return ti({},r,n)}function Nb(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Du,md=Eo.current,En(Eo,e),En(es,es.current),!0}function kj(e,t,r){var n=e.stateNode;if(!n)throw Error(At(169));r?(e=S5(e,t,md),n.__reactInternalMemoizedMergedChildContext=e,Dn(es),Dn(Eo),En(Eo,e)):Dn(es),En(es,r)}var Jl=null,w1=!1,IE=!1;function T5(e){Jl===null?Jl=[e]:Jl.push(e)}function qZ(e){w1=!0,T5(e)}function Nu(){if(!IE&&Jl!==null){IE=!0;var e=0,t=pn;try{var r=Jl;for(pn=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}Jl=null,w1=!1}catch(o){throw Jl!==null&&(Jl=Jl.slice(e+1)),Z4(AO,Nu),o}finally{pn=t,IE=!1}}return null}var op=[],sp=0,$b=null,Fb=0,qs=[],Hs=0,gd=null,Ql=1,ec="";function Nh(e,t){op[sp++]=Fb,op[sp++]=$b,$b=e,Fb=t}function E5(e,t,r){qs[Hs++]=Ql,qs[Hs++]=ec,qs[Hs++]=gd,gd=e;var n=Ql;e=ec;var o=32-Fa(n)-1;n&=~(1<<o),r+=1;var l=32-Fa(t)+o;if(30<l){var h=o-o%5;l=(n&(1<<h)-1).toString(32),n>>=h,o-=h,Ql=1<<32-Fa(t)+o|r<<o|n,ec=l+e}else Ql=1<<l|r<<o|n,ec=e}function LO(e){e.return!==null&&(Nh(e,1),E5(e,1,0))}function jO(e){for(;e===$b;)$b=op[--sp],op[sp]=null,Fb=op[--sp],op[sp]=null;for(;e===gd;)gd=qs[--Hs],qs[Hs]=null,ec=qs[--Hs],qs[Hs]=null,Ql=qs[--Hs],qs[Hs]=null}var Ps=null,As=null,Un=!1,Ba=null;function A5(e,t){var r=Zs(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function Oj(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Ps=e,As=Eu(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Ps=e,As=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=gd!==null?{id:Ql,overflow:ec}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=Zs(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,Ps=e,As=null,!0):!1;default:return!1}}function PP(e){return(e.mode&1)!==0&&(e.flags&128)===0}function CP(e){if(Un){var t=As;if(t){var r=t;if(!Oj(e,t)){if(PP(e))throw Error(At(418));t=Eu(r.nextSibling);var n=Ps;t&&Oj(e,t)?A5(n,r):(e.flags=e.flags&-4097|2,Un=!1,Ps=e)}}else{if(PP(e))throw Error(At(418));e.flags=e.flags&-4097|2,Un=!1,Ps=e}}}function Mj(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Ps=e}function Px(e){if(e!==Ps)return!1;if(!Un)return Mj(e),Un=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!SP(e.type,e.memoizedProps)),t&&(t=As)){if(PP(e))throw P5(),Error(At(418));for(;t;)A5(e,t),t=Eu(t.nextSibling)}if(Mj(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(At(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){As=Eu(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}As=null}}else As=Ps?Eu(e.stateNode.nextSibling):null;return!0}function P5(){for(var e=As;e;)e=Eu(e.nextSibling)}function jp(){As=Ps=null,Un=!1}function zO(e){Ba===null?Ba=[e]:Ba.push(e)}var HZ=_c.ReactCurrentBatchConfig;function Ma(e,t){if(e&&e.defaultProps){t=ti({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}var Ub=Bu(null),Vb=null,ap=null,BO=null;function NO(){BO=ap=Vb=null}function $O(e){var t=Ub.current;Dn(Ub),e._currentValue=t}function kP(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function Sp(e,t){Vb=e,BO=ap=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Jo=!0),e.firstContext=null)}function ra(e){var t=e._currentValue;if(BO!==e)if(e={context:e,memoizedValue:t,next:null},ap===null){if(Vb===null)throw Error(At(308));ap=e,Vb.dependencies={lanes:0,firstContext:e}}else ap=ap.next=e;return t}var Xh=null;function FO(e){Xh===null?Xh=[e]:Xh.push(e)}function C5(e,t,r,n){var o=t.interleaved;return o===null?(r.next=r,FO(t)):(r.next=o.next,o.next=r),t.interleaved=r,dc(e,n)}function dc(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var lu=!1;function UO(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function k5(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function ic(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Au(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,Ur&2){var o=n.pending;return o===null?t.next=t:(t.next=o.next,o.next=t),n.pending=t,dc(e,r)}return o=n.interleaved,o===null?(t.next=t,FO(n)):(t.next=o.next,o.next=t),n.interleaved=t,dc(e,r)}function ub(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,PO(e,r)}}function Ij(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var o=null,l=null;if(r=r.firstBaseUpdate,r!==null){do{var h={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};l===null?o=l=h:l=l.next=h,r=r.next}while(r!==null);l===null?o=l=t:l=l.next=t}else o=l=t;r={baseState:n.baseState,firstBaseUpdate:o,lastBaseUpdate:l,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function Gb(e,t,r,n){var o=e.updateQueue;lu=!1;var l=o.firstBaseUpdate,h=o.lastBaseUpdate,f=o.shared.pending;if(f!==null){o.shared.pending=null;var s=f,y=s.next;s.next=null,h===null?l=y:h.next=y,h=s;var b=e.alternate;b!==null&&(b=b.updateQueue,f=b.lastBaseUpdate,f!==h&&(f===null?b.firstBaseUpdate=y:f.next=y,b.lastBaseUpdate=s))}if(l!==null){var w=o.baseState;h=0,b=y=s=null,f=l;do{var A=f.lane,k=f.eventTime;if((n&A)===A){b!==null&&(b=b.next={eventTime:k,lane:0,tag:f.tag,payload:f.payload,callback:f.callback,next:null});e:{var M=e,R=f;switch(A=t,k=r,R.tag){case 1:if(M=R.payload,typeof M=="function"){w=M.call(k,w,A);break e}w=M;break e;case 3:M.flags=M.flags&-65537|128;case 0:if(M=R.payload,A=typeof M=="function"?M.call(k,w,A):M,A==null)break e;w=ti({},w,A);break e;case 2:lu=!0}}f.callback!==null&&f.lane!==0&&(e.flags|=64,A=o.effects,A===null?o.effects=[f]:A.push(f))}else k={eventTime:k,lane:A,tag:f.tag,payload:f.payload,callback:f.callback,next:null},b===null?(y=b=k,s=w):b=b.next=k,h|=A;if(f=f.next,f===null){if(f=o.shared.pending,f===null)break;A=f,f=A.next,A.next=null,o.lastBaseUpdate=A,o.shared.pending=null}}while(!0);if(b===null&&(s=w),o.baseState=s,o.firstBaseUpdate=y,o.lastBaseUpdate=b,t=o.shared.interleaved,t!==null){o=t;do h|=o.lane,o=o.next;while(o!==t)}else l===null&&(o.shared.lanes=0);vd|=h,e.lanes=h,e.memoizedState=w}}function Rj(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],o=n.callback;if(o!==null){if(n.callback=null,n=r,typeof o!="function")throw Error(At(191,o));o.call(n)}}}var O5=new C4.Component().refs;function OP(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:ti({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var S1={isMounted:function(e){return(e=e._reactInternals)?Cd(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=jo(),o=Cu(e),l=ic(n,o);l.payload=t,r!=null&&(l.callback=r),t=Au(e,l,o),t!==null&&(Ua(t,e,o,n),ub(t,e,o))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=jo(),o=Cu(e),l=ic(n,o);l.tag=1,l.payload=t,r!=null&&(l.callback=r),t=Au(e,l,o),t!==null&&(Ua(t,e,o,n),ub(t,e,o))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=jo(),n=Cu(e),o=ic(r,n);o.tag=2,t!=null&&(o.callback=t),t=Au(e,o,n),t!==null&&(Ua(t,e,n,r),ub(t,e,n))}};function Dj(e,t,r,n,o,l,h){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,l,h):t.prototype&&t.prototype.isPureReactComponent?!Sv(r,n)||!Sv(o,l):!0}function M5(e,t,r){var n=!1,o=Du,l=t.contextType;return typeof l=="object"&&l!==null?l=ra(l):(o=ts(t)?md:Eo.current,n=t.contextTypes,l=(n=n!=null)?Lp(e,o):Du),t=new t(r,l),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=S1,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=o,e.__reactInternalMemoizedMaskedChildContext=l),t}function Lj(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&S1.enqueueReplaceState(t,t.state,null)}function MP(e,t,r,n){var o=e.stateNode;o.props=r,o.state=e.memoizedState,o.refs=O5,UO(e);var l=t.contextType;typeof l=="object"&&l!==null?o.context=ra(l):(l=ts(t)?md:Eo.current,o.context=Lp(e,l)),o.state=e.memoizedState,l=t.getDerivedStateFromProps,typeof l=="function"&&(OP(e,t,l,r),o.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof o.getSnapshotBeforeUpdate=="function"||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(t=o.state,typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount(),t!==o.state&&S1.enqueueReplaceState(o,o.state,null),Gb(e,r,o,n),o.state=e.memoizedState),typeof o.componentDidMount=="function"&&(e.flags|=4194308)}function _y(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(At(309));var n=r.stateNode}if(!n)throw Error(At(147,e));var o=n,l=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===l?t.ref:(t=function(h){var f=o.refs;f===O5&&(f=o.refs={}),h===null?delete f[l]:f[l]=h},t._stringRef=l,t)}if(typeof e!="string")throw Error(At(284));if(!r._owner)throw Error(At(290,e))}return e}function Cx(e,t){throw e=Object.prototype.toString.call(t),Error(At(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function jj(e){var t=e._init;return t(e._payload)}function I5(e){function t(L,z){if(e){var B=L.deletions;B===null?(L.deletions=[z],L.flags|=16):B.push(z)}}function r(L,z){if(!e)return null;for(;z!==null;)t(L,z),z=z.sibling;return null}function n(L,z){for(L=new Map;z!==null;)z.key!==null?L.set(z.key,z):L.set(z.index,z),z=z.sibling;return L}function o(L,z){return L=ku(L,z),L.index=0,L.sibling=null,L}function l(L,z,B){return L.index=B,e?(B=L.alternate,B!==null?(B=B.index,B<z?(L.flags|=2,z):B):(L.flags|=2,z)):(L.flags|=1048576,z)}function h(L){return e&&L.alternate===null&&(L.flags|=2),L}function f(L,z,B,Z){return z===null||z.tag!==6?(z=NE(B,L.mode,Z),z.return=L,z):(z=o(z,B),z.return=L,z)}function s(L,z,B,Z){var F=B.type;return F===Qf?b(L,z,B.props.children,Z,B.key):z!==null&&(z.elementType===F||typeof F=="object"&&F!==null&&F.$$typeof===au&&jj(F)===z.type)?(Z=o(z,B.props),Z.ref=_y(L,z,B),Z.return=L,Z):(Z=gb(B.type,B.key,B.props,null,L.mode,Z),Z.ref=_y(L,z,B),Z.return=L,Z)}function y(L,z,B,Z){return z===null||z.tag!==4||z.stateNode.containerInfo!==B.containerInfo||z.stateNode.implementation!==B.implementation?(z=$E(B,L.mode,Z),z.return=L,z):(z=o(z,B.children||[]),z.return=L,z)}function b(L,z,B,Z,F){return z===null||z.tag!==7?(z=ld(B,L.mode,Z,F),z.return=L,z):(z=o(z,B),z.return=L,z)}function w(L,z,B){if(typeof z=="string"&&z!==""||typeof z=="number")return z=NE(""+z,L.mode,B),z.return=L,z;if(typeof z=="object"&&z!==null){switch(z.$$typeof){case yx:return B=gb(z.type,z.key,z.props,null,L.mode,B),B.ref=_y(L,null,z),B.return=L,B;case Jf:return z=$E(z,L.mode,B),z.return=L,z;case au:var Z=z._init;return w(L,Z(z._payload),B)}if(Ny(z)||py(z))return z=ld(z,L.mode,B,null),z.return=L,z;Cx(L,z)}return null}function A(L,z,B,Z){var F=z!==null?z.key:null;if(typeof B=="string"&&B!==""||typeof B=="number")return F!==null?null:f(L,z,""+B,Z);if(typeof B=="object"&&B!==null){switch(B.$$typeof){case yx:return B.key===F?s(L,z,B,Z):null;case Jf:return B.key===F?y(L,z,B,Z):null;case au:return F=B._init,A(L,z,F(B._payload),Z)}if(Ny(B)||py(B))return F!==null?null:b(L,z,B,Z,null);Cx(L,B)}return null}function k(L,z,B,Z,F){if(typeof Z=="string"&&Z!==""||typeof Z=="number")return L=L.get(B)||null,f(z,L,""+Z,F);if(typeof Z=="object"&&Z!==null){switch(Z.$$typeof){case yx:return L=L.get(Z.key===null?B:Z.key)||null,s(z,L,Z,F);case Jf:return L=L.get(Z.key===null?B:Z.key)||null,y(z,L,Z,F);case au:var H=Z._init;return k(L,z,B,H(Z._payload),F)}if(Ny(Z)||py(Z))return L=L.get(B)||null,b(z,L,Z,F,null);Cx(z,Z)}return null}function M(L,z,B,Z){for(var F=null,H=null,Y=z,te=z=0,pe=null;Y!==null&&te<B.length;te++){Y.index>te?(pe=Y,Y=null):pe=Y.sibling;var ue=A(L,Y,B[te],Z);if(ue===null){Y===null&&(Y=pe);break}e&&Y&&ue.alternate===null&&t(L,Y),z=l(ue,z,te),H===null?F=ue:H.sibling=ue,H=ue,Y=pe}if(te===B.length)return r(L,Y),Un&&Nh(L,te),F;if(Y===null){for(;te<B.length;te++)Y=w(L,B[te],Z),Y!==null&&(z=l(Y,z,te),H===null?F=Y:H.sibling=Y,H=Y);return Un&&Nh(L,te),F}for(Y=n(L,Y);te<B.length;te++)pe=k(Y,L,te,B[te],Z),pe!==null&&(e&&pe.alternate!==null&&Y.delete(pe.key===null?te:pe.key),z=l(pe,z,te),H===null?F=pe:H.sibling=pe,H=pe);return e&&Y.forEach(function(Ee){return t(L,Ee)}),Un&&Nh(L,te),F}function R(L,z,B,Z){var F=py(B);if(typeof F!="function")throw Error(At(150));if(B=F.call(B),B==null)throw Error(At(151));for(var H=F=null,Y=z,te=z=0,pe=null,ue=B.next();Y!==null&&!ue.done;te++,ue=B.next()){Y.index>te?(pe=Y,Y=null):pe=Y.sibling;var Ee=A(L,Y,ue.value,Z);if(Ee===null){Y===null&&(Y=pe);break}e&&Y&&Ee.alternate===null&&t(L,Y),z=l(Ee,z,te),H===null?F=Ee:H.sibling=Ee,H=Ee,Y=pe}if(ue.done)return r(L,Y),Un&&Nh(L,te),F;if(Y===null){for(;!ue.done;te++,ue=B.next())ue=w(L,ue.value,Z),ue!==null&&(z=l(ue,z,te),H===null?F=ue:H.sibling=ue,H=ue);return Un&&Nh(L,te),F}for(Y=n(L,Y);!ue.done;te++,ue=B.next())ue=k(Y,L,te,ue.value,Z),ue!==null&&(e&&ue.alternate!==null&&Y.delete(ue.key===null?te:ue.key),z=l(ue,z,te),H===null?F=ue:H.sibling=ue,H=ue);return e&&Y.forEach(function(Oe){return t(L,Oe)}),Un&&Nh(L,te),F}function j(L,z,B,Z){if(typeof B=="object"&&B!==null&&B.type===Qf&&B.key===null&&(B=B.props.children),typeof B=="object"&&B!==null){switch(B.$$typeof){case yx:e:{for(var F=B.key,H=z;H!==null;){if(H.key===F){if(F=B.type,F===Qf){if(H.tag===7){r(L,H.sibling),z=o(H,B.props.children),z.return=L,L=z;break e}}else if(H.elementType===F||typeof F=="object"&&F!==null&&F.$$typeof===au&&jj(F)===H.type){r(L,H.sibling),z=o(H,B.props),z.ref=_y(L,H,B),z.return=L,L=z;break e}r(L,H);break}else t(L,H);H=H.sibling}B.type===Qf?(z=ld(B.props.children,L.mode,Z,B.key),z.return=L,L=z):(Z=gb(B.type,B.key,B.props,null,L.mode,Z),Z.ref=_y(L,z,B),Z.return=L,L=Z)}return h(L);case Jf:e:{for(H=B.key;z!==null;){if(z.key===H)if(z.tag===4&&z.stateNode.containerInfo===B.containerInfo&&z.stateNode.implementation===B.implementation){r(L,z.sibling),z=o(z,B.children||[]),z.return=L,L=z;break e}else{r(L,z);break}else t(L,z);z=z.sibling}z=$E(B,L.mode,Z),z.return=L,L=z}return h(L);case au:return H=B._init,j(L,z,H(B._payload),Z)}if(Ny(B))return M(L,z,B,Z);if(py(B))return R(L,z,B,Z);Cx(L,B)}return typeof B=="string"&&B!==""||typeof B=="number"?(B=""+B,z!==null&&z.tag===6?(r(L,z.sibling),z=o(z,B),z.return=L,L=z):(r(L,z),z=NE(B,L.mode,Z),z.return=L,L=z),h(L)):r(L,z)}return j}var zp=I5(!0),R5=I5(!1),I_={},_l=Bu(I_),Pv=Bu(I_),Cv=Bu(I_);function Yh(e){if(e===I_)throw Error(At(174));return e}function VO(e,t){switch(En(Cv,t),En(Pv,e),En(_l,I_),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:cP(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=cP(t,e)}Dn(_l),En(_l,t)}function Bp(){Dn(_l),Dn(Pv),Dn(Cv)}function D5(e){Yh(Cv.current);var t=Yh(_l.current),r=cP(t,e.type);t!==r&&(En(Pv,e),En(_l,r))}function GO(e){Pv.current===e&&(Dn(_l),Dn(Pv))}var Jn=Bu(0);function Wb(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var RE=[];function WO(){for(var e=0;e<RE.length;e++)RE[e]._workInProgressVersionPrimary=null;RE.length=0}var hb=_c.ReactCurrentDispatcher,DE=_c.ReactCurrentBatchConfig,yd=0,ei=null,Ii=null,qi=null,qb=!1,Jy=!1,kv=0,KZ=0;function yo(){throw Error(At(321))}function qO(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!Va(e[r],t[r]))return!1;return!0}function HO(e,t,r,n,o,l){if(yd=l,ei=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,hb.current=e===null||e.memoizedState===null?JZ:QZ,e=r(n,o),Jy){l=0;do{if(Jy=!1,kv=0,25<=l)throw Error(At(301));l+=1,qi=Ii=null,t.updateQueue=null,hb.current=eX,e=r(n,o)}while(Jy)}if(hb.current=Hb,t=Ii!==null&&Ii.next!==null,yd=0,qi=Ii=ei=null,qb=!1,t)throw Error(At(300));return e}function KO(){var e=kv!==0;return kv=0,e}function fl(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return qi===null?ei.memoizedState=qi=e:qi=qi.next=e,qi}function na(){if(Ii===null){var e=ei.alternate;e=e!==null?e.memoizedState:null}else e=Ii.next;var t=qi===null?ei.memoizedState:qi.next;if(t!==null)qi=t,Ii=e;else{if(e===null)throw Error(At(310));Ii=e,e={memoizedState:Ii.memoizedState,baseState:Ii.baseState,baseQueue:Ii.baseQueue,queue:Ii.queue,next:null},qi===null?ei.memoizedState=qi=e:qi=qi.next=e}return qi}function Ov(e,t){return typeof t=="function"?t(e):t}function LE(e){var t=na(),r=t.queue;if(r===null)throw Error(At(311));r.lastRenderedReducer=e;var n=Ii,o=n.baseQueue,l=r.pending;if(l!==null){if(o!==null){var h=o.next;o.next=l.next,l.next=h}n.baseQueue=o=l,r.pending=null}if(o!==null){l=o.next,n=n.baseState;var f=h=null,s=null,y=l;do{var b=y.lane;if((yd&b)===b)s!==null&&(s=s.next={lane:0,action:y.action,hasEagerState:y.hasEagerState,eagerState:y.eagerState,next:null}),n=y.hasEagerState?y.eagerState:e(n,y.action);else{var w={lane:b,action:y.action,hasEagerState:y.hasEagerState,eagerState:y.eagerState,next:null};s===null?(f=s=w,h=n):s=s.next=w,ei.lanes|=b,vd|=b}y=y.next}while(y!==null&&y!==l);s===null?h=n:s.next=f,Va(n,t.memoizedState)||(Jo=!0),t.memoizedState=n,t.baseState=h,t.baseQueue=s,r.lastRenderedState=n}if(e=r.interleaved,e!==null){o=e;do l=o.lane,ei.lanes|=l,vd|=l,o=o.next;while(o!==e)}else o===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function jE(e){var t=na(),r=t.queue;if(r===null)throw Error(At(311));r.lastRenderedReducer=e;var n=r.dispatch,o=r.pending,l=t.memoizedState;if(o!==null){r.pending=null;var h=o=o.next;do l=e(l,h.action),h=h.next;while(h!==o);Va(l,t.memoizedState)||(Jo=!0),t.memoizedState=l,t.baseQueue===null&&(t.baseState=l),r.lastRenderedState=l}return[l,n]}function L5(){}function j5(e,t){var r=ei,n=na(),o=t(),l=!Va(n.memoizedState,o);if(l&&(n.memoizedState=o,Jo=!0),n=n.queue,ZO(N5.bind(null,r,n,e),[e]),n.getSnapshot!==t||l||qi!==null&&qi.memoizedState.tag&1){if(r.flags|=2048,Mv(9,B5.bind(null,r,n,o,t),void 0,null),Hi===null)throw Error(At(349));yd&30||z5(r,t,o)}return o}function z5(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=ei.updateQueue,t===null?(t={lastEffect:null,stores:null},ei.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function B5(e,t,r,n){t.value=r,t.getSnapshot=n,$5(t)&&F5(e)}function N5(e,t,r){return r(function(){$5(t)&&F5(e)})}function $5(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Va(e,r)}catch{return!0}}function F5(e){var t=dc(e,1);t!==null&&Ua(t,e,1,-1)}function zj(e){var t=fl();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ov,lastRenderedState:e},t.queue=e,e=e.dispatch=YZ.bind(null,ei,e),[t.memoizedState,e]}function Mv(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=ei.updateQueue,t===null?(t={lastEffect:null,stores:null},ei.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function U5(){return na().memoizedState}function db(e,t,r,n){var o=fl();ei.flags|=e,o.memoizedState=Mv(1|t,r,void 0,n===void 0?null:n)}function T1(e,t,r,n){var o=na();n=n===void 0?null:n;var l=void 0;if(Ii!==null){var h=Ii.memoizedState;if(l=h.destroy,n!==null&&qO(n,h.deps)){o.memoizedState=Mv(t,r,l,n);return}}ei.flags|=e,o.memoizedState=Mv(1|t,r,l,n)}function Bj(e,t){return db(8390656,8,e,t)}function ZO(e,t){return T1(2048,8,e,t)}function V5(e,t){return T1(4,2,e,t)}function G5(e,t){return T1(4,4,e,t)}function W5(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function q5(e,t,r){return r=r!=null?r.concat([e]):null,T1(4,4,W5.bind(null,t,e),r)}function XO(){}function H5(e,t){var r=na();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&qO(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function K5(e,t){var r=na();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&qO(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function Z5(e,t,r){return yd&21?(Va(r,t)||(r=J4(),ei.lanes|=r,vd|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Jo=!0),e.memoizedState=r)}function ZZ(e,t){var r=pn;pn=r!==0&&4>r?r:4,e(!0);var n=DE.transition;DE.transition={};try{e(!1),t()}finally{pn=r,DE.transition=n}}function X5(){return na().memoizedState}function XZ(e,t,r){var n=Cu(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},Y5(e))J5(t,r);else if(r=C5(e,t,r,n),r!==null){var o=jo();Ua(r,e,n,o),Q5(r,t,n)}}function YZ(e,t,r){var n=Cu(e),o={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(Y5(e))J5(t,o);else{var l=e.alternate;if(e.lanes===0&&(l===null||l.lanes===0)&&(l=t.lastRenderedReducer,l!==null))try{var h=t.lastRenderedState,f=l(h,r);if(o.hasEagerState=!0,o.eagerState=f,Va(f,h)){var s=t.interleaved;s===null?(o.next=o,FO(t)):(o.next=s.next,s.next=o),t.interleaved=o;return}}catch{}finally{}r=C5(e,t,o,n),r!==null&&(o=jo(),Ua(r,e,n,o),Q5(r,t,n))}}function Y5(e){var t=e.alternate;return e===ei||t!==null&&t===ei}function J5(e,t){Jy=qb=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function Q5(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,PO(e,r)}}var Hb={readContext:ra,useCallback:yo,useContext:yo,useEffect:yo,useImperativeHandle:yo,useInsertionEffect:yo,useLayoutEffect:yo,useMemo:yo,useReducer:yo,useRef:yo,useState:yo,useDebugValue:yo,useDeferredValue:yo,useTransition:yo,useMutableSource:yo,useSyncExternalStore:yo,useId:yo,unstable_isNewReconciler:!1},JZ={readContext:ra,useCallback:function(e,t){return fl().memoizedState=[e,t===void 0?null:t],e},useContext:ra,useEffect:Bj,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,db(4194308,4,W5.bind(null,t,e),r)},useLayoutEffect:function(e,t){return db(4194308,4,e,t)},useInsertionEffect:function(e,t){return db(4,2,e,t)},useMemo:function(e,t){var r=fl();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=fl();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=XZ.bind(null,ei,e),[n.memoizedState,e]},useRef:function(e){var t=fl();return e={current:e},t.memoizedState=e},useState:zj,useDebugValue:XO,useDeferredValue:function(e){return fl().memoizedState=e},useTransition:function(){var e=zj(!1),t=e[0];return e=ZZ.bind(null,e[1]),fl().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=ei,o=fl();if(Un){if(r===void 0)throw Error(At(407));r=r()}else{if(r=t(),Hi===null)throw Error(At(349));yd&30||z5(n,t,r)}o.memoizedState=r;var l={value:r,getSnapshot:t};return o.queue=l,Bj(N5.bind(null,n,l,e),[e]),n.flags|=2048,Mv(9,B5.bind(null,n,l,r,t),void 0,null),r},useId:function(){var e=fl(),t=Hi.identifierPrefix;if(Un){var r=ec,n=Ql;r=(n&~(1<<32-Fa(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=kv++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=KZ++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},QZ={readContext:ra,useCallback:H5,useContext:ra,useEffect:ZO,useImperativeHandle:q5,useInsertionEffect:V5,useLayoutEffect:G5,useMemo:K5,useReducer:LE,useRef:U5,useState:function(){return LE(Ov)},useDebugValue:XO,useDeferredValue:function(e){var t=na();return Z5(t,Ii.memoizedState,e)},useTransition:function(){var e=LE(Ov)[0],t=na().memoizedState;return[e,t]},useMutableSource:L5,useSyncExternalStore:j5,useId:X5,unstable_isNewReconciler:!1},eX={readContext:ra,useCallback:H5,useContext:ra,useEffect:ZO,useImperativeHandle:q5,useInsertionEffect:V5,useLayoutEffect:G5,useMemo:K5,useReducer:jE,useRef:U5,useState:function(){return jE(Ov)},useDebugValue:XO,useDeferredValue:function(e){var t=na();return Ii===null?t.memoizedState=e:Z5(t,Ii.memoizedState,e)},useTransition:function(){var e=jE(Ov)[0],t=na().memoizedState;return[e,t]},useMutableSource:L5,useSyncExternalStore:j5,useId:X5,unstable_isNewReconciler:!1};function Np(e,t){try{var r="",n=t;do r+=CK(n),n=n.return;while(n);var o=r}catch(l){o=`
Error generating stack: `+l.message+`
`+l.stack}return{value:e,source:t,stack:o,digest:null}}function zE(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function IP(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var tX=typeof WeakMap=="function"?WeakMap:Map;function eU(e,t,r){r=ic(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){Zb||(Zb=!0,UP=n),IP(e,t)},r}function tU(e,t,r){r=ic(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var o=t.value;r.payload=function(){return n(o)},r.callback=function(){IP(e,t)}}var l=e.stateNode;return l!==null&&typeof l.componentDidCatch=="function"&&(r.callback=function(){IP(e,t),typeof n!="function"&&(Pu===null?Pu=new Set([this]):Pu.add(this));var h=t.stack;this.componentDidCatch(t.value,{componentStack:h!==null?h:""})}),r}function Nj(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new tX;var o=new Set;n.set(t,o)}else o=n.get(t),o===void 0&&(o=new Set,n.set(t,o));o.has(r)||(o.add(r),e=mX.bind(null,e,t,r),t.then(e,e))}function $j(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Fj(e,t,r,n,o){return e.mode&1?(e.flags|=65536,e.lanes=o,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=ic(-1,1),t.tag=2,Au(r,t,1))),r.lanes|=1),e)}var rX=_c.ReactCurrentOwner,Jo=!1;function Oo(e,t,r,n){t.child=e===null?R5(t,null,r,n):zp(t,e.child,r,n)}function Uj(e,t,r,n,o){r=r.render;var l=t.ref;return Sp(t,o),n=HO(e,t,r,n,l,o),r=KO(),e!==null&&!Jo?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~o,fc(e,t,o)):(Un&&r&&LO(t),t.flags|=1,Oo(e,t,n,o),t.child)}function Vj(e,t,r,n,o){if(e===null){var l=r.type;return typeof l=="function"&&!iM(l)&&l.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=l,rU(e,t,l,n,o)):(e=gb(r.type,null,n,t,t.mode,o),e.ref=t.ref,e.return=t,t.child=e)}if(l=e.child,!(e.lanes&o)){var h=l.memoizedProps;if(r=r.compare,r=r!==null?r:Sv,r(h,n)&&e.ref===t.ref)return fc(e,t,o)}return t.flags|=1,e=ku(l,n),e.ref=t.ref,e.return=t,t.child=e}function rU(e,t,r,n,o){if(e!==null){var l=e.memoizedProps;if(Sv(l,n)&&e.ref===t.ref)if(Jo=!1,t.pendingProps=n=l,(e.lanes&o)!==0)e.flags&131072&&(Jo=!0);else return t.lanes=e.lanes,fc(e,t,o)}return RP(e,t,r,n,o)}function nU(e,t,r){var n=t.pendingProps,o=n.children,l=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},En(cp,xs),xs|=r;else{if(!(r&1073741824))return e=l!==null?l.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,En(cp,xs),xs|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=l!==null?l.baseLanes:r,En(cp,xs),xs|=n}else l!==null?(n=l.baseLanes|r,t.memoizedState=null):n=r,En(cp,xs),xs|=n;return Oo(e,t,o,r),t.child}function iU(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function RP(e,t,r,n,o){var l=ts(r)?md:Eo.current;return l=Lp(t,l),Sp(t,o),r=HO(e,t,r,n,l,o),n=KO(),e!==null&&!Jo?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~o,fc(e,t,o)):(Un&&n&&LO(t),t.flags|=1,Oo(e,t,r,o),t.child)}function Gj(e,t,r,n,o){if(ts(r)){var l=!0;Nb(t)}else l=!1;if(Sp(t,o),t.stateNode===null)fb(e,t),M5(t,r,n),MP(t,r,n,o),n=!0;else if(e===null){var h=t.stateNode,f=t.memoizedProps;h.props=f;var s=h.context,y=r.contextType;typeof y=="object"&&y!==null?y=ra(y):(y=ts(r)?md:Eo.current,y=Lp(t,y));var b=r.getDerivedStateFromProps,w=typeof b=="function"||typeof h.getSnapshotBeforeUpdate=="function";w||typeof h.UNSAFE_componentWillReceiveProps!="function"&&typeof h.componentWillReceiveProps!="function"||(f!==n||s!==y)&&Lj(t,h,n,y),lu=!1;var A=t.memoizedState;h.state=A,Gb(t,n,h,o),s=t.memoizedState,f!==n||A!==s||es.current||lu?(typeof b=="function"&&(OP(t,r,b,n),s=t.memoizedState),(f=lu||Dj(t,r,f,n,A,s,y))?(w||typeof h.UNSAFE_componentWillMount!="function"&&typeof h.componentWillMount!="function"||(typeof h.componentWillMount=="function"&&h.componentWillMount(),typeof h.UNSAFE_componentWillMount=="function"&&h.UNSAFE_componentWillMount()),typeof h.componentDidMount=="function"&&(t.flags|=4194308)):(typeof h.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=s),h.props=n,h.state=s,h.context=y,n=f):(typeof h.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{h=t.stateNode,k5(e,t),f=t.memoizedProps,y=t.type===t.elementType?f:Ma(t.type,f),h.props=y,w=t.pendingProps,A=h.context,s=r.contextType,typeof s=="object"&&s!==null?s=ra(s):(s=ts(r)?md:Eo.current,s=Lp(t,s));var k=r.getDerivedStateFromProps;(b=typeof k=="function"||typeof h.getSnapshotBeforeUpdate=="function")||typeof h.UNSAFE_componentWillReceiveProps!="function"&&typeof h.componentWillReceiveProps!="function"||(f!==w||A!==s)&&Lj(t,h,n,s),lu=!1,A=t.memoizedState,h.state=A,Gb(t,n,h,o);var M=t.memoizedState;f!==w||A!==M||es.current||lu?(typeof k=="function"&&(OP(t,r,k,n),M=t.memoizedState),(y=lu||Dj(t,r,y,n,A,M,s)||!1)?(b||typeof h.UNSAFE_componentWillUpdate!="function"&&typeof h.componentWillUpdate!="function"||(typeof h.componentWillUpdate=="function"&&h.componentWillUpdate(n,M,s),typeof h.UNSAFE_componentWillUpdate=="function"&&h.UNSAFE_componentWillUpdate(n,M,s)),typeof h.componentDidUpdate=="function"&&(t.flags|=4),typeof h.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof h.componentDidUpdate!="function"||f===e.memoizedProps&&A===e.memoizedState||(t.flags|=4),typeof h.getSnapshotBeforeUpdate!="function"||f===e.memoizedProps&&A===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=M),h.props=n,h.state=M,h.context=s,n=y):(typeof h.componentDidUpdate!="function"||f===e.memoizedProps&&A===e.memoizedState||(t.flags|=4),typeof h.getSnapshotBeforeUpdate!="function"||f===e.memoizedProps&&A===e.memoizedState||(t.flags|=1024),n=!1)}return DP(e,t,r,n,l,o)}function DP(e,t,r,n,o,l){iU(e,t);var h=(t.flags&128)!==0;if(!n&&!h)return o&&kj(t,r,!1),fc(e,t,l);n=t.stateNode,rX.current=t;var f=h&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&h?(t.child=zp(t,e.child,null,l),t.child=zp(t,null,f,l)):Oo(e,t,f,l),t.memoizedState=n.state,o&&kj(t,r,!0),t.child}function oU(e){var t=e.stateNode;t.pendingContext?Cj(e,t.pendingContext,t.pendingContext!==t.context):t.context&&Cj(e,t.context,!1),VO(e,t.containerInfo)}function Wj(e,t,r,n,o){return jp(),zO(o),t.flags|=256,Oo(e,t,r,n),t.child}var LP={dehydrated:null,treeContext:null,retryLane:0};function jP(e){return{baseLanes:e,cachePool:null,transitions:null}}function sU(e,t,r){var n=t.pendingProps,o=Jn.current,l=!1,h=(t.flags&128)!==0,f;if((f=h)||(f=e!==null&&e.memoizedState===null?!1:(o&2)!==0),f?(l=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(o|=1),En(Jn,o&1),e===null)return CP(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(h=n.children,e=n.fallback,l?(n=t.mode,l=t.child,h={mode:"hidden",children:h},!(n&1)&&l!==null?(l.childLanes=0,l.pendingProps=h):l=P1(h,n,0,null),e=ld(e,n,r,null),l.return=t,e.return=t,l.sibling=e,t.child=l,t.child.memoizedState=jP(r),t.memoizedState=LP,e):YO(t,h));if(o=e.memoizedState,o!==null&&(f=o.dehydrated,f!==null))return nX(e,t,h,n,f,o,r);if(l){l=n.fallback,h=t.mode,o=e.child,f=o.sibling;var s={mode:"hidden",children:n.children};return!(h&1)&&t.child!==o?(n=t.child,n.childLanes=0,n.pendingProps=s,t.deletions=null):(n=ku(o,s),n.subtreeFlags=o.subtreeFlags&14680064),f!==null?l=ku(f,l):(l=ld(l,h,r,null),l.flags|=2),l.return=t,n.return=t,n.sibling=l,t.child=n,n=l,l=t.child,h=e.child.memoizedState,h=h===null?jP(r):{baseLanes:h.baseLanes|r,cachePool:null,transitions:h.transitions},l.memoizedState=h,l.childLanes=e.childLanes&~r,t.memoizedState=LP,n}return l=e.child,e=l.sibling,n=ku(l,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function YO(e,t){return t=P1({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function kx(e,t,r,n){return n!==null&&zO(n),zp(t,e.child,null,r),e=YO(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function nX(e,t,r,n,o,l,h){if(r)return t.flags&256?(t.flags&=-257,n=zE(Error(At(422))),kx(e,t,h,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(l=n.fallback,o=t.mode,n=P1({mode:"visible",children:n.children},o,0,null),l=ld(l,o,h,null),l.flags|=2,n.return=t,l.return=t,n.sibling=l,t.child=n,t.mode&1&&zp(t,e.child,null,h),t.child.memoizedState=jP(h),t.memoizedState=LP,l);if(!(t.mode&1))return kx(e,t,h,null);if(o.data==="$!"){if(n=o.nextSibling&&o.nextSibling.dataset,n)var f=n.dgst;return n=f,l=Error(At(419)),n=zE(l,n,void 0),kx(e,t,h,n)}if(f=(h&e.childLanes)!==0,Jo||f){if(n=Hi,n!==null){switch(h&-h){case 4:o=2;break;case 16:o=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:o=32;break;case 536870912:o=268435456;break;default:o=0}o=o&(n.suspendedLanes|h)?0:o,o!==0&&o!==l.retryLane&&(l.retryLane=o,dc(e,o),Ua(n,e,o,-1))}return nM(),n=zE(Error(At(421))),kx(e,t,h,n)}return o.data==="$?"?(t.flags|=128,t.child=e.child,t=gX.bind(null,e),o._reactRetry=t,null):(e=l.treeContext,As=Eu(o.nextSibling),Ps=t,Un=!0,Ba=null,e!==null&&(qs[Hs++]=Ql,qs[Hs++]=ec,qs[Hs++]=gd,Ql=e.id,ec=e.overflow,gd=t),t=YO(t,n.children),t.flags|=4096,t)}function qj(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),kP(e.return,t,r)}function BE(e,t,r,n,o){var l=e.memoizedState;l===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:o}:(l.isBackwards=t,l.rendering=null,l.renderingStartTime=0,l.last=n,l.tail=r,l.tailMode=o)}function aU(e,t,r){var n=t.pendingProps,o=n.revealOrder,l=n.tail;if(Oo(e,t,n.children,r),n=Jn.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&qj(e,r,t);else if(e.tag===19)qj(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(En(Jn,n),!(t.mode&1))t.memoizedState=null;else switch(o){case"forwards":for(r=t.child,o=null;r!==null;)e=r.alternate,e!==null&&Wb(e)===null&&(o=r),r=r.sibling;r=o,r===null?(o=t.child,t.child=null):(o=r.sibling,r.sibling=null),BE(t,!1,o,r,l);break;case"backwards":for(r=null,o=t.child,t.child=null;o!==null;){if(e=o.alternate,e!==null&&Wb(e)===null){t.child=o;break}e=o.sibling,o.sibling=r,r=o,o=e}BE(t,!0,r,null,l);break;case"together":BE(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function fb(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function fc(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),vd|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(At(153));if(t.child!==null){for(e=t.child,r=ku(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=ku(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function iX(e,t,r){switch(t.tag){case 3:oU(t),jp();break;case 5:D5(t);break;case 1:ts(t.type)&&Nb(t);break;case 4:VO(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,o=t.memoizedProps.value;En(Ub,n._currentValue),n._currentValue=o;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(En(Jn,Jn.current&1),t.flags|=128,null):r&t.child.childLanes?sU(e,t,r):(En(Jn,Jn.current&1),e=fc(e,t,r),e!==null?e.sibling:null);En(Jn,Jn.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return aU(e,t,r);t.flags|=128}if(o=t.memoizedState,o!==null&&(o.rendering=null,o.tail=null,o.lastEffect=null),En(Jn,Jn.current),n)break;return null;case 22:case 23:return t.lanes=0,nU(e,t,r)}return fc(e,t,r)}var lU,zP,cU,uU;lU=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};zP=function(){};cU=function(e,t,r,n){var o=e.memoizedProps;if(o!==n){e=t.stateNode,Yh(_l.current);var l=null;switch(r){case"input":o=oP(e,o),n=oP(e,n),l=[];break;case"select":o=ti({},o,{value:void 0}),n=ti({},n,{value:void 0}),l=[];break;case"textarea":o=lP(e,o),n=lP(e,n),l=[];break;default:typeof o.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=zb)}uP(r,n);var h;r=null;for(y in o)if(!n.hasOwnProperty(y)&&o.hasOwnProperty(y)&&o[y]!=null)if(y==="style"){var f=o[y];for(h in f)f.hasOwnProperty(h)&&(r||(r={}),r[h]="")}else y!=="dangerouslySetInnerHTML"&&y!=="children"&&y!=="suppressContentEditableWarning"&&y!=="suppressHydrationWarning"&&y!=="autoFocus"&&(gv.hasOwnProperty(y)?l||(l=[]):(l=l||[]).push(y,null));for(y in n){var s=n[y];if(f=o!=null?o[y]:void 0,n.hasOwnProperty(y)&&s!==f&&(s!=null||f!=null))if(y==="style")if(f){for(h in f)!f.hasOwnProperty(h)||s&&s.hasOwnProperty(h)||(r||(r={}),r[h]="");for(h in s)s.hasOwnProperty(h)&&f[h]!==s[h]&&(r||(r={}),r[h]=s[h])}else r||(l||(l=[]),l.push(y,r)),r=s;else y==="dangerouslySetInnerHTML"?(s=s?s.__html:void 0,f=f?f.__html:void 0,s!=null&&f!==s&&(l=l||[]).push(y,s)):y==="children"?typeof s!="string"&&typeof s!="number"||(l=l||[]).push(y,""+s):y!=="suppressContentEditableWarning"&&y!=="suppressHydrationWarning"&&(gv.hasOwnProperty(y)?(s!=null&&y==="onScroll"&&Mn("scroll",e),l||f===s||(l=[])):(l=l||[]).push(y,s))}r&&(l=l||[]).push("style",r);var y=l;(t.updateQueue=y)&&(t.flags|=4)}};uU=function(e,t,r,n){r!==n&&(t.flags|=4)};function xy(e,t){if(!Un)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function vo(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var o=e.child;o!==null;)r|=o.lanes|o.childLanes,n|=o.subtreeFlags&14680064,n|=o.flags&14680064,o.return=e,o=o.sibling;else for(o=e.child;o!==null;)r|=o.lanes|o.childLanes,n|=o.subtreeFlags,n|=o.flags,o.return=e,o=o.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function oX(e,t,r){var n=t.pendingProps;switch(jO(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return vo(t),null;case 1:return ts(t.type)&&Bb(),vo(t),null;case 3:return n=t.stateNode,Bp(),Dn(es),Dn(Eo),WO(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(Px(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Ba!==null&&(WP(Ba),Ba=null))),zP(e,t),vo(t),null;case 5:GO(t);var o=Yh(Cv.current);if(r=t.type,e!==null&&t.stateNode!=null)cU(e,t,r,n,o),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(At(166));return vo(t),null}if(e=Yh(_l.current),Px(t)){n=t.stateNode,r=t.type;var l=t.memoizedProps;switch(n[pl]=t,n[Av]=l,e=(t.mode&1)!==0,r){case"dialog":Mn("cancel",n),Mn("close",n);break;case"iframe":case"object":case"embed":Mn("load",n);break;case"video":case"audio":for(o=0;o<Fy.length;o++)Mn(Fy[o],n);break;case"source":Mn("error",n);break;case"img":case"image":case"link":Mn("error",n),Mn("load",n);break;case"details":Mn("toggle",n);break;case"input":tj(n,l),Mn("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!l.multiple},Mn("invalid",n);break;case"textarea":nj(n,l),Mn("invalid",n)}uP(r,l),o=null;for(var h in l)if(l.hasOwnProperty(h)){var f=l[h];h==="children"?typeof f=="string"?n.textContent!==f&&(l.suppressHydrationWarning!==!0&&Ax(n.textContent,f,e),o=["children",f]):typeof f=="number"&&n.textContent!==""+f&&(l.suppressHydrationWarning!==!0&&Ax(n.textContent,f,e),o=["children",""+f]):gv.hasOwnProperty(h)&&f!=null&&h==="onScroll"&&Mn("scroll",n)}switch(r){case"input":vx(n),rj(n,l,!0);break;case"textarea":vx(n),ij(n);break;case"select":case"option":break;default:typeof l.onClick=="function"&&(n.onclick=zb)}n=o,t.updateQueue=n,n!==null&&(t.flags|=4)}else{h=o.nodeType===9?o:o.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=z4(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=h.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=h.createElement(r,{is:n.is}):(e=h.createElement(r),r==="select"&&(h=e,n.multiple?h.multiple=!0:n.size&&(h.size=n.size))):e=h.createElementNS(e,r),e[pl]=t,e[Av]=n,lU(e,t,!1,!1),t.stateNode=e;e:{switch(h=hP(r,n),r){case"dialog":Mn("cancel",e),Mn("close",e),o=n;break;case"iframe":case"object":case"embed":Mn("load",e),o=n;break;case"video":case"audio":for(o=0;o<Fy.length;o++)Mn(Fy[o],e);o=n;break;case"source":Mn("error",e),o=n;break;case"img":case"image":case"link":Mn("error",e),Mn("load",e),o=n;break;case"details":Mn("toggle",e),o=n;break;case"input":tj(e,n),o=oP(e,n),Mn("invalid",e);break;case"option":o=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},o=ti({},n,{value:void 0}),Mn("invalid",e);break;case"textarea":nj(e,n),o=lP(e,n),Mn("invalid",e);break;default:o=n}uP(r,o),f=o;for(l in f)if(f.hasOwnProperty(l)){var s=f[l];l==="style"?$4(e,s):l==="dangerouslySetInnerHTML"?(s=s?s.__html:void 0,s!=null&&B4(e,s)):l==="children"?typeof s=="string"?(r!=="textarea"||s!=="")&&yv(e,s):typeof s=="number"&&yv(e,""+s):l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&l!=="autoFocus"&&(gv.hasOwnProperty(l)?s!=null&&l==="onScroll"&&Mn("scroll",e):s!=null&&bO(e,l,s,h))}switch(r){case"input":vx(e),rj(e,n,!1);break;case"textarea":vx(e),ij(e);break;case"option":n.value!=null&&e.setAttribute("value",""+Ru(n.value));break;case"select":e.multiple=!!n.multiple,l=n.value,l!=null?_p(e,!!n.multiple,l,!1):n.defaultValue!=null&&_p(e,!!n.multiple,n.defaultValue,!0);break;default:typeof o.onClick=="function"&&(e.onclick=zb)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return vo(t),null;case 6:if(e&&t.stateNode!=null)uU(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(At(166));if(r=Yh(Cv.current),Yh(_l.current),Px(t)){if(n=t.stateNode,r=t.memoizedProps,n[pl]=t,(l=n.nodeValue!==r)&&(e=Ps,e!==null))switch(e.tag){case 3:Ax(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Ax(n.nodeValue,r,(e.mode&1)!==0)}l&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[pl]=t,t.stateNode=n}return vo(t),null;case 13:if(Dn(Jn),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Un&&As!==null&&t.mode&1&&!(t.flags&128))P5(),jp(),t.flags|=98560,l=!1;else if(l=Px(t),n!==null&&n.dehydrated!==null){if(e===null){if(!l)throw Error(At(318));if(l=t.memoizedState,l=l!==null?l.dehydrated:null,!l)throw Error(At(317));l[pl]=t}else jp(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;vo(t),l=!1}else Ba!==null&&(WP(Ba),Ba=null),l=!0;if(!l)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||Jn.current&1?Ri===0&&(Ri=3):nM())),t.updateQueue!==null&&(t.flags|=4),vo(t),null);case 4:return Bp(),zP(e,t),e===null&&Tv(t.stateNode.containerInfo),vo(t),null;case 10:return $O(t.type._context),vo(t),null;case 17:return ts(t.type)&&Bb(),vo(t),null;case 19:if(Dn(Jn),l=t.memoizedState,l===null)return vo(t),null;if(n=(t.flags&128)!==0,h=l.rendering,h===null)if(n)xy(l,!1);else{if(Ri!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(h=Wb(e),h!==null){for(t.flags|=128,xy(l,!1),n=h.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)l=r,e=n,l.flags&=14680066,h=l.alternate,h===null?(l.childLanes=0,l.lanes=e,l.child=null,l.subtreeFlags=0,l.memoizedProps=null,l.memoizedState=null,l.updateQueue=null,l.dependencies=null,l.stateNode=null):(l.childLanes=h.childLanes,l.lanes=h.lanes,l.child=h.child,l.subtreeFlags=0,l.deletions=null,l.memoizedProps=h.memoizedProps,l.memoizedState=h.memoizedState,l.updateQueue=h.updateQueue,l.type=h.type,e=h.dependencies,l.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return En(Jn,Jn.current&1|2),t.child}e=e.sibling}l.tail!==null&&ai()>$p&&(t.flags|=128,n=!0,xy(l,!1),t.lanes=4194304)}else{if(!n)if(e=Wb(h),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),xy(l,!0),l.tail===null&&l.tailMode==="hidden"&&!h.alternate&&!Un)return vo(t),null}else 2*ai()-l.renderingStartTime>$p&&r!==1073741824&&(t.flags|=128,n=!0,xy(l,!1),t.lanes=4194304);l.isBackwards?(h.sibling=t.child,t.child=h):(r=l.last,r!==null?r.sibling=h:t.child=h,l.last=h)}return l.tail!==null?(t=l.tail,l.rendering=t,l.tail=t.sibling,l.renderingStartTime=ai(),t.sibling=null,r=Jn.current,En(Jn,n?r&1|2:r&1),t):(vo(t),null);case 22:case 23:return rM(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?xs&1073741824&&(vo(t),t.subtreeFlags&6&&(t.flags|=8192)):vo(t),null;case 24:return null;case 25:return null}throw Error(At(156,t.tag))}function sX(e,t){switch(jO(t),t.tag){case 1:return ts(t.type)&&Bb(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Bp(),Dn(es),Dn(Eo),WO(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return GO(t),null;case 13:if(Dn(Jn),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(At(340));jp()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Dn(Jn),null;case 4:return Bp(),null;case 10:return $O(t.type._context),null;case 22:case 23:return rM(),null;case 24:return null;default:return null}}var Ox=!1,xo=!1,aX=typeof WeakSet=="function"?WeakSet:Set,Ht=null;function lp(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){oi(e,t,n)}else r.current=null}function BP(e,t,r){try{r()}catch(n){oi(e,t,n)}}var Hj=!1;function lX(e,t){if(bP=Db,e=p5(),DO(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var o=n.anchorOffset,l=n.focusNode;n=n.focusOffset;try{r.nodeType,l.nodeType}catch{r=null;break e}var h=0,f=-1,s=-1,y=0,b=0,w=e,A=null;t:for(;;){for(var k;w!==r||o!==0&&w.nodeType!==3||(f=h+o),w!==l||n!==0&&w.nodeType!==3||(s=h+n),w.nodeType===3&&(h+=w.nodeValue.length),(k=w.firstChild)!==null;)A=w,w=k;for(;;){if(w===e)break t;if(A===r&&++y===o&&(f=h),A===l&&++b===n&&(s=h),(k=w.nextSibling)!==null)break;w=A,A=w.parentNode}w=k}r=f===-1||s===-1?null:{start:f,end:s}}else r=null}r=r||{start:0,end:0}}else r=null;for(wP={focusedElem:e,selectionRange:r},Db=!1,Ht=t;Ht!==null;)if(t=Ht,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Ht=e;else for(;Ht!==null;){t=Ht;try{var M=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(M!==null){var R=M.memoizedProps,j=M.memoizedState,L=t.stateNode,z=L.getSnapshotBeforeUpdate(t.elementType===t.type?R:Ma(t.type,R),j);L.__reactInternalSnapshotBeforeUpdate=z}break;case 3:var B=t.stateNode.containerInfo;B.nodeType===1?B.textContent="":B.nodeType===9&&B.documentElement&&B.removeChild(B.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(At(163))}}catch(Z){oi(t,t.return,Z)}if(e=t.sibling,e!==null){e.return=t.return,Ht=e;break}Ht=t.return}return M=Hj,Hj=!1,M}function Qy(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var o=n=n.next;do{if((o.tag&e)===e){var l=o.destroy;o.destroy=void 0,l!==void 0&&BP(t,r,l)}o=o.next}while(o!==n)}}function E1(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function NP(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function hU(e){var t=e.alternate;t!==null&&(e.alternate=null,hU(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[pl],delete t[Av],delete t[EP],delete t[GZ],delete t[WZ])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function dU(e){return e.tag===5||e.tag===3||e.tag===4}function Kj(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||dU(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function $P(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=zb));else if(n!==4&&(e=e.child,e!==null))for($P(e,t,r),e=e.sibling;e!==null;)$P(e,t,r),e=e.sibling}function FP(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(FP(e,t,r),e=e.sibling;e!==null;)FP(e,t,r),e=e.sibling}var eo=null,Ra=!1;function ru(e,t,r){for(r=r.child;r!==null;)fU(e,t,r),r=r.sibling}function fU(e,t,r){if(vl&&typeof vl.onCommitFiberUnmount=="function")try{vl.onCommitFiberUnmount(y1,r)}catch{}switch(r.tag){case 5:xo||lp(r,t);case 6:var n=eo,o=Ra;eo=null,ru(e,t,r),eo=n,Ra=o,eo!==null&&(Ra?(e=eo,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):eo.removeChild(r.stateNode));break;case 18:eo!==null&&(Ra?(e=eo,r=r.stateNode,e.nodeType===8?ME(e.parentNode,r):e.nodeType===1&&ME(e,r),bv(e)):ME(eo,r.stateNode));break;case 4:n=eo,o=Ra,eo=r.stateNode.containerInfo,Ra=!0,ru(e,t,r),eo=n,Ra=o;break;case 0:case 11:case 14:case 15:if(!xo&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){o=n=n.next;do{var l=o,h=l.destroy;l=l.tag,h!==void 0&&(l&2||l&4)&&BP(r,t,h),o=o.next}while(o!==n)}ru(e,t,r);break;case 1:if(!xo&&(lp(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(f){oi(r,t,f)}ru(e,t,r);break;case 21:ru(e,t,r);break;case 22:r.mode&1?(xo=(n=xo)||r.memoizedState!==null,ru(e,t,r),xo=n):ru(e,t,r);break;default:ru(e,t,r)}}function Zj(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new aX),t.forEach(function(n){var o=yX.bind(null,e,n);r.has(n)||(r.add(n),n.then(o,o))})}}function Ta(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var o=r[n];try{var l=e,h=t,f=h;e:for(;f!==null;){switch(f.tag){case 5:eo=f.stateNode,Ra=!1;break e;case 3:eo=f.stateNode.containerInfo,Ra=!0;break e;case 4:eo=f.stateNode.containerInfo,Ra=!0;break e}f=f.return}if(eo===null)throw Error(At(160));fU(l,h,o),eo=null,Ra=!1;var s=o.alternate;s!==null&&(s.return=null),o.return=null}catch(y){oi(o,t,y)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)pU(t,e),t=t.sibling}function pU(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Ta(t,e),hl(e),n&4){try{Qy(3,e,e.return),E1(3,e)}catch(R){oi(e,e.return,R)}try{Qy(5,e,e.return)}catch(R){oi(e,e.return,R)}}break;case 1:Ta(t,e),hl(e),n&512&&r!==null&&lp(r,r.return);break;case 5:if(Ta(t,e),hl(e),n&512&&r!==null&&lp(r,r.return),e.flags&32){var o=e.stateNode;try{yv(o,"")}catch(R){oi(e,e.return,R)}}if(n&4&&(o=e.stateNode,o!=null)){var l=e.memoizedProps,h=r!==null?r.memoizedProps:l,f=e.type,s=e.updateQueue;if(e.updateQueue=null,s!==null)try{f==="input"&&l.type==="radio"&&l.name!=null&&L4(o,l),hP(f,h);var y=hP(f,l);for(h=0;h<s.length;h+=2){var b=s[h],w=s[h+1];b==="style"?$4(o,w):b==="dangerouslySetInnerHTML"?B4(o,w):b==="children"?yv(o,w):bO(o,b,w,y)}switch(f){case"input":sP(o,l);break;case"textarea":j4(o,l);break;case"select":var A=o._wrapperState.wasMultiple;o._wrapperState.wasMultiple=!!l.multiple;var k=l.value;k!=null?_p(o,!!l.multiple,k,!1):A!==!!l.multiple&&(l.defaultValue!=null?_p(o,!!l.multiple,l.defaultValue,!0):_p(o,!!l.multiple,l.multiple?[]:"",!1))}o[Av]=l}catch(R){oi(e,e.return,R)}}break;case 6:if(Ta(t,e),hl(e),n&4){if(e.stateNode===null)throw Error(At(162));o=e.stateNode,l=e.memoizedProps;try{o.nodeValue=l}catch(R){oi(e,e.return,R)}}break;case 3:if(Ta(t,e),hl(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{bv(t.containerInfo)}catch(R){oi(e,e.return,R)}break;case 4:Ta(t,e),hl(e);break;case 13:Ta(t,e),hl(e),o=e.child,o.flags&8192&&(l=o.memoizedState!==null,o.stateNode.isHidden=l,!l||o.alternate!==null&&o.alternate.memoizedState!==null||(eM=ai())),n&4&&Zj(e);break;case 22:if(b=r!==null&&r.memoizedState!==null,e.mode&1?(xo=(y=xo)||b,Ta(t,e),xo=y):Ta(t,e),hl(e),n&8192){if(y=e.memoizedState!==null,(e.stateNode.isHidden=y)&&!b&&e.mode&1)for(Ht=e,b=e.child;b!==null;){for(w=Ht=b;Ht!==null;){switch(A=Ht,k=A.child,A.tag){case 0:case 11:case 14:case 15:Qy(4,A,A.return);break;case 1:lp(A,A.return);var M=A.stateNode;if(typeof M.componentWillUnmount=="function"){n=A,r=A.return;try{t=n,M.props=t.memoizedProps,M.state=t.memoizedState,M.componentWillUnmount()}catch(R){oi(n,r,R)}}break;case 5:lp(A,A.return);break;case 22:if(A.memoizedState!==null){Yj(w);continue}}k!==null?(k.return=A,Ht=k):Yj(w)}b=b.sibling}e:for(b=null,w=e;;){if(w.tag===5){if(b===null){b=w;try{o=w.stateNode,y?(l=o.style,typeof l.setProperty=="function"?l.setProperty("display","none","important"):l.display="none"):(f=w.stateNode,s=w.memoizedProps.style,h=s!=null&&s.hasOwnProperty("display")?s.display:null,f.style.display=N4("display",h))}catch(R){oi(e,e.return,R)}}}else if(w.tag===6){if(b===null)try{w.stateNode.nodeValue=y?"":w.memoizedProps}catch(R){oi(e,e.return,R)}}else if((w.tag!==22&&w.tag!==23||w.memoizedState===null||w===e)&&w.child!==null){w.child.return=w,w=w.child;continue}if(w===e)break e;for(;w.sibling===null;){if(w.return===null||w.return===e)break e;b===w&&(b=null),w=w.return}b===w&&(b=null),w.sibling.return=w.return,w=w.sibling}}break;case 19:Ta(t,e),hl(e),n&4&&Zj(e);break;case 21:break;default:Ta(t,e),hl(e)}}function hl(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(dU(r)){var n=r;break e}r=r.return}throw Error(At(160))}switch(n.tag){case 5:var o=n.stateNode;n.flags&32&&(yv(o,""),n.flags&=-33);var l=Kj(e);FP(e,l,o);break;case 3:case 4:var h=n.stateNode.containerInfo,f=Kj(e);$P(e,f,h);break;default:throw Error(At(161))}}catch(s){oi(e,e.return,s)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function cX(e,t,r){Ht=e,mU(e)}function mU(e,t,r){for(var n=(e.mode&1)!==0;Ht!==null;){var o=Ht,l=o.child;if(o.tag===22&&n){var h=o.memoizedState!==null||Ox;if(!h){var f=o.alternate,s=f!==null&&f.memoizedState!==null||xo;f=Ox;var y=xo;if(Ox=h,(xo=s)&&!y)for(Ht=o;Ht!==null;)h=Ht,s=h.child,h.tag===22&&h.memoizedState!==null?Jj(o):s!==null?(s.return=h,Ht=s):Jj(o);for(;l!==null;)Ht=l,mU(l),l=l.sibling;Ht=o,Ox=f,xo=y}Xj(e)}else o.subtreeFlags&8772&&l!==null?(l.return=o,Ht=l):Xj(e)}}function Xj(e){for(;Ht!==null;){var t=Ht;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:xo||E1(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!xo)if(r===null)n.componentDidMount();else{var o=t.elementType===t.type?r.memoizedProps:Ma(t.type,r.memoizedProps);n.componentDidUpdate(o,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var l=t.updateQueue;l!==null&&Rj(t,l,n);break;case 3:var h=t.updateQueue;if(h!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}Rj(t,h,r)}break;case 5:var f=t.stateNode;if(r===null&&t.flags&4){r=f;var s=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":s.autoFocus&&r.focus();break;case"img":s.src&&(r.src=s.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var y=t.alternate;if(y!==null){var b=y.memoizedState;if(b!==null){var w=b.dehydrated;w!==null&&bv(w)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(At(163))}xo||t.flags&512&&NP(t)}catch(A){oi(t,t.return,A)}}if(t===e){Ht=null;break}if(r=t.sibling,r!==null){r.return=t.return,Ht=r;break}Ht=t.return}}function Yj(e){for(;Ht!==null;){var t=Ht;if(t===e){Ht=null;break}var r=t.sibling;if(r!==null){r.return=t.return,Ht=r;break}Ht=t.return}}function Jj(e){for(;Ht!==null;){var t=Ht;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{E1(4,t)}catch(s){oi(t,r,s)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var o=t.return;try{n.componentDidMount()}catch(s){oi(t,o,s)}}var l=t.return;try{NP(t)}catch(s){oi(t,l,s)}break;case 5:var h=t.return;try{NP(t)}catch(s){oi(t,h,s)}}}catch(s){oi(t,t.return,s)}if(t===e){Ht=null;break}var f=t.sibling;if(f!==null){f.return=t.return,Ht=f;break}Ht=t.return}}var uX=Math.ceil,Kb=_c.ReactCurrentDispatcher,JO=_c.ReactCurrentOwner,Js=_c.ReactCurrentBatchConfig,Ur=0,Hi=null,_i=null,no=0,xs=0,cp=Bu(0),Ri=0,Iv=null,vd=0,A1=0,QO=0,ev=null,Xo=null,eM=0,$p=1/0,Xl=null,Zb=!1,UP=null,Pu=null,Mx=!1,gu=null,Xb=0,tv=0,VP=null,pb=-1,mb=0;function jo(){return Ur&6?ai():pb!==-1?pb:pb=ai()}function Cu(e){return e.mode&1?Ur&2&&no!==0?no&-no:HZ.transition!==null?(mb===0&&(mb=J4()),mb):(e=pn,e!==0||(e=window.event,e=e===void 0?16:o5(e.type)),e):1}function Ua(e,t,r,n){if(50<tv)throw tv=0,VP=null,Error(At(185));k_(e,r,n),(!(Ur&2)||e!==Hi)&&(e===Hi&&(!(Ur&2)&&(A1|=r),Ri===4&&du(e,no)),rs(e,n),r===1&&Ur===0&&!(t.mode&1)&&($p=ai()+500,w1&&Nu()))}function rs(e,t){var r=e.callbackNode;HK(e,t);var n=Rb(e,e===Hi?no:0);if(n===0)r!==null&&aj(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&aj(r),t===1)e.tag===0?qZ(Qj.bind(null,e)):T5(Qj.bind(null,e)),UZ(function(){!(Ur&6)&&Nu()}),r=null;else{switch(Q4(n)){case 1:r=AO;break;case 4:r=X4;break;case 16:r=Ib;break;case 536870912:r=Y4;break;default:r=Ib}r=SU(r,gU.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function gU(e,t){if(pb=-1,mb=0,Ur&6)throw Error(At(327));var r=e.callbackNode;if(Tp()&&e.callbackNode!==r)return null;var n=Rb(e,e===Hi?no:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=Yb(e,n);else{t=n;var o=Ur;Ur|=2;var l=vU();(Hi!==e||no!==t)&&(Xl=null,$p=ai()+500,ad(e,t));do try{fX();break}catch(f){yU(e,f)}while(!0);NO(),Kb.current=l,Ur=o,_i!==null?t=0:(Hi=null,no=0,t=Ri)}if(t!==0){if(t===2&&(o=gP(e),o!==0&&(n=o,t=GP(e,o))),t===1)throw r=Iv,ad(e,0),du(e,n),rs(e,ai()),r;if(t===6)du(e,n);else{if(o=e.current.alternate,!(n&30)&&!hX(o)&&(t=Yb(e,n),t===2&&(l=gP(e),l!==0&&(n=l,t=GP(e,l))),t===1))throw r=Iv,ad(e,0),du(e,n),rs(e,ai()),r;switch(e.finishedWork=o,e.finishedLanes=n,t){case 0:case 1:throw Error(At(345));case 2:$h(e,Xo,Xl);break;case 3:if(du(e,n),(n&130023424)===n&&(t=eM+500-ai(),10<t)){if(Rb(e,0)!==0)break;if(o=e.suspendedLanes,(o&n)!==n){jo(),e.pingedLanes|=e.suspendedLanes&o;break}e.timeoutHandle=TP($h.bind(null,e,Xo,Xl),t);break}$h(e,Xo,Xl);break;case 4:if(du(e,n),(n&4194240)===n)break;for(t=e.eventTimes,o=-1;0<n;){var h=31-Fa(n);l=1<<h,h=t[h],h>o&&(o=h),n&=~l}if(n=o,n=ai()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*uX(n/1960))-n,10<n){e.timeoutHandle=TP($h.bind(null,e,Xo,Xl),n);break}$h(e,Xo,Xl);break;case 5:$h(e,Xo,Xl);break;default:throw Error(At(329))}}}return rs(e,ai()),e.callbackNode===r?gU.bind(null,e):null}function GP(e,t){var r=ev;return e.current.memoizedState.isDehydrated&&(ad(e,t).flags|=256),e=Yb(e,t),e!==2&&(t=Xo,Xo=r,t!==null&&WP(t)),e}function WP(e){Xo===null?Xo=e:Xo.push.apply(Xo,e)}function hX(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var o=r[n],l=o.getSnapshot;o=o.value;try{if(!Va(l(),o))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function du(e,t){for(t&=~QO,t&=~A1,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-Fa(t),n=1<<r;e[r]=-1,t&=~n}}function Qj(e){if(Ur&6)throw Error(At(327));Tp();var t=Rb(e,0);if(!(t&1))return rs(e,ai()),null;var r=Yb(e,t);if(e.tag!==0&&r===2){var n=gP(e);n!==0&&(t=n,r=GP(e,n))}if(r===1)throw r=Iv,ad(e,0),du(e,t),rs(e,ai()),r;if(r===6)throw Error(At(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,$h(e,Xo,Xl),rs(e,ai()),null}function tM(e,t){var r=Ur;Ur|=1;try{return e(t)}finally{Ur=r,Ur===0&&($p=ai()+500,w1&&Nu())}}function _d(e){gu!==null&&gu.tag===0&&!(Ur&6)&&Tp();var t=Ur;Ur|=1;var r=Js.transition,n=pn;try{if(Js.transition=null,pn=1,e)return e()}finally{pn=n,Js.transition=r,Ur=t,!(Ur&6)&&Nu()}}function rM(){xs=cp.current,Dn(cp)}function ad(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,FZ(r)),_i!==null)for(r=_i.return;r!==null;){var n=r;switch(jO(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&Bb();break;case 3:Bp(),Dn(es),Dn(Eo),WO();break;case 5:GO(n);break;case 4:Bp();break;case 13:Dn(Jn);break;case 19:Dn(Jn);break;case 10:$O(n.type._context);break;case 22:case 23:rM()}r=r.return}if(Hi=e,_i=e=ku(e.current,null),no=xs=t,Ri=0,Iv=null,QO=A1=vd=0,Xo=ev=null,Xh!==null){for(t=0;t<Xh.length;t++)if(r=Xh[t],n=r.interleaved,n!==null){r.interleaved=null;var o=n.next,l=r.pending;if(l!==null){var h=l.next;l.next=o,n.next=h}r.pending=n}Xh=null}return e}function yU(e,t){do{var r=_i;try{if(NO(),hb.current=Hb,qb){for(var n=ei.memoizedState;n!==null;){var o=n.queue;o!==null&&(o.pending=null),n=n.next}qb=!1}if(yd=0,qi=Ii=ei=null,Jy=!1,kv=0,JO.current=null,r===null||r.return===null){Ri=1,Iv=t,_i=null;break}e:{var l=e,h=r.return,f=r,s=t;if(t=no,f.flags|=32768,s!==null&&typeof s=="object"&&typeof s.then=="function"){var y=s,b=f,w=b.tag;if(!(b.mode&1)&&(w===0||w===11||w===15)){var A=b.alternate;A?(b.updateQueue=A.updateQueue,b.memoizedState=A.memoizedState,b.lanes=A.lanes):(b.updateQueue=null,b.memoizedState=null)}var k=$j(h);if(k!==null){k.flags&=-257,Fj(k,h,f,l,t),k.mode&1&&Nj(l,y,t),t=k,s=y;var M=t.updateQueue;if(M===null){var R=new Set;R.add(s),t.updateQueue=R}else M.add(s);break e}else{if(!(t&1)){Nj(l,y,t),nM();break e}s=Error(At(426))}}else if(Un&&f.mode&1){var j=$j(h);if(j!==null){!(j.flags&65536)&&(j.flags|=256),Fj(j,h,f,l,t),zO(Np(s,f));break e}}l=s=Np(s,f),Ri!==4&&(Ri=2),ev===null?ev=[l]:ev.push(l),l=h;do{switch(l.tag){case 3:l.flags|=65536,t&=-t,l.lanes|=t;var L=eU(l,s,t);Ij(l,L);break e;case 1:f=s;var z=l.type,B=l.stateNode;if(!(l.flags&128)&&(typeof z.getDerivedStateFromError=="function"||B!==null&&typeof B.componentDidCatch=="function"&&(Pu===null||!Pu.has(B)))){l.flags|=65536,t&=-t,l.lanes|=t;var Z=tU(l,f,t);Ij(l,Z);break e}}l=l.return}while(l!==null)}xU(r)}catch(F){t=F,_i===r&&r!==null&&(_i=r=r.return);continue}break}while(!0)}function vU(){var e=Kb.current;return Kb.current=Hb,e===null?Hb:e}function nM(){(Ri===0||Ri===3||Ri===2)&&(Ri=4),Hi===null||!(vd&268435455)&&!(A1&268435455)||du(Hi,no)}function Yb(e,t){var r=Ur;Ur|=2;var n=vU();(Hi!==e||no!==t)&&(Xl=null,ad(e,t));do try{dX();break}catch(o){yU(e,o)}while(!0);if(NO(),Ur=r,Kb.current=n,_i!==null)throw Error(At(261));return Hi=null,no=0,Ri}function dX(){for(;_i!==null;)_U(_i)}function fX(){for(;_i!==null&&!BK();)_U(_i)}function _U(e){var t=wU(e.alternate,e,xs);e.memoizedProps=e.pendingProps,t===null?xU(e):_i=t,JO.current=null}function xU(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=sX(r,t),r!==null){r.flags&=32767,_i=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Ri=6,_i=null;return}}else if(r=oX(r,t,xs),r!==null){_i=r;return}if(t=t.sibling,t!==null){_i=t;return}_i=t=e}while(t!==null);Ri===0&&(Ri=5)}function $h(e,t,r){var n=pn,o=Js.transition;try{Js.transition=null,pn=1,pX(e,t,r,n)}finally{Js.transition=o,pn=n}return null}function pX(e,t,r,n){do Tp();while(gu!==null);if(Ur&6)throw Error(At(327));r=e.finishedWork;var o=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(At(177));e.callbackNode=null,e.callbackPriority=0;var l=r.lanes|r.childLanes;if(KK(e,l),e===Hi&&(_i=Hi=null,no=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||Mx||(Mx=!0,SU(Ib,function(){return Tp(),null})),l=(r.flags&15990)!==0,r.subtreeFlags&15990||l){l=Js.transition,Js.transition=null;var h=pn;pn=1;var f=Ur;Ur|=4,JO.current=null,lX(e,r),pU(r,e),DZ(wP),Db=!!bP,wP=bP=null,e.current=r,cX(r),NK(),Ur=f,pn=h,Js.transition=l}else e.current=r;if(Mx&&(Mx=!1,gu=e,Xb=o),l=e.pendingLanes,l===0&&(Pu=null),UK(r.stateNode),rs(e,ai()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)o=t[r],n(o.value,{componentStack:o.stack,digest:o.digest});if(Zb)throw Zb=!1,e=UP,UP=null,e;return Xb&1&&e.tag!==0&&Tp(),l=e.pendingLanes,l&1?e===VP?tv++:(tv=0,VP=e):tv=0,Nu(),null}function Tp(){if(gu!==null){var e=Q4(Xb),t=Js.transition,r=pn;try{if(Js.transition=null,pn=16>e?16:e,gu===null)var n=!1;else{if(e=gu,gu=null,Xb=0,Ur&6)throw Error(At(331));var o=Ur;for(Ur|=4,Ht=e.current;Ht!==null;){var l=Ht,h=l.child;if(Ht.flags&16){var f=l.deletions;if(f!==null){for(var s=0;s<f.length;s++){var y=f[s];for(Ht=y;Ht!==null;){var b=Ht;switch(b.tag){case 0:case 11:case 15:Qy(8,b,l)}var w=b.child;if(w!==null)w.return=b,Ht=w;else for(;Ht!==null;){b=Ht;var A=b.sibling,k=b.return;if(hU(b),b===y){Ht=null;break}if(A!==null){A.return=k,Ht=A;break}Ht=k}}}var M=l.alternate;if(M!==null){var R=M.child;if(R!==null){M.child=null;do{var j=R.sibling;R.sibling=null,R=j}while(R!==null)}}Ht=l}}if(l.subtreeFlags&2064&&h!==null)h.return=l,Ht=h;else e:for(;Ht!==null;){if(l=Ht,l.flags&2048)switch(l.tag){case 0:case 11:case 15:Qy(9,l,l.return)}var L=l.sibling;if(L!==null){L.return=l.return,Ht=L;break e}Ht=l.return}}var z=e.current;for(Ht=z;Ht!==null;){h=Ht;var B=h.child;if(h.subtreeFlags&2064&&B!==null)B.return=h,Ht=B;else e:for(h=z;Ht!==null;){if(f=Ht,f.flags&2048)try{switch(f.tag){case 0:case 11:case 15:E1(9,f)}}catch(F){oi(f,f.return,F)}if(f===h){Ht=null;break e}var Z=f.sibling;if(Z!==null){Z.return=f.return,Ht=Z;break e}Ht=f.return}}if(Ur=o,Nu(),vl&&typeof vl.onPostCommitFiberRoot=="function")try{vl.onPostCommitFiberRoot(y1,e)}catch{}n=!0}return n}finally{pn=r,Js.transition=t}}return!1}function ez(e,t,r){t=Np(r,t),t=eU(e,t,1),e=Au(e,t,1),t=jo(),e!==null&&(k_(e,1,t),rs(e,t))}function oi(e,t,r){if(e.tag===3)ez(e,e,r);else for(;t!==null;){if(t.tag===3){ez(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Pu===null||!Pu.has(n))){e=Np(r,e),e=tU(t,e,1),t=Au(t,e,1),e=jo(),t!==null&&(k_(t,1,e),rs(t,e));break}}t=t.return}}function mX(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=jo(),e.pingedLanes|=e.suspendedLanes&r,Hi===e&&(no&r)===r&&(Ri===4||Ri===3&&(no&130023424)===no&&500>ai()-eM?ad(e,0):QO|=r),rs(e,t)}function bU(e,t){t===0&&(e.mode&1?(t=bx,bx<<=1,!(bx&130023424)&&(bx=4194304)):t=1);var r=jo();e=dc(e,t),e!==null&&(k_(e,t,r),rs(e,r))}function gX(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),bU(e,r)}function yX(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,o=e.memoizedState;o!==null&&(r=o.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(At(314))}n!==null&&n.delete(t),bU(e,r)}var wU;wU=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||es.current)Jo=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return Jo=!1,iX(e,t,r);Jo=!!(e.flags&131072)}else Jo=!1,Un&&t.flags&1048576&&E5(t,Fb,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;fb(e,t),e=t.pendingProps;var o=Lp(t,Eo.current);Sp(t,r),o=HO(null,t,n,e,o,r);var l=KO();return t.flags|=1,typeof o=="object"&&o!==null&&typeof o.render=="function"&&o.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,ts(n)?(l=!0,Nb(t)):l=!1,t.memoizedState=o.state!==null&&o.state!==void 0?o.state:null,UO(t),o.updater=S1,t.stateNode=o,o._reactInternals=t,MP(t,n,e,r),t=DP(null,t,n,!0,l,r)):(t.tag=0,Un&&l&&LO(t),Oo(null,t,o,r),t=t.child),t;case 16:n=t.elementType;e:{switch(fb(e,t),e=t.pendingProps,o=n._init,n=o(n._payload),t.type=n,o=t.tag=_X(n),e=Ma(n,e),o){case 0:t=RP(null,t,n,e,r);break e;case 1:t=Gj(null,t,n,e,r);break e;case 11:t=Uj(null,t,n,e,r);break e;case 14:t=Vj(null,t,n,Ma(n.type,e),r);break e}throw Error(At(306,n,""))}return t;case 0:return n=t.type,o=t.pendingProps,o=t.elementType===n?o:Ma(n,o),RP(e,t,n,o,r);case 1:return n=t.type,o=t.pendingProps,o=t.elementType===n?o:Ma(n,o),Gj(e,t,n,o,r);case 3:e:{if(oU(t),e===null)throw Error(At(387));n=t.pendingProps,l=t.memoizedState,o=l.element,k5(e,t),Gb(t,n,null,r);var h=t.memoizedState;if(n=h.element,l.isDehydrated)if(l={element:n,isDehydrated:!1,cache:h.cache,pendingSuspenseBoundaries:h.pendingSuspenseBoundaries,transitions:h.transitions},t.updateQueue.baseState=l,t.memoizedState=l,t.flags&256){o=Np(Error(At(423)),t),t=Wj(e,t,n,r,o);break e}else if(n!==o){o=Np(Error(At(424)),t),t=Wj(e,t,n,r,o);break e}else for(As=Eu(t.stateNode.containerInfo.firstChild),Ps=t,Un=!0,Ba=null,r=R5(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(jp(),n===o){t=fc(e,t,r);break e}Oo(e,t,n,r)}t=t.child}return t;case 5:return D5(t),e===null&&CP(t),n=t.type,o=t.pendingProps,l=e!==null?e.memoizedProps:null,h=o.children,SP(n,o)?h=null:l!==null&&SP(n,l)&&(t.flags|=32),iU(e,t),Oo(e,t,h,r),t.child;case 6:return e===null&&CP(t),null;case 13:return sU(e,t,r);case 4:return VO(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=zp(t,null,n,r):Oo(e,t,n,r),t.child;case 11:return n=t.type,o=t.pendingProps,o=t.elementType===n?o:Ma(n,o),Uj(e,t,n,o,r);case 7:return Oo(e,t,t.pendingProps,r),t.child;case 8:return Oo(e,t,t.pendingProps.children,r),t.child;case 12:return Oo(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,o=t.pendingProps,l=t.memoizedProps,h=o.value,En(Ub,n._currentValue),n._currentValue=h,l!==null)if(Va(l.value,h)){if(l.children===o.children&&!es.current){t=fc(e,t,r);break e}}else for(l=t.child,l!==null&&(l.return=t);l!==null;){var f=l.dependencies;if(f!==null){h=l.child;for(var s=f.firstContext;s!==null;){if(s.context===n){if(l.tag===1){s=ic(-1,r&-r),s.tag=2;var y=l.updateQueue;if(y!==null){y=y.shared;var b=y.pending;b===null?s.next=s:(s.next=b.next,b.next=s),y.pending=s}}l.lanes|=r,s=l.alternate,s!==null&&(s.lanes|=r),kP(l.return,r,t),f.lanes|=r;break}s=s.next}}else if(l.tag===10)h=l.type===t.type?null:l.child;else if(l.tag===18){if(h=l.return,h===null)throw Error(At(341));h.lanes|=r,f=h.alternate,f!==null&&(f.lanes|=r),kP(h,r,t),h=l.sibling}else h=l.child;if(h!==null)h.return=l;else for(h=l;h!==null;){if(h===t){h=null;break}if(l=h.sibling,l!==null){l.return=h.return,h=l;break}h=h.return}l=h}Oo(e,t,o.children,r),t=t.child}return t;case 9:return o=t.type,n=t.pendingProps.children,Sp(t,r),o=ra(o),n=n(o),t.flags|=1,Oo(e,t,n,r),t.child;case 14:return n=t.type,o=Ma(n,t.pendingProps),o=Ma(n.type,o),Vj(e,t,n,o,r);case 15:return rU(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,o=t.pendingProps,o=t.elementType===n?o:Ma(n,o),fb(e,t),t.tag=1,ts(n)?(e=!0,Nb(t)):e=!1,Sp(t,r),M5(t,n,o),MP(t,n,o,r),DP(null,t,n,!0,e,r);case 19:return aU(e,t,r);case 22:return nU(e,t,r)}throw Error(At(156,t.tag))};function SU(e,t){return Z4(e,t)}function vX(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Zs(e,t,r,n){return new vX(e,t,r,n)}function iM(e){return e=e.prototype,!(!e||!e.isReactComponent)}function _X(e){if(typeof e=="function")return iM(e)?1:0;if(e!=null){if(e=e.$$typeof,e===SO)return 11;if(e===TO)return 14}return 2}function ku(e,t){var r=e.alternate;return r===null?(r=Zs(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function gb(e,t,r,n,o,l){var h=2;if(n=e,typeof e=="function")iM(e)&&(h=1);else if(typeof e=="string")h=5;else e:switch(e){case Qf:return ld(r.children,o,l,t);case wO:h=8,o|=8;break;case tP:return e=Zs(12,r,t,o|2),e.elementType=tP,e.lanes=l,e;case rP:return e=Zs(13,r,t,o),e.elementType=rP,e.lanes=l,e;case nP:return e=Zs(19,r,t,o),e.elementType=nP,e.lanes=l,e;case I4:return P1(r,o,l,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case O4:h=10;break e;case M4:h=9;break e;case SO:h=11;break e;case TO:h=14;break e;case au:h=16,n=null;break e}throw Error(At(130,e==null?e:typeof e,""))}return t=Zs(h,r,t,o),t.elementType=e,t.type=n,t.lanes=l,t}function ld(e,t,r,n){return e=Zs(7,e,n,t),e.lanes=r,e}function P1(e,t,r,n){return e=Zs(22,e,n,t),e.elementType=I4,e.lanes=r,e.stateNode={isHidden:!1},e}function NE(e,t,r){return e=Zs(6,e,null,t),e.lanes=r,e}function $E(e,t,r){return t=Zs(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function xX(e,t,r,n,o){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=xE(0),this.expirationTimes=xE(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=xE(0),this.identifierPrefix=n,this.onRecoverableError=o,this.mutableSourceEagerHydrationData=null}function oM(e,t,r,n,o,l,h,f,s){return e=new xX(e,t,r,f,s),t===1?(t=1,l===!0&&(t|=8)):t=0,l=Zs(3,null,null,t),e.current=l,l.stateNode=e,l.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},UO(l),e}function bX(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Jf,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function TU(e){if(!e)return Du;e=e._reactInternals;e:{if(Cd(e)!==e||e.tag!==1)throw Error(At(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(ts(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(At(171))}if(e.tag===1){var r=e.type;if(ts(r))return S5(e,r,t)}return t}function EU(e,t,r,n,o,l,h,f,s){return e=oM(r,n,!0,e,o,l,h,f,s),e.context=TU(null),r=e.current,n=jo(),o=Cu(r),l=ic(n,o),l.callback=t??null,Au(r,l,o),e.current.lanes=o,k_(e,o,n),rs(e,n),e}function C1(e,t,r,n){var o=t.current,l=jo(),h=Cu(o);return r=TU(r),t.context===null?t.context=r:t.pendingContext=r,t=ic(l,h),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=Au(o,t,h),e!==null&&(Ua(e,o,h,l),ub(e,o,h)),h}function Jb(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function tz(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function sM(e,t){tz(e,t),(e=e.alternate)&&tz(e,t)}function wX(){return null}var AU=typeof reportError=="function"?reportError:function(e){console.error(e)};function aM(e){this._internalRoot=e}k1.prototype.render=aM.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(At(409));C1(e,t,null,null)};k1.prototype.unmount=aM.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;_d(function(){C1(null,e,null,null)}),t[hc]=null}};function k1(e){this._internalRoot=e}k1.prototype.unstable_scheduleHydration=function(e){if(e){var t=r5();e={blockedOn:null,target:e,priority:t};for(var r=0;r<hu.length&&t!==0&&t<hu[r].priority;r++);hu.splice(r,0,e),r===0&&i5(e)}};function lM(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function O1(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function rz(){}function SX(e,t,r,n,o){if(o){if(typeof n=="function"){var l=n;n=function(){var y=Jb(h);l.call(y)}}var h=EU(t,n,e,0,null,!1,!1,"",rz);return e._reactRootContainer=h,e[hc]=h.current,Tv(e.nodeType===8?e.parentNode:e),_d(),h}for(;o=e.lastChild;)e.removeChild(o);if(typeof n=="function"){var f=n;n=function(){var y=Jb(s);f.call(y)}}var s=oM(e,0,!1,null,null,!1,!1,"",rz);return e._reactRootContainer=s,e[hc]=s.current,Tv(e.nodeType===8?e.parentNode:e),_d(function(){C1(t,s,r,n)}),s}function M1(e,t,r,n,o){var l=r._reactRootContainer;if(l){var h=l;if(typeof o=="function"){var f=o;o=function(){var s=Jb(h);f.call(s)}}C1(t,h,e,o)}else h=SX(r,t,e,o,n);return Jb(h)}e5=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=$y(t.pendingLanes);r!==0&&(PO(t,r|1),rs(t,ai()),!(Ur&6)&&($p=ai()+500,Nu()))}break;case 13:_d(function(){var n=dc(e,1);if(n!==null){var o=jo();Ua(n,e,1,o)}}),sM(e,1)}};CO=function(e){if(e.tag===13){var t=dc(e,134217728);if(t!==null){var r=jo();Ua(t,e,134217728,r)}sM(e,134217728)}};t5=function(e){if(e.tag===13){var t=Cu(e),r=dc(e,t);if(r!==null){var n=jo();Ua(r,e,t,n)}sM(e,t)}};r5=function(){return pn};n5=function(e,t){var r=pn;try{return pn=e,t()}finally{pn=r}};fP=function(e,t,r){switch(t){case"input":if(sP(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var o=b1(n);if(!o)throw Error(At(90));D4(n),sP(n,o)}}}break;case"textarea":j4(e,r);break;case"select":t=r.value,t!=null&&_p(e,!!r.multiple,t,!1)}};V4=tM;G4=_d;var TX={usingClientEntryPoint:!1,Events:[M_,np,b1,F4,U4,tM]},by={findFiberByHostInstance:Zh,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},EX={bundleType:by.bundleType,version:by.version,rendererPackageName:by.rendererPackageName,rendererConfig:by.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:_c.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=H4(e),e===null?null:e.stateNode},findFiberByHostInstance:by.findFiberByHostInstance||wX,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ix=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ix.isDisabled&&Ix.supportsFiber)try{y1=Ix.inject(EX),vl=Ix}catch{}}ks.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=TX;ks.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!lM(t))throw Error(At(200));return bX(e,t,null,r)};ks.createRoot=function(e,t){if(!lM(e))throw Error(At(299));var r=!1,n="",o=AU;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(o=t.onRecoverableError)),t=oM(e,1,!1,null,null,r,!1,n,o),e[hc]=t.current,Tv(e.nodeType===8?e.parentNode:e),new aM(t)};ks.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(At(188)):(e=Object.keys(e).join(","),Error(At(268,e)));return e=H4(t),e=e===null?null:e.stateNode,e};ks.flushSync=function(e){return _d(e)};ks.hydrate=function(e,t,r){if(!O1(t))throw Error(At(200));return M1(null,e,t,!0,r)};ks.hydrateRoot=function(e,t,r){if(!lM(e))throw Error(At(405));var n=r!=null&&r.hydratedSources||null,o=!1,l="",h=AU;if(r!=null&&(r.unstable_strictMode===!0&&(o=!0),r.identifierPrefix!==void 0&&(l=r.identifierPrefix),r.onRecoverableError!==void 0&&(h=r.onRecoverableError)),t=EU(t,null,e,1,r??null,o,!1,l,h),e[hc]=t.current,Tv(e),n)for(e=0;e<n.length;e++)r=n[e],o=r._getVersion,o=o(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,o]:t.mutableSourceEagerHydrationData.push(r,o);return new k1(t)};ks.render=function(e,t,r){if(!O1(t))throw Error(At(200));return M1(null,e,t,!1,r)};ks.unmountComponentAtNode=function(e){if(!O1(e))throw Error(At(40));return e._reactRootContainer?(_d(function(){M1(null,null,e,!1,function(){e._reactRootContainer=null,e[hc]=null})}),!0):!1};ks.unstable_batchedUpdates=tM;ks.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!O1(r))throw Error(At(200));if(e==null||e._reactInternals===void 0)throw Error(At(38));return M1(e,t,r,!1,n)};ks.version="18.2.0-next-9e3b772b8-20220608";function PU(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(PU)}catch(e){console.error(e)}}PU(),E4.exports=ks;var cM=E4.exports,nz=cM;QA.createRoot=nz.createRoot,QA.hydrateRoot=nz.hydrateRoot;/**
 * @remix-run/router v1.23.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Rv(){return Rv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Rv.apply(this,arguments)}var yu;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(yu||(yu={}));const iz="popstate";function AX(e){e===void 0&&(e={});function t(n,o){let{pathname:l,search:h,hash:f}=n.location;return qP("",{pathname:l,search:h,hash:f},o.state&&o.state.usr||null,o.state&&o.state.key||"default")}function r(n,o){return typeof o=="string"?o:Qb(o)}return CX(t,r,null,e)}function ci(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function uM(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function PX(){return Math.random().toString(36).substr(2,8)}function oz(e,t){return{usr:e.state,key:e.key,idx:t}}function qP(e,t,r,n){return r===void 0&&(r=null),Rv({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?_m(t):t,{state:r,key:t&&t.key||n||PX()})}function Qb(e){let{pathname:t="/",search:r="",hash:n=""}=e;return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function _m(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}function CX(e,t,r,n){n===void 0&&(n={});let{window:o=document.defaultView,v5Compat:l=!1}=n,h=o.history,f=yu.Pop,s=null,y=b();y==null&&(y=0,h.replaceState(Rv({},h.state,{idx:y}),""));function b(){return(h.state||{idx:null}).idx}function w(){f=yu.Pop;let j=b(),L=j==null?null:j-y;y=j,s&&s({action:f,location:R.location,delta:L})}function A(j,L){f=yu.Push;let z=qP(R.location,j,L);y=b()+1;let B=oz(z,y),Z=R.createHref(z);try{h.pushState(B,"",Z)}catch(F){if(F instanceof DOMException&&F.name==="DataCloneError")throw F;o.location.assign(Z)}l&&s&&s({action:f,location:R.location,delta:1})}function k(j,L){f=yu.Replace;let z=qP(R.location,j,L);y=b();let B=oz(z,y),Z=R.createHref(z);h.replaceState(B,"",Z),l&&s&&s({action:f,location:R.location,delta:0})}function M(j){let L=o.location.origin!=="null"?o.location.origin:o.location.href,z=typeof j=="string"?j:Qb(j);return z=z.replace(/ $/,"%20"),ci(L,"No window.location.(origin|href) available to create URL for href: "+z),new URL(z,L)}let R={get action(){return f},get location(){return e(o,h)},listen(j){if(s)throw new Error("A history only accepts one active listener");return o.addEventListener(iz,w),s=j,()=>{o.removeEventListener(iz,w),s=null}},createHref(j){return t(o,j)},createURL:M,encodeLocation(j){let L=M(j);return{pathname:L.pathname,search:L.search,hash:L.hash}},push:A,replace:k,go(j){return h.go(j)}};return R}var sz;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(sz||(sz={}));function kX(e,t,r){return r===void 0&&(r="/"),OX(e,t,r)}function OX(e,t,r,n){let o=typeof t=="string"?_m(t):t,l=hM(o.pathname||"/",r);if(l==null)return null;let h=CU(e);MX(h);let f=null;for(let s=0;f==null&&s<h.length;++s){let y=VX(l);f=$X(h[s],y)}return f}function CU(e,t,r,n){t===void 0&&(t=[]),r===void 0&&(r=[]),n===void 0&&(n="");let o=(l,h,f)=>{let s={relativePath:f===void 0?l.path||"":f,caseSensitive:l.caseSensitive===!0,childrenIndex:h,route:l};s.relativePath.startsWith("/")&&(ci(s.relativePath.startsWith(n),'Absolute route path "'+s.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),s.relativePath=s.relativePath.slice(n.length));let y=Ou([n,s.relativePath]),b=r.concat(s);l.children&&l.children.length>0&&(ci(l.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+y+'".')),CU(l.children,t,b,y)),!(l.path==null&&!l.index)&&t.push({path:y,score:BX(y,l.index),routesMeta:b})};return e.forEach((l,h)=>{var f;if(l.path===""||!((f=l.path)!=null&&f.includes("?")))o(l,h);else for(let s of kU(l.path))o(l,h,s)}),t}function kU(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,o=r.endsWith("?"),l=r.replace(/\?$/,"");if(n.length===0)return o?[l,""]:[l];let h=kU(n.join("/")),f=[];return f.push(...h.map(s=>s===""?l:[l,s].join("/"))),o&&f.push(...h),f.map(s=>e.startsWith("/")&&s===""?"/":s)}function MX(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:NX(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const IX=/^:[\w-]+$/,RX=3,DX=2,LX=1,jX=10,zX=-2,az=e=>e==="*";function BX(e,t){let r=e.split("/"),n=r.length;return r.some(az)&&(n+=zX),t&&(n+=DX),r.filter(o=>!az(o)).reduce((o,l)=>o+(IX.test(l)?RX:l===""?LX:jX),n)}function NX(e,t){return e.length===t.length&&e.slice(0,-1).every((n,o)=>n===t[o])?e[e.length-1]-t[t.length-1]:0}function $X(e,t,r){let{routesMeta:n}=e,o={},l="/",h=[];for(let f=0;f<n.length;++f){let s=n[f],y=f===n.length-1,b=l==="/"?t:t.slice(l.length)||"/",w=FX({path:s.relativePath,caseSensitive:s.caseSensitive,end:y},b),A=s.route;if(!w)return null;Object.assign(o,w.params),h.push({params:o,pathname:Ou([l,w.pathname]),pathnameBase:KX(Ou([l,w.pathnameBase])),route:A}),w.pathnameBase!=="/"&&(l=Ou([l,w.pathnameBase]))}return h}function FX(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=UX(e.path,e.caseSensitive,e.end),o=t.match(r);if(!o)return null;let l=o[0],h=l.replace(/(.)\/+$/,"$1"),f=o.slice(1);return{params:n.reduce((y,b,w)=>{let{paramName:A,isOptional:k}=b;if(A==="*"){let R=f[w]||"";h=l.slice(0,l.length-R.length).replace(/(.)\/+$/,"$1")}const M=f[w];return k&&!M?y[A]=void 0:y[A]=(M||"").replace(/%2F/g,"/"),y},{}),pathname:l,pathnameBase:h,pattern:e}}function UX(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!0),uM(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let n=[],o="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(h,f,s)=>(n.push({paramName:f,isOptional:s!=null}),s?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(n.push({paramName:"*"}),o+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?o+="\\/*$":e!==""&&e!=="/"&&(o+="(?:(?=\\/|$))"),[new RegExp(o,t?void 0:"i"),n]}function VX(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return uM(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function hM(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}const GX=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,WX=e=>GX.test(e);function qX(e,t){t===void 0&&(t="/");let{pathname:r,search:n="",hash:o=""}=typeof e=="string"?_m(e):e,l;if(r)if(WX(r))l=r;else{if(r.includes("//")){let h=r;r=r.replace(/\/\/+/g,"/"),uM(!1,"Pathnames cannot have embedded double slashes - normalizing "+(h+" -> "+r))}r.startsWith("/")?l=lz(r.substring(1),"/"):l=lz(r,t)}else l=t;return{pathname:l,search:ZX(n),hash:XX(o)}}function lz(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(o=>{o===".."?r.length>1&&r.pop():o!=="."&&r.push(o)}),r.length>1?r.join("/"):"/"}function FE(e,t,r,n){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function HX(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function dM(e,t){let r=HX(e);return t?r.map((n,o)=>o===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function fM(e,t,r,n){n===void 0&&(n=!1);let o;typeof e=="string"?o=_m(e):(o=Rv({},e),ci(!o.pathname||!o.pathname.includes("?"),FE("?","pathname","search",o)),ci(!o.pathname||!o.pathname.includes("#"),FE("#","pathname","hash",o)),ci(!o.search||!o.search.includes("#"),FE("#","search","hash",o)));let l=e===""||o.pathname==="",h=l?"/":o.pathname,f;if(h==null)f=r;else{let w=t.length-1;if(!n&&h.startsWith("..")){let A=h.split("/");for(;A[0]==="..";)A.shift(),w-=1;o.pathname=A.join("/")}f=w>=0?t[w]:"/"}let s=qX(o,f),y=h&&h!=="/"&&h.endsWith("/"),b=(l||h===".")&&r.endsWith("/");return!s.pathname.endsWith("/")&&(y||b)&&(s.pathname+="/"),s}const Ou=e=>e.join("/").replace(/\/\/+/g,"/"),KX=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),ZX=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,XX=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function YX(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const OU=["post","put","patch","delete"];new Set(OU);const JX=["get",...OU];new Set(JX);/**
 * React Router v6.30.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Dv(){return Dv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Dv.apply(this,arguments)}const pM=re.createContext(null),QX=re.createContext(null),$u=re.createContext(null),I1=re.createContext(null),xc=re.createContext({outlet:null,matches:[],isDataRoute:!1}),MU=re.createContext(null);function eY(e,t){let{relative:r}=t===void 0?{}:t;xm()||ci(!1);let{basename:n,navigator:o}=re.useContext($u),{hash:l,pathname:h,search:f}=RU(e,{relative:r}),s=h;return n!=="/"&&(s=h==="/"?n:Ou([n,h])),o.createHref({pathname:s,search:f,hash:l})}function xm(){return re.useContext(I1)!=null}function kd(){return xm()||ci(!1),re.useContext(I1).location}function IU(e){re.useContext($u).static||re.useLayoutEffect(e)}function Fu(){let{isDataRoute:e}=re.useContext(xc);return e?pY():tY()}function tY(){xm()||ci(!1);let e=re.useContext(pM),{basename:t,future:r,navigator:n}=re.useContext($u),{matches:o}=re.useContext(xc),{pathname:l}=kd(),h=JSON.stringify(dM(o,r.v7_relativeSplatPath)),f=re.useRef(!1);return IU(()=>{f.current=!0}),re.useCallback(function(y,b){if(b===void 0&&(b={}),!f.current)return;if(typeof y=="number"){n.go(y);return}let w=fM(y,JSON.parse(h),l,b.relative==="path");e==null&&t!=="/"&&(w.pathname=w.pathname==="/"?t:Ou([t,w.pathname])),(b.replace?n.replace:n.push)(w,b.state,b)},[t,n,h,l,e])}function rY(){let{matches:e}=re.useContext(xc),t=e[e.length-1];return t?t.params:{}}function RU(e,t){let{relative:r}=t===void 0?{}:t,{future:n}=re.useContext($u),{matches:o}=re.useContext(xc),{pathname:l}=kd(),h=JSON.stringify(dM(o,n.v7_relativeSplatPath));return re.useMemo(()=>fM(e,JSON.parse(h),l,r==="path"),[e,h,l,r])}function nY(e,t){return iY(e,t)}function iY(e,t,r,n){xm()||ci(!1);let{navigator:o}=re.useContext($u),{matches:l}=re.useContext(xc),h=l[l.length-1],f=h?h.params:{};h&&h.pathname;let s=h?h.pathnameBase:"/";h&&h.route;let y=kd(),b;if(t){var w;let j=typeof t=="string"?_m(t):t;s==="/"||(w=j.pathname)!=null&&w.startsWith(s)||ci(!1),b=j}else b=y;let A=b.pathname||"/",k=A;if(s!=="/"){let j=s.replace(/^\//,"").split("/");k="/"+A.replace(/^\//,"").split("/").slice(j.length).join("/")}let M=kX(e,{pathname:k}),R=cY(M&&M.map(j=>Object.assign({},j,{params:Object.assign({},f,j.params),pathname:Ou([s,o.encodeLocation?o.encodeLocation(j.pathname).pathname:j.pathname]),pathnameBase:j.pathnameBase==="/"?s:Ou([s,o.encodeLocation?o.encodeLocation(j.pathnameBase).pathname:j.pathnameBase])})),l,r,n);return t&&R?re.createElement(I1.Provider,{value:{location:Dv({pathname:"/",search:"",hash:"",state:null,key:"default"},b),navigationType:yu.Pop}},R):R}function oY(){let e=fY(),t=YX(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,o={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return re.createElement(re.Fragment,null,re.createElement("h2",null,"Unexpected Application Error!"),re.createElement("h3",{style:{fontStyle:"italic"}},t),r?re.createElement("pre",{style:o},r):null,null)}const sY=re.createElement(oY,null);class aY extends re.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,r){return r.location!==t.location||r.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:r.error,location:r.location,revalidation:t.revalidation||r.revalidation}}componentDidCatch(t,r){console.error("React Router caught the following error during render",t,r)}render(){return this.state.error!==void 0?re.createElement(xc.Provider,{value:this.props.routeContext},re.createElement(MU.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function lY(e){let{routeContext:t,match:r,children:n}=e,o=re.useContext(pM);return o&&o.static&&o.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(o.staticContext._deepestRenderedBoundaryId=r.route.id),re.createElement(xc.Provider,{value:t},n)}function cY(e,t,r,n){var o;if(t===void 0&&(t=[]),r===void 0&&(r=null),n===void 0&&(n=null),e==null){var l;if(!r)return null;if(r.errors)e=r.matches;else if((l=n)!=null&&l.v7_partialHydration&&t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let h=e,f=(o=r)==null?void 0:o.errors;if(f!=null){let b=h.findIndex(w=>w.route.id&&(f==null?void 0:f[w.route.id])!==void 0);b>=0||ci(!1),h=h.slice(0,Math.min(h.length,b+1))}let s=!1,y=-1;if(r&&n&&n.v7_partialHydration)for(let b=0;b<h.length;b++){let w=h[b];if((w.route.HydrateFallback||w.route.hydrateFallbackElement)&&(y=b),w.route.id){let{loaderData:A,errors:k}=r,M=w.route.loader&&A[w.route.id]===void 0&&(!k||k[w.route.id]===void 0);if(w.route.lazy||M){s=!0,y>=0?h=h.slice(0,y+1):h=[h[0]];break}}}return h.reduceRight((b,w,A)=>{let k,M=!1,R=null,j=null;r&&(k=f&&w.route.id?f[w.route.id]:void 0,R=w.route.errorElement||sY,s&&(y<0&&A===0?(mY("route-fallback"),M=!0,j=null):y===A&&(M=!0,j=w.route.hydrateFallbackElement||null)));let L=t.concat(h.slice(0,A+1)),z=()=>{let B;return k?B=R:M?B=j:w.route.Component?B=re.createElement(w.route.Component,null):w.route.element?B=w.route.element:B=b,re.createElement(lY,{match:w,routeContext:{outlet:b,matches:L,isDataRoute:r!=null},children:B})};return r&&(w.route.ErrorBoundary||w.route.errorElement||A===0)?re.createElement(aY,{location:r.location,revalidation:r.revalidation,component:R,error:k,children:z(),routeContext:{outlet:null,matches:L,isDataRoute:!0}}):z()},null)}var DU=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(DU||{}),LU=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(LU||{});function uY(e){let t=re.useContext(pM);return t||ci(!1),t}function hY(e){let t=re.useContext(QX);return t||ci(!1),t}function dY(e){let t=re.useContext(xc);return t||ci(!1),t}function jU(e){let t=dY(),r=t.matches[t.matches.length-1];return r.route.id||ci(!1),r.route.id}function fY(){var e;let t=re.useContext(MU),r=hY(),n=jU();return t!==void 0?t:(e=r.errors)==null?void 0:e[n]}function pY(){let{router:e}=uY(DU.UseNavigateStable),t=jU(LU.UseNavigateStable),r=re.useRef(!1);return IU(()=>{r.current=!0}),re.useCallback(function(o,l){l===void 0&&(l={}),r.current&&(typeof o=="number"?e.navigate(o):e.navigate(o,Dv({fromRouteId:t},l)))},[e,t])}const cz={};function mY(e,t,r){cz[e]||(cz[e]=!0)}function gY(e,t){e==null||e.v7_startTransition,e==null||e.v7_relativeSplatPath}function qh(e){let{to:t,replace:r,state:n,relative:o}=e;xm()||ci(!1);let{future:l,static:h}=re.useContext($u),{matches:f}=re.useContext(xc),{pathname:s}=kd(),y=Fu(),b=fM(t,dM(f,l.v7_relativeSplatPath),s,o==="path"),w=JSON.stringify(b);return re.useEffect(()=>y(JSON.parse(w),{replace:r,state:n,relative:o}),[y,w,o,r,n]),null}function Pa(e){ci(!1)}function yY(e){let{basename:t="/",children:r=null,location:n,navigationType:o=yu.Pop,navigator:l,static:h=!1,future:f}=e;xm()&&ci(!1);let s=t.replace(/^\/*/,"/"),y=re.useMemo(()=>({basename:s,navigator:l,static:h,future:Dv({v7_relativeSplatPath:!1},f)}),[s,f,l,h]);typeof n=="string"&&(n=_m(n));let{pathname:b="/",search:w="",hash:A="",state:k=null,key:M="default"}=n,R=re.useMemo(()=>{let j=hM(b,s);return j==null?null:{location:{pathname:j,search:w,hash:A,state:k,key:M},navigationType:o}},[s,b,w,A,k,M,o]);return R==null?null:re.createElement($u.Provider,{value:y},re.createElement(I1.Provider,{children:r,value:R}))}function vY(e){let{children:t,location:r}=e;return nY(HP(t),r)}new Promise(()=>{});function HP(e,t){t===void 0&&(t=[]);let r=[];return re.Children.forEach(e,(n,o)=>{if(!re.isValidElement(n))return;let l=[...t,o];if(n.type===re.Fragment){r.push.apply(r,HP(n.props.children,l));return}n.type!==Pa&&ci(!1),!n.props.index||!n.props.children||ci(!1);let h={id:n.props.id||l.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(h.children=HP(n.props.children,l)),r.push(h)}),r}/**
 * React Router DOM v6.30.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function KP(){return KP=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},KP.apply(this,arguments)}function _Y(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,l;for(l=0;l<n.length;l++)o=n[l],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function xY(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function bY(e,t){return e.button===0&&(!t||t==="_self")&&!xY(e)}const wY=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],SY="6";try{window.__reactRouterVersion=SY}catch{}const TY="startTransition",uz=gK[TY];function EY(e){let{basename:t,children:r,future:n,window:o}=e,l=re.useRef();l.current==null&&(l.current=AX({window:o,v5Compat:!0}));let h=l.current,[f,s]=re.useState({action:h.action,location:h.location}),{v7_startTransition:y}=n||{},b=re.useCallback(w=>{y&&uz?uz(()=>s(w)):s(w)},[s,y]);return re.useLayoutEffect(()=>h.listen(b),[h,b]),re.useEffect(()=>gY(n),[n]),re.createElement(yY,{basename:t,children:r,location:f.location,navigationType:f.action,navigator:h,future:n})}const AY=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",PY=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Qs=re.forwardRef(function(t,r){let{onClick:n,relative:o,reloadDocument:l,replace:h,state:f,target:s,to:y,preventScrollReset:b,viewTransition:w}=t,A=_Y(t,wY),{basename:k}=re.useContext($u),M,R=!1;if(typeof y=="string"&&PY.test(y)&&(M=y,AY))try{let B=new URL(window.location.href),Z=y.startsWith("//")?new URL(B.protocol+y):new URL(y),F=hM(Z.pathname,k);Z.origin===B.origin&&F!=null?y=F+Z.search+Z.hash:R=!0}catch{}let j=eY(y,{relative:o}),L=CY(y,{replace:h,state:f,target:s,preventScrollReset:b,relative:o,viewTransition:w});function z(B){n&&n(B),B.defaultPrevented||L(B)}return re.createElement("a",KP({},A,{href:M||j,onClick:R||l?n:z,ref:r,target:s}))});var hz;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(hz||(hz={}));var dz;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(dz||(dz={}));function CY(e,t){let{target:r,replace:n,state:o,preventScrollReset:l,relative:h,viewTransition:f}=t===void 0?{}:t,s=Fu(),y=kd(),b=RU(e,{relative:h});return re.useCallback(w=>{if(bY(w,r)){w.preventDefault();let A=n!==void 0?n:Qb(y)===Qb(b);s(e,{replace:A,state:o,preventScrollReset:l,relative:h,viewTransition:f})}},[y,s,b,n,o,r,e,l,h,f])}const kY={},fz=e=>{let t;const r=new Set,n=(b,w)=>{const A=typeof b=="function"?b(t):b;if(!Object.is(A,t)){const k=t;t=w??(typeof A!="object"||A===null)?A:Object.assign({},t,A),r.forEach(M=>M(t,k))}},o=()=>t,s={setState:n,getState:o,getInitialState:()=>y,subscribe:b=>(r.add(b),()=>r.delete(b)),destroy:()=>{(kY?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),r.clear()}},y=t=e(n,o,s);return s},OY=e=>e?fz(e):fz;var zU={exports:{}},BU={},NU={exports:{}},$U={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Fp=re;function MY(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var IY=typeof Object.is=="function"?Object.is:MY,RY=Fp.useState,DY=Fp.useEffect,LY=Fp.useLayoutEffect,jY=Fp.useDebugValue;function zY(e,t){var r=t(),n=RY({inst:{value:r,getSnapshot:t}}),o=n[0].inst,l=n[1];return LY(function(){o.value=r,o.getSnapshot=t,UE(o)&&l({inst:o})},[e,r,t]),DY(function(){return UE(o)&&l({inst:o}),e(function(){UE(o)&&l({inst:o})})},[e]),jY(r),r}function UE(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!IY(e,r)}catch{return!0}}function BY(e,t){return t()}var NY=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?BY:zY;$U.useSyncExternalStore=Fp.useSyncExternalStore!==void 0?Fp.useSyncExternalStore:NY;NU.exports=$U;var $Y=NU.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var R1=re,FY=$Y;function UY(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var VY=typeof Object.is=="function"?Object.is:UY,GY=FY.useSyncExternalStore,WY=R1.useRef,qY=R1.useEffect,HY=R1.useMemo,KY=R1.useDebugValue;BU.useSyncExternalStoreWithSelector=function(e,t,r,n,o){var l=WY(null);if(l.current===null){var h={hasValue:!1,value:null};l.current=h}else h=l.current;l=HY(function(){function s(k){if(!y){if(y=!0,b=k,k=n(k),o!==void 0&&h.hasValue){var M=h.value;if(o(M,k))return w=M}return w=k}if(M=w,VY(b,k))return M;var R=n(k);return o!==void 0&&o(M,R)?(b=k,M):(b=k,w=R)}var y=!1,b,w,A=r===void 0?null:r;return[function(){return s(t())},A===null?void 0:function(){return s(A())}]},[t,r,n,o]);var f=GY(e,l[0],l[1]);return qY(function(){h.hasValue=!0,h.value=f},[f]),KY(f),f};zU.exports=BU;var ZY=zU.exports;const XY=mn(ZY),FU={},{useDebugValue:YY}=Ce,{useSyncExternalStoreWithSelector:JY}=XY;let pz=!1;const QY=e=>e;function e2(e,t=QY,r){(FU?"production":void 0)!=="production"&&r&&!pz&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),pz=!0);const n=JY(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,r);return YY(n),n}const mz=e=>{(FU?"production":void 0)!=="production"&&typeof e!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const t=typeof e=="function"?OY(e):e,r=(n,o)=>e2(t,n,o);return Object.assign(r,t),r},UU=e=>e?mz(e):mz;function VU(e,t){return function(){return e.apply(t,arguments)}}const{toString:t2}=Object.prototype,{getPrototypeOf:mM}=Object,{iterator:D1,toStringTag:GU}=Symbol,L1=(e=>t=>{const r=t2.call(t);return e[r]||(e[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),Wa=e=>(e=e.toLowerCase(),t=>L1(t)===e),j1=e=>t=>typeof t===e,{isArray:bm}=Array,Up=j1("undefined");function R_(e){return e!==null&&!Up(e)&&e.constructor!==null&&!Up(e.constructor)&&ns(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const WU=Wa("ArrayBuffer");function r2(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&WU(e.buffer),t}const n2=j1("string"),ns=j1("function"),qU=j1("number"),D_=e=>e!==null&&typeof e=="object",i2=e=>e===!0||e===!1,yb=e=>{if(L1(e)!=="object")return!1;const t=mM(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(GU in e)&&!(D1 in e)},o2=e=>{if(!D_(e)||R_(e))return!1;try{return Object.keys(e).length===0&&Object.getPrototypeOf(e)===Object.prototype}catch{return!1}},s2=Wa("Date"),a2=Wa("File"),l2=Wa("Blob"),c2=Wa("FileList"),u2=e=>D_(e)&&ns(e.pipe),h2=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||ns(e.append)&&((t=L1(e))==="formdata"||t==="object"&&ns(e.toString)&&e.toString()==="[object FormData]"))},d2=Wa("URLSearchParams"),[f2,p2,m2,g2]=["ReadableStream","Request","Response","Headers"].map(Wa),y2=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function L_(e,t,{allOwnKeys:r=!1}={}){if(e===null||typeof e>"u")return;let n,o;if(typeof e!="object"&&(e=[e]),bm(e))for(n=0,o=e.length;n<o;n++)t.call(null,e[n],n,e);else{if(R_(e))return;const l=r?Object.getOwnPropertyNames(e):Object.keys(e),h=l.length;let f;for(n=0;n<h;n++)f=l[n],t.call(null,e[f],f,e)}}function HU(e,t){if(R_(e))return null;t=t.toLowerCase();const r=Object.keys(e);let n=r.length,o;for(;n-- >0;)if(o=r[n],t===o.toLowerCase())return o;return null}const Jh=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,KU=e=>!Up(e)&&e!==Jh;function ZP(){const{caseless:e,skipUndefined:t}=KU(this)&&this||{},r={},n=(o,l)=>{const h=e&&HU(r,l)||l;yb(r[h])&&yb(o)?r[h]=ZP(r[h],o):yb(o)?r[h]=ZP({},o):bm(o)?r[h]=o.slice():(!t||!Up(o))&&(r[h]=o)};for(let o=0,l=arguments.length;o<l;o++)arguments[o]&&L_(arguments[o],n);return r}const v2=(e,t,r,{allOwnKeys:n}={})=>(L_(t,(o,l)=>{r&&ns(o)?e[l]=VU(o,r):e[l]=o},{allOwnKeys:n}),e),_2=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),x2=(e,t,r,n)=>{e.prototype=Object.create(t.prototype,n),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),r&&Object.assign(e.prototype,r)},b2=(e,t,r,n)=>{let o,l,h;const f={};if(t=t||{},e==null)return t;do{for(o=Object.getOwnPropertyNames(e),l=o.length;l-- >0;)h=o[l],(!n||n(h,e,t))&&!f[h]&&(t[h]=e[h],f[h]=!0);e=r!==!1&&mM(e)}while(e&&(!r||r(e,t))&&e!==Object.prototype);return t},w2=(e,t,r)=>{e=String(e),(r===void 0||r>e.length)&&(r=e.length),r-=t.length;const n=e.indexOf(t,r);return n!==-1&&n===r},S2=e=>{if(!e)return null;if(bm(e))return e;let t=e.length;if(!qU(t))return null;const r=new Array(t);for(;t-- >0;)r[t]=e[t];return r},T2=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&mM(Uint8Array)),E2=(e,t)=>{const n=(e&&e[D1]).call(e);let o;for(;(o=n.next())&&!o.done;){const l=o.value;t.call(e,l[0],l[1])}},A2=(e,t)=>{let r;const n=[];for(;(r=e.exec(t))!==null;)n.push(r);return n},P2=Wa("HTMLFormElement"),C2=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(r,n,o){return n.toUpperCase()+o}),gz=(({hasOwnProperty:e})=>(t,r)=>e.call(t,r))(Object.prototype),k2=Wa("RegExp"),ZU=(e,t)=>{const r=Object.getOwnPropertyDescriptors(e),n={};L_(r,(o,l)=>{let h;(h=t(o,l,e))!==!1&&(n[l]=h||o)}),Object.defineProperties(e,n)},O2=e=>{ZU(e,(t,r)=>{if(ns(e)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;const n=e[r];if(ns(n)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")})}})},M2=(e,t)=>{const r={},n=o=>{o.forEach(l=>{r[l]=!0})};return bm(e)?n(e):n(String(e).split(t)),r},I2=()=>{},R2=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function D2(e){return!!(e&&ns(e.append)&&e[GU]==="FormData"&&e[D1])}const L2=e=>{const t=new Array(10),r=(n,o)=>{if(D_(n)){if(t.indexOf(n)>=0)return;if(R_(n))return n;if(!("toJSON"in n)){t[o]=n;const l=bm(n)?[]:{};return L_(n,(h,f)=>{const s=r(h,o+1);!Up(s)&&(l[f]=s)}),t[o]=void 0,l}}return n};return r(e,0)},j2=Wa("AsyncFunction"),z2=e=>e&&(D_(e)||ns(e))&&ns(e.then)&&ns(e.catch),XU=((e,t)=>e?setImmediate:t?((r,n)=>(Jh.addEventListener("message",({source:o,data:l})=>{o===Jh&&l===r&&n.length&&n.shift()()},!1),o=>{n.push(o),Jh.postMessage(r,"*")}))(`axios@${Math.random()}`,[]):r=>setTimeout(r))(typeof setImmediate=="function",ns(Jh.postMessage)),B2=typeof queueMicrotask<"u"?queueMicrotask.bind(Jh):typeof process<"u"&&process.nextTick||XU,N2=e=>e!=null&&ns(e[D1]),et={isArray:bm,isArrayBuffer:WU,isBuffer:R_,isFormData:h2,isArrayBufferView:r2,isString:n2,isNumber:qU,isBoolean:i2,isObject:D_,isPlainObject:yb,isEmptyObject:o2,isReadableStream:f2,isRequest:p2,isResponse:m2,isHeaders:g2,isUndefined:Up,isDate:s2,isFile:a2,isBlob:l2,isRegExp:k2,isFunction:ns,isStream:u2,isURLSearchParams:d2,isTypedArray:T2,isFileList:c2,forEach:L_,merge:ZP,extend:v2,trim:y2,stripBOM:_2,inherits:x2,toFlatObject:b2,kindOf:L1,kindOfTest:Wa,endsWith:w2,toArray:S2,forEachEntry:E2,matchAll:A2,isHTMLForm:P2,hasOwnProperty:gz,hasOwnProp:gz,reduceDescriptors:ZU,freezeMethods:O2,toObjectSet:M2,toCamelCase:C2,noop:I2,toFiniteNumber:R2,findKey:HU,global:Jh,isContextDefined:KU,isSpecCompliantForm:D2,toJSONObject:L2,isAsyncFn:j2,isThenable:z2,setImmediate:XU,asap:B2,isIterable:N2};function Pr(e,t,r,n,o){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),r&&(this.config=r),n&&(this.request=n),o&&(this.response=o,this.status=o.status?o.status:null)}et.inherits(Pr,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:et.toJSONObject(this.config),code:this.code,status:this.status}}});const YU=Pr.prototype,JU={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{JU[e]={value:e}});Object.defineProperties(Pr,JU);Object.defineProperty(YU,"isAxiosError",{value:!0});Pr.from=(e,t,r,n,o,l)=>{const h=Object.create(YU);et.toFlatObject(e,h,function(b){return b!==Error.prototype},y=>y!=="isAxiosError");const f=e&&e.message?e.message:"Error",s=t==null&&e?e.code:t;return Pr.call(h,f,s,r,n,o),e&&h.cause==null&&Object.defineProperty(h,"cause",{value:e,configurable:!0}),h.name=e&&e.name||"Error",l&&Object.assign(h,l),h};const $2=null;function XP(e){return et.isPlainObject(e)||et.isArray(e)}function QU(e){return et.endsWith(e,"[]")?e.slice(0,-2):e}function yz(e,t,r){return e?e.concat(t).map(function(o,l){return o=QU(o),!r&&l?"["+o+"]":o}).join(r?".":""):t}function F2(e){return et.isArray(e)&&!e.some(XP)}const U2=et.toFlatObject(et,{},null,function(t){return/^is[A-Z]/.test(t)});function z1(e,t,r){if(!et.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,r=et.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(R,j){return!et.isUndefined(j[R])});const n=r.metaTokens,o=r.visitor||b,l=r.dots,h=r.indexes,s=(r.Blob||typeof Blob<"u"&&Blob)&&et.isSpecCompliantForm(t);if(!et.isFunction(o))throw new TypeError("visitor must be a function");function y(M){if(M===null)return"";if(et.isDate(M))return M.toISOString();if(et.isBoolean(M))return M.toString();if(!s&&et.isBlob(M))throw new Pr("Blob is not supported. Use a Buffer instead.");return et.isArrayBuffer(M)||et.isTypedArray(M)?s&&typeof Blob=="function"?new Blob([M]):Buffer.from(M):M}function b(M,R,j){let L=M;if(M&&!j&&typeof M=="object"){if(et.endsWith(R,"{}"))R=n?R:R.slice(0,-2),M=JSON.stringify(M);else if(et.isArray(M)&&F2(M)||(et.isFileList(M)||et.endsWith(R,"[]"))&&(L=et.toArray(M)))return R=QU(R),L.forEach(function(B,Z){!(et.isUndefined(B)||B===null)&&t.append(h===!0?yz([R],Z,l):h===null?R:R+"[]",y(B))}),!1}return XP(M)?!0:(t.append(yz(j,R,l),y(M)),!1)}const w=[],A=Object.assign(U2,{defaultVisitor:b,convertValue:y,isVisitable:XP});function k(M,R){if(!et.isUndefined(M)){if(w.indexOf(M)!==-1)throw Error("Circular reference detected in "+R.join("."));w.push(M),et.forEach(M,function(L,z){(!(et.isUndefined(L)||L===null)&&o.call(t,L,et.isString(z)?z.trim():z,R,A))===!0&&k(L,R?R.concat(z):[z])}),w.pop()}}if(!et.isObject(e))throw new TypeError("data must be an object");return k(e),t}function vz(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(n){return t[n]})}function gM(e,t){this._pairs=[],e&&z1(e,this,t)}const eV=gM.prototype;eV.append=function(t,r){this._pairs.push([t,r])};eV.toString=function(t){const r=t?function(n){return t.call(this,n,vz)}:vz;return this._pairs.map(function(o){return r(o[0])+"="+r(o[1])},"").join("&")};function V2(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function tV(e,t,r){if(!t)return e;const n=r&&r.encode||V2;et.isFunction(r)&&(r={serialize:r});const o=r&&r.serialize;let l;if(o?l=o(t,r):l=et.isURLSearchParams(t)?t.toString():new gM(t,r).toString(n),l){const h=e.indexOf("#");h!==-1&&(e=e.slice(0,h)),e+=(e.indexOf("?")===-1?"?":"&")+l}return e}class _z{constructor(){this.handlers=[]}use(t,r,n){return this.handlers.push({fulfilled:t,rejected:r,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){et.forEach(this.handlers,function(n){n!==null&&t(n)})}}const rV={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},G2=typeof URLSearchParams<"u"?URLSearchParams:gM,W2=typeof FormData<"u"?FormData:null,q2=typeof Blob<"u"?Blob:null,H2={isBrowser:!0,classes:{URLSearchParams:G2,FormData:W2,Blob:q2},protocols:["http","https","file","blob","url","data"]},yM=typeof window<"u"&&typeof document<"u",YP=typeof navigator=="object"&&navigator||void 0,K2=yM&&(!YP||["ReactNative","NativeScript","NS"].indexOf(YP.product)<0),Z2=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",X2=yM&&window.location.href||"http://localhost",Y2=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:yM,hasStandardBrowserEnv:K2,hasStandardBrowserWebWorkerEnv:Z2,navigator:YP,origin:X2},Symbol.toStringTag,{value:"Module"})),So={...Y2,...H2};function J2(e,t){return z1(e,new So.classes.URLSearchParams,{visitor:function(r,n,o,l){return So.isNode&&et.isBuffer(r)?(this.append(n,r.toString("base64")),!1):l.defaultVisitor.apply(this,arguments)},...t})}function Q2(e){return et.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function eJ(e){const t={},r=Object.keys(e);let n;const o=r.length;let l;for(n=0;n<o;n++)l=r[n],t[l]=e[l];return t}function nV(e){function t(r,n,o,l){let h=r[l++];if(h==="__proto__")return!0;const f=Number.isFinite(+h),s=l>=r.length;return h=!h&&et.isArray(o)?o.length:h,s?(et.hasOwnProp(o,h)?o[h]=[o[h],n]:o[h]=n,!f):((!o[h]||!et.isObject(o[h]))&&(o[h]=[]),t(r,n,o[h],l)&&et.isArray(o[h])&&(o[h]=eJ(o[h])),!f)}if(et.isFormData(e)&&et.isFunction(e.entries)){const r={};return et.forEachEntry(e,(n,o)=>{t(Q2(n),o,r,0)}),r}return null}function tJ(e,t,r){if(et.isString(e))try{return(t||JSON.parse)(e),et.trim(e)}catch(n){if(n.name!=="SyntaxError")throw n}return(r||JSON.stringify)(e)}const j_={transitional:rV,adapter:["xhr","http","fetch"],transformRequest:[function(t,r){const n=r.getContentType()||"",o=n.indexOf("application/json")>-1,l=et.isObject(t);if(l&&et.isHTMLForm(t)&&(t=new FormData(t)),et.isFormData(t))return o?JSON.stringify(nV(t)):t;if(et.isArrayBuffer(t)||et.isBuffer(t)||et.isStream(t)||et.isFile(t)||et.isBlob(t)||et.isReadableStream(t))return t;if(et.isArrayBufferView(t))return t.buffer;if(et.isURLSearchParams(t))return r.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let f;if(l){if(n.indexOf("application/x-www-form-urlencoded")>-1)return J2(t,this.formSerializer).toString();if((f=et.isFileList(t))||n.indexOf("multipart/form-data")>-1){const s=this.env&&this.env.FormData;return z1(f?{"files[]":t}:t,s&&new s,this.formSerializer)}}return l||o?(r.setContentType("application/json",!1),tJ(t)):t}],transformResponse:[function(t){const r=this.transitional||j_.transitional,n=r&&r.forcedJSONParsing,o=this.responseType==="json";if(et.isResponse(t)||et.isReadableStream(t))return t;if(t&&et.isString(t)&&(n&&!this.responseType||o)){const h=!(r&&r.silentJSONParsing)&&o;try{return JSON.parse(t,this.parseReviver)}catch(f){if(h)throw f.name==="SyntaxError"?Pr.from(f,Pr.ERR_BAD_RESPONSE,this,null,this.response):f}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:So.classes.FormData,Blob:So.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};et.forEach(["delete","get","head","post","put","patch"],e=>{j_.headers[e]={}});const rJ=et.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),nJ=e=>{const t={};let r,n,o;return e&&e.split(`
`).forEach(function(h){o=h.indexOf(":"),r=h.substring(0,o).trim().toLowerCase(),n=h.substring(o+1).trim(),!(!r||t[r]&&rJ[r])&&(r==="set-cookie"?t[r]?t[r].push(n):t[r]=[n]:t[r]=t[r]?t[r]+", "+n:n)}),t},xz=Symbol("internals");function wy(e){return e&&String(e).trim().toLowerCase()}function vb(e){return e===!1||e==null?e:et.isArray(e)?e.map(vb):String(e)}function iJ(e){const t=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=r.exec(e);)t[n[1]]=n[2];return t}const oJ=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function VE(e,t,r,n,o){if(et.isFunction(n))return n.call(this,t,r);if(o&&(t=r),!!et.isString(t)){if(et.isString(n))return t.indexOf(n)!==-1;if(et.isRegExp(n))return n.test(t)}}function sJ(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,r,n)=>r.toUpperCase()+n)}function aJ(e,t){const r=et.toCamelCase(" "+t);["get","set","has"].forEach(n=>{Object.defineProperty(e,n+r,{value:function(o,l,h){return this[n].call(this,t,o,l,h)},configurable:!0})})}let is=class{constructor(t){t&&this.set(t)}set(t,r,n){const o=this;function l(f,s,y){const b=wy(s);if(!b)throw new Error("header name must be a non-empty string");const w=et.findKey(o,b);(!w||o[w]===void 0||y===!0||y===void 0&&o[w]!==!1)&&(o[w||s]=vb(f))}const h=(f,s)=>et.forEach(f,(y,b)=>l(y,b,s));if(et.isPlainObject(t)||t instanceof this.constructor)h(t,r);else if(et.isString(t)&&(t=t.trim())&&!oJ(t))h(nJ(t),r);else if(et.isObject(t)&&et.isIterable(t)){let f={},s,y;for(const b of t){if(!et.isArray(b))throw TypeError("Object iterator must return a key-value pair");f[y=b[0]]=(s=f[y])?et.isArray(s)?[...s,b[1]]:[s,b[1]]:b[1]}h(f,r)}else t!=null&&l(r,t,n);return this}get(t,r){if(t=wy(t),t){const n=et.findKey(this,t);if(n){const o=this[n];if(!r)return o;if(r===!0)return iJ(o);if(et.isFunction(r))return r.call(this,o,n);if(et.isRegExp(r))return r.exec(o);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,r){if(t=wy(t),t){const n=et.findKey(this,t);return!!(n&&this[n]!==void 0&&(!r||VE(this,this[n],n,r)))}return!1}delete(t,r){const n=this;let o=!1;function l(h){if(h=wy(h),h){const f=et.findKey(n,h);f&&(!r||VE(n,n[f],f,r))&&(delete n[f],o=!0)}}return et.isArray(t)?t.forEach(l):l(t),o}clear(t){const r=Object.keys(this);let n=r.length,o=!1;for(;n--;){const l=r[n];(!t||VE(this,this[l],l,t,!0))&&(delete this[l],o=!0)}return o}normalize(t){const r=this,n={};return et.forEach(this,(o,l)=>{const h=et.findKey(n,l);if(h){r[h]=vb(o),delete r[l];return}const f=t?sJ(l):String(l).trim();f!==l&&delete r[l],r[f]=vb(o),n[f]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const r=Object.create(null);return et.forEach(this,(n,o)=>{n!=null&&n!==!1&&(r[o]=t&&et.isArray(n)?n.join(", "):n)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,r])=>t+": "+r).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...r){const n=new this(t);return r.forEach(o=>n.set(o)),n}static accessor(t){const n=(this[xz]=this[xz]={accessors:{}}).accessors,o=this.prototype;function l(h){const f=wy(h);n[f]||(aJ(o,h),n[f]=!0)}return et.isArray(t)?t.forEach(l):l(t),this}};is.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);et.reduceDescriptors(is.prototype,({value:e},t)=>{let r=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(n){this[r]=n}}});et.freezeMethods(is);function GE(e,t){const r=this||j_,n=t||r,o=is.from(n.headers);let l=n.data;return et.forEach(e,function(f){l=f.call(r,l,o.normalize(),t?t.status:void 0)}),o.normalize(),l}function iV(e){return!!(e&&e.__CANCEL__)}function wm(e,t,r){Pr.call(this,e??"canceled",Pr.ERR_CANCELED,t,r),this.name="CanceledError"}et.inherits(wm,Pr,{__CANCEL__:!0});function oV(e,t,r){const n=r.config.validateStatus;!r.status||!n||n(r.status)?e(r):t(new Pr("Request failed with status code "+r.status,[Pr.ERR_BAD_REQUEST,Pr.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}function lJ(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function cJ(e,t){e=e||10;const r=new Array(e),n=new Array(e);let o=0,l=0,h;return t=t!==void 0?t:1e3,function(s){const y=Date.now(),b=n[l];h||(h=y),r[o]=s,n[o]=y;let w=l,A=0;for(;w!==o;)A+=r[w++],w=w%e;if(o=(o+1)%e,o===l&&(l=(l+1)%e),y-h<t)return;const k=b&&y-b;return k?Math.round(A*1e3/k):void 0}}function uJ(e,t){let r=0,n=1e3/t,o,l;const h=(y,b=Date.now())=>{r=b,o=null,l&&(clearTimeout(l),l=null),e(...y)};return[(...y)=>{const b=Date.now(),w=b-r;w>=n?h(y,b):(o=y,l||(l=setTimeout(()=>{l=null,h(o)},n-w)))},()=>o&&h(o)]}const ew=(e,t,r=3)=>{let n=0;const o=cJ(50,250);return uJ(l=>{const h=l.loaded,f=l.lengthComputable?l.total:void 0,s=h-n,y=o(s),b=h<=f;n=h;const w={loaded:h,total:f,progress:f?h/f:void 0,bytes:s,rate:y||void 0,estimated:y&&f&&b?(f-h)/y:void 0,event:l,lengthComputable:f!=null,[t?"download":"upload"]:!0};e(w)},r)},bz=(e,t)=>{const r=e!=null;return[n=>t[0]({lengthComputable:r,total:e,loaded:n}),t[1]]},wz=e=>(...t)=>et.asap(()=>e(...t)),hJ=So.hasStandardBrowserEnv?((e,t)=>r=>(r=new URL(r,So.origin),e.protocol===r.protocol&&e.host===r.host&&(t||e.port===r.port)))(new URL(So.origin),So.navigator&&/(msie|trident)/i.test(So.navigator.userAgent)):()=>!0,dJ=So.hasStandardBrowserEnv?{write(e,t,r,n,o,l,h){if(typeof document>"u")return;const f=[`${e}=${encodeURIComponent(t)}`];et.isNumber(r)&&f.push(`expires=${new Date(r).toUTCString()}`),et.isString(n)&&f.push(`path=${n}`),et.isString(o)&&f.push(`domain=${o}`),l===!0&&f.push("secure"),et.isString(h)&&f.push(`SameSite=${h}`),document.cookie=f.join("; ")},read(e){if(typeof document>"u")return null;const t=document.cookie.match(new RegExp("(?:^|; )"+e+"=([^;]*)"));return t?decodeURIComponent(t[1]):null},remove(e){this.write(e,"",Date.now()-864e5,"/")}}:{write(){},read(){return null},remove(){}};function fJ(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function pJ(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function sV(e,t,r){let n=!fJ(t);return e&&(n||r==!1)?pJ(e,t):t}const Sz=e=>e instanceof is?{...e}:e;function xd(e,t){t=t||{};const r={};function n(y,b,w,A){return et.isPlainObject(y)&&et.isPlainObject(b)?et.merge.call({caseless:A},y,b):et.isPlainObject(b)?et.merge({},b):et.isArray(b)?b.slice():b}function o(y,b,w,A){if(et.isUndefined(b)){if(!et.isUndefined(y))return n(void 0,y,w,A)}else return n(y,b,w,A)}function l(y,b){if(!et.isUndefined(b))return n(void 0,b)}function h(y,b){if(et.isUndefined(b)){if(!et.isUndefined(y))return n(void 0,y)}else return n(void 0,b)}function f(y,b,w){if(w in t)return n(y,b);if(w in e)return n(void 0,y)}const s={url:l,method:l,data:l,baseURL:h,transformRequest:h,transformResponse:h,paramsSerializer:h,timeout:h,timeoutMessage:h,withCredentials:h,withXSRFToken:h,adapter:h,responseType:h,xsrfCookieName:h,xsrfHeaderName:h,onUploadProgress:h,onDownloadProgress:h,decompress:h,maxContentLength:h,maxBodyLength:h,beforeRedirect:h,transport:h,httpAgent:h,httpsAgent:h,cancelToken:h,socketPath:h,responseEncoding:h,validateStatus:f,headers:(y,b,w)=>o(Sz(y),Sz(b),w,!0)};return et.forEach(Object.keys({...e,...t}),function(b){const w=s[b]||o,A=w(e[b],t[b],b);et.isUndefined(A)&&w!==f||(r[b]=A)}),r}const aV=e=>{const t=xd({},e);let{data:r,withXSRFToken:n,xsrfHeaderName:o,xsrfCookieName:l,headers:h,auth:f}=t;if(t.headers=h=is.from(h),t.url=tV(sV(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),f&&h.set("Authorization","Basic "+btoa((f.username||"")+":"+(f.password?unescape(encodeURIComponent(f.password)):""))),et.isFormData(r)){if(So.hasStandardBrowserEnv||So.hasStandardBrowserWebWorkerEnv)h.setContentType(void 0);else if(et.isFunction(r.getHeaders)){const s=r.getHeaders(),y=["content-type","content-length"];Object.entries(s).forEach(([b,w])=>{y.includes(b.toLowerCase())&&h.set(b,w)})}}if(So.hasStandardBrowserEnv&&(n&&et.isFunction(n)&&(n=n(t)),n||n!==!1&&hJ(t.url))){const s=o&&l&&dJ.read(l);s&&h.set(o,s)}return t},mJ=typeof XMLHttpRequest<"u",gJ=mJ&&function(e){return new Promise(function(r,n){const o=aV(e);let l=o.data;const h=is.from(o.headers).normalize();let{responseType:f,onUploadProgress:s,onDownloadProgress:y}=o,b,w,A,k,M;function R(){k&&k(),M&&M(),o.cancelToken&&o.cancelToken.unsubscribe(b),o.signal&&o.signal.removeEventListener("abort",b)}let j=new XMLHttpRequest;j.open(o.method.toUpperCase(),o.url,!0),j.timeout=o.timeout;function L(){if(!j)return;const B=is.from("getAllResponseHeaders"in j&&j.getAllResponseHeaders()),F={data:!f||f==="text"||f==="json"?j.responseText:j.response,status:j.status,statusText:j.statusText,headers:B,config:e,request:j};oV(function(Y){r(Y),R()},function(Y){n(Y),R()},F),j=null}"onloadend"in j?j.onloadend=L:j.onreadystatechange=function(){!j||j.readyState!==4||j.status===0&&!(j.responseURL&&j.responseURL.indexOf("file:")===0)||setTimeout(L)},j.onabort=function(){j&&(n(new Pr("Request aborted",Pr.ECONNABORTED,e,j)),j=null)},j.onerror=function(Z){const F=Z&&Z.message?Z.message:"Network Error",H=new Pr(F,Pr.ERR_NETWORK,e,j);H.event=Z||null,n(H),j=null},j.ontimeout=function(){let Z=o.timeout?"timeout of "+o.timeout+"ms exceeded":"timeout exceeded";const F=o.transitional||rV;o.timeoutErrorMessage&&(Z=o.timeoutErrorMessage),n(new Pr(Z,F.clarifyTimeoutError?Pr.ETIMEDOUT:Pr.ECONNABORTED,e,j)),j=null},l===void 0&&h.setContentType(null),"setRequestHeader"in j&&et.forEach(h.toJSON(),function(Z,F){j.setRequestHeader(F,Z)}),et.isUndefined(o.withCredentials)||(j.withCredentials=!!o.withCredentials),f&&f!=="json"&&(j.responseType=o.responseType),y&&([A,M]=ew(y,!0),j.addEventListener("progress",A)),s&&j.upload&&([w,k]=ew(s),j.upload.addEventListener("progress",w),j.upload.addEventListener("loadend",k)),(o.cancelToken||o.signal)&&(b=B=>{j&&(n(!B||B.type?new wm(null,e,j):B),j.abort(),j=null)},o.cancelToken&&o.cancelToken.subscribe(b),o.signal&&(o.signal.aborted?b():o.signal.addEventListener("abort",b)));const z=lJ(o.url);if(z&&So.protocols.indexOf(z)===-1){n(new Pr("Unsupported protocol "+z+":",Pr.ERR_BAD_REQUEST,e));return}j.send(l||null)})},yJ=(e,t)=>{const{length:r}=e=e?e.filter(Boolean):[];if(t||r){let n=new AbortController,o;const l=function(y){if(!o){o=!0,f();const b=y instanceof Error?y:this.reason;n.abort(b instanceof Pr?b:new wm(b instanceof Error?b.message:b))}};let h=t&&setTimeout(()=>{h=null,l(new Pr(`timeout ${t} of ms exceeded`,Pr.ETIMEDOUT))},t);const f=()=>{e&&(h&&clearTimeout(h),h=null,e.forEach(y=>{y.unsubscribe?y.unsubscribe(l):y.removeEventListener("abort",l)}),e=null)};e.forEach(y=>y.addEventListener("abort",l));const{signal:s}=n;return s.unsubscribe=()=>et.asap(f),s}},vJ=function*(e,t){let r=e.byteLength;if(r<t){yield e;return}let n=0,o;for(;n<r;)o=n+t,yield e.slice(n,o),n=o},_J=async function*(e,t){for await(const r of xJ(e))yield*vJ(r,t)},xJ=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:r,value:n}=await t.read();if(r)break;yield n}}finally{await t.cancel()}},Tz=(e,t,r,n)=>{const o=_J(e,t);let l=0,h,f=s=>{h||(h=!0,n&&n(s))};return new ReadableStream({async pull(s){try{const{done:y,value:b}=await o.next();if(y){f(),s.close();return}let w=b.byteLength;if(r){let A=l+=w;r(A)}s.enqueue(new Uint8Array(b))}catch(y){throw f(y),y}},cancel(s){return f(s),o.return()}},{highWaterMark:2})},Ez=64*1024,{isFunction:Rx}=et,bJ=(({Request:e,Response:t})=>({Request:e,Response:t}))(et.global),{ReadableStream:Az,TextEncoder:Pz}=et.global,Cz=(e,...t)=>{try{return!!e(...t)}catch{return!1}},wJ=e=>{e=et.merge.call({skipUndefined:!0},bJ,e);const{fetch:t,Request:r,Response:n}=e,o=t?Rx(t):typeof fetch=="function",l=Rx(r),h=Rx(n);if(!o)return!1;const f=o&&Rx(Az),s=o&&(typeof Pz=="function"?(M=>R=>M.encode(R))(new Pz):async M=>new Uint8Array(await new r(M).arrayBuffer())),y=l&&f&&Cz(()=>{let M=!1;const R=new r(So.origin,{body:new Az,method:"POST",get duplex(){return M=!0,"half"}}).headers.has("Content-Type");return M&&!R}),b=h&&f&&Cz(()=>et.isReadableStream(new n("").body)),w={stream:b&&(M=>M.body)};o&&["text","arrayBuffer","blob","formData","stream"].forEach(M=>{!w[M]&&(w[M]=(R,j)=>{let L=R&&R[M];if(L)return L.call(R);throw new Pr(`Response type '${M}' is not supported`,Pr.ERR_NOT_SUPPORT,j)})});const A=async M=>{if(M==null)return 0;if(et.isBlob(M))return M.size;if(et.isSpecCompliantForm(M))return(await new r(So.origin,{method:"POST",body:M}).arrayBuffer()).byteLength;if(et.isArrayBufferView(M)||et.isArrayBuffer(M))return M.byteLength;if(et.isURLSearchParams(M)&&(M=M+""),et.isString(M))return(await s(M)).byteLength},k=async(M,R)=>{const j=et.toFiniteNumber(M.getContentLength());return j??A(R)};return async M=>{let{url:R,method:j,data:L,signal:z,cancelToken:B,timeout:Z,onDownloadProgress:F,onUploadProgress:H,responseType:Y,headers:te,withCredentials:pe="same-origin",fetchOptions:ue}=aV(M),Ee=t||fetch;Y=Y?(Y+"").toLowerCase():"text";let Oe=yJ([z,B&&B.toAbortSignal()],Z),je=null;const Ge=Oe&&Oe.unsubscribe&&(()=>{Oe.unsubscribe()});let Ze;try{if(H&&y&&j!=="get"&&j!=="head"&&(Ze=await k(te,L))!==0){let ht=new r(R,{method:"POST",body:L,duplex:"half"}),at;if(et.isFormData(L)&&(at=ht.headers.get("content-type"))&&te.setContentType(at),ht.body){const[Lt,$t]=bz(Ze,ew(wz(H)));L=Tz(ht.body,Ez,Lt,$t)}}et.isString(pe)||(pe=pe?"include":"omit");const Ye=l&&"credentials"in r.prototype,tt={...ue,signal:Oe,method:j.toUpperCase(),headers:te.normalize().toJSON(),body:L,duplex:"half",credentials:Ye?pe:void 0};je=l&&new r(R,tt);let ze=await(l?Ee(je,ue):Ee(R,tt));const De=b&&(Y==="stream"||Y==="response");if(b&&(F||De&&Ge)){const ht={};["status","statusText","headers"].forEach(Tr=>{ht[Tr]=ze[Tr]});const at=et.toFiniteNumber(ze.headers.get("content-length")),[Lt,$t]=F&&bz(at,ew(wz(F),!0))||[];ze=new n(Tz(ze.body,Ez,Lt,()=>{$t&&$t(),Ge&&Ge()}),ht)}Y=Y||"text";let ut=await w[et.findKey(w,Y)||"text"](ze,M);return!De&&Ge&&Ge(),await new Promise((ht,at)=>{oV(ht,at,{data:ut,headers:is.from(ze.headers),status:ze.status,statusText:ze.statusText,config:M,request:je})})}catch(Ye){throw Ge&&Ge(),Ye&&Ye.name==="TypeError"&&/Load failed|fetch/i.test(Ye.message)?Object.assign(new Pr("Network Error",Pr.ERR_NETWORK,M,je),{cause:Ye.cause||Ye}):Pr.from(Ye,Ye&&Ye.code,M,je)}}},SJ=new Map,lV=e=>{let t=e&&e.env||{};const{fetch:r,Request:n,Response:o}=t,l=[n,o,r];let h=l.length,f=h,s,y,b=SJ;for(;f--;)s=l[f],y=b.get(s),y===void 0&&b.set(s,y=f?new Map:wJ(t)),b=y;return y};lV();const vM={http:$2,xhr:gJ,fetch:{get:lV}};et.forEach(vM,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const kz=e=>`- ${e}`,TJ=e=>et.isFunction(e)||e===null||e===!1;function EJ(e,t){e=et.isArray(e)?e:[e];const{length:r}=e;let n,o;const l={};for(let h=0;h<r;h++){n=e[h];let f;if(o=n,!TJ(n)&&(o=vM[(f=String(n)).toLowerCase()],o===void 0))throw new Pr(`Unknown adapter '${f}'`);if(o&&(et.isFunction(o)||(o=o.get(t))))break;l[f||"#"+h]=o}if(!o){const h=Object.entries(l).map(([s,y])=>`adapter ${s} `+(y===!1?"is not supported by the environment":"is not available in the build"));let f=r?h.length>1?`since :
`+h.map(kz).join(`
`):" "+kz(h[0]):"as no adapter specified";throw new Pr("There is no suitable adapter to dispatch the request "+f,"ERR_NOT_SUPPORT")}return o}const cV={getAdapter:EJ,adapters:vM};function WE(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new wm(null,e)}function Oz(e){return WE(e),e.headers=is.from(e.headers),e.data=GE.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),cV.getAdapter(e.adapter||j_.adapter,e)(e).then(function(n){return WE(e),n.data=GE.call(e,e.transformResponse,n),n.headers=is.from(n.headers),n},function(n){return iV(n)||(WE(e),n&&n.response&&(n.response.data=GE.call(e,e.transformResponse,n.response),n.response.headers=is.from(n.response.headers))),Promise.reject(n)})}const uV="1.13.2",B1={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{B1[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}});const Mz={};B1.transitional=function(t,r,n){function o(l,h){return"[Axios v"+uV+"] Transitional option '"+l+"'"+h+(n?". "+n:"")}return(l,h,f)=>{if(t===!1)throw new Pr(o(h," has been removed"+(r?" in "+r:"")),Pr.ERR_DEPRECATED);return r&&!Mz[h]&&(Mz[h]=!0,console.warn(o(h," has been deprecated since v"+r+" and will be removed in the near future"))),t?t(l,h,f):!0}};B1.spelling=function(t){return(r,n)=>(console.warn(`${n} is likely a misspelling of ${t}`),!0)};function AJ(e,t,r){if(typeof e!="object")throw new Pr("options must be an object",Pr.ERR_BAD_OPTION_VALUE);const n=Object.keys(e);let o=n.length;for(;o-- >0;){const l=n[o],h=t[l];if(h){const f=e[l],s=f===void 0||h(f,l,e);if(s!==!0)throw new Pr("option "+l+" must be "+s,Pr.ERR_BAD_OPTION_VALUE);continue}if(r!==!0)throw new Pr("Unknown option "+l,Pr.ERR_BAD_OPTION)}}const _b={assertOptions:AJ,validators:B1},dl=_b.validators;let cd=class{constructor(t){this.defaults=t||{},this.interceptors={request:new _z,response:new _z}}async request(t,r){try{return await this._request(t,r)}catch(n){if(n instanceof Error){let o={};Error.captureStackTrace?Error.captureStackTrace(o):o=new Error;const l=o.stack?o.stack.replace(/^.+\n/,""):"";try{n.stack?l&&!String(n.stack).endsWith(l.replace(/^.+\n.+\n/,""))&&(n.stack+=`
`+l):n.stack=l}catch{}}throw n}}_request(t,r){typeof t=="string"?(r=r||{},r.url=t):r=t||{},r=xd(this.defaults,r);const{transitional:n,paramsSerializer:o,headers:l}=r;n!==void 0&&_b.assertOptions(n,{silentJSONParsing:dl.transitional(dl.boolean),forcedJSONParsing:dl.transitional(dl.boolean),clarifyTimeoutError:dl.transitional(dl.boolean)},!1),o!=null&&(et.isFunction(o)?r.paramsSerializer={serialize:o}:_b.assertOptions(o,{encode:dl.function,serialize:dl.function},!0)),r.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?r.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:r.allowAbsoluteUrls=!0),_b.assertOptions(r,{baseUrl:dl.spelling("baseURL"),withXsrfToken:dl.spelling("withXSRFToken")},!0),r.method=(r.method||this.defaults.method||"get").toLowerCase();let h=l&&et.merge(l.common,l[r.method]);l&&et.forEach(["delete","get","head","post","put","patch","common"],M=>{delete l[M]}),r.headers=is.concat(h,l);const f=[];let s=!0;this.interceptors.request.forEach(function(R){typeof R.runWhen=="function"&&R.runWhen(r)===!1||(s=s&&R.synchronous,f.unshift(R.fulfilled,R.rejected))});const y=[];this.interceptors.response.forEach(function(R){y.push(R.fulfilled,R.rejected)});let b,w=0,A;if(!s){const M=[Oz.bind(this),void 0];for(M.unshift(...f),M.push(...y),A=M.length,b=Promise.resolve(r);w<A;)b=b.then(M[w++],M[w++]);return b}A=f.length;let k=r;for(;w<A;){const M=f[w++],R=f[w++];try{k=M(k)}catch(j){R.call(this,j);break}}try{b=Oz.call(this,k)}catch(M){return Promise.reject(M)}for(w=0,A=y.length;w<A;)b=b.then(y[w++],y[w++]);return b}getUri(t){t=xd(this.defaults,t);const r=sV(t.baseURL,t.url,t.allowAbsoluteUrls);return tV(r,t.params,t.paramsSerializer)}};et.forEach(["delete","get","head","options"],function(t){cd.prototype[t]=function(r,n){return this.request(xd(n||{},{method:t,url:r,data:(n||{}).data}))}});et.forEach(["post","put","patch"],function(t){function r(n){return function(l,h,f){return this.request(xd(f||{},{method:t,headers:n?{"Content-Type":"multipart/form-data"}:{},url:l,data:h}))}}cd.prototype[t]=r(),cd.prototype[t+"Form"]=r(!0)});let PJ=class hV{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let r;this.promise=new Promise(function(l){r=l});const n=this;this.promise.then(o=>{if(!n._listeners)return;let l=n._listeners.length;for(;l-- >0;)n._listeners[l](o);n._listeners=null}),this.promise.then=o=>{let l;const h=new Promise(f=>{n.subscribe(f),l=f}).then(o);return h.cancel=function(){n.unsubscribe(l)},h},t(function(l,h,f){n.reason||(n.reason=new wm(l,h,f),r(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const r=this._listeners.indexOf(t);r!==-1&&this._listeners.splice(r,1)}toAbortSignal(){const t=new AbortController,r=n=>{t.abort(n)};return this.subscribe(r),t.signal.unsubscribe=()=>this.unsubscribe(r),t.signal}static source(){let t;return{token:new hV(function(o){t=o}),cancel:t}}};function CJ(e){return function(r){return e.apply(null,r)}}function kJ(e){return et.isObject(e)&&e.isAxiosError===!0}const JP={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(JP).forEach(([e,t])=>{JP[t]=e});function dV(e){const t=new cd(e),r=VU(cd.prototype.request,t);return et.extend(r,cd.prototype,t,{allOwnKeys:!0}),et.extend(r,t,null,{allOwnKeys:!0}),r.create=function(o){return dV(xd(e,o))},r}const ui=dV(j_);ui.Axios=cd;ui.CanceledError=wm;ui.CancelToken=PJ;ui.isCancel=iV;ui.VERSION=uV;ui.toFormData=z1;ui.AxiosError=Pr;ui.Cancel=ui.CanceledError;ui.all=function(t){return Promise.all(t)};ui.spread=CJ;ui.isAxiosError=kJ;ui.mergeConfig=xd;ui.AxiosHeaders=is;ui.formToJSON=e=>nV(et.isHTMLForm(e)?new FormData(e):e);ui.getAdapter=cV.getAdapter;ui.HttpStatusCode=JP;ui.default=ui;const{Axios:_De,AxiosError:xDe,CanceledError:bDe,isCancel:wDe,CancelToken:SDe,VERSION:TDe,all:EDe,Cancel:ADe,isAxiosError:PDe,spread:CDe,toFormData:kDe,AxiosHeaders:ODe,HttpStatusCode:MDe,formToJSON:IDe,getAdapter:RDe,mergeConfig:DDe}=ui,OJ="http://localhost:3001/api",Gi=ui.create({baseURL:OJ,withCredentials:!0,headers:{"Content-Type":"application/json"}});Gi.interceptors.request.use(e=>{const t=localStorage.getItem("accessToken");if(t){const r=t.trim().replace(/^Bearer\s+/i,"");r&&r!=="null"&&r!=="undefined"&&(e.headers.Authorization=`Bearer ${r}`)}return e});Gi.interceptors.response.use(e=>e,async e=>{var t;return((t=e.response)==null?void 0:t.status)===401&&(localStorage.removeItem("accessToken"),window.location.href="/login"),Promise.reject(e)});const up={async register(e){return(await Gi.post("/auth/register",e)).data.user},async verifyOTP(e,t){await Gi.post("/auth/verify",{userId:e,otp:t})},async login(e){const t=await Gi.post("/auth/login",e);return localStorage.setItem("accessToken",t.data.accessToken),t.data},async createLocalUser(e){await Gi.post("/auth/create-local-user",e)},async me(){return(await Gi.get("/auth/me")).data.user},logout(){localStorage.removeItem("accessToken"),window.location.href="/login"}},Uu=UU(e=>({user:null,isLoading:!0,isAuthenticated:!1,login:async(t,r)=>{var n,o,l,h;try{const f=await up.login({email:t,password:r});e({user:f.user,isAuthenticated:!0})}catch(f){const s=((o=(n=f.response)==null?void 0:n.data)==null?void 0:o.message)||((h=(l=f.response)==null?void 0:l.data)==null?void 0:h.error)||f.message||"Login failed";throw new Error(s)}},register:async(t,r,n="student")=>{var o,l;try{await up.register({email:t,password:r,role:n})}catch(h){throw new Error(((l=(o=h.response)==null?void 0:o.data)==null?void 0:l.error)||"Registration failed")}},logout:()=>{up.logout(),e({user:null,isAuthenticated:!1})},checkAuth:async()=>{try{if(!localStorage.getItem("accessToken")){e({isLoading:!1,isAuthenticated:!1});return}const r=await up.me();e({user:r,isAuthenticated:!0,isLoading:!1})}catch(t){console.warn("Auth check failed:",t.message||t),localStorage.removeItem("accessToken"),e({user:null,isAuthenticated:!1,isLoading:!1})}},setUser:t=>{e({user:t,isAuthenticated:!!t})}}));function zf({children:e,allowedRoles:t}){const{isAuthenticated:r,user:n,isLoading:o}=Uu();return o?W.jsx("div",{className:"flex items-center justify-center min-h-screen",children:W.jsx("div",{className:"text-white",children:"Loading..."})}):r?t&&n&&!t.includes(n.role)?W.jsx(qh,{to:"/",replace:!0}):W.jsx(W.Fragment,{children:e}):W.jsx(qh,{to:"/login",replace:!0})}const _M=re.createContext({});function xM(e){const t=re.useRef(null);return t.current===null&&(t.current=e()),t.current}const fV=typeof window<"u",pV=fV?re.useLayoutEffect:re.useEffect,N1=re.createContext(null);function bM(e,t){e.indexOf(t)===-1&&e.push(t)}function wM(e,t){const r=e.indexOf(t);r>-1&&e.splice(r,1)}const Al=(e,t,r)=>r>t?t:r<e?e:r;let SM=()=>{};const pc={},mV=e=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(e);function gV(e){return typeof e=="object"&&e!==null}const yV=e=>/^0[^.\s]+$/u.test(e);function TM(e){let t;return()=>(t===void 0&&(t=e()),t)}const ea=e=>e,MJ=(e,t)=>r=>t(e(r)),z_=(...e)=>e.reduce(MJ),Lv=(e,t,r)=>{const n=t-e;return n===0?1:(r-e)/n};class EM{constructor(){this.subscriptions=[]}add(t){return bM(this.subscriptions,t),()=>wM(this.subscriptions,t)}notify(t,r,n){const o=this.subscriptions.length;if(o)if(o===1)this.subscriptions[0](t,r,n);else for(let l=0;l<o;l++){const h=this.subscriptions[l];h&&h(t,r,n)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const oc=e=>e*1e3,Xs=e=>e/1e3;function vV(e,t){return t?e*(1e3/t):0}const _V=(e,t,r)=>(((1-3*r+3*t)*e+(3*r-6*t))*e+3*t)*e,IJ=1e-7,RJ=12;function DJ(e,t,r,n,o){let l,h,f=0;do h=t+(r-t)/2,l=_V(h,n,o)-e,l>0?r=h:t=h;while(Math.abs(l)>IJ&&++f<RJ);return h}function B_(e,t,r,n){if(e===t&&r===n)return ea;const o=l=>DJ(l,0,1,e,r);return l=>l===0||l===1?l:_V(o(l),t,n)}const xV=e=>t=>t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2,bV=e=>t=>1-e(1-t),wV=B_(.33,1.53,.69,.99),AM=bV(wV),SV=xV(AM),TV=e=>(e*=2)<1?.5*AM(e):.5*(2-Math.pow(2,-10*(e-1))),PM=e=>1-Math.sin(Math.acos(e)),EV=bV(PM),AV=xV(PM),LJ=B_(.42,0,1,1),jJ=B_(0,0,.58,1),PV=B_(.42,0,.58,1),zJ=e=>Array.isArray(e)&&typeof e[0]!="number",CV=e=>Array.isArray(e)&&typeof e[0]=="number",BJ={linear:ea,easeIn:LJ,easeInOut:PV,easeOut:jJ,circIn:PM,circInOut:AV,circOut:EV,backIn:AM,backInOut:SV,backOut:wV,anticipate:TV},NJ=e=>typeof e=="string",Iz=e=>{if(CV(e)){SM(e.length===4);const[t,r,n,o]=e;return B_(t,r,n,o)}else if(NJ(e))return BJ[e];return e},Dx=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"];function $J(e,t){let r=new Set,n=new Set,o=!1,l=!1;const h=new WeakSet;let f={delta:0,timestamp:0,isProcessing:!1};function s(b){h.has(b)&&(y.schedule(b),e()),b(f)}const y={schedule:(b,w=!1,A=!1)=>{const M=A&&o?r:n;return w&&h.add(b),M.has(b)||M.add(b),b},cancel:b=>{n.delete(b),h.delete(b)},process:b=>{if(f=b,o){l=!0;return}o=!0,[r,n]=[n,r],r.forEach(s),r.clear(),o=!1,l&&(l=!1,y.process(b))}};return y}const FJ=40;function kV(e,t){let r=!1,n=!0;const o={delta:0,timestamp:0,isProcessing:!1},l=()=>r=!0,h=Dx.reduce((B,Z)=>(B[Z]=$J(l),B),{}),{setup:f,read:s,resolveKeyframes:y,preUpdate:b,update:w,preRender:A,render:k,postRender:M}=h,R=()=>{const B=pc.useManualTiming?o.timestamp:performance.now();r=!1,pc.useManualTiming||(o.delta=n?1e3/60:Math.max(Math.min(B-o.timestamp,FJ),1)),o.timestamp=B,o.isProcessing=!0,f.process(o),s.process(o),y.process(o),b.process(o),w.process(o),A.process(o),k.process(o),M.process(o),o.isProcessing=!1,r&&t&&(n=!1,e(R))},j=()=>{r=!0,n=!0,o.isProcessing||e(R)};return{schedule:Dx.reduce((B,Z)=>{const F=h[Z];return B[Z]=(H,Y=!1,te=!1)=>(r||j(),F.schedule(H,Y,te)),B},{}),cancel:B=>{for(let Z=0;Z<Dx.length;Z++)h[Dx[Z]].cancel(B)},state:o,steps:h}}const{schedule:Ln,cancel:Lu,state:to,steps:qE}=kV(typeof requestAnimationFrame<"u"?requestAnimationFrame:ea,!0);let xb;function UJ(){xb=void 0}const Io={now:()=>(xb===void 0&&Io.set(to.isProcessing||pc.useManualTiming?to.timestamp:performance.now()),xb),set:e=>{xb=e,queueMicrotask(UJ)}},OV=e=>t=>typeof t=="string"&&t.startsWith(e),MV=OV("--"),VJ=OV("var(--"),CM=e=>VJ(e)?GJ.test(e.split("/*")[0].trim()):!1,GJ=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu;function Rz(e){return typeof e!="string"?!1:e.split("/*")[0].includes("var(--")}const Sm={test:e=>typeof e=="number",parse:parseFloat,transform:e=>e},jv={...Sm,transform:e=>Al(0,1,e)},Lx={...Sm,default:1},rv=e=>Math.round(e*1e5)/1e5,kM=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function WJ(e){return e==null}const qJ=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,OM=(e,t)=>r=>!!(typeof r=="string"&&qJ.test(r)&&r.startsWith(e)||t&&!WJ(r)&&Object.prototype.hasOwnProperty.call(r,t)),IV=(e,t,r)=>n=>{if(typeof n!="string")return n;const[o,l,h,f]=n.match(kM);return{[e]:parseFloat(o),[t]:parseFloat(l),[r]:parseFloat(h),alpha:f!==void 0?parseFloat(f):1}},HJ=e=>Al(0,255,e),HE={...Sm,transform:e=>Math.round(HJ(e))},Qh={test:OM("rgb","red"),parse:IV("red","green","blue"),transform:({red:e,green:t,blue:r,alpha:n=1})=>"rgba("+HE.transform(e)+", "+HE.transform(t)+", "+HE.transform(r)+", "+rv(jv.transform(n))+")"};function KJ(e){let t="",r="",n="",o="";return e.length>5?(t=e.substring(1,3),r=e.substring(3,5),n=e.substring(5,7),o=e.substring(7,9)):(t=e.substring(1,2),r=e.substring(2,3),n=e.substring(3,4),o=e.substring(4,5),t+=t,r+=r,n+=n,o+=o),{red:parseInt(t,16),green:parseInt(r,16),blue:parseInt(n,16),alpha:o?parseInt(o,16)/255:1}}const QP={test:OM("#"),parse:KJ,transform:Qh.transform},N_=e=>({test:t=>typeof t=="string"&&t.endsWith(e)&&t.split(" ").length===1,parse:parseFloat,transform:t=>`${t}${e}`}),ou=N_("deg"),xl=N_("%"),Wt=N_("px"),ZJ=N_("vh"),XJ=N_("vw"),Dz={...xl,parse:e=>xl.parse(e)/100,transform:e=>xl.transform(e*100)},hp={test:OM("hsl","hue"),parse:IV("hue","saturation","lightness"),transform:({hue:e,saturation:t,lightness:r,alpha:n=1})=>"hsla("+Math.round(e)+", "+xl.transform(rv(t))+", "+xl.transform(rv(r))+", "+rv(jv.transform(n))+")"},vi={test:e=>Qh.test(e)||QP.test(e)||hp.test(e),parse:e=>Qh.test(e)?Qh.parse(e):hp.test(e)?hp.parse(e):QP.parse(e),transform:e=>typeof e=="string"?e:e.hasOwnProperty("red")?Qh.transform(e):hp.transform(e),getAnimatableNone:e=>{const t=vi.parse(e);return t.alpha=0,vi.transform(t)}},YJ=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function JJ(e){var t,r;return isNaN(e)&&typeof e=="string"&&(((t=e.match(kM))==null?void 0:t.length)||0)+(((r=e.match(YJ))==null?void 0:r.length)||0)>0}const RV="number",DV="color",QJ="var",eQ="var(",Lz="${}",tQ=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function zv(e){const t=e.toString(),r=[],n={color:[],number:[],var:[]},o=[];let l=0;const f=t.replace(tQ,s=>(vi.test(s)?(n.color.push(l),o.push(DV),r.push(vi.parse(s))):s.startsWith(eQ)?(n.var.push(l),o.push(QJ),r.push(s)):(n.number.push(l),o.push(RV),r.push(parseFloat(s))),++l,Lz)).split(Lz);return{values:r,split:f,indexes:n,types:o}}function LV(e){return zv(e).values}function jV(e){const{split:t,types:r}=zv(e),n=t.length;return o=>{let l="";for(let h=0;h<n;h++)if(l+=t[h],o[h]!==void 0){const f=r[h];f===RV?l+=rv(o[h]):f===DV?l+=vi.transform(o[h]):l+=o[h]}return l}}const rQ=e=>typeof e=="number"?0:vi.test(e)?vi.getAnimatableNone(e):e;function nQ(e){const t=LV(e);return jV(e)(t.map(rQ))}const ju={test:JJ,parse:LV,createTransformer:jV,getAnimatableNone:nQ};function KE(e,t,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?e+(t-e)*6*r:r<1/2?t:r<2/3?e+(t-e)*(2/3-r)*6:e}function iQ({hue:e,saturation:t,lightness:r,alpha:n}){e/=360,t/=100,r/=100;let o=0,l=0,h=0;if(!t)o=l=h=r;else{const f=r<.5?r*(1+t):r+t-r*t,s=2*r-f;o=KE(s,f,e+1/3),l=KE(s,f,e),h=KE(s,f,e-1/3)}return{red:Math.round(o*255),green:Math.round(l*255),blue:Math.round(h*255),alpha:n}}function tw(e,t){return r=>r>0?t:e}const Qn=(e,t,r)=>e+(t-e)*r,ZE=(e,t,r)=>{const n=e*e,o=r*(t*t-n)+n;return o<0?0:Math.sqrt(o)},oQ=[QP,Qh,hp],sQ=e=>oQ.find(t=>t.test(e));function jz(e){const t=sQ(e);if(!t)return!1;let r=t.parse(e);return t===hp&&(r=iQ(r)),r}const zz=(e,t)=>{const r=jz(e),n=jz(t);if(!r||!n)return tw(e,t);const o={...r};return l=>(o.red=ZE(r.red,n.red,l),o.green=ZE(r.green,n.green,l),o.blue=ZE(r.blue,n.blue,l),o.alpha=Qn(r.alpha,n.alpha,l),Qh.transform(o))},eC=new Set(["none","hidden"]);function aQ(e,t){return eC.has(e)?r=>r<=0?e:t:r=>r>=1?t:e}function lQ(e,t){return r=>Qn(e,t,r)}function MM(e){return typeof e=="number"?lQ:typeof e=="string"?CM(e)?tw:vi.test(e)?zz:hQ:Array.isArray(e)?zV:typeof e=="object"?vi.test(e)?zz:cQ:tw}function zV(e,t){const r=[...e],n=r.length,o=e.map((l,h)=>MM(l)(l,t[h]));return l=>{for(let h=0;h<n;h++)r[h]=o[h](l);return r}}function cQ(e,t){const r={...e,...t},n={};for(const o in r)e[o]!==void 0&&t[o]!==void 0&&(n[o]=MM(e[o])(e[o],t[o]));return o=>{for(const l in n)r[l]=n[l](o);return r}}function uQ(e,t){const r=[],n={color:0,var:0,number:0};for(let o=0;o<t.values.length;o++){const l=t.types[o],h=e.indexes[l][n[l]],f=e.values[h]??0;r[o]=f,n[l]++}return r}const hQ=(e,t)=>{const r=ju.createTransformer(t),n=zv(e),o=zv(t);return n.indexes.var.length===o.indexes.var.length&&n.indexes.color.length===o.indexes.color.length&&n.indexes.number.length>=o.indexes.number.length?eC.has(e)&&!o.values.length||eC.has(t)&&!n.values.length?aQ(e,t):z_(zV(uQ(n,o),o.values),r):tw(e,t)};function BV(e,t,r){return typeof e=="number"&&typeof t=="number"&&typeof r=="number"?Qn(e,t,r):MM(e)(e,t)}const dQ=e=>{const t=({timestamp:r})=>e(r);return{start:(r=!0)=>Ln.update(t,r),stop:()=>Lu(t),now:()=>to.isProcessing?to.timestamp:Io.now()}},NV=(e,t,r=10)=>{let n="";const o=Math.max(Math.round(t/r),2);for(let l=0;l<o;l++)n+=Math.round(e(l/(o-1))*1e4)/1e4+", ";return`linear(${n.substring(0,n.length-2)})`},rw=2e4;function IM(e){let t=0;const r=50;let n=e.next(t);for(;!n.done&&t<rw;)t+=r,n=e.next(t);return t>=rw?1/0:t}function fQ(e,t=100,r){const n=r({...e,keyframes:[0,t]}),o=Math.min(IM(n),rw);return{type:"keyframes",ease:l=>n.next(o*l).value/t,duration:Xs(o)}}const pQ=5;function $V(e,t,r){const n=Math.max(t-pQ,0);return vV(r-e(n),t-n)}const ii={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},XE=.001;function mQ({duration:e=ii.duration,bounce:t=ii.bounce,velocity:r=ii.velocity,mass:n=ii.mass}){let o,l,h=1-t;h=Al(ii.minDamping,ii.maxDamping,h),e=Al(ii.minDuration,ii.maxDuration,Xs(e)),h<1?(o=y=>{const b=y*h,w=b*e,A=b-r,k=tC(y,h),M=Math.exp(-w);return XE-A/k*M},l=y=>{const w=y*h*e,A=w*r+r,k=Math.pow(h,2)*Math.pow(y,2)*e,M=Math.exp(-w),R=tC(Math.pow(y,2),h);return(-o(y)+XE>0?-1:1)*((A-k)*M)/R}):(o=y=>{const b=Math.exp(-y*e),w=(y-r)*e+1;return-XE+b*w},l=y=>{const b=Math.exp(-y*e),w=(r-y)*(e*e);return b*w});const f=5/e,s=yQ(o,l,f);if(e=oc(e),isNaN(s))return{stiffness:ii.stiffness,damping:ii.damping,duration:e};{const y=Math.pow(s,2)*n;return{stiffness:y,damping:h*2*Math.sqrt(n*y),duration:e}}}const gQ=12;function yQ(e,t,r){let n=r;for(let o=1;o<gQ;o++)n=n-e(n)/t(n);return n}function tC(e,t){return e*Math.sqrt(1-t*t)}const vQ=["duration","bounce"],_Q=["stiffness","damping","mass"];function Bz(e,t){return t.some(r=>e[r]!==void 0)}function xQ(e){let t={velocity:ii.velocity,stiffness:ii.stiffness,damping:ii.damping,mass:ii.mass,isResolvedFromDuration:!1,...e};if(!Bz(e,_Q)&&Bz(e,vQ))if(e.visualDuration){const r=e.visualDuration,n=2*Math.PI/(r*1.2),o=n*n,l=2*Al(.05,1,1-(e.bounce||0))*Math.sqrt(o);t={...t,mass:ii.mass,stiffness:o,damping:l}}else{const r=mQ(e);t={...t,...r,mass:ii.mass},t.isResolvedFromDuration=!0}return t}function nw(e=ii.visualDuration,t=ii.bounce){const r=typeof e!="object"?{visualDuration:e,keyframes:[0,1],bounce:t}:e;let{restSpeed:n,restDelta:o}=r;const l=r.keyframes[0],h=r.keyframes[r.keyframes.length-1],f={done:!1,value:l},{stiffness:s,damping:y,mass:b,duration:w,velocity:A,isResolvedFromDuration:k}=xQ({...r,velocity:-Xs(r.velocity||0)}),M=A||0,R=y/(2*Math.sqrt(s*b)),j=h-l,L=Xs(Math.sqrt(s/b)),z=Math.abs(j)<5;n||(n=z?ii.restSpeed.granular:ii.restSpeed.default),o||(o=z?ii.restDelta.granular:ii.restDelta.default);let B;if(R<1){const F=tC(L,R);B=H=>{const Y=Math.exp(-R*L*H);return h-Y*((M+R*L*j)/F*Math.sin(F*H)+j*Math.cos(F*H))}}else if(R===1)B=F=>h-Math.exp(-L*F)*(j+(M+L*j)*F);else{const F=L*Math.sqrt(R*R-1);B=H=>{const Y=Math.exp(-R*L*H),te=Math.min(F*H,300);return h-Y*((M+R*L*j)*Math.sinh(te)+F*j*Math.cosh(te))/F}}const Z={calculatedDuration:k&&w||null,next:F=>{const H=B(F);if(k)f.done=F>=w;else{let Y=F===0?M:0;R<1&&(Y=F===0?oc(M):$V(B,F,H));const te=Math.abs(Y)<=n,pe=Math.abs(h-H)<=o;f.done=te&&pe}return f.value=f.done?h:H,f},toString:()=>{const F=Math.min(IM(Z),rw),H=NV(Y=>Z.next(F*Y).value,F,30);return F+"ms "+H},toTransition:()=>{}};return Z}nw.applyToOptions=e=>{const t=fQ(e,100,nw);return e.ease=t.ease,e.duration=oc(t.duration),e.type="keyframes",e};function rC({keyframes:e,velocity:t=0,power:r=.8,timeConstant:n=325,bounceDamping:o=10,bounceStiffness:l=500,modifyTarget:h,min:f,max:s,restDelta:y=.5,restSpeed:b}){const w=e[0],A={done:!1,value:w},k=te=>f!==void 0&&te<f||s!==void 0&&te>s,M=te=>f===void 0?s:s===void 0||Math.abs(f-te)<Math.abs(s-te)?f:s;let R=r*t;const j=w+R,L=h===void 0?j:h(j);L!==j&&(R=L-w);const z=te=>-R*Math.exp(-te/n),B=te=>L+z(te),Z=te=>{const pe=z(te),ue=B(te);A.done=Math.abs(pe)<=y,A.value=A.done?L:ue};let F,H;const Y=te=>{k(A.value)&&(F=te,H=nw({keyframes:[A.value,M(A.value)],velocity:$V(B,te,A.value),damping:o,stiffness:l,restDelta:y,restSpeed:b}))};return Y(0),{calculatedDuration:null,next:te=>{let pe=!1;return!H&&F===void 0&&(pe=!0,Z(te),Y(te)),F!==void 0&&te>=F?H.next(te-F):(!pe&&Z(te),A)}}}function bQ(e,t,r){const n=[],o=r||pc.mix||BV,l=e.length-1;for(let h=0;h<l;h++){let f=o(e[h],e[h+1]);if(t){const s=Array.isArray(t)?t[h]||ea:t;f=z_(s,f)}n.push(f)}return n}function wQ(e,t,{clamp:r=!0,ease:n,mixer:o}={}){const l=e.length;if(SM(l===t.length),l===1)return()=>t[0];if(l===2&&t[0]===t[1])return()=>t[1];const h=e[0]===e[1];e[0]>e[l-1]&&(e=[...e].reverse(),t=[...t].reverse());const f=bQ(t,n,o),s=f.length,y=b=>{if(h&&b<e[0])return t[0];let w=0;if(s>1)for(;w<e.length-2&&!(b<e[w+1]);w++);const A=Lv(e[w],e[w+1],b);return f[w](A)};return r?b=>y(Al(e[0],e[l-1],b)):y}function SQ(e,t){const r=e[e.length-1];for(let n=1;n<=t;n++){const o=Lv(0,t,n);e.push(Qn(r,1,o))}}function TQ(e){const t=[0];return SQ(t,e.length-1),t}function EQ(e,t){return e.map(r=>r*t)}function AQ(e,t){return e.map(()=>t||PV).splice(0,e.length-1)}function nv({duration:e=300,keyframes:t,times:r,ease:n="easeInOut"}){const o=zJ(n)?n.map(Iz):Iz(n),l={done:!1,value:t[0]},h=EQ(r&&r.length===t.length?r:TQ(t),e),f=wQ(h,t,{ease:Array.isArray(o)?o:AQ(t,o)});return{calculatedDuration:e,next:s=>(l.value=f(s),l.done=s>=e,l)}}const PQ=e=>e!==null;function RM(e,{repeat:t,repeatType:r="loop"},n,o=1){const l=e.filter(PQ),f=o<0||t&&r!=="loop"&&t%2===1?0:l.length-1;return!f||n===void 0?l[f]:n}const CQ={decay:rC,inertia:rC,tween:nv,keyframes:nv,spring:nw};function FV(e){typeof e.type=="string"&&(e.type=CQ[e.type])}class DM{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(t=>{this.resolve=t})}notifyFinished(){this.resolve()}then(t,r){return this.finished.then(t,r)}}const kQ=e=>e/100;class LM extends DM{constructor(t){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{var n,o;const{motionValue:r}=this.options;r&&r.updatedAt!==Io.now()&&this.tick(Io.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),(o=(n=this.options).onStop)==null||o.call(n))},this.options=t,this.initAnimation(),this.play(),t.autoplay===!1&&this.pause()}initAnimation(){const{options:t}=this;FV(t);const{type:r=nv,repeat:n=0,repeatDelay:o=0,repeatType:l,velocity:h=0}=t;let{keyframes:f}=t;const s=r||nv;s!==nv&&typeof f[0]!="number"&&(this.mixKeyframes=z_(kQ,BV(f[0],f[1])),f=[0,100]);const y=s({...t,keyframes:f});l==="mirror"&&(this.mirroredGenerator=s({...t,keyframes:[...f].reverse(),velocity:-h})),y.calculatedDuration===null&&(y.calculatedDuration=IM(y));const{calculatedDuration:b}=y;this.calculatedDuration=b,this.resolvedDuration=b+o,this.totalDuration=this.resolvedDuration*(n+1)-o,this.generator=y}updateTime(t){const r=Math.round(t-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=r}tick(t,r=!1){const{generator:n,totalDuration:o,mixKeyframes:l,mirroredGenerator:h,resolvedDuration:f,calculatedDuration:s}=this;if(this.startTime===null)return n.next(0);const{delay:y=0,keyframes:b,repeat:w,repeatType:A,repeatDelay:k,type:M,onUpdate:R,finalKeyframe:j}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,t):this.speed<0&&(this.startTime=Math.min(t-o/this.speed,this.startTime)),r?this.currentTime=t:this.updateTime(t);const L=this.currentTime-y*(this.playbackSpeed>=0?1:-1),z=this.playbackSpeed>=0?L<0:L>o;this.currentTime=Math.max(L,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=o);let B=this.currentTime,Z=n;if(w){const te=Math.min(this.currentTime,o)/f;let pe=Math.floor(te),ue=te%1;!ue&&te>=1&&(ue=1),ue===1&&pe--,pe=Math.min(pe,w+1),!!(pe%2)&&(A==="reverse"?(ue=1-ue,k&&(ue-=k/f)):A==="mirror"&&(Z=h)),B=Al(0,1,ue)*f}const F=z?{done:!1,value:b[0]}:Z.next(B);l&&(F.value=l(F.value));let{done:H}=F;!z&&s!==null&&(H=this.playbackSpeed>=0?this.currentTime>=o:this.currentTime<=0);const Y=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&H);return Y&&M!==rC&&(F.value=RM(b,this.options,j,this.speed)),R&&R(F.value),Y&&this.finish(),F}then(t,r){return this.finished.then(t,r)}get duration(){return Xs(this.calculatedDuration)}get iterationDuration(){const{delay:t=0}=this.options||{};return this.duration+Xs(t)}get time(){return Xs(this.currentTime)}set time(t){var r;t=oc(t),this.currentTime=t,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=t:this.driver&&(this.startTime=this.driver.now()-t/this.playbackSpeed),(r=this.driver)==null||r.start(!1)}get speed(){return this.playbackSpeed}set speed(t){this.updateTime(Io.now());const r=this.playbackSpeed!==t;this.playbackSpeed=t,r&&(this.time=Xs(this.currentTime))}play(){var o,l;if(this.isStopped)return;const{driver:t=dQ,startTime:r}=this.options;this.driver||(this.driver=t(h=>this.tick(h))),(l=(o=this.options).onPlay)==null||l.call(o);const n=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=n):this.holdTime!==null?this.startTime=n-this.holdTime:this.startTime||(this.startTime=r??n),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(Io.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){var t,r;this.notifyFinished(),this.teardown(),this.state="finished",(r=(t=this.options).onComplete)==null||r.call(t)}cancel(){var t,r;this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),(r=(t=this.options).onCancel)==null||r.call(t)}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(t){return this.startTime=0,this.tick(t,!0)}attachTimeline(t){var r;return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),(r=this.driver)==null||r.stop(),t.observe(this)}}function OQ(e){for(let t=1;t<e.length;t++)e[t]??(e[t]=e[t-1])}const ed=e=>e*180/Math.PI,nC=e=>{const t=ed(Math.atan2(e[1],e[0]));return iC(t)},MQ={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:e=>(Math.abs(e[0])+Math.abs(e[3]))/2,rotate:nC,rotateZ:nC,skewX:e=>ed(Math.atan(e[1])),skewY:e=>ed(Math.atan(e[2])),skew:e=>(Math.abs(e[1])+Math.abs(e[2]))/2},iC=e=>(e=e%360,e<0&&(e+=360),e),Nz=nC,$z=e=>Math.sqrt(e[0]*e[0]+e[1]*e[1]),Fz=e=>Math.sqrt(e[4]*e[4]+e[5]*e[5]),IQ={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:$z,scaleY:Fz,scale:e=>($z(e)+Fz(e))/2,rotateX:e=>iC(ed(Math.atan2(e[6],e[5]))),rotateY:e=>iC(ed(Math.atan2(-e[2],e[0]))),rotateZ:Nz,rotate:Nz,skewX:e=>ed(Math.atan(e[4])),skewY:e=>ed(Math.atan(e[1])),skew:e=>(Math.abs(e[1])+Math.abs(e[4]))/2};function oC(e){return e.includes("scale")?1:0}function sC(e,t){if(!e||e==="none")return oC(t);const r=e.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let n,o;if(r)n=IQ,o=r;else{const f=e.match(/^matrix\(([-\d.e\s,]+)\)$/u);n=MQ,o=f}if(!o)return oC(t);const l=n[t],h=o[1].split(",").map(DQ);return typeof l=="function"?l(h):h[l]}const RQ=(e,t)=>{const{transform:r="none"}=getComputedStyle(e);return sC(r,t)};function DQ(e){return parseFloat(e.trim())}const Tm=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Em=new Set(Tm),Uz=e=>e===Sm||e===Wt,LQ=new Set(["x","y","z"]),jQ=Tm.filter(e=>!LQ.has(e));function zQ(e){const t=[];return jQ.forEach(r=>{const n=e.getValue(r);n!==void 0&&(t.push([r,n.get()]),n.set(r.startsWith("scale")?1:0))}),t}const vu={width:({x:e},{paddingLeft:t="0",paddingRight:r="0"})=>e.max-e.min-parseFloat(t)-parseFloat(r),height:({y:e},{paddingTop:t="0",paddingBottom:r="0"})=>e.max-e.min-parseFloat(t)-parseFloat(r),top:(e,{top:t})=>parseFloat(t),left:(e,{left:t})=>parseFloat(t),bottom:({y:e},{top:t})=>parseFloat(t)+(e.max-e.min),right:({x:e},{left:t})=>parseFloat(t)+(e.max-e.min),x:(e,{transform:t})=>sC(t,"x"),y:(e,{transform:t})=>sC(t,"y")};vu.translateX=vu.x;vu.translateY=vu.y;const ud=new Set;let aC=!1,lC=!1,cC=!1;function UV(){if(lC){const e=Array.from(ud).filter(n=>n.needsMeasurement),t=new Set(e.map(n=>n.element)),r=new Map;t.forEach(n=>{const o=zQ(n);o.length&&(r.set(n,o),n.render())}),e.forEach(n=>n.measureInitialState()),t.forEach(n=>{n.render();const o=r.get(n);o&&o.forEach(([l,h])=>{var f;(f=n.getValue(l))==null||f.set(h)})}),e.forEach(n=>n.measureEndState()),e.forEach(n=>{n.suspendedScrollY!==void 0&&window.scrollTo(0,n.suspendedScrollY)})}lC=!1,aC=!1,ud.forEach(e=>e.complete(cC)),ud.clear()}function VV(){ud.forEach(e=>{e.readKeyframes(),e.needsMeasurement&&(lC=!0)})}function BQ(){cC=!0,VV(),UV(),cC=!1}class jM{constructor(t,r,n,o,l,h=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...t],this.onComplete=r,this.name=n,this.motionValue=o,this.element=l,this.isAsync=h}scheduleResolve(){this.state="scheduled",this.isAsync?(ud.add(this),aC||(aC=!0,Ln.read(VV),Ln.resolveKeyframes(UV))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:t,name:r,element:n,motionValue:o}=this;if(t[0]===null){const l=o==null?void 0:o.get(),h=t[t.length-1];if(l!==void 0)t[0]=l;else if(n&&r){const f=n.readValue(r,h);f!=null&&(t[0]=f)}t[0]===void 0&&(t[0]=h),o&&l===void 0&&o.set(t[0])}OQ(t)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(t=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,t),ud.delete(this)}cancel(){this.state==="scheduled"&&(ud.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const NQ=e=>e.startsWith("--");function $Q(e,t,r){NQ(t)?e.style.setProperty(t,r):e.style[t]=r}const FQ=TM(()=>window.ScrollTimeline!==void 0),UQ={};function VQ(e,t){const r=TM(e);return()=>UQ[t]??r()}const GV=VQ(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),Uy=([e,t,r,n])=>`cubic-bezier(${e}, ${t}, ${r}, ${n})`,Vz={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:Uy([0,.65,.55,1]),circOut:Uy([.55,0,1,.45]),backIn:Uy([.31,.01,.66,-.59]),backOut:Uy([.33,1.53,.69,.99])};function WV(e,t){if(e)return typeof e=="function"?GV()?NV(e,t):"ease-out":CV(e)?Uy(e):Array.isArray(e)?e.map(r=>WV(r,t)||Vz.easeOut):Vz[e]}function GQ(e,t,r,{delay:n=0,duration:o=300,repeat:l=0,repeatType:h="loop",ease:f="easeOut",times:s}={},y=void 0){const b={[t]:r};s&&(b.offset=s);const w=WV(f,o);Array.isArray(w)&&(b.easing=w);const A={delay:n,duration:o,easing:Array.isArray(w)?"linear":w,fill:"both",iterations:l+1,direction:h==="reverse"?"alternate":"normal"};return y&&(A.pseudoElement=y),e.animate(b,A)}function qV(e){return typeof e=="function"&&"applyToOptions"in e}function WQ({type:e,...t}){return qV(e)&&GV()?e.applyToOptions(t):(t.duration??(t.duration=300),t.ease??(t.ease="easeOut"),t)}class qQ extends DM{constructor(t){if(super(),this.finishedTime=null,this.isStopped=!1,this.manualStartTime=null,!t)return;const{element:r,name:n,keyframes:o,pseudoElement:l,allowFlatten:h=!1,finalKeyframe:f,onComplete:s}=t;this.isPseudoElement=!!l,this.allowFlatten=h,this.options=t,SM(typeof t.type!="string");const y=WQ(t);this.animation=GQ(r,n,o,y,l),y.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!l){const b=RM(o,this.options,f,this.speed);this.updateMotionValue?this.updateMotionValue(b):$Q(r,n,b),this.animation.cancel()}s==null||s(),this.notifyFinished()}}play(){this.isStopped||(this.manualStartTime=null,this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){var t,r;(r=(t=this.animation).finish)==null||r.call(t)}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:t}=this;t==="idle"||t==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){var t,r;this.isPseudoElement||(r=(t=this.animation).commitStyles)==null||r.call(t)}get duration(){var r,n;const t=((n=(r=this.animation.effect)==null?void 0:r.getComputedTiming)==null?void 0:n.call(r).duration)||0;return Xs(Number(t))}get iterationDuration(){const{delay:t=0}=this.options||{};return this.duration+Xs(t)}get time(){return Xs(Number(this.animation.currentTime)||0)}set time(t){this.manualStartTime=null,this.finishedTime=null,this.animation.currentTime=oc(t)}get speed(){return this.animation.playbackRate}set speed(t){t<0&&(this.finishedTime=null),this.animation.playbackRate=t}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return this.manualStartTime??Number(this.animation.startTime)}set startTime(t){this.manualStartTime=this.animation.startTime=t}attachTimeline({timeline:t,observe:r}){var n;return this.allowFlatten&&((n=this.animation.effect)==null||n.updateTiming({easing:"linear"})),this.animation.onfinish=null,t&&FQ()?(this.animation.timeline=t,ea):r(this)}}const HV={anticipate:TV,backInOut:SV,circInOut:AV};function HQ(e){return e in HV}function KQ(e){typeof e.ease=="string"&&HQ(e.ease)&&(e.ease=HV[e.ease])}const YE=10;class ZQ extends qQ{constructor(t){KQ(t),FV(t),super(t),t.startTime!==void 0&&(this.startTime=t.startTime),this.options=t}updateMotionValue(t){const{motionValue:r,onUpdate:n,onComplete:o,element:l,...h}=this.options;if(!r)return;if(t!==void 0){r.set(t);return}const f=new LM({...h,autoplay:!1}),s=Math.max(YE,Io.now()-this.startTime),y=Al(0,YE,s-YE);r.setWithVelocity(f.sample(Math.max(0,s-y)).value,f.sample(s).value,y),f.stop()}}const Gz=(e,t)=>t==="zIndex"?!1:!!(typeof e=="number"||Array.isArray(e)||typeof e=="string"&&(ju.test(e)||e==="0")&&!e.startsWith("url("));function XQ(e){const t=e[0];if(e.length===1)return!0;for(let r=0;r<e.length;r++)if(e[r]!==t)return!0}function YQ(e,t,r,n){const o=e[0];if(o===null)return!1;if(t==="display"||t==="visibility")return!0;const l=e[e.length-1],h=Gz(o,t),f=Gz(l,t);return!h||!f?!1:XQ(e)||(r==="spring"||qV(r))&&n}function uC(e){e.duration=0,e.type="keyframes"}const JQ=new Set(["opacity","clipPath","filter","transform"]),QQ=TM(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function eee(e){var b;const{motionValue:t,name:r,repeatDelay:n,repeatType:o,damping:l,type:h}=e;if(!(((b=t==null?void 0:t.owner)==null?void 0:b.current)instanceof HTMLElement))return!1;const{onUpdate:s,transformTemplate:y}=t.owner.getProps();return QQ()&&r&&JQ.has(r)&&(r!=="transform"||!y)&&!s&&!n&&o!=="mirror"&&l!==0&&h!=="inertia"}const tee=40;class ree extends DM{constructor({autoplay:t=!0,delay:r=0,type:n="keyframes",repeat:o=0,repeatDelay:l=0,repeatType:h="loop",keyframes:f,name:s,motionValue:y,element:b,...w}){var M;super(),this.stop=()=>{var R,j;this._animation&&(this._animation.stop(),(R=this.stopTimeline)==null||R.call(this)),(j=this.keyframeResolver)==null||j.cancel()},this.createdAt=Io.now();const A={autoplay:t,delay:r,type:n,repeat:o,repeatDelay:l,repeatType:h,name:s,motionValue:y,element:b,...w},k=(b==null?void 0:b.KeyframeResolver)||jM;this.keyframeResolver=new k(f,(R,j,L)=>this.onKeyframesResolved(R,j,A,!L),s,y,b),(M=this.keyframeResolver)==null||M.scheduleResolve()}onKeyframesResolved(t,r,n,o){this.keyframeResolver=void 0;const{name:l,type:h,velocity:f,delay:s,isHandoff:y,onUpdate:b}=n;this.resolvedAt=Io.now(),YQ(t,l,h,f)||((pc.instantAnimations||!s)&&(b==null||b(RM(t,n,r))),t[0]=t[t.length-1],uC(n),n.repeat=0);const A={startTime:o?this.resolvedAt?this.resolvedAt-this.createdAt>tee?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:r,...n,keyframes:t},k=!y&&eee(A)?new ZQ({...A,element:A.motionValue.owner.current}):new LM(A);k.finished.then(()=>this.notifyFinished()).catch(ea),this.pendingTimeline&&(this.stopTimeline=k.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=k}get finished(){return this._animation?this.animation.finished:this._finished}then(t,r){return this.finished.finally(t).then(()=>{})}get animation(){var t;return this._animation||((t=this.keyframeResolver)==null||t.resume(),BQ()),this._animation}get duration(){return this.animation.duration}get iterationDuration(){return this.animation.iterationDuration}get time(){return this.animation.time}set time(t){this.animation.time=t}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(t){this.animation.speed=t}get startTime(){return this.animation.startTime}attachTimeline(t){return this._animation?this.stopTimeline=this.animation.attachTimeline(t):this.pendingTimeline=t,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){var t;this._animation&&this.animation.cancel(),(t=this.keyframeResolver)==null||t.cancel()}}const nee=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function iee(e){const t=nee.exec(e);if(!t)return[,];const[,r,n,o]=t;return[`--${r??n}`,o]}function KV(e,t,r=1){const[n,o]=iee(e);if(!n)return;const l=window.getComputedStyle(t).getPropertyValue(n);if(l){const h=l.trim();return mV(h)?parseFloat(h):h}return CM(o)?KV(o,t,r+1):o}function zM(e,t){return(e==null?void 0:e[t])??(e==null?void 0:e.default)??e}const oee={type:"spring",stiffness:500,damping:25,restSpeed:10},see=e=>({type:"spring",stiffness:550,damping:e===0?2*Math.sqrt(550):30,restSpeed:10}),aee={type:"keyframes",duration:.8},lee={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},cee=(e,{keyframes:t})=>t.length>2?aee:Em.has(e)?e.startsWith("scale")?see(t[1]):oee:lee;function uee({when:e,delay:t,delayChildren:r,staggerChildren:n,staggerDirection:o,repeat:l,repeatType:h,repeatDelay:f,from:s,elapsed:y,...b}){return!!Object.keys(b).length}const hee=e=>e!==null;function dee(e,{repeat:t,repeatType:r="loop"},n){const o=e.filter(hee),l=t&&r!=="loop"&&t%2===1?0:o.length-1;return o[l]}function ZV(e,t,r,n=0,o=1){const l=Array.from(e).sort((y,b)=>y.sortNodePosition(b)).indexOf(t),h=e.size,f=(h-1)*n;return typeof r=="function"?r(l,h):o===1?l*n:f-l*n}const BM=(e,t,r,n={},o,l)=>h=>{const f=zM(n,e)||{},s=f.delay||n.delay||0;let{elapsed:y=0}=n;y=y-oc(s);const b={keyframes:Array.isArray(r)?r:[null,r],ease:"easeOut",velocity:t.getVelocity(),...f,delay:-y,onUpdate:A=>{t.set(A),f.onUpdate&&f.onUpdate(A)},onComplete:()=>{h(),f.onComplete&&f.onComplete()},name:e,motionValue:t,element:l?void 0:o};uee(f)||Object.assign(b,cee(e,b)),b.duration&&(b.duration=oc(b.duration)),b.repeatDelay&&(b.repeatDelay=oc(b.repeatDelay)),b.from!==void 0&&(b.keyframes[0]=b.from);let w=!1;if((b.type===!1||b.duration===0&&!b.repeatDelay)&&(uC(b),b.delay===0&&(w=!0)),(pc.instantAnimations||pc.skipAnimations)&&(w=!0,uC(b),b.delay=0),b.allowFlatten=!f.type&&!f.ease,w&&!l&&t.get()!==void 0){const A=dee(b.keyframes,f);if(A!==void 0){Ln.update(()=>{b.onUpdate(A),b.onComplete()});return}}return f.isSync?new LM(b):new ree(b)},XV=new Set(["width","height","top","left","right","bottom",...Tm]),Wz=30,fee=e=>!isNaN(parseFloat(e));class pee{constructor(t,r={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=n=>{var l;const o=Io.now();if(this.updatedAt!==o&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(n),this.current!==this.prev&&((l=this.events.change)==null||l.notify(this.current),this.dependents))for(const h of this.dependents)h.dirty()},this.hasAnimated=!1,this.setCurrent(t),this.owner=r.owner}setCurrent(t){this.current=t,this.updatedAt=Io.now(),this.canTrackVelocity===null&&t!==void 0&&(this.canTrackVelocity=fee(this.current))}setPrevFrameValue(t=this.current){this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt}onChange(t){return this.on("change",t)}on(t,r){this.events[t]||(this.events[t]=new EM);const n=this.events[t].add(r);return t==="change"?()=>{n(),Ln.read(()=>{this.events.change.getSize()||this.stop()})}:n}clearListeners(){for(const t in this.events)this.events[t].clear()}attach(t,r){this.passiveEffect=t,this.stopPassiveEffect=r}set(t){this.passiveEffect?this.passiveEffect(t,this.updateAndNotify):this.updateAndNotify(t)}setWithVelocity(t,r,n){this.set(r),this.prev=void 0,this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt-n}jump(t,r=!0){this.updateAndNotify(t),this.prev=t,this.prevUpdatedAt=this.prevFrameValue=void 0,r&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){var t;(t=this.events.change)==null||t.notify(this.current)}addDependent(t){this.dependents||(this.dependents=new Set),this.dependents.add(t)}removeDependent(t){this.dependents&&this.dependents.delete(t)}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const t=Io.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||t-this.updatedAt>Wz)return 0;const r=Math.min(this.updatedAt-this.prevUpdatedAt,Wz);return vV(parseFloat(this.current)-parseFloat(this.prevFrameValue),r)}start(t){return this.stop(),new Promise(r=>{this.hasAnimated=!0,this.animation=t(r),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){var t,r;(t=this.dependents)==null||t.clear(),(r=this.events.destroy)==null||r.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Vp(e,t){return new pee(e,t)}function qz(e){const t=[{},{}];return e==null||e.values.forEach((r,n)=>{t[0][n]=r.get(),t[1][n]=r.getVelocity()}),t}function NM(e,t,r,n){if(typeof t=="function"){const[o,l]=qz(n);t=t(r!==void 0?r:e.custom,o,l)}if(typeof t=="string"&&(t=e.variants&&e.variants[t]),typeof t=="function"){const[o,l]=qz(n);t=t(r!==void 0?r:e.custom,o,l)}return t}function Ep(e,t,r){const n=e.getProps();return NM(n,t,r!==void 0?r:n.custom,e)}const hC=e=>Array.isArray(e);function mee(e,t,r){e.hasValue(t)?e.getValue(t).set(r):e.addValue(t,Vp(r))}function gee(e){return hC(e)?e[e.length-1]||0:e}function yee(e,t){const r=Ep(e,t);let{transitionEnd:n={},transition:o={},...l}=r||{};l={...l,...n};for(const h in l){const f=gee(l[h]);mee(e,h,f)}}const To=e=>!!(e&&e.getVelocity);function vee(e){return!!(To(e)&&e.add)}function dC(e,t){const r=e.getValue("willChange");if(vee(r))return r.add(t);if(!r&&pc.WillChange){const n=new pc.WillChange("auto");e.addValue("willChange",n),n.add(t)}}function $M(e){return e.replace(/([A-Z])/g,t=>`-${t.toLowerCase()}`)}const _ee="framerAppearId",YV="data-"+$M(_ee);function JV(e){return e.props[YV]}function xee({protectedKeys:e,needsAnimating:t},r){const n=e.hasOwnProperty(r)&&t[r]!==!0;return t[r]=!1,n}function QV(e,t,{delay:r=0,transitionOverride:n,type:o}={}){let{transition:l=e.getDefaultTransition(),transitionEnd:h,...f}=t;n&&(l=n);const s=[],y=o&&e.animationState&&e.animationState.getState()[o];for(const b in f){const w=e.getValue(b,e.latestValues[b]??null),A=f[b];if(A===void 0||y&&xee(y,b))continue;const k={delay:r,...zM(l||{},b)},M=w.get();if(M!==void 0&&!w.isAnimating&&!Array.isArray(A)&&A===M&&!k.velocity)continue;let R=!1;if(window.MotionHandoffAnimation){const L=JV(e);if(L){const z=window.MotionHandoffAnimation(L,b,Ln);z!==null&&(k.startTime=z,R=!0)}}dC(e,b),w.start(BM(b,w,A,e.shouldReduceMotion&&XV.has(b)?{type:!1}:k,e,R));const j=w.animation;j&&s.push(j)}return h&&Promise.all(s).then(()=>{Ln.update(()=>{h&&yee(e,h)})}),s}function fC(e,t,r={}){var s;const n=Ep(e,t,r.type==="exit"?(s=e.presenceContext)==null?void 0:s.custom:void 0);let{transition:o=e.getDefaultTransition()||{}}=n||{};r.transitionOverride&&(o=r.transitionOverride);const l=n?()=>Promise.all(QV(e,n,r)):()=>Promise.resolve(),h=e.variantChildren&&e.variantChildren.size?(y=0)=>{const{delayChildren:b=0,staggerChildren:w,staggerDirection:A}=o;return bee(e,t,y,b,w,A,r)}:()=>Promise.resolve(),{when:f}=o;if(f){const[y,b]=f==="beforeChildren"?[l,h]:[h,l];return y().then(()=>b())}else return Promise.all([l(),h(r.delay)])}function bee(e,t,r=0,n=0,o=0,l=1,h){const f=[];for(const s of e.variantChildren)s.notify("AnimationStart",t),f.push(fC(s,t,{...h,delay:r+(typeof n=="function"?0:n)+ZV(e.variantChildren,s,n,o,l)}).then(()=>s.notify("AnimationComplete",t)));return Promise.all(f)}function wee(e,t,r={}){e.notify("AnimationStart",t);let n;if(Array.isArray(t)){const o=t.map(l=>fC(e,l,r));n=Promise.all(o)}else if(typeof t=="string")n=fC(e,t,r);else{const o=typeof t=="function"?Ep(e,t,r.custom):t;n=Promise.all(QV(e,o,r))}return n.then(()=>{e.notify("AnimationComplete",t)})}const See={test:e=>e==="auto",parse:e=>e},e6=e=>t=>t.test(e),t6=[Sm,Wt,xl,ou,XJ,ZJ,See],Hz=e=>t6.find(e6(e));function Tee(e){return typeof e=="number"?e===0:e!==null?e==="none"||e==="0"||yV(e):!0}const Eee=new Set(["brightness","contrast","saturate","opacity"]);function Aee(e){const[t,r]=e.slice(0,-1).split("(");if(t==="drop-shadow")return e;const[n]=r.match(kM)||[];if(!n)return e;const o=r.replace(n,"");let l=Eee.has(t)?1:0;return n!==r&&(l*=100),t+"("+l+o+")"}const Pee=/\b([a-z-]*)\(.*?\)/gu,pC={...ju,getAnimatableNone:e=>{const t=e.match(Pee);return t?t.map(Aee).join(" "):e}},Kz={...Sm,transform:Math.round},Cee={rotate:ou,rotateX:ou,rotateY:ou,rotateZ:ou,scale:Lx,scaleX:Lx,scaleY:Lx,scaleZ:Lx,skew:ou,skewX:ou,skewY:ou,distance:Wt,translateX:Wt,translateY:Wt,translateZ:Wt,x:Wt,y:Wt,z:Wt,perspective:Wt,transformPerspective:Wt,opacity:jv,originX:Dz,originY:Dz,originZ:Wt},FM={borderWidth:Wt,borderTopWidth:Wt,borderRightWidth:Wt,borderBottomWidth:Wt,borderLeftWidth:Wt,borderRadius:Wt,radius:Wt,borderTopLeftRadius:Wt,borderTopRightRadius:Wt,borderBottomRightRadius:Wt,borderBottomLeftRadius:Wt,width:Wt,maxWidth:Wt,height:Wt,maxHeight:Wt,top:Wt,right:Wt,bottom:Wt,left:Wt,inset:Wt,insetBlock:Wt,insetBlockStart:Wt,insetBlockEnd:Wt,insetInline:Wt,insetInlineStart:Wt,insetInlineEnd:Wt,padding:Wt,paddingTop:Wt,paddingRight:Wt,paddingBottom:Wt,paddingLeft:Wt,paddingBlock:Wt,paddingBlockStart:Wt,paddingBlockEnd:Wt,paddingInline:Wt,paddingInlineStart:Wt,paddingInlineEnd:Wt,margin:Wt,marginTop:Wt,marginRight:Wt,marginBottom:Wt,marginLeft:Wt,marginBlock:Wt,marginBlockStart:Wt,marginBlockEnd:Wt,marginInline:Wt,marginInlineStart:Wt,marginInlineEnd:Wt,backgroundPositionX:Wt,backgroundPositionY:Wt,...Cee,zIndex:Kz,fillOpacity:jv,strokeOpacity:jv,numOctaves:Kz},kee={...FM,color:vi,backgroundColor:vi,outlineColor:vi,fill:vi,stroke:vi,borderColor:vi,borderTopColor:vi,borderRightColor:vi,borderBottomColor:vi,borderLeftColor:vi,filter:pC,WebkitFilter:pC},r6=e=>kee[e];function n6(e,t){let r=r6(e);return r!==pC&&(r=ju),r.getAnimatableNone?r.getAnimatableNone(t):void 0}const Oee=new Set(["auto","none","0"]);function Mee(e,t,r){let n=0,o;for(;n<e.length&&!o;){const l=e[n];typeof l=="string"&&!Oee.has(l)&&zv(l).values.length&&(o=e[n]),n++}if(o&&r)for(const l of t)e[l]=n6(r,o)}class Iee extends jM{constructor(t,r,n,o,l){super(t,r,n,o,l,!0)}readKeyframes(){const{unresolvedKeyframes:t,element:r,name:n}=this;if(!r||!r.current)return;super.readKeyframes();for(let b=0;b<t.length;b++){let w=t[b];if(typeof w=="string"&&(w=w.trim(),CM(w))){const A=KV(w,r.current);A!==void 0&&(t[b]=A),b===t.length-1&&(this.finalKeyframe=w)}}if(this.resolveNoneKeyframes(),!XV.has(n)||t.length!==2)return;const[o,l]=t,h=Hz(o),f=Hz(l),s=Rz(o),y=Rz(l);if(s!==y&&vu[n]){this.needsMeasurement=!0;return}if(h!==f)if(Uz(h)&&Uz(f))for(let b=0;b<t.length;b++){const w=t[b];typeof w=="string"&&(t[b]=parseFloat(w))}else vu[n]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:t,name:r}=this,n=[];for(let o=0;o<t.length;o++)(t[o]===null||Tee(t[o]))&&n.push(o);n.length&&Mee(t,n,r)}measureInitialState(){const{element:t,unresolvedKeyframes:r,name:n}=this;if(!t||!t.current)return;n==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=vu[n](t.measureViewportBox(),window.getComputedStyle(t.current)),r[0]=this.measuredOrigin;const o=r[r.length-1];o!==void 0&&t.getValue(n,o).jump(o,!1)}measureEndState(){var f;const{element:t,name:r,unresolvedKeyframes:n}=this;if(!t||!t.current)return;const o=t.getValue(r);o&&o.jump(this.measuredOrigin,!1);const l=n.length-1,h=n[l];n[l]=vu[r](t.measureViewportBox(),window.getComputedStyle(t.current)),h!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=h),(f=this.removedTransforms)!=null&&f.length&&this.removedTransforms.forEach(([s,y])=>{t.getValue(s).set(y)}),this.resolveNoneKeyframes()}}function Ree(e,t,r){if(e instanceof EventTarget)return[e];if(typeof e=="string"){let n=document;const o=(r==null?void 0:r[e])??n.querySelectorAll(e);return o?Array.from(o):[]}return Array.from(e)}const i6=(e,t)=>t&&typeof e=="number"?t.transform(e):e;function o6(e){return gV(e)&&"offsetHeight"in e}const{schedule:UM}=kV(queueMicrotask,!1),Oa={x:!1,y:!1};function s6(){return Oa.x||Oa.y}function Dee(e){return e==="x"||e==="y"?Oa[e]?null:(Oa[e]=!0,()=>{Oa[e]=!1}):Oa.x||Oa.y?null:(Oa.x=Oa.y=!0,()=>{Oa.x=Oa.y=!1})}function a6(e,t){const r=Ree(e),n=new AbortController,o={passive:!0,...t,signal:n.signal};return[r,o,()=>n.abort()]}function Zz(e){return!(e.pointerType==="touch"||s6())}function Lee(e,t,r={}){const[n,o,l]=a6(e,r),h=f=>{if(!Zz(f))return;const{target:s}=f,y=t(s,f);if(typeof y!="function"||!s)return;const b=w=>{Zz(w)&&(y(w),s.removeEventListener("pointerleave",b))};s.addEventListener("pointerleave",b,o)};return n.forEach(f=>{f.addEventListener("pointerenter",h,o)}),l}const l6=(e,t)=>t?e===t?!0:l6(e,t.parentElement):!1,VM=e=>e.pointerType==="mouse"?typeof e.button!="number"||e.button<=0:e.isPrimary!==!1,jee=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function c6(e){return jee.has(e.tagName)||e.isContentEditable===!0}const bb=new WeakSet;function Xz(e){return t=>{t.key==="Enter"&&e(t)}}function JE(e,t){e.dispatchEvent(new PointerEvent("pointer"+t,{isPrimary:!0,bubbles:!0}))}const zee=(e,t)=>{const r=e.currentTarget;if(!r)return;const n=Xz(()=>{if(bb.has(r))return;JE(r,"down");const o=Xz(()=>{JE(r,"up")}),l=()=>JE(r,"cancel");r.addEventListener("keyup",o,t),r.addEventListener("blur",l,t)});r.addEventListener("keydown",n,t),r.addEventListener("blur",()=>r.removeEventListener("keydown",n),t)};function Yz(e){return VM(e)&&!s6()}function Bee(e,t,r={}){const[n,o,l]=a6(e,r),h=f=>{const s=f.currentTarget;if(!Yz(f))return;bb.add(s);const y=t(s,f),b=(k,M)=>{window.removeEventListener("pointerup",w),window.removeEventListener("pointercancel",A),bb.has(s)&&bb.delete(s),Yz(k)&&typeof y=="function"&&y(k,{success:M})},w=k=>{b(k,s===window||s===document||r.useGlobalTarget||l6(s,k.target))},A=k=>{b(k,!1)};window.addEventListener("pointerup",w,o),window.addEventListener("pointercancel",A,o)};return n.forEach(f=>{(r.useGlobalTarget?window:f).addEventListener("pointerdown",h,o),o6(f)&&(f.addEventListener("focus",y=>zee(y,o)),!c6(f)&&!f.hasAttribute("tabindex")&&(f.tabIndex=0))}),l}function u6(e){return gV(e)&&"ownerSVGElement"in e}function Nee(e){return u6(e)&&e.tagName==="svg"}const $ee=[...t6,vi,ju],Fee=e=>$ee.find(e6(e)),Jz=()=>({translate:0,scale:1,origin:0,originPoint:0}),dp=()=>({x:Jz(),y:Jz()}),Qz=()=>({min:0,max:0}),Mi=()=>({x:Qz(),y:Qz()}),mC={current:null},h6={current:!1},Uee=typeof window<"u";function Vee(){if(h6.current=!0,!!Uee)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),t=()=>mC.current=e.matches;e.addEventListener("change",t),t()}else mC.current=!1}const Gee=new WeakMap;function $1(e){return e!==null&&typeof e=="object"&&typeof e.start=="function"}function Bv(e){return typeof e=="string"||Array.isArray(e)}const GM=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],WM=["initial",...GM];function F1(e){return $1(e.animate)||WM.some(t=>Bv(e[t]))}function d6(e){return!!(F1(e)||e.variants)}function Wee(e,t,r){for(const n in t){const o=t[n],l=r[n];if(To(o))e.addValue(n,o);else if(To(l))e.addValue(n,Vp(o,{owner:e}));else if(l!==o)if(e.hasValue(n)){const h=e.getValue(n);h.liveStyle===!0?h.jump(o):h.hasAnimated||h.set(o)}else{const h=e.getStaticValue(n);e.addValue(n,Vp(h!==void 0?h:o,{owner:e}))}}for(const n in r)t[n]===void 0&&e.removeValue(n);return t}const eB=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];let iw={};function f6(e){iw=e}function qee(){return iw}class Hee{scrapeMotionValuesFromProps(t,r,n){return{}}constructor({parent:t,props:r,presenceContext:n,reducedMotionConfig:o,blockInitialAnimation:l,visualState:h},f={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=jM,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const A=Io.now();this.renderScheduledAt<A&&(this.renderScheduledAt=A,Ln.render(this.render,!1,!0))};const{latestValues:s,renderState:y}=h;this.latestValues=s,this.baseTarget={...s},this.initialValues=r.initial?{...s}:{},this.renderState=y,this.parent=t,this.props=r,this.presenceContext=n,this.depth=t?t.depth+1:0,this.reducedMotionConfig=o,this.options=f,this.blockInitialAnimation=!!l,this.isControllingVariants=F1(r),this.isVariantNode=d6(r),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(t&&t.current);const{willChange:b,...w}=this.scrapeMotionValuesFromProps(r,{},this);for(const A in w){const k=w[A];s[A]!==void 0&&To(k)&&k.set(s[A])}}mount(t){var r;this.current=t,Gee.set(t,this),this.projection&&!this.projection.instance&&this.projection.mount(t),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((n,o)=>this.bindToMotionValue(o,n)),this.reducedMotionConfig==="never"?this.shouldReduceMotion=!1:this.reducedMotionConfig==="always"?this.shouldReduceMotion=!0:(h6.current||Vee(),this.shouldReduceMotion=mC.current),(r=this.parent)==null||r.addChild(this),this.update(this.props,this.presenceContext)}unmount(){var t;this.projection&&this.projection.unmount(),Lu(this.notifyUpdate),Lu(this.render),this.valueSubscriptions.forEach(r=>r()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),(t=this.parent)==null||t.removeChild(this);for(const r in this.events)this.events[r].clear();for(const r in this.features){const n=this.features[r];n&&(n.unmount(),n.isMounted=!1)}this.current=null}addChild(t){this.children.add(t),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(t)}removeChild(t){this.children.delete(t),this.enteringChildren&&this.enteringChildren.delete(t)}bindToMotionValue(t,r){this.valueSubscriptions.has(t)&&this.valueSubscriptions.get(t)();const n=Em.has(t);n&&this.onBindTransform&&this.onBindTransform();const o=r.on("change",h=>{this.latestValues[t]=h,this.props.onUpdate&&Ln.preRender(this.notifyUpdate),n&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let l;typeof window<"u"&&window.MotionCheckAppearSync&&(l=window.MotionCheckAppearSync(this,t,r)),this.valueSubscriptions.set(t,()=>{o(),l&&l(),r.owner&&r.stop()})}sortNodePosition(t){return!this.current||!this.sortInstanceNodePosition||this.type!==t.type?0:this.sortInstanceNodePosition(this.current,t.current)}updateFeatures(){let t="animation";for(t in iw){const r=iw[t];if(!r)continue;const{isEnabled:n,Feature:o}=r;if(!this.features[t]&&o&&n(this.props)&&(this.features[t]=new o(this)),this.features[t]){const l=this.features[t];l.isMounted?l.update():(l.mount(),l.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Mi()}getStaticValue(t){return this.latestValues[t]}setStaticValue(t,r){this.latestValues[t]=r}update(t,r){(t.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=t,this.prevPresenceContext=this.presenceContext,this.presenceContext=r;for(let n=0;n<eB.length;n++){const o=eB[n];this.propEventSubscriptions[o]&&(this.propEventSubscriptions[o](),delete this.propEventSubscriptions[o]);const l="on"+o,h=t[l];h&&(this.propEventSubscriptions[o]=this.on(o,h))}this.prevMotionValues=Wee(this,this.scrapeMotionValuesFromProps(t,this.prevProps||{},this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(t){return this.props.variants?this.props.variants[t]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(t){const r=this.getClosestVariantNode();if(r)return r.variantChildren&&r.variantChildren.add(t),()=>r.variantChildren.delete(t)}addValue(t,r){const n=this.values.get(t);r!==n&&(n&&this.removeValue(t),this.bindToMotionValue(t,r),this.values.set(t,r),this.latestValues[t]=r.get())}removeValue(t){this.values.delete(t);const r=this.valueSubscriptions.get(t);r&&(r(),this.valueSubscriptions.delete(t)),delete this.latestValues[t],this.removeValueFromRenderState(t,this.renderState)}hasValue(t){return this.values.has(t)}getValue(t,r){if(this.props.values&&this.props.values[t])return this.props.values[t];let n=this.values.get(t);return n===void 0&&r!==void 0&&(n=Vp(r===null?void 0:r,{owner:this}),this.addValue(t,n)),n}readValue(t,r){let n=this.latestValues[t]!==void 0||!this.current?this.latestValues[t]:this.getBaseTargetFromProps(this.props,t)??this.readValueFromInstance(this.current,t,this.options);return n!=null&&(typeof n=="string"&&(mV(n)||yV(n))?n=parseFloat(n):!Fee(n)&&ju.test(r)&&(n=n6(t,r)),this.setBaseTarget(t,To(n)?n.get():n)),To(n)?n.get():n}setBaseTarget(t,r){this.baseTarget[t]=r}getBaseTarget(t){var l;const{initial:r}=this.props;let n;if(typeof r=="string"||typeof r=="object"){const h=NM(this.props,r,(l=this.presenceContext)==null?void 0:l.custom);h&&(n=h[t])}if(r&&n!==void 0)return n;const o=this.getBaseTargetFromProps(this.props,t);return o!==void 0&&!To(o)?o:this.initialValues[t]!==void 0&&n===void 0?void 0:this.baseTarget[t]}on(t,r){return this.events[t]||(this.events[t]=new EM),this.events[t].add(r)}notify(t,...r){this.events[t]&&this.events[t].notify(...r)}scheduleRenderMicrotask(){UM.render(this.render)}}class Vu{constructor(t){this.isMounted=!1,this.node=t}update(){}}class p6 extends Hee{constructor(){super(...arguments),this.KeyframeResolver=Iee}sortInstanceNodePosition(t,r){return t.compareDocumentPosition(r)&2?1:-1}getBaseTargetFromProps(t,r){const n=t.style;return n?n[r]:void 0}removeValueFromRenderState(t,{vars:r,style:n}){delete r[t],delete n[t]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:t}=this.props;To(t)&&(this.childSubscription=t.on("change",r=>{this.current&&(this.current.textContent=`${r}`)}))}}function m6({top:e,left:t,right:r,bottom:n}){return{x:{min:t,max:r},y:{min:e,max:n}}}function Kee({x:e,y:t}){return{top:t.min,right:e.max,bottom:t.max,left:e.min}}function Zee(e,t){if(!t)return e;const r=t({x:e.left,y:e.top}),n=t({x:e.right,y:e.bottom});return{top:r.y,left:r.x,bottom:n.y,right:n.x}}function QE(e){return e===void 0||e===1}function gC({scale:e,scaleX:t,scaleY:r}){return!QE(e)||!QE(t)||!QE(r)}function Fh(e){return gC(e)||g6(e)||e.z||e.rotate||e.rotateX||e.rotateY||e.skewX||e.skewY}function g6(e){return tB(e.x)||tB(e.y)}function tB(e){return e&&e!=="0%"}function ow(e,t,r){const n=e-r,o=t*n;return r+o}function rB(e,t,r,n,o){return o!==void 0&&(e=ow(e,o,n)),ow(e,r,n)+t}function yC(e,t=0,r=1,n,o){e.min=rB(e.min,t,r,n,o),e.max=rB(e.max,t,r,n,o)}function y6(e,{x:t,y:r}){yC(e.x,t.translate,t.scale,t.originPoint),yC(e.y,r.translate,r.scale,r.originPoint)}const nB=.999999999999,iB=1.0000000000001;function Xee(e,t,r,n=!1){const o=r.length;if(!o)return;t.x=t.y=1;let l,h;for(let f=0;f<o;f++){l=r[f],h=l.projectionDelta;const{visualElement:s}=l.options;s&&s.props.style&&s.props.style.display==="contents"||(n&&l.options.layoutScroll&&l.scroll&&l!==l.root&&pp(e,{x:-l.scroll.offset.x,y:-l.scroll.offset.y}),h&&(t.x*=h.x.scale,t.y*=h.y.scale,y6(e,h)),n&&Fh(l.latestValues)&&pp(e,l.latestValues))}t.x<iB&&t.x>nB&&(t.x=1),t.y<iB&&t.y>nB&&(t.y=1)}function fp(e,t){e.min=e.min+t,e.max=e.max+t}function oB(e,t,r,n,o=.5){const l=Qn(e.min,e.max,o);yC(e,t,r,l,n)}function pp(e,t){oB(e.x,t.x,t.scaleX,t.scale,t.originX),oB(e.y,t.y,t.scaleY,t.scale,t.originY)}function v6(e,t){return m6(Zee(e.getBoundingClientRect(),t))}function Yee(e,t,r){const n=v6(e,r),{scroll:o}=t;return o&&(fp(n.x,o.offset.x),fp(n.y,o.offset.y)),n}const Jee={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},Qee=Tm.length;function ete(e,t,r){let n="",o=!0;for(let l=0;l<Qee;l++){const h=Tm[l],f=e[h];if(f===void 0)continue;let s=!0;if(typeof f=="number"?s=f===(h.startsWith("scale")?1:0):s=parseFloat(f)===0,!s||r){const y=i6(f,FM[h]);if(!s){o=!1;const b=Jee[h]||h;n+=`${b}(${y}) `}r&&(t[h]=y)}}return n=n.trim(),r?n=r(t,o?"":n):o&&(n="none"),n}function qM(e,t,r){const{style:n,vars:o,transformOrigin:l}=e;let h=!1,f=!1;for(const s in t){const y=t[s];if(Em.has(s)){h=!0;continue}else if(MV(s)){o[s]=y;continue}else{const b=i6(y,FM[s]);s.startsWith("origin")?(f=!0,l[s]=b):n[s]=b}}if(t.transform||(h||r?n.transform=ete(t,e.transform,r):n.transform&&(n.transform="none")),f){const{originX:s="50%",originY:y="50%",originZ:b=0}=l;n.transformOrigin=`${s} ${y} ${b}`}}function _6(e,{style:t,vars:r},n,o){const l=e.style;let h;for(h in t)l[h]=t[h];o==null||o.applyProjectionStyles(l,n);for(h in r)l.setProperty(h,r[h])}function sB(e,t){return t.max===t.min?0:e/(t.max-t.min)*100}const Sy={correct:(e,t)=>{if(!t.target)return e;if(typeof e=="string")if(Wt.test(e))e=parseFloat(e);else return e;const r=sB(e,t.target.x),n=sB(e,t.target.y);return`${r}% ${n}%`}},tte={correct:(e,{treeScale:t,projectionDelta:r})=>{const n=e,o=ju.parse(e);if(o.length>5)return n;const l=ju.createTransformer(e),h=typeof o[0]!="number"?1:0,f=r.x.scale*t.x,s=r.y.scale*t.y;o[0+h]/=f,o[1+h]/=s;const y=Qn(f,s,.5);return typeof o[2+h]=="number"&&(o[2+h]/=y),typeof o[3+h]=="number"&&(o[3+h]/=y),l(o)}},vC={borderRadius:{...Sy,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:Sy,borderTopRightRadius:Sy,borderBottomLeftRadius:Sy,borderBottomRightRadius:Sy,boxShadow:tte};function x6(e,{layout:t,layoutId:r}){return Em.has(e)||e.startsWith("origin")||(t||r!==void 0)&&(!!vC[e]||e==="opacity")}function HM(e,t,r){var h;const n=e.style,o=t==null?void 0:t.style,l={};if(!n)return l;for(const f in n)(To(n[f])||o&&To(o[f])||x6(f,e)||((h=r==null?void 0:r.getValue(f))==null?void 0:h.liveStyle)!==void 0)&&(l[f]=n[f]);return l}function rte(e){return window.getComputedStyle(e)}class nte extends p6{constructor(){super(...arguments),this.type="html",this.renderInstance=_6}readValueFromInstance(t,r){var n;if(Em.has(r))return(n=this.projection)!=null&&n.isProjecting?oC(r):RQ(t,r);{const o=rte(t),l=(MV(r)?o.getPropertyValue(r):o[r])||0;return typeof l=="string"?l.trim():l}}measureInstanceViewportBox(t,{transformPagePoint:r}){return v6(t,r)}build(t,r,n){qM(t,r,n.transformTemplate)}scrapeMotionValuesFromProps(t,r,n){return HM(t,r,n)}}const ite={offset:"stroke-dashoffset",array:"stroke-dasharray"},ote={offset:"strokeDashoffset",array:"strokeDasharray"};function ste(e,t,r=1,n=0,o=!0){e.pathLength=1;const l=o?ite:ote;e[l.offset]=Wt.transform(-n);const h=Wt.transform(t),f=Wt.transform(r);e[l.array]=`${h} ${f}`}const ate=["offsetDistance","offsetPath","offsetRotate","offsetAnchor"];function b6(e,{attrX:t,attrY:r,attrScale:n,pathLength:o,pathSpacing:l=1,pathOffset:h=0,...f},s,y,b){if(qM(e,f,y),s){e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox);return}e.attrs=e.style,e.style={};const{attrs:w,style:A}=e;w.transform&&(A.transform=w.transform,delete w.transform),(A.transform||w.transformOrigin)&&(A.transformOrigin=w.transformOrigin??"50% 50%",delete w.transformOrigin),A.transform&&(A.transformBox=(b==null?void 0:b.transformBox)??"fill-box",delete w.transformBox);for(const k of ate)w[k]!==void 0&&(A[k]=w[k],delete w[k]);t!==void 0&&(w.x=t),r!==void 0&&(w.y=r),n!==void 0&&(w.scale=n),o!==void 0&&ste(w,o,l,h,!1)}const w6=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]),S6=e=>typeof e=="string"&&e.toLowerCase()==="svg";function lte(e,t,r,n){_6(e,t,void 0,n);for(const o in t.attrs)e.setAttribute(w6.has(o)?o:$M(o),t.attrs[o])}function T6(e,t,r){const n=HM(e,t,r);for(const o in e)if(To(e[o])||To(t[o])){const l=Tm.indexOf(o)!==-1?"attr"+o.charAt(0).toUpperCase()+o.substring(1):o;n[l]=e[o]}return n}class cte extends p6{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=Mi}getBaseTargetFromProps(t,r){return t[r]}readValueFromInstance(t,r){if(Em.has(r)){const n=r6(r);return n&&n.default||0}return r=w6.has(r)?r:$M(r),t.getAttribute(r)}scrapeMotionValuesFromProps(t,r,n){return T6(t,r,n)}build(t,r,n){b6(t,r,this.isSVGTag,n.transformTemplate,n.style)}renderInstance(t,r,n,o){lte(t,r,n,o)}mount(t){this.isSVGTag=S6(t.tagName),super.mount(t)}}const ute=WM.length;function E6(e){if(!e)return;if(!e.isControllingVariants){const r=e.parent?E6(e.parent)||{}:{};return e.props.initial!==void 0&&(r.initial=e.props.initial),r}const t={};for(let r=0;r<ute;r++){const n=WM[r],o=e.props[n];(Bv(o)||o===!1)&&(t[n]=o)}return t}function A6(e,t){if(!Array.isArray(t))return!1;const r=t.length;if(r!==e.length)return!1;for(let n=0;n<r;n++)if(t[n]!==e[n])return!1;return!0}const hte=[...GM].reverse(),dte=GM.length;function fte(e){return t=>Promise.all(t.map(({animation:r,options:n})=>wee(e,r,n)))}function pte(e){let t=fte(e),r=aB(),n=!0;const o=s=>(y,b)=>{var A;const w=Ep(e,b,s==="exit"?(A=e.presenceContext)==null?void 0:A.custom:void 0);if(w){const{transition:k,transitionEnd:M,...R}=w;y={...y,...R,...M}}return y};function l(s){t=s(e)}function h(s){const{props:y}=e,b=E6(e.parent)||{},w=[],A=new Set;let k={},M=1/0;for(let j=0;j<dte;j++){const L=hte[j],z=r[L],B=y[L]!==void 0?y[L]:b[L],Z=Bv(B),F=L===s?z.isActive:null;F===!1&&(M=j);let H=B===b[L]&&B!==y[L]&&Z;if(H&&n&&e.manuallyAnimateOnMount&&(H=!1),z.protectedKeys={...k},!z.isActive&&F===null||!B&&!z.prevProp||$1(B)||typeof B=="boolean")continue;const Y=mte(z.prevProp,B);let te=Y||L===s&&z.isActive&&!H&&Z||j>M&&Z,pe=!1;const ue=Array.isArray(B)?B:[B];let Ee=ue.reduce(o(L),{});F===!1&&(Ee={});const{prevResolvedValues:Oe={}}=z,je={...Oe,...Ee},Ge=tt=>{te=!0,A.has(tt)&&(pe=!0,A.delete(tt)),z.needsAnimating[tt]=!0;const ze=e.getValue(tt);ze&&(ze.liveStyle=!1)};for(const tt in je){const ze=Ee[tt],De=Oe[tt];if(k.hasOwnProperty(tt))continue;let ut=!1;hC(ze)&&hC(De)?ut=!A6(ze,De):ut=ze!==De,ut?ze!=null?Ge(tt):A.add(tt):ze!==void 0&&A.has(tt)?Ge(tt):z.protectedKeys[tt]=!0}z.prevProp=B,z.prevResolvedValues=Ee,z.isActive&&(k={...k,...Ee}),n&&e.blockInitialAnimation&&(te=!1);const Ze=H&&Y;te&&(!Ze||pe)&&w.push(...ue.map(tt=>{const ze={type:L};if(typeof tt=="string"&&n&&!Ze&&e.manuallyAnimateOnMount&&e.parent){const{parent:De}=e,ut=Ep(De,tt);if(De.enteringChildren&&ut){const{delayChildren:ht}=ut.transition||{};ze.delay=ZV(De.enteringChildren,e,ht)}}return{animation:tt,options:ze}}))}if(A.size){const j={};if(typeof y.initial!="boolean"){const L=Ep(e,Array.isArray(y.initial)?y.initial[0]:y.initial);L&&L.transition&&(j.transition=L.transition)}A.forEach(L=>{const z=e.getBaseTarget(L),B=e.getValue(L);B&&(B.liveStyle=!0),j[L]=z??null}),w.push({animation:j})}let R=!!w.length;return n&&(y.initial===!1||y.initial===y.animate)&&!e.manuallyAnimateOnMount&&(R=!1),n=!1,R?t(w):Promise.resolve()}function f(s,y){var w;if(r[s].isActive===y)return Promise.resolve();(w=e.variantChildren)==null||w.forEach(A=>{var k;return(k=A.animationState)==null?void 0:k.setActive(s,y)}),r[s].isActive=y;const b=h(s);for(const A in r)r[A].protectedKeys={};return b}return{animateChanges:h,setActive:f,setAnimateFunction:l,getState:()=>r,reset:()=>{r=aB()}}}function mte(e,t){return typeof t=="string"?t!==e:Array.isArray(t)?!A6(t,e):!1}function Lh(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function aB(){return{animate:Lh(!0),whileInView:Lh(),whileHover:Lh(),whileTap:Lh(),whileDrag:Lh(),whileFocus:Lh(),exit:Lh()}}const P6=1e-4,gte=1-P6,yte=1+P6,C6=.01,vte=0-C6,_te=0+C6;function Ro(e){return e.max-e.min}function xte(e,t,r){return Math.abs(e-t)<=r}function lB(e,t,r,n=.5){e.origin=n,e.originPoint=Qn(t.min,t.max,e.origin),e.scale=Ro(r)/Ro(t),e.translate=Qn(r.min,r.max,e.origin)-e.originPoint,(e.scale>=gte&&e.scale<=yte||isNaN(e.scale))&&(e.scale=1),(e.translate>=vte&&e.translate<=_te||isNaN(e.translate))&&(e.translate=0)}function iv(e,t,r,n){lB(e.x,t.x,r.x,n?n.originX:void 0),lB(e.y,t.y,r.y,n?n.originY:void 0)}function cB(e,t,r){e.min=r.min+t.min,e.max=e.min+Ro(t)}function bte(e,t,r){cB(e.x,t.x,r.x),cB(e.y,t.y,r.y)}function uB(e,t,r){e.min=t.min-r.min,e.max=e.min+Ro(t)}function sw(e,t,r){uB(e.x,t.x,r.x),uB(e.y,t.y,r.y)}function hB(e,t,r,n,o){return e-=t,e=ow(e,1/r,n),o!==void 0&&(e=ow(e,1/o,n)),e}function wte(e,t=0,r=1,n=.5,o,l=e,h=e){if(xl.test(t)&&(t=parseFloat(t),t=Qn(h.min,h.max,t/100)-h.min),typeof t!="number")return;let f=Qn(l.min,l.max,n);e===l&&(f-=t),e.min=hB(e.min,t,r,f,o),e.max=hB(e.max,t,r,f,o)}function dB(e,t,[r,n,o],l,h){wte(e,t[r],t[n],t[o],t.scale,l,h)}const Ste=["x","scaleX","originX"],Tte=["y","scaleY","originY"];function fB(e,t,r,n){dB(e.x,t,Ste,r?r.x:void 0,n?n.x:void 0),dB(e.y,t,Tte,r?r.y:void 0,n?n.y:void 0)}function pB(e,t){e.min=t.min,e.max=t.max}function Ea(e,t){pB(e.x,t.x),pB(e.y,t.y)}function mB(e,t){e.translate=t.translate,e.scale=t.scale,e.originPoint=t.originPoint,e.origin=t.origin}function gB(e){return e.translate===0&&e.scale===1}function k6(e){return gB(e.x)&&gB(e.y)}function yB(e,t){return e.min===t.min&&e.max===t.max}function Ete(e,t){return yB(e.x,t.x)&&yB(e.y,t.y)}function vB(e,t){return Math.round(e.min)===Math.round(t.min)&&Math.round(e.max)===Math.round(t.max)}function O6(e,t){return vB(e.x,t.x)&&vB(e.y,t.y)}function _B(e){return Ro(e.x)/Ro(e.y)}function xB(e,t){return e.translate===t.translate&&e.scale===t.scale&&e.originPoint===t.originPoint}function Gs(e){return[e("x"),e("y")]}function Ate(e,t,r){let n="";const o=e.x.translate/t.x,l=e.y.translate/t.y,h=(r==null?void 0:r.z)||0;if((o||l||h)&&(n=`translate3d(${o}px, ${l}px, ${h}px) `),(t.x!==1||t.y!==1)&&(n+=`scale(${1/t.x}, ${1/t.y}) `),r){const{transformPerspective:y,rotate:b,rotateX:w,rotateY:A,skewX:k,skewY:M}=r;y&&(n=`perspective(${y}px) ${n}`),b&&(n+=`rotate(${b}deg) `),w&&(n+=`rotateX(${w}deg) `),A&&(n+=`rotateY(${A}deg) `),k&&(n+=`skewX(${k}deg) `),M&&(n+=`skewY(${M}deg) `)}const f=e.x.scale*t.x,s=e.y.scale*t.y;return(f!==1||s!==1)&&(n+=`scale(${f}, ${s})`),n||"none"}const M6=["TopLeft","TopRight","BottomLeft","BottomRight"],Pte=M6.length,bB=e=>typeof e=="string"?parseFloat(e):e,wB=e=>typeof e=="number"||Wt.test(e);function Cte(e,t,r,n,o,l){o?(e.opacity=Qn(0,r.opacity??1,kte(n)),e.opacityExit=Qn(t.opacity??1,0,Ote(n))):l&&(e.opacity=Qn(t.opacity??1,r.opacity??1,n));for(let h=0;h<Pte;h++){const f=`border${M6[h]}Radius`;let s=SB(t,f),y=SB(r,f);if(s===void 0&&y===void 0)continue;s||(s=0),y||(y=0),s===0||y===0||wB(s)===wB(y)?(e[f]=Math.max(Qn(bB(s),bB(y),n),0),(xl.test(y)||xl.test(s))&&(e[f]+="%")):e[f]=y}(t.rotate||r.rotate)&&(e.rotate=Qn(t.rotate||0,r.rotate||0,n))}function SB(e,t){return e[t]!==void 0?e[t]:e.borderRadius}const kte=I6(0,.5,EV),Ote=I6(.5,.95,ea);function I6(e,t,r){return n=>n<e?0:n>t?1:r(Lv(e,t,n))}function Mte(e,t){const r=Io.now(),n=({timestamp:o})=>{const l=o-r;l>=t&&(Lu(n),e(l-t))};return Ln.setup(n,!0),()=>Lu(n)}function Nv(e,t,r,n={passive:!0}){return e.addEventListener(t,r,n),()=>e.removeEventListener(t,r)}function wb(e){return To(e)?e.get():e}function Ite(e,t,r){const n=To(e)?e:Vp(e);return n.start(BM("",n,t,r)),n.animation}const Rte=(e,t)=>e.depth-t.depth;class Dte{constructor(){this.children=[],this.isDirty=!1}add(t){bM(this.children,t),this.isDirty=!0}remove(t){wM(this.children,t),this.isDirty=!0}forEach(t){this.isDirty&&this.children.sort(Rte),this.isDirty=!1,this.children.forEach(t)}}class Lte{constructor(){this.members=[]}add(t){bM(this.members,t),t.scheduleRender()}remove(t){if(wM(this.members,t),t===this.prevLead&&(this.prevLead=void 0),t===this.lead){const r=this.members[this.members.length-1];r&&this.promote(r)}}relegate(t){const r=this.members.findIndex(o=>t===o);if(r===0)return!1;let n;for(let o=r;o>=0;o--){const l=this.members[o];if(l.isPresent!==!1){n=l;break}}return n?(this.promote(n),!0):!1}promote(t,r){const n=this.lead;if(t!==n&&(this.prevLead=n,this.lead=t,t.show(),n)){n.instance&&n.scheduleRender(),t.scheduleRender(),t.resumeFrom=n,r&&(t.resumeFrom.preserveOpacity=!0),n.snapshot&&(t.snapshot=n.snapshot,t.snapshot.latestValues=n.animationValues||n.latestValues),t.root&&t.root.isUpdating&&(t.isLayoutDirty=!0);const{crossfade:o}=t.options;o===!1&&n.hide()}}exitAnimationComplete(){this.members.forEach(t=>{const{options:r,resumingFrom:n}=t;r.onExitComplete&&r.onExitComplete(),n&&n.options.onExitComplete&&n.options.onExitComplete()})}scheduleRender(){this.members.forEach(t=>{t.instance&&t.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}const Sb={hasAnimatedSinceResize:!0,hasEverUpdated:!1},eA=["","X","Y","Z"],jte=1e3;let zte=0;function tA(e,t,r,n){const{latestValues:o}=t;o[e]&&(r[e]=o[e],t.setStaticValue(e,0),n&&(n[e]=0))}function R6(e){if(e.hasCheckedOptimisedAppear=!0,e.root===e)return;const{visualElement:t}=e.options;if(!t)return;const r=JV(t);if(window.MotionHasOptimisedAnimation(r,"transform")){const{layout:o,layoutId:l}=e.options;window.MotionCancelOptimisedAnimation(r,"transform",Ln,!(o||l))}const{parent:n}=e;n&&!n.hasCheckedOptimisedAppear&&R6(n)}function D6({attachResizeListener:e,defaultParent:t,measureScroll:r,checkIsScrollRoot:n,resetTransform:o}){return class{constructor(h={},f=t==null?void 0:t()){this.id=zte++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.layoutVersion=0,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach($te),this.nodes.forEach(Gte),this.nodes.forEach(Wte),this.nodes.forEach(Fte)},this.resolvedRelativeTargetAt=0,this.linkedParentVersion=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=h,this.root=f?f.root||f:this,this.path=f?[...f.path,f]:[],this.parent=f,this.depth=f?f.depth+1:0;for(let s=0;s<this.path.length;s++)this.path[s].shouldResetTransform=!0;this.root===this&&(this.nodes=new Dte)}addEventListener(h,f){return this.eventHandlers.has(h)||this.eventHandlers.set(h,new EM),this.eventHandlers.get(h).add(f)}notifyListeners(h,...f){const s=this.eventHandlers.get(h);s&&s.notify(...f)}hasListeners(h){return this.eventHandlers.has(h)}mount(h){if(this.instance)return;this.isSVG=u6(h)&&!Nee(h),this.instance=h;const{layoutId:f,layout:s,visualElement:y}=this.options;if(y&&!y.current&&y.mount(h),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(s||f)&&(this.isLayoutDirty=!0),e){let b,w=0;const A=()=>this.root.updateBlockedByResize=!1;Ln.read(()=>{w=window.innerWidth}),e(h,()=>{const k=window.innerWidth;k!==w&&(w=k,this.root.updateBlockedByResize=!0,b&&b(),b=Mte(A,250),Sb.hasAnimatedSinceResize&&(Sb.hasAnimatedSinceResize=!1,this.nodes.forEach(AB)))})}f&&this.root.registerSharedNode(f,this),this.options.animate!==!1&&y&&(f||s)&&this.addEventListener("didUpdate",({delta:b,hasLayoutChanged:w,hasRelativeLayoutChanged:A,layout:k})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const M=this.options.transition||y.getDefaultTransition()||Xte,{onLayoutAnimationStart:R,onLayoutAnimationComplete:j}=y.getProps(),L=!this.targetLayout||!O6(this.targetLayout,k),z=!w&&A;if(this.options.layoutRoot||this.resumeFrom||z||w&&(L||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const B={...zM(M,"layout"),onPlay:R,onComplete:j};(y.shouldReduceMotion||this.options.layoutRoot)&&(B.delay=0,B.type=!1),this.startAnimation(B),this.setAnimationOrigin(b,z)}else w||AB(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=k})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const h=this.getStack();h&&h.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),Lu(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(qte),this.animationId++)}getTransformTemplate(){const{visualElement:h}=this.options;return h&&h.getProps().transformTemplate}willUpdate(h=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&R6(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let b=0;b<this.path.length;b++){const w=this.path[b];w.shouldResetTransform=!0,w.updateScroll("snapshot"),w.options.layoutRoot&&w.willUpdate(!1)}const{layoutId:f,layout:s}=this.options;if(f===void 0&&!s)return;const y=this.getTransformTemplate();this.prevTransformTemplateValue=y?y(this.latestValues,""):void 0,this.updateSnapshot(),h&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(TB);return}if(this.animationId<=this.animationCommitId){this.nodes.forEach(EB);return}this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(Vte),this.nodes.forEach(Bte),this.nodes.forEach(Nte)):this.nodes.forEach(EB),this.clearAllSnapshots();const f=Io.now();to.delta=Al(0,1e3/60,f-to.timestamp),to.timestamp=f,to.isProcessing=!0,qE.update.process(to),qE.preRender.process(to),qE.render.process(to),to.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,UM.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(Ute),this.sharedNodes.forEach(Hte)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,Ln.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){Ln.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!Ro(this.snapshot.measuredBox.x)&&!Ro(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let s=0;s<this.path.length;s++)this.path[s].updateScroll();const h=this.layout;this.layout=this.measure(!1),this.layoutVersion++,this.layoutCorrected=Mi(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:f}=this.options;f&&f.notify("LayoutMeasure",this.layout.layoutBox,h?h.layoutBox:void 0)}updateScroll(h="measure"){let f=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===h&&(f=!1),f&&this.instance){const s=n(this.instance);this.scroll={animationId:this.root.animationId,phase:h,isRoot:s,offset:r(this.instance),wasRoot:this.scroll?this.scroll.isRoot:s}}}resetTransform(){if(!o)return;const h=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,f=this.projectionDelta&&!k6(this.projectionDelta),s=this.getTransformTemplate(),y=s?s(this.latestValues,""):void 0,b=y!==this.prevTransformTemplateValue;h&&this.instance&&(f||Fh(this.latestValues)||b)&&(o(this.instance,y),this.shouldResetTransform=!1,this.scheduleRender())}measure(h=!0){const f=this.measurePageBox();let s=this.removeElementScroll(f);return h&&(s=this.removeTransform(s)),Yte(s),{animationId:this.root.animationId,measuredBox:f,layoutBox:s,latestValues:{},source:this.id}}measurePageBox(){var y;const{visualElement:h}=this.options;if(!h)return Mi();const f=h.measureViewportBox();if(!(((y=this.scroll)==null?void 0:y.wasRoot)||this.path.some(Jte))){const{scroll:b}=this.root;b&&(fp(f.x,b.offset.x),fp(f.y,b.offset.y))}return f}removeElementScroll(h){var s;const f=Mi();if(Ea(f,h),(s=this.scroll)!=null&&s.wasRoot)return f;for(let y=0;y<this.path.length;y++){const b=this.path[y],{scroll:w,options:A}=b;b!==this.root&&w&&A.layoutScroll&&(w.wasRoot&&Ea(f,h),fp(f.x,w.offset.x),fp(f.y,w.offset.y))}return f}applyTransform(h,f=!1){const s=Mi();Ea(s,h);for(let y=0;y<this.path.length;y++){const b=this.path[y];!f&&b.options.layoutScroll&&b.scroll&&b!==b.root&&pp(s,{x:-b.scroll.offset.x,y:-b.scroll.offset.y}),Fh(b.latestValues)&&pp(s,b.latestValues)}return Fh(this.latestValues)&&pp(s,this.latestValues),s}removeTransform(h){const f=Mi();Ea(f,h);for(let s=0;s<this.path.length;s++){const y=this.path[s];if(!y.instance||!Fh(y.latestValues))continue;gC(y.latestValues)&&y.updateSnapshot();const b=Mi(),w=y.measurePageBox();Ea(b,w),fB(f,y.latestValues,y.snapshot?y.snapshot.layoutBox:void 0,b)}return Fh(this.latestValues)&&fB(f,this.latestValues),f}setTargetDelta(h){this.targetDelta=h,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(h){this.options={...this.options,...h,crossfade:h.crossfade!==void 0?h.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==to.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(h=!1){var k;const f=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=f.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=f.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=f.isSharedProjectionDirty);const s=!!this.resumingFrom||this!==f;if(!(h||s&&this.isSharedProjectionDirty||this.isProjectionDirty||(k=this.parent)!=null&&k.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:b,layoutId:w}=this.options;if(!this.layout||!(b||w))return;this.resolvedRelativeTargetAt=to.timestamp;const A=this.getClosestProjectingParent();A&&this.linkedParentVersion!==A.layoutVersion&&!A.options.layoutRoot&&this.removeRelativeTarget(),!this.targetDelta&&!this.relativeTarget&&(A&&A.layout?this.createRelativeTarget(A,this.layout.layoutBox,A.layout.layoutBox):this.removeRelativeTarget()),!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=Mi(),this.targetWithTransforms=Mi()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),bte(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):Ea(this.target,this.layout.layoutBox),y6(this.target,this.targetDelta)):Ea(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget&&(this.attemptToResolveRelativeTarget=!1,A&&!!A.resumingFrom==!!this.resumingFrom&&!A.options.layoutScroll&&A.target&&this.animationProgress!==1?this.createRelativeTarget(A,this.target,A.target):this.relativeParent=this.relativeTarget=void 0))}getClosestProjectingParent(){if(!(!this.parent||gC(this.parent.latestValues)||g6(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}createRelativeTarget(h,f,s){this.relativeParent=h,this.linkedParentVersion=h.layoutVersion,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Mi(),this.relativeTargetOrigin=Mi(),sw(this.relativeTargetOrigin,f,s),Ea(this.relativeTarget,this.relativeTargetOrigin)}removeRelativeTarget(){this.relativeParent=this.relativeTarget=void 0}calcProjection(){var M;const h=this.getLead(),f=!!this.resumingFrom||this!==h;let s=!0;if((this.isProjectionDirty||(M=this.parent)!=null&&M.isProjectionDirty)&&(s=!1),f&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(s=!1),this.resolvedRelativeTargetAt===to.timestamp&&(s=!1),s)return;const{layout:y,layoutId:b}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(y||b))return;Ea(this.layoutCorrected,this.layout.layoutBox);const w=this.treeScale.x,A=this.treeScale.y;Xee(this.layoutCorrected,this.treeScale,this.path,f),h.layout&&!h.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(h.target=h.layout.layoutBox,h.targetWithTransforms=Mi());const{target:k}=h;if(!k){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(mB(this.prevProjectionDelta.x,this.projectionDelta.x),mB(this.prevProjectionDelta.y,this.projectionDelta.y)),iv(this.projectionDelta,this.layoutCorrected,k,this.latestValues),(this.treeScale.x!==w||this.treeScale.y!==A||!xB(this.projectionDelta.x,this.prevProjectionDelta.x)||!xB(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",k))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(h=!0){var f;if((f=this.options.visualElement)==null||f.scheduleRender(),h){const s=this.getStack();s&&s.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=dp(),this.projectionDelta=dp(),this.projectionDeltaWithTransform=dp()}setAnimationOrigin(h,f=!1){const s=this.snapshot,y=s?s.latestValues:{},b={...this.latestValues},w=dp();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!f;const A=Mi(),k=s?s.source:void 0,M=this.layout?this.layout.source:void 0,R=k!==M,j=this.getStack(),L=!j||j.members.length<=1,z=!!(R&&!L&&this.options.crossfade===!0&&!this.path.some(Zte));this.animationProgress=0;let B;this.mixTargetDelta=Z=>{const F=Z/1e3;PB(w.x,h.x,F),PB(w.y,h.y,F),this.setTargetDelta(w),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(sw(A,this.layout.layoutBox,this.relativeParent.layout.layoutBox),Kte(this.relativeTarget,this.relativeTargetOrigin,A,F),B&&Ete(this.relativeTarget,B)&&(this.isProjectionDirty=!1),B||(B=Mi()),Ea(B,this.relativeTarget)),R&&(this.animationValues=b,Cte(b,y,this.latestValues,F,z,L)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=F},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(h){var f,s,y;this.notifyListeners("animationStart"),(f=this.currentAnimation)==null||f.stop(),(y=(s=this.resumingFrom)==null?void 0:s.currentAnimation)==null||y.stop(),this.pendingAnimation&&(Lu(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=Ln.update(()=>{Sb.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=Vp(0)),this.currentAnimation=Ite(this.motionValue,[0,1e3],{...h,velocity:0,isSync:!0,onUpdate:b=>{this.mixTargetDelta(b),h.onUpdate&&h.onUpdate(b)},onStop:()=>{},onComplete:()=>{h.onComplete&&h.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const h=this.getStack();h&&h.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(jte),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const h=this.getLead();let{targetWithTransforms:f,target:s,layout:y,latestValues:b}=h;if(!(!f||!s||!y)){if(this!==h&&this.layout&&y&&L6(this.options.animationType,this.layout.layoutBox,y.layoutBox)){s=this.target||Mi();const w=Ro(this.layout.layoutBox.x);s.x.min=h.target.x.min,s.x.max=s.x.min+w;const A=Ro(this.layout.layoutBox.y);s.y.min=h.target.y.min,s.y.max=s.y.min+A}Ea(f,s),pp(f,b),iv(this.projectionDeltaWithTransform,this.layoutCorrected,f,b)}}registerSharedNode(h,f){this.sharedNodes.has(h)||this.sharedNodes.set(h,new Lte),this.sharedNodes.get(h).add(f);const y=f.options.initialPromotionConfig;f.promote({transition:y?y.transition:void 0,preserveFollowOpacity:y&&y.shouldPreserveFollowOpacity?y.shouldPreserveFollowOpacity(f):void 0})}isLead(){const h=this.getStack();return h?h.lead===this:!0}getLead(){var f;const{layoutId:h}=this.options;return h?((f=this.getStack())==null?void 0:f.lead)||this:this}getPrevLead(){var f;const{layoutId:h}=this.options;return h?(f=this.getStack())==null?void 0:f.prevLead:void 0}getStack(){const{layoutId:h}=this.options;if(h)return this.root.sharedNodes.get(h)}promote({needsReset:h,transition:f,preserveFollowOpacity:s}={}){const y=this.getStack();y&&y.promote(this,s),h&&(this.projectionDelta=void 0,this.needsReset=!0),f&&this.setOptions({transition:f})}relegate(){const h=this.getStack();return h?h.relegate(this):!1}resetSkewAndRotation(){const{visualElement:h}=this.options;if(!h)return;let f=!1;const{latestValues:s}=h;if((s.z||s.rotate||s.rotateX||s.rotateY||s.rotateZ||s.skewX||s.skewY)&&(f=!0),!f)return;const y={};s.z&&tA("z",h,y,this.animationValues);for(let b=0;b<eA.length;b++)tA(`rotate${eA[b]}`,h,y,this.animationValues),tA(`skew${eA[b]}`,h,y,this.animationValues);h.render();for(const b in y)h.setStaticValue(b,y[b]),this.animationValues&&(this.animationValues[b]=y[b]);h.scheduleRender()}applyProjectionStyles(h,f){if(!this.instance||this.isSVG)return;if(!this.isVisible){h.visibility="hidden";return}const s=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,h.visibility="",h.opacity="",h.pointerEvents=wb(f==null?void 0:f.pointerEvents)||"",h.transform=s?s(this.latestValues,""):"none";return}const y=this.getLead();if(!this.projectionDelta||!this.layout||!y.target){this.options.layoutId&&(h.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,h.pointerEvents=wb(f==null?void 0:f.pointerEvents)||""),this.hasProjected&&!Fh(this.latestValues)&&(h.transform=s?s({},""):"none",this.hasProjected=!1);return}h.visibility="";const b=y.animationValues||y.latestValues;this.applyTransformsToTarget();let w=Ate(this.projectionDeltaWithTransform,this.treeScale,b);s&&(w=s(b,w)),h.transform=w;const{x:A,y:k}=this.projectionDelta;h.transformOrigin=`${A.origin*100}% ${k.origin*100}% 0`,y.animationValues?h.opacity=y===this?b.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:b.opacityExit:h.opacity=y===this?b.opacity!==void 0?b.opacity:"":b.opacityExit!==void 0?b.opacityExit:0;for(const M in vC){if(b[M]===void 0)continue;const{correct:R,applyTo:j,isCSSVariable:L}=vC[M],z=w==="none"?b[M]:R(b[M],y);if(j){const B=j.length;for(let Z=0;Z<B;Z++)h[j[Z]]=z}else L?this.options.visualElement.renderState.vars[M]=z:h[M]=z}this.options.layoutId&&(h.pointerEvents=y===this?wb(f==null?void 0:f.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(h=>{var f;return(f=h.currentAnimation)==null?void 0:f.stop()}),this.root.nodes.forEach(TB),this.root.sharedNodes.clear()}}}function Bte(e){e.updateLayout()}function Nte(e){var r;const t=((r=e.resumeFrom)==null?void 0:r.snapshot)||e.snapshot;if(e.isLead()&&e.layout&&t&&e.hasListeners("didUpdate")){const{layoutBox:n,measuredBox:o}=e.layout,{animationType:l}=e.options,h=t.source!==e.layout.source;l==="size"?Gs(w=>{const A=h?t.measuredBox[w]:t.layoutBox[w],k=Ro(A);A.min=n[w].min,A.max=A.min+k}):L6(l,t.layoutBox,n)&&Gs(w=>{const A=h?t.measuredBox[w]:t.layoutBox[w],k=Ro(n[w]);A.max=A.min+k,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[w].max=e.relativeTarget[w].min+k)});const f=dp();iv(f,n,t.layoutBox);const s=dp();h?iv(s,e.applyTransform(o,!0),t.measuredBox):iv(s,n,t.layoutBox);const y=!k6(f);let b=!1;if(!e.resumeFrom){const w=e.getClosestProjectingParent();if(w&&!w.resumeFrom){const{snapshot:A,layout:k}=w;if(A&&k){const M=Mi();sw(M,t.layoutBox,A.layoutBox);const R=Mi();sw(R,n,k.layoutBox),O6(M,R)||(b=!0),w.options.layoutRoot&&(e.relativeTarget=R,e.relativeTargetOrigin=M,e.relativeParent=w)}}}e.notifyListeners("didUpdate",{layout:n,snapshot:t,delta:s,layoutDelta:f,hasLayoutChanged:y,hasRelativeLayoutChanged:b})}else if(e.isLead()){const{onExitComplete:n}=e.options;n&&n()}e.options.transition=void 0}function $te(e){e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=!!(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function Fte(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function Ute(e){e.clearSnapshot()}function TB(e){e.clearMeasurements()}function EB(e){e.isLayoutDirty=!1}function Vte(e){const{visualElement:t}=e.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),e.resetTransform()}function AB(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function Gte(e){e.resolveTargetDelta()}function Wte(e){e.calcProjection()}function qte(e){e.resetSkewAndRotation()}function Hte(e){e.removeLeadSnapshot()}function PB(e,t,r){e.translate=Qn(t.translate,0,r),e.scale=Qn(t.scale,1,r),e.origin=t.origin,e.originPoint=t.originPoint}function CB(e,t,r,n){e.min=Qn(t.min,r.min,n),e.max=Qn(t.max,r.max,n)}function Kte(e,t,r,n){CB(e.x,t.x,r.x,n),CB(e.y,t.y,r.y,n)}function Zte(e){return e.animationValues&&e.animationValues.opacityExit!==void 0}const Xte={duration:.45,ease:[.4,0,.1,1]},kB=e=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(e),OB=kB("applewebkit/")&&!kB("chrome/")?Math.round:ea;function MB(e){e.min=OB(e.min),e.max=OB(e.max)}function Yte(e){MB(e.x),MB(e.y)}function L6(e,t,r){return e==="position"||e==="preserve-aspect"&&!xte(_B(t),_B(r),.2)}function Jte(e){var t;return e!==e.root&&((t=e.scroll)==null?void 0:t.wasRoot)}const Qte=D6({attachResizeListener:(e,t)=>Nv(e,"resize",t),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),rA={current:void 0},j6=D6({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!rA.current){const e=new Qte({});e.mount(window),e.setOptions({layoutScroll:!0}),rA.current=e}return rA.current},resetTransform:(e,t)=>{e.style.transform=t!==void 0?t:"none"},checkIsScrollRoot:e=>window.getComputedStyle(e).position==="fixed"}),KM=re.createContext({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"});function IB(e,t){if(typeof e=="function")return e(t);e!=null&&(e.current=t)}function ere(...e){return t=>{let r=!1;const n=e.map(o=>{const l=IB(o,t);return!r&&typeof l=="function"&&(r=!0),l});if(r)return()=>{for(let o=0;o<n.length;o++){const l=n[o];typeof l=="function"?l():IB(e[o],null)}}}}function tre(...e){return re.useCallback(ere(...e),e)}class rre extends re.Component{getSnapshotBeforeUpdate(t){const r=this.props.childRef.current;if(r&&t.isPresent&&!this.props.isPresent){const n=r.offsetParent,o=o6(n)&&n.offsetWidth||0,l=this.props.sizeRef.current;l.height=r.offsetHeight||0,l.width=r.offsetWidth||0,l.top=r.offsetTop,l.left=r.offsetLeft,l.right=o-l.width-l.left}return null}componentDidUpdate(){}render(){return this.props.children}}function nre({children:e,isPresent:t,anchorX:r,root:n}){var b;const o=re.useId(),l=re.useRef(null),h=re.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:f}=re.useContext(KM),s=((b=e.props)==null?void 0:b.ref)??(e==null?void 0:e.ref),y=tre(l,s);return re.useInsertionEffect(()=>{const{width:w,height:A,top:k,left:M,right:R}=h.current;if(t||!l.current||!w||!A)return;const j=r==="left"?`left: ${M}`:`right: ${R}`;l.current.dataset.motionPopId=o;const L=document.createElement("style");f&&(L.nonce=f);const z=n??document.head;return z.appendChild(L),L.sheet&&L.sheet.insertRule(`
          [data-motion-pop-id="${o}"] {
            position: absolute !important;
            width: ${w}px !important;
            height: ${A}px !important;
            ${j}px !important;
            top: ${k}px !important;
          }
        `),()=>{z.contains(L)&&z.removeChild(L)}},[t]),W.jsx(rre,{isPresent:t,childRef:l,sizeRef:h,children:re.cloneElement(e,{ref:y})})}const ire=({children:e,initial:t,isPresent:r,onExitComplete:n,custom:o,presenceAffectsLayout:l,mode:h,anchorX:f,root:s})=>{const y=xM(ore),b=re.useId();let w=!0,A=re.useMemo(()=>(w=!1,{id:b,initial:t,isPresent:r,custom:o,onExitComplete:k=>{y.set(k,!0);for(const M of y.values())if(!M)return;n&&n()},register:k=>(y.set(k,!1),()=>y.delete(k))}),[r,y,n]);return l&&w&&(A={...A}),re.useMemo(()=>{y.forEach((k,M)=>y.set(M,!1))},[r]),re.useEffect(()=>{!r&&!y.size&&n&&n()},[r]),h==="popLayout"&&(e=W.jsx(nre,{isPresent:r,anchorX:f,root:s,children:e})),W.jsx(N1.Provider,{value:A,children:e})};function ore(){return new Map}function z6(e=!0){const t=re.useContext(N1);if(t===null)return[!0,null];const{isPresent:r,onExitComplete:n,register:o}=t,l=re.useId();re.useEffect(()=>{if(e)return o(l)},[e]);const h=re.useCallback(()=>e&&n&&n(l),[l,n,e]);return!r&&n?[!1,h]:[!0]}const jx=e=>e.key||"";function RB(e){const t=[];return re.Children.forEach(e,r=>{re.isValidElement(r)&&t.push(r)}),t}const _C=({children:e,custom:t,initial:r=!0,onExitComplete:n,presenceAffectsLayout:o=!0,mode:l="sync",propagate:h=!1,anchorX:f="left",root:s})=>{const[y,b]=z6(h),w=re.useMemo(()=>RB(e),[e]),A=h&&!y?[]:w.map(jx),k=re.useRef(!0),M=re.useRef(w),R=xM(()=>new Map),j=re.useRef(new Set),[L,z]=re.useState(w),[B,Z]=re.useState(w);pV(()=>{k.current=!1,M.current=w;for(let Y=0;Y<B.length;Y++){const te=jx(B[Y]);A.includes(te)?(R.delete(te),j.current.delete(te)):R.get(te)!==!0&&R.set(te,!1)}},[B,A.length,A.join("-")]);const F=[];if(w!==L){let Y=[...w];for(let te=0;te<B.length;te++){const pe=B[te],ue=jx(pe);A.includes(ue)||(Y.splice(te,0,pe),F.push(pe))}return l==="wait"&&F.length&&(Y=F),Z(RB(Y)),z(w),null}const{forceRender:H}=re.useContext(_M);return W.jsx(W.Fragment,{children:B.map(Y=>{const te=jx(Y),pe=h&&!y?!1:w===B||A.includes(te),ue=()=>{if(j.current.has(te))return;if(j.current.add(te),R.has(te))R.set(te,!0);else return;let Ee=!0;R.forEach(Oe=>{Oe||(Ee=!1)}),Ee&&(H==null||H(),Z(M.current),h&&(b==null||b()),n&&n())};return W.jsx(ire,{isPresent:pe,initial:!k.current||r?void 0:!1,custom:t,presenceAffectsLayout:o,mode:l,root:s,onExitComplete:pe?void 0:ue,anchorX:f,children:Y},te)})})},B6=re.createContext({strict:!1}),DB={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]};let LB=!1;function sre(){if(LB)return;const e={};for(const t in DB)e[t]={isEnabled:r=>DB[t].some(n=>!!r[n])};f6(e),LB=!0}function N6(){return sre(),qee()}function are(e){const t=N6();for(const r in e)t[r]={...t[r],...e[r]};f6(t)}const lre=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function aw(e){return e.startsWith("while")||e.startsWith("drag")&&e!=="draggable"||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||lre.has(e)}let $6=e=>!aw(e);function cre(e){typeof e=="function"&&($6=t=>t.startsWith("on")?!aw(t):e(t))}try{cre(require("@emotion/is-prop-valid").default)}catch{}function ure(e,t,r){const n={};for(const o in e)o==="values"&&typeof e.values=="object"||($6(o)||r===!0&&aw(o)||!t&&!aw(o)||e.draggable&&o.startsWith("onDrag"))&&(n[o]=e[o]);return n}const U1=re.createContext({});function hre(e,t){if(F1(e)){const{initial:r,animate:n}=e;return{initial:r===!1||Bv(r)?r:void 0,animate:Bv(n)?n:void 0}}return e.inherit!==!1?t:{}}function dre(e){const{initial:t,animate:r}=hre(e,re.useContext(U1));return re.useMemo(()=>({initial:t,animate:r}),[jB(t),jB(r)])}function jB(e){return Array.isArray(e)?e.join(" "):e}const ZM=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function F6(e,t,r){for(const n in t)!To(t[n])&&!x6(n,r)&&(e[n]=t[n])}function fre({transformTemplate:e},t){return re.useMemo(()=>{const r=ZM();return qM(r,t,e),Object.assign({},r.vars,r.style)},[t])}function pre(e,t){const r=e.style||{},n={};return F6(n,r,e),Object.assign(n,fre(e,t)),n}function mre(e,t){const r={},n=pre(e,t);return e.drag&&e.dragListener!==!1&&(r.draggable=!1,n.userSelect=n.WebkitUserSelect=n.WebkitTouchCallout="none",n.touchAction=e.drag===!0?"none":`pan-${e.drag==="x"?"y":"x"}`),e.tabIndex===void 0&&(e.onTap||e.onTapStart||e.whileTap)&&(r.tabIndex=0),r.style=n,r}const U6=()=>({...ZM(),attrs:{}});function gre(e,t,r,n){const o=re.useMemo(()=>{const l=U6();return b6(l,t,S6(n),e.transformTemplate,e.style),{...l.attrs,style:{...l.style}}},[t]);if(e.style){const l={};F6(l,e.style,e),o.style={...l,...o.style}}return o}const yre=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function XM(e){return typeof e!="string"||e.includes("-")?!1:!!(yre.indexOf(e)>-1||/[A-Z]/u.test(e))}function vre(e,t,r,{latestValues:n},o,l=!1,h){const s=(h??XM(e)?gre:mre)(t,n,o,e),y=ure(t,typeof e=="string",l),b=e!==re.Fragment?{...y,...s,ref:r}:{},{children:w}=t,A=re.useMemo(()=>To(w)?w.get():w,[w]);return re.createElement(e,{...b,children:A})}function _re({scrapeMotionValuesFromProps:e,createRenderState:t},r,n,o){return{latestValues:xre(r,n,o,e),renderState:t()}}function xre(e,t,r,n){const o={},l=n(e,{});for(const A in l)o[A]=wb(l[A]);let{initial:h,animate:f}=e;const s=F1(e),y=d6(e);t&&y&&!s&&e.inherit!==!1&&(h===void 0&&(h=t.initial),f===void 0&&(f=t.animate));let b=r?r.initial===!1:!1;b=b||h===!1;const w=b?f:h;if(w&&typeof w!="boolean"&&!$1(w)){const A=Array.isArray(w)?w:[w];for(let k=0;k<A.length;k++){const M=NM(e,A[k]);if(M){const{transitionEnd:R,transition:j,...L}=M;for(const z in L){let B=L[z];if(Array.isArray(B)){const Z=b?B.length-1:0;B=B[Z]}B!==null&&(o[z]=B)}for(const z in R)o[z]=R[z]}}}return o}const V6=e=>(t,r)=>{const n=re.useContext(U1),o=re.useContext(N1),l=()=>_re(e,t,n,o);return r?l():xM(l)},bre=V6({scrapeMotionValuesFromProps:HM,createRenderState:ZM}),wre=V6({scrapeMotionValuesFromProps:T6,createRenderState:U6}),Sre=Symbol.for("motionComponentSymbol");function Tre(e,t,r){const n=re.useRef(r);re.useInsertionEffect(()=>{n.current=r});const o=re.useRef(null);return re.useCallback(l=>{var f;l&&((f=e.onMount)==null||f.call(e,l)),t&&(l?t.mount(l):t.unmount());const h=n.current;if(typeof h=="function")if(l){const s=h(l);typeof s=="function"&&(o.current=s)}else o.current?(o.current(),o.current=null):h(l);else h&&(h.current=l)},[t])}const G6=re.createContext({});function Vy(e){return e&&typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"current")}function Ere(e,t,r,n,o,l){var j,L;const{visualElement:h}=re.useContext(U1),f=re.useContext(B6),s=re.useContext(N1),y=re.useContext(KM).reducedMotion,b=re.useRef(null);n=n||f.renderer,!b.current&&n&&(b.current=n(e,{visualState:t,parent:h,props:r,presenceContext:s,blockInitialAnimation:s?s.initial===!1:!1,reducedMotionConfig:y,isSVG:l}));const w=b.current,A=re.useContext(G6);w&&!w.projection&&o&&(w.type==="html"||w.type==="svg")&&Are(b.current,r,o,A);const k=re.useRef(!1);re.useInsertionEffect(()=>{w&&k.current&&w.update(r,s)});const M=r[YV],R=re.useRef(!!M&&!((j=window.MotionHandoffIsComplete)!=null&&j.call(window,M))&&((L=window.MotionHasOptimisedAnimation)==null?void 0:L.call(window,M)));return pV(()=>{w&&(k.current=!0,window.MotionIsMounted=!0,w.updateFeatures(),w.scheduleRenderMicrotask(),R.current&&w.animationState&&w.animationState.animateChanges())}),re.useEffect(()=>{w&&(!R.current&&w.animationState&&w.animationState.animateChanges(),R.current&&(queueMicrotask(()=>{var z;(z=window.MotionHandoffMarkAsComplete)==null||z.call(window,M)}),R.current=!1),w.enteringChildren=void 0)}),w}function Are(e,t,r,n){const{layoutId:o,layout:l,drag:h,dragConstraints:f,layoutScroll:s,layoutRoot:y,layoutCrossfade:b}=t;e.projection=new r(e.latestValues,t["data-framer-portal-id"]?void 0:W6(e.parent)),e.projection.setOptions({layoutId:o,layout:l,alwaysMeasureLayout:!!h||f&&Vy(f),visualElement:e,animationType:typeof l=="string"?l:"both",initialPromotionConfig:n,crossfade:b,layoutScroll:s,layoutRoot:y})}function W6(e){if(e)return e.options.allowProjection!==!1?e.projection:W6(e.parent)}function nA(e,{forwardMotionProps:t=!1,type:r}={},n,o){n&&are(n);const l=r?r==="svg":XM(e),h=l?wre:bre;function f(y,b){let w;const A={...re.useContext(KM),...y,layoutId:Pre(y)},{isStatic:k}=A,M=dre(y),R=h(y,k);if(!k&&fV){Cre();const j=kre(A);w=j.MeasureLayout,M.visualElement=Ere(e,R,A,o,j.ProjectionNode,l)}return W.jsxs(U1.Provider,{value:M,children:[w&&M.visualElement?W.jsx(w,{visualElement:M.visualElement,...A}):null,vre(e,y,Tre(R,M.visualElement,b),R,k,t,l)]})}f.displayName=`motion.${typeof e=="string"?e:`create(${e.displayName??e.name??""})`}`;const s=re.forwardRef(f);return s[Sre]=e,s}function Pre({layoutId:e}){const t=re.useContext(_M).id;return t&&e!==void 0?t+"-"+e:e}function Cre(e,t){re.useContext(B6).strict}function kre(e){const t=N6(),{drag:r,layout:n}=t;if(!r&&!n)return{};const o={...r,...n};return{MeasureLayout:r!=null&&r.isEnabled(e)||n!=null&&n.isEnabled(e)?o.MeasureLayout:void 0,ProjectionNode:o.ProjectionNode}}function Ore(e,t){if(typeof Proxy>"u")return nA;const r=new Map,n=(l,h)=>nA(l,h,e,t),o=(l,h)=>n(l,h);return new Proxy(o,{get:(l,h)=>h==="create"?n:(r.has(h)||r.set(h,nA(h,void 0,e,t)),r.get(h))})}const Mre=(e,t)=>t.isSVG??XM(e)?new cte(t):new nte(t,{allowProjection:e!==re.Fragment});class Ire extends Vu{constructor(t){super(t),t.animationState||(t.animationState=pte(t))}updateAnimationControlsSubscription(){const{animate:t}=this.node.getProps();$1(t)&&(this.unmountControls=t.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:t}=this.node.getProps(),{animate:r}=this.node.prevProps||{};t!==r&&this.updateAnimationControlsSubscription()}unmount(){var t;this.node.animationState.reset(),(t=this.unmountControls)==null||t.call(this)}}let Rre=0;class Dre extends Vu{constructor(){super(...arguments),this.id=Rre++}update(){if(!this.node.presenceContext)return;const{isPresent:t,onExitComplete:r}=this.node.presenceContext,{isPresent:n}=this.node.prevPresenceContext||{};if(!this.node.animationState||t===n)return;const o=this.node.animationState.setActive("exit",!t);r&&!t&&o.then(()=>{r(this.id)})}mount(){const{register:t,onExitComplete:r}=this.node.presenceContext||{};r&&r(this.id),t&&(this.unmount=t(this.id))}unmount(){}}const Lre={animation:{Feature:Ire},exit:{Feature:Dre}};function $_(e){return{point:{x:e.pageX,y:e.pageY}}}const jre=e=>t=>VM(t)&&e(t,$_(t));function ov(e,t,r,n){return Nv(e,t,jre(r),n)}const q6=({current:e})=>e?e.ownerDocument.defaultView:null,zB=(e,t)=>Math.abs(e-t);function zre(e,t){const r=zB(e.x,t.x),n=zB(e.y,t.y);return Math.sqrt(r**2+n**2)}const BB=new Set(["auto","scroll"]);class H6{constructor(t,r,{transformPagePoint:n,contextWindow:o=window,dragSnapToOrigin:l=!1,distanceThreshold:h=3,element:f}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.scrollPositions=new Map,this.removeScrollListeners=null,this.onElementScroll=k=>{this.handleScroll(k.target)},this.onWindowScroll=()=>{this.handleScroll(window)},this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const k=oA(this.lastMoveEventInfo,this.history),M=this.startEvent!==null,R=zre(k.offset,{x:0,y:0})>=this.distanceThreshold;if(!M&&!R)return;const{point:j}=k,{timestamp:L}=to;this.history.push({...j,timestamp:L});const{onStart:z,onMove:B}=this.handlers;M||(z&&z(this.lastMoveEvent,k),this.startEvent=this.lastMoveEvent),B&&B(this.lastMoveEvent,k)},this.handlePointerMove=(k,M)=>{this.lastMoveEvent=k,this.lastMoveEventInfo=iA(M,this.transformPagePoint),Ln.update(this.updatePoint,!0)},this.handlePointerUp=(k,M)=>{this.end();const{onEnd:R,onSessionEnd:j,resumeAnimation:L}=this.handlers;if((this.dragSnapToOrigin||!this.startEvent)&&L&&L(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const z=oA(k.type==="pointercancel"?this.lastMoveEventInfo:iA(M,this.transformPagePoint),this.history);this.startEvent&&R&&R(k,z),j&&j(k,z)},!VM(t))return;this.dragSnapToOrigin=l,this.handlers=r,this.transformPagePoint=n,this.distanceThreshold=h,this.contextWindow=o||window;const s=$_(t),y=iA(s,this.transformPagePoint),{point:b}=y,{timestamp:w}=to;this.history=[{...b,timestamp:w}];const{onSessionStart:A}=r;A&&A(t,oA(y,this.history)),this.removeListeners=z_(ov(this.contextWindow,"pointermove",this.handlePointerMove),ov(this.contextWindow,"pointerup",this.handlePointerUp),ov(this.contextWindow,"pointercancel",this.handlePointerUp)),f&&this.startScrollTracking(f)}startScrollTracking(t){let r=t.parentElement;for(;r;){const n=getComputedStyle(r);(BB.has(n.overflowX)||BB.has(n.overflowY))&&this.scrollPositions.set(r,{x:r.scrollLeft,y:r.scrollTop}),r=r.parentElement}this.scrollPositions.set(window,{x:window.scrollX,y:window.scrollY}),window.addEventListener("scroll",this.onElementScroll,{capture:!0,passive:!0}),window.addEventListener("scroll",this.onWindowScroll,{passive:!0}),this.removeScrollListeners=()=>{window.removeEventListener("scroll",this.onElementScroll,{capture:!0}),window.removeEventListener("scroll",this.onWindowScroll)}}handleScroll(t){const r=this.scrollPositions.get(t);if(!r)return;const n=t===window,o=n?{x:window.scrollX,y:window.scrollY}:{x:t.scrollLeft,y:t.scrollTop},l={x:o.x-r.x,y:o.y-r.y};l.x===0&&l.y===0||(n?this.lastMoveEventInfo&&(this.lastMoveEventInfo.point.x+=l.x,this.lastMoveEventInfo.point.y+=l.y):this.history.length>0&&(this.history[0].x-=l.x,this.history[0].y-=l.y),this.scrollPositions.set(t,o),Ln.update(this.updatePoint,!0))}updateHandlers(t){this.handlers=t}end(){this.removeListeners&&this.removeListeners(),this.removeScrollListeners&&this.removeScrollListeners(),this.scrollPositions.clear(),Lu(this.updatePoint)}}function iA(e,t){return t?{point:t(e.point)}:e}function NB(e,t){return{x:e.x-t.x,y:e.y-t.y}}function oA({point:e},t){return{point:e,delta:NB(e,K6(t)),offset:NB(e,Bre(t)),velocity:Nre(t,.1)}}function Bre(e){return e[0]}function K6(e){return e[e.length-1]}function Nre(e,t){if(e.length<2)return{x:0,y:0};let r=e.length-1,n=null;const o=K6(e);for(;r>=0&&(n=e[r],!(o.timestamp-n.timestamp>oc(t)));)r--;if(!n)return{x:0,y:0};const l=Xs(o.timestamp-n.timestamp);if(l===0)return{x:0,y:0};const h={x:(o.x-n.x)/l,y:(o.y-n.y)/l};return h.x===1/0&&(h.x=0),h.y===1/0&&(h.y=0),h}function $re(e,{min:t,max:r},n){return t!==void 0&&e<t?e=n?Qn(t,e,n.min):Math.max(e,t):r!==void 0&&e>r&&(e=n?Qn(r,e,n.max):Math.min(e,r)),e}function $B(e,t,r){return{min:t!==void 0?e.min+t:void 0,max:r!==void 0?e.max+r-(e.max-e.min):void 0}}function Fre(e,{top:t,left:r,bottom:n,right:o}){return{x:$B(e.x,r,o),y:$B(e.y,t,n)}}function FB(e,t){let r=t.min-e.min,n=t.max-e.max;return t.max-t.min<e.max-e.min&&([r,n]=[n,r]),{min:r,max:n}}function Ure(e,t){return{x:FB(e.x,t.x),y:FB(e.y,t.y)}}function Vre(e,t){let r=.5;const n=Ro(e),o=Ro(t);return o>n?r=Lv(t.min,t.max-n,e.min):n>o&&(r=Lv(e.min,e.max-o,t.min)),Al(0,1,r)}function Gre(e,t){const r={};return t.min!==void 0&&(r.min=t.min-e.min),t.max!==void 0&&(r.max=t.max-e.min),r}const xC=.35;function Wre(e=xC){return e===!1?e=0:e===!0&&(e=xC),{x:UB(e,"left","right"),y:UB(e,"top","bottom")}}function UB(e,t,r){return{min:VB(e,t),max:VB(e,r)}}function VB(e,t){return typeof e=="number"?e:e[t]||0}const qre=new WeakMap;class Hre{constructor(t){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=Mi(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=t}start(t,{snapToCursor:r=!1,distanceThreshold:n}={}){const{presenceContext:o}=this.visualElement;if(o&&o.isPresent===!1)return;const l=w=>{r?(this.stopAnimation(),this.snapToCursor($_(w).point)):this.pauseAnimation()},h=(w,A)=>{this.stopAnimation();const{drag:k,dragPropagation:M,onDragStart:R}=this.getProps();if(k&&!M&&(this.openDragLock&&this.openDragLock(),this.openDragLock=Dee(k),!this.openDragLock))return;this.latestPointerEvent=w,this.latestPanInfo=A,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Gs(L=>{let z=this.getAxisMotionValue(L).get()||0;if(xl.test(z)){const{projection:B}=this.visualElement;if(B&&B.layout){const Z=B.layout.layoutBox[L];Z&&(z=Ro(Z)*(parseFloat(z)/100))}}this.originPoint[L]=z}),R&&Ln.postRender(()=>R(w,A)),dC(this.visualElement,"transform");const{animationState:j}=this.visualElement;j&&j.setActive("whileDrag",!0)},f=(w,A)=>{this.latestPointerEvent=w,this.latestPanInfo=A;const{dragPropagation:k,dragDirectionLock:M,onDirectionLock:R,onDrag:j}=this.getProps();if(!k&&!this.openDragLock)return;const{offset:L}=A;if(M&&this.currentDirection===null){this.currentDirection=Kre(L),this.currentDirection!==null&&R&&R(this.currentDirection);return}this.updateAxis("x",A.point,L),this.updateAxis("y",A.point,L),this.visualElement.render(),j&&j(w,A)},s=(w,A)=>{this.latestPointerEvent=w,this.latestPanInfo=A,this.stop(w,A),this.latestPointerEvent=null,this.latestPanInfo=null},y=()=>Gs(w=>{var A;return this.getAnimationState(w)==="paused"&&((A=this.getAxisMotionValue(w).animation)==null?void 0:A.play())}),{dragSnapToOrigin:b}=this.getProps();this.panSession=new H6(t,{onSessionStart:l,onStart:h,onMove:f,onSessionEnd:s,resumeAnimation:y},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:b,distanceThreshold:n,contextWindow:q6(this.visualElement),element:this.visualElement.current})}stop(t,r){const n=t||this.latestPointerEvent,o=r||this.latestPanInfo,l=this.isDragging;if(this.cancel(),!l||!o||!n)return;const{velocity:h}=o;this.startAnimation(h);const{onDragEnd:f}=this.getProps();f&&Ln.postRender(()=>f(n,o))}cancel(){this.isDragging=!1;const{projection:t,animationState:r}=this.visualElement;t&&(t.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:n}=this.getProps();!n&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),r&&r.setActive("whileDrag",!1)}updateAxis(t,r,n){const{drag:o}=this.getProps();if(!n||!zx(t,o,this.currentDirection))return;const l=this.getAxisMotionValue(t);let h=this.originPoint[t]+n[t];this.constraints&&this.constraints[t]&&(h=$re(h,this.constraints[t],this.elastic[t])),l.set(h)}resolveConstraints(){var l;const{dragConstraints:t,dragElastic:r}=this.getProps(),n=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(l=this.visualElement.projection)==null?void 0:l.layout,o=this.constraints;t&&Vy(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):t&&n?this.constraints=Fre(n.layoutBox,t):this.constraints=!1,this.elastic=Wre(r),o!==this.constraints&&n&&this.constraints&&!this.hasMutatedConstraints&&Gs(h=>{this.constraints!==!1&&this.getAxisMotionValue(h)&&(this.constraints[h]=Gre(n.layoutBox[h],this.constraints[h]))})}resolveRefConstraints(){const{dragConstraints:t,onMeasureDragConstraints:r}=this.getProps();if(!t||!Vy(t))return!1;const n=t.current,{projection:o}=this.visualElement;if(!o||!o.layout)return!1;const l=Yee(n,o.root,this.visualElement.getTransformPagePoint());let h=Ure(o.layout.layoutBox,l);if(r){const f=r(Kee(h));this.hasMutatedConstraints=!!f,f&&(h=m6(f))}return h}startAnimation(t){const{drag:r,dragMomentum:n,dragElastic:o,dragTransition:l,dragSnapToOrigin:h,onDragTransitionEnd:f}=this.getProps(),s=this.constraints||{},y=Gs(b=>{if(!zx(b,r,this.currentDirection))return;let w=s&&s[b]||{};h&&(w={min:0,max:0});const A=o?200:1e6,k=o?40:1e7,M={type:"inertia",velocity:n?t[b]:0,bounceStiffness:A,bounceDamping:k,timeConstant:750,restDelta:1,restSpeed:10,...l,...w};return this.startAxisValueAnimation(b,M)});return Promise.all(y).then(f)}startAxisValueAnimation(t,r){const n=this.getAxisMotionValue(t);return dC(this.visualElement,t),n.start(BM(t,n,0,r,this.visualElement,!1))}stopAnimation(){Gs(t=>this.getAxisMotionValue(t).stop())}pauseAnimation(){Gs(t=>{var r;return(r=this.getAxisMotionValue(t).animation)==null?void 0:r.pause()})}getAnimationState(t){var r;return(r=this.getAxisMotionValue(t).animation)==null?void 0:r.state}getAxisMotionValue(t){const r=`_drag${t.toUpperCase()}`,n=this.visualElement.getProps(),o=n[r];return o||this.visualElement.getValue(t,(n.initial?n.initial[t]:void 0)||0)}snapToCursor(t){Gs(r=>{const{drag:n}=this.getProps();if(!zx(r,n,this.currentDirection))return;const{projection:o}=this.visualElement,l=this.getAxisMotionValue(r);if(o&&o.layout){const{min:h,max:f}=o.layout.layoutBox[r],s=l.get()||0;l.set(t[r]-Qn(h,f,.5)+s)}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:t,dragConstraints:r}=this.getProps(),{projection:n}=this.visualElement;if(!Vy(r)||!n||!this.constraints)return;this.stopAnimation();const o={x:0,y:0};Gs(h=>{const f=this.getAxisMotionValue(h);if(f&&this.constraints!==!1){const s=f.get();o[h]=Vre({min:s,max:s},this.constraints[h])}});const{transformTemplate:l}=this.visualElement.getProps();this.visualElement.current.style.transform=l?l({},""):"none",n.root&&n.root.updateScroll(),n.updateLayout(),this.resolveConstraints(),Gs(h=>{if(!zx(h,t,null))return;const f=this.getAxisMotionValue(h),{min:s,max:y}=this.constraints[h];f.set(Qn(s,y,o[h]))})}addListeners(){if(!this.visualElement.current)return;qre.set(this.visualElement,this);const t=this.visualElement.current,r=ov(t,"pointerdown",s=>{const{drag:y,dragListener:b=!0}=this.getProps();y&&b&&!c6(s.target)&&this.start(s)}),n=()=>{const{dragConstraints:s}=this.getProps();Vy(s)&&s.current&&(this.constraints=this.resolveRefConstraints())},{projection:o}=this.visualElement,l=o.addEventListener("measure",n);o&&!o.layout&&(o.root&&o.root.updateScroll(),o.updateLayout()),Ln.read(n);const h=Nv(window,"resize",()=>this.scalePositionWithinConstraints()),f=o.addEventListener("didUpdate",({delta:s,hasLayoutChanged:y})=>{this.isDragging&&y&&(Gs(b=>{const w=this.getAxisMotionValue(b);w&&(this.originPoint[b]+=s[b].translate,w.set(w.get()+s[b].translate))}),this.visualElement.render())});return()=>{h(),r(),l(),f&&f()}}getProps(){const t=this.visualElement.getProps(),{drag:r=!1,dragDirectionLock:n=!1,dragPropagation:o=!1,dragConstraints:l=!1,dragElastic:h=xC,dragMomentum:f=!0}=t;return{...t,drag:r,dragDirectionLock:n,dragPropagation:o,dragConstraints:l,dragElastic:h,dragMomentum:f}}}function zx(e,t,r){return(t===!0||t===e)&&(r===null||r===e)}function Kre(e,t=10){let r=null;return Math.abs(e.y)>t?r="y":Math.abs(e.x)>t&&(r="x"),r}class Zre extends Vu{constructor(t){super(t),this.removeGroupControls=ea,this.removeListeners=ea,this.controls=new Hre(t)}mount(){const{dragControls:t}=this.node.getProps();t&&(this.removeGroupControls=t.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||ea}update(){const{dragControls:t}=this.node.getProps(),{dragControls:r}=this.node.prevProps||{};t!==r&&(this.removeGroupControls(),t&&(this.removeGroupControls=t.subscribe(this.controls)))}unmount(){this.removeGroupControls(),this.removeListeners()}}const GB=e=>(t,r)=>{e&&Ln.postRender(()=>e(t,r))};class Xre extends Vu{constructor(){super(...arguments),this.removePointerDownListener=ea}onPointerDown(t){this.session=new H6(t,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:q6(this.node)})}createPanHandlers(){const{onPanSessionStart:t,onPanStart:r,onPan:n,onPanEnd:o}=this.node.getProps();return{onSessionStart:GB(t),onStart:GB(r),onMove:n,onEnd:(l,h)=>{delete this.session,o&&Ln.postRender(()=>o(l,h))}}}mount(){this.removePointerDownListener=ov(this.node.current,"pointerdown",t=>this.onPointerDown(t))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}let sA=!1;class Yre extends re.Component{componentDidMount(){const{visualElement:t,layoutGroup:r,switchLayoutGroup:n,layoutId:o}=this.props,{projection:l}=t;l&&(r.group&&r.group.add(l),n&&n.register&&o&&n.register(l),sA&&l.root.didUpdate(),l.addEventListener("animationComplete",()=>{this.safeToRemove()}),l.setOptions({...l.options,onExitComplete:()=>this.safeToRemove()})),Sb.hasEverUpdated=!0}getSnapshotBeforeUpdate(t){const{layoutDependency:r,visualElement:n,drag:o,isPresent:l}=this.props,{projection:h}=n;return h&&(h.isPresent=l,sA=!0,o||t.layoutDependency!==r||r===void 0||t.isPresent!==l?h.willUpdate():this.safeToRemove(),t.isPresent!==l&&(l?h.promote():h.relegate()||Ln.postRender(()=>{const f=h.getStack();(!f||!f.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:t}=this.props.visualElement;t&&(t.root.didUpdate(),UM.postRender(()=>{!t.currentAnimation&&t.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:t,layoutGroup:r,switchLayoutGroup:n}=this.props,{projection:o}=t;sA=!0,o&&(o.scheduleCheckAfterUnmount(),r&&r.group&&r.group.remove(o),n&&n.deregister&&n.deregister(o))}safeToRemove(){const{safeToRemove:t}=this.props;t&&t()}render(){return null}}function Z6(e){const[t,r]=z6(),n=re.useContext(_M);return W.jsx(Yre,{...e,layoutGroup:n,switchLayoutGroup:re.useContext(G6),isPresent:t,safeToRemove:r})}const Jre={pan:{Feature:Xre},drag:{Feature:Zre,ProjectionNode:j6,MeasureLayout:Z6}};function WB(e,t,r){const{props:n}=e;e.animationState&&n.whileHover&&e.animationState.setActive("whileHover",r==="Start");const o="onHover"+r,l=n[o];l&&Ln.postRender(()=>l(t,$_(t)))}class Qre extends Vu{mount(){const{current:t}=this.node;t&&(this.unmount=Lee(t,(r,n)=>(WB(this.node,n,"Start"),o=>WB(this.node,o,"End"))))}unmount(){}}class ene extends Vu{constructor(){super(...arguments),this.isActive=!1}onFocus(){let t=!1;try{t=this.node.current.matches(":focus-visible")}catch{t=!0}!t||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=z_(Nv(this.node.current,"focus",()=>this.onFocus()),Nv(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function qB(e,t,r){const{props:n}=e;if(e.current instanceof HTMLButtonElement&&e.current.disabled)return;e.animationState&&n.whileTap&&e.animationState.setActive("whileTap",r==="Start");const o="onTap"+(r==="End"?"":r),l=n[o];l&&Ln.postRender(()=>l(t,$_(t)))}class tne extends Vu{mount(){const{current:t}=this.node;t&&(this.unmount=Bee(t,(r,n)=>(qB(this.node,n,"Start"),(o,{success:l})=>qB(this.node,o,l?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const bC=new WeakMap,aA=new WeakMap,rne=e=>{const t=bC.get(e.target);t&&t(e)},nne=e=>{e.forEach(rne)};function ine({root:e,...t}){const r=e||document;aA.has(r)||aA.set(r,{});const n=aA.get(r),o=JSON.stringify(t);return n[o]||(n[o]=new IntersectionObserver(nne,{root:e,...t})),n[o]}function one(e,t,r){const n=ine(t);return bC.set(e,r),n.observe(e),()=>{bC.delete(e),n.unobserve(e)}}const sne={some:0,all:1};class ane extends Vu{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:t={}}=this.node.getProps(),{root:r,margin:n,amount:o="some",once:l}=t,h={root:r?r.current:void 0,rootMargin:n,threshold:typeof o=="number"?o:sne[o]},f=s=>{const{isIntersecting:y}=s;if(this.isInView===y||(this.isInView=y,l&&!y&&this.hasEnteredView))return;y&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",y);const{onViewportEnter:b,onViewportLeave:w}=this.node.getProps(),A=y?b:w;A&&A(s)};return one(this.node.current,h,f)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:t,prevProps:r}=this.node;["amount","margin","root"].some(lne(t,r))&&this.startObserver()}unmount(){}}function lne({viewport:e={}},{viewport:t={}}={}){return r=>e[r]!==t[r]}const cne={inView:{Feature:ane},tap:{Feature:tne},focus:{Feature:ene},hover:{Feature:Qre}},une={layout:{ProjectionNode:j6,MeasureLayout:Z6}},hne={...Lre,...cne,...Jre,...une},Do=Ore(hne,Mre),dne={sm:{text:"text-2xl",iconPx:32},md:{text:"text-4xl",iconPx:40},lg:{text:"text-5xl",iconPx:48},xl:{text:"text-6xl",iconPx:56}};function lw({size:e="md",showText:t=!0,className:r="",glowing:n=!1,markScale:o=1}){const{text:l,iconPx:h}=dne[e],f=re.useId(),[s,y]=re.useState(0),b=re.useMemo(()=>{var z,B;const j=((B=(z=import.meta)==null?void 0:z.env)==null?void 0:B.BASE_URL)||"/",L=j.endsWith("/")?j:`${j}/`;return[`${L}aurora-sentinel-logo.png`,`${L}aurora-sentinel-logo.webp`,`${L}aurora-sentinel-logo.svg`,`${L}logo.png`,`${L}logo.webp`,`${L}logo.svg`,`${L}aurora-logo.png`]},[]),w=b[s],A=s<b.length,k=Math.max(12,Math.round(h*(Number.isFinite(o)?o:1))),M=(Number.isFinite(o)?o:1)>=2?"mb-0":"mb-2",R=(Number.isFinite(o)?o:1)>=2?"-mt-2 leading-none":"leading-tight";return W.jsx("div",{className:`flex flex-col items-center gap-0 ${r}`,children:W.jsxs(Do.div,{animate:n?{filter:["drop-shadow(0 0 20px rgba(34, 211, 238, 0.35))","drop-shadow(0 0 40px rgba(34, 211, 238, 0.55))","drop-shadow(0 0 20px rgba(34, 211, 238, 0.35))"]}:{},transition:{duration:2,repeat:1/0,ease:"easeInOut"},className:"text-center",children:[W.jsx("div",{className:`flex items-center justify-center ${M}`,children:W.jsxs("div",{className:"relative",style:{width:k,height:k},children:[A?W.jsx("img",{src:w,alt:"Aurora Sentinel",className:"absolute inset-0 w-full h-full object-contain",onError:()=>y(j=>j+1)}):W.jsxs("svg",{viewBox:"0 0 64 64",className:"absolute inset-0 w-full h-full","aria-hidden":"true",children:[W.jsx("defs",{children:W.jsxs("linearGradient",{id:f,x1:"0",y1:"0",x2:"1",y2:"1",children:[W.jsx("stop",{offset:"0%",stopColor:"hsl(var(--aurora-cyan))"}),W.jsx("stop",{offset:"45%",stopColor:"hsl(var(--aurora-blue))"}),W.jsx("stop",{offset:"100%",stopColor:"hsl(var(--aurora-violet))"})]})}),W.jsx("path",{d:"M32 4c8 6 16 6 24 8v22c0 15-10 24-24 28C18 58 8 49 8 34V12c8-2 16-2 24-8Z",fill:`url(#${f})`,opacity:"0.95"}),W.jsx("path",{d:"M32 14c5 4 10 4 16 5v14c0 9-6 15-16 17-10-2-16-8-16-17V19c6-1 11-1 16-5Z",fill:"hsl(var(--background))",opacity:"0.55"}),W.jsx("path",{d:"M18 34c6-2 10-6 14-12 2 7 7 12 14 14-6 2-10 6-14 12-2-7-7-12-14-14Z",fill:`url(#${f})`,opacity:"0.8"})]}),W.jsx("div",{className:"absolute inset-0 rounded-full blur-xl",style:{background:"radial-gradient(circle, hsl(var(--aurora-cyan) / 0.25), transparent 65%)"}})]})}),t?W.jsxs("h1",{className:`${l} font-bold tracking-tight ${R}`,children:[W.jsx("span",{className:"text-foreground",children:"Aurora"})," ",W.jsx("span",{className:"aurora-text",children:"Sentinel"})]}):null]})})}function fne({onComplete:e}){const[t,r]=re.useState("intro");return re.useEffect(()=>{const n=setTimeout(()=>{r("exit")},900),o=setTimeout(()=>{e()},1500);return()=>{clearTimeout(n),clearTimeout(o)}},[e]),W.jsxs(Do.div,{className:"fixed inset-0 z-50 bg-background flex items-center justify-center overflow-hidden",initial:{opacity:1},animate:{opacity:t==="exit"?0:1},transition:{duration:.6,delay:t==="exit"?.1:0},children:[W.jsx(lw,{size:"xl",showText:!0,glowing:!0,markScale:5}),W.jsx(Do.p,{className:"absolute bottom-10 text-center text-muted-foreground mt-6 text-lg",initial:{opacity:0,y:10},animate:{opacity:t==="exit"?0:1,y:0},transition:{delay:.2,duration:.4},children:"Intelligent Safety. Always Guarding."})]})}function Bx(e,t){return typeof window>"u"?`hsla(0, 0%, 100%, ${t})`:`hsl(${getComputedStyle(document.documentElement).getPropertyValue(e).trim()} / ${t})`}function X6({interactive:e=!1}){const t=re.useRef(null),r=re.useRef(null),n=re.useRef(null),o=re.useRef(0),[l,h]=re.useState({x:.5,y:.5}),[f,s]=re.useState([]);re.useEffect(()=>{const w=[];for(let A=0;A<90;A++)w.push({id:A,x:Math.random()*100,y:Math.random()*100,size:Math.random()*1.8+.4,opacity:Math.random()*.7+.2,twinkleSpeed:Math.random()*2+1});s(w)},[]);const y=re.useMemo(()=>typeof window>"u"?{cyan:"hsla(186, 92%, 46%, 0.5)",blue:"hsla(214, 95%, 56%, 0.4)",violet:"hsla(270, 82%, 60%, 0.35)"}:{cyan:Bx("--aurora-cyan",.55),blue:Bx("--aurora-blue",.45),violet:Bx("--aurora-violet",.38)},[]),b=re.useCallback(w=>{if(!e||!t.current)return;const A=t.current.getBoundingClientRect();h({x:(w.clientX-A.left)/A.width,y:(w.clientY-A.top)/A.height})},[e]);return re.useEffect(()=>{const w=r.current;if(!w)return;const A=w.getContext("2d");if(!A)return;const k=()=>{const R=window.devicePixelRatio||1,j=w.getBoundingClientRect();w.width=j.width*R,w.height=j.height*R,A.setTransform(1,0,0,1,0,0),A.scale(R,R)};k(),window.addEventListener("resize",k);const M=()=>{const R=w.getBoundingClientRect(),j=R.width,L=R.height;A.clearRect(0,0,j,L),o.current+=.006;const z=o.current,B=(l.x-.5)*110,Z=(l.y-.5)*60;[{color1:y.cyan,color2:"transparent",offset:0,amplitude:85,frequency:.003,speed:1,height:.52},{color1:y.blue,color2:"transparent",offset:18,amplitude:70,frequency:.0037,speed:.85,height:.46},{color1:y.violet,color2:"transparent",offset:-26,amplitude:60,frequency:.0048,speed:1.15,height:.38}].forEach(H=>{A.beginPath();for(let te=0;te<=j;te+=2){const pe=L*(1-H.height),ue=Math.sin((te+B)*H.frequency+z*H.speed)*H.amplitude,Ee=Math.sin((te+B)*H.frequency*1.6+z*H.speed*.7)*(H.amplitude*.45),Oe=Math.sin((te+B)*H.frequency*.6+z*H.speed*1.35)*(H.amplitude*.25),je=pe+ue+Ee+Oe+H.offset+Z*.35;te===0?A.moveTo(te,je):A.lineTo(te,je)}A.lineTo(j,0),A.lineTo(0,0),A.closePath();const Y=A.createLinearGradient(0,0,0,L);Y.addColorStop(0,"transparent"),Y.addColorStop(.25,H.color1),Y.addColorStop(.7,H.color1),Y.addColorStop(1,H.color2),A.fillStyle=Y,A.fill()}),n.current=requestAnimationFrame(M)};return M(),()=>{window.removeEventListener("resize",k),n.current&&cancelAnimationFrame(n.current)}},[y,l.x,l.y]),W.jsxs("div",{ref:t,className:"absolute inset-0 overflow-hidden",onMouseMove:b,children:[W.jsx("div",{className:"absolute inset-0",style:{background:"radial-gradient(ellipse at 50% 100%, hsl(270 35% 14% / 0.45) 0%, transparent 55%), radial-gradient(ellipse at 80% 20%, hsl(214 45% 12% / 0.35) 0%, transparent 45%), linear-gradient(180deg, hsl(230 30% 8%) 0%, hsl(240 25% 5%) 100%)"}}),W.jsx("canvas",{ref:r,className:"absolute inset-0 w-full h-full",style:{mixBlendMode:"screen"}}),W.jsx("svg",{className:"absolute inset-0 w-full h-full pointer-events-none",children:f.map(w=>W.jsx(Do.circle,{cx:`${w.x}%`,cy:`${w.y}%`,r:w.size,fill:"white",initial:{opacity:w.opacity*.5},animate:{opacity:[w.opacity*.25,w.opacity,w.opacity*.25]},transition:{duration:w.twinkleSpeed,repeat:1/0,ease:"easeInOut",delay:Math.random()*2}},w.id))}),e?W.jsx(Do.div,{className:"pointer-events-none absolute w-96 h-96 -translate-x-1/2 -translate-y-1/2 rounded-full",style:{left:`${l.x*100}%`,top:`${l.y*100}%`,background:`radial-gradient(circle, ${Bx("--aurora-cyan",.08)} 0%, transparent 60%)`},animate:{scale:[1,1.1,1],opacity:[.35,.55,.35]},transition:{duration:3,repeat:1/0,ease:"easeInOut"}}):null]})}function Y6(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var o=e.length;for(t=0;t<o;t++)e[t]&&(r=Y6(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}function zr(){for(var e,t,r=0,n="",o=arguments.length;r<o;r++)(e=arguments[r])&&(t=Y6(e))&&(n&&(n+=" "),n+=t);return n}const YM="-",pne=e=>{const t=gne(e),{conflictingClassGroups:r,conflictingClassGroupModifiers:n}=e;return{getClassGroupId:h=>{const f=h.split(YM);return f[0]===""&&f.length!==1&&f.shift(),J6(f,t)||mne(h)},getConflictingClassGroupIds:(h,f)=>{const s=r[h]||[];return f&&n[h]?[...s,...n[h]]:s}}},J6=(e,t)=>{var h;if(e.length===0)return t.classGroupId;const r=e[0],n=t.nextPart.get(r),o=n?J6(e.slice(1),n):void 0;if(o)return o;if(t.validators.length===0)return;const l=e.join(YM);return(h=t.validators.find(({validator:f})=>f(l)))==null?void 0:h.classGroupId},HB=/^\[(.+)\]$/,mne=e=>{if(HB.test(e)){const t=HB.exec(e)[1],r=t==null?void 0:t.substring(0,t.indexOf(":"));if(r)return"arbitrary.."+r}},gne=e=>{const{theme:t,prefix:r}=e,n={nextPart:new Map,validators:[]};return vne(Object.entries(e.classGroups),r).forEach(([l,h])=>{wC(h,n,l,t)}),n},wC=(e,t,r,n)=>{e.forEach(o=>{if(typeof o=="string"){const l=o===""?t:KB(t,o);l.classGroupId=r;return}if(typeof o=="function"){if(yne(o)){wC(o(n),t,r,n);return}t.validators.push({validator:o,classGroupId:r});return}Object.entries(o).forEach(([l,h])=>{wC(h,KB(t,l),r,n)})})},KB=(e,t)=>{let r=e;return t.split(YM).forEach(n=>{r.nextPart.has(n)||r.nextPart.set(n,{nextPart:new Map,validators:[]}),r=r.nextPart.get(n)}),r},yne=e=>e.isThemeGetter,vne=(e,t)=>t?e.map(([r,n])=>{const o=n.map(l=>typeof l=="string"?t+l:typeof l=="object"?Object.fromEntries(Object.entries(l).map(([h,f])=>[t+h,f])):l);return[r,o]}):e,_ne=e=>{if(e<1)return{get:()=>{},set:()=>{}};let t=0,r=new Map,n=new Map;const o=(l,h)=>{r.set(l,h),t++,t>e&&(t=0,n=r,r=new Map)};return{get(l){let h=r.get(l);if(h!==void 0)return h;if((h=n.get(l))!==void 0)return o(l,h),h},set(l,h){r.has(l)?r.set(l,h):o(l,h)}}},Q6="!",xne=e=>{const{separator:t,experimentalParseClassName:r}=e,n=t.length===1,o=t[0],l=t.length,h=f=>{const s=[];let y=0,b=0,w;for(let j=0;j<f.length;j++){let L=f[j];if(y===0){if(L===o&&(n||f.slice(j,j+l)===t)){s.push(f.slice(b,j)),b=j+l;continue}if(L==="/"){w=j;continue}}L==="["?y++:L==="]"&&y--}const A=s.length===0?f:f.substring(b),k=A.startsWith(Q6),M=k?A.substring(1):A,R=w&&w>b?w-b:void 0;return{modifiers:s,hasImportantModifier:k,baseClassName:M,maybePostfixModifierPosition:R}};return r?f=>r({className:f,parseClassName:h}):h},bne=e=>{if(e.length<=1)return e;const t=[];let r=[];return e.forEach(n=>{n[0]==="["?(t.push(...r.sort(),n),r=[]):r.push(n)}),t.push(...r.sort()),t},wne=e=>({cache:_ne(e.cacheSize),parseClassName:xne(e),...pne(e)}),Sne=/\s+/,Tne=(e,t)=>{const{parseClassName:r,getClassGroupId:n,getConflictingClassGroupIds:o}=t,l=[],h=e.trim().split(Sne);let f="";for(let s=h.length-1;s>=0;s-=1){const y=h[s],{modifiers:b,hasImportantModifier:w,baseClassName:A,maybePostfixModifierPosition:k}=r(y);let M=!!k,R=n(M?A.substring(0,k):A);if(!R){if(!M){f=y+(f.length>0?" "+f:f);continue}if(R=n(A),!R){f=y+(f.length>0?" "+f:f);continue}M=!1}const j=bne(b).join(":"),L=w?j+Q6:j,z=L+R;if(l.includes(z))continue;l.push(z);const B=o(R,M);for(let Z=0;Z<B.length;++Z){const F=B[Z];l.push(L+F)}f=y+(f.length>0?" "+f:f)}return f};function Ene(){let e=0,t,r,n="";for(;e<arguments.length;)(t=arguments[e++])&&(r=e8(t))&&(n&&(n+=" "),n+=r);return n}const e8=e=>{if(typeof e=="string")return e;let t,r="";for(let n=0;n<e.length;n++)e[n]&&(t=e8(e[n]))&&(r&&(r+=" "),r+=t);return r};function Ane(e,...t){let r,n,o,l=h;function h(s){const y=t.reduce((b,w)=>w(b),e());return r=wne(y),n=r.cache.get,o=r.cache.set,l=f,f(s)}function f(s){const y=n(s);if(y)return y;const b=Tne(s,r);return o(s,b),b}return function(){return l(Ene.apply(null,arguments))}}const On=e=>{const t=r=>r[e]||[];return t.isThemeGetter=!0,t},t8=/^\[(?:([a-z-]+):)?(.+)\]$/i,Pne=/^\d+\/\d+$/,Cne=new Set(["px","full","screen"]),kne=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,One=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,Mne=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,Ine=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,Rne=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Kl=e=>Ap(e)||Cne.has(e)||Pne.test(e),nu=e=>Am(e,"length",Fne),Ap=e=>!!e&&!Number.isNaN(Number(e)),lA=e=>Am(e,"number",Ap),Ty=e=>!!e&&Number.isInteger(Number(e)),Dne=e=>e.endsWith("%")&&Ap(e.slice(0,-1)),Cr=e=>t8.test(e),iu=e=>kne.test(e),Lne=new Set(["length","size","percentage"]),jne=e=>Am(e,Lne,r8),zne=e=>Am(e,"position",r8),Bne=new Set(["image","url"]),Nne=e=>Am(e,Bne,Vne),$ne=e=>Am(e,"",Une),Ey=()=>!0,Am=(e,t,r)=>{const n=t8.exec(e);return n?n[1]?typeof t=="string"?n[1]===t:t.has(n[1]):r(n[2]):!1},Fne=e=>One.test(e)&&!Mne.test(e),r8=()=>!1,Une=e=>Ine.test(e),Vne=e=>Rne.test(e),Gne=()=>{const e=On("colors"),t=On("spacing"),r=On("blur"),n=On("brightness"),o=On("borderColor"),l=On("borderRadius"),h=On("borderSpacing"),f=On("borderWidth"),s=On("contrast"),y=On("grayscale"),b=On("hueRotate"),w=On("invert"),A=On("gap"),k=On("gradientColorStops"),M=On("gradientColorStopPositions"),R=On("inset"),j=On("margin"),L=On("opacity"),z=On("padding"),B=On("saturate"),Z=On("scale"),F=On("sepia"),H=On("skew"),Y=On("space"),te=On("translate"),pe=()=>["auto","contain","none"],ue=()=>["auto","hidden","clip","visible","scroll"],Ee=()=>["auto",Cr,t],Oe=()=>[Cr,t],je=()=>["",Kl,nu],Ge=()=>["auto",Ap,Cr],Ze=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],Ye=()=>["solid","dashed","dotted","double","none"],tt=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],ze=()=>["start","end","center","between","around","evenly","stretch"],De=()=>["","0",Cr],ut=()=>["auto","avoid","all","avoid-page","page","left","right","column"],ht=()=>[Ap,Cr];return{cacheSize:500,separator:":",theme:{colors:[Ey],spacing:[Kl,nu],blur:["none","",iu,Cr],brightness:ht(),borderColor:[e],borderRadius:["none","","full",iu,Cr],borderSpacing:Oe(),borderWidth:je(),contrast:ht(),grayscale:De(),hueRotate:ht(),invert:De(),gap:Oe(),gradientColorStops:[e],gradientColorStopPositions:[Dne,nu],inset:Ee(),margin:Ee(),opacity:ht(),padding:Oe(),saturate:ht(),scale:ht(),sepia:De(),skew:ht(),space:Oe(),translate:Oe()},classGroups:{aspect:[{aspect:["auto","square","video",Cr]}],container:["container"],columns:[{columns:[iu]}],"break-after":[{"break-after":ut()}],"break-before":[{"break-before":ut()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...Ze(),Cr]}],overflow:[{overflow:ue()}],"overflow-x":[{"overflow-x":ue()}],"overflow-y":[{"overflow-y":ue()}],overscroll:[{overscroll:pe()}],"overscroll-x":[{"overscroll-x":pe()}],"overscroll-y":[{"overscroll-y":pe()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[R]}],"inset-x":[{"inset-x":[R]}],"inset-y":[{"inset-y":[R]}],start:[{start:[R]}],end:[{end:[R]}],top:[{top:[R]}],right:[{right:[R]}],bottom:[{bottom:[R]}],left:[{left:[R]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",Ty,Cr]}],basis:[{basis:Ee()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",Cr]}],grow:[{grow:De()}],shrink:[{shrink:De()}],order:[{order:["first","last","none",Ty,Cr]}],"grid-cols":[{"grid-cols":[Ey]}],"col-start-end":[{col:["auto",{span:["full",Ty,Cr]},Cr]}],"col-start":[{"col-start":Ge()}],"col-end":[{"col-end":Ge()}],"grid-rows":[{"grid-rows":[Ey]}],"row-start-end":[{row:["auto",{span:[Ty,Cr]},Cr]}],"row-start":[{"row-start":Ge()}],"row-end":[{"row-end":Ge()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",Cr]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",Cr]}],gap:[{gap:[A]}],"gap-x":[{"gap-x":[A]}],"gap-y":[{"gap-y":[A]}],"justify-content":[{justify:["normal",...ze()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...ze(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...ze(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[z]}],px:[{px:[z]}],py:[{py:[z]}],ps:[{ps:[z]}],pe:[{pe:[z]}],pt:[{pt:[z]}],pr:[{pr:[z]}],pb:[{pb:[z]}],pl:[{pl:[z]}],m:[{m:[j]}],mx:[{mx:[j]}],my:[{my:[j]}],ms:[{ms:[j]}],me:[{me:[j]}],mt:[{mt:[j]}],mr:[{mr:[j]}],mb:[{mb:[j]}],ml:[{ml:[j]}],"space-x":[{"space-x":[Y]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[Y]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",Cr,t]}],"min-w":[{"min-w":[Cr,t,"min","max","fit"]}],"max-w":[{"max-w":[Cr,t,"none","full","min","max","fit","prose",{screen:[iu]},iu]}],h:[{h:[Cr,t,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[Cr,t,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[Cr,t,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[Cr,t,"auto","min","max","fit"]}],"font-size":[{text:["base",iu,nu]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",lA]}],"font-family":[{font:[Ey]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",Cr]}],"line-clamp":[{"line-clamp":["none",Ap,lA]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",Kl,Cr]}],"list-image":[{"list-image":["none",Cr]}],"list-style-type":[{list:["none","disc","decimal",Cr]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[e]}],"placeholder-opacity":[{"placeholder-opacity":[L]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[e]}],"text-opacity":[{"text-opacity":[L]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...Ye(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",Kl,nu]}],"underline-offset":[{"underline-offset":["auto",Kl,Cr]}],"text-decoration-color":[{decoration:[e]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:Oe()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Cr]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Cr]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[L]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...Ze(),zne]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",jne]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},Nne]}],"bg-color":[{bg:[e]}],"gradient-from-pos":[{from:[M]}],"gradient-via-pos":[{via:[M]}],"gradient-to-pos":[{to:[M]}],"gradient-from":[{from:[k]}],"gradient-via":[{via:[k]}],"gradient-to":[{to:[k]}],rounded:[{rounded:[l]}],"rounded-s":[{"rounded-s":[l]}],"rounded-e":[{"rounded-e":[l]}],"rounded-t":[{"rounded-t":[l]}],"rounded-r":[{"rounded-r":[l]}],"rounded-b":[{"rounded-b":[l]}],"rounded-l":[{"rounded-l":[l]}],"rounded-ss":[{"rounded-ss":[l]}],"rounded-se":[{"rounded-se":[l]}],"rounded-ee":[{"rounded-ee":[l]}],"rounded-es":[{"rounded-es":[l]}],"rounded-tl":[{"rounded-tl":[l]}],"rounded-tr":[{"rounded-tr":[l]}],"rounded-br":[{"rounded-br":[l]}],"rounded-bl":[{"rounded-bl":[l]}],"border-w":[{border:[f]}],"border-w-x":[{"border-x":[f]}],"border-w-y":[{"border-y":[f]}],"border-w-s":[{"border-s":[f]}],"border-w-e":[{"border-e":[f]}],"border-w-t":[{"border-t":[f]}],"border-w-r":[{"border-r":[f]}],"border-w-b":[{"border-b":[f]}],"border-w-l":[{"border-l":[f]}],"border-opacity":[{"border-opacity":[L]}],"border-style":[{border:[...Ye(),"hidden"]}],"divide-x":[{"divide-x":[f]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[f]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[L]}],"divide-style":[{divide:Ye()}],"border-color":[{border:[o]}],"border-color-x":[{"border-x":[o]}],"border-color-y":[{"border-y":[o]}],"border-color-s":[{"border-s":[o]}],"border-color-e":[{"border-e":[o]}],"border-color-t":[{"border-t":[o]}],"border-color-r":[{"border-r":[o]}],"border-color-b":[{"border-b":[o]}],"border-color-l":[{"border-l":[o]}],"divide-color":[{divide:[o]}],"outline-style":[{outline:["",...Ye()]}],"outline-offset":[{"outline-offset":[Kl,Cr]}],"outline-w":[{outline:[Kl,nu]}],"outline-color":[{outline:[e]}],"ring-w":[{ring:je()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[e]}],"ring-opacity":[{"ring-opacity":[L]}],"ring-offset-w":[{"ring-offset":[Kl,nu]}],"ring-offset-color":[{"ring-offset":[e]}],shadow:[{shadow:["","inner","none",iu,$ne]}],"shadow-color":[{shadow:[Ey]}],opacity:[{opacity:[L]}],"mix-blend":[{"mix-blend":[...tt(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":tt()}],filter:[{filter:["","none"]}],blur:[{blur:[r]}],brightness:[{brightness:[n]}],contrast:[{contrast:[s]}],"drop-shadow":[{"drop-shadow":["","none",iu,Cr]}],grayscale:[{grayscale:[y]}],"hue-rotate":[{"hue-rotate":[b]}],invert:[{invert:[w]}],saturate:[{saturate:[B]}],sepia:[{sepia:[F]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[r]}],"backdrop-brightness":[{"backdrop-brightness":[n]}],"backdrop-contrast":[{"backdrop-contrast":[s]}],"backdrop-grayscale":[{"backdrop-grayscale":[y]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[b]}],"backdrop-invert":[{"backdrop-invert":[w]}],"backdrop-opacity":[{"backdrop-opacity":[L]}],"backdrop-saturate":[{"backdrop-saturate":[B]}],"backdrop-sepia":[{"backdrop-sepia":[F]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[h]}],"border-spacing-x":[{"border-spacing-x":[h]}],"border-spacing-y":[{"border-spacing-y":[h]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",Cr]}],duration:[{duration:ht()}],ease:[{ease:["linear","in","out","in-out",Cr]}],delay:[{delay:ht()}],animate:[{animate:["none","spin","ping","pulse","bounce",Cr]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[Z]}],"scale-x":[{"scale-x":[Z]}],"scale-y":[{"scale-y":[Z]}],rotate:[{rotate:[Ty,Cr]}],"translate-x":[{"translate-x":[te]}],"translate-y":[{"translate-y":[te]}],"skew-x":[{"skew-x":[H]}],"skew-y":[{"skew-y":[H]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",Cr]}],accent:[{accent:["auto",e]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Cr]}],"caret-color":[{caret:[e]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":Oe()}],"scroll-mx":[{"scroll-mx":Oe()}],"scroll-my":[{"scroll-my":Oe()}],"scroll-ms":[{"scroll-ms":Oe()}],"scroll-me":[{"scroll-me":Oe()}],"scroll-mt":[{"scroll-mt":Oe()}],"scroll-mr":[{"scroll-mr":Oe()}],"scroll-mb":[{"scroll-mb":Oe()}],"scroll-ml":[{"scroll-ml":Oe()}],"scroll-p":[{"scroll-p":Oe()}],"scroll-px":[{"scroll-px":Oe()}],"scroll-py":[{"scroll-py":Oe()}],"scroll-ps":[{"scroll-ps":Oe()}],"scroll-pe":[{"scroll-pe":Oe()}],"scroll-pt":[{"scroll-pt":Oe()}],"scroll-pr":[{"scroll-pr":Oe()}],"scroll-pb":[{"scroll-pb":Oe()}],"scroll-pl":[{"scroll-pl":Oe()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Cr]}],fill:[{fill:[e,"none"]}],"stroke-w":[{stroke:[Kl,nu,lA]}],stroke:[{stroke:[e,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},Wne=Ane(Gne);function Mo(...e){return Wne(zr(e))}function n8({children:e,className:t,hover:r=!0,...n}){return W.jsx(Do.div,{className:Mo("glass-card",r&&"transition-all duration-500",t),whileHover:r?{y:-2}:void 0,...n,children:e})}/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var qne={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hne=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),JM=(e,t)=>{const r=re.forwardRef(({color:n="currentColor",size:o=24,strokeWidth:l=2,absoluteStrokeWidth:h,className:f="",children:s,...y},b)=>re.createElement("svg",{ref:b,...qne,width:o,height:o,stroke:n,strokeWidth:h?Number(l)*24/Number(o):l,className:["lucide",`lucide-${Hne(e)}`,f].join(" "),...y},[...t.map(([w,A])=>re.createElement(w,A)),...Array.isArray(s)?s:[s]]));return r.displayName=`${e}`,r};/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kne=JM("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zne=JM("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xne=JM("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),Pp=re.forwardRef(({label:e,error:t,type:r,className:n,...o},l)=>{const[h,f]=re.useState(!1),[s,y]=re.useState(!1),b=r==="password";return W.jsxs("div",{className:"relative space-y-2",children:[e&&W.jsx("label",{className:"block text-sm font-medium text-muted-foreground",children:e}),W.jsxs("div",{className:"relative",children:[W.jsx(_C,{children:h&&W.jsx(Do.div,{className:"absolute -inset-[2px] rounded-lg opacity-50",style:{background:t?"linear-gradient(135deg, hsl(var(--danger) / 0.3), hsl(var(--danger) / 0.1))":"linear-gradient(135deg, hsl(172 66% 50% / 0.3), hsl(160 84% 39% / 0.1))"},initial:{opacity:0},animate:{opacity:.5},exit:{opacity:0},transition:{duration:.2}})}),W.jsx("input",{ref:l,type:b&&s?"text":r,className:Mo("relative w-full rounded-lg border border-border bg-card/50 px-4 py-3 text-foreground","placeholder:text-muted-foreground/50 backdrop-blur-sm","transition-all duration-300","focus:outline-none focus:border-primary/50",b&&"pr-12",t&&"border-destructive/50",n),onFocus:()=>f(!0),onBlur:()=>f(!1),...o}),b&&W.jsx("button",{type:"button",className:"absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-foreground transition-colors",onClick:()=>y(!s),children:s?W.jsx(Zne,{size:18}):W.jsx(Xne,{size:18})})]}),W.jsx(_C,{children:t&&W.jsxs(Do.div,{initial:{opacity:0,y:-5},animate:{opacity:1,y:0},exit:{opacity:0,y:-5},className:"flex items-center gap-1.5 text-destructive text-sm",children:[W.jsx(Kne,{size:14}),W.jsx("span",{children:t})]})})]})});Pp.displayName="AuroraInput";const Yne={primary:Mo("bg-gradient-to-r from-aurora-cyan via-aurora-blue to-aurora-violet text-white","hover:shadow-[0_0_40px_-10px_hsl(var(--aurora-cyan)_/_0.55)]","border-aurora-cyan/20"),secondary:Mo("bg-secondary text-secondary-foreground","hover:bg-secondary/80","border-border"),danger:Mo("bg-gradient-to-r from-danger to-warning text-white","hover:shadow-[0_0_40px_-10px_hsl(0_72%_51%_/_0.6)]","border-transparent"),ghost:Mo("bg-transparent text-foreground","hover:bg-muted","border-transparent"),outline:Mo("bg-transparent text-primary border-primary/30","hover:bg-primary/10 hover:border-primary/50")},Jne={sm:"h-9 px-4 text-sm",md:"h-11 px-6 text-base",lg:"h-14 px-8 text-lg"},QM=re.forwardRef(({children:e,variant:t="primary",size:r="md",loading:n=!1,icon:o,iconPosition:l="left",className:h,disabled:f,...s},y)=>{const b=t,w=r;return W.jsxs(Do.button,{ref:y,className:Mo("relative inline-flex items-center justify-center gap-2 font-medium rounded-lg border","transition-all duration-300 ease-out","focus:outline-none focus:ring-2 focus:ring-primary/50 focus:ring-offset-2 focus:ring-offset-background","disabled:opacity-50 disabled:pointer-events-none",Yne[b],Jne[w],h),whileHover:{scale:1.02},whileTap:{scale:.98},disabled:f||n,...s,children:[W.jsx("span",{className:"absolute inset-0 rounded-lg overflow-hidden",children:W.jsx("span",{className:"absolute inset-0 shimmer"})}),W.jsxs("span",{className:"relative flex items-center gap-2",children:[o&&l==="left"&&W.jsx("span",{children:o}),W.jsx("span",{children:e}),o&&l==="right"&&W.jsx("span",{children:o})]})]})});QM.displayName="AuroraButton";function Qne(){const[e,t]=re.useState(!0),[r,n]=re.useState(""),[o,l]=re.useState(""),[h,f]=re.useState(""),[s,y]=re.useState(!1),b=Fu(),{login:w}=Uu(),A=async k=>{k.preventDefault(),f(""),y(!0);try{await w(r,o),b("/")}catch(M){const R=M.message||"Login failed";alert(`Login Failed:

${R}`),f(R)}finally{y(!1)}};return W.jsxs(W.Fragment,{children:[W.jsx(_C,{children:e&&W.jsx(fne,{onComplete:()=>t(!1)})}),W.jsxs("div",{className:"min-h-screen flex",children:[W.jsxs(Do.div,{className:"w-full lg:w-[55%] flex items-center justify-center p-8 relative",initial:{opacity:0,x:-100},animate:{opacity:e?0:1,x:e?-100:0},transition:{duration:.8,delay:.2,ease:"easeOut"},children:[W.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-background via-background to-aurora-cyan/5"}),W.jsxs(n8,{className:"w-full max-w-md p-8 relative z-10",children:[W.jsxs("div",{className:"text-center mb-8",children:[W.jsx(lw,{size:"lg",showText:!0,glowing:!0,markScale:5}),W.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Campus Security System"})]}),W.jsxs("form",{onSubmit:A,className:"space-y-4",children:[h&&W.jsxs("div",{className:"bg-destructive/20 border border-destructive/40 text-destructive-foreground px-4 py-3 rounded",children:[W.jsx("div",{className:"font-semibold mb-1",children:"Login Error:"}),W.jsx("div",{className:"text-sm",children:h})]}),W.jsx(Pp,{label:"Email Address",type:"email",placeholder:"Enter your email",value:r,onChange:k=>n(k.target.value),required:!0}),W.jsx(Pp,{label:"Password",type:"password",placeholder:"Enter your password",value:o,onChange:k=>l(k.target.value),required:!0}),W.jsx(QM,{type:"submit",className:"w-full mt-2",size:"lg",loading:s,children:s?"Logging in...":"Sign In"})]}),W.jsx("div",{className:"mt-6 text-center",children:W.jsxs("p",{className:"text-muted-foreground text-sm",children:["Don't have an account?"," ",W.jsx(Qs,{to:"/register",className:"text-aurora-cyan hover:opacity-80 transition-opacity",children:"Register"})]})})]})]}),W.jsxs(Do.div,{className:"hidden lg:flex flex-1 relative overflow-hidden items-center justify-center",initial:{opacity:0},animate:{opacity:e?0:1},transition:{duration:.8,delay:.4},children:[W.jsx(X6,{interactive:!1}),W.jsxs(Do.div,{className:"relative z-10 text-center px-8",initial:{opacity:0,y:20},animate:{opacity:e?0:1,y:e?20:0},transition:{delay:.8,duration:.8},children:[W.jsx(lw,{size:"lg",showText:!0,glowing:!1,markScale:5}),W.jsx(Do.p,{className:"text-muted-foreground mt-6 max-w-sm mx-auto text-lg",initial:{opacity:0},animate:{opacity:1},transition:{delay:1.2},children:"Intelligent Safety. Always Guarding."})]})]})]})]})}function V1(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]]);return r}function eie(e,t,r,n){function o(l){return l instanceof r?l:new r(function(h){h(l)})}return new(r||(r=Promise))(function(l,h){function f(b){try{y(n.next(b))}catch(w){h(w)}}function s(b){try{y(n.throw(b))}catch(w){h(w)}}function y(b){b.done?l(b.value):o(b.value).then(f,s)}y((n=n.apply(e,t||[])).next())})}const tie=e=>e?(...t)=>e(...t):(...t)=>fetch(...t);class eI extends Error{constructor(t,r="FunctionsError",n){super(t),this.name=r,this.context=n}}class rie extends eI{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class ZB extends eI{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class XB extends eI{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var SC;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(SC||(SC={}));class nie{constructor(t,{headers:r={},customFetch:n,region:o=SC.Any}={}){this.url=t,this.headers=r,this.region=o,this.fetch=tie(n)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t){return eie(this,arguments,void 0,function*(r,n={}){var o;let l,h;try{const{headers:f,method:s,body:y,signal:b,timeout:w}=n;let A={},{region:k}=n;k||(k=this.region);const M=new URL(`${this.url}/${r}`);k&&k!=="any"&&(A["x-region"]=k,M.searchParams.set("forceFunctionRegion",k));let R;y&&(f&&!Object.prototype.hasOwnProperty.call(f,"Content-Type")||!f)?typeof Blob<"u"&&y instanceof Blob||y instanceof ArrayBuffer?(A["Content-Type"]="application/octet-stream",R=y):typeof y=="string"?(A["Content-Type"]="text/plain",R=y):typeof FormData<"u"&&y instanceof FormData?R=y:(A["Content-Type"]="application/json",R=JSON.stringify(y)):y&&typeof y!="string"&&!(typeof Blob<"u"&&y instanceof Blob)&&!(y instanceof ArrayBuffer)&&!(typeof FormData<"u"&&y instanceof FormData)?R=JSON.stringify(y):R=y;let j=b;w&&(h=new AbortController,l=setTimeout(()=>h.abort(),w),b?(j=h.signal,b.addEventListener("abort",()=>h.abort())):j=h.signal);const L=yield this.fetch(M.toString(),{method:s||"POST",headers:Object.assign(Object.assign(Object.assign({},A),this.headers),f),body:R,signal:j}).catch(F=>{throw new rie(F)}),z=L.headers.get("x-relay-error");if(z&&z==="true")throw new ZB(L);if(!L.ok)throw new XB(L);let B=((o=L.headers.get("Content-Type"))!==null&&o!==void 0?o:"text/plain").split(";")[0].trim(),Z;return B==="application/json"?Z=yield L.json():B==="application/octet-stream"||B==="application/pdf"?Z=yield L.blob():B==="text/event-stream"?Z=L:B==="multipart/form-data"?Z=yield L.formData():Z=yield L.text(),{data:Z,error:null,response:L}}catch(f){return{data:null,error:f,response:f instanceof XB||f instanceof ZB?f.context:void 0}}finally{l&&clearTimeout(l)}})}}var iie=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}},oie=class{constructor(e){var t,r;this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=new Headers(e.headers),this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=(t=e.shouldThrowOnError)!==null&&t!==void 0?t:!1,this.signal=e.signal,this.isMaybeSingle=(r=e.isMaybeSingle)!==null&&r!==void 0?r:!1,e.fetch?this.fetch=e.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=new Headers(this.headers),this.headers.set(e,t),this}then(e,t){var r=this;this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const n=this.fetch;let o=n(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async l=>{let h=null,f=null,s=null,y=l.status,b=l.statusText;if(l.ok){var w,A;if(r.method!=="HEAD"){var k;const L=await l.text();L===""||(r.headers.get("Accept")==="text/csv"||r.headers.get("Accept")&&(!((k=r.headers.get("Accept"))===null||k===void 0)&&k.includes("application/vnd.pgrst.plan+text"))?f=L:f=JSON.parse(L))}const R=(w=r.headers.get("Prefer"))===null||w===void 0?void 0:w.match(/count=(exact|planned|estimated)/),j=(A=l.headers.get("content-range"))===null||A===void 0?void 0:A.split("/");R&&j&&j.length>1&&(s=parseInt(j[1])),r.isMaybeSingle&&r.method==="GET"&&Array.isArray(f)&&(f.length>1?(h={code:"PGRST116",details:`Results contain ${f.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},f=null,s=null,y=406,b="Not Acceptable"):f.length===1?f=f[0]:f=null)}else{var M;const R=await l.text();try{h=JSON.parse(R),Array.isArray(h)&&l.status===404&&(f=[],h=null,y=200,b="OK")}catch{l.status===404&&R===""?(y=204,b="No Content"):h={message:R}}if(h&&r.isMaybeSingle&&(!(h==null||(M=h.details)===null||M===void 0)&&M.includes("0 rows"))&&(h=null,y=200,b="OK"),h&&r.shouldThrowOnError)throw new iie(h)}return{error:h,data:f,count:s,status:y,statusText:b}});return this.shouldThrowOnError||(o=o.catch(l=>{var h;let f="";const s=l==null?void 0:l.cause;if(s){var y,b,w,A;const M=(y=s==null?void 0:s.message)!==null&&y!==void 0?y:"",R=(b=s==null?void 0:s.code)!==null&&b!==void 0?b:"";f=`${(w=l==null?void 0:l.name)!==null&&w!==void 0?w:"FetchError"}: ${l==null?void 0:l.message}`,f+=`

Caused by: ${(A=s==null?void 0:s.name)!==null&&A!==void 0?A:"Error"}: ${M}`,R&&(f+=` (${R})`),s!=null&&s.stack&&(f+=`
${s.stack}`)}else{var k;f=(k=l==null?void 0:l.stack)!==null&&k!==void 0?k:""}return{error:{message:`${(h=l==null?void 0:l.name)!==null&&h!==void 0?h:"FetchError"}: ${l==null?void 0:l.message}`,details:f,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),o.then(e,t)}returns(){return this}overrideTypes(){return this}},sie=class extends oie{select(e){let t=!1;const r=(e??"*").split("").map(n=>/\s/.test(n)&&!t?"":(n==='"'&&(t=!t),n)).join("");return this.url.searchParams.set("select",r),this.headers.append("Prefer","return=representation"),this}order(e,{ascending:t=!0,nullsFirst:r,foreignTable:n,referencedTable:o=n}={}){const l=o?`${o}.order`:"order",h=this.url.searchParams.get(l);return this.url.searchParams.set(l,`${h?`${h},`:""}${e}.${t?"asc":"desc"}${r===void 0?"":r?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:r=t}={}){const n=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(n,`${e}`),this}range(e,t,{foreignTable:r,referencedTable:n=r}={}){const o=typeof n>"u"?"offset":`${n}.offset`,l=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(o,`${e}`),this.url.searchParams.set(l,`${t-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:e=!1,verbose:t=!1,settings:r=!1,buffers:n=!1,wal:o=!1,format:l="text"}={}){var h;const f=[e?"analyze":null,t?"verbose":null,r?"settings":null,n?"buffers":null,o?"wal":null].filter(Boolean).join("|"),s=(h=this.headers.get("Accept"))!==null&&h!==void 0?h:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${l}; for="${s}"; options=${f};`),l==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(e){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${e}`),this}};const YB=new RegExp("[,()]");var Zf=class extends sie{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}regexMatch(e,t){return this.url.searchParams.append(e,`match.${t}`),this}regexIMatch(e,t){return this.url.searchParams.append(e,`imatch.${t}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}isDistinct(e,t){return this.url.searchParams.append(e,`isdistinct.${t}`),this}in(e,t){const r=Array.from(new Set(t)).map(n=>typeof n=="string"&&YB.test(n)?`"${n}"`:`${n}`).join(",");return this.url.searchParams.append(e,`in.(${r})`),this}notIn(e,t){const r=Array.from(new Set(t)).map(n=>typeof n=="string"&&YB.test(n)?`"${n}"`:`${n}`).join(",");return this.url.searchParams.append(e,`not.in.(${r})`),this}contains(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return typeof t=="string"?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:r,type:n}={}){let o="";n==="plain"?o="pl":n==="phrase"?o="ph":n==="websearch"&&(o="w");const l=r===void 0?"":`(${r})`;return this.url.searchParams.append(e,`${o}fts${l}.${t}`),this}match(e){return Object.entries(e).forEach(([t,r])=>{this.url.searchParams.append(t,`eq.${r}`)}),this}not(e,t,r){return this.url.searchParams.append(e,`not.${t}.${r}`),this}or(e,{foreignTable:t,referencedTable:r=t}={}){const n=r?`${r}.or`:"or";return this.url.searchParams.append(n,`(${e})`),this}filter(e,t,r){return this.url.searchParams.append(e,`${t}.${r}`),this}},aie=class{constructor(e,{headers:t={},schema:r,fetch:n}){this.url=e,this.headers=new Headers(t),this.schema=r,this.fetch=n}cloneRequestState(){return{url:new URL(this.url.toString()),headers:new Headers(this.headers)}}select(e,t){const{head:r=!1,count:n}=t??{},o=r?"HEAD":"GET";let l=!1;const h=(e??"*").split("").map(y=>/\s/.test(y)&&!l?"":(y==='"'&&(l=!l),y)).join(""),{url:f,headers:s}=this.cloneRequestState();return f.searchParams.set("select",h),n&&s.append("Prefer",`count=${n}`),new Zf({method:o,url:f,headers:s,schema:this.schema,fetch:this.fetch})}insert(e,{count:t,defaultToNull:r=!0}={}){var n;const o="POST",{url:l,headers:h}=this.cloneRequestState();if(t&&h.append("Prefer",`count=${t}`),r||h.append("Prefer","missing=default"),Array.isArray(e)){const f=e.reduce((s,y)=>s.concat(Object.keys(y)),[]);if(f.length>0){const s=[...new Set(f)].map(y=>`"${y}"`);l.searchParams.set("columns",s.join(","))}}return new Zf({method:o,url:l,headers:h,schema:this.schema,body:e,fetch:(n=this.fetch)!==null&&n!==void 0?n:fetch})}upsert(e,{onConflict:t,ignoreDuplicates:r=!1,count:n,defaultToNull:o=!0}={}){var l;const h="POST",{url:f,headers:s}=this.cloneRequestState();if(s.append("Prefer",`resolution=${r?"ignore":"merge"}-duplicates`),t!==void 0&&f.searchParams.set("on_conflict",t),n&&s.append("Prefer",`count=${n}`),o||s.append("Prefer","missing=default"),Array.isArray(e)){const y=e.reduce((b,w)=>b.concat(Object.keys(w)),[]);if(y.length>0){const b=[...new Set(y)].map(w=>`"${w}"`);f.searchParams.set("columns",b.join(","))}}return new Zf({method:h,url:f,headers:s,schema:this.schema,body:e,fetch:(l=this.fetch)!==null&&l!==void 0?l:fetch})}update(e,{count:t}={}){var r;const n="PATCH",{url:o,headers:l}=this.cloneRequestState();return t&&l.append("Prefer",`count=${t}`),new Zf({method:n,url:o,headers:l,schema:this.schema,body:e,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch})}delete({count:e}={}){var t;const r="DELETE",{url:n,headers:o}=this.cloneRequestState();return e&&o.append("Prefer",`count=${e}`),new Zf({method:r,url:n,headers:o,schema:this.schema,fetch:(t=this.fetch)!==null&&t!==void 0?t:fetch})}},lie=class i8{constructor(t,{headers:r={},schema:n,fetch:o}={}){this.url=t,this.headers=new Headers(r),this.schemaName=n,this.fetch=o}from(t){if(!t||typeof t!="string"||t.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");return new aie(new URL(`${this.url}/${t}`),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new i8(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,r={},{head:n=!1,get:o=!1,count:l}={}){var h;let f;const s=new URL(`${this.url}/rpc/${t}`);let y;const b=k=>k!==null&&typeof k=="object"&&(!Array.isArray(k)||k.some(b)),w=n&&Object.values(r).some(b);w?(f="POST",y=r):n||o?(f=n?"HEAD":"GET",Object.entries(r).filter(([k,M])=>M!==void 0).map(([k,M])=>[k,Array.isArray(M)?`{${M.join(",")}}`:`${M}`]).forEach(([k,M])=>{s.searchParams.append(k,M)})):(f="POST",y=r);const A=new Headers(this.headers);return w?A.set("Prefer",l?`count=${l},return=minimal`:"return=minimal"):l&&A.set("Prefer",`count=${l}`),new Zf({method:f,url:s,headers:A,schema:this.schemaName,body:y,fetch:(h=this.fetch)!==null&&h!==void 0?h:fetch})}};class cie{constructor(){}static detectEnvironment(){var t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};const r=globalThis.process;if(r){const n=r.versions;if(n&&n.node){const o=n.node,l=parseInt(o.replace(/^v/,"").split(".")[0]);return l>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${l} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${l} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let r=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(r+=`

Suggested solution: ${t.workaround}`),new Error(r)}static createWebSocket(t,r){const n=this.getWebSocketConstructor();return new n(t,r)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}}const uie="2.90.1",hie=`realtime-js/${uie}`,o8="1.0.0",die="2.0.0",JB=o8,TC=1e4,fie=1e3,pie=100;var cu;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(cu||(cu={}));var Oi;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(Oi||(Oi={}));var Da;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(Da||(Da={}));var EC;(function(e){e.websocket="websocket"})(EC||(EC={}));var Hh;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(Hh||(Hh={}));class mie{constructor(t){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=t??[]}encode(t,r){if(t.event===this.BROADCAST_EVENT&&!(t.payload instanceof ArrayBuffer)&&typeof t.payload.event=="string")return r(this._binaryEncodeUserBroadcastPush(t));let n=[t.join_ref,t.ref,t.topic,t.event,t.payload];return r(JSON.stringify(n))}_binaryEncodeUserBroadcastPush(t){var r;return this._isArrayBuffer((r=t.payload)===null||r===void 0?void 0:r.payload)?this._encodeBinaryUserBroadcastPush(t):this._encodeJsonUserBroadcastPush(t)}_encodeBinaryUserBroadcastPush(t){var r,n;const o=(n=(r=t.payload)===null||r===void 0?void 0:r.payload)!==null&&n!==void 0?n:new ArrayBuffer(0);return this._encodeUserBroadcastPush(t,this.BINARY_ENCODING,o)}_encodeJsonUserBroadcastPush(t){var r,n;const o=(n=(r=t.payload)===null||r===void 0?void 0:r.payload)!==null&&n!==void 0?n:{},h=new TextEncoder().encode(JSON.stringify(o)).buffer;return this._encodeUserBroadcastPush(t,this.JSON_ENCODING,h)}_encodeUserBroadcastPush(t,r,n){var o,l;const h=t.topic,f=(o=t.ref)!==null&&o!==void 0?o:"",s=(l=t.join_ref)!==null&&l!==void 0?l:"",y=t.payload.event,b=this.allowedMetadataKeys?this._pick(t.payload,this.allowedMetadataKeys):{},w=Object.keys(b).length===0?"":JSON.stringify(b);if(s.length>255)throw new Error(`joinRef length ${s.length} exceeds maximum of 255`);if(f.length>255)throw new Error(`ref length ${f.length} exceeds maximum of 255`);if(h.length>255)throw new Error(`topic length ${h.length} exceeds maximum of 255`);if(y.length>255)throw new Error(`userEvent length ${y.length} exceeds maximum of 255`);if(w.length>255)throw new Error(`metadata length ${w.length} exceeds maximum of 255`);const A=this.USER_BROADCAST_PUSH_META_LENGTH+s.length+f.length+h.length+y.length+w.length,k=new ArrayBuffer(this.HEADER_LENGTH+A);let M=new DataView(k),R=0;M.setUint8(R++,this.KINDS.userBroadcastPush),M.setUint8(R++,s.length),M.setUint8(R++,f.length),M.setUint8(R++,h.length),M.setUint8(R++,y.length),M.setUint8(R++,w.length),M.setUint8(R++,r),Array.from(s,L=>M.setUint8(R++,L.charCodeAt(0))),Array.from(f,L=>M.setUint8(R++,L.charCodeAt(0))),Array.from(h,L=>M.setUint8(R++,L.charCodeAt(0))),Array.from(y,L=>M.setUint8(R++,L.charCodeAt(0))),Array.from(w,L=>M.setUint8(R++,L.charCodeAt(0)));var j=new Uint8Array(k.byteLength+n.byteLength);return j.set(new Uint8Array(k),0),j.set(new Uint8Array(n),k.byteLength),j.buffer}decode(t,r){if(this._isArrayBuffer(t)){let n=this._binaryDecode(t);return r(n)}if(typeof t=="string"){const n=JSON.parse(t),[o,l,h,f,s]=n;return r({join_ref:o,ref:l,topic:h,event:f,payload:s})}return r({})}_binaryDecode(t){const r=new DataView(t),n=r.getUint8(0),o=new TextDecoder;switch(n){case this.KINDS.userBroadcast:return this._decodeUserBroadcast(t,r,o)}}_decodeUserBroadcast(t,r,n){const o=r.getUint8(1),l=r.getUint8(2),h=r.getUint8(3),f=r.getUint8(4);let s=this.HEADER_LENGTH+4;const y=n.decode(t.slice(s,s+o));s=s+o;const b=n.decode(t.slice(s,s+l));s=s+l;const w=n.decode(t.slice(s,s+h));s=s+h;const A=t.slice(s,t.byteLength),k=f===this.JSON_ENCODING?JSON.parse(n.decode(A)):A,M={type:this.BROADCAST_EVENT,event:b,payload:k};return h>0&&(M.meta=JSON.parse(w)),{join_ref:null,ref:null,topic:y,event:this.BROADCAST_EVENT,payload:M}}_isArrayBuffer(t){var r;return t instanceof ArrayBuffer||((r=t==null?void 0:t.constructor)===null||r===void 0?void 0:r.name)==="ArrayBuffer"}_pick(t,r){return!t||typeof t!="object"?{}:Object.fromEntries(Object.entries(t).filter(([n])=>r.includes(n)))}}class s8{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Sn;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(Sn||(Sn={}));const QB=(e,t,r={})=>{var n;const o=(n=r.skipTypes)!==null&&n!==void 0?n:[];return t?Object.keys(t).reduce((l,h)=>(l[h]=gie(h,e,t,o),l),{}):{}},gie=(e,t,r,n)=>{const o=t.find(f=>f.name===e),l=o==null?void 0:o.type,h=r[e];return l&&!n.includes(l)?a8(l,h):AC(h)},a8=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return xie(t,r)}switch(e){case Sn.bool:return yie(t);case Sn.float4:case Sn.float8:case Sn.int2:case Sn.int4:case Sn.int8:case Sn.numeric:case Sn.oid:return vie(t);case Sn.json:case Sn.jsonb:return _ie(t);case Sn.timestamp:return bie(t);case Sn.abstime:case Sn.date:case Sn.daterange:case Sn.int4range:case Sn.int8range:case Sn.money:case Sn.reltime:case Sn.text:case Sn.time:case Sn.timestamptz:case Sn.timetz:case Sn.tsrange:case Sn.tstzrange:return AC(t);default:return AC(t)}},AC=e=>e,yie=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},vie=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},_ie=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch{return e}return e},xie=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,n=e[r];if(e[0]==="{"&&n==="}"){let l;const h=e.slice(1,r);try{l=JSON.parse("["+h+"]")}catch{l=h?h.split(","):[]}return l.map(f=>a8(t,f))}return e},bie=e=>typeof e=="string"?e.replace(" ","T"):e,l8=e=>{const t=new URL(e);return t.protocol=t.protocol.replace(/^ws/i,"http"),t.pathname=t.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),t.pathname===""||t.pathname==="/"?t.pathname="/api/broadcast":t.pathname=t.pathname+"/api/broadcast",t.href};class cA{constructor(t,r,n={},o=TC){this.channel=t,this.event=r,this.payload=n,this.timeout=o,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var n;return this._hasReceived(t)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(n=>n.status===t).forEach(n=>n.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var e3;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(e3||(e3={}));class sv{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},o=>{const{onJoin:l,onLeave:h,onSync:f}=this.caller;this.joinRef=this.channel._joinRef(),this.state=sv.syncState(this.state,o,l,h),this.pendingDiffs.forEach(s=>{this.state=sv.syncDiff(this.state,s,l,h)}),this.pendingDiffs=[],f()}),this.channel._on(n.diff,{},o=>{const{onJoin:l,onLeave:h,onSync:f}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(o):(this.state=sv.syncDiff(this.state,o,l,h),f())}),this.onJoin((o,l,h)=>{this.channel._trigger("presence",{event:"join",key:o,currentPresences:l,newPresences:h})}),this.onLeave((o,l,h)=>{this.channel._trigger("presence",{event:"leave",key:o,currentPresences:l,leftPresences:h})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,n,o){const l=this.cloneDeep(t),h=this.transformState(r),f={},s={};return this.map(l,(y,b)=>{h[y]||(s[y]=b)}),this.map(h,(y,b)=>{const w=l[y];if(w){const A=b.map(j=>j.presence_ref),k=w.map(j=>j.presence_ref),M=b.filter(j=>k.indexOf(j.presence_ref)<0),R=w.filter(j=>A.indexOf(j.presence_ref)<0);M.length>0&&(f[y]=M),R.length>0&&(s[y]=R)}else f[y]=b}),this.syncDiff(l,{joins:f,leaves:s},n,o)}static syncDiff(t,r,n,o){const{joins:l,leaves:h}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),o||(o=()=>{}),this.map(l,(f,s)=>{var y;const b=(y=t[f])!==null&&y!==void 0?y:[];if(t[f]=this.cloneDeep(s),b.length>0){const w=t[f].map(k=>k.presence_ref),A=b.filter(k=>w.indexOf(k.presence_ref)<0);t[f].unshift(...A)}n(f,b,s)}),this.map(h,(f,s)=>{let y=t[f];if(!y)return;const b=s.map(w=>w.presence_ref);y=y.filter(w=>b.indexOf(w.presence_ref)<0),t[f]=y,o(f,y,s),y.length===0&&delete t[f]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(n=>r(n,t[n]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,n)=>{const o=t[n];return"metas"in o?r[n]=o.metas.map(l=>(l.presence_ref=l.phx_ref,delete l.phx_ref,delete l.phx_ref_prev,l)):r[n]=o,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var t3;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(t3||(t3={}));var av;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(av||(av={}));var Yl;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(Yl||(Yl={}));class mp{constructor(t,r={config:{}},n){var o,l;if(this.topic=t,this.params=r,this.socket=n,this.bindings={},this.state=Oi.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new cA(this,Da.join,this.params,this.timeout),this.rejoinTimer=new s8(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Oi.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(h=>h.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Oi.closed,this.socket._remove(this)}),this._onError(h=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,h),this.state=Oi.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Oi.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",h=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,h),this.state=Oi.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Da.reply,{},(h,f)=>{this._trigger(this._replyEventName(f),h)}),this.presence=new sv(this),this.broadcastEndpointURL=l8(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((l=(o=this.params.config)===null||o===void 0?void 0:o.broadcast)===null||l===void 0)&&l.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(t,r=this.timeout){var n,o,l;if(this.socket.isConnected()||this.socket.connect(),this.state==Oi.closed){const{config:{broadcast:h,presence:f,private:s}}=this.params,y=(o=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(k=>k.filter))!==null&&o!==void 0?o:[],b=!!this.bindings[av.PRESENCE]&&this.bindings[av.PRESENCE].length>0||((l=this.params.config.presence)===null||l===void 0?void 0:l.enabled)===!0,w={},A={broadcast:h,presence:Object.assign(Object.assign({},f),{enabled:b}),postgres_changes:y,private:s};this.socket.accessTokenValue&&(w.access_token=this.socket.accessTokenValue),this._onError(k=>t==null?void 0:t(Yl.CHANNEL_ERROR,k)),this._onClose(()=>t==null?void 0:t(Yl.CLOSED)),this.updateJoinPayload(Object.assign({config:A},w)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:k})=>{var M;if(this.socket._isManualToken()||this.socket.setAuth(),k===void 0){t==null||t(Yl.SUBSCRIBED);return}else{const R=this.bindings.postgres_changes,j=(M=R==null?void 0:R.length)!==null&&M!==void 0?M:0,L=[];for(let z=0;z<j;z++){const B=R[z],{filter:{event:Z,schema:F,table:H,filter:Y}}=B,te=k&&k[z];if(te&&te.event===Z&&mp.isFilterValueEqual(te.schema,F)&&mp.isFilterValueEqual(te.table,H)&&mp.isFilterValueEqual(te.filter,Y))L.push(Object.assign(Object.assign({},B),{id:te.id}));else{this.unsubscribe(),this.state=Oi.errored,t==null||t(Yl.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=L,t&&t(Yl.SUBSCRIBED);return}}).receive("error",k=>{this.state=Oi.errored,t==null||t(Yl.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(k).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(Yl.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,n){return this.state===Oi.joined&&t===av.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(t,r,n)}async httpSend(t,r,n={}){var o;if(r==null)return Promise.reject("Payload is required for httpSend()");const l={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(l.Authorization=`Bearer ${this.socket.accessTokenValue}`);const h={method:"POST",headers:l,body:JSON.stringify({messages:[{topic:this.subTopic,event:t,payload:r,private:this.private}]})},f=await this._fetchWithTimeout(this.broadcastEndpointURL,h,(o=n.timeout)!==null&&o!==void 0?o:this.timeout);if(f.status===202)return{success:!0};let s=f.statusText;try{const y=await f.json();s=y.error||y.message||s}catch{}return Promise.reject(new Error(s))}async send(t,r={}){var n,o;if(!this._canPush()&&t.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:l,payload:h}=t,f={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(f.Authorization=`Bearer ${this.socket.accessTokenValue}`);const s={method:"POST",headers:f,body:JSON.stringify({messages:[{topic:this.subTopic,event:l,payload:h,private:this.private}]})};try{const y=await this._fetchWithTimeout(this.broadcastEndpointURL,s,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((o=y.body)===null||o===void 0?void 0:o.cancel()),y.ok?"ok":"error"}catch(y){return y.name==="AbortError"?"timed out":"error"}}else return new Promise(l=>{var h,f,s;const y=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((s=(f=(h=this.params)===null||h===void 0?void 0:h.config)===null||f===void 0?void 0:f.broadcast)===null||s===void 0)&&s.ack)&&l("ok"),y.receive("ok",()=>l("ok")),y.receive("error",()=>l("error")),y.receive("timeout",()=>l("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=Oi.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Da.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(o=>{n=new cA(this,Da.leave,{},t),n.receive("ok",()=>{r(),o("ok")}).receive("timeout",()=>{r(),o("timed out")}).receive("error",()=>{o("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n==null||n.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Oi.closed,this.bindings={}}async _fetchWithTimeout(t,r,n){const o=new AbortController,l=setTimeout(()=>o.abort(),n),h=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:o.signal}));return clearTimeout(l),h}_push(t,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let o=new cA(this,t,r,n);return this._canPush()?o.send():this._addToPushBuffer(o),o}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>pie){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(t,r,n){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,n){var o,l;const h=t.toLocaleLowerCase(),{close:f,error:s,leave:y,join:b}=Da;if(n&&[f,s,y,b].indexOf(h)>=0&&n!==this._joinRef())return;let A=this._onMessage(h,r,n);if(r&&!A)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(h)?(o=this.bindings.postgres_changes)===null||o===void 0||o.filter(k=>{var M,R,j;return((M=k.filter)===null||M===void 0?void 0:M.event)==="*"||((j=(R=k.filter)===null||R===void 0?void 0:R.event)===null||j===void 0?void 0:j.toLocaleLowerCase())===h}).map(k=>k.callback(A,n)):(l=this.bindings[h])===null||l===void 0||l.filter(k=>{var M,R,j,L,z,B,Z,F;if(["broadcast","presence","postgres_changes"].includes(h))if("id"in k){const H=k.id,Y=(M=k.filter)===null||M===void 0?void 0:M.event;return H&&((R=r.ids)===null||R===void 0?void 0:R.includes(H))&&(Y==="*"||(Y==null?void 0:Y.toLocaleLowerCase())===((j=r.data)===null||j===void 0?void 0:j.type.toLocaleLowerCase()))&&(!(!((L=k.filter)===null||L===void 0)&&L.table)||k.filter.table===((z=r.data)===null||z===void 0?void 0:z.table))}else{const H=(Z=(B=k==null?void 0:k.filter)===null||B===void 0?void 0:B.event)===null||Z===void 0?void 0:Z.toLocaleLowerCase();return H==="*"||H===((F=r==null?void 0:r.event)===null||F===void 0?void 0:F.toLocaleLowerCase())}else return k.type.toLocaleLowerCase()===h}).map(k=>{if(typeof A=="object"&&"ids"in A){const M=A.data,{schema:R,table:j,commit_timestamp:L,type:z,errors:B}=M;A=Object.assign(Object.assign({},{schema:R,table:j,commit_timestamp:L,eventType:z,new:{},old:{},errors:B}),this._getPayloadRecords(M))}k.callback(A,n)})}_isClosed(){return this.state===Oi.closed}_isJoined(){return this.state===Oi.joined}_isJoining(){return this.state===Oi.joining}_isLeaving(){return this.state===Oi.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,n){const o=t.toLocaleLowerCase(),l={type:o,filter:r,callback:n};return this.bindings[o]?this.bindings[o].push(l):this.bindings[o]=[l],this}_off(t,r){const n=t.toLocaleLowerCase();return this.bindings[n]&&(this.bindings[n]=this.bindings[n].filter(o=>{var l;return!(((l=o.type)===null||l===void 0?void 0:l.toLocaleLowerCase())===n&&mp.isEqual(o.filter,r))})),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const n in t)if(t[n]!==r[n])return!1;return!0}static isFilterValueEqual(t,r){return(t??void 0)===(r??void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(Da.close,{},t)}_onError(t){this._on(Da.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Oi.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=QB(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=QB(t.columns,t.old_record)),r}}const uA=()=>{},Nx={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},wie=[1e3,2e3,5e3,1e4],Sie=1e4,Tie=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class Eie{constructor(t,r){var n;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=TC,this.transport=null,this.heartbeatIntervalMs=Nx.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=uA,this.ref=0,this.reconnectTimer=null,this.vsn=JB,this.logger=uA,this.conn=null,this.sendBuffer=[],this.serializer=new mie,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._heartbeatSentAt=null,this._resolveFetch=o=>o?(...l)=>o(...l):(...l)=>fetch(...l),!(!((n=r==null?void 0:r.params)===null||n===void 0)&&n.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${t}/${EC.websocket}`,this.httpEndpoint=l8(t),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r==null?void 0:r.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=cie.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const r=t.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(t,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const n=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(n),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(t?this.conn.close(t,r??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,r,n){this.logger(t,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case cu.connecting:return Hh.Connecting;case cu.open:return Hh.Open;case cu.closing:return Hh.Closing;default:return Hh.Closed}}isConnected(){return this.connectionState()===Hh.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,r={config:{}}){const n=`realtime:${t}`,o=this.getChannels().find(l=>l.topic===n);if(o)return o;{const l=new mp(`realtime:${t}`,r,this);return this.channels.push(l),l}}push(t){const{topic:r,event:n,payload:o,ref:l}=t,h=()=>{this.encode(t,f=>{var s;(s=this.conn)===null||s===void 0||s.send(f)})};this.log("push",`${r} ${n} (${l})`,o),this.isConnected()?h():this.sendBuffer.push(h)}async setAuth(t=null){this._authPromise=this._performAuth(t);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var t;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this._heartbeatSentAt=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(fie,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},Nx.HEARTBEAT_TIMEOUT_FALLBACK);return}this._heartbeatSentAt=Date.now(),this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(n=>n.topic===t&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply"&&r.ref&&r.ref===this.pendingHeartbeatRef){const y=this._heartbeatSentAt?Date.now()-this._heartbeatSentAt:void 0;try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error",y)}catch(b){this.log("error","error in heartbeat callback",b)}this._heartbeatSentAt=null,this.pendingHeartbeatRef=null}const{topic:n,event:o,payload:l,ref:h}=r,f=h?`(${h})`:"",s=l.status||"";this.log("receive",`${s} ${n} ${o} ${f}`.trim(),l),this.channels.filter(y=>y._isMember(n)).forEach(y=>y._trigger(o,l,h)),this._triggerStateCallbacks("message",r)})}_clearTimer(t){var r;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t),this.conn.readyState===cu.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===cu.open||this.conn.readyState===cu.connecting)try{this.conn.close()}catch(t){this.log("error","Error closing connection",t)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(r=>{this.log("error","error waiting for auth on connect",r),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this._terminateWorker()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(t){var r;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t)}_triggerChanError(){this.channels.forEach(t=>t._trigger(Da.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const n=t.match(/\?/)?"&":"?",o=new URLSearchParams(r);return`${t}${n}${o}`}_workerObjectUrl(t){let r;if(t)r=t;else{const n=new Blob([Tie],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}_setConnectionState(t,r=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(t=null){let r,n=!1;if(t)r=t,n=!0;else if(this.accessToken)try{r=await this.accessToken()}catch(o){this.log("error","Error fetching access token from callback",o),r=this.accessTokenValue}else r=this.accessTokenValue;n?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(o=>{const l={access_token:r,version:hie};r&&o.updateJoinPayload(l),o.joinedOnce&&o._isJoined()&&o._push(Da.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(t="general"){this._isManualToken()||this.setAuth().catch(r=>{this.log("error",`Error setting auth in ${t}`,r)})}_triggerStateCallbacks(t,r){try{this.stateChangeCallbacks[t].forEach(n=>{try{n(r)}catch(o){this.log("error",`error in ${t} callback`,o)}})}catch(n){this.log("error",`error triggering ${t} callbacks`,n)}}_setupReconnectionTimer(){this.reconnectTimer=new s8(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Nx.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(t){var r,n,o,l,h,f,s,y,b,w,A,k;switch(this.transport=(r=t==null?void 0:t.transport)!==null&&r!==void 0?r:null,this.timeout=(n=t==null?void 0:t.timeout)!==null&&n!==void 0?n:TC,this.heartbeatIntervalMs=(o=t==null?void 0:t.heartbeatIntervalMs)!==null&&o!==void 0?o:Nx.HEARTBEAT_INTERVAL,this.worker=(l=t==null?void 0:t.worker)!==null&&l!==void 0?l:!1,this.accessToken=(h=t==null?void 0:t.accessToken)!==null&&h!==void 0?h:null,this.heartbeatCallback=(f=t==null?void 0:t.heartbeatCallback)!==null&&f!==void 0?f:uA,this.vsn=(s=t==null?void 0:t.vsn)!==null&&s!==void 0?s:JB,t!=null&&t.params&&(this.params=t.params),t!=null&&t.logger&&(this.logger=t.logger),(t!=null&&t.logLevel||t!=null&&t.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(y=t==null?void 0:t.reconnectAfterMs)!==null&&y!==void 0?y:M=>wie[M-1]||Sie,this.vsn){case o8:this.encode=(b=t==null?void 0:t.encode)!==null&&b!==void 0?b:(M,R)=>R(JSON.stringify(M)),this.decode=(w=t==null?void 0:t.decode)!==null&&w!==void 0?w:(M,R)=>R(JSON.parse(M));break;case die:this.encode=(A=t==null?void 0:t.encode)!==null&&A!==void 0?A:this.serializer.encode.bind(this.serializer),this.decode=(k=t==null?void 0:t.decode)!==null&&k!==void 0?k:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t==null?void 0:t.workerUrl}}}var $v=class extends Error{constructor(e,t){var r;super(e),this.name="IcebergError",this.status=t.status,this.icebergType=t.icebergType,this.icebergCode=t.icebergCode,this.details=t.details,this.isCommitStateUnknown=t.icebergType==="CommitStateUnknownException"||[500,502,504].includes(t.status)&&((r=t.icebergType)==null?void 0:r.includes("CommitState"))===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function Aie(e,t,r){const n=new URL(t,e);if(r)for(const[o,l]of Object.entries(r))l!==void 0&&n.searchParams.set(o,l);return n.toString()}async function Pie(e){return!e||e.type==="none"?{}:e.type==="bearer"?{Authorization:`Bearer ${e.token}`}:e.type==="header"?{[e.name]:e.value}:e.type==="custom"?await e.getHeaders():{}}function Cie(e){const t=e.fetchImpl??globalThis.fetch;return{async request({method:r,path:n,query:o,body:l,headers:h}){const f=Aie(e.baseUrl,n,o),s=await Pie(e.auth),y=await t(f,{method:r,headers:{...l?{"Content-Type":"application/json"}:{},...s,...h},body:l?JSON.stringify(l):void 0}),b=await y.text(),w=(y.headers.get("content-type")||"").includes("application/json"),A=w&&b?JSON.parse(b):b;if(!y.ok){const k=w?A:void 0,M=k==null?void 0:k.error;throw new $v((M==null?void 0:M.message)??`Request failed with status ${y.status}`,{status:y.status,icebergType:M==null?void 0:M.type,icebergCode:M==null?void 0:M.code,details:k})}return{status:y.status,headers:y.headers,data:A}}}}function $x(e){return e.join("")}var kie=class{constructor(e,t=""){this.client=e,this.prefix=t}async listNamespaces(e){const t=e?{parent:$x(e.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:t})).data.namespaces.map(n=>({namespace:n}))}async createNamespace(e,t){const r={namespace:e.namespace,properties:t==null?void 0:t.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:r})).data}async dropNamespace(e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${$x(e.namespace)}`})}async loadNamespaceMetadata(e){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${$x(e.namespace)}`})).data.properties}}async namespaceExists(e){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${$x(e.namespace)}`}),!0}catch(t){if(t instanceof $v&&t.status===404)return!1;throw t}}async createNamespaceIfNotExists(e,t){try{return await this.createNamespace(e,t)}catch(r){if(r instanceof $v&&r.status===409)return;throw r}}};function Bf(e){return e.join("")}var Oie=class{constructor(e,t="",r){this.client=e,this.prefix=t,this.accessDelegation=r}async listTables(e){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Bf(e.namespace)}/tables`})).data.identifiers}async createTable(e,t){const r={};return this.accessDelegation&&(r["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${Bf(e.namespace)}/tables`,body:t,headers:r})).data.metadata}async updateTable(e,t){const r=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${Bf(e.namespace)}/tables/${e.name}`,body:t});return{"metadata-location":r.data["metadata-location"],metadata:r.data.metadata}}async dropTable(e,t){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${Bf(e.namespace)}/tables/${e.name}`,query:{purgeRequested:String((t==null?void 0:t.purge)??!1)}})}async loadTable(e){const t={};return this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Bf(e.namespace)}/tables/${e.name}`,headers:t})).data.metadata}async tableExists(e){const t={};this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${Bf(e.namespace)}/tables/${e.name}`,headers:t}),!0}catch(r){if(r instanceof $v&&r.status===404)return!1;throw r}}async createTableIfNotExists(e,t){try{return await this.createTable(e,t)}catch(r){if(r instanceof $v&&r.status===409)return await this.loadTable({namespace:e.namespace,name:t.name});throw r}}},Mie=class{constructor(e){var n;let t="v1";e.catalogName&&(t+=`/${e.catalogName}`);const r=e.baseUrl.endsWith("/")?e.baseUrl:`${e.baseUrl}/`;this.client=Cie({baseUrl:r,auth:e.auth,fetchImpl:e.fetch}),this.accessDelegation=(n=e.accessDelegation)==null?void 0:n.join(","),this.namespaceOps=new kie(this.client,t),this.tableOps=new Oie(this.client,t,this.accessDelegation)}async listNamespaces(e){return this.namespaceOps.listNamespaces(e)}async createNamespace(e,t){return this.namespaceOps.createNamespace(e,t)}async dropNamespace(e){await this.namespaceOps.dropNamespace(e)}async loadNamespaceMetadata(e){return this.namespaceOps.loadNamespaceMetadata(e)}async listTables(e){return this.tableOps.listTables(e)}async createTable(e,t){return this.tableOps.createTable(e,t)}async updateTable(e,t){return this.tableOps.updateTable(e,t)}async dropTable(e,t){await this.tableOps.dropTable(e,t)}async loadTable(e){return this.tableOps.loadTable(e)}async namespaceExists(e){return this.namespaceOps.namespaceExists(e)}async tableExists(e){return this.tableOps.tableExists(e)}async createNamespaceIfNotExists(e,t){return this.namespaceOps.createNamespaceIfNotExists(e,t)}async createTableIfNotExists(e,t){return this.tableOps.createTableIfNotExists(e,t)}},G1=class extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}};function Yn(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}var Iie=class extends G1{constructor(e,t,r){super(e),this.name="StorageApiError",this.status=t,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},PC=class extends G1{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}};const tI=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),Rie=()=>Response,CC=e=>{if(Array.isArray(e))return e.map(r=>CC(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,n])=>{const o=r.replace(/([-_][a-z])/gi,l=>l.toUpperCase().replace(/[-_]/g,""));t[o]=CC(n)}),t},Die=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},Lie=e=>!e||typeof e!="string"||e.length===0||e.length>100||e.trim()!==e||e.includes("/")||e.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(e);function Fv(e){"@babel/helpers - typeof";return Fv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fv(e)}function jie(e,t){if(Fv(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Fv(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function zie(e){var t=jie(e,"string");return Fv(t)=="symbol"?t:t+""}function Bie(e,t,r){return(t=zie(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function r3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function pr(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?r3(Object(r),!0).forEach(function(n){Bie(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):r3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}const hA=e=>{var t;return e.msg||e.message||e.error_description||(typeof e.error=="string"?e.error:(t=e.error)===null||t===void 0?void 0:t.message)||JSON.stringify(e)},Nie=async(e,t,r)=>{e instanceof await Rie()&&!(r!=null&&r.noResolveJson)?e.json().then(n=>{const o=e.status||500,l=(n==null?void 0:n.statusCode)||o+"";t(new Iie(hA(n),o,l))}).catch(n=>{t(new PC(hA(n),n))}):t(new PC(hA(e),e))},$ie=(e,t,r,n)=>{const o={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"||!n?o:(Die(n)?(o.headers=pr({"Content-Type":"application/json"},t==null?void 0:t.headers),o.body=JSON.stringify(n)):o.body=n,t!=null&&t.duplex&&(o.duplex=t.duplex),pr(pr({},o),r))};async function F_(e,t,r,n,o,l){return new Promise((h,f)=>{e(r,$ie(t,n,o,l)).then(s=>{if(!s.ok)throw s;return n!=null&&n.noResolveJson?s:s.json()}).then(s=>h(s)).catch(s=>Nie(s,f,n))})}async function Uv(e,t,r,n){return F_(e,"GET",t,r,n)}async function Ia(e,t,r,n,o){return F_(e,"POST",t,n,o,r)}async function kC(e,t,r,n,o){return F_(e,"PUT",t,n,o,r)}async function Fie(e,t,r,n){return F_(e,"HEAD",t,pr(pr({},r),{},{noResolveJson:!0}),n)}async function rI(e,t,r,n,o){return F_(e,"DELETE",t,n,o,r)}var Uie=class{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t}then(e,t){return this.execute().then(e,t)}async execute(){var e=this;try{return{data:(await e.downloadFn()).body,error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Yn(t))return{data:null,error:t};throw t}}};let c8;c8=Symbol.toStringTag;var Vie=class{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t,this[c8]="BlobDownloadBuilder",this.promise=null}asStream(){return new Uie(this.downloadFn,this.shouldThrowOnError)}then(e,t){return this.getPromise().then(e,t)}catch(e){return this.getPromise().catch(e)}finally(e){return this.getPromise().finally(e)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){var e=this;try{return{data:await(await e.downloadFn()).blob(),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Yn(t))return{data:null,error:t};throw t}}};const Gie={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},n3={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var Wie=class{constructor(e,t={},r,n){this.shouldThrowOnError=!1,this.url=e,this.headers=t,this.bucketId=r,this.fetch=tI(n)}throwOnError(){return this.shouldThrowOnError=!0,this}async uploadOrUpdate(e,t,r,n){var o=this;try{let l;const h=pr(pr({},n3),n);let f=pr(pr({},o.headers),e==="POST"&&{"x-upsert":String(h.upsert)});const s=h.metadata;typeof Blob<"u"&&r instanceof Blob?(l=new FormData,l.append("cacheControl",h.cacheControl),s&&l.append("metadata",o.encodeMetadata(s)),l.append("",r)):typeof FormData<"u"&&r instanceof FormData?(l=r,l.has("cacheControl")||l.append("cacheControl",h.cacheControl),s&&!l.has("metadata")&&l.append("metadata",o.encodeMetadata(s))):(l=r,f["cache-control"]=`max-age=${h.cacheControl}`,f["content-type"]=h.contentType,s&&(f["x-metadata"]=o.toBase64(o.encodeMetadata(s))),(typeof ReadableStream<"u"&&l instanceof ReadableStream||l&&typeof l=="object"&&"pipe"in l&&typeof l.pipe=="function")&&!h.duplex&&(h.duplex="half")),n!=null&&n.headers&&(f=pr(pr({},f),n.headers));const y=o._removeEmptyFolders(t),b=o._getFinalPath(y),w=await(e=="PUT"?kC:Ia)(o.fetch,`${o.url}/object/${b}`,l,pr({headers:f},h!=null&&h.duplex?{duplex:h.duplex}:{}));return{data:{path:y,id:w.Id,fullPath:w.Key},error:null}}catch(l){if(o.shouldThrowOnError)throw l;if(Yn(l))return{data:null,error:l};throw l}}async upload(e,t,r){return this.uploadOrUpdate("POST",e,t,r)}async uploadToSignedUrl(e,t,r,n){var o=this;const l=o._removeEmptyFolders(e),h=o._getFinalPath(l),f=new URL(o.url+`/object/upload/sign/${h}`);f.searchParams.set("token",t);try{let s;const y=pr({upsert:n3.upsert},n),b=pr(pr({},o.headers),{"x-upsert":String(y.upsert)});return typeof Blob<"u"&&r instanceof Blob?(s=new FormData,s.append("cacheControl",y.cacheControl),s.append("",r)):typeof FormData<"u"&&r instanceof FormData?(s=r,s.append("cacheControl",y.cacheControl)):(s=r,b["cache-control"]=`max-age=${y.cacheControl}`,b["content-type"]=y.contentType),{data:{path:l,fullPath:(await kC(o.fetch,f.toString(),s,{headers:b})).Key},error:null}}catch(s){if(o.shouldThrowOnError)throw s;if(Yn(s))return{data:null,error:s};throw s}}async createSignedUploadUrl(e,t){var r=this;try{let n=r._getFinalPath(e);const o=pr({},r.headers);t!=null&&t.upsert&&(o["x-upsert"]="true");const l=await Ia(r.fetch,`${r.url}/object/upload/sign/${n}`,{},{headers:o}),h=new URL(r.url+l.url),f=h.searchParams.get("token");if(!f)throw new G1("No token returned by API");return{data:{signedUrl:h.toString(),path:e,token:f},error:null}}catch(n){if(r.shouldThrowOnError)throw n;if(Yn(n))return{data:null,error:n};throw n}}async update(e,t,r){return this.uploadOrUpdate("PUT",e,t,r)}async move(e,t,r){var n=this;try{return{data:await Ia(n.fetch,`${n.url}/object/move`,{bucketId:n.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r==null?void 0:r.destinationBucket},{headers:n.headers}),error:null}}catch(o){if(n.shouldThrowOnError)throw o;if(Yn(o))return{data:null,error:o};throw o}}async copy(e,t,r){var n=this;try{return{data:{path:(await Ia(n.fetch,`${n.url}/object/copy`,{bucketId:n.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r==null?void 0:r.destinationBucket},{headers:n.headers})).Key},error:null}}catch(o){if(n.shouldThrowOnError)throw o;if(Yn(o))return{data:null,error:o};throw o}}async createSignedUrl(e,t,r){var n=this;try{let o=n._getFinalPath(e),l=await Ia(n.fetch,`${n.url}/object/sign/${o}`,pr({expiresIn:t},r!=null&&r.transform?{transform:r.transform}:{}),{headers:n.headers});const h=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return l={signedUrl:encodeURI(`${n.url}${l.signedURL}${h}`)},{data:l,error:null}}catch(o){if(n.shouldThrowOnError)throw o;if(Yn(o))return{data:null,error:o};throw o}}async createSignedUrls(e,t,r){var n=this;try{const o=await Ia(n.fetch,`${n.url}/object/sign/${n.bucketId}`,{expiresIn:t,paths:e},{headers:n.headers}),l=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return{data:o.map(h=>pr(pr({},h),{},{signedUrl:h.signedURL?encodeURI(`${n.url}${h.signedURL}${l}`):null})),error:null}}catch(o){if(n.shouldThrowOnError)throw o;if(Yn(o))return{data:null,error:o};throw o}}download(e,t){const r=typeof(t==null?void 0:t.transform)<"u"?"render/image/authenticated":"object",n=this.transformOptsToQueryString((t==null?void 0:t.transform)||{}),o=n?`?${n}`:"",l=this._getFinalPath(e),h=()=>Uv(this.fetch,`${this.url}/${r}/${l}${o}`,{headers:this.headers,noResolveJson:!0});return new Vie(h,this.shouldThrowOnError)}async info(e){var t=this;const r=t._getFinalPath(e);try{return{data:CC(await Uv(t.fetch,`${t.url}/object/info/${r}`,{headers:t.headers})),error:null}}catch(n){if(t.shouldThrowOnError)throw n;if(Yn(n))return{data:null,error:n};throw n}}async exists(e){var t=this;const r=t._getFinalPath(e);try{return await Fie(t.fetch,`${t.url}/object/${r}`,{headers:t.headers}),{data:!0,error:null}}catch(n){if(t.shouldThrowOnError)throw n;if(Yn(n)&&n instanceof PC){const o=n.originalError;if([400,404].includes(o==null?void 0:o.status))return{data:!1,error:n}}throw n}}getPublicUrl(e,t){const r=this._getFinalPath(e),n=[],o=t!=null&&t.download?`download=${t.download===!0?"":t.download}`:"";o!==""&&n.push(o);const l=typeof(t==null?void 0:t.transform)<"u"?"render/image":"object",h=this.transformOptsToQueryString((t==null?void 0:t.transform)||{});h!==""&&n.push(h);let f=n.join("&");return f!==""&&(f=`?${f}`),{data:{publicUrl:encodeURI(`${this.url}/${l}/public/${r}${f}`)}}}async remove(e){var t=this;try{return{data:await rI(t.fetch,`${t.url}/object/${t.bucketId}`,{prefixes:e},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Yn(r))return{data:null,error:r};throw r}}async list(e,t,r){var n=this;try{const o=pr(pr(pr({},Gie),t),{},{prefix:e||""});return{data:await Ia(n.fetch,`${n.url}/object/list/${n.bucketId}`,o,{headers:n.headers},r),error:null}}catch(o){if(n.shouldThrowOnError)throw o;if(Yn(o))return{data:null,error:o};throw o}}async listV2(e,t){var r=this;try{const n=pr({},e);return{data:await Ia(r.fetch,`${r.url}/object/list-v2/${r.bucketId}`,n,{headers:r.headers},t),error:null}}catch(n){if(r.shouldThrowOnError)throw n;if(Yn(n))return{data:null,error:n};throw n}}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}};const u8="2.90.1",h8={"X-Client-Info":`storage-js/${u8}`};var qie=class{constructor(e,t={},r,n){this.shouldThrowOnError=!1;const o=new URL(e);n!=null&&n.useNewHostname&&/supabase\.(co|in|red)$/.test(o.hostname)&&!o.hostname.includes("storage.supabase.")&&(o.hostname=o.hostname.replace("supabase.","storage.supabase.")),this.url=o.href.replace(/\/$/,""),this.headers=pr(pr({},h8),t),this.fetch=tI(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async listBuckets(e){var t=this;try{const r=t.listBucketOptionsToQueryString(e);return{data:await Uv(t.fetch,`${t.url}/bucket${r}`,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Yn(r))return{data:null,error:r};throw r}}async getBucket(e){var t=this;try{return{data:await Uv(t.fetch,`${t.url}/bucket/${e}`,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Yn(r))return{data:null,error:r};throw r}}async createBucket(e,t={public:!1}){var r=this;try{return{data:await Ia(r.fetch,`${r.url}/bucket`,{id:e,name:e,type:t.type,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:r.headers}),error:null}}catch(n){if(r.shouldThrowOnError)throw n;if(Yn(n))return{data:null,error:n};throw n}}async updateBucket(e,t){var r=this;try{return{data:await kC(r.fetch,`${r.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:r.headers}),error:null}}catch(n){if(r.shouldThrowOnError)throw n;if(Yn(n))return{data:null,error:n};throw n}}async emptyBucket(e){var t=this;try{return{data:await Ia(t.fetch,`${t.url}/bucket/${e}/empty`,{},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Yn(r))return{data:null,error:r};throw r}}async deleteBucket(e){var t=this;try{return{data:await rI(t.fetch,`${t.url}/bucket/${e}`,{},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Yn(r))return{data:null,error:r};throw r}}listBucketOptionsToQueryString(e){const t={};return e&&("limit"in e&&(t.limit=String(e.limit)),"offset"in e&&(t.offset=String(e.offset)),e.search&&(t.search=e.search),e.sortColumn&&(t.sortColumn=e.sortColumn),e.sortOrder&&(t.sortOrder=e.sortOrder)),Object.keys(t).length>0?"?"+new URLSearchParams(t).toString():""}},Hie=class{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=pr(pr({},h8),t),this.fetch=tI(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(e){var t=this;try{return{data:await Ia(t.fetch,`${t.url}/bucket`,{name:e},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Yn(r))return{data:null,error:r};throw r}}async listBuckets(e){var t=this;try{const r=new URLSearchParams;(e==null?void 0:e.limit)!==void 0&&r.set("limit",e.limit.toString()),(e==null?void 0:e.offset)!==void 0&&r.set("offset",e.offset.toString()),e!=null&&e.sortColumn&&r.set("sortColumn",e.sortColumn),e!=null&&e.sortOrder&&r.set("sortOrder",e.sortOrder),e!=null&&e.search&&r.set("search",e.search);const n=r.toString(),o=n?`${t.url}/bucket?${n}`:`${t.url}/bucket`;return{data:await Uv(t.fetch,o,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Yn(r))return{data:null,error:r};throw r}}async deleteBucket(e){var t=this;try{return{data:await rI(t.fetch,`${t.url}/bucket/${e}`,{},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Yn(r))return{data:null,error:r};throw r}}from(e){var t=this;if(!Lie(e))throw new G1("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const r=new Mie({baseUrl:this.url,catalogName:e,auth:{type:"custom",getHeaders:async()=>t.headers},fetch:this.fetch}),n=this.shouldThrowOnError;return new Proxy(r,{get(o,l){const h=o[l];return typeof h!="function"?h:async(...f)=>{try{return{data:await h.apply(o,f),error:null}}catch(s){if(n)throw s;return{data:null,error:s}}}}})}};const nI={"X-Client-Info":`storage-js/${u8}`,"Content-Type":"application/json"};var d8=class extends Error{constructor(e){super(e),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}};function Ss(e){return typeof e=="object"&&e!==null&&"__isStorageVectorsError"in e}var dA=class extends d8{constructor(e,t,r){super(e),this.name="StorageVectorsApiError",this.status=t,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},Kie=class extends d8{constructor(e,t){super(e),this.name="StorageVectorsUnknownError",this.originalError=t}};const iI=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),Zie=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},i3=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),Xie=async(e,t,r)=>{if(e&&typeof e=="object"&&"status"in e&&"ok"in e&&typeof e.status=="number"&&!(r!=null&&r.noResolveJson)){const n=e.status||500,o=e;if(typeof o.json=="function")o.json().then(l=>{const h=(l==null?void 0:l.statusCode)||(l==null?void 0:l.code)||n+"";t(new dA(i3(l),n,h))}).catch(()=>{const l=n+"";t(new dA(o.statusText||`HTTP ${n} error`,n,l))});else{const l=n+"";t(new dA(o.statusText||`HTTP ${n} error`,n,l))}}else t(new Kie(i3(e),e))},Yie=(e,t,r,n)=>{const o={method:e,headers:(t==null?void 0:t.headers)||{}};return n?(Zie(n)?(o.headers=pr({"Content-Type":"application/json"},t==null?void 0:t.headers),o.body=JSON.stringify(n)):o.body=n,pr(pr({},o),r)):o};async function Jie(e,t,r,n,o,l){return new Promise((h,f)=>{e(r,Yie(t,n,o,l)).then(s=>{if(!s.ok)throw s;if(n!=null&&n.noResolveJson)return s;const y=s.headers.get("content-type");return!y||!y.includes("application/json")?{}:s.json()}).then(s=>h(s)).catch(s=>Xie(s,f,n))})}async function Ts(e,t,r,n,o){return Jie(e,"POST",t,n,o,r)}var Qie=class{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=pr(pr({},nI),t),this.fetch=iI(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async createIndex(e){var t=this;try{return{data:await Ts(t.fetch,`${t.url}/CreateIndex`,e,{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Ss(r))return{data:null,error:r};throw r}}async getIndex(e,t){var r=this;try{return{data:await Ts(r.fetch,`${r.url}/GetIndex`,{vectorBucketName:e,indexName:t},{headers:r.headers}),error:null}}catch(n){if(r.shouldThrowOnError)throw n;if(Ss(n))return{data:null,error:n};throw n}}async listIndexes(e){var t=this;try{return{data:await Ts(t.fetch,`${t.url}/ListIndexes`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Ss(r))return{data:null,error:r};throw r}}async deleteIndex(e,t){var r=this;try{return{data:await Ts(r.fetch,`${r.url}/DeleteIndex`,{vectorBucketName:e,indexName:t},{headers:r.headers})||{},error:null}}catch(n){if(r.shouldThrowOnError)throw n;if(Ss(n))return{data:null,error:n};throw n}}},eoe=class{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=pr(pr({},nI),t),this.fetch=iI(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async putVectors(e){var t=this;try{if(e.vectors.length<1||e.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:await Ts(t.fetch,`${t.url}/PutVectors`,e,{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Ss(r))return{data:null,error:r};throw r}}async getVectors(e){var t=this;try{return{data:await Ts(t.fetch,`${t.url}/GetVectors`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Ss(r))return{data:null,error:r};throw r}}async listVectors(e){var t=this;try{if(e.segmentCount!==void 0){if(e.segmentCount<1||e.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(e.segmentIndex!==void 0&&(e.segmentIndex<0||e.segmentIndex>=e.segmentCount))throw new Error(`segmentIndex must be between 0 and ${e.segmentCount-1}`)}return{data:await Ts(t.fetch,`${t.url}/ListVectors`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Ss(r))return{data:null,error:r};throw r}}async queryVectors(e){var t=this;try{return{data:await Ts(t.fetch,`${t.url}/QueryVectors`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Ss(r))return{data:null,error:r};throw r}}async deleteVectors(e){var t=this;try{if(e.keys.length<1||e.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:await Ts(t.fetch,`${t.url}/DeleteVectors`,e,{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Ss(r))return{data:null,error:r};throw r}}},toe=class{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=pr(pr({},nI),t),this.fetch=iI(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(e){var t=this;try{return{data:await Ts(t.fetch,`${t.url}/CreateVectorBucket`,{vectorBucketName:e},{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Ss(r))return{data:null,error:r};throw r}}async getBucket(e){var t=this;try{return{data:await Ts(t.fetch,`${t.url}/GetVectorBucket`,{vectorBucketName:e},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Ss(r))return{data:null,error:r};throw r}}async listBuckets(e={}){var t=this;try{return{data:await Ts(t.fetch,`${t.url}/ListVectorBuckets`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Ss(r))return{data:null,error:r};throw r}}async deleteBucket(e){var t=this;try{return{data:await Ts(t.fetch,`${t.url}/DeleteVectorBucket`,{vectorBucketName:e},{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Ss(r))return{data:null,error:r};throw r}}},roe=class extends toe{constructor(e,t={}){super(e,t.headers||{},t.fetch)}from(e){return new noe(this.url,this.headers,e,this.fetch)}async createBucket(e){var t=()=>super.createBucket,r=this;return t().call(r,e)}async getBucket(e){var t=()=>super.getBucket,r=this;return t().call(r,e)}async listBuckets(e={}){var t=()=>super.listBuckets,r=this;return t().call(r,e)}async deleteBucket(e){var t=()=>super.deleteBucket,r=this;return t().call(r,e)}},noe=class extends Qie{constructor(e,t,r,n){super(e,t,n),this.vectorBucketName=r}async createIndex(e){var t=()=>super.createIndex,r=this;return t().call(r,pr(pr({},e),{},{vectorBucketName:r.vectorBucketName}))}async listIndexes(e={}){var t=()=>super.listIndexes,r=this;return t().call(r,pr(pr({},e),{},{vectorBucketName:r.vectorBucketName}))}async getIndex(e){var t=()=>super.getIndex,r=this;return t().call(r,r.vectorBucketName,e)}async deleteIndex(e){var t=()=>super.deleteIndex,r=this;return t().call(r,r.vectorBucketName,e)}index(e){return new ioe(this.url,this.headers,this.vectorBucketName,e,this.fetch)}},ioe=class extends eoe{constructor(e,t,r,n,o){super(e,t,o),this.vectorBucketName=r,this.indexName=n}async putVectors(e){var t=()=>super.putVectors,r=this;return t().call(r,pr(pr({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async getVectors(e){var t=()=>super.getVectors,r=this;return t().call(r,pr(pr({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async listVectors(e={}){var t=()=>super.listVectors,r=this;return t().call(r,pr(pr({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async queryVectors(e){var t=()=>super.queryVectors,r=this;return t().call(r,pr(pr({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async deleteVectors(e){var t=()=>super.deleteVectors,r=this;return t().call(r,pr(pr({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}},ooe=class extends qie{constructor(e,t={},r,n){super(e,t,r,n)}from(e){return new Wie(this.url,this.headers,e,this.fetch)}get vectors(){return new roe(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new Hie(this.url+"/iceberg",this.headers,this.fetch)}};const f8="2.90.1",Xf=30*1e3,OC=3,fA=OC*Xf,soe="http://localhost:9999",aoe="supabase.auth.token",loe={"X-Client-Info":`gotrue-js/${f8}`},MC="X-Supabase-Api-Version",p8={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},coe=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,uoe=10*60*1e3;class Vv extends Error{constructor(t,r,n){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function er(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class hoe extends Vv{constructor(t,r,n){super(t,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function doe(e){return er(e)&&e.name==="AuthApiError"}class Kh extends Vv{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class bc extends Vv{constructor(t,r,n,o){super(t,n,o),this.name=r,this.status=n}}class ys extends bc{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function foe(e){return er(e)&&e.name==="AuthSessionMissingError"}class Nf extends bc{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Fx extends bc{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class Ux extends bc{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function poe(e){return er(e)&&e.name==="AuthImplicitGrantRedirectError"}class o3 extends bc{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class moe extends bc{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class IC extends bc{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function pA(e){return er(e)&&e.name==="AuthRetryableFetchError"}class s3 extends bc{constructor(t,r,n){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}class RC extends bc{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const cw="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),a3=` 	
\r=`.split(""),goe=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<a3.length;t+=1)e[a3[t].charCodeAt(0)]=-2;for(let t=0;t<cw.length;t+=1)e[cw[t].charCodeAt(0)]=t;return e})();function l3(e,t,r){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(cw[n]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(cw[n]),t.queuedBits-=6}}function m8(e,t,r){const n=goe[e];if(n>-1)for(t.queue=t.queue<<6|n,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function c3(e){const t=[],r=h=>{t.push(String.fromCodePoint(h))},n={utf8seq:0,codepoint:0},o={queue:0,queuedBits:0},l=h=>{_oe(h,n,r)};for(let h=0;h<e.length;h+=1)m8(e.charCodeAt(h),o,l);return t.join("")}function yoe(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function voe(e,t){for(let r=0;r<e.length;r+=1){let n=e.charCodeAt(r);if(n>55295&&n<=56319){const o=(n-55296)*1024&65535;n=(e.charCodeAt(r+1)-56320&65535|o)+65536,r+=1}yoe(n,t)}}function _oe(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let n=1;n<6;n+=1)if(!(e>>7-n&1)){t.utf8seq=n;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function Cp(e){const t=[],r={queue:0,queuedBits:0},n=o=>{t.push(o)};for(let o=0;o<e.length;o+=1)m8(e.charCodeAt(o),r,n);return new Uint8Array(t)}function xoe(e){const t=[];return voe(e,r=>t.push(r)),new Uint8Array(t)}function td(e){const t=[],r={queue:0,queuedBits:0},n=o=>{t.push(o)};return e.forEach(o=>l3(o,r,n)),l3(null,r,n),t.join("")}function boe(e){return Math.round(Date.now()/1e3)+e}function woe(){return Symbol("auth-callback")}const Ji=()=>typeof window<"u"&&typeof document<"u",jh={tested:!1,writable:!1},g8=()=>{if(!Ji())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(jh.tested)return jh.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),jh.tested=!0,jh.writable=!0}catch{jh.tested=!0,jh.writable=!1}return jh.writable};function Soe(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((o,l)=>{t[l]=o})}catch{}return r.searchParams.forEach((n,o)=>{t[o]=n}),t}const y8=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),Toe=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",Yf=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},zh=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},Yi=async(e,t)=>{await e.removeItem(t)};class W1{constructor(){this.promise=new W1.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}W1.promiseConstructor=Promise;function mA(e){const t=e.split(".");if(t.length!==3)throw new RC("Invalid JWT structure");for(let n=0;n<t.length;n++)if(!coe.test(t[n]))throw new RC("JWT not in base64url format");return{header:JSON.parse(c3(t[0])),payload:JSON.parse(c3(t[1])),signature:Cp(t[2]),raw:{header:t[0],payload:t[1]}}}async function Eoe(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function Aoe(e,t){return new Promise((n,o)=>{(async()=>{for(let l=0;l<1/0;l++)try{const h=await e(l);if(!t(l,null,h)){n(h);return}}catch(h){if(!t(l,h)){o(h);return}}})()})}function Poe(e){return("0"+e.toString(16)).substr(-2)}function Coe(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let o="";for(let l=0;l<56;l++)o+=r.charAt(Math.floor(Math.random()*n));return o}return crypto.getRandomValues(t),Array.from(t,Poe).join("")}async function koe(e){const r=new TextEncoder().encode(e),n=await crypto.subtle.digest("SHA-256",r),o=new Uint8Array(n);return Array.from(o).map(l=>String.fromCharCode(l)).join("")}async function Ooe(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=await koe(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function $f(e,t,r=!1){const n=Coe();let o=n;r&&(o+="/PASSWORD_RECOVERY"),await Yf(e,`${t}-code-verifier`,o);const l=await Ooe(n);return[l,n===l?"plain":"s256"]}const Moe=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function Ioe(e){const t=e.headers.get(MC);if(!t||!t.match(Moe))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function Roe(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function Doe(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const Loe=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Ff(e){if(!Loe.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function gA(){const e={};return new Proxy(e,{get:(t,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const n=r.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function joe(e,t){return new Proxy(e,{get:(r,n,o)=>{if(n==="__isInsecureUserWarningProxy")return!0;if(typeof n=="symbol"){const l=n.toString();if(l==="Symbol(Symbol.toPrimitive)"||l==="Symbol(Symbol.toStringTag)"||l==="Symbol(util.inspect.custom)"||l==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(r,n,o)}return!t.value&&typeof n=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),t.value=!0),Reflect.get(r,n,o)}})}function u3(e){return JSON.parse(JSON.stringify(e))}const Uh=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),zoe=[502,503,504];async function h3(e){var t;if(!Toe(e))throw new IC(Uh(e),0);if(zoe.includes(e.status))throw new IC(Uh(e),e.status);let r;try{r=await e.json()}catch(l){throw new Kh(Uh(l),l)}let n;const o=Ioe(e);if(o&&o.getTime()>=p8["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new s3(Uh(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(n==="session_not_found")throw new ys}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((l,h)=>l&&typeof h=="string",!0))throw new s3(Uh(r),e.status,r.weak_password.reasons);throw new hoe(Uh(r),e.status||500,n)}const Boe=(e,t,r,n)=>{const o={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?o:(o.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),o.body=JSON.stringify(n),Object.assign(Object.assign({},o),r))};async function fr(e,t,r,n){var o;const l=Object.assign({},n==null?void 0:n.headers);l[MC]||(l[MC]=p8["2024-01-01"].name),n!=null&&n.jwt&&(l.Authorization=`Bearer ${n.jwt}`);const h=(o=n==null?void 0:n.query)!==null&&o!==void 0?o:{};n!=null&&n.redirectTo&&(h.redirect_to=n.redirectTo);const f=Object.keys(h).length?"?"+new URLSearchParams(h).toString():"",s=await Noe(e,t,r+f,{headers:l,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(s):{data:Object.assign({},s),error:null}}async function Noe(e,t,r,n,o,l){const h=Boe(t,n,o,l);let f;try{f=await e(r,Object.assign({},h))}catch(s){throw console.error(s),new IC(Uh(s),0)}if(f.ok||await h3(f),n!=null&&n.noResolveJson)return f;try{return await f.json()}catch(s){await h3(s)}}function Ca(e){var t;let r=null;Uoe(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=boe(e.expires_in)));const n=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:n},error:null}}function d3(e){const t=Ca(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(t.data.weak_password=e.weak_password),t}function fu(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function $oe(e){return{data:e,error:null}}function Foe(e){const{action_link:t,email_otp:r,hashed_token:n,redirect_to:o,verification_type:l}=e,h=V1(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),f={action_link:t,email_otp:r,hashed_token:n,redirect_to:o,verification_type:l},s=Object.assign({},h);return{data:{properties:f,user:s},error:null}}function f3(e){return e}function Uoe(e){return e.access_token&&e.refresh_token&&e.expires_in}const yA=["global","local","others"];class Voe{constructor({url:t="",headers:r={},fetch:n}){this.url=t,this.headers=r,this.fetch=y8(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(t,r=yA[0]){if(yA.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${yA.join(", ")}`);try{return await fr(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(n){if(er(n))return{data:null,error:n};throw n}}async inviteUserByEmail(t,r={}){try{return await fr(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:fu})}catch(n){if(er(n))return{data:{user:null},error:n};throw n}}async generateLink(t){try{const{options:r}=t,n=V1(t,["options"]),o=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(o.new_email=n==null?void 0:n.newEmail,delete o.newEmail),await fr(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:o,headers:this.headers,xform:Foe,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(er(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await fr(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:fu})}catch(r){if(er(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,n,o,l,h,f,s;try{const y={nextPage:null,lastPage:0,total:0},b=await fr(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(l=(o=t==null?void 0:t.perPage)===null||o===void 0?void 0:o.toString())!==null&&l!==void 0?l:""},xform:f3});if(b.error)throw b.error;const w=await b.json(),A=(h=b.headers.get("x-total-count"))!==null&&h!==void 0?h:0,k=(s=(f=b.headers.get("link"))===null||f===void 0?void 0:f.split(","))!==null&&s!==void 0?s:[];return k.length>0&&(k.forEach(M=>{const R=parseInt(M.split(";")[0].split("=")[1].substring(0,1)),j=JSON.parse(M.split(";")[1].split("=")[1]);y[`${j}Page`]=R}),y.total=parseInt(A)),{data:Object.assign(Object.assign({},w),y),error:null}}catch(y){if(er(y))return{data:{users:[]},error:y};throw y}}async getUserById(t){Ff(t);try{return await fr(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:fu})}catch(r){if(er(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){Ff(t);try{return await fr(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:fu})}catch(n){if(er(n))return{data:{user:null},error:n};throw n}}async deleteUser(t,r=!1){Ff(t);try{return await fr(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:fu})}catch(n){if(er(n))return{data:{user:null},error:n};throw n}}async _listFactors(t){Ff(t.userId);try{const{data:r,error:n}=await fr(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:o=>({data:{factors:o},error:null})});return{data:r,error:n}}catch(r){if(er(r))return{data:null,error:r};throw r}}async _deleteFactor(t){Ff(t.userId),Ff(t.id);try{return{data:await fr(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(er(r))return{data:null,error:r};throw r}}async _listOAuthClients(t){var r,n,o,l,h,f,s;try{const y={nextPage:null,lastPage:0,total:0},b=await fr(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(l=(o=t==null?void 0:t.perPage)===null||o===void 0?void 0:o.toString())!==null&&l!==void 0?l:""},xform:f3});if(b.error)throw b.error;const w=await b.json(),A=(h=b.headers.get("x-total-count"))!==null&&h!==void 0?h:0,k=(s=(f=b.headers.get("link"))===null||f===void 0?void 0:f.split(","))!==null&&s!==void 0?s:[];return k.length>0&&(k.forEach(M=>{const R=parseInt(M.split(";")[0].split("=")[1].substring(0,1)),j=JSON.parse(M.split(";")[1].split("=")[1]);y[`${j}Page`]=R}),y.total=parseInt(A)),{data:Object.assign(Object.assign({},w),y),error:null}}catch(y){if(er(y))return{data:{clients:[]},error:y};throw y}}async _createOAuthClient(t){try{return await fr(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:t,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(er(r))return{data:null,error:r};throw r}}async _getOAuthClient(t){try{return await fr(this.fetch,"GET",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(er(r))return{data:null,error:r};throw r}}async _updateOAuthClient(t,r){try{return await fr(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${t}`,{body:r,headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(er(n))return{data:null,error:n};throw n}}async _deleteOAuthClient(t){try{return await fr(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(r){if(er(r))return{data:null,error:r};throw r}}async _regenerateOAuthClientSecret(t){try{return await fr(this.fetch,"POST",`${this.url}/admin/oauth/clients/${t}/regenerate_secret`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(er(r))return{data:null,error:r};throw r}}}function p3(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}const Uf={debug:!!(globalThis&&g8()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class v8 extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class Goe extends v8{}async function Woe(e,t,r){Uf.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const n=new globalThis.AbortController;return t>0&&setTimeout(()=>{n.abort(),Uf.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async o=>{if(o){Uf.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,o.name);try{return await r()}finally{Uf.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,o.name)}}else{if(t===0)throw Uf.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new Goe(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(Uf.debug)try{const l=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(l,null,"  "))}catch(l){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",l)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}function qoe(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function _8(e){if(!/^0x[a-fA-F0-9]{40}$/.test(e))throw new Error(`@supabase/auth-js: Address "${e}" is invalid.`);return e.toLowerCase()}function Hoe(e){return parseInt(e,16)}function Koe(e){const t=new TextEncoder().encode(e);return"0x"+Array.from(t,n=>n.toString(16).padStart(2,"0")).join("")}function Zoe(e){var t;const{chainId:r,domain:n,expirationTime:o,issuedAt:l=new Date,nonce:h,notBefore:f,requestId:s,resources:y,scheme:b,uri:w,version:A}=e;{if(!Number.isInteger(r))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${r}`);if(!n)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(h&&h.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${h}`);if(!w)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(A!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${A}`);if(!((t=e.statement)===null||t===void 0)&&t.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${e.statement}`)}const k=_8(e.address),M=b?`${b}://${n}`:n,R=e.statement?`${e.statement}
`:"",j=`${M} wants you to sign in with your Ethereum account:
${k}

${R}`;let L=`URI: ${w}
Version: ${A}
Chain ID: ${r}${h?`
Nonce: ${h}`:""}
Issued At: ${l.toISOString()}`;if(o&&(L+=`
Expiration Time: ${o.toISOString()}`),f&&(L+=`
Not Before: ${f.toISOString()}`),s&&(L+=`
Request ID: ${s}`),y){let z=`
Resources:`;for(const B of y){if(!B||typeof B!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${B}`);z+=`
- ${B}`}L+=z}return`${j}
${L}`}class yi extends Error{constructor({message:t,code:r,cause:n,name:o}){var l;super(t,{cause:n}),this.__isWebAuthnError=!0,this.name=(l=o??(n instanceof Error?n.name:void 0))!==null&&l!==void 0?l:"Unknown Error",this.code=r}}class uw extends yi{constructor(t,r){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r,message:t}),this.name="WebAuthnUnknownError",this.originalError=r}}function Xoe({error:e,options:t}){var r,n,o;const{publicKey:l}=t;if(!l)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new yi({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else if(e.name==="ConstraintError"){if(((r=l.authenticatorSelection)===null||r===void 0?void 0:r.requireResidentKey)===!0)return new yi({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:e});if(t.mediation==="conditional"&&((n=l.authenticatorSelection)===null||n===void 0?void 0:n.userVerification)==="required")return new yi({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:e});if(((o=l.authenticatorSelection)===null||o===void 0?void 0:o.userVerification)==="required")return new yi({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:e})}else{if(e.name==="InvalidStateError")return new yi({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:e});if(e.name==="NotAllowedError")return new yi({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="NotSupportedError")return l.pubKeyCredParams.filter(f=>f.type==="public-key").length===0?new yi({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:e}):new yi({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:e});if(e.name==="SecurityError"){const h=window.location.hostname;if(x8(h)){if(l.rp.id!==h)return new yi({message:`The RP ID "${l.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new yi({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="TypeError"){if(l.user.id.byteLength<1||l.user.id.byteLength>64)return new yi({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:e})}else if(e.name==="UnknownError")return new yi({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new yi({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}function Yoe({error:e,options:t}){const{publicKey:r}=t;if(!r)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new yi({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else{if(e.name==="NotAllowedError")return new yi({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="SecurityError"){const n=window.location.hostname;if(x8(n)){if(r.rpId!==n)return new yi({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new yi({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="UnknownError")return new yi({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new yi({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}class Joe{createNewAbortSignal(){if(this.controller){const r=new Error("Cancelling existing WebAuthn API call for new one");r.name="AbortError",this.controller.abort(r)}const t=new AbortController;return this.controller=t,t.signal}cancelCeremony(){if(this.controller){const t=new Error("Manually cancelling existing WebAuthn API call");t.name="AbortError",this.controller.abort(t),this.controller=void 0}}}const Qoe=new Joe;function ese(e){if(!e)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(e);const{challenge:t,user:r,excludeCredentials:n}=e,o=V1(e,["challenge","user","excludeCredentials"]),l=Cp(t).buffer,h=Object.assign(Object.assign({},r),{id:Cp(r.id).buffer}),f=Object.assign(Object.assign({},o),{challenge:l,user:h});if(n&&n.length>0){f.excludeCredentials=new Array(n.length);for(let s=0;s<n.length;s++){const y=n[s];f.excludeCredentials[s]=Object.assign(Object.assign({},y),{id:Cp(y.id).buffer,type:y.type||"public-key",transports:y.transports})}}return f}function tse(e){if(!e)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(e);const{challenge:t,allowCredentials:r}=e,n=V1(e,["challenge","allowCredentials"]),o=Cp(t).buffer,l=Object.assign(Object.assign({},n),{challenge:o});if(r&&r.length>0){l.allowCredentials=new Array(r.length);for(let h=0;h<r.length;h++){const f=r[h];l.allowCredentials[h]=Object.assign(Object.assign({},f),{id:Cp(f.id).buffer,type:f.type||"public-key",transports:f.transports})}}return l}function rse(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e;return{id:e.id,rawId:e.id,response:{attestationObject:td(new Uint8Array(e.response.attestationObject)),clientDataJSON:td(new Uint8Array(e.response.clientDataJSON))},type:"public-key",clientExtensionResults:e.getClientExtensionResults(),authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function nse(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e,n=e.getClientExtensionResults(),o=e.response;return{id:e.id,rawId:e.id,response:{authenticatorData:td(new Uint8Array(o.authenticatorData)),clientDataJSON:td(new Uint8Array(o.clientDataJSON)),signature:td(new Uint8Array(o.signature)),userHandle:o.userHandle?td(new Uint8Array(o.userHandle)):void 0},type:"public-key",clientExtensionResults:n,authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function x8(e){return e==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(e)}function m3(){var e,t;return!!(Ji()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((e=navigator==null?void 0:navigator.credentials)===null||e===void 0?void 0:e.create)=="function"&&typeof((t=navigator==null?void 0:navigator.credentials)===null||t===void 0?void 0:t.get)=="function")}async function ise(e){try{const t=await navigator.credentials.create(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new uw("Browser returned unexpected credential type",t)}:{data:null,error:new uw("Empty credential response",t)}}catch(t){return{data:null,error:Xoe({error:t,options:e})}}}async function ose(e){try{const t=await navigator.credentials.get(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new uw("Browser returned unexpected credential type",t)}:{data:null,error:new uw("Empty credential response",t)}}catch(t){return{data:null,error:Yoe({error:t,options:e})}}}const sse={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},ase={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function hw(...e){const t=o=>o!==null&&typeof o=="object"&&!Array.isArray(o),r=o=>o instanceof ArrayBuffer||ArrayBuffer.isView(o),n={};for(const o of e)if(o)for(const l in o){const h=o[l];if(h!==void 0)if(Array.isArray(h))n[l]=h;else if(r(h))n[l]=h;else if(t(h)){const f=n[l];t(f)?n[l]=hw(f,h):n[l]=hw(h)}else n[l]=h}return n}function lse(e,t){return hw(sse,e,t||{})}function cse(e,t){return hw(ase,e,t||{})}class use{constructor(t){this.client=t,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(t){return this.client.mfa.enroll(Object.assign(Object.assign({},t),{factorType:"webauthn"}))}async _challenge({factorId:t,webauthn:r,friendlyName:n,signal:o},l){try{const{data:h,error:f}=await this.client.mfa.challenge({factorId:t,webauthn:r});if(!h)return{data:null,error:f};const s=o??Qoe.createNewAbortSignal();if(h.webauthn.type==="create"){const{user:y}=h.webauthn.credential_options.publicKey;y.name||(y.name=`${y.id}:${n}`),y.displayName||(y.displayName=y.name)}switch(h.webauthn.type){case"create":{const y=lse(h.webauthn.credential_options.publicKey,l==null?void 0:l.create),{data:b,error:w}=await ise({publicKey:y,signal:s});return b?{data:{factorId:t,challengeId:h.id,webauthn:{type:h.webauthn.type,credential_response:b}},error:null}:{data:null,error:w}}case"request":{const y=cse(h.webauthn.credential_options.publicKey,l==null?void 0:l.request),{data:b,error:w}=await ose(Object.assign(Object.assign({},h.webauthn.credential_options),{publicKey:y,signal:s}));return b?{data:{factorId:t,challengeId:h.id,webauthn:{type:h.webauthn.type,credential_response:b}},error:null}:{data:null,error:w}}}}catch(h){return er(h)?{data:null,error:h}:{data:null,error:new Kh("Unexpected error in challenge",h)}}}async _verify({challengeId:t,factorId:r,webauthn:n}){return this.client.mfa.verify({factorId:r,challengeId:t,webauthn:n})}async _authenticate({factorId:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:o}={}},l){if(!r)return{data:null,error:new Vv("rpId is required for WebAuthn authentication")};try{if(!m3())return{data:null,error:new Kh("Browser does not support WebAuthn",null)};const{data:h,error:f}=await this.challenge({factorId:t,webauthn:{rpId:r,rpOrigins:n},signal:o},{request:l});if(!h)return{data:null,error:f};const{webauthn:s}=h;return this._verify({factorId:t,challengeId:h.challengeId,webauthn:{type:s.type,rpId:r,rpOrigins:n,credential_response:s.credential_response}})}catch(h){return er(h)?{data:null,error:h}:{data:null,error:new Kh("Unexpected error in authenticate",h)}}}async _register({friendlyName:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:o}={}},l){if(!r)return{data:null,error:new Vv("rpId is required for WebAuthn registration")};try{if(!m3())return{data:null,error:new Kh("Browser does not support WebAuthn",null)};const{data:h,error:f}=await this._enroll({friendlyName:t});if(!h)return await this.client.mfa.listFactors().then(b=>{var w;return(w=b.data)===null||w===void 0?void 0:w.all.find(A=>A.factor_type==="webauthn"&&A.friendly_name===t&&A.status!=="unverified")}).then(b=>b?this.client.mfa.unenroll({factorId:b==null?void 0:b.id}):void 0),{data:null,error:f};const{data:s,error:y}=await this._challenge({factorId:h.id,friendlyName:h.friendly_name,webauthn:{rpId:r,rpOrigins:n},signal:o},{create:l});return s?this._verify({factorId:h.id,challengeId:s.challengeId,webauthn:{rpId:r,rpOrigins:n,type:s.webauthn.type,credential_response:s.webauthn.credential_response}}):{data:null,error:y}}catch(h){return er(h)?{data:null,error:h}:{data:null,error:new Kh("Unexpected error in register",h)}}}}qoe();const hse={url:soe,storageKey:aoe,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:loe,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1,lockAcquireTimeout:1e4};async function g3(e,t,r){return await r()}const Vf={};class Gv{get jwks(){var t,r;return(r=(t=Vf[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(t){Vf[this.storageKey]=Object.assign(Object.assign({},Vf[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,r;return(r=(t=Vf[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){Vf[this.storageKey]=Object.assign(Object.assign({},Vf[this.storageKey]),{cachedAt:t})}constructor(t){var r,n,o;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.autoRefreshTickTimeout=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const l=Object.assign(Object.assign({},hse),t);if(this.storageKey=l.storageKey,this.instanceID=(r=Gv.nextInstanceID[this.storageKey])!==null&&r!==void 0?r:0,Gv.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!l.debug,typeof l.debug=="function"&&(this.logger=l.debug),this.instanceID>0&&Ji()){const h=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(h),this.logDebugMessages&&console.trace(h)}if(this.persistSession=l.persistSession,this.autoRefreshToken=l.autoRefreshToken,this.admin=new Voe({url:l.url,headers:l.headers,fetch:l.fetch}),this.url=l.url,this.headers=l.headers,this.fetch=y8(l.fetch),this.lock=l.lock||g3,this.detectSessionInUrl=l.detectSessionInUrl,this.flowType=l.flowType,this.hasCustomAuthorizationHeader=l.hasCustomAuthorizationHeader,this.throwOnError=l.throwOnError,this.lockAcquireTimeout=l.lockAcquireTimeout,l.lock?this.lock=l.lock:this.persistSession&&Ji()&&(!((n=globalThis==null?void 0:globalThis.navigator)===null||n===void 0)&&n.locks)?this.lock=Woe:this.lock=g3,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new use(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(l.storage?this.storage=l.storage:g8()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=p3(this.memoryStorage)),l.userStorage&&(this.userStorage=l.userStorage)):(this.memoryStorage={},this.storage=p3(this.memoryStorage)),Ji()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(h){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",h)}(o=this.broadcastChannel)===null||o===void 0||o.addEventListener("message",async h=>{this._debug("received broadcast notification from other tab or client",h),await this._notifyAllSubscribers(h.data.event,h.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(t){if(this.throwOnError&&t&&t.error)throw t.error;return t}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${f8}) ${new Date().toISOString()}`}_debug(...t){return this.logDebugMessages&&this.logger(this._logPrefix(),...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(this.lockAcquireTimeout,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{let r={},n="none";if(Ji()&&(r=Soe(window.location.href),this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce")),Ji()&&this.detectSessionInUrl&&n!=="none"){const{data:o,error:l}=await this._getSessionFromURL(r,n);if(l){if(this._debug("#_initialize()","error detecting session from URL",l),poe(l)){const s=(t=l.details)===null||t===void 0?void 0:t.code;if(s==="identity_already_exists"||s==="identity_not_found"||s==="single_identity_not_deletable")return{error:l}}return{error:l}}const{session:h,redirectType:f}=o;return this._debug("#_initialize()","detected session in URL",h,"redirect type",f),await this._saveSession(h),setTimeout(async()=>{f==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",h):await this._notifyAllSubscribers("SIGNED_IN",h)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return er(r)?this._returnResult({error:r}):this._returnResult({error:new Kh("Unexpected error during initialization",r)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,n,o;try{const l=await fr(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=t==null?void 0:t.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(o=t==null?void 0:t.options)===null||o===void 0?void 0:o.captchaToken}},xform:Ca}),{data:h,error:f}=l;if(f||!h)return this._returnResult({data:{user:null,session:null},error:f});const s=h.session,y=h.user;return h.session&&(await this._saveSession(h.session),await this._notifyAllSubscribers("SIGNED_IN",s)),this._returnResult({data:{user:y,session:s},error:null})}catch(l){if(er(l))return this._returnResult({data:{user:null,session:null},error:l});throw l}}async signUp(t){var r,n,o;try{let l;if("email"in t){const{email:b,password:w,options:A}=t;let k=null,M=null;this.flowType==="pkce"&&([k,M]=await $f(this.storage,this.storageKey)),l=await fr(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:A==null?void 0:A.emailRedirectTo,body:{email:b,password:w,data:(r=A==null?void 0:A.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:A==null?void 0:A.captchaToken},code_challenge:k,code_challenge_method:M},xform:Ca})}else if("phone"in t){const{phone:b,password:w,options:A}=t;l=await fr(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:b,password:w,data:(n=A==null?void 0:A.data)!==null&&n!==void 0?n:{},channel:(o=A==null?void 0:A.channel)!==null&&o!==void 0?o:"sms",gotrue_meta_security:{captcha_token:A==null?void 0:A.captchaToken}},xform:Ca})}else throw new Fx("You must provide either an email or phone number and a password");const{data:h,error:f}=l;if(f||!h)return await Yi(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:f});const s=h.session,y=h.user;return h.session&&(await this._saveSession(h.session),await this._notifyAllSubscribers("SIGNED_IN",s)),this._returnResult({data:{user:y,session:s},error:null})}catch(l){if(await Yi(this.storage,`${this.storageKey}-code-verifier`),er(l))return this._returnResult({data:{user:null,session:null},error:l});throw l}}async signInWithPassword(t){try{let r;if("email"in t){const{email:l,password:h,options:f}=t;r=await fr(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:l,password:h,gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken}},xform:d3})}else if("phone"in t){const{phone:l,password:h,options:f}=t;r=await fr(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:l,password:h,gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken}},xform:d3})}else throw new Fx("You must provide either an email or phone number and a password");const{data:n,error:o}=r;if(o)return this._returnResult({data:{user:null,session:null},error:o});if(!n||!n.session||!n.user){const l=new Nf;return this._returnResult({data:{user:null,session:null},error:l})}return n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),this._returnResult({data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:o})}catch(r){if(er(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOAuth(t){var r,n,o,l;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=t.options)===null||n===void 0?void 0:n.scopes,queryParams:(o=t.options)===null||o===void 0?void 0:o.queryParams,skipBrowserRedirect:(l=t.options)===null||l===void 0?void 0:l.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(this.lockAcquireTimeout,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:r}=t;switch(r){case"ethereum":return await this.signInWithEthereum(t);case"solana":return await this.signInWithSolana(t);default:throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}}async signInWithEthereum(t){var r,n,o,l,h,f,s,y,b,w,A;let k,M;if("message"in t)k=t.message,M=t.signature;else{const{chain:R,wallet:j,statement:L,options:z}=t;let B;if(Ji())if(typeof j=="object")B=j;else{const pe=window;if("ethereum"in pe&&typeof pe.ethereum=="object"&&"request"in pe.ethereum&&typeof pe.ethereum.request=="function")B=pe.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof j!="object"||!(z!=null&&z.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");B=j}const Z=new URL((r=z==null?void 0:z.url)!==null&&r!==void 0?r:window.location.href),F=await B.request({method:"eth_requestAccounts"}).then(pe=>pe).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!F||F.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const H=_8(F[0]);let Y=(n=z==null?void 0:z.signInWithEthereum)===null||n===void 0?void 0:n.chainId;if(!Y){const pe=await B.request({method:"eth_chainId"});Y=Hoe(pe)}const te={domain:Z.host,address:H,statement:L,uri:Z.href,version:"1",chainId:Y,nonce:(o=z==null?void 0:z.signInWithEthereum)===null||o===void 0?void 0:o.nonce,issuedAt:(h=(l=z==null?void 0:z.signInWithEthereum)===null||l===void 0?void 0:l.issuedAt)!==null&&h!==void 0?h:new Date,expirationTime:(f=z==null?void 0:z.signInWithEthereum)===null||f===void 0?void 0:f.expirationTime,notBefore:(s=z==null?void 0:z.signInWithEthereum)===null||s===void 0?void 0:s.notBefore,requestId:(y=z==null?void 0:z.signInWithEthereum)===null||y===void 0?void 0:y.requestId,resources:(b=z==null?void 0:z.signInWithEthereum)===null||b===void 0?void 0:b.resources};k=Zoe(te),M=await B.request({method:"personal_sign",params:[Koe(k),H]})}try{const{data:R,error:j}=await fr(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:k,signature:M},!((w=t.options)===null||w===void 0)&&w.captchaToken?{gotrue_meta_security:{captcha_token:(A=t.options)===null||A===void 0?void 0:A.captchaToken}}:null),xform:Ca});if(j)throw j;if(!R||!R.session||!R.user){const L=new Nf;return this._returnResult({data:{user:null,session:null},error:L})}return R.session&&(await this._saveSession(R.session),await this._notifyAllSubscribers("SIGNED_IN",R.session)),this._returnResult({data:Object.assign({},R),error:j})}catch(R){if(er(R))return this._returnResult({data:{user:null,session:null},error:R});throw R}}async signInWithSolana(t){var r,n,o,l,h,f,s,y,b,w,A,k;let M,R;if("message"in t)M=t.message,R=t.signature;else{const{chain:j,wallet:L,statement:z,options:B}=t;let Z;if(Ji())if(typeof L=="object")Z=L;else{const H=window;if("solana"in H&&typeof H.solana=="object"&&("signIn"in H.solana&&typeof H.solana.signIn=="function"||"signMessage"in H.solana&&typeof H.solana.signMessage=="function"))Z=H.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof L!="object"||!(B!=null&&B.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");Z=L}const F=new URL((r=B==null?void 0:B.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in Z&&Z.signIn){const H=await Z.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},B==null?void 0:B.signInWithSolana),{version:"1",domain:F.host,uri:F.href}),z?{statement:z}:null));let Y;if(Array.isArray(H)&&H[0]&&typeof H[0]=="object")Y=H[0];else if(H&&typeof H=="object"&&"signedMessage"in H&&"signature"in H)Y=H;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in Y&&"signature"in Y&&(typeof Y.signedMessage=="string"||Y.signedMessage instanceof Uint8Array)&&Y.signature instanceof Uint8Array)M=typeof Y.signedMessage=="string"?Y.signedMessage:new TextDecoder().decode(Y.signedMessage),R=Y.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in Z)||typeof Z.signMessage!="function"||!("publicKey"in Z)||typeof Z!="object"||!Z.publicKey||!("toBase58"in Z.publicKey)||typeof Z.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");M=[`${F.host} wants you to sign in with your Solana account:`,Z.publicKey.toBase58(),...z?["",z,""]:[""],"Version: 1",`URI: ${F.href}`,`Issued At: ${(o=(n=B==null?void 0:B.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&o!==void 0?o:new Date().toISOString()}`,...!((l=B==null?void 0:B.signInWithSolana)===null||l===void 0)&&l.notBefore?[`Not Before: ${B.signInWithSolana.notBefore}`]:[],...!((h=B==null?void 0:B.signInWithSolana)===null||h===void 0)&&h.expirationTime?[`Expiration Time: ${B.signInWithSolana.expirationTime}`]:[],...!((f=B==null?void 0:B.signInWithSolana)===null||f===void 0)&&f.chainId?[`Chain ID: ${B.signInWithSolana.chainId}`]:[],...!((s=B==null?void 0:B.signInWithSolana)===null||s===void 0)&&s.nonce?[`Nonce: ${B.signInWithSolana.nonce}`]:[],...!((y=B==null?void 0:B.signInWithSolana)===null||y===void 0)&&y.requestId?[`Request ID: ${B.signInWithSolana.requestId}`]:[],...!((w=(b=B==null?void 0:B.signInWithSolana)===null||b===void 0?void 0:b.resources)===null||w===void 0)&&w.length?["Resources",...B.signInWithSolana.resources.map(Y=>`- ${Y}`)]:[]].join(`
`);const H=await Z.signMessage(new TextEncoder().encode(M),"utf8");if(!H||!(H instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");R=H}}try{const{data:j,error:L}=await fr(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:M,signature:td(R)},!((A=t.options)===null||A===void 0)&&A.captchaToken?{gotrue_meta_security:{captcha_token:(k=t.options)===null||k===void 0?void 0:k.captchaToken}}:null),xform:Ca});if(L)throw L;if(!j||!j.session||!j.user){const z=new Nf;return this._returnResult({data:{user:null,session:null},error:z})}return j.session&&(await this._saveSession(j.session),await this._notifyAllSubscribers("SIGNED_IN",j.session)),this._returnResult({data:Object.assign({},j),error:L})}catch(j){if(er(j))return this._returnResult({data:{user:null,session:null},error:j});throw j}}async _exchangeCodeForSession(t){const r=await zh(this.storage,`${this.storageKey}-code-verifier`),[n,o]=(r??"").split("/");try{if(!n&&this.flowType==="pkce")throw new moe;const{data:l,error:h}=await fr(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:n},xform:Ca});if(await Yi(this.storage,`${this.storageKey}-code-verifier`),h)throw h;if(!l||!l.session||!l.user){const f=new Nf;return this._returnResult({data:{user:null,session:null,redirectType:null},error:f})}return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),this._returnResult({data:Object.assign(Object.assign({},l),{redirectType:o??null}),error:h})}catch(l){if(await Yi(this.storage,`${this.storageKey}-code-verifier`),er(l))return this._returnResult({data:{user:null,session:null,redirectType:null},error:l});throw l}}async signInWithIdToken(t){try{const{options:r,provider:n,token:o,access_token:l,nonce:h}=t,f=await fr(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:o,access_token:l,nonce:h,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:Ca}),{data:s,error:y}=f;if(y)return this._returnResult({data:{user:null,session:null},error:y});if(!s||!s.session||!s.user){const b=new Nf;return this._returnResult({data:{user:null,session:null},error:b})}return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),this._returnResult({data:s,error:y})}catch(r){if(er(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOtp(t){var r,n,o,l,h;try{if("email"in t){const{email:f,options:s}=t;let y=null,b=null;this.flowType==="pkce"&&([y,b]=await $f(this.storage,this.storageKey));const{error:w}=await fr(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:f,data:(r=s==null?void 0:s.data)!==null&&r!==void 0?r:{},create_user:(n=s==null?void 0:s.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken},code_challenge:y,code_challenge_method:b},redirectTo:s==null?void 0:s.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:w})}if("phone"in t){const{phone:f,options:s}=t,{data:y,error:b}=await fr(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:f,data:(o=s==null?void 0:s.data)!==null&&o!==void 0?o:{},create_user:(l=s==null?void 0:s.shouldCreateUser)!==null&&l!==void 0?l:!0,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken},channel:(h=s==null?void 0:s.channel)!==null&&h!==void 0?h:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:y==null?void 0:y.message_id},error:b})}throw new Fx("You must provide either an email or phone number.")}catch(f){if(await Yi(this.storage,`${this.storageKey}-code-verifier`),er(f))return this._returnResult({data:{user:null,session:null},error:f});throw f}}async verifyOtp(t){var r,n;try{let o,l;"options"in t&&(o=(r=t.options)===null||r===void 0?void 0:r.redirectTo,l=(n=t.options)===null||n===void 0?void 0:n.captchaToken);const{data:h,error:f}=await fr(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:l}}),redirectTo:o,xform:Ca});if(f)throw f;if(!h)throw new Error("An error occurred on token verification.");const s=h.session,y=h.user;return s!=null&&s.access_token&&(await this._saveSession(s),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",s)),this._returnResult({data:{user:y,session:s},error:null})}catch(o){if(er(o))return this._returnResult({data:{user:null,session:null},error:o});throw o}}async signInWithSSO(t){var r,n,o,l,h;try{let f=null,s=null;this.flowType==="pkce"&&([f,s]=await $f(this.storage,this.storageKey));const y=await fr(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(n=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((o=t==null?void 0:t.options)===null||o===void 0)&&o.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:f,code_challenge_method:s}),headers:this.headers,xform:$oe});return!((l=y.data)===null||l===void 0)&&l.url&&Ji()&&!(!((h=t.options)===null||h===void 0)&&h.skipBrowserRedirect)&&window.location.assign(y.data.url),this._returnResult(y)}catch(f){if(await Yi(this.storage,`${this.storageKey}-code-verifier`),er(f))return this._returnResult({data:null,error:f});throw f}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;if(n)throw n;if(!r)throw new ys;const{error:o}=await fr(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return this._returnResult({data:{user:null,session:null},error:o})})}catch(t){if(er(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:n,type:o,options:l}=t,{error:h}=await fr(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},redirectTo:l==null?void 0:l.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:h})}else if("phone"in t){const{phone:n,type:o,options:l}=t,{data:h,error:f}=await fr(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:h==null?void 0:h.message_id},error:f})}throw new Fx("You must provide either an email or phone number and a type")}catch(r){if(er(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),o=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await o}catch{}})()),o}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const o=[...this.pendingInLock];await Promise.all(o),this.pendingInLock.splice(0,o.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await zh(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const n=t.expires_at?t.expires_at*1e3-Date.now()<fA:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",t.expires_at),!n){if(this.userStorage){const h=await zh(this.userStorage,this.storageKey+"-user");h!=null&&h.user?t.user=h.user:t.user=gA()}if(this.storage.isServer&&t.user&&!t.user.__isUserNotAvailableProxy){const h={value:this.suppressGetSessionWarning};t.user=joe(t.user,h),h.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:t},error:null}}const{data:o,error:l}=await this._callRefreshToken(t.refresh_token);return l?this._returnResult({data:{session:null},error:l}):this._returnResult({data:{session:o},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(t){if(t)return await this._getUser(t);await this.initializePromise;const r=await this._acquireLock(this.lockAcquireTimeout,async()=>await this._getUser());return r.data.user&&(this.suppressGetSessionWarning=!0),r}async _getUser(t){try{return t?await fr(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:fu}):await this._useSession(async r=>{var n,o,l;const{data:h,error:f}=r;if(f)throw f;return!(!((n=h.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new ys}:await fr(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(l=(o=h.session)===null||o===void 0?void 0:o.access_token)!==null&&l!==void 0?l:void 0,xform:fu})})}catch(r){if(er(r))return foe(r)&&(await this._removeSession(),await Yi(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:r});throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async n=>{const{data:o,error:l}=n;if(l)throw l;if(!o.session)throw new ys;const h=o.session;let f=null,s=null;this.flowType==="pkce"&&t.email!=null&&([f,s]=await $f(this.storage,this.storageKey));const{data:y,error:b}=await fr(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:f,code_challenge_method:s}),jwt:h.access_token,xform:fu});if(b)throw b;return h.user=y.user,await this._saveSession(h),await this._notifyAllSubscribers("USER_UPDATED",h),this._returnResult({data:{user:h.user},error:null})})}catch(n){if(await Yi(this.storage,`${this.storageKey}-code-verifier`),er(n))return this._returnResult({data:{user:null},error:n});throw n}}async setSession(t){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new ys;const r=Date.now()/1e3;let n=r,o=!0,l=null;const{payload:h}=mA(t.access_token);if(h.exp&&(n=h.exp,o=n<=r),o){const{data:f,error:s}=await this._callRefreshToken(t.refresh_token);if(s)return this._returnResult({data:{user:null,session:null},error:s});if(!f)return{data:{user:null,session:null},error:null};l=f}else{const{data:f,error:s}=await this._getUser(t.access_token);if(s)throw s;l={access_token:t.access_token,refresh_token:t.refresh_token,user:f.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(l),await this._notifyAllSubscribers("SIGNED_IN",l)}return this._returnResult({data:{user:l.user,session:l},error:null})}catch(r){if(er(r))return this._returnResult({data:{session:null,user:null},error:r});throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var n;if(!t){const{data:h,error:f}=r;if(f)throw f;t=(n=h.session)!==null&&n!==void 0?n:void 0}if(!(t!=null&&t.refresh_token))throw new ys;const{data:o,error:l}=await this._callRefreshToken(t.refresh_token);return l?this._returnResult({data:{user:null,session:null},error:l}):o?this._returnResult({data:{user:o.user,session:o},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(r){if(er(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async _getSessionFromURL(t,r){try{if(!Ji())throw new Ux("No browser detected.");if(t.error||t.error_description||t.error_code)throw new Ux(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new o3("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Ux("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new o3("No code detected.");const{data:z,error:B}=await this._exchangeCodeForSession(t.code);if(B)throw B;const Z=new URL(window.location.href);return Z.searchParams.delete("code"),window.history.replaceState(window.history.state,"",Z.toString()),{data:{session:z.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:o,access_token:l,refresh_token:h,expires_in:f,expires_at:s,token_type:y}=t;if(!l||!f||!h||!y)throw new Ux("No session defined in URL");const b=Math.round(Date.now()/1e3),w=parseInt(f);let A=b+w;s&&(A=parseInt(s));const k=A-b;k*1e3<=Xf&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${k}s, should have been closer to ${w}s`);const M=A-w;b-M>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",M,A,b):b-M<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",M,A,b);const{data:R,error:j}=await this._getUser(l);if(j)throw j;const L={provider_token:n,provider_refresh_token:o,access_token:l,expires_in:w,expires_at:A,refresh_token:h,token_type:y,user:R.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:L,redirectType:t.type},error:null})}catch(n){if(er(n))return this._returnResult({data:{session:null,redirectType:null},error:n});throw n}}_isImplicitGrantCallback(t){return typeof this.detectSessionInUrl=="function"?this.detectSessionInUrl(new URL(window.location.href),t):!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await zh(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:o,error:l}=r;if(l)return this._returnResult({error:l});const h=(n=o.session)===null||n===void 0?void 0:n.access_token;if(h){const{error:f}=await this.admin.signOut(h,t);if(f&&!(doe(f)&&(f.status===404||f.status===401||f.status===403)))return this._returnResult({error:f})}return t!=="others"&&(await this._removeSession(),await Yi(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(t){const r=woe(),n={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(t){return await this._useSession(async r=>{var n,o;try{const{data:{session:l},error:h}=r;if(h)throw h;await((n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",l)),this._debug("INITIAL_SESSION","callback id",t,"session",l)}catch(l){await((o=this.stateChangeEmitters.get(t))===null||o===void 0?void 0:o.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",l),console.error(l)}})}async resetPasswordForEmail(t,r={}){let n=null,o=null;this.flowType==="pkce"&&([n,o]=await $f(this.storage,this.storageKey,!0));try{return await fr(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:n,code_challenge_method:o,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(l){if(await Yi(this.storage,`${this.storageKey}-code-verifier`),er(l))return this._returnResult({data:null,error:l});throw l}}async getUserIdentities(){var t;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return this._returnResult({data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null})}catch(r){if(er(r))return this._returnResult({data:null,error:r});throw r}}async linkIdentity(t){return"token"in t?this.linkIdentityIdToken(t):this.linkIdentityOAuth(t)}async linkIdentityOAuth(t){var r;try{const{data:n,error:o}=await this._useSession(async l=>{var h,f,s,y,b;const{data:w,error:A}=l;if(A)throw A;const k=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(h=t.options)===null||h===void 0?void 0:h.redirectTo,scopes:(f=t.options)===null||f===void 0?void 0:f.scopes,queryParams:(s=t.options)===null||s===void 0?void 0:s.queryParams,skipBrowserRedirect:!0});return await fr(this.fetch,"GET",k,{headers:this.headers,jwt:(b=(y=w.session)===null||y===void 0?void 0:y.access_token)!==null&&b!==void 0?b:void 0})});if(o)throw o;return Ji()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),this._returnResult({data:{provider:t.provider,url:n==null?void 0:n.url},error:null})}catch(n){if(er(n))return this._returnResult({data:{provider:t.provider,url:null},error:n});throw n}}async linkIdentityIdToken(t){return await this._useSession(async r=>{var n;try{const{error:o,data:{session:l}}=r;if(o)throw o;const{options:h,provider:f,token:s,access_token:y,nonce:b}=t,w=await fr(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(n=l==null?void 0:l.access_token)!==null&&n!==void 0?n:void 0,body:{provider:f,id_token:s,access_token:y,nonce:b,link_identity:!0,gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken}},xform:Ca}),{data:A,error:k}=w;return k?this._returnResult({data:{user:null,session:null},error:k}):!A||!A.session||!A.user?this._returnResult({data:{user:null,session:null},error:new Nf}):(A.session&&(await this._saveSession(A.session),await this._notifyAllSubscribers("USER_UPDATED",A.session)),this._returnResult({data:A,error:k}))}catch(o){if(await Yi(this.storage,`${this.storageKey}-code-verifier`),er(o))return this._returnResult({data:{user:null,session:null},error:o});throw o}})}async unlinkIdentity(t){try{return await this._useSession(async r=>{var n,o;const{data:l,error:h}=r;if(h)throw h;return await fr(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(o=(n=l.session)===null||n===void 0?void 0:n.access_token)!==null&&o!==void 0?o:void 0})})}catch(r){if(er(r))return this._returnResult({data:null,error:r});throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await Aoe(async o=>(o>0&&await Eoe(200*Math.pow(2,o-1)),this._debug(r,"refreshing attempt",o),await fr(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:Ca})),(o,l)=>{const h=200*Math.pow(2,o);return l&&pA(l)&&Date.now()+h-n<Xf})}catch(n){if(this._debug(r,"error",n),er(n))return this._returnResult({data:{session:null,user:null},error:n});throw n}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",n),Ji()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:t,url:n},error:null}}async _recoverAndRefresh(){var t,r;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const o=await zh(this.storage,this.storageKey);if(o&&this.userStorage){let h=await zh(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!h&&(h={user:o.user},await Yf(this.userStorage,this.storageKey+"-user",h)),o.user=(t=h==null?void 0:h.user)!==null&&t!==void 0?t:gA()}else if(o&&!o.user&&!o.user){const h=await zh(this.storage,this.storageKey+"-user");h&&(h!=null&&h.user)?(o.user=h.user,await Yi(this.storage,this.storageKey+"-user"),await Yf(this.storage,this.storageKey,o)):o.user=gA()}if(this._debug(n,"session from storage",o),!this._isValidSession(o)){this._debug(n,"session is not valid"),o!==null&&await this._removeSession();return}const l=((r=o.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<fA;if(this._debug(n,`session has${l?"":" not"} expired with margin of ${fA}s`),l){if(this.autoRefreshToken&&o.refresh_token){const{error:h}=await this._callRefreshToken(o.refresh_token);h&&(console.error(h),pA(h)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",h),await this._removeSession()))}}else if(o.user&&o.user.__isUserNotAvailableProxy===!0)try{const{data:h,error:f}=await this._getUser(o.access_token);!f&&(h!=null&&h.user)?(o.user=h.user,await this._saveSession(o),await this._notifyAllSubscribers("SIGNED_IN",o)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(h){console.error("Error getting user data:",h),this._debug(n,"error getting user data, skipping SIGNED_IN notification",h)}else await this._notifyAllSubscribers("SIGNED_IN",o)}catch(o){this._debug(n,"error",o),console.error(o);return}finally{this._debug(n,"end")}}async _callRefreshToken(t){var r,n;if(!t)throw new ys;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const o=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(o,"begin");try{this.refreshingDeferred=new W1;const{data:l,error:h}=await this._refreshAccessToken(t);if(h)throw h;if(!l.session)throw new ys;await this._saveSession(l.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",l.session);const f={data:l.session,error:null};return this.refreshingDeferred.resolve(f),f}catch(l){if(this._debug(o,"error",l),er(l)){const h={data:null,error:l};return pA(l)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(h),h}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(l),l}finally{this.refreshingDeferred=null,this._debug(o,"end")}}async _notifyAllSubscribers(t,r,n=!0){const o=`#_notifyAllSubscribers(${t})`;this._debug(o,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:t,session:r});const l=[],h=Array.from(this.stateChangeEmitters.values()).map(async f=>{try{await f.callback(t,r)}catch(s){l.push(s)}});if(await Promise.all(h),l.length>0){for(let f=0;f<l.length;f+=1)console.error(l[f]);throw l[0]}}finally{this._debug(o,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0,await Yi(this.storage,`${this.storageKey}-code-verifier`);const r=Object.assign({},t),n=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&r.user&&await Yf(this.userStorage,this.storageKey+"-user",{user:r.user});const o=Object.assign({},r);delete o.user;const l=u3(o);await Yf(this.storage,this.storageKey,l)}else{const o=u3(r);await Yf(this.storage,this.storageKey,o)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await Yi(this.storage,this.storageKey),await Yi(this.storage,this.storageKey+"-code-verifier"),await Yi(this.storage,this.storageKey+"-user"),this.userStorage&&await Yi(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&Ji()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),Xf);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t);const r=setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0);this.autoRefreshTickTimeout=r,r&&typeof r=="object"&&typeof r.unref=="function"?r.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(r)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t);const r=this.autoRefreshTickTimeout;this.autoRefreshTickTimeout=null,r&&clearTimeout(r)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const o=Math.floor((n.expires_at*1e3-t)/Xf);this._debug("#_autoRefreshTokenTick()",`access token expires in ${o} ticks, a tick lasts ${Xf}ms, refresh threshold is ${OC} ticks`),o<=OC&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof v8)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Ji()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,n){const o=[`provider=${encodeURIComponent(r)}`];if(n!=null&&n.redirectTo&&o.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&o.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[l,h]=await $f(this.storage,this.storageKey),f=new URLSearchParams({code_challenge:`${encodeURIComponent(l)}`,code_challenge_method:`${encodeURIComponent(h)}`});o.push(f.toString())}if(n!=null&&n.queryParams){const l=new URLSearchParams(n.queryParams);o.push(l.toString())}return n!=null&&n.skipBrowserRedirect&&o.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${t}?${o.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var n;const{data:o,error:l}=r;return l?this._returnResult({data:null,error:l}):await fr(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(n=o==null?void 0:o.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(er(r))return this._returnResult({data:null,error:r});throw r}}async _enroll(t){try{return await this._useSession(async r=>{var n,o;const{data:l,error:h}=r;if(h)return this._returnResult({data:null,error:h});const f=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:t.factorType==="totp"?{issuer:t.issuer}:{}),{data:s,error:y}=await fr(this.fetch,"POST",`${this.url}/factors`,{body:f,headers:this.headers,jwt:(n=l==null?void 0:l.session)===null||n===void 0?void 0:n.access_token});return y?this._returnResult({data:null,error:y}):(t.factorType==="totp"&&s.type==="totp"&&(!((o=s==null?void 0:s.totp)===null||o===void 0)&&o.qr_code)&&(s.totp.qr_code=`data:image/svg+xml;utf-8,${s.totp.qr_code}`),this._returnResult({data:s,error:null}))})}catch(r){if(er(r))return this._returnResult({data:null,error:r});throw r}}async _verify(t){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async r=>{var n;const{data:o,error:l}=r;if(l)return this._returnResult({data:null,error:l});const h=Object.assign({challenge_id:t.challengeId},"webauthn"in t?{webauthn:Object.assign(Object.assign({},t.webauthn),{credential_response:t.webauthn.type==="create"?rse(t.webauthn.credential_response):nse(t.webauthn.credential_response)})}:{code:t.code}),{data:f,error:s}=await fr(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:h,headers:this.headers,jwt:(n=o==null?void 0:o.session)===null||n===void 0?void 0:n.access_token});return s?this._returnResult({data:null,error:s}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+f.expires_in},f)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",f),this._returnResult({data:f,error:s}))})}catch(r){if(er(r))return this._returnResult({data:null,error:r});throw r}})}async _challenge(t){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async r=>{var n;const{data:o,error:l}=r;if(l)return this._returnResult({data:null,error:l});const h=await fr(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:t,headers:this.headers,jwt:(n=o==null?void 0:o.session)===null||n===void 0?void 0:n.access_token});if(h.error)return h;const{data:f}=h;if(f.type!=="webauthn")return{data:f,error:null};switch(f.webauthn.type){case"create":return{data:Object.assign(Object.assign({},f),{webauthn:Object.assign(Object.assign({},f.webauthn),{credential_options:Object.assign(Object.assign({},f.webauthn.credential_options),{publicKey:ese(f.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},f),{webauthn:Object.assign(Object.assign({},f.webauthn),{credential_options:Object.assign(Object.assign({},f.webauthn.credential_options),{publicKey:tse(f.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(r){if(er(r))return this._returnResult({data:null,error:r});throw r}})}async _challengeAndVerify(t){const{data:r,error:n}=await this._challenge({factorId:t.factorId});return n?this._returnResult({data:null,error:n}):await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){var t;const{data:{user:r},error:n}=await this.getUser();if(n)return{data:null,error:n};const o={all:[],phone:[],totp:[],webauthn:[]};for(const l of(t=r==null?void 0:r.factors)!==null&&t!==void 0?t:[])o.all.push(l),l.status==="verified"&&o[l.factor_type].push(l);return{data:o,error:null}}async _getAuthenticatorAssuranceLevel(){var t,r;const{data:{session:n},error:o}=await this.getSession();if(o)return this._returnResult({data:null,error:o});if(!n)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:l}=mA(n.access_token);let h=null;l.aal&&(h=l.aal);let f=h;((r=(t=n.user.factors)===null||t===void 0?void 0:t.filter(b=>b.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(f="aal2");const y=l.amr||[];return{data:{currentLevel:h,nextLevel:f,currentAuthenticationMethods:y},error:null}}async _getAuthorizationDetails(t){try{return await this._useSession(async r=>{const{data:{session:n},error:o}=r;return o?this._returnResult({data:null,error:o}):n?await fr(this.fetch,"GET",`${this.url}/oauth/authorizations/${t}`,{headers:this.headers,jwt:n.access_token,xform:l=>({data:l,error:null})}):this._returnResult({data:null,error:new ys})})}catch(r){if(er(r))return this._returnResult({data:null,error:r});throw r}}async _approveAuthorization(t,r){try{return await this._useSession(async n=>{const{data:{session:o},error:l}=n;if(l)return this._returnResult({data:null,error:l});if(!o)return this._returnResult({data:null,error:new ys});const h=await fr(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:o.access_token,body:{action:"approve"},xform:f=>({data:f,error:null})});return h.data&&h.data.redirect_url&&Ji()&&!(r!=null&&r.skipBrowserRedirect)&&window.location.assign(h.data.redirect_url),h})}catch(n){if(er(n))return this._returnResult({data:null,error:n});throw n}}async _denyAuthorization(t,r){try{return await this._useSession(async n=>{const{data:{session:o},error:l}=n;if(l)return this._returnResult({data:null,error:l});if(!o)return this._returnResult({data:null,error:new ys});const h=await fr(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:o.access_token,body:{action:"deny"},xform:f=>({data:f,error:null})});return h.data&&h.data.redirect_url&&Ji()&&!(r!=null&&r.skipBrowserRedirect)&&window.location.assign(h.data.redirect_url),h})}catch(n){if(er(n))return this._returnResult({data:null,error:n});throw n}}async _listOAuthGrants(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;return n?this._returnResult({data:null,error:n}):r?await fr(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:r.access_token,xform:o=>({data:o,error:null})}):this._returnResult({data:null,error:new ys})})}catch(t){if(er(t))return this._returnResult({data:null,error:t});throw t}}async _revokeOAuthGrant(t){try{return await this._useSession(async r=>{const{data:{session:n},error:o}=r;return o?this._returnResult({data:null,error:o}):n?(await fr(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:n.access_token,query:{client_id:t.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new ys})})}catch(r){if(er(r))return this._returnResult({data:null,error:r});throw r}}async fetchJwk(t,r={keys:[]}){let n=r.keys.find(f=>f.kid===t);if(n)return n;const o=Date.now();if(n=this.jwks.keys.find(f=>f.kid===t),n&&this.jwks_cached_at+uoe>o)return n;const{data:l,error:h}=await fr(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(h)throw h;return!l.keys||l.keys.length===0||(this.jwks=l,this.jwks_cached_at=o,n=l.keys.find(f=>f.kid===t),!n)?null:n}async getClaims(t,r={}){try{let n=t;if(!n){const{data:k,error:M}=await this.getSession();if(M||!k.session)return this._returnResult({data:null,error:M});n=k.session.access_token}const{header:o,payload:l,signature:h,raw:{header:f,payload:s}}=mA(n);r!=null&&r.allowExpired||Roe(l.exp);const y=!o.alg||o.alg.startsWith("HS")||!o.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(o.kid,r!=null&&r.keys?{keys:r.keys}:r==null?void 0:r.jwks);if(!y){const{error:k}=await this.getUser(n);if(k)throw k;return{data:{claims:l,header:o,signature:h},error:null}}const b=Doe(o.alg),w=await crypto.subtle.importKey("jwk",y,b,!0,["verify"]);if(!await crypto.subtle.verify(b,w,h,xoe(`${f}.${s}`)))throw new RC("Invalid JWT signature");return{data:{claims:l,header:o,signature:h},error:null}}catch(n){if(er(n))return this._returnResult({data:null,error:n});throw n}}}Gv.nextInstanceID={};const dse=Gv,fse="2.90.1";let Gy="";typeof Deno<"u"?Gy="deno":typeof document<"u"?Gy="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Gy="react-native":Gy="node";const pse={"X-Client-Info":`supabase-js-${Gy}/${fse}`},mse={headers:pse},gse={schema:"public"},yse={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},vse={};function Wv(e){"@babel/helpers - typeof";return Wv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wv(e)}function _se(e,t){if(Wv(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Wv(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function xse(e){var t=_se(e,"string");return Wv(t)=="symbol"?t:t+""}function bse(e,t,r){return(t=xse(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function y3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function ni(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?y3(Object(r),!0).forEach(function(n){bse(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):y3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}const wse=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),Sse=()=>Headers,Tse=(e,t,r)=>{const n=wse(r),o=Sse();return async(l,h)=>{var f;const s=(f=await t())!==null&&f!==void 0?f:e;let y=new o(h==null?void 0:h.headers);return y.has("apikey")||y.set("apikey",e),y.has("Authorization")||y.set("Authorization",`Bearer ${s}`),n(l,ni(ni({},h),{},{headers:y}))}};function Ese(e){return e.endsWith("/")?e:e+"/"}function Ase(e,t){var r,n;const{db:o,auth:l,realtime:h,global:f}=e,{db:s,auth:y,realtime:b,global:w}=t,A={db:ni(ni({},s),o),auth:ni(ni({},y),l),realtime:ni(ni({},b),h),storage:{},global:ni(ni(ni({},w),f),{},{headers:ni(ni({},(r=w==null?void 0:w.headers)!==null&&r!==void 0?r:{}),(n=f==null?void 0:f.headers)!==null&&n!==void 0?n:{})}),accessToken:async()=>""};return e.accessToken?A.accessToken=e.accessToken:delete A.accessToken,A}function Pse(e){const t=e==null?void 0:e.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(Ese(t))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}var Cse=class extends dse{constructor(e){super(e)}},kse=class{constructor(e,t,r){var n,o;this.supabaseUrl=e,this.supabaseKey=t;const l=Pse(e);if(!t)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",l),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",l),this.storageUrl=new URL("storage/v1",l),this.functionsUrl=new URL("functions/v1",l);const h=`sb-${l.hostname.split(".")[0]}-auth-token`,f={db:gse,realtime:vse,auth:ni(ni({},yse),{},{storageKey:h}),global:mse},s=Ase(r??{},f);if(this.storageKey=(n=s.auth.storageKey)!==null&&n!==void 0?n:"",this.headers=(o=s.global.headers)!==null&&o!==void 0?o:{},s.accessToken)this.accessToken=s.accessToken,this.auth=new Proxy({},{get:(b,w)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(w)} is not possible`)}});else{var y;this.auth=this._initSupabaseAuthClient((y=s.auth)!==null&&y!==void 0?y:{},this.headers,s.global.fetch)}this.fetch=Tse(t,this._getAccessToken.bind(this),s.global.fetch),this.realtime=this._initRealtimeClient(ni({headers:this.headers,accessToken:this._getAccessToken.bind(this)},s.realtime)),this.accessToken&&this.accessToken().then(b=>this.realtime.setAuth(b)).catch(b=>console.warn("Failed to set initial Realtime auth token:",b)),this.rest=new lie(new URL("rest/v1",l).href,{headers:this.headers,schema:s.db.schema,fetch:this.fetch}),this.storage=new ooe(this.storageUrl.href,this.headers,this.fetch,r==null?void 0:r.storage),s.accessToken||this._listenForAuthEvents()}get functions(){return new nie(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},r={head:!1,get:!1,count:void 0}){return this.rest.rpc(e,t,r)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var e=this,t,r;if(e.accessToken)return await e.accessToken();const{data:n}=await e.auth.getSession();return(t=(r=n.session)===null||r===void 0?void 0:r.access_token)!==null&&t!==void 0?t:e.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:n,userStorage:o,storageKey:l,flowType:h,lock:f,debug:s,throwOnError:y},b,w){const A={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Cse({url:this.authUrl.href,headers:ni(ni({},A),b),storageKey:l,autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:n,userStorage:o,flowType:h,lock:f,debug:s,throwOnError:y,fetch:w,hasCustomAuthorizationHeader:Object.keys(this.headers).some(k=>k.toLowerCase()==="authorization")})}_initRealtimeClient(e){return new Eie(this.realtimeUrl.href,ni(ni({},e),{},{params:ni(ni({},{apikey:this.supabaseKey}),e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((e,t)=>{this._handleTokenChanged(e,"CLIENT",t==null?void 0:t.access_token)})}_handleTokenChanged(e,t,r){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==r?(this.changedAccessToken=r,this.realtime.setAuth(r)):e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}};const Ose=(e,t,r)=>new kse(e,t,r);function Mse(){if(typeof window<"u")return!1;const e=globalThis.process;if(!e)return!1;const t=e.version;if(t==null)return!1;const r=t.match(/^v(\d+)\./);return r?parseInt(r[1],10)<=18:!1}Mse()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const Ise="https://uszrynkltqxddwiytbnp.supabase.co",Rse="sb_publishable_qJZ4qrX1UyNZrI_lT5Pv9g_7isoMvd4",kp=Ose(Ise,Rse);function Dse(){const[e,t]=re.useState(""),[r,n]=re.useState(""),[o,l]=re.useState(""),[h,f]=re.useState("student"),[s,y]=re.useState(""),[b,w]=re.useState(!1),[A,k]=re.useState(!1),M=async R=>{var j,L;if(R.preventDefault(),y(""),k(!1),r!==o){y("Passwords do not match");return}if(r.length<8){y("Password must be at least 8 characters");return}w(!0);try{const{data:z,error:B}=await kp.auth.signUp({email:e,password:r,options:{emailRedirectTo:"http://localhost:3000/verify-complete",data:{role:h}}});if(B){B.message.includes("fetch")?y("Unable to connect to Supabase. Please check your VITE_SUPABASE_URL in frontend/.env file."):y(B.message||"Registration failed");return}if(z.user){k(!0);try{await up.createLocalUser({email:e,password:r,role:h})}catch(Z){console.warn("Failed to create local user (non-blocking):",Z)}}}catch(z){(j=z.message)!=null&&j.includes("fetch")||(L=z.message)!=null&&L.includes("Failed to fetch")?y("Network error: Unable to connect to Supabase. Please check your internet connection and Supabase configuration."):y(z.message||"Registration failed. Please check your Supabase configuration.")}finally{w(!1)}};return W.jsxs("div",{className:"min-h-screen flex",children:[W.jsxs("div",{className:"w-full lg:w-[55%] flex items-center justify-center p-8 relative",children:[W.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-background via-background to-aurora-cyan/5"}),W.jsxs(n8,{className:"w-full max-w-md p-8 relative z-10",children:[W.jsxs("div",{className:"text-center mb-8",children:[W.jsx(lw,{size:"md",showText:!0,glowing:!1}),W.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"Create your account"})]}),W.jsxs("form",{onSubmit:M,className:"space-y-4",children:[s&&W.jsx("div",{className:"bg-destructive/20 border border-destructive/40 text-destructive-foreground px-4 py-3 rounded",children:s}),A&&W.jsx("div",{className:"bg-safe/20 border border-safe/40 text-foreground px-4 py-3 rounded",children:"Verification email sent. Please check your inbox."}),W.jsx(Pp,{label:"Email Address",type:"email",placeholder:"Enter your email",value:e,onChange:R=>t(R.target.value),required:!0}),W.jsxs("div",{children:[W.jsx("label",{htmlFor:"role",className:"block text-sm font-medium text-muted-foreground mb-2",children:"Role"}),W.jsxs("select",{id:"role",value:h,onChange:R=>f(R.target.value),className:"w-full px-4 py-3 rounded-lg border border-border bg-card/50 text-foreground backdrop-blur-sm focus:outline-none focus:border-primary/50",children:[W.jsx("option",{value:"student",children:"Student"}),W.jsx("option",{value:"security",children:"Security"})]})]}),W.jsx(Pp,{label:"Password",type:"password",placeholder:"Enter your password",value:r,onChange:R=>n(R.target.value),required:!0,minLength:8}),W.jsx(Pp,{label:"Confirm Password",type:"password",placeholder:"Confirm your password",value:o,onChange:R=>l(R.target.value),required:!0,minLength:8}),W.jsx(QM,{type:"submit",className:"w-full mt-2",size:"lg",loading:b,children:b?"Registering...":"Register"})]}),W.jsx("div",{className:"mt-6 text-center",children:W.jsxs("p",{className:"text-muted-foreground text-sm",children:["Already have an account?"," ",W.jsx(Qs,{to:"/login",className:"text-aurora-cyan hover:opacity-80 transition-opacity",children:"Log In"})]})})]})]}),W.jsx(Do.div,{className:"hidden lg:flex flex-1 relative overflow-hidden items-center justify-center",initial:{opacity:0},animate:{opacity:1},transition:{duration:.8,delay:.2},children:W.jsx(X6,{interactive:!1})})]})}function Lse(){var M;const[e,t]=re.useState(""),[r,n]=re.useState(""),[o,l]=re.useState(""),[h,f]=re.useState(!1),[s,y]=re.useState(!1),b=Fu(),A=((M=kd().state)==null?void 0:M.email)||"";re.useEffect(()=>{},[]);const k=async R=>{var j,L;if(R.preventDefault(),l(""),!e){l("User ID is required. Please check your registration confirmation.");return}if(r.length!==6){l("OTP must be 6 digits");return}y(!0);try{await up.verifyOTP(e,r),f(!0),setTimeout(()=>{b("/login")},2e3)}catch(z){l(((L=(j=z.response)==null?void 0:j.data)==null?void 0:L.error)||"Invalid or expired OTP")}finally{y(!1)}};return h?W.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-slate-900 to-slate-800 px-4",children:W.jsxs("div",{className:"max-w-md w-full bg-slate-800 rounded-lg shadow-xl p-8 text-center",children:[W.jsx("div",{className:"text-6xl mb-4",children:""}),W.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:"Email Verified!"}),W.jsx("p",{className:"text-slate-400",children:"Redirecting to login..."})]})}):W.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-slate-900 to-slate-800 px-4",children:W.jsxs("div",{className:"max-w-md w-full bg-slate-800 rounded-lg shadow-xl p-8",children:[W.jsxs("div",{className:"text-center mb-8",children:[W.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"Verify Email"}),W.jsx("p",{className:"text-slate-400",children:A?`Check ${A} for your OTP code`:"Enter your verification code"})]}),W.jsxs("form",{onSubmit:k,className:"space-y-6",children:[o&&W.jsx("div",{className:"bg-red-500/20 border border-red-500 text-red-200 px-4 py-3 rounded",children:o}),W.jsxs("div",{children:[W.jsx("label",{htmlFor:"userId",className:"block text-sm font-medium text-slate-300 mb-2",children:"User ID (from registration email)"}),W.jsx("input",{id:"userId",type:"text",value:e,onChange:R=>t(R.target.value),required:!0,className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"Enter user ID"})]}),W.jsxs("div",{children:[W.jsx("label",{htmlFor:"otp",className:"block text-sm font-medium text-slate-300 mb-2",children:"OTP Code"}),W.jsx("input",{id:"otp",type:"text",value:r,onChange:R=>n(R.target.value.replace(/\D/g,"").slice(0,6)),required:!0,maxLength:6,className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white text-center text-2xl tracking-widest focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"000000"})]}),W.jsx("button",{type:"submit",disabled:s,className:"w-full bg-primary-600 hover:bg-primary-700 text-white font-semibold py-2 px-4 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:s?"Verifying...":"Verify"})]}),W.jsx("div",{className:"mt-6 text-center",children:W.jsx(Qs,{to:"/login",className:"text-primary-400 hover:text-primary-300 text-sm",children:"Back to Login"})})]})})}function jse(){const[e,t]=re.useState("verifying"),[r,n]=re.useState(""),o=kd();return re.useEffect(()=>{(async()=>{var h;try{const f=new URLSearchParams(o.hash.substring(1)),s=f.get("access_token"),y=f.get("type"),b=new URLSearchParams(o.search),w=b.get("token"),A=b.get("type");if(s&&y==="email"){const{data:{session:k},error:M}=await kp.auth.setSession({access_token:s,refresh_token:f.get("refresh_token")||""});if(M)throw M;if(k!=null&&k.user)t("verified");else throw new Error("Failed to establish session")}else if(w&&A==="email"){const{error:k}=await kp.auth.verifyOtp({token_hash:w,type:"email"});if(k)throw k;t("verified")}else{const{data:{session:k}}=await kp.auth.getSession();(h=k==null?void 0:k.user)!=null&&h.email_confirmed_at||k!=null&&k.user?t("verified"):(n("Verification link is invalid or expired. Please request a new verification email."),t("error"))}}catch(f){console.error("Verification error:",f),n(f.message||"Verification failed. Please try again or request a new verification email."),t("error")}})()},[o]),e==="verifying"?W.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-slate-900 to-slate-800 px-4",children:W.jsx("div",{className:"max-w-md w-full bg-slate-800 rounded-lg shadow-xl p-8",children:W.jsxs("div",{className:"text-center mb-8",children:[W.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-500 mx-auto mb-4"}),W.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"Verifying Email"}),W.jsx("p",{className:"text-slate-400",children:"Please wait while we verify your email..."})]})})}):e==="error"?W.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-slate-900 to-slate-800 px-4",children:W.jsxs("div",{className:"max-w-md w-full bg-slate-800 rounded-lg shadow-xl p-8",children:[W.jsxs("div",{className:"text-center mb-8",children:[W.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"Verification Failed"}),W.jsx("p",{className:"text-red-400 mb-4",children:r})]}),W.jsx("div",{className:"mt-6 text-center space-y-4",children:W.jsx(Qs,{to:"/register",className:"inline-block bg-primary-600 hover:bg-primary-700 text-white font-semibold py-2 px-6 rounded-lg transition-colors",children:"Back to Register"})})]})}):W.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-slate-900 to-slate-800 px-4",children:W.jsxs("div",{className:"max-w-md w-full bg-slate-800 rounded-lg shadow-xl p-8",children:[W.jsxs("div",{className:"text-center mb-8",children:[W.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"Email Verified"}),W.jsx("p",{className:"text-slate-400",children:"Hurray! Your email has been verified. You may now log in."})]}),W.jsx("div",{className:"mt-6 text-center",children:W.jsx(Qs,{to:"/login",className:"inline-block bg-primary-600 hover:bg-primary-700 text-white font-semibold py-2 px-6 rounded-lg transition-colors",children:"Go to Login"})})]})})}const v3="presentationModeEnabled",zse=UU(e=>({enabled:!1,isLoading:!1,fetchStatus:async()=>{try{const t=localStorage.getItem(v3);e({enabled:t==="true"})}catch(t){console.error("Failed to fetch presentation mode status:",t)}},toggle:async(t,r)=>{var n,o;e({isLoading:!0});try{localStorage.setItem(v3,t?"true":"false"),e({enabled:t,isLoading:!1})}catch(l){throw e({isLoading:!1}),new Error(((o=(n=l.response)==null?void 0:n.data)==null?void 0:o.error)||"Failed to toggle presentation mode")}}})),Yo={async createSOS(e){return(await Gi.post("/sos",e)).data},async getRecentSOSChat(){return(await Gi.get("/sos/recent/chat")).data},async getSOSEvents(e){const t=new URLSearchParams;return e!=null&&e.status&&t.append("status",e.status),e!=null&&e.limit&&t.append("limit",e.limit.toString()),e!=null&&e.offset&&t.append("offset",e.offset.toString()),(await Gi.get(`/sos?${t.toString()}`)).data},async getSOSById(e){return(await Gi.get(`/sos/${e}`)).data},async getSOSChatById(e){return(await Gi.get(`/sos/${e}/chat`)).data},async sendSOSChatMessage(e,t){return(await Gi.post(`/sos/${e}/chat/messages`,{message:t})).data},async updateStatus(e,t){return(await Gi.patch(`/sos/${e}/status`,{status:t})).data},async clearHistory(){return(await Gi.delete("/sos/history")).data},async getSOSEventHistory(e){return(await Gi.get(`/sos/${e}/events`)).data}};let _3=0;function Bse(e){const{rms:t,pitchVariance:r,spikeCount:n}=e,l=(t*.5+r*.3+Math.min(n/5,1)*.2)*35;return Math.min(l,35)}function Nse(e){const{accelerationMagnitude:t,jitter:r}=e,o=Math.min(t/30*.6+r/20*.4,1)*25;return Math.min(o,25)}function $se(e){const r=new Date().getHours();let n;return r>=6&&r<20?n=.2:r>=20&&r<24?n=.6:r>=0&&r<4?n=1:n=.4,n*20}function Fse(e){let t=10;return e!=null&&e.matchedZone?e.matchedZone.type==="high"?t=20:t=12:e!=null&&e.isNormalZone&&(t=10),(e==null?void 0:e.presentationMode)===!0?20:t}function DC(e,t,r,n){const o=Bse({rms:e.rms,pitchVariance:e.pitchVariance,spikeCount:e.spikeCount}),l=Nse({accelerationMagnitude:t.accelerationMagnitude,jitter:t.jitter}),h=$se(),f=Fse(r),s=o+l+h+f;let y;return s<25?y="low":s<50?y="medium":y="high",{audio:{stress:e.stress,score:o},motion:{intensity:t.intensity,score:l},time:{riskFactor:(()=>{const b=new Date().getHours();return b>=6&&b<20?.2:b>=20&&b<24?.6:b>=0&&b<4?1:.4})(),score:h},location:{riskFactor:1,score:f},total:s,level:y}}function Use(e,t){if(e<=50)return!1;const n=Date.now();return n-_3<1e4?!1:(_3=n,!0)}class b8{constructor(){gs(this,"audioContext",null);gs(this,"analyser",null);gs(this,"microphone",null);gs(this,"stream",null);gs(this,"isActive",!1);gs(this,"pitchBuffer",[]);gs(this,"spikeThreshold",.7);gs(this,"spikeCount",0);gs(this,"presentationMode",!1)}async initialize(){try{this.stream=await navigator.mediaDevices.getUserMedia({audio:!0}),this.audioContext=new(window.AudioContext||window.webkitAudioContext),this.analyser=this.audioContext.createAnalyser(),this.analyser.fftSize=2048,this.analyser.smoothingTimeConstant=.8,this.microphone=this.audioContext.createMediaStreamSource(this.stream),this.microphone.connect(this.analyser),this.isActive=!0}catch(t){throw console.error("Failed to initialize audio sensor:",t),t}}setPresentationMode(t){this.presentationMode=t,this.spikeThreshold=t?.35:.7}getAudioData(){if(!this.analyser||!this.isActive)return{rms:0,pitch:0,pitchVariance:0,spikeCount:0,stress:0};const t=this.analyser.frequencyBinCount,r=new Uint8Array(t);this.analyser.getByteFrequencyData(r);let n=0;for(let w=0;w<t;w++){const A=r[w]/255;n+=A*A}const o=Math.sqrt(n/t),l=this.presentationMode?Math.min(o*2,1):o;l>this.spikeThreshold?this.spikeCount++:this.spikeCount=Math.max(0,this.spikeCount-1);let h=0,f=0;for(let w=0;w<t;w++)r[w]>f&&(f=r[w],h=w);const s=h*this.audioContext.sampleRate/(2*t);this.pitchBuffer.push(s),this.pitchBuffer.length>50&&this.pitchBuffer.shift();const y=this.calculateVariance(this.pitchBuffer),b=l*.5+y*.3+Math.min(this.spikeCount/5,1)*.2;return{rms:l,pitch:s,pitchVariance:Math.min(y,1),spikeCount:this.spikeCount,stress:b}}calculateVariance(t){if(t.length===0)return 0;const r=t.reduce((o,l)=>o+l,0)/t.length,n=t.reduce((o,l)=>o+Math.pow(l-r,2),0)/t.length;return Math.min(n/1e4,1)}stop(){this.isActive=!1,this.stream&&(this.stream.getTracks().forEach(t=>t.stop()),this.stream=null),this.microphone&&(this.microphone.disconnect(),this.microphone=null),this.audioContext&&(this.audioContext.close(),this.audioContext=null),this.analyser=null}}class w8{constructor(){gs(this,"isActive",!1);gs(this,"lastAcceleration",null);gs(this,"accelerationBuffer",[])}async initialize(){if(typeof DeviceMotionEvent>"u")throw new Error("Device motion not supported");if(typeof DeviceMotionEvent.requestPermission=="function"&&await DeviceMotionEvent.requestPermission()!=="granted")throw new Error("Motion sensor permission denied");this.isActive=!0}handleMotionEvent(t){if(!this.isActive||!t.acceleration)return{acceleration:0,accelerationMagnitude:0,jitter:0,shake:0,intensity:0};const r=t.acceleration.x??0,n=t.acceleration.y??0,o=t.acceleration.z??0,l=Math.sqrt(r*r+n*n+o*o);this.accelerationBuffer.push(l),this.accelerationBuffer.length>20&&this.accelerationBuffer.shift();const h=this.calculateJitter(this.accelerationBuffer);let f=0;if(this.lastAcceleration){const y=Math.abs(r-this.lastAcceleration.x),b=Math.abs(n-this.lastAcceleration.y),w=Math.abs(o-this.lastAcceleration.z);f=(y+b+w)/3}this.lastAcceleration={x:r,y:n,z:o};const s=Math.min(l/30*.6+h/20*.4,1);return{acceleration:l,accelerationMagnitude:l,jitter:h,shake:f,intensity:s}}calculateJitter(t){if(t.length<2)return 0;let r=0;for(let n=1;n<t.length;n++)r+=Math.abs(t[n]-t[n-1]);return r/(t.length-1)}stop(){this.isActive=!1,this.lastAcceleration=null,this.accelerationBuffer=[]}isSupported(){return typeof DeviceMotionEvent<"u"}}function S8({isOpen:e,countdown:t,triggerType:r,onSendNow:n,onCancel:o}){const l=re.useRef(null),h=re.useRef(null),f=re.useRef(null),s=re.useRef(0);return re.useEffect(()=>{var R,j;if(!e){l.current&&(clearInterval(l.current),l.current=null),f.current&&(f.current.pause(),f.current.currentTime=0,f.current=null),h.current&&(h.current.close().catch(()=>{}),h.current=null);return}const y=((j=(R=import.meta)==null?void 0:R.env)==null?void 0:j.BASE_URL)||"/",b=y.endsWith("/")?y:`${y}/`,w=[`${b}sos-alarm.mp3`,`${b}sos-alarm.wav`,`${b}sos-alarm.ogg`,`${b}no-test.mp3`],A=()=>{l.current&&(clearInterval(l.current),l.current=null),h.current&&(h.current.close().catch(()=>{}),h.current=null)},k=()=>{const L=()=>{const z=s.current;if(z>=w.length)return;const B=new Audio(w[z]);B.loop=!0,B.volume=.8,B.onerror=()=>{s.current+=1,L()},f.current=B,B.play().then(()=>{A()}).catch(()=>{})};s.current=0,L()},M=()=>{try{const L=h.current||new(window.AudioContext||window.webkitAudioContext);h.current=L,L.state==="suspended"&&L.resume().catch(()=>{});const z=L.createOscillator(),B=L.createGain();z.connect(B),B.connect(L.destination),z.frequency.value=800,z.type="sine",B.gain.setValueAtTime(.3,L.currentTime),B.gain.exponentialRampToValueAtTime(.01,L.currentTime+.3),z.start(L.currentTime),z.stop(L.currentTime+.3)}catch(L){console.error("Failed to play alarm:",L)}};return M(),l.current=setInterval(M,500),k(),document.body.style.animation="flash 0.5s ease-in-out infinite",()=>{l.current&&(clearInterval(l.current),l.current=null),f.current&&(f.current.pause(),f.current.currentTime=0,f.current=null),h.current&&(h.current.close().catch(()=>{}),h.current=null),document.body.style.animation=""}},[e]),e?cM.createPortal(W.jsxs(W.Fragment,{children:[W.jsx("style",{children:`
        @keyframes flash {
          0%, 100% { background-color: rgba(239, 68, 68, 0.1); }
          50% { background-color: rgba(239, 68, 68, 0.3); }
        }
        @keyframes pulse {
          0%, 100% { transform: scale(1); }
          50% { transform: scale(1.05); }
        }
      `}),W.jsx("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-md flex items-center justify-center z-[99999]",children:W.jsxs("div",{className:"glass-panel-critical rounded-2xl p-8 max-w-md w-full mx-4 pulse-critical",children:[W.jsxs("div",{className:"text-center mb-6",children:[W.jsx("div",{className:"text-6xl mb-4 animate-pulse",children:""}),W.jsx("h2",{className:"text-3xl font-bold text-danger mb-2",children:r==="ai"?"AUTO SOS TRIGGERED":"EMERGENCY SOS"}),W.jsx("p",{className:"text-muted-foreground",children:r==="ai"?"High risk detected! Emergency alert will be sent automatically.":"Emergency alert will be sent automatically."})]}),W.jsxs("div",{className:"text-center mb-8",children:[W.jsx("div",{className:"text-8xl font-bold text-danger mb-4 animate-pulse",children:t}),W.jsx("p",{className:"text-muted-foreground text-lg",children:t>1?"seconds remaining":"second remaining"})]}),W.jsxs("div",{className:"flex gap-4",children:[W.jsx("button",{onClick:o,className:"flex-1 px-6 py-4 bg-secondary/60 hover:bg-secondary/80 text-foreground rounded-lg font-semibold text-lg transition-colors border border-border/50",children:"Cancel"}),W.jsx("button",{onClick:n,className:"flex-1 px-6 py-4 bg-danger hover:bg-red-600 text-white rounded-lg font-semibold text-lg transition-colors shadow-lg",children:"Send Now"})]})]})})]}),document.body):null}function Vse({onSOSTriggered:e,triggerType:t,onCancelAuto:r,location:n}){const[o,l]=re.useState(null),[h,f]=re.useState(!1),[s,y]=re.useState("manual"),[b,w]=re.useState(null),[A,k]=re.useState(null),[M,R]=re.useState({rms:0,pitch:0,pitchVariance:0,spikeCount:0,stress:0}),[j,L]=re.useState({acceleration:0,accelerationMagnitude:0,jitter:0,shake:0,intensity:0}),z=re.useRef(null),B=re.useRef(!1),Z=re.useRef(!1),F=(ue="manual")=>{Z.current=!1,y(ue),l(10),f(!0)};re.useEffect(()=>{t==="ai"&&o===null&&!h&&F("ai")},[t]),re.useEffect(()=>((async()=>{try{const Ee=new b8;await Ee.initialize(),w(Ee);const Oe=new w8;if(Oe.isSupported()){await Oe.initialize(),k(Oe);const je=Ge=>{const Ze=Oe.handleMotionEvent(Ge);L(Ze)};return window.addEventListener("devicemotion",je),()=>window.removeEventListener("devicemotion",je)}}catch(Ee){console.error("Failed to initialize sensors:",Ee)}})(),()=>{b&&b.stop(),A&&A.stop()}),[]),re.useEffect(()=>{if(!b)return;const ue=setInterval(()=>{const Ee=b.getAudioData();R(Ee)},200);return()=>clearInterval(ue)},[b]);const H=()=>{o===null&&F("manual")},Y=()=>{z.current&&clearInterval(z.current),l(null),f(!1),s==="ai"&&r&&r()},te=re.useCallback(async()=>{if(!Z.current){Z.current=!0;try{const ue=DC(M,j,n||void 0);await Yo.createSOS({risk_score:ue.total,factors:{audio:ue.audio.score,motion:ue.motion.score,time:ue.time.score,location:ue.location.score},location:n||void 0,trigger_type:s}),e&&e()}catch(ue){console.error("Failed to trigger SOS:",ue),Z.current=!1}finally{l(null),f(!1)}}},[M,j,s,e,n]),pe=()=>{z.current&&(clearInterval(z.current),z.current=null),te()};return re.useEffect(()=>{if(o===null){z.current&&(clearInterval(z.current),z.current=null),B.current=!1;return}if(o<=0){z.current&&(clearInterval(z.current),z.current=null),B.current=!1,te();return}return!B.current&&o>0&&(B.current=!0,z.current=setInterval(()=>{l(ue=>ue===null||ue<=0?(B.current=!1,z.current&&(clearInterval(z.current),z.current=null),0):ue-1)},1e3)),()=>{o===null&&z.current&&(clearInterval(z.current),z.current=null,B.current=!1)}},[o,te]),W.jsxs(W.Fragment,{children:[W.jsxs("div",{className:"flex flex-col items-center gap-4",children:[W.jsx("button",{onClick:H,className:`
            relative w-32 h-32 rounded-full font-bold text-xl
            transition-all duration-300
            ${h?"bg-danger hover:bg-red-600 animate-pulse":"bg-danger hover:bg-red-600"}
            text-white shadow-2xl
            focus:outline-none focus:ring-4 focus:ring-danger/50
          `,children:W.jsx("span",{children:"SOS"})}),!h&&W.jsx("div",{className:"text-white text-center",children:W.jsx("p",{className:"text-sm text-slate-400",children:"Click to trigger emergency"})})]}),W.jsx(S8,{isOpen:h&&o!==null,countdown:o!==null?o:0,triggerType:s,onSendNow:pe,onCancel:Y})]})}const Pl=Object.create(null);Pl.open="0";Pl.close="1";Pl.ping="2";Pl.pong="3";Pl.message="4";Pl.upgrade="5";Pl.noop="6";const Tb=Object.create(null);Object.keys(Pl).forEach(e=>{Tb[Pl[e]]=e});const LC={type:"error",data:"parser error"},T8=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",E8=typeof ArrayBuffer=="function",A8=e=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(e):e&&e.buffer instanceof ArrayBuffer,oI=({type:e,data:t},r,n)=>T8&&t instanceof Blob?r?n(t):x3(t,n):E8&&(t instanceof ArrayBuffer||A8(t))?r?n(t):x3(new Blob([t]),n):n(Pl[e]+(t||"")),x3=(e,t)=>{const r=new FileReader;return r.onload=function(){const n=r.result.split(",")[1];t("b"+(n||""))},r.readAsDataURL(e)};function b3(e){return e instanceof Uint8Array?e:e instanceof ArrayBuffer?new Uint8Array(e):new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}let vA;function Gse(e,t){if(T8&&e.data instanceof Blob)return e.data.arrayBuffer().then(b3).then(t);if(E8&&(e.data instanceof ArrayBuffer||A8(e.data)))return t(b3(e.data));oI(e,!1,r=>{vA||(vA=new TextEncoder),t(vA.encode(r))})}const w3="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Wy=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let e=0;e<w3.length;e++)Wy[w3.charCodeAt(e)]=e;const Wse=e=>{let t=e.length*.75,r=e.length,n,o=0,l,h,f,s;e[e.length-1]==="="&&(t--,e[e.length-2]==="="&&t--);const y=new ArrayBuffer(t),b=new Uint8Array(y);for(n=0;n<r;n+=4)l=Wy[e.charCodeAt(n)],h=Wy[e.charCodeAt(n+1)],f=Wy[e.charCodeAt(n+2)],s=Wy[e.charCodeAt(n+3)],b[o++]=l<<2|h>>4,b[o++]=(h&15)<<4|f>>2,b[o++]=(f&3)<<6|s&63;return y},qse=typeof ArrayBuffer=="function",sI=(e,t)=>{if(typeof e!="string")return{type:"message",data:P8(e,t)};const r=e.charAt(0);return r==="b"?{type:"message",data:Hse(e.substring(1),t)}:Tb[r]?e.length>1?{type:Tb[r],data:e.substring(1)}:{type:Tb[r]}:LC},Hse=(e,t)=>{if(qse){const r=Wse(e);return P8(r,t)}else return{base64:!0,data:e}},P8=(e,t)=>{switch(t){case"blob":return e instanceof Blob?e:new Blob([e]);case"arraybuffer":default:return e instanceof ArrayBuffer?e:e.buffer}},C8="",Kse=(e,t)=>{const r=e.length,n=new Array(r);let o=0;e.forEach((l,h)=>{oI(l,!1,f=>{n[h]=f,++o===r&&t(n.join(C8))})})},Zse=(e,t)=>{const r=e.split(C8),n=[];for(let o=0;o<r.length;o++){const l=sI(r[o],t);if(n.push(l),l.type==="error")break}return n};function Xse(){return new TransformStream({transform(e,t){Gse(e,r=>{const n=r.length;let o;if(n<126)o=new Uint8Array(1),new DataView(o.buffer).setUint8(0,n);else if(n<65536){o=new Uint8Array(3);const l=new DataView(o.buffer);l.setUint8(0,126),l.setUint16(1,n)}else{o=new Uint8Array(9);const l=new DataView(o.buffer);l.setUint8(0,127),l.setBigUint64(1,BigInt(n))}e.data&&typeof e.data!="string"&&(o[0]|=128),t.enqueue(o),t.enqueue(r)})}})}let _A;function Vx(e){return e.reduce((t,r)=>t+r.length,0)}function Gx(e,t){if(e[0].length===t)return e.shift();const r=new Uint8Array(t);let n=0;for(let o=0;o<t;o++)r[o]=e[0][n++],n===e[0].length&&(e.shift(),n=0);return e.length&&n<e[0].length&&(e[0]=e[0].slice(n)),r}function Yse(e,t){_A||(_A=new TextDecoder);const r=[];let n=0,o=-1,l=!1;return new TransformStream({transform(h,f){for(r.push(h);;){if(n===0){if(Vx(r)<1)break;const s=Gx(r,1);l=(s[0]&128)===128,o=s[0]&127,o<126?n=3:o===126?n=1:n=2}else if(n===1){if(Vx(r)<2)break;const s=Gx(r,2);o=new DataView(s.buffer,s.byteOffset,s.length).getUint16(0),n=3}else if(n===2){if(Vx(r)<8)break;const s=Gx(r,8),y=new DataView(s.buffer,s.byteOffset,s.length),b=y.getUint32(0);if(b>Math.pow(2,21)-1){f.enqueue(LC);break}o=b*Math.pow(2,32)+y.getUint32(4),n=3}else{if(Vx(r)<o)break;const s=Gx(r,o);f.enqueue(sI(l?s:_A.decode(s),t)),n=0}if(o===0||o>e){f.enqueue(LC);break}}}})}const k8=4;function xi(e){if(e)return Jse(e)}function Jse(e){for(var t in xi.prototype)e[t]=xi.prototype[t];return e}xi.prototype.on=xi.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this};xi.prototype.once=function(e,t){function r(){this.off(e,r),t.apply(this,arguments)}return r.fn=t,this.on(e,r),this};xi.prototype.off=xi.prototype.removeListener=xi.prototype.removeAllListeners=xi.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var r=this._callbacks["$"+e];if(!r)return this;if(arguments.length==1)return delete this._callbacks["$"+e],this;for(var n,o=0;o<r.length;o++)if(n=r[o],n===t||n.fn===t){r.splice(o,1);break}return r.length===0&&delete this._callbacks["$"+e],this};xi.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),r=this._callbacks["$"+e],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(r){r=r.slice(0);for(var n=0,o=r.length;n<o;++n)r[n].apply(this,t)}return this};xi.prototype.emitReserved=xi.prototype.emit;xi.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]};xi.prototype.hasListeners=function(e){return!!this.listeners(e).length};const q1=typeof Promise=="function"&&typeof Promise.resolve=="function"?t=>Promise.resolve().then(t):(t,r)=>r(t,0),Ks=typeof self<"u"?self:typeof window<"u"?window:Function("return this")(),Qse="arraybuffer";function O8(e,...t){return t.reduce((r,n)=>(e.hasOwnProperty(n)&&(r[n]=e[n]),r),{})}const eae=Ks.setTimeout,tae=Ks.clearTimeout;function H1(e,t){t.useNativeTimers?(e.setTimeoutFn=eae.bind(Ks),e.clearTimeoutFn=tae.bind(Ks)):(e.setTimeoutFn=Ks.setTimeout.bind(Ks),e.clearTimeoutFn=Ks.clearTimeout.bind(Ks))}const rae=1.33;function nae(e){return typeof e=="string"?iae(e):Math.ceil((e.byteLength||e.size)*rae)}function iae(e){let t=0,r=0;for(let n=0,o=e.length;n<o;n++)t=e.charCodeAt(n),t<128?r+=1:t<2048?r+=2:t<55296||t>=57344?r+=3:(n++,r+=4);return r}function M8(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}function oae(e){let t="";for(let r in e)e.hasOwnProperty(r)&&(t.length&&(t+="&"),t+=encodeURIComponent(r)+"="+encodeURIComponent(e[r]));return t}function sae(e){let t={},r=e.split("&");for(let n=0,o=r.length;n<o;n++){let l=r[n].split("=");t[decodeURIComponent(l[0])]=decodeURIComponent(l[1])}return t}class aae extends Error{constructor(t,r,n){super(t),this.description=r,this.context=n,this.type="TransportError"}}class aI extends xi{constructor(t){super(),this.writable=!1,H1(this,t),this.opts=t,this.query=t.query,this.socket=t.socket,this.supportsBinary=!t.forceBase64}onError(t,r,n){return super.emitReserved("error",new aae(t,r,n)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(t){this.readyState==="open"&&this.write(t)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(t){const r=sI(t,this.socket.binaryType);this.onPacket(r)}onPacket(t){super.emitReserved("packet",t)}onClose(t){this.readyState="closed",super.emitReserved("close",t)}pause(t){}createUri(t,r={}){return t+"://"+this._hostname()+this._port()+this.opts.path+this._query(r)}_hostname(){const t=this.opts.hostname;return t.indexOf(":")===-1?t:"["+t+"]"}_port(){return this.opts.port&&(this.opts.secure&&Number(this.opts.port)!==443||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(t){const r=oae(t);return r.length?"?"+r:""}}class lae extends aI{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(t){this.readyState="pausing";const r=()=>{this.readyState="paused",t()};if(this._polling||!this.writable){let n=0;this._polling&&(n++,this.once("pollComplete",function(){--n||r()})),this.writable||(n++,this.once("drain",function(){--n||r()}))}else r()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(t){const r=n=>{if(this.readyState==="opening"&&n.type==="open"&&this.onOpen(),n.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(n)};Zse(t,this.socket.binaryType).forEach(r),this.readyState!=="closed"&&(this._polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this._poll())}doClose(){const t=()=>{this.write([{type:"close"}])};this.readyState==="open"?t():this.once("open",t)}write(t){this.writable=!1,Kse(t,r=>{this.doWrite(r,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const t=this.opts.secure?"https":"http",r=this.query||{};return this.opts.timestampRequests!==!1&&(r[this.opts.timestampParam]=M8()),!this.supportsBinary&&!r.sid&&(r.b64=1),this.createUri(t,r)}}let I8=!1;try{I8=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const cae=I8;function uae(){}class hae extends lae{constructor(t){if(super(t),typeof location<"u"){const r=location.protocol==="https:";let n=location.port;n||(n=r?"443":"80"),this.xd=typeof location<"u"&&t.hostname!==location.hostname||n!==t.port}}doWrite(t,r){const n=this.request({method:"POST",data:t});n.on("success",r),n.on("error",(o,l)=>{this.onError("xhr post error",o,l)})}doPoll(){const t=this.request();t.on("data",this.onData.bind(this)),t.on("error",(r,n)=>{this.onError("xhr poll error",r,n)}),this.pollXhr=t}}class bl extends xi{constructor(t,r,n){super(),this.createRequest=t,H1(this,n),this._opts=n,this._method=n.method||"GET",this._uri=r,this._data=n.data!==void 0?n.data:null,this._create()}_create(){var t;const r=O8(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");r.xdomain=!!this._opts.xd;const n=this._xhr=this.createRequest(r);try{n.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){n.setDisableHeaderCheck&&n.setDisableHeaderCheck(!0);for(let o in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(o)&&n.setRequestHeader(o,this._opts.extraHeaders[o])}}catch{}if(this._method==="POST")try{n.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{n.setRequestHeader("Accept","*/*")}catch{}(t=this._opts.cookieJar)===null||t===void 0||t.addCookies(n),"withCredentials"in n&&(n.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(n.timeout=this._opts.requestTimeout),n.onreadystatechange=()=>{var o;n.readyState===3&&((o=this._opts.cookieJar)===null||o===void 0||o.parseCookies(n.getResponseHeader("set-cookie"))),n.readyState===4&&(n.status===200||n.status===1223?this._onLoad():this.setTimeoutFn(()=>{this._onError(typeof n.status=="number"?n.status:0)},0))},n.send(this._data)}catch(o){this.setTimeoutFn(()=>{this._onError(o)},0);return}typeof document<"u"&&(this._index=bl.requestsCount++,bl.requests[this._index]=this)}_onError(t){this.emitReserved("error",t,this._xhr),this._cleanup(!0)}_cleanup(t){if(!(typeof this._xhr>"u"||this._xhr===null)){if(this._xhr.onreadystatechange=uae,t)try{this._xhr.abort()}catch{}typeof document<"u"&&delete bl.requests[this._index],this._xhr=null}}_onLoad(){const t=this._xhr.responseText;t!==null&&(this.emitReserved("data",t),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}}bl.requestsCount=0;bl.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",S3);else if(typeof addEventListener=="function"){const e="onpagehide"in Ks?"pagehide":"unload";addEventListener(e,S3,!1)}}function S3(){for(let e in bl.requests)bl.requests.hasOwnProperty(e)&&bl.requests[e].abort()}const dae=function(){const e=R8({xdomain:!1});return e&&e.responseType!==null}();class fae extends hae{constructor(t){super(t);const r=t&&t.forceBase64;this.supportsBinary=dae&&!r}request(t={}){return Object.assign(t,{xd:this.xd},this.opts),new bl(R8,this.uri(),t)}}function R8(e){const t=e.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!t||cae))return new XMLHttpRequest}catch{}if(!t)try{return new Ks[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}const D8=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class pae extends aI{get name(){return"websocket"}doOpen(){const t=this.uri(),r=this.opts.protocols,n=D8?{}:O8(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(n.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(t,r,n)}catch(o){return this.emitReserved("error",o)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=t=>this.onClose({description:"websocket connection closed",context:t}),this.ws.onmessage=t=>this.onData(t.data),this.ws.onerror=t=>this.onError("websocket error",t)}write(t){this.writable=!1;for(let r=0;r<t.length;r++){const n=t[r],o=r===t.length-1;oI(n,this.supportsBinary,l=>{try{this.doWrite(n,l)}catch{}o&&q1(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){const t=this.opts.secure?"wss":"ws",r=this.query||{};return this.opts.timestampRequests&&(r[this.opts.timestampParam]=M8()),this.supportsBinary||(r.b64=1),this.createUri(t,r)}}const xA=Ks.WebSocket||Ks.MozWebSocket;class mae extends pae{createSocket(t,r,n){return D8?new xA(t,r,n):r?new xA(t,r):new xA(t)}doWrite(t,r){this.ws.send(r)}}class gae extends aI{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(t){return this.emitReserved("error",t)}this._transport.closed.then(()=>{this.onClose()}).catch(t=>{this.onError("webtransport error",t)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(t=>{const r=Yse(Number.MAX_SAFE_INTEGER,this.socket.binaryType),n=t.readable.pipeThrough(r).getReader(),o=Xse();o.readable.pipeTo(t.writable),this._writer=o.writable.getWriter();const l=()=>{n.read().then(({done:f,value:s})=>{f||(this.onPacket(s),l())}).catch(f=>{})};l();const h={type:"open"};this.query.sid&&(h.data=`{"sid":"${this.query.sid}"}`),this._writer.write(h).then(()=>this.onOpen())})})}write(t){this.writable=!1;for(let r=0;r<t.length;r++){const n=t[r],o=r===t.length-1;this._writer.write(n).then(()=>{o&&q1(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var t;(t=this._transport)===null||t===void 0||t.close()}}const yae={websocket:mae,webtransport:gae,polling:fae},vae=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,_ae=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function jC(e){if(e.length>8e3)throw"URI too long";const t=e,r=e.indexOf("["),n=e.indexOf("]");r!=-1&&n!=-1&&(e=e.substring(0,r)+e.substring(r,n).replace(/:/g,";")+e.substring(n,e.length));let o=vae.exec(e||""),l={},h=14;for(;h--;)l[_ae[h]]=o[h]||"";return r!=-1&&n!=-1&&(l.source=t,l.host=l.host.substring(1,l.host.length-1).replace(/;/g,":"),l.authority=l.authority.replace("[","").replace("]","").replace(/;/g,":"),l.ipv6uri=!0),l.pathNames=xae(l,l.path),l.queryKey=bae(l,l.query),l}function xae(e,t){const r=/\/{2,9}/g,n=t.replace(r,"/").split("/");return(t.slice(0,1)=="/"||t.length===0)&&n.splice(0,1),t.slice(-1)=="/"&&n.splice(n.length-1,1),n}function bae(e,t){const r={};return t.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(n,o,l){o&&(r[o]=l)}),r}const zC=typeof addEventListener=="function"&&typeof removeEventListener=="function",Eb=[];zC&&addEventListener("offline",()=>{Eb.forEach(e=>e())},!1);class Mu extends xi{constructor(t,r){if(super(),this.binaryType=Qse,this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,t&&typeof t=="object"&&(r=t,t=null),t){const n=jC(t);r.hostname=n.host,r.secure=n.protocol==="https"||n.protocol==="wss",r.port=n.port,n.query&&(r.query=n.query)}else r.host&&(r.hostname=jC(r.host).host);H1(this,r),this.secure=r.secure!=null?r.secure:typeof location<"u"&&location.protocol==="https:",r.hostname&&!r.port&&(r.port=this.secure?"443":"80"),this.hostname=r.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=r.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},r.transports.forEach(n=>{const o=n.prototype.name;this.transports.push(o),this._transportsByName[o]=n}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},r),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=sae(this.opts.query)),zC&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},Eb.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(t){const r=Object.assign({},this.opts.query);r.EIO=k8,r.transport=t,this.id&&(r.sid=this.id);const n=Object.assign({},this.opts,{query:r,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[t]);return new this._transportsByName[t](n)}_open(){if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}const t=this.opts.rememberUpgrade&&Mu.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1?"websocket":this.transports[0];this.readyState="opening";const r=this.createTransport(t);r.open(),this.setTransport(r)}setTransport(t){this.transport&&this.transport.removeAllListeners(),this.transport=t,t.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",r=>this._onClose("transport close",r))}onOpen(){this.readyState="open",Mu.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush()}_onPacket(t){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",t),this.emitReserved("heartbeat"),t.type){case"open":this.onHandshake(JSON.parse(t.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const r=new Error("server error");r.code=t.data,this._onError(r);break;case"message":this.emitReserved("data",t.data),this.emitReserved("message",t.data);break}}onHandshake(t){this.emitReserved("handshake",t),this.id=t.sid,this.transport.query.sid=t.sid,this._pingInterval=t.pingInterval,this._pingTimeout=t.pingTimeout,this._maxPayload=t.maxPayload,this.onOpen(),this.readyState!=="closed"&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const t=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+t,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},t),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const t=this._getWritablePackets();this.transport.send(t),this._prevBufferLen=t.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let r=1;for(let n=0;n<this.writeBuffer.length;n++){const o=this.writeBuffer[n].data;if(o&&(r+=nae(o)),n>0&&r>this._maxPayload)return this.writeBuffer.slice(0,n);r+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const t=Date.now()>this._pingTimeoutTime;return t&&(this._pingTimeoutTime=0,q1(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),t}write(t,r,n){return this._sendPacket("message",t,r,n),this}send(t,r,n){return this._sendPacket("message",t,r,n),this}_sendPacket(t,r,n,o){if(typeof r=="function"&&(o=r,r=void 0),typeof n=="function"&&(o=n,n=null),this.readyState==="closing"||this.readyState==="closed")return;n=n||{},n.compress=n.compress!==!1;const l={type:t,data:r,options:n};this.emitReserved("packetCreate",l),this.writeBuffer.push(l),o&&this.once("flush",o),this.flush()}close(){const t=()=>{this._onClose("forced close"),this.transport.close()},r=()=>{this.off("upgrade",r),this.off("upgradeError",r),t()},n=()=>{this.once("upgrade",r),this.once("upgradeError",r)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?n():t()}):this.upgrading?n():t()),this}_onError(t){if(Mu.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&this.readyState==="opening")return this.transports.shift(),this._open();this.emitReserved("error",t),this._onClose("transport error",t)}_onClose(t,r){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing"){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),zC&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const n=Eb.indexOf(this._offlineEventListener);n!==-1&&Eb.splice(n,1)}this.readyState="closed",this.id=null,this.emitReserved("close",t,r),this.writeBuffer=[],this._prevBufferLen=0}}}Mu.protocol=k8;class wae extends Mu{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),this.readyState==="open"&&this.opts.upgrade)for(let t=0;t<this._upgrades.length;t++)this._probe(this._upgrades[t])}_probe(t){let r=this.createTransport(t),n=!1;Mu.priorWebsocketSuccess=!1;const o=()=>{n||(r.send([{type:"ping",data:"probe"}]),r.once("packet",w=>{if(!n)if(w.type==="pong"&&w.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",r),!r)return;Mu.priorWebsocketSuccess=r.name==="websocket",this.transport.pause(()=>{n||this.readyState!=="closed"&&(b(),this.setTransport(r),r.send([{type:"upgrade"}]),this.emitReserved("upgrade",r),r=null,this.upgrading=!1,this.flush())})}else{const A=new Error("probe error");A.transport=r.name,this.emitReserved("upgradeError",A)}}))};function l(){n||(n=!0,b(),r.close(),r=null)}const h=w=>{const A=new Error("probe error: "+w);A.transport=r.name,l(),this.emitReserved("upgradeError",A)};function f(){h("transport closed")}function s(){h("socket closed")}function y(w){r&&w.name!==r.name&&l()}const b=()=>{r.removeListener("open",o),r.removeListener("error",h),r.removeListener("close",f),this.off("close",s),this.off("upgrading",y)};r.once("open",o),r.once("error",h),r.once("close",f),this.once("close",s),this.once("upgrading",y),this._upgrades.indexOf("webtransport")!==-1&&t!=="webtransport"?this.setTimeoutFn(()=>{n||r.open()},200):r.open()}onHandshake(t){this._upgrades=this._filterUpgrades(t.upgrades),super.onHandshake(t)}_filterUpgrades(t){const r=[];for(let n=0;n<t.length;n++)~this.transports.indexOf(t[n])&&r.push(t[n]);return r}}let Sae=class extends wae{constructor(t,r={}){const n=typeof t=="object"?t:r;(!n.transports||n.transports&&typeof n.transports[0]=="string")&&(n.transports=(n.transports||["polling","websocket","webtransport"]).map(o=>yae[o]).filter(o=>!!o)),super(t,n)}};function Tae(e,t="",r){let n=e;r=r||typeof location<"u"&&location,e==null&&(e=r.protocol+"//"+r.host),typeof e=="string"&&(e.charAt(0)==="/"&&(e.charAt(1)==="/"?e=r.protocol+e:e=r.host+e),/^(https?|wss?):\/\//.test(e)||(typeof r<"u"?e=r.protocol+"//"+e:e="https://"+e),n=jC(e)),n.port||(/^(http|ws)$/.test(n.protocol)?n.port="80":/^(http|ws)s$/.test(n.protocol)&&(n.port="443")),n.path=n.path||"/";const l=n.host.indexOf(":")!==-1?"["+n.host+"]":n.host;return n.id=n.protocol+"://"+l+":"+n.port+t,n.href=n.protocol+"://"+l+(r&&r.port===n.port?"":":"+n.port),n}const Eae=typeof ArrayBuffer=="function",Aae=e=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(e):e.buffer instanceof ArrayBuffer,L8=Object.prototype.toString,Pae=typeof Blob=="function"||typeof Blob<"u"&&L8.call(Blob)==="[object BlobConstructor]",Cae=typeof File=="function"||typeof File<"u"&&L8.call(File)==="[object FileConstructor]";function lI(e){return Eae&&(e instanceof ArrayBuffer||Aae(e))||Pae&&e instanceof Blob||Cae&&e instanceof File}function Ab(e,t){if(!e||typeof e!="object")return!1;if(Array.isArray(e)){for(let r=0,n=e.length;r<n;r++)if(Ab(e[r]))return!0;return!1}if(lI(e))return!0;if(e.toJSON&&typeof e.toJSON=="function"&&arguments.length===1)return Ab(e.toJSON(),!0);for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&Ab(e[r]))return!0;return!1}function kae(e){const t=[],r=e.data,n=e;return n.data=BC(r,t),n.attachments=t.length,{packet:n,buffers:t}}function BC(e,t){if(!e)return e;if(lI(e)){const r={_placeholder:!0,num:t.length};return t.push(e),r}else if(Array.isArray(e)){const r=new Array(e.length);for(let n=0;n<e.length;n++)r[n]=BC(e[n],t);return r}else if(typeof e=="object"&&!(e instanceof Date)){const r={};for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=BC(e[n],t));return r}return e}function Oae(e,t){return e.data=NC(e.data,t),delete e.attachments,e}function NC(e,t){if(!e)return e;if(e&&e._placeholder===!0){if(typeof e.num=="number"&&e.num>=0&&e.num<t.length)return t[e.num];throw new Error("illegal attachments")}else if(Array.isArray(e))for(let r=0;r<e.length;r++)e[r]=NC(e[r],t);else if(typeof e=="object")for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&(e[r]=NC(e[r],t));return e}const j8=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],Mae=5;var kr;(function(e){e[e.CONNECT=0]="CONNECT",e[e.DISCONNECT=1]="DISCONNECT",e[e.EVENT=2]="EVENT",e[e.ACK=3]="ACK",e[e.CONNECT_ERROR=4]="CONNECT_ERROR",e[e.BINARY_EVENT=5]="BINARY_EVENT",e[e.BINARY_ACK=6]="BINARY_ACK"})(kr||(kr={}));class Iae{constructor(t){this.replacer=t}encode(t){return(t.type===kr.EVENT||t.type===kr.ACK)&&Ab(t)?this.encodeAsBinary({type:t.type===kr.EVENT?kr.BINARY_EVENT:kr.BINARY_ACK,nsp:t.nsp,data:t.data,id:t.id}):[this.encodeAsString(t)]}encodeAsString(t){let r=""+t.type;return(t.type===kr.BINARY_EVENT||t.type===kr.BINARY_ACK)&&(r+=t.attachments+"-"),t.nsp&&t.nsp!=="/"&&(r+=t.nsp+","),t.id!=null&&(r+=t.id),t.data!=null&&(r+=JSON.stringify(t.data,this.replacer)),r}encodeAsBinary(t){const r=kae(t),n=this.encodeAsString(r.packet),o=r.buffers;return o.unshift(n),o}}class cI extends xi{constructor(t){super(),this.reviver=t}add(t){let r;if(typeof t=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");r=this.decodeString(t);const n=r.type===kr.BINARY_EVENT;n||r.type===kr.BINARY_ACK?(r.type=n?kr.EVENT:kr.ACK,this.reconstructor=new Rae(r),r.attachments===0&&super.emitReserved("decoded",r)):super.emitReserved("decoded",r)}else if(lI(t)||t.base64)if(this.reconstructor)r=this.reconstructor.takeBinaryData(t),r&&(this.reconstructor=null,super.emitReserved("decoded",r));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+t)}decodeString(t){let r=0;const n={type:Number(t.charAt(0))};if(kr[n.type]===void 0)throw new Error("unknown packet type "+n.type);if(n.type===kr.BINARY_EVENT||n.type===kr.BINARY_ACK){const l=r+1;for(;t.charAt(++r)!=="-"&&r!=t.length;);const h=t.substring(l,r);if(h!=Number(h)||t.charAt(r)!=="-")throw new Error("Illegal attachments");n.attachments=Number(h)}if(t.charAt(r+1)==="/"){const l=r+1;for(;++r&&!(t.charAt(r)===","||r===t.length););n.nsp=t.substring(l,r)}else n.nsp="/";const o=t.charAt(r+1);if(o!==""&&Number(o)==o){const l=r+1;for(;++r;){const h=t.charAt(r);if(h==null||Number(h)!=h){--r;break}if(r===t.length)break}n.id=Number(t.substring(l,r+1))}if(t.charAt(++r)){const l=this.tryParse(t.substr(r));if(cI.isPayloadValid(n.type,l))n.data=l;else throw new Error("invalid payload")}return n}tryParse(t){try{return JSON.parse(t,this.reviver)}catch{return!1}}static isPayloadValid(t,r){switch(t){case kr.CONNECT:return dw(r);case kr.DISCONNECT:return r===void 0;case kr.CONNECT_ERROR:return typeof r=="string"||dw(r);case kr.EVENT:case kr.BINARY_EVENT:return Array.isArray(r)&&(typeof r[0]=="number"||typeof r[0]=="string"&&j8.indexOf(r[0])===-1);case kr.ACK:case kr.BINARY_ACK:return Array.isArray(r)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class Rae{constructor(t){this.packet=t,this.buffers=[],this.reconPack=t}takeBinaryData(t){if(this.buffers.push(t),this.buffers.length===this.reconPack.attachments){const r=Oae(this.reconPack,this.buffers);return this.finishedReconstruction(),r}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}function Dae(e){return typeof e=="string"}const Lae=Number.isInteger||function(e){return typeof e=="number"&&isFinite(e)&&Math.floor(e)===e};function jae(e){return e===void 0||Lae(e)}function dw(e){return Object.prototype.toString.call(e)==="[object Object]"}function zae(e,t){switch(e){case kr.CONNECT:return t===void 0||dw(t);case kr.DISCONNECT:return t===void 0;case kr.EVENT:return Array.isArray(t)&&(typeof t[0]=="number"||typeof t[0]=="string"&&j8.indexOf(t[0])===-1);case kr.ACK:return Array.isArray(t);case kr.CONNECT_ERROR:return typeof t=="string"||dw(t);default:return!1}}function Bae(e){return Dae(e.nsp)&&jae(e.id)&&zae(e.type,e.data)}const Nae=Object.freeze(Object.defineProperty({__proto__:null,Decoder:cI,Encoder:Iae,get PacketType(){return kr},isPacketValid:Bae,protocol:Mae},Symbol.toStringTag,{value:"Module"}));function La(e,t,r){return e.on(t,r),function(){e.off(t,r)}}const $ae=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class z8 extends xi{constructor(t,r,n){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=t,this.nsp=r,n&&n.auth&&(this.auth=n.auth),this._opts=Object.assign({},n),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const t=this.io;this.subs=[La(t,"open",this.onopen.bind(this)),La(t,"packet",this.onpacket.bind(this)),La(t,"error",this.onerror.bind(this)),La(t,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...t){return t.unshift("message"),this.emit.apply(this,t),this}emit(t,...r){var n,o,l;if($ae.hasOwnProperty(t))throw new Error('"'+t.toString()+'" is a reserved event name');if(r.unshift(t),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(r),this;const h={type:kr.EVENT,data:r};if(h.options={},h.options.compress=this.flags.compress!==!1,typeof r[r.length-1]=="function"){const b=this.ids++,w=r.pop();this._registerAckCallback(b,w),h.id=b}const f=(o=(n=this.io.engine)===null||n===void 0?void 0:n.transport)===null||o===void 0?void 0:o.writable,s=this.connected&&!(!((l=this.io.engine)===null||l===void 0)&&l._hasPingExpired());return this.flags.volatile&&!f||(s?(this.notifyOutgoingListeners(h),this.packet(h)):this.sendBuffer.push(h)),this.flags={},this}_registerAckCallback(t,r){var n;const o=(n=this.flags.timeout)!==null&&n!==void 0?n:this._opts.ackTimeout;if(o===void 0){this.acks[t]=r;return}const l=this.io.setTimeoutFn(()=>{delete this.acks[t];for(let f=0;f<this.sendBuffer.length;f++)this.sendBuffer[f].id===t&&this.sendBuffer.splice(f,1);r.call(this,new Error("operation has timed out"))},o),h=(...f)=>{this.io.clearTimeoutFn(l),r.apply(this,f)};h.withError=!0,this.acks[t]=h}emitWithAck(t,...r){return new Promise((n,o)=>{const l=(h,f)=>h?o(h):n(f);l.withError=!0,r.push(l),this.emit(t,...r)})}_addToQueue(t){let r;typeof t[t.length-1]=="function"&&(r=t.pop());const n={id:this._queueSeq++,tryCount:0,pending:!1,args:t,flags:Object.assign({fromQueue:!0},this.flags)};t.push((o,...l)=>(this._queue[0],o!==null?n.tryCount>this._opts.retries&&(this._queue.shift(),r&&r(o)):(this._queue.shift(),r&&r(null,...l)),n.pending=!1,this._drainQueue())),this._queue.push(n),this._drainQueue()}_drainQueue(t=!1){if(!this.connected||this._queue.length===0)return;const r=this._queue[0];r.pending&&!t||(r.pending=!0,r.tryCount++,this.flags=r.flags,this.emit.apply(this,r.args))}packet(t){t.nsp=this.nsp,this.io._packet(t)}onopen(){typeof this.auth=="function"?this.auth(t=>{this._sendConnectPacket(t)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(t){this.packet({type:kr.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},t):t})}onerror(t){this.connected||this.emitReserved("connect_error",t)}onclose(t,r){this.connected=!1,delete this.id,this.emitReserved("disconnect",t,r),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(t=>{if(!this.sendBuffer.some(n=>String(n.id)===t)){const n=this.acks[t];delete this.acks[t],n.withError&&n.call(this,new Error("socket has been disconnected"))}})}onpacket(t){if(t.nsp===this.nsp)switch(t.type){case kr.CONNECT:t.data&&t.data.sid?this.onconnect(t.data.sid,t.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case kr.EVENT:case kr.BINARY_EVENT:this.onevent(t);break;case kr.ACK:case kr.BINARY_ACK:this.onack(t);break;case kr.DISCONNECT:this.ondisconnect();break;case kr.CONNECT_ERROR:this.destroy();const n=new Error(t.data.message);n.data=t.data.data,this.emitReserved("connect_error",n);break}}onevent(t){const r=t.data||[];t.id!=null&&r.push(this.ack(t.id)),this.connected?this.emitEvent(r):this.receiveBuffer.push(Object.freeze(r))}emitEvent(t){if(this._anyListeners&&this._anyListeners.length){const r=this._anyListeners.slice();for(const n of r)n.apply(this,t)}super.emit.apply(this,t),this._pid&&t.length&&typeof t[t.length-1]=="string"&&(this._lastOffset=t[t.length-1])}ack(t){const r=this;let n=!1;return function(...o){n||(n=!0,r.packet({type:kr.ACK,id:t,data:o}))}}onack(t){const r=this.acks[t.id];typeof r=="function"&&(delete this.acks[t.id],r.withError&&t.data.unshift(null),r.apply(this,t.data))}onconnect(t,r){this.id=t,this.recovered=r&&this._pid===r,this._pid=r,this.connected=!0,this.emitBuffered(),this._drainQueue(!0),this.emitReserved("connect")}emitBuffered(){this.receiveBuffer.forEach(t=>this.emitEvent(t)),this.receiveBuffer=[],this.sendBuffer.forEach(t=>{this.notifyOutgoingListeners(t),this.packet(t)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(t=>t()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:kr.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(t){return this.flags.compress=t,this}get volatile(){return this.flags.volatile=!0,this}timeout(t){return this.flags.timeout=t,this}onAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(t),this}prependAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(t),this}offAny(t){if(!this._anyListeners)return this;if(t){const r=this._anyListeners;for(let n=0;n<r.length;n++)if(t===r[n])return r.splice(n,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(t),this}prependAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(t),this}offAnyOutgoing(t){if(!this._anyOutgoingListeners)return this;if(t){const r=this._anyOutgoingListeners;for(let n=0;n<r.length;n++)if(t===r[n])return r.splice(n,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(t){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const r=this._anyOutgoingListeners.slice();for(const n of r)n.apply(this,t.data)}}}function Pm(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}Pm.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),r=Math.floor(t*this.jitter*e);e=Math.floor(t*10)&1?e+r:e-r}return Math.min(e,this.max)|0};Pm.prototype.reset=function(){this.attempts=0};Pm.prototype.setMin=function(e){this.ms=e};Pm.prototype.setMax=function(e){this.max=e};Pm.prototype.setJitter=function(e){this.jitter=e};class $C extends xi{constructor(t,r){var n;super(),this.nsps={},this.subs=[],t&&typeof t=="object"&&(r=t,t=void 0),r=r||{},r.path=r.path||"/socket.io",this.opts=r,H1(this,r),this.reconnection(r.reconnection!==!1),this.reconnectionAttempts(r.reconnectionAttempts||1/0),this.reconnectionDelay(r.reconnectionDelay||1e3),this.reconnectionDelayMax(r.reconnectionDelayMax||5e3),this.randomizationFactor((n=r.randomizationFactor)!==null&&n!==void 0?n:.5),this.backoff=new Pm({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(r.timeout==null?2e4:r.timeout),this._readyState="closed",this.uri=t;const o=r.parser||Nae;this.encoder=new o.Encoder,this.decoder=new o.Decoder,this._autoConnect=r.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(t){return arguments.length?(this._reconnection=!!t,t||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(t){return t===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=t,this)}reconnectionDelay(t){var r;return t===void 0?this._reconnectionDelay:(this._reconnectionDelay=t,(r=this.backoff)===null||r===void 0||r.setMin(t),this)}randomizationFactor(t){var r;return t===void 0?this._randomizationFactor:(this._randomizationFactor=t,(r=this.backoff)===null||r===void 0||r.setJitter(t),this)}reconnectionDelayMax(t){var r;return t===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=t,(r=this.backoff)===null||r===void 0||r.setMax(t),this)}timeout(t){return arguments.length?(this._timeout=t,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(t){if(~this._readyState.indexOf("open"))return this;this.engine=new Sae(this.uri,this.opts);const r=this.engine,n=this;this._readyState="opening",this.skipReconnect=!1;const o=La(r,"open",function(){n.onopen(),t&&t()}),l=f=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",f),t?t(f):this.maybeReconnectOnOpen()},h=La(r,"error",l);if(this._timeout!==!1){const f=this._timeout,s=this.setTimeoutFn(()=>{o(),l(new Error("timeout")),r.close()},f);this.opts.autoUnref&&s.unref(),this.subs.push(()=>{this.clearTimeoutFn(s)})}return this.subs.push(o),this.subs.push(h),this}connect(t){return this.open(t)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const t=this.engine;this.subs.push(La(t,"ping",this.onping.bind(this)),La(t,"data",this.ondata.bind(this)),La(t,"error",this.onerror.bind(this)),La(t,"close",this.onclose.bind(this)),La(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(t){try{this.decoder.add(t)}catch(r){this.onclose("parse error",r)}}ondecoded(t){q1(()=>{this.emitReserved("packet",t)},this.setTimeoutFn)}onerror(t){this.emitReserved("error",t)}socket(t,r){let n=this.nsps[t];return n?this._autoConnect&&!n.active&&n.connect():(n=new z8(this,t,r),this.nsps[t]=n),n}_destroy(t){const r=Object.keys(this.nsps);for(const n of r)if(this.nsps[n].active)return;this._close()}_packet(t){const r=this.encoder.encode(t);for(let n=0;n<r.length;n++)this.engine.write(r[n],t.options)}cleanup(){this.subs.forEach(t=>t()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(t,r){var n;this.cleanup(),(n=this.engine)===null||n===void 0||n.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",t,r),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const t=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const r=this.backoff.duration();this._reconnecting=!0;const n=this.setTimeoutFn(()=>{t.skipReconnect||(this.emitReserved("reconnect_attempt",t.backoff.attempts),!t.skipReconnect&&t.open(o=>{o?(t._reconnecting=!1,t.reconnect(),this.emitReserved("reconnect_error",o)):t.onreconnect()}))},r);this.opts.autoUnref&&n.unref(),this.subs.push(()=>{this.clearTimeoutFn(n)})}}onreconnect(){const t=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",t)}}const Ay={};function Pb(e,t){typeof e=="object"&&(t=e,e=void 0),t=t||{};const r=Tae(e,t.path||"/socket.io"),n=r.source,o=r.id,l=r.path,h=Ay[o]&&l in Ay[o].nsps,f=t.forceNew||t["force new connection"]||t.multiplex===!1||h;let s;return f?s=new $C(n,t):(Ay[o]||(Ay[o]=new $C(n,t)),s=Ay[o]),r.query&&!t.query&&(t.query=r.queryKey),s.socket(r.path,t)}Object.assign(Pb,{Manager:$C,Socket:z8,io:Pb,connect:Pb});const bA={},Fae=(bA==null?void 0:bA.VITE_WS_URL)||"http://localhost:3001";let ka=null;function Op(){return ka}function fw(e){if(ka!=null&&ka.connected)return ka;if(ka&&(ka.disconnect(),ka=null),!e)throw console.error("WebSocket: No token provided, cannot connect"),new Error("Token required for WebSocket connection");return ka=Pb(Fae,{auth:{token:e},transports:["websocket","polling"],reconnection:!0,reconnectionDelay:1e3,reconnectionAttempts:5}),ka.on("connect_error",t=>{console.error(" WebSocket connection error:",t.message)}),ka}var B8={exports:{}};(function(e,t){var r={};(function(n,o){e.exports=o()})(zy,function(){var n,o,l;function h(s,y){if(!n)n=y;else if(!o)o=y;else{var b="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+n+")(sharedChunk); ("+o+")(sharedChunk); self.onerror = null;",w={};n(w),l=y(w),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(l.workerUrl=window.URL.createObjectURL(new Blob([b],{type:"text/javascript"})))}}h(["exports"],function(s){var y=typeof self<"u"?self:{},b="2.15.0";let w;const A={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(w==null){const a=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{w=r.API_URL_REGEX!=null?new RegExp(r.API_URL_REGEX):a}catch{w=a}}return w},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!A.API_URL)return null;try{const a=new URL(A.API_URL);return a.hostname==="api.mapbox.cn"?"https://events.mapbox.cn/events/v2":a.hostname==="api.mapbox.com"?"https://events.mapbox.com/events/v2":null}catch{return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},k={supported:!1,testSupport:function(a){!j&&R&&(L?z(a):M=a)}};let M,R,j=!1,L=!1;function z(a){const i=a.createTexture();a.bindTexture(a.TEXTURE_2D,i);try{if(a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,R),a.isContextLost())return;k.supported=!0}catch{}a.deleteTexture(i),j=!0}y.document&&(R=y.document.createElement("img"),R.onload=function(){M&&z(M),M=null,L=!0},R.onerror=function(){j=!0,M=null},R.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const B="01";function Z(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}var F=H;function H(a,i,c,d){this.cx=3*a,this.bx=3*(c-a)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*i,this.by=3*(d-i)-this.cy,this.ay=1-this.cy-this.by,this.p1x=a,this.p1y=i,this.p2x=c,this.p2y=d}H.prototype={sampleCurveX:function(a){return((this.ax*a+this.bx)*a+this.cx)*a},sampleCurveY:function(a){return((this.ay*a+this.by)*a+this.cy)*a},sampleCurveDerivativeX:function(a){return(3*this.ax*a+2*this.bx)*a+this.cx},solveCurveX:function(a,i){if(i===void 0&&(i=1e-6),a<0)return 0;if(a>1)return 1;for(var c=a,d=0;d<8;d++){var m=this.sampleCurveX(c)-a;if(Math.abs(m)<i)return c;var v=this.sampleCurveDerivativeX(c);if(Math.abs(v)<1e-6)break;c-=m/v}var x=0,T=1;for(c=a,d=0;d<20&&(m=this.sampleCurveX(c),!(Math.abs(m-a)<i));d++)a>m?x=c:T=c,c=.5*(T-x)+x;return c},solve:function(a,i){return this.sampleCurveY(this.solveCurveX(a,i))}};var Y=Z(F),te=pe;function pe(a,i){this.x=a,this.y=i}pe.prototype={clone:function(){return new pe(this.x,this.y)},add:function(a){return this.clone()._add(a)},sub:function(a){return this.clone()._sub(a)},multByPoint:function(a){return this.clone()._multByPoint(a)},divByPoint:function(a){return this.clone()._divByPoint(a)},mult:function(a){return this.clone()._mult(a)},div:function(a){return this.clone()._div(a)},rotate:function(a){return this.clone()._rotate(a)},rotateAround:function(a,i){return this.clone()._rotateAround(a,i)},matMult:function(a){return this.clone()._matMult(a)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(a){return this.x===a.x&&this.y===a.y},dist:function(a){return Math.sqrt(this.distSqr(a))},distSqr:function(a){var i=a.x-this.x,c=a.y-this.y;return i*i+c*c},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(a){return Math.atan2(this.y-a.y,this.x-a.x)},angleWith:function(a){return this.angleWithSep(a.x,a.y)},angleWithSep:function(a,i){return Math.atan2(this.x*i-this.y*a,this.x*a+this.y*i)},_matMult:function(a){var i=a[2]*this.x+a[3]*this.y;return this.x=a[0]*this.x+a[1]*this.y,this.y=i,this},_add:function(a){return this.x+=a.x,this.y+=a.y,this},_sub:function(a){return this.x-=a.x,this.y-=a.y,this},_mult:function(a){return this.x*=a,this.y*=a,this},_div:function(a){return this.x/=a,this.y/=a,this},_multByPoint:function(a){return this.x*=a.x,this.y*=a.y,this},_divByPoint:function(a){return this.x/=a.x,this.y/=a.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var a=this.y;return this.y=this.x,this.x=-a,this},_rotate:function(a){var i=Math.cos(a),c=Math.sin(a),d=c*this.x+i*this.y;return this.x=i*this.x-c*this.y,this.y=d,this},_rotateAround:function(a,i){var c=Math.cos(a),d=Math.sin(a),m=i.y+d*(this.x-i.x)+c*(this.y-i.y);return this.x=i.x+c*(this.x-i.x)-d*(this.y-i.y),this.y=m,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},pe.convert=function(a){return a instanceof pe?a:Array.isArray(a)?new pe(a[0],a[1]):a};var ue=Z(te);const Ee=Math.PI/180,Oe=180/Math.PI;function je(a){return a*Ee}function Ge(a){return a*Oe}const Ze=[[0,0],[1,0],[1,1],[0,1]];function Ye(a){if(a<=0)return 0;if(a>=1)return 1;const i=a*a,c=i*a;return 4*(a<.5?c:3*(a-i)+c-.75)}function tt(a,i,c,d){const m=new Y(a,i,c,d);return function(v){return m.solve(v)}}const ze=tt(.25,.1,.25,1);function De(a,i,c){return Math.min(c,Math.max(i,a))}function ut(a,i,c){return(c=De((c-a)/(i-a),0,1))*c*(3-2*c)}function ht(a,i,c){const d=c-i,m=((a-i)%d+d)%d+i;return m===i?c:m}function at(a,i,c){if(!a.length)return c(null,[]);let d=a.length;const m=new Array(a.length);let v=null;a.forEach((x,T)=>{i(x,(P,C)=>{P&&(v=P),m[T]=C,--d==0&&c(v,m)})})}function Lt(a){const i=[];for(const c in a)i.push(a[c]);return i}function $t(a,...i){for(const c of i)for(const d in c)a[d]=c[d];return a}let Tr=1;function Br(){return Tr++}function cn(){return function a(i){return i?(i^Math.random()*(16>>i/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,a)}()}function Vr(a){return a<=1?1:Math.pow(2,Math.ceil(Math.log(a)/Math.LN2))}function Dt(a){return!!a&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(a)}function Jt(a,i){a.forEach(c=>{i[c]&&(i[c]=i[c].bind(i))})}function rr(a,i){return a.indexOf(i,a.length-i.length)!==-1}function Le(a,i,c){const d={};for(const m in a)d[m]=i.call(this,a[m],m,a);return d}function qt(a,i,c){const d={};for(const m in a)i.call(c||this,a[m],m,a)&&(d[m]=a[m]);return d}function Tt(a){return Array.isArray(a)?a.map(Tt):typeof a=="object"&&a?Le(a,Tt):a}const St={};function Et(a){St[a]||(typeof console<"u"&&console.warn(a),St[a]=!0)}function Ft(a,i,c){return(c.y-a.y)*(i.x-a.x)>(i.y-a.y)*(c.x-a.x)}function un(a){let i=0;for(let c,d,m=0,v=a.length,x=v-1;m<v;x=m++)c=a[m],d=a[x],i+=(d.x-c.x)*(c.y+d.y);return i}function Gr(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function hn(a){const i={};if(a.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(c,d,m,v)=>{const x=m||v;return i[d]=!x||x.toLowerCase(),""}),i["max-age"]){const c=parseInt(i["max-age"],10);isNaN(c)?delete i["max-age"]:i["max-age"]=c}return i}let zi=null;function jn(a){if(zi==null){const i=a.navigator?a.navigator.userAgent:null;zi=!!a.safari||!(!i||!(/\b(iPad|iPhone|iPod)\b/.test(i)||i.match("Safari")&&!i.match("Chrome")))}return zi}function oo(a){try{const i=y[a];return i.setItem("_mapbox_test_",1),i.removeItem("_mapbox_test_"),!0}catch{return!1}}function Zi(a,i){return[a[4*i],a[4*i+1],a[4*i+2],a[4*i+3]]}const so="mapbox-tiles";let Ha=500,Ol=50,Bi,as;function Ka(){try{return y.caches}catch{}}function ao(){Ka()&&!Bi&&(Bi=y.caches.open(so))}function zn(a){const i=a.indexOf("?");if(i<0)return a;const c=function(m){const v=m.indexOf("?");return v>0?m.slice(v+1).split("&"):[]}(a),d=c.filter(m=>{const v=m.split("=");return v[0]==="language"||v[0]==="worldview"});return d.length?`${a.slice(0,i)}?${d.join("&")}`:a.slice(0,i)}let Za=1/0;const Ms={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(Ms);class Ao extends Error{constructor(i,c,d){c===401&&Ne(d)&&(i+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(i),this.status=c,this.url=d}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const No=Gr()?()=>self.worker&&self.worker.referrer:()=>(y.location.protocol==="blob:"?y.parent:y).location.href,ls=function(a,i){if(!(/^file:/.test(c=a.url)||/^file:/.test(No())&&!/^\w+:/.test(c))){if(y.fetch&&y.Request&&y.AbortController&&y.Request.prototype.hasOwnProperty("signal"))return function(d,m){const v=new y.AbortController,x=new y.Request(d.url,{method:d.method||"GET",body:d.body,credentials:d.credentials,headers:d.headers,referrer:No(),referrerPolicy:d.referrerPolicy,signal:v.signal});let T=!1,P=!1;const C=(D=x.url).indexOf("sku=")>0&&Ne(D);var D;d.type==="json"&&x.headers.set("Accept","application/json");const $=(q,K,Q)=>{if(P)return;if(q&&q.message!=="SecurityError"&&Et(q.toString()),K&&Q)return U(K);const oe=Date.now();y.fetch(x).then(de=>{if(de.ok){const xe=C?de.clone():null;return U(de,xe,oe)}return m(new Ao(de.statusText,de.status,d.url))}).catch(de=>{de.name!=="AbortError"&&m(new Error(`${de.message} ${d.url}`))})},U=(q,K,Q)=>{(d.type==="arrayBuffer"?q.arrayBuffer():d.type==="json"?q.json():q.text()).then(oe=>{P||(K&&Q&&function(de,xe,fe){if(ao(),!Bi)return;const _e={status:xe.status,statusText:xe.statusText,headers:new y.Headers};xe.headers.forEach((We,Fe)=>_e.headers.set(Fe,We));const we=hn(xe.headers.get("Cache-Control")||"");if(we["no-store"])return;we["max-age"]&&_e.headers.set("Expires",new Date(fe+1e3*we["max-age"]).toUTCString());const be=_e.headers.get("Expires");be&&(new Date(be).getTime()-fe<42e4||function(We,Fe){if(as===void 0)try{new Response(new ReadableStream),as=!0}catch{as=!1}as?Fe(We.body):We.blob().then(Fe)}(xe,We=>{const Fe=new y.Response(We,_e);ao(),Bi&&Bi.then(Qe=>Qe.put(zn(de.url),Fe)).catch(Qe=>Et(Qe.message))}))}(x,K,Q),T=!0,m(null,oe,q.headers.get("Cache-Control"),q.headers.get("Expires")))}).catch(oe=>{P||m(new Error(oe.message))})};return C?function(q,K){if(ao(),!Bi)return K(null);const Q=zn(q.url);Bi.then(oe=>{oe.match(Q).then(de=>{const xe=function(fe){if(!fe)return!1;const _e=new Date(fe.headers.get("Expires")||0),we=hn(fe.headers.get("Cache-Control")||"");return _e>Date.now()&&!we["no-cache"]}(de);oe.delete(Q),xe&&oe.put(Q,de.clone()),K(null,de,xe)}).catch(K)}).catch(K)}(x,$):$(null,null),{cancel:()=>{P=!0,T||v.abort()}}}(a,i);if(Gr()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",a,i,void 0,!0)}var c;return function(d,m){const v=new y.XMLHttpRequest;v.open(d.method||"GET",d.url,!0),d.type==="arrayBuffer"&&(v.responseType="arraybuffer");for(const x in d.headers)v.setRequestHeader(x,d.headers[x]);return d.type==="json"&&(v.responseType="text",v.setRequestHeader("Accept","application/json")),v.withCredentials=d.credentials==="include",v.onerror=()=>{m(new Error(v.statusText))},v.onload=()=>{if((v.status>=200&&v.status<300||v.status===0)&&v.response!==null){let x=v.response;if(d.type==="json")try{x=JSON.parse(v.response)}catch(T){return m(T)}m(null,x,v.getResponseHeader("Cache-Control"),v.getResponseHeader("Expires"))}else m(new Ao(v.statusText,v.status,d.url))},v.send(d.body),{cancel:()=>v.abort()}}(a,i)},cs=function(a,i){return ls($t(a,{type:"arrayBuffer"}),i)};function Xa(a){const i=y.document.createElement("a");return i.href=a,i.protocol===y.document.location.protocol&&i.host===y.document.location.host}const ve="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let ee,ne;ee=[],ne=0;const ye=function(a,i){if(k.supported&&(a.headers||(a.headers={}),a.headers.accept="image/webp,*/*"),ne>=A.MAX_PARALLEL_IMAGE_REQUESTS){const v={requestParameters:a,callback:i,cancelled:!1,cancel(){this.cancelled=!0}};return ee.push(v),v}ne++;let c=!1;const d=()=>{if(!c)for(c=!0,ne--;ee.length&&ne<A.MAX_PARALLEL_IMAGE_REQUESTS;){const v=ee.shift(),{requestParameters:x,callback:T,cancelled:P}=v;P||(v.cancel=ye(x,T).cancel)}},m=cs(a,(v,x,T,P)=>{d(),v?i(v):x&&(y.createImageBitmap?function(C,D){const $=new y.Blob([new Uint8Array(C)],{type:"image/png"});y.createImageBitmap($).then(U=>{D(null,U)}).catch(U=>{D(new Error(`Could not load image because of ${U.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(x,(C,D)=>i(C,D,T,P)):function(C,D){const $=new y.Image,U=y.URL;$.onload=()=>{D(null,$),U.revokeObjectURL($.src),$.onload=null,y.requestAnimationFrame(()=>{$.src=ve})},$.onerror=()=>D(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const q=new y.Blob([new Uint8Array(C)],{type:"image/png"});$.src=C.byteLength?U.createObjectURL(q):ve}(x,(C,D)=>i(C,D,T,P)))});return{cancel:()=>{m.cancel(),d()}}},Se="NO_ACCESS_TOKEN";function Me(a){return a.indexOf("mapbox:")===0}function Ne(a){return A.API_URL_REGEX.test(a)}function Be(a){return A.API_CDN_URL_REGEX.test(a)}function ke(a){return A.API_STYLE_REGEX.test(a)&&!qe(a)}function qe(a){return A.API_SPRITE_REGEX.test(a)}const xt=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function wt(a){const i=a.match(xt);if(!i)throw new Error("Unable to parse URL object");return{protocol:i[1],authority:i[2],path:i[3]||"/",params:i[4]?i[4].split("&"):[]}}function gt(a){const i=a.params.length?`?${a.params.join("&")}`:"";return`${a.protocol}://${a.authority}${a.path}${i}`}const or="mapbox.eventData";function mr(a){if(!a)return null;const i=a.split(".");if(!i||i.length!==3)return null;try{return JSON.parse(decodeURIComponent(y.atob(i[1]).split("").map(c=>"%"+("00"+c.charCodeAt(0).toString(16)).slice(-2)).join("")))}catch{return null}}class sr{constructor(i){this.type=i,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(i){const c=mr(A.ACCESS_TOKEN);let d="";return d=c&&c.u?y.btoa(encodeURIComponent(c.u).replace(/%([0-9A-F]{2})/g,(m,v)=>String.fromCharCode(+("0x"+v)))):A.ACCESS_TOKEN||"",i?`${or}.${i}:${d}`:`${or}:${d}`}fetchEventData(){const i=oo("localStorage"),c=this.getStorageKey(),d=this.getStorageKey("uuid");if(i)try{const m=y.localStorage.getItem(c);m&&(this.eventData=JSON.parse(m));const v=y.localStorage.getItem(d);v&&(this.anonId=v)}catch{Et("Unable to read from LocalStorage")}}saveEventData(){const i=oo("localStorage"),c=this.getStorageKey(),d=this.getStorageKey("uuid");if(i)try{y.localStorage.setItem(d,this.anonId),Object.keys(this.eventData).length>=1&&y.localStorage.setItem(c,JSON.stringify(this.eventData))}catch{Et("Unable to write to LocalStorage")}}processRequests(i){}postEvent(i,c,d,m){if(!A.EVENTS_URL)return;const v=wt(A.EVENTS_URL);v.params.push(`access_token=${m||A.ACCESS_TOKEN||""}`);const x={event:this.type,created:new Date(i).toISOString()},T=c?$t(x,c):x,P={url:gt(v),headers:{"Content-Type":"text/plain"},body:JSON.stringify([T])};this.pendingRequest=function(C,D){return ls($t(C,{method:"POST"}),D)}(P,C=>{this.pendingRequest=null,d(C),this.saveEventData(),this.processRequests(m)})}queueRequest(i,c){this.queue.push(i),this.processRequests(c)}}const gr=new class extends sr{constructor(a){super("appUserTurnstile"),this._customAccessToken=a}postTurnstileEvent(a,i){A.EVENTS_URL&&A.ACCESS_TOKEN&&Array.isArray(a)&&a.some(c=>Me(c)||Ne(c))&&this.queueRequest(Date.now(),i)}processRequests(a){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const i=mr(A.ACCESS_TOKEN),c=i?i.u:A.ACCESS_TOKEN;let d=c!==this.eventData.tokenU;Dt(this.anonId)||(this.anonId=cn(),d=!0);const m=this.queue.shift();if(this.eventData.lastSuccess){const v=new Date(this.eventData.lastSuccess),x=new Date(m),T=(m-this.eventData.lastSuccess)/864e5;d=d||T>=1||T<-1||v.getDate()!==x.getDate()}else d=!0;d?this.postEvent(m,{sdkIdentifier:"mapbox-gl-js",sdkVersion:b,skuId:B,"enabled.telemetry":!1,userId:this.anonId},v=>{v||(this.eventData.lastSuccess=m,this.eventData.tokenU=c)},a):this.processRequests()}},vr=gr.postTurnstileEvent.bind(gr),dn=new class extends sr{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(a,i,c,d){this.skuToken=i,this.errorCb=d,A.EVENTS_URL&&(c||A.ACCESS_TOKEN?this.queueRequest({id:a,timestamp:Date.now()},c):this.errorCb(new Error(Se)))}processRequests(a){if(this.pendingRequest||this.queue.length===0)return;const{id:i,timestamp:c}=this.queue.shift();i&&this.success[i]||(this.anonId||this.fetchEventData(),Dt(this.anonId)||(this.anonId=cn()),this.postEvent(c,{sdkIdentifier:"mapbox-gl-js",sdkVersion:b,skuId:B,skuToken:this.skuToken,userId:this.anonId},d=>{d?this.errorCb(d):i&&(this.success[i]=!0)},a))}},An=dn.postMapLoadEvent.bind(dn),hi=new class extends sr{constructor(){super("gljs.performance")}postPerformanceEvent(a,i){A.EVENTS_URL&&(a||A.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:i},a)}processRequests(a){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:i,performanceData:c}=this.queue.shift(),d=function(m){const v=y.performance.getEntriesByType("resource"),x=y.performance.getEntriesByType("mark"),T=function(U){const q={};if(U){for(const K in U)if(K!=="other")for(const Q of U[K]){const oe=`${K}ResolveRangeMin`,de=`${K}ResolveRangeMax`,xe=`${K}RequestCount`,fe=`${K}RequestCachedCount`;q[oe]=Math.min(q[oe]||1/0,Q.startTime),q[de]=Math.max(q[de]||-1/0,Q.responseEnd);const _e=we=>{q[we]===void 0&&(q[we]=0),++q[we]};Q.transferSize!==void 0&&Q.transferSize===0&&_e(fe),_e(xe)}}return q}(function(U,q){const K={};if(U)for(const Q of U){const oe=q(Q);K[oe]===void 0&&(K[oe]=[]),K[oe].push(Q)}return K}(v,zd)),P=y.devicePixelRatio,C=y.navigator.connection||y.navigator.mozConnection||y.navigator.webkitConnection,D={counters:[],metadata:[],attributes:[]},$=(U,q,K)=>{K!=null&&U.push({name:q,value:K.toString()})};for(const U in T)$(D.counters,U,T[U]);if(m.interactionRange[0]!==1/0&&m.interactionRange[1]!==-1/0&&($(D.counters,"interactionRangeMin",m.interactionRange[0]),$(D.counters,"interactionRangeMax",m.interactionRange[1])),x)for(const U of Object.keys(Ya)){const q=Ya[U],K=x.find(Q=>Q.name===q);K&&$(D.counters,q,K.startTime)}return $(D.counters,"visibilityHidden",m.visibilityHidden),$(D.attributes,"style",function(U){if(U)for(const q of U){const K=q.name.split("?")[0];if(ke(K)){const Q=K.split("/").slice(-2);if(Q.length===2)return`mapbox://styles/${Q[0]}/${Q[1]}`}}}(v)),$(D.attributes,"terrainEnabled",m.terrainEnabled?"true":"false"),$(D.attributes,"fogEnabled",m.fogEnabled?"true":"false"),$(D.attributes,"projection",m.projection),$(D.attributes,"zoom",m.zoom),$(D.metadata,"devicePixelRatio",P),$(D.metadata,"connectionEffectiveType",C?C.effectiveType:void 0),$(D.metadata,"navigatorUserAgent",y.navigator.userAgent),$(D.metadata,"screenWidth",y.screen.width),$(D.metadata,"screenHeight",y.screen.height),$(D.metadata,"windowWidth",y.innerWidth),$(D.metadata,"windowHeight",y.innerHeight),$(D.metadata,"mapWidth",m.width/P),$(D.metadata,"mapHeight",m.height/P),$(D.metadata,"webglRenderer",m.renderer),$(D.metadata,"webglVendor",m.vendor),$(D.metadata,"sdkVersion",b),$(D.metadata,"sdkIdentifier","mapbox-gl-js"),D}(c);for(const m of d.metadata);for(const m of d.counters);for(const m of d.attributes);this.postEvent(i,d,()=>{},a)}},Pn=hi.postPerformanceEvent.bind(hi),$o=new class extends sr{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(a,i,c,d){if(!A.API_URL||!A.SESSION_PATH)return;const m=wt(A.API_URL+A.SESSION_PATH);m.params.push(`sku=${i||""}`),m.params.push(`access_token=${d||A.ACCESS_TOKEN||""}`);const v={url:gt(m),headers:{"Content-Type":"text/plain"}};this.pendingRequest=function(x,T){return ls($t(x,{method:"GET"}),T)}(v,x=>{this.pendingRequest=null,c(x),this.saveEventData(),this.processRequests(d)})}getSessionAPI(a,i,c,d){this.skuToken=i,this.errorCb=d,A.SESSION_PATH&&A.API_URL&&(c||A.ACCESS_TOKEN?this.queueRequest({id:a,timestamp:Date.now()},c):this.errorCb(new Error(Se)))}processRequests(a){if(this.pendingRequest||this.queue.length===0)return;const{id:i,timestamp:c}=this.queue.shift();i&&this.success[i]||this.getSession(c,this.skuToken,d=>{d?this.errorCb(d):i&&(this.success[i]=!0)},a)}},Bn=$o.getSessionAPI.bind($o),wi=new Set,Ya={create:"create",load:"load",fullLoad:"fullLoad"},jd={mark(a){y.performance.mark(a)},measure(a,i,c){y.performance.measure(a,i,c)}};function zd(a){const i=a.name.split("?")[0];return Be(i)&&i.includes("mapbox-gl.js")?"javascript":Be(i)&&i.includes("mapbox-gl.css")?"css":function(c){return A.API_FONTS_REGEX.test(c)}(i)?"fontRange":qe(i)?"sprite":ke(i)?"style":function(c){return A.API_TILEJSON_REGEX.test(c)}(i)?"tilejson":"other"}const Mr=y.performance;function Ec(a){const i=a?a.url.toString():void 0;return Mr.getEntriesByName(i)}let Ja,Ac,rt,Ct;const nr={now:()=>rt!==void 0?rt:y.performance.now(),setNow(a){rt=a},restoreNow(){rt=void 0},frame(a){const i=y.requestAnimationFrame(a);return{cancel:()=>y.cancelAnimationFrame(i)}},getImageData(a,i=0){const{width:c,height:d}=a;Ct||(Ct=y.document.createElement("canvas"));const m=Ct.getContext("2d",{willReadFrequently:!0});if(!m)throw new Error("failed to create canvas 2d context");return(c>Ct.width||d>Ct.height)&&(Ct.width=c,Ct.height=d),m.clearRect(-i,-i,c+2*i,d+2*i),m.drawImage(a,0,0,c,d),m.getImageData(-i,-i,c+2*i,d+2*i)},resolveURL:a=>(Ja||(Ja=y.document.createElement("a")),Ja.href=a,Ja.href),get devicePixelRatio(){return y.devicePixelRatio},get prefersReducedMotion(){return!!y.matchMedia&&(Ac==null&&(Ac=y.matchMedia("(prefers-reduced-motion: reduce)")),Ac.matches)}};function Xt(a,i,c){c[a]&&c[a].indexOf(i)!==-1||(c[a]=c[a]||[],c[a].push(i))}function Ut(a,i,c){if(c&&c[a]){const d=c[a].indexOf(i);d!==-1&&c[a].splice(d,1)}}class tr{constructor(i,c={}){$t(this,c),this.type=i}}class Dr extends tr{constructor(i,c={}){super("error",$t({error:i},c))}}class Si{on(i,c){return this._listeners=this._listeners||{},Xt(i,c,this._listeners),this}off(i,c){return Ut(i,c,this._listeners),Ut(i,c,this._oneTimeListeners),this}once(i,c){return c?(this._oneTimeListeners=this._oneTimeListeners||{},Xt(i,c,this._oneTimeListeners),this):new Promise(d=>this.once(i,d))}fire(i,c){typeof i=="string"&&(i=new tr(i,c||{}));const d=i.type;if(this.listens(d)){i.target=this;const m=this._listeners&&this._listeners[d]?this._listeners[d].slice():[];for(const T of m)T.call(this,i);const v=this._oneTimeListeners&&this._oneTimeListeners[d]?this._oneTimeListeners[d].slice():[];for(const T of v)Ut(d,T,this._oneTimeListeners),T.call(this,i);const x=this._eventedParent;x&&($t(i,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),x.fire(i))}else i instanceof Dr&&console.error(i.error);return this}listens(i){return!!(this._listeners&&this._listeners[i]&&this._listeners[i].length>0||this._oneTimeListeners&&this._oneTimeListeners[i]&&this._oneTimeListeners[i].length>0||this._eventedParent&&this._eventedParent.listens(i))}setEventedParent(i,c){return this._eventedParent=i,this._eventedParentData=c,this}}var Xe=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360,"units":"degrees"},"pitch":{"type":"number","default":0,"units":"degrees"},"light":{"type":"light"},"terrain":{"type":"terrain"},"fog":{"type":"fog"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":{},"mapbox":{}},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":{}}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":{}}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":{}}},"url":{"required":true,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"hillshade":{},"background":{},"sky":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],"layout_background":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","private":true,"default":0,"minimum":0,"maximum":1,"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":{},"round":{},"square":{}},"default":"butt","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":{},"round":{},"miter":{}},"default":"miter","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"requires":[{"line-join":"miter"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"requires":[{"line-join":"round"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":{},"line":{},"line-center":{}},"default":"point","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"units":"pixels","requires":[{"symbol-placement":"line"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":{},"viewport-y":{},"source":{}},"default":"auto","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"units":"factor of the original icon size","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":{},"width":{},"height":{},"both":{}},"default":"none","requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"units":"pixels","requires":["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"requires":["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"units":"ems","requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":{},"left":{},"center":{},"right":{}},"default":"center","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","units":"ems","default":0,"requires":["text-field"],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["text-field",{"!":"text-variable-anchor"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"units":"degrees","requires":["text-field",{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":{},"vertical":{}},"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"requires":["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":{},"uppercase":{},"lowercase":{}},"default":"none","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","units":"ems","length":2,"default":[0,0],"requires":["text-field",{"!":"text-radial-offset"}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"requires":["text-field","icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},"in":{},"!in":{},"all":{},"any":{},"none":{},"has":{},"!has":{},"within":{}}},"geometry_type":{"type":"enum","values":{"Point":{},"LineString":{},"Polygon":{}}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":{},"exponential":{},"interval":{},"categorical":{}},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":{},"lab":{},"hcl":{}},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":{},"viewport":{}},"property-type":"data-constant","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":{},"equalEarth":{},"equirectangular":{},"lambertConformalConic":{},"mercator":{},"naturalEarth":{},"winkelTripel":{},"globe":{}},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["source"]}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"requires":[{"!":"fill-pattern"},{"fill-antialias":true}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-extrusion-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-extrusion-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"requires":["fill-extrusion-height"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","private":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["fill-extrusion-edge-radius"]},"fill-extrusion-rounded-roof":{"type":"boolean","default":true,"requires":["fill-extrusion-edge-radius"],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"line-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["line-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"transition":false,"units":"line widths","requires":[{"!":"line-pattern"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","transition":false,"requires":[{"!":"line-pattern"},{"source":"geojson","has":{"lineMetrics":true}}],"expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"transition":false,"requires":[{"source":"geojson","has":{"lineMetrics":true}}],"property-type":"constant"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["circle-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"transition":false,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"transition":false,"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["icon-image","icon-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["text-field","text-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"units":"degrees","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":{},"nearest":{}},"default":"linear","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"transition":false,"units":"milliseconds","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"transition":false,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"background-pattern"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":{},"atmosphere":{}},"default":"atmosphere","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"requires":[{"sky-type":"atmosphere"}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","requires":[{"sky-type":"atmosphere"}],"default":10,"minimum":0,"maximum":100,"transition":false,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","requires":[{"sky-type":"gradient"}],"value":"number","default":[0,0],"length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","requires":[{"sky-type":"gradient"}],"default":90,"minimum":0,"maximum":180,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"transition":false,"requires":[{"sky-type":"gradient"}],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"transition":{"duration":{"type":"number","default":300,"minimum":0,"units":"milliseconds"},"delay":{"type":"number","default":0,"minimum":0,"units":"milliseconds"}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');function Ti(a,...i){for(const c of i)for(const d in c)a[d]=c[d];return a}function en(a){return a instanceof Number||a instanceof String||a instanceof Boolean?a.valueOf():a}function Nn(a){if(Array.isArray(a))return a.map(Nn);if(a instanceof Object&&!(a instanceof Number||a instanceof String||a instanceof Boolean)){const i={};for(const c in a)i[c]=Nn(a[c]);return i}return en(a)}class Is extends Error{constructor(i,c){super(c),this.message=c,this.key=i}}var Ni=Is;class Qa{constructor(i,c=[]){this.parent=i,this.bindings={};for(const[d,m]of c)this.bindings[d]=m}concat(i){return new Qa(this,i)}get(i){if(this.bindings[i])return this.bindings[i];if(this.parent)return this.parent.get(i);throw new Error(`${i} not found in scope.`)}has(i){return!!this.bindings[i]||!!this.parent&&this.parent.has(i)}}var Bd=Qa;const Pc={kind:"null"},Mt={kind:"number"},Er={kind:"string"},_r={kind:"boolean"},Po={kind:"color"},us={kind:"object"},xr={kind:"value"},Co={kind:"collator"},Xu={kind:"formatted"},Ml={kind:"resolvedImage"};function Fo(a,i){return{kind:"array",itemType:a,N:i}}function yn(a){if(a.kind==="array"){const i=yn(a.itemType);return typeof a.N=="number"?`array<${i}, ${a.N}>`:a.itemType.kind==="value"?"array":`array<${i}>`}return a.kind}const K_=[Pc,Mt,Er,_r,Po,Xu,us,Fo(xr),Ml];function aa(a,i){if(i.kind==="error")return null;if(a.kind==="array"){if(i.kind==="array"&&(i.N===0&&i.itemType.kind==="value"||!aa(a.itemType,i.itemType))&&(typeof a.N!="number"||a.N===i.N))return null}else{if(a.kind===i.kind)return null;if(a.kind==="value"){for(const c of K_)if(!aa(c,i))return null}}return`Expected ${yn(a)} but found ${yn(i)} instead.`}function Yu(a,i){return i.some(c=>c.kind===a.kind)}function Ju(a,i){return i.some(c=>c==="null"?a===null:c==="array"?Array.isArray(a):c==="object"?a&&!Array.isArray(a)&&typeof a=="object":c===typeof a)}var Um,Z_={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function Qu(a){return(a=Math.round(a))<0?0:a>255?255:a}function eh(a){return Qu(a[a.length-1]==="%"?parseFloat(a)/100*255:parseInt(a))}function Nd(a){return(i=a[a.length-1]==="%"?parseFloat(a)/100:parseFloat(a))<0?0:i>1?1:i;var i}function Cc(a,i,c){return c<0?c+=1:c>1&&(c-=1),6*c<1?a+(i-a)*c*6:2*c<1?i:3*c<2?a+(i-a)*(2/3-c)*6:a}try{Um={}.parseCSSColor=function(a){var i,c=a.replace(/ /g,"").toLowerCase();if(c in Z_)return Z_[c].slice();if(c[0]==="#")return c.length===4?(i=parseInt(c.substr(1),16))>=0&&i<=4095?[(3840&i)>>4|(3840&i)>>8,240&i|(240&i)>>4,15&i|(15&i)<<4,1]:null:c.length===7&&(i=parseInt(c.substr(1),16))>=0&&i<=16777215?[(16711680&i)>>16,(65280&i)>>8,255&i,1]:null;var d=c.indexOf("("),m=c.indexOf(")");if(d!==-1&&m+1===c.length){var v=c.substr(0,d),x=c.substr(d+1,m-(d+1)).split(","),T=1;switch(v){case"rgba":if(x.length!==4)return null;T=Nd(x.pop());case"rgb":return x.length!==3?null:[eh(x[0]),eh(x[1]),eh(x[2]),T];case"hsla":if(x.length!==4)return null;T=Nd(x.pop());case"hsl":if(x.length!==3)return null;var P=(parseFloat(x[0])%360+360)%360/360,C=Nd(x[1]),D=Nd(x[2]),$=D<=.5?D*(C+1):D+C-D*C,U=2*D-$;return[Qu(255*Cc(U,$,P+1/3)),Qu(255*Cc(U,$,P)),Qu(255*Cc(U,$,P-1/3)),T];default:return null}}return null}}catch{}class lo{constructor(i,c,d,m=1){this.r=i,this.g=c,this.b=d,this.a=m}static parse(i){if(!i)return;if(i instanceof lo)return i;if(typeof i!="string")return;const c=Um(i);return c?new lo(c[0]/255*c[3],c[1]/255*c[3],c[2]/255*c[3],c[3]):void 0}toString(){const[i,c,d,m]=this.toArray();return`rgba(${Math.round(i)},${Math.round(c)},${Math.round(d)},${m})`}toArray(){const{r:i,g:c,b:d,a:m}=this;return m===0?[0,0,0,0]:[255*i/m,255*c/m,255*d/m,m]}toArray01(){const{r:i,g:c,b:d,a:m}=this;return m===0?[0,0,0,0]:[i/m,c/m,d/m,m]}toArray01PremultipliedAlpha(){const{r:i,g:c,b:d,a:m}=this;return[i,c,d,m]}}lo.black=new lo(0,0,0,1),lo.white=new lo(1,1,1,1),lo.transparent=new lo(0,0,0,0),lo.red=new lo(1,0,0,1),lo.blue=new lo(0,0,1,1);var $n=lo;class Vm{constructor(i,c,d){this.sensitivity=i?c?"variant":"case":c?"accent":"base",this.locale=d,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(i,c){return this.collator.compare(i,c)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Gm{constructor(i,c,d,m,v){this.text=i.normalize?i.normalize():i,this.image=c,this.scale=d,this.fontStack=m,this.textColor=v}}class co{constructor(i){this.sections=i}static fromString(i){return new co([new Gm(i,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(i=>i.text.length!==0||i.image&&i.image.name.length!==0)}static factory(i){return i instanceof co?i:co.fromString(i)}toString(){return this.sections.length===0?"":this.sections.map(i=>i.text).join("")}serialize(){const i=["format"];for(const c of this.sections){if(c.image){i.push(["image",c.image.name]);continue}i.push(c.text);const d={};c.fontStack&&(d["text-font"]=["literal",c.fontStack.split(",")]),c.scale&&(d["font-scale"]=c.scale),c.textColor&&(d["text-color"]=["rgba"].concat(c.textColor.toArray())),i.push(d)}return i}}class Uo{constructor(i){this.name=i.name,this.available=i.available}toString(){return this.name}static fromString(i){return i?new Uo({name:i,available:!1}):null}serialize(){return["image",this.name]}}function X_(a,i,c,d){return typeof a=="number"&&a>=0&&a<=255&&typeof i=="number"&&i>=0&&i<=255&&typeof c=="number"&&c>=0&&c<=255?d===void 0||typeof d=="number"&&d>=0&&d<=1?null:`Invalid rgba value [${[a,i,c,d].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof d=="number"?[a,i,c,d]:[a,i,c]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function th(a){if(a===null||typeof a=="string"||typeof a=="boolean"||typeof a=="number"||a instanceof $n||a instanceof Vm||a instanceof co||a instanceof Uo)return!0;if(Array.isArray(a)){for(const i of a)if(!th(i))return!1;return!0}if(typeof a=="object"){for(const i in a)if(!th(a[i]))return!1;return!0}return!1}function Cn(a){if(a===null)return Pc;if(typeof a=="string")return Er;if(typeof a=="boolean")return _r;if(typeof a=="number")return Mt;if(a instanceof $n)return Po;if(a instanceof Vm)return Co;if(a instanceof co)return Xu;if(a instanceof Uo)return Ml;if(Array.isArray(a)){const i=a.length;let c;for(const d of a){const m=Cn(d);if(c){if(c===m)continue;c=xr;break}c=m}return Fo(c||xr,i)}return us}function rh(a){const i=typeof a;return a===null?"":i==="string"||i==="number"||i==="boolean"?String(a):a instanceof $n||a instanceof co||a instanceof Uo?a.toString():JSON.stringify(a)}class Wm{constructor(i,c){this.type=i,this.value=c}static parse(i,c){if(i.length!==2)return c.error(`'literal' expression requires exactly one argument, but found ${i.length-1} instead.`);if(!th(i[1]))return c.error("invalid value");const d=i[1];let m=Cn(d);const v=c.expectedType;return m.kind!=="array"||m.N!==0||!v||v.kind!=="array"||typeof v.N=="number"&&v.N!==0||(m=v),new Wm(m,d)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof $n?["rgba"].concat(this.value.toArray()):this.value instanceof co?this.value.serialize():this.value}}var Il=Wm,Ei=class{constructor(a){this.name="ExpressionEvaluationError",this.message=a}toJSON(){return this.message}};const qm={string:Er,number:Mt,boolean:_r,object:us};class Hm{constructor(i,c){this.type=i,this.args=c}static parse(i,c){if(i.length<2)return c.error("Expected at least one argument.");let d,m=1;const v=i[0];if(v==="array"){let T,P;if(i.length>2){const C=i[1];if(typeof C!="string"||!(C in qm)||C==="object")return c.error('The item type argument of "array" must be one of string, number, boolean',1);T=qm[C],m++}else T=xr;if(i.length>3){if(i[2]!==null&&(typeof i[2]!="number"||i[2]<0||i[2]!==Math.floor(i[2])))return c.error('The length argument to "array" must be a positive integer literal',2);P=i[2],m++}d=Fo(T,P)}else d=qm[v];const x=[];for(;m<i.length;m++){const T=c.parse(i[m],m,xr);if(!T)return null;x.push(T)}return new Hm(d,x)}evaluate(i){for(let c=0;c<this.args.length;c++){const d=this.args[c].evaluate(i);if(!aa(this.type,Cn(d)))return d;if(c===this.args.length-1)throw new Ei(`Expected value to be of type ${yn(this.type)}, but found ${yn(Cn(d))} instead.`)}return null}eachChild(i){this.args.forEach(i)}outputDefined(){return this.args.every(i=>i.outputDefined())}serialize(){const i=this.type,c=[i.kind];if(i.kind==="array"){const d=i.itemType;if(d.kind==="string"||d.kind==="number"||d.kind==="boolean"){c.push(d.kind);const m=i.N;(typeof m=="number"||this.args.length>1)&&c.push(m)}}return c.concat(this.args.map(d=>d.serialize()))}}var la=Hm;class el{constructor(i){this.type=Xu,this.sections=i}static parse(i,c){if(i.length<2)return c.error("Expected at least one argument.");const d=i[1];if(!Array.isArray(d)&&typeof d=="object")return c.error("First argument must be an image or text section.");const m=[];let v=!1;for(let x=1;x<=i.length-1;++x){const T=i[x];if(v&&typeof T=="object"&&!Array.isArray(T)){v=!1;let P=null;if(T["font-scale"]&&(P=c.parse(T["font-scale"],1,Mt),!P))return null;let C=null;if(T["text-font"]&&(C=c.parse(T["text-font"],1,Fo(Er)),!C))return null;let D=null;if(T["text-color"]&&(D=c.parse(T["text-color"],1,Po),!D))return null;const $=m[m.length-1];$.scale=P,$.font=C,$.textColor=D}else{const P=c.parse(i[x],1,xr);if(!P)return null;const C=P.type.kind;if(C!=="string"&&C!=="value"&&C!=="null"&&C!=="resolvedImage")return c.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");v=!0,m.push({content:P,scale:null,font:null,textColor:null})}}return new el(m)}evaluate(i){return new co(this.sections.map(c=>{const d=c.content.evaluate(i);return Cn(d)===Ml?new Gm("",d,null,null,null):new Gm(rh(d),null,c.scale?c.scale.evaluate(i):null,c.font?c.font.evaluate(i).join(","):null,c.textColor?c.textColor.evaluate(i):null)}))}eachChild(i){for(const c of this.sections)i(c.content),c.scale&&i(c.scale),c.font&&i(c.font),c.textColor&&i(c.textColor)}outputDefined(){return!1}serialize(){const i=["format"];for(const c of this.sections){i.push(c.content.serialize());const d={};c.scale&&(d["font-scale"]=c.scale.serialize()),c.font&&(d["text-font"]=c.font.serialize()),c.textColor&&(d["text-color"]=c.textColor.serialize()),i.push(d)}return i}}class $d{constructor(i){this.type=Ml,this.input=i}static parse(i,c){if(i.length!==2)return c.error("Expected two arguments.");const d=c.parse(i[1],1,Er);return d?new $d(d):c.error("No image name provided.")}evaluate(i){const c=this.input.evaluate(i),d=Uo.fromString(c);return d&&i.availableImages&&(d.available=i.availableImages.indexOf(c)>-1),d}eachChild(i){i(this.input)}outputDefined(){return!1}serialize(){return["image",this.input.serialize()]}}const zS={"to-boolean":_r,"to-color":Po,"to-number":Mt,"to-string":Er};class Km{constructor(i,c){this.type=i,this.args=c}static parse(i,c){if(i.length<2)return c.error("Expected at least one argument.");const d=i[0];if((d==="to-boolean"||d==="to-string")&&i.length!==2)return c.error("Expected one argument.");const m=zS[d],v=[];for(let x=1;x<i.length;x++){const T=c.parse(i[x],x,xr);if(!T)return null;v.push(T)}return new Km(m,v)}evaluate(i){if(this.type.kind==="boolean")return!!this.args[0].evaluate(i);if(this.type.kind==="color"){let c,d;for(const m of this.args){if(c=m.evaluate(i),d=null,c instanceof $n)return c;if(typeof c=="string"){const v=i.parseColor(c);if(v)return v}else if(Array.isArray(c)&&(d=c.length<3||c.length>4?`Invalid rbga value ${JSON.stringify(c)}: expected an array containing either three or four numeric values.`:X_(c[0],c[1],c[2],c[3]),!d))return new $n(c[0]/255,c[1]/255,c[2]/255,c[3])}throw new Ei(d||`Could not parse color from value '${typeof c=="string"?c:String(JSON.stringify(c))}'`)}if(this.type.kind==="number"){let c=null;for(const d of this.args){if(c=d.evaluate(i),c===null)return 0;const m=Number(c);if(!isNaN(m))return m}throw new Ei(`Could not convert ${JSON.stringify(c)} to number.`)}return this.type.kind==="formatted"?co.fromString(rh(this.args[0].evaluate(i))):this.type.kind==="resolvedImage"?Uo.fromString(rh(this.args[0].evaluate(i))):rh(this.args[0].evaluate(i))}eachChild(i){this.args.forEach(i)}outputDefined(){return this.args.every(i=>i.outputDefined())}serialize(){if(this.type.kind==="formatted")return new el([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new $d(this.args[0]).serialize();const i=[`to-${this.type.kind}`];return this.eachChild(c=>{i.push(c.serialize())}),i}}var kc=Km;const Rs=["Unknown","Point","LineString","Polygon"];var Zm=class{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null}id(){return this.feature&&this.feature.id!==void 0?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Rs[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const a=this.featureDistanceData.center,i=this.featureDistanceData.scale,{x:c,y:d}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(c*i-a[0])+this.featureDistanceData.bearing[1]*(d*i-a[1])}return 0}parseColor(a){let i=this._parseColorCache[a];return i||(i=this._parseColorCache[a]=$n.parse(a)),i}};class Rl{constructor(i,c,d,m){this.name=i,this.type=c,this._evaluate=d,this.args=m}evaluate(i){return this._evaluate(i,this.args)}eachChild(i){this.args.forEach(i)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(i=>i.serialize()))}static parse(i,c){const d=i[0],m=Rl.definitions[d];if(!m)return c.error(`Unknown expression "${d}". If you wanted a literal array, use ["literal", [...]].`,0);const v=Array.isArray(m)?m[0]:m.type,x=Array.isArray(m)?[[m[1],m[2]]]:m.overloads,T=x.filter(([C])=>!Array.isArray(C)||C.length===i.length-1);let P=null;for(const[C,D]of T){P=new tg(c.registry,c.path,null,c.scope);const $=[];let U=!1;for(let q=1;q<i.length;q++){const K=i[q],Q=Array.isArray(C)?C[q-1]:C.type,oe=P.parse(K,1+$.length,Q);if(!oe){U=!0;break}$.push(oe)}if(!U)if(Array.isArray(C)&&C.length!==$.length)P.error(`Expected ${C.length} arguments, but found ${$.length} instead.`);else{for(let q=0;q<$.length;q++){const K=Array.isArray(C)?C[q]:C.type,Q=$[q];P.concat(q+1).checkSubtype(K,Q.type)}if(P.errors.length===0)return new Rl(d,v,D,$)}}if(T.length===1)c.errors.push(...P.errors);else{const C=(T.length?T:x).map(([$])=>{return U=$,Array.isArray(U)?`(${U.map(yn).join(", ")})`:`(${yn(U.type)}...)`;var U}).join(" | "),D=[];for(let $=1;$<i.length;$++){const U=c.parse(i[$],1+D.length);if(!U)return null;D.push(yn(U.type))}c.error(`Expected arguments of type ${C}, but found (${D.join(", ")}) instead.`)}return null}static register(i,c){Rl.definitions=c;for(const d in c)i[d]=Rl}}var ca=Rl;class nh{constructor(i,c,d){this.type=Co,this.locale=d,this.caseSensitive=i,this.diacriticSensitive=c}static parse(i,c){if(i.length!==2)return c.error("Expected one argument.");const d=i[1];if(typeof d!="object"||Array.isArray(d))return c.error("Collator options argument must be an object.");const m=c.parse(d["case-sensitive"]!==void 0&&d["case-sensitive"],1,_r);if(!m)return null;const v=c.parse(d["diacritic-sensitive"]!==void 0&&d["diacritic-sensitive"],1,_r);if(!v)return null;let x=null;return d.locale&&(x=c.parse(d.locale,1,Er),!x)?null:new nh(m,v,x)}evaluate(i){return new Vm(this.caseSensitive.evaluate(i),this.diacriticSensitive.evaluate(i),this.locale?this.locale.evaluate(i):null)}eachChild(i){i(this.caseSensitive),i(this.diacriticSensitive),this.locale&&i(this.locale)}outputDefined(){return!1}serialize(){const i={};return i["case-sensitive"]=this.caseSensitive.serialize(),i["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(i.locale=this.locale.serialize()),["collator",i]}}const ua=8192;function Fd(a,i){a[0]=Math.min(a[0],i[0]),a[1]=Math.min(a[1],i[1]),a[2]=Math.max(a[2],i[0]),a[3]=Math.max(a[3],i[1])}function Oc(a,i){return!(a[0]<=i[0]||a[2]>=i[2]||a[1]<=i[1]||a[3]>=i[3])}function ih(a,i){const c=(180+a[0])/360,d=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+a[1]*Math.PI/360)))/360,m=Math.pow(2,i.z);return[Math.round(c*m*ua),Math.round(d*m*ua)]}function Y_(a,i,c){const d=a[0]-i[0],m=a[1]-i[1],v=a[0]-c[0],x=a[1]-c[1];return d*x-v*m==0&&d*v<=0&&m*x<=0}function Ud(a,i){let c=!1;for(let x=0,T=i.length;x<T;x++){const P=i[x];for(let C=0,D=P.length;C<D-1;C++){if(Y_(a,P[C],P[C+1]))return!1;(m=P[C])[1]>(d=a)[1]!=(v=P[C+1])[1]>d[1]&&d[0]<(v[0]-m[0])*(d[1]-m[1])/(v[1]-m[1])+m[0]&&(c=!c)}}var d,m,v;return c}function Xm(a,i){for(let c=0;c<i.length;c++)if(Ud(a,i[c]))return!0;return!1}function Ym(a,i,c,d){const m=d[0]-c[0],v=d[1]-c[1],x=(a[0]-c[0])*v-m*(a[1]-c[1]),T=(i[0]-c[0])*v-m*(i[1]-c[1]);return x>0&&T<0||x<0&&T>0}function Mc(a,i,c){for(const C of c)for(let D=0;D<C.length-1;++D)if((T=[(x=C[D+1])[0]-(v=C[D])[0],x[1]-v[1]])[0]*(P=[(m=i)[0]-(d=a)[0],m[1]-d[1]])[1]-T[1]*P[0]!=0&&Ym(d,m,v,x)&&Ym(v,x,d,m))return!0;var d,m,v,x,T,P;return!1}function Nr(a,i){for(let c=0;c<a.length;++c)if(!Ud(a[c],i))return!1;for(let c=0;c<a.length-1;++c)if(Mc(a[c],a[c+1],i))return!1;return!0}function BS(a,i){for(let c=0;c<i.length;c++)if(Nr(a,i[c]))return!0;return!1}function Jm(a,i,c){const d=[];for(let m=0;m<a.length;m++){const v=[];for(let x=0;x<a[m].length;x++){const T=ih(a[m][x],c);Fd(i,T),v.push(T)}d.push(v)}return d}function J_(a,i,c){const d=[];for(let m=0;m<a.length;m++){const v=Jm(a[m],i,c);d.push(v)}return d}function Qm(a,i,c,d){if(a[0]<c[0]||a[0]>c[2]){const m=.5*d;let v=a[0]-c[0]>m?-d:c[0]-a[0]>m?d:0;v===0&&(v=a[0]-c[2]>m?-d:c[2]-a[0]>m?d:0),a[0]+=v}Fd(i,a)}function Q_(a,i,c,d){const m=Math.pow(2,d.z)*ua,v=[d.x*ua,d.y*ua],x=[];if(!a)return x;for(const T of a)for(const P of T){const C=[P.x+v[0],P.y+v[1]];Qm(C,i,c,m),x.push(C)}return x}function eg(a,i,c,d){const m=Math.pow(2,d.z)*ua,v=[d.x*ua,d.y*ua],x=[];if(!a)return x;for(const P of a){const C=[];for(const D of P){const $=[D.x+v[0],D.y+v[1]];Fd(i,$),C.push($)}x.push(C)}if(i[2]-i[0]<=m/2){(T=i)[0]=T[1]=1/0,T[2]=T[3]=-1/0;for(const P of x)for(const C of P)Qm(C,i,c,m)}var T;return x}class Ic{constructor(i,c){this.type=_r,this.geojson=i,this.geometries=c}static parse(i,c){if(i.length!==2)return c.error(`'within' expression requires exactly one argument, but found ${i.length-1} instead.`);if(th(i[1])){const d=i[1];if(d.type==="FeatureCollection")for(let m=0;m<d.features.length;++m){const v=d.features[m].geometry.type;if(v==="Polygon"||v==="MultiPolygon")return new Ic(d,d.features[m].geometry)}else if(d.type==="Feature"){const m=d.geometry.type;if(m==="Polygon"||m==="MultiPolygon")return new Ic(d,d.geometry)}else if(d.type==="Polygon"||d.type==="MultiPolygon")return new Ic(d,d)}return c.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(i){if(i.geometry()!=null&&i.canonicalID()!=null){if(i.geometryType()==="Point")return function(c,d){const m=[1/0,1/0,-1/0,-1/0],v=[1/0,1/0,-1/0,-1/0],x=c.canonicalID();if(!x)return!1;if(d.type==="Polygon"){const T=Jm(d.coordinates,v,x),P=Q_(c.geometry(),m,v,x);if(!Oc(m,v))return!1;for(const C of P)if(!Ud(C,T))return!1}if(d.type==="MultiPolygon"){const T=J_(d.coordinates,v,x),P=Q_(c.geometry(),m,v,x);if(!Oc(m,v))return!1;for(const C of P)if(!Xm(C,T))return!1}return!0}(i,this.geometries);if(i.geometryType()==="LineString")return function(c,d){const m=[1/0,1/0,-1/0,-1/0],v=[1/0,1/0,-1/0,-1/0],x=c.canonicalID();if(!x)return!1;if(d.type==="Polygon"){const T=Jm(d.coordinates,v,x),P=eg(c.geometry(),m,v,x);if(!Oc(m,v))return!1;for(const C of P)if(!Nr(C,T))return!1}if(d.type==="MultiPolygon"){const T=J_(d.coordinates,v,x),P=eg(c.geometry(),m,v,x);if(!Oc(m,v))return!1;for(const C of P)if(!BS(C,T))return!1}return!0}(i,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}var Vd=Ic;function Rc(a){if(a instanceof ca&&(a.name==="get"&&a.args.length===1||a.name==="feature-state"||a.name==="has"&&a.args.length===1||a.name==="properties"||a.name==="geometry-type"||a.name==="id"||/^filter-/.test(a.name))||a instanceof Vd)return!1;let i=!0;return a.eachChild(c=>{i&&!Rc(c)&&(i=!1)}),i}function ha(a){if(a instanceof ca&&a.name==="feature-state")return!1;let i=!0;return a.eachChild(c=>{i&&!ha(c)&&(i=!1)}),i}function Dl(a,i){if(a instanceof ca&&i.indexOf(a.name)>=0)return!1;let c=!0;return a.eachChild(d=>{c&&!Dl(d,i)&&(c=!1)}),c}class Gd{constructor(i,c){this.type=c.type,this.name=i,this.boundExpression=c}static parse(i,c){if(i.length!==2||typeof i[1]!="string")return c.error("'var' expression requires exactly one string literal argument.");const d=i[1];return c.scope.has(d)?new Gd(d,c.scope.get(d)):c.error(`Unknown variable "${d}". Make sure "${d}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(i){return this.boundExpression.evaluate(i)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}var e0=Gd;class oh{constructor(i,c=[],d,m=new Bd,v=[]){this.registry=i,this.path=c,this.key=c.map(x=>`[${x}]`).join(""),this.scope=m,this.errors=v,this.expectedType=d}parse(i,c,d,m,v={}){return c?this.concat(c,d,m)._parse(i,v):this._parse(i,v)}_parse(i,c){function d(m,v,x){return x==="assert"?new la(v,[m]):x==="coerce"?new kc(v,[m]):m}if(i!==null&&typeof i!="string"&&typeof i!="boolean"&&typeof i!="number"||(i=["literal",i]),Array.isArray(i)){if(i.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const m=i[0];if(typeof m!="string")return this.error(`Expression name must be a string, but found ${typeof m} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const v=this.registry[m];if(v){let x=v.parse(i,this);if(!x)return null;if(this.expectedType){const T=this.expectedType,P=x.type;if(T.kind!=="string"&&T.kind!=="number"&&T.kind!=="boolean"&&T.kind!=="object"&&T.kind!=="array"||P.kind!=="value")if(T.kind!=="color"&&T.kind!=="formatted"&&T.kind!=="resolvedImage"||P.kind!=="value"&&P.kind!=="string"){if(this.checkSubtype(T,P))return null}else x=d(x,T,c.typeAnnotation||"coerce");else x=d(x,T,c.typeAnnotation||"assert")}if(!(x instanceof Il)&&x.type.kind!=="resolvedImage"&&rg(x)){const T=new Zm;try{x=new Il(x.type,x.evaluate(T))}catch(P){return this.error(P.message),null}}return x}return this.error(`Unknown expression "${m}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(i===void 0?"'undefined' value invalid. Use null instead.":typeof i=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof i} instead.`)}concat(i,c,d){const m=typeof i=="number"?this.path.concat(i):this.path,v=d?this.scope.concat(d):this.scope;return new oh(this.registry,m,c||null,v,this.errors)}error(i,...c){const d=`${this.key}${c.map(m=>`[${m}]`).join("")}`;this.errors.push(new Ni(d,i))}checkSubtype(i,c){const d=aa(i,c);return d&&this.error(d),d}}var tg=oh;function rg(a){if(a instanceof e0)return rg(a.boundExpression);if(a instanceof ca&&a.name==="error"||a instanceof nh||a instanceof Vd)return!1;const i=a instanceof kc||a instanceof la;let c=!0;return a.eachChild(d=>{c=i?c&&rg(d):c&&d instanceof Il}),!!c&&Rc(a)&&Dl(a,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center"])}function Wd(a,i){const c=a.length-1;let d,m,v=0,x=c,T=0;for(;v<=x;)if(T=Math.floor((v+x)/2),d=a[T],m=a[T+1],d<=i){if(T===c||i<m)return T;v=T+1}else{if(!(d>i))throw new Ei("Input is not a number.");x=T-1}return 0}class qd{constructor(i,c,d){this.type=i,this.input=c,this.labels=[],this.outputs=[];for(const[m,v]of d)this.labels.push(m),this.outputs.push(v)}static parse(i,c){if(i.length-1<4)return c.error(`Expected at least 4 arguments, but found only ${i.length-1}.`);if((i.length-1)%2!=0)return c.error("Expected an even number of arguments.");const d=c.parse(i[1],1,Mt);if(!d)return null;const m=[];let v=null;c.expectedType&&c.expectedType.kind!=="value"&&(v=c.expectedType);for(let x=1;x<i.length;x+=2){const T=x===1?-1/0:i[x],P=i[x+1],C=x,D=x+1;if(typeof T!="number")return c.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',C);if(m.length&&m[m.length-1][0]>=T)return c.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',C);const $=c.parse(P,D,v);if(!$)return null;v=v||$.type,m.push([T,$])}return new qd(v,d,m)}evaluate(i){const c=this.labels,d=this.outputs;if(c.length===1)return d[0].evaluate(i);const m=this.input.evaluate(i);if(m<=c[0])return d[0].evaluate(i);const v=c.length;return m>=c[v-1]?d[v-1].evaluate(i):d[Wd(c,m)].evaluate(i)}eachChild(i){i(this.input);for(const c of this.outputs)i(c)}outputDefined(){return this.outputs.every(i=>i.outputDefined())}serialize(){const i=["step",this.input.serialize()];for(let c=0;c<this.labels.length;c++)c>0&&i.push(this.labels[c]),i.push(this.outputs[c].serialize());return i}}var ng=qd;function Or(a,i,c){return a*(1-c)+i*c}var sh=Object.freeze({__proto__:null,array:function(a,i,c){return a.map((d,m)=>Or(d,i[m],c))},color:function(a,i,c){return new $n(Or(a.r,i.r,c),Or(a.g,i.g,c),Or(a.b,i.b,c),Or(a.a,i.a,c))},number:Or});const t0=.95047,ig=1.08883,r0=4/29,Ll=6/29,og=3*Ll*Ll,NS=Ll*Ll*Ll,$S=Math.PI/180,FS=180/Math.PI;function sg(a){return a>NS?Math.pow(a,1/3):a/og+r0}function ag(a){return a>Ll?a*a*a:og*(a-r0)}function lg(a){return 255*(a<=.0031308?12.92*a:1.055*Math.pow(a,1/2.4)-.055)}function Hd(a){return(a/=255)<=.04045?a/12.92:Math.pow((a+.055)/1.055,2.4)}function n0(a){const i=Hd(a.r),c=Hd(a.g),d=Hd(a.b),m=sg((.4124564*i+.3575761*c+.1804375*d)/t0),v=sg((.2126729*i+.7151522*c+.072175*d)/1);return{l:116*v-16,a:500*(m-v),b:200*(v-sg((.0193339*i+.119192*c+.9503041*d)/ig)),alpha:a.a}}function i0(a){let i=(a.l+16)/116,c=isNaN(a.a)?i:i+a.a/500,d=isNaN(a.b)?i:i-a.b/200;return i=1*ag(i),c=t0*ag(c),d=ig*ag(d),new $n(lg(3.2404542*c-1.5371385*i-.4985314*d),lg(-.969266*c+1.8760108*i+.041556*d),lg(.0556434*c-.2040259*i+1.0572252*d),a.alpha)}function US(a,i,c){const d=i-a;return a+c*(d>180||d<-180?d-360*Math.round(d/360):d)}const ah={forward:n0,reverse:i0,interpolate:function(a,i,c){return{l:Or(a.l,i.l,c),a:Or(a.a,i.a,c),b:Or(a.b,i.b,c),alpha:Or(a.alpha,i.alpha,c)}}},Dc={forward:function(a){const{l:i,a:c,b:d}=n0(a),m=Math.atan2(d,c)*FS;return{h:m<0?m+360:m,c:Math.sqrt(c*c+d*d),l:i,alpha:a.a}},reverse:function(a){const i=a.h*$S,c=a.c;return i0({l:a.l,a:Math.cos(i)*c,b:Math.sin(i)*c,alpha:a.alpha})},interpolate:function(a,i,c){return{h:US(a.h,i.h,c),c:Or(a.c,i.c,c),l:Or(a.l,i.l,c),alpha:Or(a.alpha,i.alpha,c)}}};var cg=Object.freeze({__proto__:null,hcl:Dc,lab:ah});class lh{constructor(i,c,d,m,v){this.type=i,this.operator=c,this.interpolation=d,this.input=m,this.labels=[],this.outputs=[];for(const[x,T]of v)this.labels.push(x),this.outputs.push(T)}static interpolationFactor(i,c,d,m){let v=0;if(i.name==="exponential")v=ug(c,i.base,d,m);else if(i.name==="linear")v=ug(c,1,d,m);else if(i.name==="cubic-bezier"){const x=i.controlPoints;v=new Y(x[0],x[1],x[2],x[3]).solve(ug(c,1,d,m))}return v}static parse(i,c){let[d,m,v,...x]=i;if(!Array.isArray(m)||m.length===0)return c.error("Expected an interpolation type expression.",1);if(m[0]==="linear")m={name:"linear"};else if(m[0]==="exponential"){const C=m[1];if(typeof C!="number")return c.error("Exponential interpolation requires a numeric base.",1,1);m={name:"exponential",base:C}}else{if(m[0]!=="cubic-bezier")return c.error(`Unknown interpolation type ${String(m[0])}`,1,0);{const C=m.slice(1);if(C.length!==4||C.some(D=>typeof D!="number"||D<0||D>1))return c.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);m={name:"cubic-bezier",controlPoints:C}}}if(i.length-1<4)return c.error(`Expected at least 4 arguments, but found only ${i.length-1}.`);if((i.length-1)%2!=0)return c.error("Expected an even number of arguments.");if(v=c.parse(v,2,Mt),!v)return null;const T=[];let P=null;d==="interpolate-hcl"||d==="interpolate-lab"?P=Po:c.expectedType&&c.expectedType.kind!=="value"&&(P=c.expectedType);for(let C=0;C<x.length;C+=2){const D=x[C],$=x[C+1],U=C+3,q=C+4;if(typeof D!="number")return c.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',U);if(T.length&&T[T.length-1][0]>=D)return c.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',U);const K=c.parse($,q,P);if(!K)return null;P=P||K.type,T.push([D,K])}return P.kind==="number"||P.kind==="color"||P.kind==="array"&&P.itemType.kind==="number"&&typeof P.N=="number"?new lh(P,d,m,v,T):c.error(`Type ${yn(P)} is not interpolatable.`)}evaluate(i){const c=this.labels,d=this.outputs;if(c.length===1)return d[0].evaluate(i);const m=this.input.evaluate(i);if(m<=c[0])return d[0].evaluate(i);const v=c.length;if(m>=c[v-1])return d[v-1].evaluate(i);const x=Wd(c,m),T=lh.interpolationFactor(this.interpolation,m,c[x],c[x+1]),P=d[x].evaluate(i),C=d[x+1].evaluate(i);return this.operator==="interpolate"?sh[this.type.kind.toLowerCase()](P,C,T):this.operator==="interpolate-hcl"?Dc.reverse(Dc.interpolate(Dc.forward(P),Dc.forward(C),T)):ah.reverse(ah.interpolate(ah.forward(P),ah.forward(C),T))}eachChild(i){i(this.input);for(const c of this.outputs)i(c)}outputDefined(){return this.outputs.every(i=>i.outputDefined())}serialize(){let i;i=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const c=[this.operator,i,this.input.serialize()];for(let d=0;d<this.labels.length;d++)c.push(this.labels[d],this.outputs[d].serialize());return c}}function ug(a,i,c,d){const m=d-c,v=a-c;return m===0?0:i===1?v/m:(Math.pow(i,v)-1)/(Math.pow(i,m)-1)}var Ds=lh;class Kd{constructor(i,c){this.type=i,this.args=c}static parse(i,c){if(i.length<2)return c.error("Expectected at least one argument.");let d=null;const m=c.expectedType;m&&m.kind!=="value"&&(d=m);const v=[];for(const T of i.slice(1)){const P=c.parse(T,1+v.length,d,void 0,{typeAnnotation:"omit"});if(!P)return null;d=d||P.type,v.push(P)}const x=m&&v.some(T=>aa(m,T.type));return new Kd(x?xr:d,v)}evaluate(i){let c,d=null,m=0;for(const v of this.args){if(m++,d=v.evaluate(i),d&&d instanceof Uo&&!d.available&&(c||(c=d),d=null,m===this.args.length))return c;if(d!==null)break}return d}eachChild(i){this.args.forEach(i)}outputDefined(){return this.args.every(i=>i.outputDefined())}serialize(){const i=["coalesce"];return this.eachChild(c=>{i.push(c.serialize())}),i}}var hg=Kd;class Zd{constructor(i,c){this.type=c.type,this.bindings=[].concat(i),this.result=c}evaluate(i){return this.result.evaluate(i)}eachChild(i){for(const c of this.bindings)i(c[1]);i(this.result)}static parse(i,c){if(i.length<4)return c.error(`Expected at least 3 arguments, but found ${i.length-1} instead.`);const d=[];for(let v=1;v<i.length-1;v+=2){const x=i[v];if(typeof x!="string")return c.error(`Expected string, but found ${typeof x} instead.`,v);if(/[^a-zA-Z0-9_]/.test(x))return c.error("Variable names must contain only alphanumeric characters or '_'.",v);const T=c.parse(i[v+1],v+1);if(!T)return null;d.push([x,T])}const m=c.parse(i[i.length-1],i.length-1,c.expectedType,d);return m?new Zd(d,m):null}outputDefined(){return this.result.outputDefined()}serialize(){const i=["let"];for(const[c,d]of this.bindings)i.push(c,d.serialize());return i.push(this.result.serialize()),i}}var o0=Zd;class dg{constructor(i,c,d){this.type=i,this.index=c,this.input=d}static parse(i,c){if(i.length!==3)return c.error(`Expected 2 arguments, but found ${i.length-1} instead.`);const d=c.parse(i[1],1,Mt),m=c.parse(i[2],2,Fo(c.expectedType||xr));return d&&m?new dg(m.type.itemType,d,m):null}evaluate(i){const c=this.index.evaluate(i),d=this.input.evaluate(i);if(c<0)throw new Ei(`Array index out of bounds: ${c} < 0.`);if(c>=d.length)throw new Ei(`Array index out of bounds: ${c} > ${d.length-1}.`);if(c!==Math.floor(c))throw new Ei(`Array index must be an integer, but found ${c} instead.`);return d[c]}eachChild(i){i(this.index),i(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}var VS=dg;class fg{constructor(i,c){this.type=_r,this.needle=i,this.haystack=c}static parse(i,c){if(i.length!==3)return c.error(`Expected 2 arguments, but found ${i.length-1} instead.`);const d=c.parse(i[1],1,xr),m=c.parse(i[2],2,xr);return d&&m?Yu(d.type,[_r,Er,Mt,Pc,xr])?new fg(d,m):c.error(`Expected first argument to be of type boolean, string, number or null, but found ${yn(d.type)} instead`):null}evaluate(i){const c=this.needle.evaluate(i),d=this.haystack.evaluate(i);if(d==null)return!1;if(!Ju(c,["boolean","string","number","null"]))throw new Ei(`Expected first argument to be of type boolean, string, number or null, but found ${yn(Cn(c))} instead.`);if(!Ju(d,["string","array"]))throw new Ei(`Expected second argument to be of type array or string, but found ${yn(Cn(d))} instead.`);return d.indexOf(c)>=0}eachChild(i){i(this.needle),i(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}var Xd=fg;class ch{constructor(i,c,d){this.type=Mt,this.needle=i,this.haystack=c,this.fromIndex=d}static parse(i,c){if(i.length<=2||i.length>=5)return c.error(`Expected 3 or 4 arguments, but found ${i.length-1} instead.`);const d=c.parse(i[1],1,xr),m=c.parse(i[2],2,xr);if(!d||!m)return null;if(!Yu(d.type,[_r,Er,Mt,Pc,xr]))return c.error(`Expected first argument to be of type boolean, string, number or null, but found ${yn(d.type)} instead`);if(i.length===4){const v=c.parse(i[3],3,Mt);return v?new ch(d,m,v):null}return new ch(d,m)}evaluate(i){const c=this.needle.evaluate(i),d=this.haystack.evaluate(i);if(!Ju(c,["boolean","string","number","null"]))throw new Ei(`Expected first argument to be of type boolean, string, number or null, but found ${yn(Cn(c))} instead.`);if(!Ju(d,["string","array"]))throw new Ei(`Expected second argument to be of type array or string, but found ${yn(Cn(d))} instead.`);if(this.fromIndex){const m=this.fromIndex.evaluate(i);return d.indexOf(c,m)}return d.indexOf(c)}eachChild(i){i(this.needle),i(this.haystack),this.fromIndex&&i(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const i=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),i]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}var s0=ch;class pg{constructor(i,c,d,m,v,x){this.inputType=i,this.type=c,this.input=d,this.cases=m,this.outputs=v,this.otherwise=x}static parse(i,c){if(i.length<5)return c.error(`Expected at least 4 arguments, but found only ${i.length-1}.`);if(i.length%2!=1)return c.error("Expected an even number of arguments.");let d,m;c.expectedType&&c.expectedType.kind!=="value"&&(m=c.expectedType);const v={},x=[];for(let C=2;C<i.length-1;C+=2){let D=i[C];const $=i[C+1];Array.isArray(D)||(D=[D]);const U=c.concat(C);if(D.length===0)return U.error("Expected at least one branch label.");for(const K of D){if(typeof K!="number"&&typeof K!="string")return U.error("Branch labels must be numbers or strings.");if(typeof K=="number"&&Math.abs(K)>Number.MAX_SAFE_INTEGER)return U.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof K=="number"&&Math.floor(K)!==K)return U.error("Numeric branch labels must be integer values.");if(d){if(U.checkSubtype(d,Cn(K)))return null}else d=Cn(K);if(v[String(K)]!==void 0)return U.error("Branch labels must be unique.");v[String(K)]=x.length}const q=c.parse($,C,m);if(!q)return null;m=m||q.type,x.push(q)}const T=c.parse(i[1],1,xr);if(!T)return null;const P=c.parse(i[i.length-1],i.length-1,m);return P?T.type.kind!=="value"&&c.concat(1).checkSubtype(d,T.type)?null:new pg(d,m,T,v,x,P):null}evaluate(i){const c=this.input.evaluate(i);return(Cn(c)===this.inputType&&this.outputs[this.cases[c]]||this.otherwise).evaluate(i)}eachChild(i){i(this.input),this.outputs.forEach(i),i(this.otherwise)}outputDefined(){return this.outputs.every(i=>i.outputDefined())&&this.otherwise.outputDefined()}serialize(){const i=["match",this.input.serialize()],c=Object.keys(this.cases).sort(),d=[],m={};for(const x of c){const T=m[this.cases[x]];T===void 0?(m[this.cases[x]]=d.length,d.push([this.cases[x],[x]])):d[T][1].push(x)}const v=x=>this.inputType.kind==="number"?Number(x):x;for(const[x,T]of d)i.push(T.length===1?v(T[0]):T.map(v)),i.push(this.outputs[x].serialize());return i.push(this.otherwise.serialize()),i}}var GS=pg;class mg{constructor(i,c,d){this.type=i,this.branches=c,this.otherwise=d}static parse(i,c){if(i.length<4)return c.error(`Expected at least 3 arguments, but found only ${i.length-1}.`);if(i.length%2!=0)return c.error("Expected an odd number of arguments.");let d;c.expectedType&&c.expectedType.kind!=="value"&&(d=c.expectedType);const m=[];for(let x=1;x<i.length-1;x+=2){const T=c.parse(i[x],x,_r);if(!T)return null;const P=c.parse(i[x+1],x+1,d);if(!P)return null;m.push([T,P]),d=d||P.type}const v=c.parse(i[i.length-1],i.length-1,d);return v?new mg(d,m,v):null}evaluate(i){for(const[c,d]of this.branches)if(c.evaluate(i))return d.evaluate(i);return this.otherwise.evaluate(i)}eachChild(i){for(const[c,d]of this.branches)i(c),i(d);i(this.otherwise)}outputDefined(){return this.branches.every(([i,c])=>c.outputDefined())&&this.otherwise.outputDefined()}serialize(){const i=["case"];return this.eachChild(c=>{i.push(c.serialize())}),i}}var a0=mg;class uh{constructor(i,c,d,m){this.type=i,this.input=c,this.beginIndex=d,this.endIndex=m}static parse(i,c){if(i.length<=2||i.length>=5)return c.error(`Expected 3 or 4 arguments, but found ${i.length-1} instead.`);const d=c.parse(i[1],1,xr),m=c.parse(i[2],2,Mt);if(!d||!m)return null;if(!Yu(d.type,[Fo(xr),Er,xr]))return c.error(`Expected first argument to be of type array or string, but found ${yn(d.type)} instead`);if(i.length===4){const v=c.parse(i[3],3,Mt);return v?new uh(d.type,d,m,v):null}return new uh(d.type,d,m)}evaluate(i){const c=this.input.evaluate(i),d=this.beginIndex.evaluate(i);if(!Ju(c,["string","array"]))throw new Ei(`Expected first argument to be of type array or string, but found ${yn(Cn(c))} instead.`);if(this.endIndex){const m=this.endIndex.evaluate(i);return c.slice(d,m)}return c.slice(d)}eachChild(i){i(this.input),i(this.beginIndex),this.endIndex&&i(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const i=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),i]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}var l0=uh;function Yd(a,i){return a==="=="||a==="!="?i.kind==="boolean"||i.kind==="string"||i.kind==="number"||i.kind==="null"||i.kind==="value":i.kind==="string"||i.kind==="number"||i.kind==="value"}function c0(a,i,c,d){return d.compare(i,c)===0}function Lc(a,i,c){const d=a!=="=="&&a!=="!=";return class N8{constructor(v,x,T){this.type=_r,this.lhs=v,this.rhs=x,this.collator=T,this.hasUntypedArgument=v.type.kind==="value"||x.type.kind==="value"}static parse(v,x){if(v.length!==3&&v.length!==4)return x.error("Expected two or three arguments.");const T=v[0];let P=x.parse(v[1],1,xr);if(!P)return null;if(!Yd(T,P.type))return x.concat(1).error(`"${T}" comparisons are not supported for type '${yn(P.type)}'.`);let C=x.parse(v[2],2,xr);if(!C)return null;if(!Yd(T,C.type))return x.concat(2).error(`"${T}" comparisons are not supported for type '${yn(C.type)}'.`);if(P.type.kind!==C.type.kind&&P.type.kind!=="value"&&C.type.kind!=="value")return x.error(`Cannot compare types '${yn(P.type)}' and '${yn(C.type)}'.`);d&&(P.type.kind==="value"&&C.type.kind!=="value"?P=new la(C.type,[P]):P.type.kind!=="value"&&C.type.kind==="value"&&(C=new la(P.type,[C])));let D=null;if(v.length===4){if(P.type.kind!=="string"&&C.type.kind!=="string"&&P.type.kind!=="value"&&C.type.kind!=="value")return x.error("Cannot use collator to compare non-string types.");if(D=x.parse(v[3],3,Co),!D)return null}return new N8(P,C,D)}evaluate(v){const x=this.lhs.evaluate(v),T=this.rhs.evaluate(v);if(d&&this.hasUntypedArgument){const P=Cn(x),C=Cn(T);if(P.kind!==C.kind||P.kind!=="string"&&P.kind!=="number")throw new Ei(`Expected arguments for "${a}" to be (string, string) or (number, number), but found (${P.kind}, ${C.kind}) instead.`)}if(this.collator&&!d&&this.hasUntypedArgument){const P=Cn(x),C=Cn(T);if(P.kind!=="string"||C.kind!=="string")return i(v,x,T)}return this.collator?c(v,x,T,this.collator.evaluate(v)):i(v,x,T)}eachChild(v){v(this.lhs),v(this.rhs),this.collator&&v(this.collator)}outputDefined(){return!0}serialize(){const v=[a];return this.eachChild(x=>{v.push(x.serialize())}),v}}}const WS=Lc("==",function(a,i,c){return i===c},c0),qS=Lc("!=",function(a,i,c){return i!==c},function(a,i,c,d){return!c0(0,i,c,d)}),HS=Lc("<",function(a,i,c){return i<c},function(a,i,c,d){return d.compare(i,c)<0}),KS=Lc(">",function(a,i,c){return i>c},function(a,i,c,d){return d.compare(i,c)>0}),ZS=Lc("<=",function(a,i,c){return i<=c},function(a,i,c,d){return d.compare(i,c)<=0}),u0=Lc(">=",function(a,i,c){return i>=c},function(a,i,c,d){return d.compare(i,c)>=0});class Jd{constructor(i,c,d,m,v,x){this.type=Er,this.number=i,this.locale=c,this.currency=d,this.unit=m,this.minFractionDigits=v,this.maxFractionDigits=x}static parse(i,c){if(i.length!==3)return c.error("Expected two arguments.");const d=c.parse(i[1],1,Mt);if(!d)return null;const m=i[2];if(typeof m!="object"||Array.isArray(m))return c.error("NumberFormat options argument must be an object.");let v=null;if(m.locale&&(v=c.parse(m.locale,1,Er),!v))return null;let x=null;if(m.currency&&(x=c.parse(m.currency,1,Er),!x))return null;let T=null;if(m.unit&&(T=c.parse(m.unit,1,Er),!T))return null;let P=null;if(m["min-fraction-digits"]&&(P=c.parse(m["min-fraction-digits"],1,Mt),!P))return null;let C=null;return m["max-fraction-digits"]&&(C=c.parse(m["max-fraction-digits"],1,Mt),!C)?null:new Jd(d,v,x,T,P,C)}evaluate(i){return new Intl.NumberFormat(this.locale?this.locale.evaluate(i):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(i):void 0,unit:this.unit?this.unit.evaluate(i):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(i):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(i):void 0}).format(this.number.evaluate(i))}eachChild(i){i(this.number),this.locale&&i(this.locale),this.currency&&i(this.currency),this.unit&&i(this.unit),this.minFractionDigits&&i(this.minFractionDigits),this.maxFractionDigits&&i(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const i={};return this.locale&&(i.locale=this.locale.serialize()),this.currency&&(i.currency=this.currency.serialize()),this.unit&&(i.unit=this.unit.serialize()),this.minFractionDigits&&(i["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(i["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),i]}}class jc{constructor(i){this.type=Mt,this.input=i}static parse(i,c){if(i.length!==2)return c.error(`Expected 1 argument, but found ${i.length-1} instead.`);const d=c.parse(i[1],1);return d?d.type.kind!=="array"&&d.type.kind!=="string"&&d.type.kind!=="value"?c.error(`Expected argument of type string or array, but found ${yn(d.type)} instead.`):new jc(d):null}evaluate(i){const c=this.input.evaluate(i);if(typeof c=="string"||Array.isArray(c))return c.length;throw new Ei(`Expected value to be of type string or array, but found ${yn(Cn(c))} instead.`)}eachChild(i){i(this.input)}outputDefined(){return!1}serialize(){const i=["length"];return this.eachChild(c=>{i.push(c.serialize())}),i}}const h0={"==":WS,"!=":qS,">":KS,"<":HS,">=":u0,"<=":ZS,array:la,at:VS,boolean:la,case:a0,coalesce:hg,collator:nh,format:el,image:$d,in:Xd,"index-of":s0,interpolate:Ds,"interpolate-hcl":Ds,"interpolate-lab":Ds,length:jc,let:o0,literal:Il,match:GS,number:la,"number-format":Jd,object:la,slice:l0,step:ng,string:la,"to-boolean":kc,"to-color":kc,"to-number":kc,"to-string":kc,var:e0,within:Vd};function d0(a,[i,c,d,m]){i=i.evaluate(a),c=c.evaluate(a),d=d.evaluate(a);const v=m?m.evaluate(a):1,x=X_(i,c,d,v);if(x)throw new Ei(x);return new $n(i/255*v,c/255*v,d/255*v,v)}function da(a,i){return a in i}function Qd(a,i){const c=i[a];return c===void 0?null:c}function Vo(a){return{type:a}}ca.register(h0,{error:[{kind:"error"},[Er],(a,[i])=>{throw new Ei(i.evaluate(a))}],typeof:[Er,[xr],(a,[i])=>yn(Cn(i.evaluate(a)))],"to-rgba":[Fo(Mt,4),[Po],(a,[i])=>i.evaluate(a).toArray()],rgb:[Po,[Mt,Mt,Mt],d0],rgba:[Po,[Mt,Mt,Mt,Mt],d0],has:{type:_r,overloads:[[[Er],(a,[i])=>da(i.evaluate(a),a.properties())],[[Er,us],(a,[i,c])=>da(i.evaluate(a),c.evaluate(a))]]},get:{type:xr,overloads:[[[Er],(a,[i])=>Qd(i.evaluate(a),a.properties())],[[Er,us],(a,[i,c])=>Qd(i.evaluate(a),c.evaluate(a))]]},"feature-state":[xr,[Er],(a,[i])=>Qd(i.evaluate(a),a.featureState||{})],properties:[us,[],a=>a.properties()],"geometry-type":[Er,[],a=>a.geometryType()],id:[xr,[],a=>a.id()],zoom:[Mt,[],a=>a.globals.zoom],pitch:[Mt,[],a=>a.globals.pitch||0],"distance-from-center":[Mt,[],a=>a.distanceFromCenter()],"heatmap-density":[Mt,[],a=>a.globals.heatmapDensity||0],"line-progress":[Mt,[],a=>a.globals.lineProgress||0],"sky-radial-progress":[Mt,[],a=>a.globals.skyRadialProgress||0],accumulated:[xr,[],a=>a.globals.accumulated===void 0?null:a.globals.accumulated],"+":[Mt,Vo(Mt),(a,i)=>{let c=0;for(const d of i)c+=d.evaluate(a);return c}],"*":[Mt,Vo(Mt),(a,i)=>{let c=1;for(const d of i)c*=d.evaluate(a);return c}],"-":{type:Mt,overloads:[[[Mt,Mt],(a,[i,c])=>i.evaluate(a)-c.evaluate(a)],[[Mt],(a,[i])=>-i.evaluate(a)]]},"/":[Mt,[Mt,Mt],(a,[i,c])=>i.evaluate(a)/c.evaluate(a)],"%":[Mt,[Mt,Mt],(a,[i,c])=>i.evaluate(a)%c.evaluate(a)],ln2:[Mt,[],()=>Math.LN2],pi:[Mt,[],()=>Math.PI],e:[Mt,[],()=>Math.E],"^":[Mt,[Mt,Mt],(a,[i,c])=>Math.pow(i.evaluate(a),c.evaluate(a))],sqrt:[Mt,[Mt],(a,[i])=>Math.sqrt(i.evaluate(a))],log10:[Mt,[Mt],(a,[i])=>Math.log(i.evaluate(a))/Math.LN10],ln:[Mt,[Mt],(a,[i])=>Math.log(i.evaluate(a))],log2:[Mt,[Mt],(a,[i])=>Math.log(i.evaluate(a))/Math.LN2],sin:[Mt,[Mt],(a,[i])=>Math.sin(i.evaluate(a))],cos:[Mt,[Mt],(a,[i])=>Math.cos(i.evaluate(a))],tan:[Mt,[Mt],(a,[i])=>Math.tan(i.evaluate(a))],asin:[Mt,[Mt],(a,[i])=>Math.asin(i.evaluate(a))],acos:[Mt,[Mt],(a,[i])=>Math.acos(i.evaluate(a))],atan:[Mt,[Mt],(a,[i])=>Math.atan(i.evaluate(a))],min:[Mt,Vo(Mt),(a,i)=>Math.min(...i.map(c=>c.evaluate(a)))],max:[Mt,Vo(Mt),(a,i)=>Math.max(...i.map(c=>c.evaluate(a)))],abs:[Mt,[Mt],(a,[i])=>Math.abs(i.evaluate(a))],round:[Mt,[Mt],(a,[i])=>{const c=i.evaluate(a);return c<0?-Math.round(-c):Math.round(c)}],floor:[Mt,[Mt],(a,[i])=>Math.floor(i.evaluate(a))],ceil:[Mt,[Mt],(a,[i])=>Math.ceil(i.evaluate(a))],"filter-==":[_r,[Er,xr],(a,[i,c])=>a.properties()[i.value]===c.value],"filter-id-==":[_r,[xr],(a,[i])=>a.id()===i.value],"filter-type-==":[_r,[Er],(a,[i])=>a.geometryType()===i.value],"filter-<":[_r,[Er,xr],(a,[i,c])=>{const d=a.properties()[i.value],m=c.value;return typeof d==typeof m&&d<m}],"filter-id-<":[_r,[xr],(a,[i])=>{const c=a.id(),d=i.value;return typeof c==typeof d&&c<d}],"filter->":[_r,[Er,xr],(a,[i,c])=>{const d=a.properties()[i.value],m=c.value;return typeof d==typeof m&&d>m}],"filter-id->":[_r,[xr],(a,[i])=>{const c=a.id(),d=i.value;return typeof c==typeof d&&c>d}],"filter-<=":[_r,[Er,xr],(a,[i,c])=>{const d=a.properties()[i.value],m=c.value;return typeof d==typeof m&&d<=m}],"filter-id-<=":[_r,[xr],(a,[i])=>{const c=a.id(),d=i.value;return typeof c==typeof d&&c<=d}],"filter->=":[_r,[Er,xr],(a,[i,c])=>{const d=a.properties()[i.value],m=c.value;return typeof d==typeof m&&d>=m}],"filter-id->=":[_r,[xr],(a,[i])=>{const c=a.id(),d=i.value;return typeof c==typeof d&&c>=d}],"filter-has":[_r,[xr],(a,[i])=>i.value in a.properties()],"filter-has-id":[_r,[],a=>a.id()!==null&&a.id()!==void 0],"filter-type-in":[_r,[Fo(Er)],(a,[i])=>i.value.indexOf(a.geometryType())>=0],"filter-id-in":[_r,[Fo(xr)],(a,[i])=>i.value.indexOf(a.id())>=0],"filter-in-small":[_r,[Er,Fo(xr)],(a,[i,c])=>c.value.indexOf(a.properties()[i.value])>=0],"filter-in-large":[_r,[Er,Fo(xr)],(a,[i,c])=>function(d,m,v,x){for(;v<=x;){const T=v+x>>1;if(m[T]===d)return!0;m[T]>d?x=T-1:v=T+1}return!1}(a.properties()[i.value],c.value,0,c.value.length-1)],all:{type:_r,overloads:[[[_r,_r],(a,[i,c])=>i.evaluate(a)&&c.evaluate(a)],[Vo(_r),(a,i)=>{for(const c of i)if(!c.evaluate(a))return!1;return!0}]]},any:{type:_r,overloads:[[[_r,_r],(a,[i,c])=>i.evaluate(a)||c.evaluate(a)],[Vo(_r),(a,i)=>{for(const c of i)if(c.evaluate(a))return!0;return!1}]]},"!":[_r,[_r],(a,[i])=>!i.evaluate(a)],"is-supported-script":[_r,[Er],(a,[i])=>{const c=a.globals&&a.globals.isSupportedScript;return!c||c(i.evaluate(a))}],upcase:[Er,[Er],(a,[i])=>i.evaluate(a).toUpperCase()],downcase:[Er,[Er],(a,[i])=>i.evaluate(a).toLowerCase()],concat:[Er,Vo(xr),(a,i)=>i.map(c=>rh(c.evaluate(a))).join("")],"resolved-locale":[Er,[Co],(a,[i])=>i.evaluate(a).resolvedLocale()]});var hh=h0;function f0(a){return{result:"success",value:a}}function jl(a){return{result:"error",value:a}}function zc(a){return a["property-type"]==="data-driven"}function ef(a){return!!a.expression&&a.expression.parameters.indexOf("zoom")>-1}function tf(a){return!!a.expression&&a.expression.interpolated}function Ir(a){return a instanceof Number?"number":a instanceof String?"string":a instanceof Boolean?"boolean":Array.isArray(a)?"array":a===null?"null":typeof a}function dh(a){return typeof a=="object"&&a!==null&&!Array.isArray(a)}function p0(a){return a}function rf(a,i){const c=i.type==="color",d=a.stops&&typeof a.stops[0][0]=="object",m=d||!(d||a.property!==void 0),v=a.type||(tf(i)?"exponential":"interval");if(c&&((a=Ti({},a)).stops&&(a.stops=a.stops.map(C=>[C[0],$n.parse(C[1])])),a.default=$n.parse(a.default?a.default:i.default)),a.colorSpace&&a.colorSpace!=="rgb"&&!cg[a.colorSpace])throw new Error(`Unknown color space: ${a.colorSpace}`);let x,T,P;if(v==="exponential")x=fa;else if(v==="interval")x=nf;else if(v==="categorical"){x=m0,T=Object.create(null);for(const C of a.stops)T[C[0]]=C[1];P=typeof a.stops[0][0]}else{if(v!=="identity")throw new Error(`Unknown function type "${v}"`);x=g0}if(d){const C={},D=[];for(let q=0;q<a.stops.length;q++){const K=a.stops[q],Q=K[0].zoom;C[Q]===void 0&&(C[Q]={zoom:Q,type:a.type,property:a.property,default:a.default,stops:[]},D.push(Q)),C[Q].stops.push([K[0].value,K[1]])}const $=[];for(const q of D)$.push([C[q].zoom,rf(C[q],i)]);const U={name:"linear"};return{kind:"composite",interpolationType:U,interpolationFactor:Ds.interpolationFactor.bind(void 0,U),zoomStops:$.map(q=>q[0]),evaluate:({zoom:q},K)=>fa({stops:$,base:a.base},i,q).evaluate(q,K)}}if(m){const C=v==="exponential"?{name:"exponential",base:a.base!==void 0?a.base:1}:null;return{kind:"camera",interpolationType:C,interpolationFactor:Ds.interpolationFactor.bind(void 0,C),zoomStops:a.stops.map(D=>D[0]),evaluate:({zoom:D})=>x(a,i,D,T,P)}}return{kind:"source",evaluate(C,D){const $=D&&D.properties?D.properties[a.property]:void 0;return $===void 0?Bc(a.default,i.default):x(a,i,$,T,P)}}}function Bc(a,i,c){return a!==void 0?a:i!==void 0?i:c!==void 0?c:void 0}function m0(a,i,c,d,m){return Bc(typeof c===m?d[c]:void 0,a.default,i.default)}function nf(a,i,c){if(Ir(c)!=="number")return Bc(a.default,i.default);const d=a.stops.length;if(d===1||c<=a.stops[0][0])return a.stops[0][1];if(c>=a.stops[d-1][0])return a.stops[d-1][1];const m=Wd(a.stops.map(v=>v[0]),c);return a.stops[m][1]}function fa(a,i,c){const d=a.base!==void 0?a.base:1;if(Ir(c)!=="number")return Bc(a.default,i.default);const m=a.stops.length;if(m===1||c<=a.stops[0][0])return a.stops[0][1];if(c>=a.stops[m-1][0])return a.stops[m-1][1];const v=Wd(a.stops.map(D=>D[0]),c),x=function(D,$,U,q){const K=q-U,Q=D-U;return K===0?0:$===1?Q/K:(Math.pow($,Q)-1)/(Math.pow($,K)-1)}(c,d,a.stops[v][0],a.stops[v+1][0]),T=a.stops[v][1],P=a.stops[v+1][1];let C=sh[i.type]||p0;if(a.colorSpace&&a.colorSpace!=="rgb"){const D=cg[a.colorSpace];C=($,U)=>D.reverse(D.interpolate(D.forward($),D.forward(U),x))}return typeof T.evaluate=="function"?{evaluate(...D){const $=T.evaluate.apply(void 0,D),U=P.evaluate.apply(void 0,D);if($!==void 0&&U!==void 0)return C($,U,x)}}:C(T,P,x)}function g0(a,i,c){return i.type==="color"?c=$n.parse(c):i.type==="formatted"?c=co.fromString(c.toString()):i.type==="resolvedImage"?c=Uo.fromString(c.toString()):Ir(c)===i.type||i.type==="enum"&&i.values[c]||(c=void 0),Bc(c,a.default,i.default)}class of{constructor(i,c){this.expression=i,this._warningHistory={},this._evaluator=new Zm,this._defaultValue=c?function(d){return d.type==="color"&&(dh(d.default)||Array.isArray(d.default))?new $n(0,0,0,0):d.type==="color"?$n.parse(d.default)||null:d.default===void 0?null:d.default}(c):null,this._enumValues=c&&c.type==="enum"?c.values:null}evaluateWithoutErrorHandling(i,c,d,m,v,x,T,P){return this._evaluator.globals=i,this._evaluator.feature=c,this._evaluator.featureState=d,this._evaluator.canonical=m||null,this._evaluator.availableImages=v||null,this._evaluator.formattedSection=x,this._evaluator.featureTileCoord=T||null,this._evaluator.featureDistanceData=P||null,this.expression.evaluate(this._evaluator)}evaluate(i,c,d,m,v,x,T,P){this._evaluator.globals=i,this._evaluator.feature=c||null,this._evaluator.featureState=d||null,this._evaluator.canonical=m||null,this._evaluator.availableImages=v||null,this._evaluator.formattedSection=x||null,this._evaluator.featureTileCoord=T||null,this._evaluator.featureDistanceData=P||null;try{const C=this.expression.evaluate(this._evaluator);if(C==null||typeof C=="number"&&C!=C)return this._defaultValue;if(this._enumValues&&!(C in this._enumValues))throw new Ei(`Expected value to be one of ${Object.keys(this._enumValues).map(D=>JSON.stringify(D)).join(", ")}, but found ${JSON.stringify(C)} instead.`);return C}catch(C){return this._warningHistory[C.message]||(this._warningHistory[C.message]=!0,typeof console<"u"&&console.warn(C.message)),this._defaultValue}}}function Nc(a){return Array.isArray(a)&&a.length>0&&typeof a[0]=="string"&&a[0]in hh}function $c(a,i){const c=new tg(hh,[],i?function(m){const v={color:Po,string:Er,number:Mt,enum:Er,boolean:_r,formatted:Xu,resolvedImage:Ml};return m.type==="array"?Fo(v[m.value]||xr,m.length):v[m.type]}(i):void 0),d=c.parse(a,void 0,void 0,void 0,i&&i.type==="string"?{typeAnnotation:"coerce"}:void 0);return d?f0(new of(d,i)):jl(c.errors)}class gg{constructor(i,c){this.kind=i,this._styleExpression=c,this.isStateDependent=i!=="constant"&&!ha(c.expression)}evaluateWithoutErrorHandling(i,c,d,m,v,x){return this._styleExpression.evaluateWithoutErrorHandling(i,c,d,m,v,x)}evaluate(i,c,d,m,v,x){return this._styleExpression.evaluate(i,c,d,m,v,x)}}class fh{constructor(i,c,d,m){this.kind=i,this.zoomStops=d,this._styleExpression=c,this.isStateDependent=i!=="camera"&&!ha(c.expression),this.interpolationType=m}evaluateWithoutErrorHandling(i,c,d,m,v,x){return this._styleExpression.evaluateWithoutErrorHandling(i,c,d,m,v,x)}evaluate(i,c,d,m,v,x){return this._styleExpression.evaluate(i,c,d,m,v,x)}interpolationFactor(i,c,d){return this.interpolationType?Ds.interpolationFactor(this.interpolationType,i,c,d):0}}function ph(a,i){if((a=$c(a,i)).result==="error")return a;const c=a.value.expression,d=Rc(c);if(!d&&!zc(i))return jl([new Ni("","data expressions not supported")]);const m=Dl(c,["zoom","pitch","distance-from-center"]);if(!m&&!ef(i))return jl([new Ni("","zoom expressions not supported")]);const v=af(c);return v||m?v instanceof Ni?jl([v]):v instanceof Ds&&!tf(i)?jl([new Ni("",'"interpolate" expressions cannot be used with this property')]):f0(v?new fh(d?"camera":"composite",a.value,v.labels,v instanceof Ds?v.interpolation:void 0):new gg(d?"constant":"source",a.value)):jl([new Ni("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class sf{constructor(i,c){this._parameters=i,this._specification=c,Ti(this,rf(this._parameters,this._specification))}static deserialize(i){return new sf(i._parameters,i._specification)}static serialize(i){return{_parameters:i._parameters,_specification:i._specification}}}function af(a){let i=null;if(a instanceof o0)i=af(a.result);else if(a instanceof hg){for(const c of a.args)if(i=af(c),i)break}else(a instanceof ng||a instanceof Ds)&&a.input instanceof ca&&a.input.name==="zoom"&&(i=a);return i instanceof Ni||a.eachChild(c=>{const d=af(c);d instanceof Ni?i=d:!i&&d?i=new Ni("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):i&&d&&i!==d&&(i=new Ni("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),i}class Rt{constructor(i,c,d,m){this.message=(i?`${i}: `:"")+d,m&&(this.identifier=m),c!=null&&c.__line__&&(this.line=c.__line__)}}function hs(a){const i=a.key,c=a.value,d=a.valueSpec||{},m=a.objectElementValidators||{},v=a.style,x=a.styleSpec;let T=[];const P=Ir(c);if(P!=="object")return[new Rt(i,c,`object expected, ${P} found`)];for(const C in c){const D=C.split(".")[0];let $;m[D]?$=m[D]:d[D]?$=$i:m["*"]?$=m["*"]:d["*"]&&($=$i),$?T=T.concat($({key:(i&&`${i}.`)+C,value:c[C],valueSpec:d[D]||d["*"],style:v,styleSpec:x,object:c,objectKey:C},c)):T.push(new Rt(i,c[C],`unknown property "${C}"`))}for(const C in d)m[C]||d[C].required&&d[C].default===void 0&&c[C]===void 0&&T.push(new Rt(i,c,`missing required property "${C}"`));return T}function y0(a){const i=a.value,c=a.valueSpec,d=a.style,m=a.styleSpec,v=a.key,x=a.arrayElementValidator||$i;if(Ir(i)!=="array")return[new Rt(v,i,`array expected, ${Ir(i)} found`)];if(c.length&&i.length!==c.length)return[new Rt(v,i,`array length ${c.length} expected, length ${i.length} found`)];if(c["min-length"]&&i.length<c["min-length"])return[new Rt(v,i,`array length at least ${c["min-length"]} expected, length ${i.length} found`)];let T={type:c.value,values:c.values,minimum:c.minimum,maximum:c.maximum,function:void 0};m.$version<7&&(T.function=c.function),Ir(c.value)==="object"&&(T=c.value);let P=[];for(let C=0;C<i.length;C++)P=P.concat(x({array:i,arrayIndex:C,value:i[C],valueSpec:T,style:d,styleSpec:m,key:`${v}[${C}]`}));return P}function mh(a){const i=a.key,c=a.value,d=a.valueSpec;let m=Ir(c);if(m==="number"&&c!=c&&(m="NaN"),m!=="number")return[new Rt(i,c,`number expected, ${m} found`)];if("minimum"in d){let v=d.minimum;if(Ir(d.minimum)==="array"&&(v=d.minimum[a.arrayIndex]),c<v)return[new Rt(i,c,`${c} is less than the minimum value ${v}`)]}if("maximum"in d){let v=d.maximum;if(Ir(d.maximum)==="array"&&(v=d.maximum[a.arrayIndex]),c>v)return[new Rt(i,c,`${c} is greater than the maximum value ${v}`)]}return[]}function gh(a){const i=a.valueSpec,c=en(a.value.type);let d,m,v,x={};const T=c!=="categorical"&&a.value.property===void 0,P=!T,C=Ir(a.value.stops)==="array"&&Ir(a.value.stops[0])==="array"&&Ir(a.value.stops[0][0])==="object",D=hs({key:a.key,value:a.value,valueSpec:a.styleSpec.function,style:a.style,styleSpec:a.styleSpec,objectElementValidators:{stops:function(q){if(c==="identity")return[new Rt(q.key,q.value,'identity function may not have a "stops" property')];let K=[];const Q=q.value;return K=K.concat(y0({key:q.key,value:Q,valueSpec:q.valueSpec,style:q.style,styleSpec:q.styleSpec,arrayElementValidator:$})),Ir(Q)==="array"&&Q.length===0&&K.push(new Rt(q.key,Q,"array must have at least one stop")),K},default:function(q){return $i({key:q.key,value:q.value,valueSpec:i,style:q.style,styleSpec:q.styleSpec})}}});return c==="identity"&&T&&D.push(new Rt(a.key,a.value,'missing required property "property"')),c==="identity"||a.value.stops||D.push(new Rt(a.key,a.value,'missing required property "stops"')),c==="exponential"&&a.valueSpec.expression&&!tf(a.valueSpec)&&D.push(new Rt(a.key,a.value,"exponential functions not supported")),a.styleSpec.$version>=8&&(P&&!zc(a.valueSpec)?D.push(new Rt(a.key,a.value,"property functions not supported")):T&&!ef(a.valueSpec)&&D.push(new Rt(a.key,a.value,"zoom functions not supported"))),c!=="categorical"&&!C||a.value.property!==void 0||D.push(new Rt(a.key,a.value,'"property" property is required')),D;function $(q){let K=[];const Q=q.value,oe=q.key;if(Ir(Q)!=="array")return[new Rt(oe,Q,`array expected, ${Ir(Q)} found`)];if(Q.length!==2)return[new Rt(oe,Q,`array length 2 expected, length ${Q.length} found`)];if(C){if(Ir(Q[0])!=="object")return[new Rt(oe,Q,`object expected, ${Ir(Q[0])} found`)];if(Q[0].zoom===void 0)return[new Rt(oe,Q,"object stop key must have zoom")];if(Q[0].value===void 0)return[new Rt(oe,Q,"object stop key must have value")];const de=en(Q[0].zoom);if(typeof de!="number")return[new Rt(oe,Q[0].zoom,"stop zoom values must be numbers")];if(v&&v>de)return[new Rt(oe,Q[0].zoom,"stop zoom values must appear in ascending order")];de!==v&&(v=de,m=void 0,x={}),K=K.concat(hs({key:`${oe}[0]`,value:Q[0],valueSpec:{zoom:{}},style:q.style,styleSpec:q.styleSpec,objectElementValidators:{zoom:mh,value:U}}))}else K=K.concat(U({key:`${oe}[0]`,value:Q[0],style:q.style,styleSpec:q.styleSpec},Q));return Nc(Nn(Q[1]))?K.concat([new Rt(`${oe}[1]`,Q[1],"expressions are not allowed in function stops.")]):K.concat($i({key:`${oe}[1]`,value:Q[1],valueSpec:i,style:q.style,styleSpec:q.styleSpec}))}function U(q,K){const Q=Ir(q.value),oe=en(q.value),de=q.value!==null?q.value:K;if(d){if(Q!==d)return[new Rt(q.key,de,`${Q} stop domain type must match previous stop domain type ${d}`)]}else d=Q;if(Q!=="number"&&Q!=="string"&&Q!=="boolean"&&typeof oe!="number"&&typeof oe!="string"&&typeof oe!="boolean")return[new Rt(q.key,de,"stop domain value must be a number, string, or boolean")];if(Q!=="number"&&c!=="categorical"){let xe=`number expected, ${Q} found`;return zc(i)&&c===void 0&&(xe+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Rt(q.key,de,xe)]}return c!=="categorical"||Q!=="number"||typeof oe=="number"&&isFinite(oe)&&Math.floor(oe)===oe?c!=="categorical"&&Q==="number"&&typeof oe=="number"&&typeof m=="number"&&m!==void 0&&oe<m?[new Rt(q.key,de,"stop domain values must appear in ascending order")]:(m=oe,c==="categorical"&&oe in x?[new Rt(q.key,de,"stop domain values must be unique")]:(x[oe]=!0,[])):[new Rt(q.key,de,`integer expected, found ${String(oe)}`)]}}function di(a){const i=(a.expressionContext==="property"?ph:$c)(Nn(a.value),a.valueSpec);if(i.result==="error")return i.value.map(d=>new Rt(`${a.key}${d.key}`,a.value,d.message));const c=i.value.expression||i.value._styleExpression.expression;if(a.expressionContext==="property"&&a.propertyKey==="text-font"&&!c.outputDefined())return[new Rt(a.key,a.value,`Invalid data expression for "${a.propertyKey}". Output values must be contained as literals within the expression.`)];if(a.expressionContext==="property"&&a.propertyType==="layout"&&!ha(c))return[new Rt(a.key,a.value,'"feature-state" data expressions are not supported with layout properties.')];if(a.expressionContext==="filter")return yh(c,a);if(a.expressionContext&&a.expressionContext.indexOf("cluster")===0){if(!Dl(c,["zoom","feature-state"]))return[new Rt(a.key,a.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(a.expressionContext==="cluster-initial"&&!Rc(c))return[new Rt(a.key,a.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function yh(a,i){const c=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(i.valueSpec&&i.valueSpec.expression)for(const m of i.valueSpec.expression.parameters)c.delete(m);if(c.size===0)return[];const d=[];return a instanceof ca&&c.has(a.name)?[new Rt(i.key,i.value,`["${a.name}"] expression is not supported in a filter for a ${i.object.type} layer with id: ${i.object.id}`)]:(a.eachChild(m=>{d.push(...yh(m,i))}),d)}function lf(a){const i=a.key,c=a.value,d=a.valueSpec,m=[];return Array.isArray(d.values)?d.values.indexOf(en(c))===-1&&m.push(new Rt(i,c,`expected one of [${d.values.join(", ")}], ${JSON.stringify(c)} found`)):Object.keys(d.values).indexOf(en(c))===-1&&m.push(new Rt(i,c,`expected one of [${Object.keys(d.values).join(", ")}], ${JSON.stringify(c)} found`)),m}function yg(a){if(a===!0||a===!1)return!0;if(!Array.isArray(a)||a.length===0)return!1;switch(a[0]){case"has":return a.length>=2&&a[1]!=="$id"&&a[1]!=="$type";case"in":return a.length>=3&&(typeof a[1]!="string"||Array.isArray(a[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return a.length!==3||Array.isArray(a[1])||Array.isArray(a[2]);case"any":case"all":for(const i of a.slice(1))if(!yg(i)&&typeof i!="boolean")return!1;return!0;default:return!0}}function cf(a,i="fill"){if(a==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};yg(a)||(a=Uc(a));const c=a;let d=!0;try{d=function(C){if(!Fc(C))return C;let D=Nn(C);return uf(D),D=v0(D),D}(c)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(c,null,2)}
        `)}const m=Xe[`filter_${i}`],v=$c(d,m);let x=null;if(v.result==="error")throw new Error(v.value.map(C=>`${C.key}: ${C.message}`).join(", "));x=(C,D,$)=>v.value.evaluate(C,D,{},$);let T=null,P=null;if(d!==c){const C=$c(c,m);if(C.result==="error")throw new Error(C.value.map(D=>`${D.key}: ${D.message}`).join(", "));T=(D,$,U,q,K)=>C.value.evaluate(D,$,{},U,void 0,void 0,q,K),P=!Rc(C.value.expression)}return{filter:x,dynamicFilter:T||void 0,needGeometry:_0(d),needFeature:!!P}}function v0(a){if(!Array.isArray(a))return a;const i=function(c){if(vg.has(c[0])){for(let d=1;d<c.length;d++)if(Fc(c[d]))return!0}return c}(a);return i===!0?i:i.map(c=>v0(c))}function uf(a){let i=!1;const c=[];if(a[0]==="case"){for(let d=1;d<a.length-1;d+=2)i=i||Fc(a[d]),c.push(a[d+1]);c.push(a[a.length-1])}else if(a[0]==="match"){i=i||Fc(a[1]);for(let d=2;d<a.length-1;d+=2)c.push(a[d+1]);c.push(a[a.length-1])}else if(a[0]==="step"){i=i||Fc(a[1]);for(let d=1;d<a.length-1;d+=2)c.push(a[d+1])}i&&(a.length=0,a.push("any",...c));for(let d=1;d<a.length;d++)uf(a[d])}function Fc(a){if(!Array.isArray(a))return!1;if((i=a[0])==="pitch"||i==="distance-from-center")return!0;var i;for(let c=1;c<a.length;c++)if(Fc(a[c]))return!0;return!1}const vg=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function XS(a,i){return a<i?-1:a>i?1:0}function _0(a){if(!Array.isArray(a))return!1;if(a[0]==="within")return!0;for(let i=1;i<a.length;i++)if(_0(a[i]))return!0;return!1}function Uc(a){if(!a)return!0;const i=a[0];return a.length<=1?i!=="any":i==="=="?_g(a[1],a[2],"=="):i==="!="?hf(_g(a[1],a[2],"==")):i==="<"||i===">"||i==="<="||i===">="?_g(a[1],a[2],i):i==="any"?(c=a.slice(1),["any"].concat(c.map(Uc))):i==="all"?["all"].concat(a.slice(1).map(Uc)):i==="none"?["all"].concat(a.slice(1).map(Uc).map(hf)):i==="in"?xg(a[1],a.slice(2)):i==="!in"?hf(xg(a[1],a.slice(2))):i==="has"?bg(a[1]):i==="!has"?hf(bg(a[1])):i!=="within"||a;var c}function _g(a,i,c){switch(a){case"$type":return[`filter-type-${c}`,i];case"$id":return[`filter-id-${c}`,i];default:return[`filter-${c}`,a,i]}}function xg(a,i){if(i.length===0)return!1;switch(a){case"$type":return["filter-type-in",["literal",i]];case"$id":return["filter-id-in",["literal",i]];default:return i.length>200&&!i.some(c=>typeof c!=typeof i[0])?["filter-in-large",a,["literal",i.sort(XS)]]:["filter-in-small",a,["literal",i]]}}function bg(a){switch(a){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",a]}}function hf(a){return["!",a]}function vh(a){return yg(Nn(a.value))?di(Ti({},a,{expressionContext:"filter",valueSpec:a.styleSpec[`filter_${a.layerType||"fill"}`]})):_h(a)}function _h(a){const i=a.value,c=a.key;if(Ir(i)!=="array")return[new Rt(c,i,`array expected, ${Ir(i)} found`)];const d=a.styleSpec;let m,v=[];if(i.length<1)return[new Rt(c,i,"filter array must have at least 1 element")];switch(v=v.concat(lf({key:`${c}[0]`,value:i[0],valueSpec:d.filter_operator,style:a.style,styleSpec:a.styleSpec})),en(i[0])){case"<":case"<=":case">":case">=":i.length>=2&&en(i[1])==="$type"&&v.push(new Rt(c,i,`"$type" cannot be use with operator "${i[0]}"`));case"==":case"!=":i.length!==3&&v.push(new Rt(c,i,`filter array for operator "${i[0]}" must have 3 elements`));case"in":case"!in":i.length>=2&&(m=Ir(i[1]),m!=="string"&&v.push(new Rt(`${c}[1]`,i[1],`string expected, ${m} found`)));for(let x=2;x<i.length;x++)m=Ir(i[x]),en(i[1])==="$type"?v=v.concat(lf({key:`${c}[${x}]`,value:i[x],valueSpec:d.geometry_type,style:a.style,styleSpec:a.styleSpec})):m!=="string"&&m!=="number"&&m!=="boolean"&&v.push(new Rt(`${c}[${x}]`,i[x],`string, number, or boolean expected, ${m} found`));break;case"any":case"all":case"none":for(let x=1;x<i.length;x++)v=v.concat(_h({key:`${c}[${x}]`,value:i[x],style:a.style,styleSpec:a.styleSpec}));break;case"has":case"!has":m=Ir(i[1]),i.length!==2?v.push(new Rt(c,i,`filter array for "${i[0]}" operator must have 2 elements`)):m!=="string"&&v.push(new Rt(`${c}[1]`,i[1],`string expected, ${m} found`));break;case"within":m=Ir(i[1]),i.length!==2?v.push(new Rt(c,i,`filter array for "${i[0]}" operator must have 2 elements`)):m!=="object"&&v.push(new Rt(`${c}[1]`,i[1],`object expected, ${m} found`))}return v}function wg(a,i){const c=a.key,d=a.style,m=a.styleSpec,v=a.value,x=a.objectKey,T=m[`${i}_${a.layerType}`];if(!T)return[];const P=x.match(/^(.*)-transition$/);if(i==="paint"&&P&&T[P[1]]&&T[P[1]].transition)return $i({key:c,value:v,valueSpec:m.transition,style:d,styleSpec:m});const C=a.valueSpec||T[x];if(!C)return[new Rt(c,v,`unknown property "${x}"`)];let D;if(Ir(v)==="string"&&zc(C)&&!C.tokens&&(D=/^{([^}]+)}$/.exec(v))){const U=`\`{ "type": "identity", "property": ${D?JSON.stringify(D[1]):'"_"'} }\``;return[new Rt(c,v,`"${x}" does not support interpolation syntax
Use an identity property function instead: ${U}.`)]}const $=[];return a.layerType==="symbol"&&(x==="text-field"&&d&&!d.glyphs&&$.push(new Rt(c,v,'use of "text-field" requires a style "glyphs" property')),x==="text-font"&&dh(Nn(v))&&en(v.type)==="identity"&&$.push(new Rt(c,v,'"text-font" does not support identity functions'))),$.concat($i({key:a.key,value:v,valueSpec:C,style:d,styleSpec:m,expressionContext:"property",propertyType:i,propertyKey:x}))}function x0(a){return wg(a,"paint")}function Sg(a){return wg(a,"layout")}function b0(a){let i=[];const c=a.value,d=a.key,m=a.style,v=a.styleSpec;c.type||c.ref||i.push(new Rt(d,c,'either "type" or "ref" is required'));let x=en(c.type);const T=en(c.ref);if(c.id){const P=en(c.id);for(let C=0;C<a.arrayIndex;C++){const D=m.layers[C];en(D.id)===P&&i.push(new Rt(d,c.id,`duplicate layer id "${c.id}", previously used at line ${D.id.__line__}`))}}if("ref"in c){let P;["type","source","source-layer","filter","layout"].forEach(C=>{C in c&&i.push(new Rt(d,c[C],`"${C}" is prohibited for ref layers`))}),m.layers.forEach(C=>{en(C.id)===T&&(P=C)}),P?P.ref?i.push(new Rt(d,c.ref,"ref cannot reference another ref layer")):x=en(P.type):typeof T=="string"&&i.push(new Rt(d,c.ref,`ref layer "${T}" not found`))}else if(x!=="background"&&x!=="sky")if(c.source){const P=m.sources&&m.sources[c.source],C=P&&en(P.type);P?C==="vector"&&x==="raster"?i.push(new Rt(d,c.source,`layer "${c.id}" requires a raster source`)):C==="raster"&&x!=="raster"?i.push(new Rt(d,c.source,`layer "${c.id}" requires a vector source`)):C!=="vector"||c["source-layer"]?C==="raster-dem"&&x!=="hillshade"?i.push(new Rt(d,c.source,"raster-dem source can only be used with layer type 'hillshade'.")):x!=="line"||!c.paint||!c.paint["line-gradient"]&&!c.paint["line-trim-offset"]||C==="geojson"&&P.lineMetrics||i.push(new Rt(d,c,`layer "${c.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):i.push(new Rt(d,c,`layer "${c.id}" must specify a "source-layer"`)):i.push(new Rt(d,c.source,`source "${c.source}" not found`))}else i.push(new Rt(d,c,'missing required property "source"'));return i=i.concat(hs({key:d,value:c,valueSpec:v.layer,style:a.style,styleSpec:a.styleSpec,objectElementValidators:{"*":()=>[],type:()=>$i({key:`${d}.type`,value:c.type,valueSpec:v.layer.type,style:a.style,styleSpec:a.styleSpec,object:c,objectKey:"type"}),filter:P=>vh(Ti({layerType:x},P)),layout:P=>hs({layer:c,key:P.key,value:P.value,valueSpec:{},style:P.style,styleSpec:P.styleSpec,objectElementValidators:{"*":C=>Sg(Ti({layerType:x},C))}}),paint:P=>hs({layer:c,key:P.key,value:P.value,valueSpec:{},style:P.style,styleSpec:P.styleSpec,objectElementValidators:{"*":C=>x0(Ti({layerType:x},C))}})}})),i}function tl(a){const i=a.value,c=a.key,d=Ir(i);return d!=="string"?[new Rt(c,i,`string expected, ${d} found`)]:[]}const w0={promoteId:function({key:a,value:i}){if(Ir(i)==="string")return tl({key:a,value:i});{const c=[];for(const d in i)c.push(...tl({key:`${a}.${d}`,value:i[d]}));return c}}};function S0(a){const i=a.value,c=a.key,d=a.styleSpec,m=a.style;if(!i.type)return[new Rt(c,i,'"type" is required')];const v=en(i.type);let x;switch(v){case"vector":case"raster":case"raster-dem":return x=hs({key:c,value:i,valueSpec:d[`source_${v.replace("-","_")}`],style:a.style,styleSpec:d,objectElementValidators:w0}),x;case"geojson":if(x=hs({key:c,value:i,valueSpec:d.source_geojson,style:m,styleSpec:d,objectElementValidators:w0}),i.cluster)for(const T in i.clusterProperties){const[P,C]=i.clusterProperties[T],D=typeof P=="string"?[P,["accumulated"],["get",T]]:P;x.push(...di({key:`${c}.${T}.map`,value:C,expressionContext:"cluster-map"})),x.push(...di({key:`${c}.${T}.reduce`,value:D,expressionContext:"cluster-reduce"}))}return x;case"video":return hs({key:c,value:i,valueSpec:d.source_video,style:m,styleSpec:d});case"image":return hs({key:c,value:i,valueSpec:d.source_image,style:m,styleSpec:d});case"canvas":return[new Rt(c,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return lf({key:`${c}.type`,value:i.type,valueSpec:{values:YS(d)}})}}function YS(a){return a.source.reduce((i,c)=>{const d=a[c];return d.type.type==="enum"&&(i=i.concat(Object.keys(d.type.values))),i},[])}function T0(a){const i=a.value,c=a.styleSpec,d=c.light,m=a.style;let v=[];const x=Ir(i);if(i===void 0)return v;if(x!=="object")return v=v.concat([new Rt("light",i,`object expected, ${x} found`)]),v;for(const T in i){const P=T.match(/^(.*)-transition$/);v=v.concat(P&&d[P[1]]&&d[P[1]].transition?$i({key:T,value:i[T],valueSpec:c.transition,style:m,styleSpec:c}):d[T]?$i({key:T,value:i[T],valueSpec:d[T],style:m,styleSpec:c}):[new Rt(T,i[T],`unknown property "${T}"`)])}return v}function Tg(a){const i=a.value,c=a.key,d=a.style,m=a.styleSpec,v=m.terrain;let x=[];const T=Ir(i);if(i===void 0)return x;if(T!=="object")return x=x.concat([new Rt("terrain",i,`object expected, ${T} found`)]),x;for(const P in i){const C=P.match(/^(.*)-transition$/);x=x.concat(C&&v[C[1]]&&v[C[1]].transition?$i({key:P,value:i[P],valueSpec:m.transition,style:d,styleSpec:m}):v[P]?$i({key:P,value:i[P],valueSpec:v[P],style:d,styleSpec:m}):[new Rt(P,i[P],`unknown property "${P}"`)])}if(i.source){const P=d.sources&&d.sources[i.source],C=P&&en(P.type);P?C!=="raster-dem"&&x.push(new Rt(c,i.source,`terrain cannot be used with a source of type ${String(C)}, it only be used with a "raster-dem" source type`)):x.push(new Rt(c,i.source,`source "${i.source}" not found`))}else x.push(new Rt(c,i,'terrain is missing required property "source"'));return x}function E0(a){const i=a.value,c=a.style,d=a.styleSpec,m=d.fog;let v=[];const x=Ir(i);if(i===void 0)return v;if(x!=="object")return v=v.concat([new Rt("fog",i,`object expected, ${x} found`)]),v;for(const T in i){const P=T.match(/^(.*)-transition$/);v=v.concat(P&&m[P[1]]&&m[P[1]].transition?$i({key:T,value:i[T],valueSpec:d.transition,style:c,styleSpec:d}):m[T]?$i({key:T,value:i[T],valueSpec:m[T],style:c,styleSpec:d}):[new Rt(T,i[T],`unknown property "${T}"`)])}return v}const A0={"*":()=>[],array:y0,boolean:function(a){const i=a.value,c=a.key,d=Ir(i);return d!=="boolean"?[new Rt(c,i,`boolean expected, ${d} found`)]:[]},number:mh,color:function(a){const i=a.key,c=a.value,d=Ir(c);return d!=="string"?[new Rt(i,c,`color expected, ${d} found`)]:Um(c)===null?[new Rt(i,c,`color expected, "${c}" found`)]:[]},enum:lf,filter:vh,function:gh,layer:b0,object:hs,source:S0,light:T0,terrain:Tg,fog:E0,string:tl,formatted:function(a){return tl(a).length===0?[]:di(a)},resolvedImage:function(a){return tl(a).length===0?[]:di(a)},projection:function(a){const i=a.value,c=a.styleSpec,d=c.projection,m=a.style;let v=[];const x=Ir(i);if(x==="object")for(const T in i)v=v.concat($i({key:T,value:i[T],valueSpec:d[T],style:m,styleSpec:c}));else x!=="string"&&(v=v.concat([new Rt("projection",i,`object or string expected, ${x} found`)]));return v}};function $i(a){const i=a.value,c=a.valueSpec,d=a.styleSpec;return c.expression&&dh(en(i))?gh(a):c.expression&&Nc(Nn(i))?di(a):c.type&&A0[c.type]?A0[c.type](a):hs(Ti({},a,{valueSpec:c.type?d[c.type]:c}))}function JS(a){const i=a.value,c=a.key,d=tl(a);return d.length||(i.indexOf("{fontstack}")===-1&&d.push(new Rt(c,i,'"glyphs" url must include a "{fontstack}" token')),i.indexOf("{range}")===-1&&d.push(new Rt(c,i,'"glyphs" url must include a "{range}" token'))),d}function P0(a,i=Xe){return Go($i({key:"",value:a,valueSpec:i.$root,styleSpec:i,style:a,objectElementValidators:{glyphs:JS,"*":()=>[]}}))}const QS=a=>Go(x0(a)),eT=a=>Go(Sg(a));function Go(a){return a.slice().sort((i,c)=>i.line&&c.line?i.line-c.line:0)}function C0(a,i){let c=!1;if(i&&i.length)for(const d of i)a.fire(new Dr(new Error(d.message))),c=!0;return c}var tT=Ls,ds=3;function Ls(a,i,c){var d=this.cells=[];if(a instanceof ArrayBuffer){this.arrayBuffer=a;var m=new Int32Array(this.arrayBuffer);a=m[0],this.d=(i=m[1])+2*(c=m[2]);for(var v=0;v<this.d*this.d;v++){var x=m[ds+v],T=m[ds+v+1];d.push(x===T?null:m.subarray(x,T))}var P=m[ds+d.length+1];this.keys=m.subarray(m[ds+d.length],P),this.bboxes=m.subarray(P),this.insert=this._insertReadonly}else{this.d=i+2*c;for(var C=0;C<this.d*this.d;C++)d.push([]);this.keys=[],this.bboxes=[]}this.n=i,this.extent=a,this.padding=c,this.scale=i/a,this.uid=0;var D=c/i*a;this.min=-D,this.max=a+D}Ls.prototype.insert=function(a,i,c,d,m){this._forEachCell(i,c,d,m,this._insertCell,this.uid++),this.keys.push(a),this.bboxes.push(i),this.bboxes.push(c),this.bboxes.push(d),this.bboxes.push(m)},Ls.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},Ls.prototype._insertCell=function(a,i,c,d,m,v){this.cells[m].push(v)},Ls.prototype.query=function(a,i,c,d,m){var v=this.min,x=this.max;if(a<=v&&i<=v&&x<=c&&x<=d&&!m)return Array.prototype.slice.call(this.keys);var T=[];return this._forEachCell(a,i,c,d,this._queryCell,T,{},m),T},Ls.prototype._queryCell=function(a,i,c,d,m,v,x,T){var P=this.cells[m];if(P!==null)for(var C=this.keys,D=this.bboxes,$=0;$<P.length;$++){var U=P[$];if(x[U]===void 0){var q=4*U;(T?T(D[q+0],D[q+1],D[q+2],D[q+3]):a<=D[q+2]&&i<=D[q+3]&&c>=D[q+0]&&d>=D[q+1])?(x[U]=!0,v.push(C[U])):x[U]=!1}}},Ls.prototype._forEachCell=function(a,i,c,d,m,v,x,T){for(var P=this._convertToCellCoord(a),C=this._convertToCellCoord(i),D=this._convertToCellCoord(c),$=this._convertToCellCoord(d),U=P;U<=D;U++)for(var q=C;q<=$;q++){var K=this.d*q+U;if((!T||T(this._convertFromCellCoord(U),this._convertFromCellCoord(q),this._convertFromCellCoord(U+1),this._convertFromCellCoord(q+1)))&&m.call(this,a,i,c,d,K,v,x,T))return}},Ls.prototype._convertFromCellCoord=function(a){return(a-this.padding)/this.scale},Ls.prototype._convertToCellCoord=function(a){return Math.max(0,Math.min(this.d-1,Math.floor(a*this.scale)+this.padding))},Ls.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var a=this.cells,i=ds+this.cells.length+1+1,c=0,d=0;d<this.cells.length;d++)c+=this.cells[d].length;var m=new Int32Array(i+c+this.keys.length+this.bboxes.length);m[0]=this.extent,m[1]=this.n,m[2]=this.padding;for(var v=i,x=0;x<a.length;x++){var T=a[x];m[ds+x]=v,m.set(T,v),v+=T.length}return m[ds+a.length]=v,m.set(this.keys,v),m[ds+a.length+1]=v+=this.keys.length,m.set(this.bboxes,v),v+=this.bboxes.length,m.buffer};var zl=Z(tT);const df={};function jt(a,i,c={}){Object.defineProperty(a,"_classRegistryKey",{value:i,writeable:!1}),df[i]={klass:a,omit:c.omit||[]}}jt(Object,"Object"),zl.serialize=function(a,i){const c=a.toArrayBuffer();return i&&i.push(c),{buffer:c}},zl.deserialize=function(a){return new zl(a.buffer)},Object.defineProperty(zl,"name",{value:"Grid"}),jt(zl,"Grid"),jt($n,"Color"),jt(Error,"Error"),jt(Ao,"AJAXError"),jt(Uo,"ResolvedImage"),jt(sf,"StylePropertyFunction"),jt(of,"StyleExpression",{omit:["_evaluator"]}),jt(fh,"ZoomDependentExpression"),jt(gg,"ZoomConstantExpression"),jt(ca,"CompoundExpression",{omit:["_evaluate"]});for(const a in hh)df[hh[a]._classRegistryKey]||jt(hh[a],`Expression${a}`);function Eg(a){return a&&typeof ArrayBuffer<"u"&&(a instanceof ArrayBuffer||a.constructor&&a.constructor.name==="ArrayBuffer")}function Ag(a){return y.ImageBitmap&&a instanceof y.ImageBitmap}function Vc(a,i){if(a==null||typeof a=="boolean"||typeof a=="number"||typeof a=="string"||a instanceof Boolean||a instanceof Number||a instanceof String||a instanceof Date||a instanceof RegExp)return a;if(Eg(a)||Ag(a))return i&&i.push(a),a;if(ArrayBuffer.isView(a)){const c=a;return i&&i.push(c.buffer),c}if(a instanceof y.ImageData)return i&&i.push(a.data.buffer),a;if(Array.isArray(a)){const c=[];for(const d of a)c.push(Vc(d,i));return c}if(typeof a=="object"){const c=a.constructor,d=c._classRegistryKey;if(!d)throw new Error(`can't serialize object of unregistered class ${d}`);const m=c.serialize?c.serialize(a,i):{};if(!c.serialize){for(const v in a)a.hasOwnProperty(v)&&(df[d].omit.indexOf(v)>=0||(m[v]=Vc(a[v],i)));a instanceof Error&&(m.message=a.message)}if(m.$name)throw new Error("$name property is reserved for worker serialization logic.");return d!=="Object"&&(m.$name=d),m}throw new Error("can't serialize object of type "+typeof a)}function Bl(a){if(a==null||typeof a=="boolean"||typeof a=="number"||typeof a=="string"||a instanceof Boolean||a instanceof Number||a instanceof String||a instanceof Date||a instanceof RegExp||Eg(a)||Ag(a)||ArrayBuffer.isView(a)||a instanceof y.ImageData)return a;if(Array.isArray(a))return a.map(Bl);if(typeof a=="object"){const i=a.$name||"Object",{klass:c}=df[i];if(!c)throw new Error(`can't deserialize unregistered class ${i}`);if(c.deserialize)return c.deserialize(a);const d=Object.create(c.prototype);for(const m of Object.keys(a))m!=="$name"&&(d[m]=Bl(a[m]));return d}throw new Error("can't deserialize object of type "+typeof a)}const Ot={"Latin-1 Supplement":a=>a>=128&&a<=255,Arabic:a=>a>=1536&&a<=1791,"Arabic Supplement":a=>a>=1872&&a<=1919,"Arabic Extended-A":a=>a>=2208&&a<=2303,"Hangul Jamo":a=>a>=4352&&a<=4607,"Unified Canadian Aboriginal Syllabics":a=>a>=5120&&a<=5759,Khmer:a=>a>=6016&&a<=6143,"Unified Canadian Aboriginal Syllabics Extended":a=>a>=6320&&a<=6399,"General Punctuation":a=>a>=8192&&a<=8303,"Letterlike Symbols":a=>a>=8448&&a<=8527,"Number Forms":a=>a>=8528&&a<=8591,"Miscellaneous Technical":a=>a>=8960&&a<=9215,"Control Pictures":a=>a>=9216&&a<=9279,"Optical Character Recognition":a=>a>=9280&&a<=9311,"Enclosed Alphanumerics":a=>a>=9312&&a<=9471,"Geometric Shapes":a=>a>=9632&&a<=9727,"Miscellaneous Symbols":a=>a>=9728&&a<=9983,"Miscellaneous Symbols and Arrows":a=>a>=11008&&a<=11263,"CJK Radicals Supplement":a=>a>=11904&&a<=12031,"Kangxi Radicals":a=>a>=12032&&a<=12255,"Ideographic Description Characters":a=>a>=12272&&a<=12287,"CJK Symbols and Punctuation":a=>a>=12288&&a<=12351,Hiragana:a=>a>=12352&&a<=12447,Katakana:a=>a>=12448&&a<=12543,Bopomofo:a=>a>=12544&&a<=12591,"Hangul Compatibility Jamo":a=>a>=12592&&a<=12687,Kanbun:a=>a>=12688&&a<=12703,"Bopomofo Extended":a=>a>=12704&&a<=12735,"CJK Strokes":a=>a>=12736&&a<=12783,"Katakana Phonetic Extensions":a=>a>=12784&&a<=12799,"Enclosed CJK Letters and Months":a=>a>=12800&&a<=13055,"CJK Compatibility":a=>a>=13056&&a<=13311,"CJK Unified Ideographs Extension A":a=>a>=13312&&a<=19903,"Yijing Hexagram Symbols":a=>a>=19904&&a<=19967,"CJK Unified Ideographs":a=>a>=19968&&a<=40959,"Yi Syllables":a=>a>=40960&&a<=42127,"Yi Radicals":a=>a>=42128&&a<=42191,"Hangul Jamo Extended-A":a=>a>=43360&&a<=43391,"Hangul Syllables":a=>a>=44032&&a<=55215,"Hangul Jamo Extended-B":a=>a>=55216&&a<=55295,"Private Use Area":a=>a>=57344&&a<=63743,"CJK Compatibility Ideographs":a=>a>=63744&&a<=64255,"Arabic Presentation Forms-A":a=>a>=64336&&a<=65023,"Vertical Forms":a=>a>=65040&&a<=65055,"CJK Compatibility Forms":a=>a>=65072&&a<=65103,"Small Form Variants":a=>a>=65104&&a<=65135,"Arabic Presentation Forms-B":a=>a>=65136&&a<=65279,"Halfwidth and Fullwidth Forms":a=>a>=65280&&a<=65519};function Pg(a){for(const i of a)if(Cg(i.charCodeAt(0)))return!0;return!1}function rT(a){for(const i of a)if(!k0(i.charCodeAt(0)))return!1;return!0}function k0(a){return!(Ot.Arabic(a)||Ot["Arabic Supplement"](a)||Ot["Arabic Extended-A"](a)||Ot["Arabic Presentation Forms-A"](a)||Ot["Arabic Presentation Forms-B"](a))}function Cg(a){return!(a!==746&&a!==747&&(a<4352||!(Ot["Bopomofo Extended"](a)||Ot.Bopomofo(a)||Ot["CJK Compatibility Forms"](a)&&!(a>=65097&&a<=65103)||Ot["CJK Compatibility Ideographs"](a)||Ot["CJK Compatibility"](a)||Ot["CJK Radicals Supplement"](a)||Ot["CJK Strokes"](a)||!(!Ot["CJK Symbols and Punctuation"](a)||a>=12296&&a<=12305||a>=12308&&a<=12319||a===12336)||Ot["CJK Unified Ideographs Extension A"](a)||Ot["CJK Unified Ideographs"](a)||Ot["Enclosed CJK Letters and Months"](a)||Ot["Hangul Compatibility Jamo"](a)||Ot["Hangul Jamo Extended-A"](a)||Ot["Hangul Jamo Extended-B"](a)||Ot["Hangul Jamo"](a)||Ot["Hangul Syllables"](a)||Ot.Hiragana(a)||Ot["Ideographic Description Characters"](a)||Ot.Kanbun(a)||Ot["Kangxi Radicals"](a)||Ot["Katakana Phonetic Extensions"](a)||Ot.Katakana(a)&&a!==12540||!(!Ot["Halfwidth and Fullwidth Forms"](a)||a===65288||a===65289||a===65293||a>=65306&&a<=65310||a===65339||a===65341||a===65343||a>=65371&&a<=65503||a===65507||a>=65512&&a<=65519)||!(!Ot["Small Form Variants"](a)||a>=65112&&a<=65118||a>=65123&&a<=65126)||Ot["Unified Canadian Aboriginal Syllabics"](a)||Ot["Unified Canadian Aboriginal Syllabics Extended"](a)||Ot["Vertical Forms"](a)||Ot["Yijing Hexagram Symbols"](a)||Ot["Yi Syllables"](a)||Ot["Yi Radicals"](a))))}function O0(a){return!(Cg(a)||function(i){return!!(Ot["Latin-1 Supplement"](i)&&(i===167||i===169||i===174||i===177||i===188||i===189||i===190||i===215||i===247)||Ot["General Punctuation"](i)&&(i===8214||i===8224||i===8225||i===8240||i===8241||i===8251||i===8252||i===8258||i===8263||i===8264||i===8265||i===8273)||Ot["Letterlike Symbols"](i)||Ot["Number Forms"](i)||Ot["Miscellaneous Technical"](i)&&(i>=8960&&i<=8967||i>=8972&&i<=8991||i>=8996&&i<=9e3||i===9003||i>=9085&&i<=9114||i>=9150&&i<=9165||i===9167||i>=9169&&i<=9179||i>=9186&&i<=9215)||Ot["Control Pictures"](i)&&i!==9251||Ot["Optical Character Recognition"](i)||Ot["Enclosed Alphanumerics"](i)||Ot["Geometric Shapes"](i)||Ot["Miscellaneous Symbols"](i)&&!(i>=9754&&i<=9759)||Ot["Miscellaneous Symbols and Arrows"](i)&&(i>=11026&&i<=11055||i>=11088&&i<=11097||i>=11192&&i<=11243)||Ot["CJK Symbols and Punctuation"](i)||Ot.Katakana(i)||Ot["Private Use Area"](i)||Ot["CJK Compatibility Forms"](i)||Ot["Small Form Variants"](i)||Ot["Halfwidth and Fullwidth Forms"](i)||i===8734||i===8756||i===8757||i>=9984&&i<=10087||i>=10102&&i<=10131||i===65532||i===65533)}(a))}function M0(a){return a>=1424&&a<=2303||Ot["Arabic Presentation Forms-A"](a)||Ot["Arabic Presentation Forms-B"](a)}function nT(a,i){return!(!i&&M0(a)||a>=2304&&a<=3583||a>=3840&&a<=4255||Ot.Khmer(a))}function iT(a){for(const i of a)if(M0(i.charCodeAt(0)))return!0;return!1}const kg="deferred",Og="loading",Mg="loaded";let Gc=null,g="unavailable",u=null;const p=function(a){a&&typeof a=="string"&&a.indexOf("NetworkError")>-1&&(g="error"),Gc&&Gc(a)};function _(){S.fire(new tr("pluginStateChange",{pluginStatus:g,pluginURL:u}))}const S=new Si,E=function(){return g},O=function(){if(g!==kg||!u)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");g=Og,_(),u&&cs({url:u},a=>{a?p(a):(g=Mg,_())})},I={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>g===Mg||I.applyArabicShaping!=null,isLoading:()=>g===Og,setState(a){g=a.pluginStatus,u=a.pluginURL},isParsed:()=>I.applyArabicShaping!=null&&I.processBidirectionalText!=null&&I.processStyledBidirectionalText!=null,getPluginURL:()=>u};class N{constructor(i,c){this.zoom=i,c?(this.now=c.now,this.fadeDuration=c.fadeDuration,this.transition=c.transition,this.pitch=c.pitch):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0)}isSupportedScript(i){return function(c,d){for(const m of c)if(!nT(m.charCodeAt(0),d))return!1;return!0}(i,I.isLoaded())}}class G{constructor(i,c){this.property=i,this.value=c,this.expression=function(d,m){if(dh(d))return new sf(d,m);if(Nc(d)){const v=ph(d,m);if(v.result==="error")throw new Error(v.value.map(x=>`${x.key}: ${x.message}`).join(", "));return v.value}{let v=d;return typeof d=="string"&&m.type==="color"&&(v=$n.parse(d)),{kind:"constant",evaluate:()=>v}}}(c===void 0?i.specification.default:c,i.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(i,c,d){return this.property.possiblyEvaluate(this,i,c,d)}}class V{constructor(i){this.property=i,this.value=new G(i,void 0)}transitioned(i,c){return new ie(this.property,this.value,c,$t({},i.transition,this.transition),i.now)}untransitioned(){return new ie(this.property,this.value,null,{},0)}}class X{constructor(i){this._properties=i,this._values=Object.create(i.defaultTransitionablePropertyValues)}getValue(i){return Tt(this._values[i].value.value)}setValue(i,c){this._values.hasOwnProperty(i)||(this._values[i]=new V(this._values[i].property)),this._values[i].value=new G(this._values[i].property,c===null?void 0:Tt(c))}getTransition(i){return Tt(this._values[i].transition)}setTransition(i,c){this._values.hasOwnProperty(i)||(this._values[i]=new V(this._values[i].property)),this._values[i].transition=Tt(c)||void 0}serialize(){const i={};for(const c of Object.keys(this._values)){const d=this.getValue(c);d!==void 0&&(i[c]=d);const m=this.getTransition(c);m!==void 0&&(i[`${c}-transition`]=m)}return i}transitioned(i,c){const d=new ae(this._properties);for(const m of Object.keys(this._values))d._values[m]=this._values[m].transitioned(i,c._values[m]);return d}untransitioned(){const i=new ae(this._properties);for(const c of Object.keys(this._values))i._values[c]=this._values[c].untransitioned();return i}}class ie{constructor(i,c,d,m,v){const x=m.delay||0,T=m.duration||0;v=v||0,this.property=i,this.value=c,this.begin=v+x,this.end=this.begin+T,i.specification.transition&&(m.delay||m.duration)&&(this.prior=d)}possiblyEvaluate(i,c,d){const m=i.now||0,v=this.value.possiblyEvaluate(i,c,d),x=this.prior;if(x){if(m>this.end)return this.prior=null,v;if(this.value.isDataDriven())return this.prior=null,v;if(m<this.begin)return x.possiblyEvaluate(i,c,d);{const T=(m-this.begin)/(this.end-this.begin);return this.property.interpolate(x.possiblyEvaluate(i,c,d),v,Ye(T))}}return v}}class ae{constructor(i){this._properties=i,this._values=Object.create(i.defaultTransitioningPropertyValues)}possiblyEvaluate(i,c,d){const m=new he(this._properties);for(const v of Object.keys(this._values))m._values[v]=this._values[v].possiblyEvaluate(i,c,d);return m}hasTransition(){for(const i of Object.keys(this._values))if(this._values[i].prior)return!0;return!1}}class ce{constructor(i){this._properties=i,this._values=Object.create(i.defaultPropertyValues)}getValue(i){return Tt(this._values[i].value)}setValue(i,c){this._values[i]=new G(this._values[i].property,c===null?void 0:Tt(c))}serialize(){const i={};for(const c of Object.keys(this._values)){const d=this.getValue(c);d!==void 0&&(i[c]=d)}return i}possiblyEvaluate(i,c,d){const m=new he(this._properties);for(const v of Object.keys(this._values))m._values[v]=this._values[v].possiblyEvaluate(i,c,d);return m}}class le{constructor(i,c,d){this.property=i,this.value=c,this.parameters=d}isConstant(){return this.value.kind==="constant"}constantOr(i){return this.value.kind==="constant"?this.value.value:i}evaluate(i,c,d,m){return this.property.evaluate(this.value,this.parameters,i,c,d,m)}}class he{constructor(i){this._properties=i,this._values=Object.create(i.defaultPossiblyEvaluatedValues)}get(i){return this._values[i]}}class J{constructor(i){this.specification=i}possiblyEvaluate(i,c){return i.expression.evaluate(c)}interpolate(i,c,d){const m=sh[this.specification.type];return m?m(i,c,d):i}}class se{constructor(i,c){this.specification=i,this.overrides=c}possiblyEvaluate(i,c,d,m){return new le(this,i.expression.kind==="constant"||i.expression.kind==="camera"?{kind:"constant",value:i.expression.evaluate(c,null,{},d,m)}:i.expression,c)}interpolate(i,c,d){if(i.value.kind!=="constant"||c.value.kind!=="constant")return i;if(i.value.value===void 0||c.value.value===void 0)return new le(this,{kind:"constant",value:void 0},i.parameters);const m=sh[this.specification.type];return m?new le(this,{kind:"constant",value:m(i.value.value,c.value.value,d)},i.parameters):i}evaluate(i,c,d,m,v,x){return i.kind==="constant"?i.value:i.evaluate(c,d,m,v,x)}}class me{constructor(i){this.specification=i}possiblyEvaluate(i,c,d,m){return!!i.expression.evaluate(c,null,{},d,m)}interpolate(){return!1}}class ge{constructor(i){this.properties=i,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const c=new N(0,{});for(const d in i){const m=i[d];m.specification.overridable&&this.overridableProperties.push(d);const v=this.defaultPropertyValues[d]=new G(m,void 0),x=this.defaultTransitionablePropertyValues[d]=new V(m);this.defaultTransitioningPropertyValues[d]=x.untransitioned(),this.defaultPossiblyEvaluatedValues[d]=v.possiblyEvaluate(c)}}}function Te(a,i){return 256*(a=De(Math.floor(a),0,255))+De(Math.floor(i),0,255)}jt(se,"DataDrivenProperty"),jt(J,"DataConstantProperty"),jt(me,"ColorRampProperty");const Pe={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Ae{constructor(i,c){this._structArray=i,this._pos1=c*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Re{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(i,c){return i._trim(),c&&(i.isTransferred=!0,c.push(i.arrayBuffer)),{length:i.length,arrayBuffer:i.arrayBuffer}}static deserialize(i){const c=Object.create(this.prototype);return c.arrayBuffer=i.arrayBuffer,c.length=i.length,c.capacity=i.arrayBuffer.byteLength/c.bytesPerElement,c._refreshViews(),c}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(i){this.reserve(i),this.length=i}reserve(i){if(i>this.capacity){this.capacity=Math.max(i,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const c=this.uint8;this._refreshViews(),c&&this.uint8.set(c)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function Ie(a,i=1){let c=0,d=0;return{members:a.map(m=>{const v=Pe[m.type].BYTES_PER_ELEMENT,x=c=Ve(c,Math.max(i,v)),T=m.components||1;return d=Math.max(d,v),c+=v*T,{name:m.name,type:m.type,components:T,offset:x}}),size:Ve(c,Math.max(d,i)),alignment:i}}function Ve(a,i){return Math.ceil(a/i)*i}class pt extends Re{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,c){const d=this.length;return this.resize(d+1),this.emplace(d,i,c)}emplace(i,c,d){const m=2*i;return this.int16[m+0]=c,this.int16[m+1]=d,i}}pt.prototype.bytesPerElement=4,jt(pt,"StructArrayLayout2i4");class $e extends Re{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,c,d){const m=this.length;return this.resize(m+1),this.emplace(m,i,c,d)}emplace(i,c,d,m){const v=3*i;return this.int16[v+0]=c,this.int16[v+1]=d,this.int16[v+2]=m,i}}$e.prototype.bytesPerElement=6,jt($e,"StructArrayLayout3i6");class it extends Re{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,c,d,m){const v=this.length;return this.resize(v+1),this.emplace(v,i,c,d,m)}emplace(i,c,d,m,v){const x=4*i;return this.int16[x+0]=c,this.int16[x+1]=d,this.int16[x+2]=m,this.int16[x+3]=v,i}}it.prototype.bytesPerElement=8,jt(it,"StructArrayLayout4i8");class He extends Re{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,c,d,m,v,x,T){const P=this.length;return this.resize(P+1),this.emplace(P,i,c,d,m,v,x,T)}emplace(i,c,d,m,v,x,T,P){const C=6*i,D=12*i,$=3*i;return this.int16[C+0]=c,this.int16[C+1]=d,this.uint8[D+4]=m,this.uint8[D+5]=v,this.uint8[D+6]=x,this.uint8[D+7]=T,this.float32[$+2]=P,i}}He.prototype.bytesPerElement=12,jt(He,"StructArrayLayout2i4ub1f12");class ft extends Re{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,c,d,m){const v=this.length;return this.resize(v+1),this.emplace(v,i,c,d,m)}emplace(i,c,d,m,v){const x=4*i;return this.float32[x+0]=c,this.float32[x+1]=d,this.float32[x+2]=m,this.float32[x+3]=v,i}}ft.prototype.bytesPerElement=16,jt(ft,"StructArrayLayout4f16");class Ue extends Re{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,c,d,m,v){const x=this.length;return this.resize(x+1),this.emplace(x,i,c,d,m,v)}emplace(i,c,d,m,v,x){const T=6*i,P=3*i;return this.uint16[T+0]=c,this.uint16[T+1]=d,this.uint16[T+2]=m,this.uint16[T+3]=v,this.float32[P+2]=x,i}}Ue.prototype.bytesPerElement=12,jt(Ue,"StructArrayLayout4ui1f12");class nt extends Re{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,c,d,m){const v=this.length;return this.resize(v+1),this.emplace(v,i,c,d,m)}emplace(i,c,d,m,v){const x=4*i;return this.uint16[x+0]=c,this.uint16[x+1]=d,this.uint16[x+2]=m,this.uint16[x+3]=v,i}}nt.prototype.bytesPerElement=8,jt(nt,"StructArrayLayout4ui8");class yt extends Re{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,c,d,m,v,x){const T=this.length;return this.resize(T+1),this.emplace(T,i,c,d,m,v,x)}emplace(i,c,d,m,v,x,T){const P=6*i;return this.int16[P+0]=c,this.int16[P+1]=d,this.int16[P+2]=m,this.int16[P+3]=v,this.int16[P+4]=x,this.int16[P+5]=T,i}}yt.prototype.bytesPerElement=12,jt(yt,"StructArrayLayout6i12");class lt extends Re{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,c,d,m,v,x,T,P,C,D,$,U){const q=this.length;return this.resize(q+1),this.emplace(q,i,c,d,m,v,x,T,P,C,D,$,U)}emplace(i,c,d,m,v,x,T,P,C,D,$,U,q){const K=12*i;return this.int16[K+0]=c,this.int16[K+1]=d,this.int16[K+2]=m,this.int16[K+3]=v,this.uint16[K+4]=x,this.uint16[K+5]=T,this.uint16[K+6]=P,this.uint16[K+7]=C,this.int16[K+8]=D,this.int16[K+9]=$,this.int16[K+10]=U,this.int16[K+11]=q,i}}lt.prototype.bytesPerElement=24,jt(lt,"StructArrayLayout4i4ui4i24");class vt extends Re{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,c,d,m,v,x){const T=this.length;return this.resize(T+1),this.emplace(T,i,c,d,m,v,x)}emplace(i,c,d,m,v,x,T){const P=10*i,C=5*i;return this.int16[P+0]=c,this.int16[P+1]=d,this.int16[P+2]=m,this.float32[C+2]=v,this.float32[C+3]=x,this.float32[C+4]=T,i}}vt.prototype.bytesPerElement=20,jt(vt,"StructArrayLayout3i3f20");class Vt extends Re{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(i){const c=this.length;return this.resize(c+1),this.emplace(c,i)}emplace(i,c){return this.uint32[1*i+0]=c,i}}Vt.prototype.bytesPerElement=4,jt(Vt,"StructArrayLayout1ul4");class ir extends Re{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,c,d,m,v,x,T,P,C,D,$,U,q){const K=this.length;return this.resize(K+1),this.emplace(K,i,c,d,m,v,x,T,P,C,D,$,U,q)}emplace(i,c,d,m,v,x,T,P,C,D,$,U,q,K){const Q=20*i,oe=10*i;return this.int16[Q+0]=c,this.int16[Q+1]=d,this.int16[Q+2]=m,this.int16[Q+3]=v,this.int16[Q+4]=x,this.float32[oe+3]=T,this.float32[oe+4]=P,this.float32[oe+5]=C,this.float32[oe+6]=D,this.int16[Q+14]=$,this.uint32[oe+8]=U,this.uint16[Q+18]=q,this.uint16[Q+19]=K,i}}ir.prototype.bytesPerElement=40,jt(ir,"StructArrayLayout5i4f1i1ul2ui40");class zt extends Re{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,c,d,m,v,x,T){const P=this.length;return this.resize(P+1),this.emplace(P,i,c,d,m,v,x,T)}emplace(i,c,d,m,v,x,T,P){const C=8*i;return this.int16[C+0]=c,this.int16[C+1]=d,this.int16[C+2]=m,this.int16[C+4]=v,this.int16[C+5]=x,this.int16[C+6]=T,this.int16[C+7]=P,i}}zt.prototype.bytesPerElement=16,jt(zt,"StructArrayLayout3i2i2i16");class Yt extends Re{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,c,d,m,v){const x=this.length;return this.resize(x+1),this.emplace(x,i,c,d,m,v)}emplace(i,c,d,m,v,x){const T=4*i,P=8*i;return this.float32[T+0]=c,this.float32[T+1]=d,this.float32[T+2]=m,this.int16[P+6]=v,this.int16[P+7]=x,i}}Yt.prototype.bytesPerElement=16,jt(Yt,"StructArrayLayout2f1f2i16");class br extends Re{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,c,d,m){const v=this.length;return this.resize(v+1),this.emplace(v,i,c,d,m)}emplace(i,c,d,m,v){const x=12*i,T=3*i;return this.uint8[x+0]=c,this.uint8[x+1]=d,this.float32[T+1]=m,this.float32[T+2]=v,i}}br.prototype.bytesPerElement=12,jt(br,"StructArrayLayout2ub2f12");class yr extends Re{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,c,d){const m=this.length;return this.resize(m+1),this.emplace(m,i,c,d)}emplace(i,c,d,m){const v=3*i;return this.float32[v+0]=c,this.float32[v+1]=d,this.float32[v+2]=m,i}}yr.prototype.bytesPerElement=12,jt(yr,"StructArrayLayout3f12");class Nt extends Re{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,c,d){const m=this.length;return this.resize(m+1),this.emplace(m,i,c,d)}emplace(i,c,d,m){const v=3*i;return this.uint16[v+0]=c,this.uint16[v+1]=d,this.uint16[v+2]=m,i}}Nt.prototype.bytesPerElement=6,jt(Nt,"StructArrayLayout3ui6");class Fr extends Re{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(i,c,d,m,v,x,T,P,C,D,$,U,q,K,Q,oe,de,xe,fe,_e,we){const be=this.length;return this.resize(be+1),this.emplace(be,i,c,d,m,v,x,T,P,C,D,$,U,q,K,Q,oe,de,xe,fe,_e,we)}emplace(i,c,d,m,v,x,T,P,C,D,$,U,q,K,Q,oe,de,xe,fe,_e,we,be){const We=30*i,Fe=15*i,Qe=60*i;return this.int16[We+0]=c,this.int16[We+1]=d,this.int16[We+2]=m,this.float32[Fe+2]=v,this.float32[Fe+3]=x,this.uint16[We+8]=T,this.uint16[We+9]=P,this.uint32[Fe+5]=C,this.uint32[Fe+6]=D,this.uint32[Fe+7]=$,this.uint16[We+16]=U,this.uint16[We+17]=q,this.uint16[We+18]=K,this.float32[Fe+10]=Q,this.float32[Fe+11]=oe,this.uint8[Qe+48]=de,this.uint8[Qe+49]=xe,this.uint8[Qe+50]=fe,this.uint32[Fe+13]=_e,this.int16[We+28]=we,this.uint8[Qe+58]=be,i}}Fr.prototype.bytesPerElement=60,jt(Fr,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class Wr extends Re{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(i,c,d,m,v,x,T,P,C,D,$,U,q,K,Q,oe,de,xe,fe,_e,we,be,We,Fe,Qe,mt,Ke,ot,st,dt){const _t=this.length;return this.resize(_t+1),this.emplace(_t,i,c,d,m,v,x,T,P,C,D,$,U,q,K,Q,oe,de,xe,fe,_e,we,be,We,Fe,Qe,mt,Ke,ot,st,dt)}emplace(i,c,d,m,v,x,T,P,C,D,$,U,q,K,Q,oe,de,xe,fe,_e,we,be,We,Fe,Qe,mt,Ke,ot,st,dt,_t){const Je=38*i,Pt=19*i;return this.int16[Je+0]=c,this.int16[Je+1]=d,this.int16[Je+2]=m,this.float32[Pt+2]=v,this.float32[Pt+3]=x,this.int16[Je+8]=T,this.int16[Je+9]=P,this.int16[Je+10]=C,this.int16[Je+11]=D,this.int16[Je+12]=$,this.int16[Je+13]=U,this.uint16[Je+14]=q,this.uint16[Je+15]=K,this.uint16[Je+16]=Q,this.uint16[Je+17]=oe,this.uint16[Je+18]=de,this.uint16[Je+19]=xe,this.uint16[Je+20]=fe,this.uint16[Je+21]=_e,this.uint16[Je+22]=we,this.uint16[Je+23]=be,this.uint16[Je+24]=We,this.uint16[Je+25]=Fe,this.uint16[Je+26]=Qe,this.uint16[Je+27]=mt,this.uint16[Je+28]=Ke,this.uint32[Pt+15]=ot,this.float32[Pt+16]=st,this.float32[Pt+17]=dt,this.float32[Pt+18]=_t,i}}Wr.prototype.bytesPerElement=76,jt(Wr,"StructArrayLayout3i2f6i15ui1ul3f76");class qr extends Re{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i){const c=this.length;return this.resize(c+1),this.emplace(c,i)}emplace(i,c){return this.float32[1*i+0]=c,i}}qr.prototype.bytesPerElement=4,jt(qr,"StructArrayLayout1f4");class Hr extends Re{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,c,d,m,v){const x=this.length;return this.resize(x+1),this.emplace(x,i,c,d,m,v)}emplace(i,c,d,m,v,x){const T=5*i;return this.float32[T+0]=c,this.float32[T+1]=d,this.float32[T+2]=m,this.float32[T+3]=v,this.float32[T+4]=x,i}}Hr.prototype.bytesPerElement=20,jt(Hr,"StructArrayLayout5f20");class Fi extends Re{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,c,d,m){const v=this.length;return this.resize(v+1),this.emplace(v,i,c,d,m)}emplace(i,c,d,m,v){const x=6*i;return this.uint32[3*i+0]=c,this.uint16[x+2]=d,this.uint16[x+3]=m,this.uint16[x+4]=v,i}}Fi.prototype.bytesPerElement=12,jt(Fi,"StructArrayLayout1ul3ui12");class fi extends Re{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,c){const d=this.length;return this.resize(d+1),this.emplace(d,i,c)}emplace(i,c,d){const m=2*i;return this.uint16[m+0]=c,this.uint16[m+1]=d,i}}fi.prototype.bytesPerElement=4,jt(fi,"StructArrayLayout2ui4");class Wo extends Re{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i){const c=this.length;return this.resize(c+1),this.emplace(c,i)}emplace(i,c){return this.uint16[1*i+0]=c,i}}Wo.prototype.bytesPerElement=2,jt(Wo,"StructArrayLayout1ui2");class js extends Re{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,c){const d=this.length;return this.resize(d+1),this.emplace(d,i,c)}emplace(i,c,d){const m=2*i;return this.float32[m+0]=c,this.float32[m+1]=d,i}}js.prototype.bytesPerElement=8,jt(js,"StructArrayLayout2f8");class vn extends Ae{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}vn.prototype.size=40;class Kr extends ir{get(i){return new vn(this,i)}}jt(Kr,"CollisionBoxArray");class Lr extends Ae{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(i){this._structArray.uint8[this._pos1+49]=i}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(i){this._structArray.uint8[this._pos1+50]=i}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(i){this._structArray.uint32[this._pos4+13]=i}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(i){this._structArray.uint8[this._pos1+58]=i}}Lr.prototype.size=60;class Gn extends Fr{get(i){return new Lr(this,i)}}jt(Gn,"PlacedSymbolArray");class Xi extends Ae{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+11]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+13]}get key(){return this._structArray.uint16[this._pos2+14]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+17]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+19]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+21]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+22]}get featureIndex(){return this._structArray.uint16[this._pos2+23]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+25]}get numIconVertices(){return this._structArray.uint16[this._pos2+26]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+27]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+28]}get crossTileID(){return this._structArray.uint32[this._pos4+15]}set crossTileID(i){this._structArray.uint32[this._pos4+15]=i}get textOffset0(){return this._structArray.float32[this._pos4+16]}get textOffset1(){return this._structArray.float32[this._pos4+17]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+18]}}Xi.prototype.size=76;class fn extends Wr{get(i){return new Xi(this,i)}}jt(fn,"SymbolInstanceArray");class uo extends qr{getoffsetX(i){return this.float32[1*i+0]}}jt(uo,"GlyphOffsetArray");class ff extends pt{getx(i){return this.int16[2*i+0]}gety(i){return this.int16[2*i+1]}}jt(ff,"SymbolLineVertexArray");class Nl extends Ae{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}Nl.prototype.size=12;class xh extends Fi{get(i){return new Nl(this,i)}}jt(xh,"FeatureIndexArray");class pa extends fi{geta_centroid_pos0(i){return this.uint16[2*i+0]}geta_centroid_pos1(i){return this.uint16[2*i+1]}}jt(pa,"FillExtrusionCentroidArray");const rl=Ie([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),$l=Ie([{name:"a_dash",components:4,type:"Uint16"}]);var pf={exports:{}},bh={exports:{}};bh.exports=function(a,i){var c,d,m,v,x,T,P,C;for(d=a.length-(c=3&a.length),m=i,x=3432918353,T=461845907,C=0;C<d;)P=255&a.charCodeAt(C)|(255&a.charCodeAt(++C))<<8|(255&a.charCodeAt(++C))<<16|(255&a.charCodeAt(++C))<<24,++C,m=27492+(65535&(v=5*(65535&(m=(m^=P=(65535&(P=(P=(65535&P)*x+(((P>>>16)*x&65535)<<16)&4294967295)<<15|P>>>17))*T+(((P>>>16)*T&65535)<<16)&4294967295)<<13|m>>>19))+((5*(m>>>16)&65535)<<16)&4294967295))+((58964+(v>>>16)&65535)<<16);switch(P=0,c){case 3:P^=(255&a.charCodeAt(C+2))<<16;case 2:P^=(255&a.charCodeAt(C+1))<<8;case 1:m^=P=(65535&(P=(P=(65535&(P^=255&a.charCodeAt(C)))*x+(((P>>>16)*x&65535)<<16)&4294967295)<<15|P>>>17))*T+(((P>>>16)*T&65535)<<16)&4294967295}return m^=a.length,m=2246822507*(65535&(m^=m>>>16))+((2246822507*(m>>>16)&65535)<<16)&4294967295,m=3266489909*(65535&(m^=m>>>13))+((3266489909*(m>>>16)&65535)<<16)&4294967295,(m^=m>>>16)>>>0};var Ig=bh.exports,_R={exports:{}};_R.exports=function(a,i){for(var c,d=a.length,m=i^d,v=0;d>=4;)c=1540483477*(65535&(c=255&a.charCodeAt(v)|(255&a.charCodeAt(++v))<<8|(255&a.charCodeAt(++v))<<16|(255&a.charCodeAt(++v))<<24))+((1540483477*(c>>>16)&65535)<<16),m=1540483477*(65535&m)+((1540483477*(m>>>16)&65535)<<16)^(c=1540483477*(65535&(c^=c>>>24))+((1540483477*(c>>>16)&65535)<<16)),d-=4,++v;switch(d){case 3:m^=(255&a.charCodeAt(v+2))<<16;case 2:m^=(255&a.charCodeAt(v+1))<<8;case 1:m=1540483477*(65535&(m^=255&a.charCodeAt(v)))+((1540483477*(m>>>16)&65535)<<16)}return m=1540483477*(65535&(m^=m>>>13))+((1540483477*(m>>>16)&65535)<<16),(m^=m>>>15)>>>0};var xR=Ig,TH=_R.exports;pf.exports=xR,pf.exports.murmur3=xR,pf.exports.murmur2=TH;var oT=Z(pf.exports);class I0{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(i,c,d,m){this.ids.push(bR(i)),this.positions.push(c,d,m)}getPositions(i){const c=bR(i);let d=0,m=this.ids.length-1;for(;d<m;){const x=d+m>>1;this.ids[x]>=c?m=x:d=x+1}const v=[];for(;this.ids[d]===c;)v.push({index:this.positions[3*d],start:this.positions[3*d+1],end:this.positions[3*d+2]}),d++;return v}static serialize(i,c){const d=new Float64Array(i.ids),m=new Uint32Array(i.positions);return sT(d,m,0,d.length-1),c&&c.push(d.buffer,m.buffer),{ids:d,positions:m}}static deserialize(i){const c=new I0;return c.ids=i.ids,c.positions=i.positions,c.indexed=!0,c}}function bR(a){const i=+a;return!isNaN(i)&&Number.MIN_SAFE_INTEGER<=i&&i<=Number.MAX_SAFE_INTEGER?i:oT(String(a))}function sT(a,i,c,d){for(;c<d;){const m=a[c+d>>1];let v=c-1,x=d+1;for(;;){do v++;while(a[v]<m);do x--;while(a[x]>m);if(v>=x)break;R0(a,v,x),R0(i,3*v,3*x),R0(i,3*v+1,3*x+1),R0(i,3*v+2,3*x+2)}x-c<d-x?(sT(a,i,c,x),c=x+1):(sT(a,i,x+1,d),d=x)}}function R0(a,i,c){const d=a[i];a[i]=a[c],a[c]=d}jt(I0,"FeaturePositionMap");class Fl{constructor(i){this.gl=i.gl,this.initialized=!1}fetchUniformLocation(i,c){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(i,c),this.initialized=!0),!!this.location}}class D0 extends Fl{constructor(i){super(i),this.current=0}set(i,c,d){this.fetchUniformLocation(i,c)&&this.current!==d&&(this.current=d,this.gl.uniform1f(this.location,d))}}class wR extends Fl{constructor(i){super(i),this.current=[0,0,0,0]}set(i,c,d){this.fetchUniformLocation(i,c)&&(d[0]===this.current[0]&&d[1]===this.current[1]&&d[2]===this.current[2]&&d[3]===this.current[3]||(this.current=d,this.gl.uniform4f(this.location,d[0],d[1],d[2],d[3])))}}class SR extends Fl{constructor(i){super(i),this.current=$n.transparent}set(i,c,d){this.fetchUniformLocation(i,c)&&(d.r===this.current.r&&d.g===this.current.g&&d.b===this.current.b&&d.a===this.current.a||(this.current=d,this.gl.uniform4f(this.location,d.r,d.g,d.b,d.a)))}}const EH=new Float32Array(16),AH=new Float32Array(9),PH=new Float32Array(4);function aT(a){return[Te(255*a.r,255*a.g),Te(255*a.b,255*a.a)]}class Rg{constructor(i,c,d){this.value=i,this.uniformNames=c.map(m=>`u_${m}`),this.type=d}setUniform(i,c,d,m,v){c.set(i,v,m.constantOr(this.value))}getBinding(i,c){return this.type==="color"?new SR(i):new D0(i)}}class mf{constructor(i,c){this.uniformNames=c.map(d=>`u_${d}`),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(i){this.pixelRatio=i.pixelRatio||1,this.pattern=i.tl.concat(i.br)}setUniform(i,c,d,m,v){const x=v==="u_pattern"||v==="u_dash"?this.pattern:v==="u_pixel_ratio"?this.pixelRatio:null;x&&c.set(i,v,x)}getBinding(i,c){return c==="u_pattern"||c==="u_dash"?new wR(i):new D0(i)}}class Ul{constructor(i,c,d,m){this.expression=i,this.type=d,this.maxValue=0,this.paintVertexAttributes=c.map(v=>({name:`a_${v}`,type:"Float32",components:d==="color"?2:1,offset:0})),this.paintVertexArray=new m}populatePaintArray(i,c,d,m,v,x){const T=this.paintVertexArray.length,P=this.expression.evaluate(new N(0),c,{},v,m,x);this.paintVertexArray.resize(i),this._setPaintValue(T,i,P)}updatePaintArray(i,c,d,m,v){const x=this.expression.evaluate({zoom:0},d,m,void 0,v);this._setPaintValue(i,c,x)}_setPaintValue(i,c,d){if(this.type==="color"){const m=aT(d);for(let v=i;v<c;v++)this.paintVertexArray.emplace(v,m[0],m[1])}else{for(let m=i;m<c;m++)this.paintVertexArray.emplace(m,d);this.maxValue=Math.max(this.maxValue,Math.abs(d))}}upload(i){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=i.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class ma{constructor(i,c,d,m,v,x){this.expression=i,this.uniformNames=c.map(T=>`u_${T}_t`),this.type=d,this.useIntegerZoom=m,this.zoom=v,this.maxValue=0,this.paintVertexAttributes=c.map(T=>({name:`a_${T}`,type:"Float32",components:d==="color"?4:2,offset:0})),this.paintVertexArray=new x}populatePaintArray(i,c,d,m,v,x){const T=this.expression.evaluate(new N(this.zoom),c,{},v,m,x),P=this.expression.evaluate(new N(this.zoom+1),c,{},v,m,x),C=this.paintVertexArray.length;this.paintVertexArray.resize(i),this._setPaintValue(C,i,T,P)}updatePaintArray(i,c,d,m,v){const x=this.expression.evaluate({zoom:this.zoom},d,m,void 0,v),T=this.expression.evaluate({zoom:this.zoom+1},d,m,void 0,v);this._setPaintValue(i,c,x,T)}_setPaintValue(i,c,d,m){if(this.type==="color"){const v=aT(d),x=aT(m);for(let T=i;T<c;T++)this.paintVertexArray.emplace(T,v[0],v[1],x[0],x[1])}else{for(let v=i;v<c;v++)this.paintVertexArray.emplace(v,d,m);this.maxValue=Math.max(this.maxValue,Math.abs(d),Math.abs(m))}}upload(i){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=i.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(i,c,d,m,v){const x=this.useIntegerZoom?Math.floor(d.zoom):d.zoom,T=De(this.expression.interpolationFactor(x,this.zoom,this.zoom+1),0,1);c.set(i,v,T)}getBinding(i,c){return new D0(i)}}class Wc{constructor(i,c,d,m,v){this.expression=i,this.layerId=v,this.paintVertexAttributes=(d==="array"?$l:rl).members;for(let x=0;x<c.length;++x);this.paintVertexArray=new m}populatePaintArray(i,c,d){const m=this.paintVertexArray.length;this.paintVertexArray.resize(i),this._setPaintValues(m,i,c.patterns&&c.patterns[this.layerId],d)}updatePaintArray(i,c,d,m,v,x){this._setPaintValues(i,c,d.patterns&&d.patterns[this.layerId],x)}_setPaintValues(i,c,d,m){if(!m||!d)return;const v=m[d];if(!v)return;const{tl:x,br:T,pixelRatio:P}=v;for(let C=i;C<c;C++)this.paintVertexArray.emplace(C,x[0],x[1],T[0],T[1],P)}upload(i){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=i.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class qc{constructor(i,c,d=()=>!0){this.binders={},this._buffers=[];const m=[];for(const v in i.paint._values){if(!d(v))continue;const x=i.paint.get(v);if(!(x instanceof le&&zc(x.property.specification)))continue;const T=kH(v,i.type),P=x.value,C=x.property.specification.type,D=!!x.property.useIntegerZoom,$=v==="line-dasharray"||v.endsWith("pattern"),U=v==="line-dasharray"&&i.layout.get("line-cap").value.kind!=="constant";if(P.kind!=="constant"||U)if(P.kind==="source"||U||$){const q=TR(v,C,"source");this.binders[v]=$?new Wc(P,T,C,q,i.id):new Ul(P,T,C,q),m.push(`/a_${v}`)}else{const q=TR(v,C,"composite");this.binders[v]=new ma(P,T,C,D,c,q),m.push(`/z_${v}`)}else this.binders[v]=$?new mf(P.value,T):new Rg(P.value,T,C),m.push(`/u_${v}`)}this.cacheKey=m.sort().join("")}getMaxValue(i){const c=this.binders[i];return c instanceof Ul||c instanceof ma?c.maxValue:0}populatePaintArrays(i,c,d,m,v,x){for(const T in this.binders){const P=this.binders[T];(P instanceof Ul||P instanceof ma||P instanceof Wc)&&P.populatePaintArray(i,c,d,m,v,x)}}setConstantPatternPositions(i){for(const c in this.binders){const d=this.binders[c];d instanceof mf&&d.setConstantPatternPositions(i)}}updatePaintArrays(i,c,d,m,v,x){let T=!1;for(const P in i){const C=c.getPositions(P);for(const D of C){const $=d.feature(D.index);for(const U in this.binders){const q=this.binders[U];if((q instanceof Ul||q instanceof ma||q instanceof Wc)&&q.expression.isStateDependent===!0){const K=m.paint.get(U);q.expression=K.value,q.updatePaintArray(D.start,D.end,$,i[P],v,x),T=!0}}}}return T}defines(){const i=[];for(const c in this.binders){const d=this.binders[c];(d instanceof Rg||d instanceof mf)&&i.push(...d.uniformNames.map(m=>`#define HAS_UNIFORM_${m}`))}return i}getBinderAttributes(){const i=[];for(const c in this.binders){const d=this.binders[c];if(d instanceof Ul||d instanceof ma||d instanceof Wc)for(let m=0;m<d.paintVertexAttributes.length;m++)i.push(d.paintVertexAttributes[m].name)}return i}getBinderUniforms(){const i=[];for(const c in this.binders){const d=this.binders[c];if(d instanceof Rg||d instanceof mf||d instanceof ma)for(const m of d.uniformNames)i.push(m)}return i}getPaintVertexBuffers(){return this._buffers}getUniforms(i){const c=[];for(const d in this.binders){const m=this.binders[d];if(m instanceof Rg||m instanceof mf||m instanceof ma)for(const v of m.uniformNames)c.push({name:v,property:d,binding:m.getBinding(i,v)})}return c}setUniforms(i,c,d,m,v){for(const{name:x,property:T,binding:P}of d)this.binders[T].setUniform(i,P,v,m.get(T),x)}updatePaintBuffers(){this._buffers=[];for(const i in this.binders){const c=this.binders[i];(c instanceof Ul||c instanceof ma||c instanceof Wc)&&c.paintVertexBuffer&&this._buffers.push(c.paintVertexBuffer)}}upload(i){for(const c in this.binders){const d=this.binders[c];(d instanceof Ul||d instanceof ma||d instanceof Wc)&&d.upload(i)}this.updatePaintBuffers()}destroy(){for(const i in this.binders){const c=this.binders[i];(c instanceof Ul||c instanceof ma||c instanceof Wc)&&c.destroy()}}}class wh{constructor(i,c,d=()=>!0){this.programConfigurations={};for(const m of i)this.programConfigurations[m.id]=new qc(m,c,d);this.needsUpload=!1,this._featureMap=new I0,this._bufferOffset=0}populatePaintArrays(i,c,d,m,v,x,T){for(const P in this.programConfigurations)this.programConfigurations[P].populatePaintArrays(i,c,m,v,x,T);c.id!==void 0&&this._featureMap.add(c.id,d,this._bufferOffset,i),this._bufferOffset=i,this.needsUpload=!0}updatePaintArrays(i,c,d,m,v){for(const x of d)this.needsUpload=this.programConfigurations[x.id].updatePaintArrays(i,this._featureMap,c,x,m,v)||this.needsUpload}get(i){return this.programConfigurations[i]}upload(i){if(this.needsUpload){for(const c in this.programConfigurations)this.programConfigurations[c].upload(i);this.needsUpload=!1}}destroy(){for(const i in this.programConfigurations)this.programConfigurations[i].destroy()}}const CH={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function kH(a,i){return CH[a]||[a.replace(`${i}-`,"").replace(/-/g,"_")]}const OH={"line-pattern":{source:Ue,composite:Ue},"fill-pattern":{source:Ue,composite:Ue},"fill-extrusion-pattern":{source:Ue,composite:Ue},"line-dasharray":{source:nt,composite:nt}},MH={color:{source:js,composite:ft},number:{source:qr,composite:js}};function TR(a,i,c){const d=OH[a];return d&&d[c]||MH[i][c]}jt(Rg,"ConstantBinder"),jt(mf,"PatternConstantBinder"),jt(Ul,"SourceExpressionBinder"),jt(Wc,"PatternCompositeBinder"),jt(ma,"CompositeExpressionBinder"),jt(qc,"ProgramConfiguration",{omit:["_buffers"]}),jt(wh,"ProgramConfigurationSet");const ER="-transition";class ga extends Si{constructor(i,c){if(super(),this.id=i.id,this.type=i.type,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,i.type!=="custom"&&(this.metadata=i.metadata,this.minzoom=i.minzoom,this.maxzoom=i.maxzoom,i.type!=="background"&&i.type!=="sky"&&(this.source=i.source,this.sourceLayer=i["source-layer"],this.filter=i.filter),c.layout&&(this._unevaluatedLayout=new ce(c.layout)),c.paint)){this._transitionablePaint=new X(c.paint);for(const d in i.paint)this.setPaintProperty(d,i.paint[d],{validate:!1});for(const d in i.layout)this.setLayoutProperty(d,i.layout[d],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new he(c.paint)}}getLayoutProperty(i){return i==="visibility"?this.visibility:this._unevaluatedLayout.getValue(i)}setLayoutProperty(i,c,d={}){c!=null&&this._validate(eT,`layers.${this.id}.layout.${i}`,i,c,d)||(i!=="visibility"?this._unevaluatedLayout.setValue(i,c):this.visibility=c)}getPaintProperty(i){return rr(i,ER)?this._transitionablePaint.getTransition(i.slice(0,-11)):this._transitionablePaint.getValue(i)}setPaintProperty(i,c,d={}){if(c!=null&&this._validate(QS,`layers.${this.id}.paint.${i}`,i,c,d))return!1;if(rr(i,ER))return this._transitionablePaint.setTransition(i.slice(0,-11),c||void 0),!1;{const m=this._transitionablePaint._values[i],v=m.value.isDataDriven(),x=m.value;this._transitionablePaint.setValue(i,c),this._handleSpecialPaintPropertyUpdate(i);const T=this._transitionablePaint._values[i].value,P=T.isDataDriven(),C=rr(i,"pattern")||i==="line-dasharray";return P||v||C||this._handleOverridablePaintPropertyUpdate(i,x,T)}}_handleSpecialPaintPropertyUpdate(i){}getProgramIds(){return null}getProgramConfiguration(i){return null}_handleOverridablePaintPropertyUpdate(i,c,d){return!1}isHidden(i){return!!(this.minzoom&&i<this.minzoom)||!!(this.maxzoom&&i>=this.maxzoom)||this.visibility==="none"}updateTransitions(i){this._transitioningPaint=this._transitionablePaint.transitioned(i,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(i,c){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(i,void 0,c)),this.paint=this._transitioningPaint.possiblyEvaluate(i,void 0,c)}serialize(){const i={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(i.layout=i.layout||{},i.layout.visibility=this.visibility),qt(i,(c,d)=>!(c===void 0||d==="layout"&&!Object.keys(c).length||d==="paint"&&!Object.keys(c).length))}_validate(i,c,d,m,v={}){return(!v||v.validate!==!1)&&C0(this,i.call(P0,{key:c,layerType:this.type,objectKey:d,value:m,styleSpec:Xe,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const i in this.paint._values){const c=this.paint.get(i);if(c instanceof le&&zc(c.property.specification)&&(c.value.kind==="source"||c.value.kind==="composite")&&c.value.isStateDependent)return!0}return!1}compileFilter(){this._filterCompiled||(this._featureFilter=cf(this.filter),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}}const IH=Ie([{name:"a_pos",components:2,type:"Int16"}],4),RH=Ie([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class Wn{constructor(i=[]){this.segments=i}prepareSegment(i,c,d,m){let v=this.segments[this.segments.length-1];return i>Wn.MAX_VERTEX_ARRAY_LENGTH&&Et(`Max vertices per segment is ${Wn.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${i}`),(!v||v.vertexLength+i>Wn.MAX_VERTEX_ARRAY_LENGTH||v.sortKey!==m)&&(v={vertexOffset:c.length,primitiveOffset:d.length,vertexLength:0,primitiveLength:0},m!==void 0&&(v.sortKey=m),this.segments.push(v)),v}get(){return this.segments}destroy(){for(const i of this.segments)for(const c in i.vaos)i.vaos[c].destroy()}static simpleSegment(i,c,d,m){return new Wn([{vertexOffset:i,primitiveOffset:c,vertexLength:d,primitiveLength:m,vaos:{},sortKey:0}])}}Wn.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,jt(Wn,"SegmentVector");var Zt=8192;class Hc{constructor(i,c){i&&(c?this.setSouthWest(i).setNorthEast(c):i.length===4?this.setSouthWest([i[0],i[1]]).setNorthEast([i[2],i[3]]):this.setSouthWest(i[0]).setNorthEast(i[1]))}setNorthEast(i){return this._ne=i instanceof Zr?new Zr(i.lng,i.lat):Zr.convert(i),this}setSouthWest(i){return this._sw=i instanceof Zr?new Zr(i.lng,i.lat):Zr.convert(i),this}extend(i){const c=this._sw,d=this._ne;let m,v;if(i instanceof Zr)m=i,v=i;else{if(!(i instanceof Hc))return Array.isArray(i)?i.length===4||i.every(Array.isArray)?this.extend(Hc.convert(i)):this.extend(Zr.convert(i)):typeof i=="object"&&i!==null&&i.hasOwnProperty("lat")&&(i.hasOwnProperty("lon")||i.hasOwnProperty("lng"))?this.extend(Zr.convert(i)):this;if(m=i._sw,v=i._ne,!m||!v)return this}return c||d?(c.lng=Math.min(m.lng,c.lng),c.lat=Math.min(m.lat,c.lat),d.lng=Math.max(v.lng,d.lng),d.lat=Math.max(v.lat,d.lat)):(this._sw=new Zr(m.lng,m.lat),this._ne=new Zr(v.lng,v.lat)),this}getCenter(){return new Zr((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new Zr(this.getWest(),this.getNorth())}getSouthEast(){return new Zr(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(i){const{lng:c,lat:d}=Zr.convert(i);let m=this._sw.lng<=c&&c<=this._ne.lng;return this._sw.lng>this._ne.lng&&(m=this._sw.lng>=c&&c>=this._ne.lng),this._sw.lat<=d&&d<=this._ne.lat&&m}static convert(i){return!i||i instanceof Hc?i:new Hc(i)}}var L0=1e-6,qo=typeof Float32Array<"u"?Float32Array:Array;function AR(){var a=new qo(9);return qo!=Float32Array&&(a[1]=0,a[2]=0,a[3]=0,a[5]=0,a[6]=0,a[7]=0),a[0]=1,a[4]=1,a[8]=1,a}function PR(a,i,c){var d=i[0],m=i[1],v=i[2],x=i[3],T=i[4],P=i[5],C=i[6],D=i[7],$=i[8],U=c[0],q=c[1],K=c[2],Q=c[3],oe=c[4],de=c[5],xe=c[6],fe=c[7],_e=c[8];return a[0]=U*d+q*x+K*C,a[1]=U*m+q*T+K*D,a[2]=U*v+q*P+K*$,a[3]=Q*d+oe*x+de*C,a[4]=Q*m+oe*T+de*D,a[5]=Q*v+oe*P+de*$,a[6]=xe*d+fe*x+_e*C,a[7]=xe*m+fe*T+_e*D,a[8]=xe*v+fe*P+_e*$,a}function ya(a){return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a}function lT(a,i){var c=i[0],d=i[1],m=i[2],v=i[3],x=i[4],T=i[5],P=i[6],C=i[7],D=i[8],$=i[9],U=i[10],q=i[11],K=i[12],Q=i[13],oe=i[14],de=i[15],xe=c*T-d*x,fe=c*P-m*x,_e=c*C-v*x,we=d*P-m*T,be=d*C-v*T,We=m*C-v*P,Fe=D*Q-$*K,Qe=D*oe-U*K,mt=D*de-q*K,Ke=$*oe-U*Q,ot=$*de-q*Q,st=U*de-q*oe,dt=xe*st-fe*ot+_e*Ke+we*mt-be*Qe+We*Fe;return dt?(a[0]=(T*st-P*ot+C*Ke)*(dt=1/dt),a[1]=(m*ot-d*st-v*Ke)*dt,a[2]=(Q*We-oe*be+de*we)*dt,a[3]=(U*be-$*We-q*we)*dt,a[4]=(P*mt-x*st-C*Qe)*dt,a[5]=(c*st-m*mt+v*Qe)*dt,a[6]=(oe*_e-K*We-de*fe)*dt,a[7]=(D*We-U*_e+q*fe)*dt,a[8]=(x*ot-T*mt+C*Fe)*dt,a[9]=(d*mt-c*ot-v*Fe)*dt,a[10]=(K*be-Q*_e+de*xe)*dt,a[11]=($*_e-D*be-q*xe)*dt,a[12]=(T*Qe-x*Ke-P*Fe)*dt,a[13]=(c*Ke-d*Qe+m*Fe)*dt,a[14]=(Q*fe-K*we-oe*xe)*dt,a[15]=(D*we-$*fe+U*xe)*dt,a):null}function Sh(a,i,c){var d=i[0],m=i[1],v=i[2],x=i[3],T=i[4],P=i[5],C=i[6],D=i[7],$=i[8],U=i[9],q=i[10],K=i[11],Q=i[12],oe=i[13],de=i[14],xe=i[15],fe=c[0],_e=c[1],we=c[2],be=c[3];return a[0]=fe*d+_e*T+we*$+be*Q,a[1]=fe*m+_e*P+we*U+be*oe,a[2]=fe*v+_e*C+we*q+be*de,a[3]=fe*x+_e*D+we*K+be*xe,a[4]=(fe=c[4])*d+(_e=c[5])*T+(we=c[6])*$+(be=c[7])*Q,a[5]=fe*m+_e*P+we*U+be*oe,a[6]=fe*v+_e*C+we*q+be*de,a[7]=fe*x+_e*D+we*K+be*xe,a[8]=(fe=c[8])*d+(_e=c[9])*T+(we=c[10])*$+(be=c[11])*Q,a[9]=fe*m+_e*P+we*U+be*oe,a[10]=fe*v+_e*C+we*q+be*de,a[11]=fe*x+_e*D+we*K+be*xe,a[12]=(fe=c[12])*d+(_e=c[13])*T+(we=c[14])*$+(be=c[15])*Q,a[13]=fe*m+_e*P+we*U+be*oe,a[14]=fe*v+_e*C+we*q+be*de,a[15]=fe*x+_e*D+we*K+be*xe,a}function Dg(a,i,c){var d,m,v,x,T,P,C,D,$,U,q,K,Q=c[0],oe=c[1],de=c[2];return i===a?(a[12]=i[0]*Q+i[4]*oe+i[8]*de+i[12],a[13]=i[1]*Q+i[5]*oe+i[9]*de+i[13],a[14]=i[2]*Q+i[6]*oe+i[10]*de+i[14],a[15]=i[3]*Q+i[7]*oe+i[11]*de+i[15]):(m=i[1],v=i[2],x=i[3],T=i[4],P=i[5],C=i[6],D=i[7],$=i[8],U=i[9],q=i[10],K=i[11],a[0]=d=i[0],a[1]=m,a[2]=v,a[3]=x,a[4]=T,a[5]=P,a[6]=C,a[7]=D,a[8]=$,a[9]=U,a[10]=q,a[11]=K,a[12]=d*Q+T*oe+$*de+i[12],a[13]=m*Q+P*oe+U*de+i[13],a[14]=v*Q+C*oe+q*de+i[14],a[15]=x*Q+D*oe+K*de+i[15]),a}function Th(a,i,c){var d=c[0],m=c[1],v=c[2];return a[0]=i[0]*d,a[1]=i[1]*d,a[2]=i[2]*d,a[3]=i[3]*d,a[4]=i[4]*m,a[5]=i[5]*m,a[6]=i[6]*m,a[7]=i[7]*m,a[8]=i[8]*v,a[9]=i[9]*v,a[10]=i[10]*v,a[11]=i[11]*v,a[12]=i[12],a[13]=i[13],a[14]=i[14],a[15]=i[15],a}function cT(a,i,c){var d=Math.sin(c),m=Math.cos(c),v=i[4],x=i[5],T=i[6],P=i[7],C=i[8],D=i[9],$=i[10],U=i[11];return i!==a&&(a[0]=i[0],a[1]=i[1],a[2]=i[2],a[3]=i[3],a[12]=i[12],a[13]=i[13],a[14]=i[14],a[15]=i[15]),a[4]=v*m+C*d,a[5]=x*m+D*d,a[6]=T*m+$*d,a[7]=P*m+U*d,a[8]=C*m-v*d,a[9]=D*m-x*d,a[10]=$*m-T*d,a[11]=U*m-P*d,a}function j0(a,i,c){var d=Math.sin(c),m=Math.cos(c),v=i[0],x=i[1],T=i[2],P=i[3],C=i[8],D=i[9],$=i[10],U=i[11];return i!==a&&(a[4]=i[4],a[5]=i[5],a[6]=i[6],a[7]=i[7],a[12]=i[12],a[13]=i[13],a[14]=i[14],a[15]=i[15]),a[0]=v*m-C*d,a[1]=x*m-D*d,a[2]=T*m-$*d,a[3]=P*m-U*d,a[8]=v*d+C*m,a[9]=x*d+D*m,a[10]=T*d+$*m,a[11]=P*d+U*m,a}function CR(a,i){return a[0]=i[0],a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=i[1],a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=i[2],a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a}function kR(a,i,c){var d,m,v,x=c[0],T=c[1],P=c[2],C=Math.hypot(x,T,P);return C<L0?null:(x*=C=1/C,T*=C,P*=C,d=Math.sin(i),m=Math.cos(i),a[0]=x*x*(v=1-m)+m,a[1]=T*x*v+P*d,a[2]=P*x*v-T*d,a[3]=0,a[4]=x*T*v-P*d,a[5]=T*T*v+m,a[6]=P*T*v+x*d,a[7]=0,a[8]=x*P*v+T*d,a[9]=T*P*v-x*d,a[10]=P*P*v+m,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a)}Math.hypot||(Math.hypot=function(){for(var a=0,i=arguments.length;i--;)a+=arguments[i]*arguments[i];return Math.sqrt(a)});var DH=Sh;function uT(){var a=new qo(3);return qo!=Float32Array&&(a[0]=0,a[1]=0,a[2]=0),a}function OR(a){var i=new qo(3);return i[0]=a[0],i[1]=a[1],i[2]=a[2],i}function Lg(a){return Math.hypot(a[0],a[1],a[2])}function gf(a,i,c){var d=new qo(3);return d[0]=a,d[1]=i,d[2]=c,d}function Vl(a,i,c){return a[0]=i[0]+c[0],a[1]=i[1]+c[1],a[2]=i[2]+c[2],a}function hT(a,i,c){return a[0]=i[0]-c[0],a[1]=i[1]-c[1],a[2]=i[2]-c[2],a}function MR(a,i,c){return a[0]=i[0]*c[0],a[1]=i[1]*c[1],a[2]=i[2]*c[2],a}function jg(a,i,c){return a[0]=Math.min(i[0],c[0]),a[1]=Math.min(i[1],c[1]),a[2]=Math.min(i[2],c[2]),a}function zg(a,i,c){return a[0]=Math.max(i[0],c[0]),a[1]=Math.max(i[1],c[1]),a[2]=Math.max(i[2],c[2]),a}function fs(a,i,c){return a[0]=i[0]*c,a[1]=i[1]*c,a[2]=i[2]*c,a}function Bg(a,i,c,d){return a[0]=i[0]+c[0]*d,a[1]=i[1]+c[1]*d,a[2]=i[2]+c[2]*d,a}function ho(a,i){var c=i[0],d=i[1],m=i[2],v=c*c+d*d+m*m;return v>0&&(v=1/Math.sqrt(v)),a[0]=i[0]*v,a[1]=i[1]*v,a[2]=i[2]*v,a}function zs(a,i){return a[0]*i[0]+a[1]*i[1]+a[2]*i[2]}function dT(a,i,c){var d=i[0],m=i[1],v=i[2],x=c[0],T=c[1],P=c[2];return a[0]=m*P-v*T,a[1]=v*x-d*P,a[2]=d*T-m*x,a}function Fn(a,i,c){var d=i[0],m=i[1],v=i[2],x=c[3]*d+c[7]*m+c[11]*v+c[15];return a[0]=(c[0]*d+c[4]*m+c[8]*v+c[12])/(x=x||1),a[1]=(c[1]*d+c[5]*m+c[9]*v+c[13])/x,a[2]=(c[2]*d+c[6]*m+c[10]*v+c[14])/x,a}function IR(a,i,c){var d=c[0],m=c[1],v=c[2],x=i[0],T=i[1],P=i[2],C=m*P-v*T,D=v*x-d*P,$=d*T-m*x,U=m*$-v*D,q=v*C-d*$,K=d*D-m*C,Q=2*c[3];return D*=Q,$*=Q,q*=2,K*=2,a[0]=x+(C*=Q)+(U*=2),a[1]=T+D+q,a[2]=P+$+K,a}var Ng,va=hT,LH=MR,jH=Lg;function RR(a,i,c){return a[0]=i[0]*c,a[1]=i[1]*c,a[2]=i[2]*c,a[3]=i[3]*c,a}function DR(a,i){var c=i[0],d=i[1],m=i[2],v=i[3],x=c*c+d*d+m*m+v*v;return x>0&&(x=1/Math.sqrt(x)),a[0]=c*x,a[1]=d*x,a[2]=m*x,a[3]=v*x,a}function Eh(a,i,c){var d=i[0],m=i[1],v=i[2],x=i[3];return a[0]=c[0]*d+c[4]*m+c[8]*v+c[12]*x,a[1]=c[1]*d+c[5]*m+c[9]*v+c[13]*x,a[2]=c[2]*d+c[6]*m+c[10]*v+c[14]*x,a[3]=c[3]*d+c[7]*m+c[11]*v+c[15]*x,a}function LR(){var a=new qo(4);return qo!=Float32Array&&(a[0]=0,a[1]=0,a[2]=0),a[3]=1,a}function jR(a){return a[0]=0,a[1]=0,a[2]=0,a[3]=1,a}function zR(a,i,c){c*=.5;var d=i[0],m=i[1],v=i[2],x=i[3],T=Math.sin(c),P=Math.cos(c);return a[0]=d*P+x*T,a[1]=m*P+v*T,a[2]=v*P-m*T,a[3]=x*P-d*T,a}function BR(a,i,c){c*=.5;var d=i[0],m=i[1],v=i[2],x=i[3],T=Math.sin(c),P=Math.cos(c);return a[0]=d*P-v*T,a[1]=m*P+x*T,a[2]=v*P+d*T,a[3]=x*P-m*T,a}uT(),Ng=new qo(4),qo!=Float32Array&&(Ng[0]=0,Ng[1]=0,Ng[2]=0,Ng[3]=0);var zH=DR;uT(),gf(1,0,0),gf(0,1,0),LR(),LR(),AR();const BH=Ie([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:NR}=BH,$R=Ie([{name:"a_pos_3",components:3,type:"Int16"}]);var $g=Ie([{name:"a_pos",type:"Int16",components:2}]);class fT{constructor(i,c){this.pos=i,this.dir=c}intersectsPlane(i,c,d){const m=zs(c,this.dir);if(Math.abs(m)<1e-6)return!1;const v=((i[0]-this.pos[0])*c[0]+(i[1]-this.pos[1])*c[1]+(i[2]-this.pos[2])*c[2])/m;return d[0]=this.pos[0]+this.dir[0]*v,d[1]=this.pos[1]+this.dir[1]*v,d[2]=this.pos[2]+this.dir[2]*v,!0}closestPointOnSphere(i,c,d){if(function(q,K){var Q=q[0],oe=q[1],de=q[2],xe=K[0],fe=K[1],_e=K[2];return Math.abs(Q-xe)<=L0*Math.max(1,Math.abs(Q),Math.abs(xe))&&Math.abs(oe-fe)<=L0*Math.max(1,Math.abs(oe),Math.abs(fe))&&Math.abs(de-_e)<=L0*Math.max(1,Math.abs(de),Math.abs(_e))}(this.pos,i)||c===0)return d[0]=d[1]=d[2]=0,!1;const[m,v,x]=this.dir,T=this.pos[0]-i[0],P=this.pos[1]-i[1],C=this.pos[2]-i[2],D=m*m+v*v+x*x,$=2*(T*m+P*v+C*x),U=$*$-4*D*(T*T+P*P+C*C-c*c);if(U<0){const q=Math.max(-$/2,0),K=T+m*q,Q=P+v*q,oe=C+x*q,de=Math.hypot(K,Q,oe);return d[0]=K*c/de,d[1]=Q*c/de,d[2]=oe*c/de,!1}{const q=(-$-Math.sqrt(U))/(2*D);if(q<0){const K=Math.hypot(T,P,C);return d[0]=T*c/K,d[1]=P*c/K,d[2]=C*c/K,!1}return d[0]=T+m*q,d[1]=P+v*q,d[2]=C+x*q,!0}}}class pT{constructor(i,c,d,m,v){this.TL=i,this.TR=c,this.BR=d,this.BL=m,this.horizon=v}static fromInvProjectionMatrix(i,c,d){const m=[-1,1,1],v=[1,1,1],x=[1,-1,1],T=[-1,-1,1],P=Fn(m,m,i),C=Fn(v,v,i),D=Fn(x,x,i),$=Fn(T,T,i);return new pT(P,C,D,$,c/d)}}class mT{constructor(i,c){this.points=i,this.planes=c}static fromInvProjectionMatrix(i,c,d,m){const v=Math.pow(2,d),x=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(P=>{const C=Eh([],P,i),D=1/C[3]/c*v;return function($,U,q){return $[0]=U[0]*q[0],$[1]=U[1]*q[1],$[2]=U[2]*q[2],$[3]=U[3]*q[3],$}(C,C,[D,D,m?1/C[3]:D,D])}),T=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(P=>{const C=ho([],dT([],va([],x[P[0]],x[P[1]]),va([],x[P[2]],x[P[1]]))),D=-zs(C,x[P[1]]);return C.concat(D)});return new mT(x,T)}}class fo{static fromPoints(i){const c=[1/0,1/0,1/0],d=[-1/0,-1/0,-1/0];for(const m of i)jg(c,c,m),zg(d,d,m);return new fo(c,d)}static applyTransform(i,c){const d=i.getCorners();for(let m=0;m<d.length;++m)Fn(d[m],d[m],c);return fo.fromPoints(d)}constructor(i,c){this.min=i,this.max=c,this.center=fs([],Vl([],this.min,this.max),.5)}quadrant(i){const c=[i%2==0,i<2],d=OR(this.min),m=OR(this.max);for(let v=0;v<c.length;v++)d[v]=c[v]?this.min[v]:this.center[v],m[v]=c[v]?this.center[v]:this.max[v];return m[2]=this.max[2],new fo(d,m)}distanceX(i){return Math.max(Math.min(this.max[0],i[0]),this.min[0])-i[0]}distanceY(i){return Math.max(Math.min(this.max[1],i[1]),this.min[1])-i[1]}distanceZ(i){return Math.max(Math.min(this.max[2],i[2]),this.min[2])-i[2]}getCorners(){const i=this.min,c=this.max;return[[i[0],i[1],i[2]],[c[0],i[1],i[2]],[c[0],c[1],i[2]],[i[0],c[1],i[2]],[i[0],i[1],c[2]],[c[0],i[1],c[2]],[c[0],c[1],c[2]],[i[0],c[1],c[2]]]}intersects(i){const c=this.getCorners();let d=!0;for(let m=0;m<i.planes.length;m++){const v=i.planes[m];let x=0;for(let T=0;T<c.length;T++)x+=zs(v,c[T])+v[3]>=0;if(x===0)return 0;x!==c.length&&(d=!1)}if(d)return 2;for(let m=0;m<3;m++){let v=Number.MAX_VALUE,x=-Number.MAX_VALUE;for(let T=0;T<i.points.length;T++){const P=i.points[T][m]-this.min[m];v=Math.min(v,P),x=Math.max(x,P)}if(x<0||v>this.max[m]-this.min[m])return 0}return 1}}const gT=5,FR=6,nl=Zt/Math.PI/2,NH=16383,Ah=64,Fg=[Ah,32,16],Bs=-nl,Ns=nl,$H=[new fo([Bs,Bs,Bs],[Ns,Ns,Ns]),new fo([Bs,Bs,Bs],[0,0,Ns]),new fo([0,Bs,Bs],[Ns,0,Ns]),new fo([Bs,0,Bs],[0,Ns,Ns]),new fo([0,0,Bs],[Ns,Ns,Ns])];function z0(a){return a*nl/Gg}function UR(a,i,c,d=!0){const m=fs([],a._camera.position,a.worldSize),v=[i,c,1,1];Eh(v,v,a.pixelMatrixInverse),RR(v,v,1/v[3]);const x=ho([],va([],v,m)),T=a.globeMatrix,P=[T[12],T[13],T[14]],C=va([],P,m),D=Lg(C),$=ho([],C),U=a.worldSize/(2*Math.PI),q=zs($,x),K=Math.asin(U/D);if(K<Math.acos(q)){if(!d)return null;const mt=[],Ke=[];fs(mt,x,D/q),ho(Ke,va(Ke,mt,C)),ho(x,Vl(x,C,fs(x,Ke,Math.tan(K)*D)))}const Q=[];new fT(m,x).closestPointOnSphere(P,U,Q);const oe=ho([],Zi(T,0)),de=ho([],Zi(T,1)),xe=ho([],Zi(T,2)),fe=zs(oe,Q),_e=zs(de,Q),we=zs(xe,Q),be=Ge(Math.asin(-_e/U));let We=Ge(Math.atan2(fe,we));We=a.center.lng+function(mt,Ke){const ot=(Ke-mt+180)%360-180;return ot<-180?ot+360:ot}(a.center.lng,We);const Fe=ol(We),Qe=De(sl(be),0,1);return new xf(Fe,Qe)}class FH{constructor(i,c,d){this.a=va([],i,d),this.b=va([],c,d),this.center=d;const m=ho([],this.a),v=ho([],this.b);this.angle=Math.acos(zs(m,v))}}function yT(a,i){if(a.angle===0)return null;let c;return c=a.a[i]===0?1/a.angle*.5*Math.PI:1/a.angle*Math.atan(a.b[i]/a.a[i]/Math.sin(a.angle)-1/Math.tan(a.angle)),c<0||c>1?null:function(d,m,v,x){const T=Math.sin(v);return d*(Math.sin((1-x)*v)/T)+m*(Math.sin(x*v)/T)}(a.a[i],a.b[i],a.angle,De(c,0,1))+a.center[i]}function il(a){if(a.z<=1)return $H[a.z+2*a.y+a.x];const i=vT(B0(a));return fo.fromPoints(i)}function Ph(a,i,c){return fs(a,a,1-c),Bg(a,a,i,c)}function VR(a,i){const c=_f(i.zoom);if(c===0)return il(a);const d=B0(a),m=vT(d),v=ol(d.getWest())*i.worldSize,x=ol(d.getEast())*i.worldSize,T=sl(d.getNorth())*i.worldSize,P=sl(d.getSouth())*i.worldSize,C=[v,T,0],D=[x,T,0],$=[v,P,0],U=[x,P,0],q=lT([],i.globeMatrix);return Fn(C,C,q),Fn(D,D,q),Fn($,$,q),Fn(U,U,q),m[0]=Ph(m[0],$,c),m[1]=Ph(m[1],U,c),m[2]=Ph(m[2],D,c),m[3]=Ph(m[3],C,c),fo.fromPoints(m)}function GR(a,i,c){for(const d of a)Fn(d,d,i),fs(d,d,c)}function UH(a,i,c){const d=i/a.worldSize,m=a.globeMatrix;if(c.z<=1){const Fe=il(c).getCorners();return GR(Fe,m,d),fo.fromPoints(Fe)}const v=B0(c),x=vT(v);GR(x,m,d);const T=Number.MAX_VALUE,P=[-T,-T,-T],C=[T,T,T];if(v.contains(a.center)){for(const mt of x)jg(C,C,mt),zg(P,P,mt);P[2]=0;const Fe=a.point,Qe=[Fe.x*d,Fe.y*d,0];return jg(C,C,Qe),zg(P,P,Qe),new fo(C,P)}const D=[m[12]*d,m[13]*d,m[14]*d],$=v.getCenter(),U=De(a.center.lat,-Vi,Vi),q=De($.lat,-Vi,Vi),K=ol(a.center.lng),Q=sl(U);let oe=K-ol($.lng);const de=Q-sl(q);oe>.5?oe-=1:oe<-.5&&(oe+=1);let xe=0;Math.abs(oe)>Math.abs(de)?xe=oe>=0?1:3:(xe=de>=0?0:2,Bg(D,D,[m[4]*d,m[5]*d,m[6]*d],-Math.sin(je(de>=0?v.getSouth():v.getNorth()))*nl));const fe=x[xe],_e=x[(xe+1)%4],we=new FH(fe,_e,D),be=[yT(we,0)||fe[0],yT(we,1)||fe[1],yT(we,2)||fe[2]],We=_f(a.zoom);if(We>0){const Fe=function({x:mt,y:Ke,z:ot},st,dt,_t,Je){const Pt=1/(1<<ot);let Bt=mt*Pt,kt=Bt+Pt,ar=Ke*Pt,bt=ar+Pt,Gt=0;const lr=(Bt+kt)/2-_t;return lr>.5?Gt=-1:lr<-.5&&(Gt=1),Bt=((Bt+Gt)*st-(_t*=st))*dt+_t,kt=((kt+Gt)*st-_t)*dt+_t,ar=(ar*st-(Je*=st))*dt+Je,bt=(bt*st-Je)*dt+Je,[[Bt,bt,0],[kt,bt,0],[kt,ar,0],[Bt,ar,0]]}(c,i,a._pixelsPerMercatorPixel,K,Q);for(let mt=0;mt<x.length;mt++)Ph(x[mt],Fe[mt],We);const Qe=Vl([],Fe[xe],Fe[(xe+1)%4]);fs(Qe,Qe,.5),Ph(be,Qe,We)}for(const Fe of x)jg(C,C,Fe),zg(P,P,Fe);return C[2]=Math.min(fe[2],_e[2]),jg(C,C,be),zg(P,P,be),new fo(C,P)}function B0({x:a,y:i,z:c}){const d=1/(1<<c),m=new Zr(ps(a*d),Ui((i+1)*d)),v=new Zr(ps((a+1)*d),Ui(i*d));return new Hc(m,v)}function vT(a){const i=je(a.getNorth()),c=je(a.getSouth()),d=Math.cos(i),m=Math.cos(c),v=Math.sin(i),x=Math.sin(c),T=a.getWest(),P=a.getEast();return[yf(m,x,T),yf(m,x,P),yf(d,v,P),yf(d,v,T)]}function yf(a,i,c,d=nl){return c=je(c),[a*Math.sin(c)*d,-i*d,a*Math.cos(c)*d]}function vf(a,i,c){return yf(Math.cos(je(a)),Math.sin(je(a)),i,c)}function Ug(a,i,c,d){const m=1<<c.z,v=(a/Zt+c.x)/m;return vf(Ui((i/Zt+c.y)/m),ps(v),d)}function N0({min:a,max:i}){return NH/Math.max(i[0]-a[0],i[1]-a[1],i[2]-a[2])}const WR=new Float64Array(16);function Vg(a){const i=N0(a),c=CR(WR,[i,i,i]);return Dg(c,c,((d=[])[0]=-(m=a.min)[0],d[1]=-m[1],d[2]=-m[2],d));var d,m}function _T(a){const i=(d=a.min,(c=WR)[0]=1,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=1,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=1,c[11]=0,c[12]=d[0],c[13]=d[1],c[14]=d[2],c[15]=1,c);var c,d;const m=1/N0(a);return Th(i,i,[m,m,m])}function qR(a,i,c,d,m){const v=function(P){const C=Zt/(2*Math.PI);return P/(2*Math.PI)/C}(c),x=[a,i,-c/(2*Math.PI)],T=ya(new Float64Array(16));return Dg(T,T,x),Th(T,T,[v,v,v]),cT(T,T,je(-m)),j0(T,T,je(-d)),T}function _f(a){return ut(gT,FR,a)}function HR(a,i){const c=vf(i.lat,i.lng),d=function(K){const Q=vf(K._center.lat,K._center.lng);let oe=dT([],gf(0,1,0),Q);const de=kR([],-K.angle,Q);oe=Fn(oe,oe,de),kR(de,-K._pitch,oe);const xe=ho([],Q);return fs(xe,xe,z0(K.cameraToCenterDistance/K.pixelsPerMeter)),Fn(xe,xe,de),Vl([],Q,xe)}(a);return x=(m=hT([],d,c))[0],T=m[1],P=m[2],C=(v=c)[0],D=v[1],$=v[2],q=(U=Math.sqrt(x*x+T*T+P*P)*Math.sqrt(C*C+D*D+$*$))&&zs(m,v)/U,Math.acos(Math.min(Math.max(q,-1),1));var m,v,x,T,P,C,D,$,U,q}function xT(a,i){return HR(a,i)>Math.PI/2*1.01}const KR=je(85),VH=Math.cos(KR),GH=Math.sin(KR),Gg=63710088e-1,ZR=2*Math.PI*Gg;class Kc{constructor(i,c){if(isNaN(i)||isNaN(c))throw new Error(`Invalid LngLat object: (${i}, ${c})`);if(this.lng=+i,this.lat=+c,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Kc(ht(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(i){const c=Math.PI/180,d=this.lat*c,m=i.lat*c,v=Math.sin(d)*Math.sin(m)+Math.cos(d)*Math.cos(m)*Math.cos((i.lng-this.lng)*c);return Gg*Math.acos(Math.min(v,1))}toBounds(i=0){const c=360*i/40075017,d=c/Math.cos(Math.PI/180*this.lat);return new Hc(new Kc(this.lng-d,this.lat-c),new Kc(this.lng+d,this.lat+c))}toEcef(i){const c=z0(i);return vf(this.lat,this.lng,nl+c)}static convert(i){if(i instanceof Kc)return i;if(Array.isArray(i)&&(i.length===2||i.length===3))return new Kc(Number(i[0]),Number(i[1]));if(!Array.isArray(i)&&typeof i=="object"&&i!==null)return new Kc(Number("lng"in i?i.lng:i.lon),Number(i.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}var Zr=Kc;function bT(a){return ZR*Math.cos(a*Math.PI/180)}function ol(a){return(180+a)/360}function sl(a){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+a*Math.PI/360)))/360}function _a(a,i){return a/bT(i)}function ps(a){return 360*a-180}function Ui(a){return 360/Math.PI*Math.atan(Math.exp((180-360*a)*Math.PI/180))-90}function XR(a,i){return a*bT(Ui(i))}const Vi=85.051129;function YR(a){return 1/Math.cos(a*Math.PI/180)}class xf{constructor(i,c,d=0){this.x=+i,this.y=+c,this.z=+d}static fromLngLat(i,c=0){const d=Zr.convert(i);return new xf(ol(d.lng),sl(d.lat),_a(c,d.lat))}toLngLat(){return new Zr(ps(this.x),Ui(this.y))}toAltitude(){return XR(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/ZR*YR(Ui(this.y))}}function wT(a,i,c,d,m,v,x,T,P){const C=(i+d)/2,D=(c+m)/2,$=new ue(C,D);T($),function(U,q,K,Q,oe,de){const xe=K-oe,fe=Q-de;return Math.abs((Q-q)*xe-(K-U)*fe)/Math.hypot(xe,fe)}($.x,$.y,v.x,v.y,x.x,x.y)>=P?(wT(a,i,c,C,D,v,$,T,P),wT(a,C,D,d,m,$,x,T,P)):a.push(x)}function JR(a,i,c){let d=a[0],m=d.x,v=d.y;i(d);const x=[d];for(let T=1;T<a.length;T++){const P=a[T],{x:C,y:D}=P;i(P),wT(x,m,v,C,D,d,P,i,c),m=C,v=D,d=P}return x}function ST(a,i,c,d){if(d(i,c)){const m=i.add(c)._mult(.5);ST(a,i,m,d),ST(a,m,c,d)}else a.push(c)}function WH(a,i){let c=a[0];const d=[c];for(let m=1;m<a.length;m++){const v=a[m];ST(d,c,v,i),c=v}return d}const TT=Math.pow(2,14)-1,QR=-TT-1;function qH(a,i){const c=Math.round(a.x*i),d=Math.round(a.y*i);return a.x=De(c,QR,TT),a.y=De(d,QR,TT),(c<a.x||c>a.x+1||d<a.y||d>a.y+1)&&Et("Geometry exceeds allowed extent, reduce your vector tile buffer size"),a}function Gl(a,i,c){const d=a.loadGeometry(),m=a.extent,v=Zt/m;if(i&&c&&c.projection.isReprojectedInTileSpace){const x=1<<i.z,{scale:T,x:P,y:C,projection:D}=c,$=U=>{const q=ps((i.x+U.x/m)/x),K=Ui((i.y+U.y/m)/x),Q=D.project(q,K);U.x=(Q.x*T-P)*m,U.y=(Q.y*T-C)*m};for(let U=0;U<d.length;U++)if(a.type!==1)d[U]=JR(d[U],$,1);else{const q=[];for(const K of d[U])K.x<0||K.x>=m||K.y<0||K.y>=m||($(K),q.push(K));d[U]=q}}for(const x of d)for(const T of x)qH(T,v);return d}function Ch(a,i){return{type:a.type,id:a.id,properties:a.properties,geometry:i?Gl(a):[]}}function $0(a,i,c,d,m){a.emplaceBack(2*i+(d+1)/2,2*c+(m+1)/2)}function F0(a,i,c){a.emplaceBack(i.x,i.y,i.z,c[0]*16384,c[1]*16384,c[2]*16384)}class ET{constructor(i){this.zoom=i.zoom,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(c=>c.id),this.index=i.index,this.hasPattern=!1,this.projection=i.projection,this.layoutVertexArray=new pt,this.indexArray=new Nt,this.segments=new Wn,this.programConfigurations=new wh(i.layers,i.zoom),this.stateDependentLayerIds=this.layers.filter(c=>c.isStateDependent()).map(c=>c.id)}populate(i,c,d,m){const v=this.layers[0],x=[];let T=null;v.type==="circle"&&(T=v.layout.get("circle-sort-key"));for(const{feature:C,id:D,index:$,sourceLayerIndex:U}of i){const q=this.layers[0]._featureFilter.needGeometry,K=Ch(C,q);if(!this.layers[0]._featureFilter.filter(new N(this.zoom),K,d))continue;const Q=T?T.evaluate(K,{},d):void 0,oe={id:D,properties:C.properties,type:C.type,sourceLayerIndex:U,index:$,geometry:q?K.geometry:Gl(C,d,m),patterns:{},sortKey:Q};x.push(oe)}T&&x.sort((C,D)=>C.sortKey-D.sortKey);let P=null;m.projection.name==="globe"&&(this.globeExtVertexArray=new yt,P=m.projection);for(const C of x){const{geometry:D,index:$,sourceLayerIndex:U}=C,q=i[$].feature;this.addFeature(C,D,$,c.availableImages,d,P),c.featureIndex.insert(q,D,$,U,this.index)}}update(i,c,d,m){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(i,c,this.stateDependentLayers,d,m)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(i){this.uploaded||(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,IH.members),this.indexBuffer=i.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=i.createVertexBuffer(this.globeExtVertexArray,RH.members))),this.programConfigurations.upload(i),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(i,c,d,m,v,x){for(const T of c)for(const P of T){const C=P.x,D=P.y;if(C<0||C>=Zt||D<0||D>=Zt)continue;if(x){const q=x.projectTilePoint(C,D,v),K=x.upVector(v,C,D),Q=this.globeExtVertexArray;F0(Q,q,K),F0(Q,q,K),F0(Q,q,K),F0(Q,q,K)}const $=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,i.sortKey),U=$.vertexLength;$0(this.layoutVertexArray,C,D,-1,-1),$0(this.layoutVertexArray,C,D,1,-1),$0(this.layoutVertexArray,C,D,1,1),$0(this.layoutVertexArray,C,D,-1,1),this.indexArray.emplaceBack(U,U+1,U+2),this.indexArray.emplaceBack(U,U+2,U+3),$.vertexLength+=4,$.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,d,{},m,v)}}function eD(a,i){for(let c=0;c<a.length;c++)if(kh(i,a[c]))return!0;for(let c=0;c<i.length;c++)if(kh(a,i[c]))return!0;return!!AT(a,i)}function HH(a,i,c){return!!kh(a,i)||!!PT(i,a,c)}function tD(a,i){if(a.length===1)return nD(i,a[0]);for(let c=0;c<i.length;c++){const d=i[c];for(let m=0;m<d.length;m++)if(kh(a,d[m]))return!0}for(let c=0;c<a.length;c++)if(nD(i,a[c]))return!0;for(let c=0;c<i.length;c++)if(AT(a,i[c]))return!0;return!1}function KH(a,i,c){if(a.length>1){if(AT(a,i))return!0;for(let d=0;d<i.length;d++)if(PT(i[d],a,c))return!0}for(let d=0;d<a.length;d++)if(PT(a[d],i,c))return!0;return!1}function AT(a,i){if(a.length===0||i.length===0)return!1;for(let c=0;c<a.length-1;c++){const d=a[c],m=a[c+1];for(let v=0;v<i.length-1;v++)if(ZH(d,m,i[v],i[v+1]))return!0}return!1}function ZH(a,i,c,d){return Ft(a,c,d)!==Ft(i,c,d)&&Ft(a,i,c)!==Ft(a,i,d)}function PT(a,i,c){const d=c*c;if(i.length===1)return a.distSqr(i[0])<d;for(let m=1;m<i.length;m++)if(rD(a,i[m-1],i[m])<d)return!0;return!1}function rD(a,i,c){const d=i.distSqr(c);if(d===0)return a.distSqr(i);const m=((a.x-i.x)*(c.x-i.x)+(a.y-i.y)*(c.y-i.y))/d;return a.distSqr(m<0?i:m>1?c:c.sub(i)._mult(m)._add(i))}function nD(a,i){let c,d,m,v=!1;for(let x=0;x<a.length;x++){c=a[x];for(let T=0,P=c.length-1;T<c.length;P=T++)d=c[T],m=c[P],d.y>i.y!=m.y>i.y&&i.x<(m.x-d.x)*(i.y-d.y)/(m.y-d.y)+d.x&&(v=!v)}return v}function kh(a,i){let c=!1;for(let d=0,m=a.length-1;d<a.length;m=d++){const v=a[d],x=a[m];v.y>i.y!=x.y>i.y&&i.x<(x.x-v.x)*(i.y-v.y)/(x.y-v.y)+v.x&&(c=!c)}return c}function iD(a,i,c,d,m){for(const x of a)if(i<=x.x&&c<=x.y&&d>=x.x&&m>=x.y)return!0;const v=[new ue(i,c),new ue(i,m),new ue(d,m),new ue(d,c)];if(a.length>2){for(const x of v)if(kh(a,x))return!0}for(let x=0;x<a.length-1;x++)if(XH(a[x],a[x+1],v))return!0;return!1}function XH(a,i,c){const d=c[0],m=c[2];if(a.x<d.x&&i.x<d.x||a.x>m.x&&i.x>m.x||a.y<d.y&&i.y<d.y||a.y>m.y&&i.y>m.y)return!1;const v=Ft(a,i,c[0]);return v!==Ft(a,i,c[1])||v!==Ft(a,i,c[2])||v!==Ft(a,i,c[3])}function bf(a,i,c){const d=i.paint.get(a).value;return d.kind==="constant"?d.value:c.programConfigurations.get(i.id).getMaxValue(a)}function U0(a){return Math.sqrt(a[0]*a[0]+a[1]*a[1])}function oD(a,i,c,d,m){if(!i[0]&&!i[1])return a;const v=ue.convert(i)._mult(m);c==="viewport"&&v._rotate(-d);const x=[];for(let T=0;T<a.length;T++)x.push(a[T].sub(v));return x}function sD(a,i,c,d){const m=ue.convert(a)._mult(d);return i==="viewport"&&m._rotate(-c),m}jt(ET,"CircleBucket",{omit:["layers"]});const YH=new ge({"circle-sort-key":new se(Xe.layout_circle["circle-sort-key"])});var JH={paint:new ge({"circle-radius":new se(Xe.paint_circle["circle-radius"]),"circle-color":new se(Xe.paint_circle["circle-color"]),"circle-blur":new se(Xe.paint_circle["circle-blur"]),"circle-opacity":new se(Xe.paint_circle["circle-opacity"]),"circle-translate":new J(Xe.paint_circle["circle-translate"]),"circle-translate-anchor":new J(Xe.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new J(Xe.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new J(Xe.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new se(Xe.paint_circle["circle-stroke-width"]),"circle-stroke-color":new se(Xe.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new se(Xe.paint_circle["circle-stroke-opacity"])}),layout:YH};function aD(a,i,c,d,m,v,x,T,P){if(v&&a.queryGeometry.isAboveHorizon)return!1;v&&(P*=a.pixelToTileUnitsFactor);const C=a.tileID.canonical,D=c.projection.upVectorScale(C,c.center.lat,c.worldSize).metersToTile;for(const $ of i)for(const U of $){const q=U.add(T),K=m&&c.elevation?c.elevation.exaggeration()*m.getElevationAt(q.x,q.y,!0):0,Q=c.projection.projectTilePoint(q.x,q.y,C);if(K>0){const fe=c.projection.upVector(C,q.x,q.y);Q.x+=fe[0]*D*K,Q.y+=fe[1]*D*K,Q.z+=fe[2]*D*K}const oe=v?q:QH(Q.x,Q.y,Q.z,d),de=v?a.tilespaceRays.map(fe=>t9(fe,K)):a.queryGeometry.screenGeometry,xe=Eh([],[Q.x,Q.y,Q.z,1],d);if(!x&&v?P*=xe[3]/c.cameraToCenterDistance:x&&!v&&(P*=c.cameraToCenterDistance/xe[3]),v){const fe=Ui((U.y/Zt+C.y)/(1<<C.z));P/=c.projection.pixelsPerMeter(fe,1)/_a(1,fe)}if(HH(de,oe,P))return!0}return!1}function QH(a,i,c,d){const m=Eh([],[a,i,c,1],d);return new ue(m[0]/m[3],m[1]/m[3])}const lD=gf(0,0,0),e9=gf(0,0,1);function t9(a,i){const c=uT();return lD[2]=i,a.intersectsPlane(lD,e9,c),new ue(c[0],c[1])}class cD extends ET{}function uD(a,{width:i,height:c},d,m){if(m){if(m instanceof Uint8ClampedArray)m=new Uint8Array(m.buffer);else if(m.length!==i*c*d)throw new RangeError("mismatched image size")}else m=new Uint8Array(i*c*d);return a.width=i,a.height=c,a.data=m,a}function hD(a,i,c){const{width:d,height:m}=i;d===a.width&&m===a.height||(CT(a,i,{x:0,y:0},{x:0,y:0},{width:Math.min(a.width,d),height:Math.min(a.height,m)},c),a.width=d,a.height=m,a.data=i.data)}function CT(a,i,c,d,m,v){if(m.width===0||m.height===0)return i;if(m.width>a.width||m.height>a.height||c.x>a.width-m.width||c.y>a.height-m.height)throw new RangeError("out of range source coordinates for image copy");if(m.width>i.width||m.height>i.height||d.x>i.width-m.width||d.y>i.height-m.height)throw new RangeError("out of range destination coordinates for image copy");const x=a.data,T=i.data;for(let P=0;P<m.height;P++){const C=((c.y+P)*a.width+c.x)*v,D=((d.y+P)*i.width+d.x)*v;for(let $=0;$<m.width*v;$++)T[D+$]=x[C+$]}return i}jt(cD,"HeatmapBucket",{omit:["layers"]});class Wl{constructor(i,c){uD(this,i,1,c)}resize(i){hD(this,new Wl(i),1)}clone(){return new Wl({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(i,c,d,m,v){CT(i,c,d,m,v,1)}}class Ho{constructor(i,c){uD(this,i,4,c)}resize(i){hD(this,new Ho(i),4)}replace(i,c){c?this.data.set(i):this.data=i instanceof Uint8ClampedArray?new Uint8Array(i.buffer):i}clone(){return new Ho({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(i,c,d,m,v){CT(i,c,d,m,v,4)}}jt(Wl,"AlphaImage"),jt(Ho,"RGBAImage");var r9={paint:new ge({"heatmap-radius":new se(Xe.paint_heatmap["heatmap-radius"]),"heatmap-weight":new se(Xe.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new J(Xe.paint_heatmap["heatmap-intensity"]),"heatmap-color":new me(Xe.paint_heatmap["heatmap-color"]),"heatmap-opacity":new J(Xe.paint_heatmap["heatmap-opacity"])})};function kT(a){const i={},c=a.resolution||256,d=a.clips?a.clips.length:1,m=a.image||new Ho({width:c,height:d}),v=(x,T,P)=>{i[a.evaluationKey]=P;const C=a.expression.evaluate(i);m.data[x+T+0]=Math.floor(255*C.r/C.a),m.data[x+T+1]=Math.floor(255*C.g/C.a),m.data[x+T+2]=Math.floor(255*C.b/C.a),m.data[x+T+3]=Math.floor(255*C.a)};if(a.clips)for(let x=0,T=0;x<d;++x,T+=4*c)for(let P=0,C=0;P<c;P++,C+=4){const D=P/(c-1),{start:$,end:U}=a.clips[x];v(T,C,$*(1-D)+U*D)}else for(let x=0,T=0;x<c;x++,T+=4)v(0,T,x/(c-1));return m}var n9={paint:new ge({"hillshade-illumination-direction":new J(Xe.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new J(Xe.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new J(Xe.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new J(Xe.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new J(Xe.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new J(Xe.paint_hillshade["hillshade-accent-color"])})};const i9=Ie([{name:"a_pos",components:2,type:"Int16"}],4),{members:o9}=i9;var OT={exports:{}};function V0(a,i,c){c=c||2;var d,m,v,x,T,P,C,D=i&&i.length,$=D?i[0]*c:a.length,U=dD(a,0,$,c,!0),q=[];if(!U||U.next===U.prev)return q;if(D&&(U=function(Q,oe,de,xe){var fe,_e,we,be=[];for(fe=0,_e=oe.length;fe<_e;fe++)(we=dD(Q,oe[fe]*xe,fe<_e-1?oe[fe+1]*xe:Q.length,xe,!1))===we.next&&(we.steiner=!0),be.push(f9(we));for(be.sort(u9),fe=0;fe<be.length;fe++)de=h9(be[fe],de);return de}(a,i,U,c)),a.length>80*c){d=v=a[0],m=x=a[1];for(var K=c;K<$;K+=c)(T=a[K])<d&&(d=T),(P=a[K+1])<m&&(m=P),T>v&&(v=T),P>x&&(x=P);C=(C=Math.max(v-d,x-m))!==0?32767/C:0}return Wg(U,q,c,d,m,C,0),q}function dD(a,i,c,d,m){var v,x;if(m===RT(a,i,c,d)>0)for(v=i;v<c;v+=d)x=mD(v,a[v],a[v+1],x);else for(v=c-d;v>=i;v-=d)x=mD(v,a[v],a[v+1],x);return x&&G0(x,x.next)&&(Hg(x),x=x.next),x}function Oh(a,i){if(!a)return a;i||(i=a);var c,d=a;do if(c=!1,d.steiner||!G0(d,d.next)&&qn(d.prev,d,d.next)!==0)d=d.next;else{if(Hg(d),(d=i=d.prev)===d.next)break;c=!0}while(c||d!==i);return i}function Wg(a,i,c,d,m,v,x){if(a){!x&&v&&function(D,$,U,q){var K=D;do K.z===0&&(K.z=MT(K.x,K.y,$,U,q)),K.prevZ=K.prev,K.nextZ=K.next,K=K.next;while(K!==D);K.prevZ.nextZ=null,K.prevZ=null,function(Q){var oe,de,xe,fe,_e,we,be,We,Fe=1;do{for(de=Q,Q=null,_e=null,we=0;de;){for(we++,xe=de,be=0,oe=0;oe<Fe&&(be++,xe=xe.nextZ);oe++);for(We=Fe;be>0||We>0&&xe;)be!==0&&(We===0||!xe||de.z<=xe.z)?(fe=de,de=de.nextZ,be--):(fe=xe,xe=xe.nextZ,We--),_e?_e.nextZ=fe:Q=fe,fe.prevZ=_e,_e=fe;de=xe}_e.nextZ=null,Fe*=2}while(we>1)}(K)}(a,d,m,v);for(var T,P,C=a;a.prev!==a.next;)if(T=a.prev,P=a.next,v?a9(a,d,m,v):s9(a))i.push(T.i/c|0),i.push(a.i/c|0),i.push(P.i/c|0),Hg(a),a=P.next,C=P.next;else if((a=P)===C){x?x===1?Wg(a=l9(Oh(a),i,c),i,c,d,m,v,2):x===2&&c9(a,i,c,d,m,v):Wg(Oh(a),i,c,d,m,v,1);break}}}function s9(a){var i=a.prev,c=a,d=a.next;if(qn(i,c,d)>=0)return!1;for(var m=i.x,v=c.x,x=d.x,T=i.y,P=c.y,C=d.y,D=m<v?m<x?m:x:v<x?v:x,$=T<P?T<C?T:C:P<C?P:C,U=m>v?m>x?m:x:v>x?v:x,q=T>P?T>C?T:C:P>C?P:C,K=d.next;K!==i;){if(K.x>=D&&K.x<=U&&K.y>=$&&K.y<=q&&wf(m,T,v,P,x,C,K.x,K.y)&&qn(K.prev,K,K.next)>=0)return!1;K=K.next}return!0}function a9(a,i,c,d){var m=a.prev,v=a,x=a.next;if(qn(m,v,x)>=0)return!1;for(var T=m.x,P=v.x,C=x.x,D=m.y,$=v.y,U=x.y,q=T<P?T<C?T:C:P<C?P:C,K=D<$?D<U?D:U:$<U?$:U,Q=T>P?T>C?T:C:P>C?P:C,oe=D>$?D>U?D:U:$>U?$:U,de=MT(q,K,i,c,d),xe=MT(Q,oe,i,c,d),fe=a.prevZ,_e=a.nextZ;fe&&fe.z>=de&&_e&&_e.z<=xe;){if(fe.x>=q&&fe.x<=Q&&fe.y>=K&&fe.y<=oe&&fe!==m&&fe!==x&&wf(T,D,P,$,C,U,fe.x,fe.y)&&qn(fe.prev,fe,fe.next)>=0||(fe=fe.prevZ,_e.x>=q&&_e.x<=Q&&_e.y>=K&&_e.y<=oe&&_e!==m&&_e!==x&&wf(T,D,P,$,C,U,_e.x,_e.y)&&qn(_e.prev,_e,_e.next)>=0))return!1;_e=_e.nextZ}for(;fe&&fe.z>=de;){if(fe.x>=q&&fe.x<=Q&&fe.y>=K&&fe.y<=oe&&fe!==m&&fe!==x&&wf(T,D,P,$,C,U,fe.x,fe.y)&&qn(fe.prev,fe,fe.next)>=0)return!1;fe=fe.prevZ}for(;_e&&_e.z<=xe;){if(_e.x>=q&&_e.x<=Q&&_e.y>=K&&_e.y<=oe&&_e!==m&&_e!==x&&wf(T,D,P,$,C,U,_e.x,_e.y)&&qn(_e.prev,_e,_e.next)>=0)return!1;_e=_e.nextZ}return!0}function l9(a,i,c){var d=a;do{var m=d.prev,v=d.next.next;!G0(m,v)&&fD(m,d,d.next,v)&&qg(m,v)&&qg(v,m)&&(i.push(m.i/c|0),i.push(d.i/c|0),i.push(v.i/c|0),Hg(d),Hg(d.next),d=a=v),d=d.next}while(d!==a);return Oh(d)}function c9(a,i,c,d,m,v){var x=a;do{for(var T=x.next.next;T!==x.prev;){if(x.i!==T.i&&p9(x,T)){var P=pD(x,T);return x=Oh(x,x.next),P=Oh(P,P.next),Wg(x,i,c,d,m,v,0),void Wg(P,i,c,d,m,v,0)}T=T.next}x=x.next}while(x!==a)}function u9(a,i){return a.x-i.x}function h9(a,i){var c=function(m,v){var x,T=v,P=m.x,C=m.y,D=-1/0;do{if(C<=T.y&&C>=T.next.y&&T.next.y!==T.y){var $=T.x+(C-T.y)*(T.next.x-T.x)/(T.next.y-T.y);if($<=P&&$>D&&(D=$,x=T.x<T.next.x?T:T.next,$===P))return x}T=T.next}while(T!==v);if(!x)return null;var U,q=x,K=x.x,Q=x.y,oe=1/0;T=x;do P>=T.x&&T.x>=K&&P!==T.x&&wf(C<Q?P:D,C,K,Q,C<Q?D:P,C,T.x,T.y)&&(U=Math.abs(C-T.y)/(P-T.x),qg(T,m)&&(U<oe||U===oe&&(T.x>x.x||T.x===x.x&&d9(x,T)))&&(x=T,oe=U)),T=T.next;while(T!==q);return x}(a,i);if(!c)return i;var d=pD(c,a);return Oh(d,d.next),Oh(c,c.next)}function d9(a,i){return qn(a.prev,a,i.prev)<0&&qn(i.next,a,a.next)<0}function MT(a,i,c,d,m){return(a=1431655765&((a=858993459&((a=252645135&((a=16711935&((a=(a-c)*m|0)|a<<8))|a<<4))|a<<2))|a<<1))|(i=1431655765&((i=858993459&((i=252645135&((i=16711935&((i=(i-d)*m|0)|i<<8))|i<<4))|i<<2))|i<<1))<<1}function f9(a){var i=a,c=a;do(i.x<c.x||i.x===c.x&&i.y<c.y)&&(c=i),i=i.next;while(i!==a);return c}function wf(a,i,c,d,m,v,x,T){return(m-x)*(i-T)>=(a-x)*(v-T)&&(a-x)*(d-T)>=(c-x)*(i-T)&&(c-x)*(v-T)>=(m-x)*(d-T)}function p9(a,i){return a.next.i!==i.i&&a.prev.i!==i.i&&!function(c,d){var m=c;do{if(m.i!==c.i&&m.next.i!==c.i&&m.i!==d.i&&m.next.i!==d.i&&fD(m,m.next,c,d))return!0;m=m.next}while(m!==c);return!1}(a,i)&&(qg(a,i)&&qg(i,a)&&function(c,d){var m=c,v=!1,x=(c.x+d.x)/2,T=(c.y+d.y)/2;do m.y>T!=m.next.y>T&&m.next.y!==m.y&&x<(m.next.x-m.x)*(T-m.y)/(m.next.y-m.y)+m.x&&(v=!v),m=m.next;while(m!==c);return v}(a,i)&&(qn(a.prev,a,i.prev)||qn(a,i.prev,i))||G0(a,i)&&qn(a.prev,a,a.next)>0&&qn(i.prev,i,i.next)>0)}function qn(a,i,c){return(i.y-a.y)*(c.x-i.x)-(i.x-a.x)*(c.y-i.y)}function G0(a,i){return a.x===i.x&&a.y===i.y}function fD(a,i,c,d){var m=q0(qn(a,i,c)),v=q0(qn(a,i,d)),x=q0(qn(c,d,a)),T=q0(qn(c,d,i));return m!==v&&x!==T||!(m!==0||!W0(a,c,i))||!(v!==0||!W0(a,d,i))||!(x!==0||!W0(c,a,d))||!(T!==0||!W0(c,i,d))}function W0(a,i,c){return i.x<=Math.max(a.x,c.x)&&i.x>=Math.min(a.x,c.x)&&i.y<=Math.max(a.y,c.y)&&i.y>=Math.min(a.y,c.y)}function q0(a){return a>0?1:a<0?-1:0}function qg(a,i){return qn(a.prev,a,a.next)<0?qn(a,i,a.next)>=0&&qn(a,a.prev,i)>=0:qn(a,i,a.prev)<0||qn(a,a.next,i)<0}function pD(a,i){var c=new IT(a.i,a.x,a.y),d=new IT(i.i,i.x,i.y),m=a.next,v=i.prev;return a.next=i,i.prev=a,c.next=m,m.prev=c,d.next=c,c.prev=d,v.next=d,d.prev=v,d}function mD(a,i,c,d){var m=new IT(a,i,c);return d?(m.next=d.next,m.prev=d,d.next.prev=m,d.next=m):(m.prev=m,m.next=m),m}function Hg(a){a.next.prev=a.prev,a.prev.next=a.next,a.prevZ&&(a.prevZ.nextZ=a.nextZ),a.nextZ&&(a.nextZ.prevZ=a.prevZ)}function IT(a,i,c){this.i=a,this.x=i,this.y=c,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function RT(a,i,c,d){for(var m=0,v=i,x=c-d;v<c;v+=d)m+=(a[x]-a[v])*(a[v+1]+a[x+1]),x=v;return m}OT.exports=V0,OT.exports.default=V0,V0.deviation=function(a,i,c,d){var m=i&&i.length,v=Math.abs(RT(a,0,m?i[0]*c:a.length,c));if(m)for(var x=0,T=i.length;x<T;x++)v-=Math.abs(RT(a,i[x]*c,x<T-1?i[x+1]*c:a.length,c));var P=0;for(x=0;x<d.length;x+=3){var C=d[x]*c,D=d[x+1]*c,$=d[x+2]*c;P+=Math.abs((a[C]-a[$])*(a[D+1]-a[C+1])-(a[C]-a[D])*(a[$+1]-a[C+1]))}return v===0&&P===0?0:Math.abs((P-v)/v)},V0.flatten=function(a){for(var i=a[0][0].length,c={vertices:[],holes:[],dimensions:i},d=0,m=0;m<a.length;m++){for(var v=0;v<a[m].length;v++)for(var x=0;x<i;x++)c.vertices.push(a[m][v][x]);m>0&&c.holes.push(d+=a[m-1].length)}return c};var DT=Z(OT.exports);function m9(a,i,c,d,m){gD(a,i,c,d||a.length-1,m||g9)}function gD(a,i,c,d,m){for(;d>c;){if(d-c>600){var v=d-c+1,x=i-c+1,T=Math.log(v),P=.5*Math.exp(2*T/3),C=.5*Math.sqrt(T*P*(v-P)/v)*(x-v/2<0?-1:1);gD(a,i,Math.max(c,Math.floor(i-x*P/v+C)),Math.min(d,Math.floor(i+(v-x)*P/v+C)),m)}var D=a[i],$=c,U=d;for(Kg(a,c,i),m(a[d],D)>0&&Kg(a,c,d);$<U;){for(Kg(a,$,U),$++,U--;m(a[$],D)<0;)$++;for(;m(a[U],D)>0;)U--}m(a[c],D)===0?Kg(a,c,U):Kg(a,++U,d),U<=i&&(c=U+1),i<=U&&(d=U-1)}}function Kg(a,i,c){var d=a[i];a[i]=a[c],a[c]=d}function g9(a,i){return a<i?-1:a>i?1:0}function LT(a,i){const c=a.length;if(c<=1)return[a];const d=[];let m,v;for(let x=0;x<c;x++){const T=un(a[x]);T!==0&&(a[x].area=Math.abs(T),v===void 0&&(v=T<0),v===T<0?(m&&d.push(m),m=[a[x]]):m.push(a[x]))}if(m&&d.push(m),i>1)for(let x=0;x<d.length;x++)d[x].length<=i||(m9(d[x],i,1,d[x].length-1,y9),d[x]=d[x].slice(0,i));return d}function y9(a,i){return i.area-a.area}function jT(a,i,c){const d=c.patternDependencies;let m=!1;for(const v of i){const x=v.paint.get(`${a}-pattern`);x.isConstant()||(m=!0);const T=x.constantOr(null);T&&(m=!0,d[T]=!0)}return m}function zT(a,i,c,d,m){const v=m.patternDependencies;for(const x of i){const T=x.paint.get(`${a}-pattern`).value;if(T.kind!=="constant"){let P=T.evaluate({zoom:d},c,{},m.availableImages);P=P&&P.name?P.name:P,v[P]=!0,c.patterns[x.id]=P}}return c}class H0{constructor(i){this.zoom=i.zoom,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(c=>c.id),this.index=i.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new pt,this.indexArray=new Nt,this.indexArray2=new fi,this.programConfigurations=new wh(i.layers,i.zoom),this.segments=new Wn,this.segments2=new Wn,this.stateDependentLayerIds=this.layers.filter(c=>c.isStateDependent()).map(c=>c.id),this.projection=i.projection}populate(i,c,d,m){this.hasPattern=jT("fill",this.layers,c);const v=this.layers[0].layout.get("fill-sort-key"),x=[];for(const{feature:T,id:P,index:C,sourceLayerIndex:D}of i){const $=this.layers[0]._featureFilter.needGeometry,U=Ch(T,$);if(!this.layers[0]._featureFilter.filter(new N(this.zoom),U,d))continue;const q=v?v.evaluate(U,{},d,c.availableImages):void 0,K={id:P,properties:T.properties,type:T.type,sourceLayerIndex:D,index:C,geometry:$?U.geometry:Gl(T,d,m),patterns:{},sortKey:q};x.push(K)}v&&x.sort((T,P)=>T.sortKey-P.sortKey);for(const T of x){const{geometry:P,index:C,sourceLayerIndex:D}=T;if(this.hasPattern){const $=zT("fill",this.layers,T,this.zoom,c);this.patternFeatures.push($)}else this.addFeature(T,P,C,d,{},c.availableImages);c.featureIndex.insert(i[C].feature,P,C,D,this.index)}}update(i,c,d,m){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(i,c,this.stateDependentLayers,d,m)}addFeatures(i,c,d,m,v){for(const x of this.patternFeatures)this.addFeature(x,x.geometry,x.index,c,d,m)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(i){this.uploaded||(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,o9),this.indexBuffer=i.createIndexBuffer(this.indexArray),this.indexBuffer2=i.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(i),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(i,c,d,m,v,x=[]){for(const T of LT(c,500)){let P=0;for(const K of T)P+=K.length;const C=this.segments.prepareSegment(P,this.layoutVertexArray,this.indexArray),D=C.vertexLength,$=[],U=[];for(const K of T){if(K.length===0)continue;K!==T[0]&&U.push($.length/2);const Q=this.segments2.prepareSegment(K.length,this.layoutVertexArray,this.indexArray2),oe=Q.vertexLength;this.layoutVertexArray.emplaceBack(K[0].x,K[0].y),this.indexArray2.emplaceBack(oe+K.length-1,oe),$.push(K[0].x),$.push(K[0].y);for(let de=1;de<K.length;de++)this.layoutVertexArray.emplaceBack(K[de].x,K[de].y),this.indexArray2.emplaceBack(oe+de-1,oe+de),$.push(K[de].x),$.push(K[de].y);Q.vertexLength+=K.length,Q.primitiveLength+=K.length}const q=DT($,U);for(let K=0;K<q.length;K+=3)this.indexArray.emplaceBack(D+q[K],D+q[K+1],D+q[K+2]);C.vertexLength+=P,C.primitiveLength+=q.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,d,v,x,m)}}jt(H0,"FillBucket",{omit:["layers","patternFeatures"]});const v9=new ge({"fill-sort-key":new se(Xe.layout_fill["fill-sort-key"])});var _9={paint:new ge({"fill-antialias":new J(Xe.paint_fill["fill-antialias"]),"fill-opacity":new se(Xe.paint_fill["fill-opacity"]),"fill-color":new se(Xe.paint_fill["fill-color"]),"fill-outline-color":new se(Xe.paint_fill["fill-outline-color"]),"fill-translate":new J(Xe.paint_fill["fill-translate"]),"fill-translate-anchor":new J(Xe.paint_fill["fill-translate-anchor"]),"fill-pattern":new se(Xe.paint_fill["fill-pattern"])}),layout:v9};const x9=Ie([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),b9=Ie([{name:"a_centroid_pos",components:2,type:"Uint16"}]),w9=Ie([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:S9}=x9;var K0={},T9=te,yD=Sf;function Sf(a,i,c,d,m){this.properties={},this.extent=c,this.type=0,this._pbf=a,this._geometry=-1,this._keys=d,this._values=m,a.readFields(E9,this,i)}function E9(a,i,c){a==1?i.id=c.readVarint():a==2?function(d,m){for(var v=d.readVarint()+d.pos;d.pos<v;){var x=m._keys[d.readVarint()],T=m._values[d.readVarint()];m.properties[x]=T}}(c,i):a==3?i.type=c.readVarint():a==4&&(i._geometry=c.pos)}function A9(a){for(var i,c,d=0,m=0,v=a.length,x=v-1;m<v;x=m++)d+=((c=a[x]).x-(i=a[m]).x)*(i.y+c.y);return d}Sf.types=["Unknown","Point","LineString","Polygon"],Sf.prototype.loadGeometry=function(){var a=this._pbf;a.pos=this._geometry;for(var i,c=a.readVarint()+a.pos,d=1,m=0,v=0,x=0,T=[];a.pos<c;){if(m<=0){var P=a.readVarint();d=7&P,m=P>>3}if(m--,d===1||d===2)v+=a.readSVarint(),x+=a.readSVarint(),d===1&&(i&&T.push(i),i=[]),i.push(new T9(v,x));else{if(d!==7)throw new Error("unknown command "+d);i&&i.push(i[0].clone())}}return i&&T.push(i),T},Sf.prototype.bbox=function(){var a=this._pbf;a.pos=this._geometry;for(var i=a.readVarint()+a.pos,c=1,d=0,m=0,v=0,x=1/0,T=-1/0,P=1/0,C=-1/0;a.pos<i;){if(d<=0){var D=a.readVarint();c=7&D,d=D>>3}if(d--,c===1||c===2)(m+=a.readSVarint())<x&&(x=m),m>T&&(T=m),(v+=a.readSVarint())<P&&(P=v),v>C&&(C=v);else if(c!==7)throw new Error("unknown command "+c)}return[x,P,T,C]},Sf.prototype.toGeoJSON=function(a,i,c){var d,m,v=this.extent*Math.pow(2,c),x=this.extent*a,T=this.extent*i,P=this.loadGeometry(),C=Sf.types[this.type];function D(q){for(var K=0;K<q.length;K++){var Q=q[K];q[K]=[360*(Q.x+x)/v-180,360/Math.PI*Math.atan(Math.exp((180-360*(Q.y+T)/v)*Math.PI/180))-90]}}switch(this.type){case 1:var $=[];for(d=0;d<P.length;d++)$[d]=P[d][0];D(P=$);break;case 2:for(d=0;d<P.length;d++)D(P[d]);break;case 3:for(P=function(q){var K=q.length;if(K<=1)return[q];for(var Q,oe,de=[],xe=0;xe<K;xe++){var fe=A9(q[xe]);fe!==0&&(oe===void 0&&(oe=fe<0),oe===fe<0?(Q&&de.push(Q),Q=[q[xe]]):Q.push(q[xe]))}return Q&&de.push(Q),de}(P),d=0;d<P.length;d++)for(m=0;m<P[d].length;m++)D(P[d][m])}P.length===1?P=P[0]:C="Multi"+C;var U={type:"Feature",geometry:{type:C,coordinates:P},properties:this.properties};return"id"in this&&(U.id=this.id),U};var P9=yD,vD=_D;function _D(a,i){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=a,this._keys=[],this._values=[],this._features=[],a.readFields(C9,this,i),this.length=this._features.length}function C9(a,i,c){a===15?i.version=c.readVarint():a===1?i.name=c.readString():a===5?i.extent=c.readVarint():a===2?i._features.push(c.pos):a===3?i._keys.push(c.readString()):a===4&&i._values.push(function(d){for(var m=null,v=d.readVarint()+d.pos;d.pos<v;){var x=d.readVarint()>>3;m=x===1?d.readString():x===2?d.readFloat():x===3?d.readDouble():x===4?d.readVarint64():x===5?d.readVarint():x===6?d.readSVarint():x===7?d.readBoolean():null}return m}(c))}_D.prototype.feature=function(a){if(a<0||a>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[a];var i=this._pbf.readVarint()+this._pbf.pos;return new P9(this._pbf,i,this.extent,this._keys,this._values)};var k9=vD;function O9(a,i,c){if(a===3){var d=new k9(c,c.readVarint()+c.pos);d.length&&(i[d.name]=d)}}var BT=K0.VectorTile=function(a,i){this.layers=a.readFields(O9,{},i)},Z0=K0.VectorTileFeature=yD;function X0(a,i,c,d){const m=[],v=d===0?(x,T,P,C,D,$)=>{x.push(new ue($,P+($-T)/(C-T)*(D-P)))}:(x,T,P,C,D,$)=>{x.push(new ue(T+($-P)/(D-P)*(C-T),$))};for(const x of a){const T=[];for(const P of x){if(P.length<=2)continue;const C=[];for(let U=0;U<P.length-1;U++){const q=P[U].x,K=P[U].y,Q=P[U+1].x,oe=P[U+1].y,de=d===0?q:K,xe=d===0?Q:oe;de<i?xe>i&&v(C,q,K,Q,oe,i):de>c?xe<c&&v(C,q,K,Q,oe,c):C.push(P[U]),xe<i&&de>=i&&v(C,q,K,Q,oe,i),xe>c&&de<=c&&v(C,q,K,Q,oe,c)}let D=P[P.length-1];const $=d===0?D.x:D.y;$>=i&&$<=c&&C.push(D),C.length&&(D=C[C.length-1],C[0].x===D.x&&C[0].y===D.y||C.push(C[0]),T.push(C))}T.length&&m.push(T)}return m}K0.VectorTileLayer=vD;const M9=Z0.types,I9=Math.pow(2,13);function Zg(a,i,c,d,m,v,x,T){a.emplaceBack((i<<1)+x,(c<<1)+v,(Math.floor(d*I9)<<1)+m,Math.round(T))}function Xg(a,i,c){a.emplaceBack(i.x,i.y,i.z,c[0]*16384,c[1]*16384,c[2]*16384)}class xD{constructor(){this.acc=new ue(0,0),this.polyCount=[]}startRing(i){this.currentPolyCount={edges:0,top:0},this.polyCount.push(this.currentPolyCount),this.min||(this.min=new ue(i.x,i.y),this.max=new ue(i.x,i.y))}append(i,c){this.currentPolyCount.edges++,this.acc._add(i);const d=this.min,m=this.max;i.x<d.x?d.x=i.x:i.x>m.x&&(m.x=i.x),i.y<d.y?d.y=i.y:i.y>m.y&&(m.y=i.y),((i.x===0||i.x===Zt)&&i.x===c.x)!=((i.y===0||i.y===Zt)&&i.y===c.y)&&this.processBorderOverlap(i,c),c.x<0!=i.x<0&&this.addBorderIntersection(0,Or(c.y,i.y,(0-c.x)/(i.x-c.x))),c.x>Zt!=i.x>Zt&&this.addBorderIntersection(1,Or(c.y,i.y,(Zt-c.x)/(i.x-c.x))),c.y<0!=i.y<0&&this.addBorderIntersection(2,Or(c.x,i.x,(0-c.y)/(i.y-c.y))),c.y>Zt!=i.y>Zt&&this.addBorderIntersection(3,Or(c.x,i.x,(Zt-c.y)/(i.y-c.y)))}addBorderIntersection(i,c){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const d=this.borders[i];c<d[0]&&(d[0]=c),c>d[1]&&(d[1]=c)}processBorderOverlap(i,c){if(i.x===c.x){if(i.y===c.y)return;const d=i.x===0?0:1;this.addBorderIntersection(d,c.y),this.addBorderIntersection(d,i.y)}else{const d=i.y===0?2:3;this.addBorderIntersection(d,c.x),this.addBorderIntersection(d,i.x)}}centroid(){const i=this.polyCount.reduce((c,d)=>c+d.edges,0);return i!==0?this.acc.div(i)._round():new ue(0,0)}span(){return new ue(this.max.x-this.min.x,this.max.y-this.min.y)}intersectsCount(){return this.borders.reduce((i,c)=>i+ +(c[0]!==Number.MAX_VALUE),0)}}class Yg{constructor(i){this.zoom=i.zoom,this.canonical=i.canonical,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(c=>c.id),this.index=i.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=i.projection,this.layoutVertexArray=new it,this.centroidVertexArray=new pa,this.indexArray=new Nt,this.programConfigurations=new wh(i.layers,i.zoom),this.segments=new Wn,this.stateDependentLayerIds=this.layers.filter(c=>c.isStateDependent()).map(c=>c.id),this.enableTerrain=i.enableTerrain}populate(i,c,d,m){this.features=[],this.hasPattern=jT("fill-extrusion",this.layers,c),this.featuresOnBorder=[],this.borders=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=function(v){const x=Math.exp(Math.PI*(1-v.y/(1<<v.z)*2));return 80150034*x/(x*x+1)/Zt/(1<<v.z)}(d),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter;for(const{feature:v,id:x,index:T,sourceLayerIndex:P}of i){const C=this.layers[0]._featureFilter.needGeometry,D=Ch(v,C);if(!this.layers[0]._featureFilter.filter(new N(this.zoom),D,d))continue;const $={id:x,sourceLayerIndex:P,index:T,geometry:C?D.geometry:Gl(v,d,m),properties:v.properties,type:v.type,patterns:{}},U=this.layoutVertexArray.length;this.hasPattern?this.features.push(zT("fill-extrusion",this.layers,$,this.zoom,c)):this.addFeature($,$.geometry,T,d,{},c.availableImages,m),c.featureIndex.insert(v,$.geometry,T,P,this.index,U)}this.sortBorders()}addFeatures(i,c,d,m,v){for(const x of this.features){const{geometry:T}=x;this.addFeature(x,T,x.index,c,d,m,v)}this.sortBorders()}update(i,c,d,m){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(i,c,this.stateDependentLayers,d,m)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(i){this.uploaded||(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,S9),this.indexBuffer=i.createIndexBuffer(this.indexArray),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=i.createVertexBuffer(this.layoutVertexExtArray,w9.members,!0))),this.programConfigurations.upload(i),this.uploaded=!0}uploadCentroid(i){this.centroidVertexArray.length!==0&&(this.centroidVertexBuffer?this.needsCentroidUpdate&&this.centroidVertexBuffer.updateData(this.centroidVertexArray):this.centroidVertexBuffer=i.createVertexBuffer(this.centroidVertexArray,b9.members,!0),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(i,c,d,m,v,x,T){const P=[new ue(0,0),new ue(Zt,Zt)],C=T.projection,D=C.name==="globe",$=this.enableTerrain&&!D?new xD:null,U=M9[i.type]==="Polygon";D&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new yt);const q=LT(c,500);for(let de=q.length-1;de>=0;de--){const xe=q[de];(xe.length===0||(K=xe[0]).every(fe=>fe.x<=0)||K.every(fe=>fe.x>=Zt)||K.every(fe=>fe.y<=0)||K.every(fe=>fe.y>=Zt))&&q.splice(de,1)}var K;let Q;if(D)Q=PD(q,P,m);else{Q=[];for(const de of q)Q.push({polygon:de,bounds:P})}const oe=U?this.edgeRadius:0;for(const{polygon:de,bounds:xe}of Q){let fe=0,_e=0;for(const be of de)U&&!be[0].equals(be[be.length-1])&&be.push(be[0]),_e+=U?be.length-1:be.length;const we=this.segments.prepareSegment((U?5:4)*_e,this.layoutVertexArray,this.indexArray);if(U){const be=[],We=[];fe=we.vertexLength;for(const Qe of de){let mt,Ke;Qe.length&&Qe!==de[0]&&We.push(be.length/2),mt=Qe[1].sub(Qe[0])._perp()._unit();for(let ot=1;ot<Qe.length;ot++){const st=Qe[ot],dt=Qe[ot===Qe.length-1?1:ot+1];let{x:_t,y:Je}=st;if(oe){Ke=dt.sub(st)._perp()._unit();const Pt=mt.add(Ke)._unit(),Bt=oe*Math.min(4,1/(mt.x*Pt.x+mt.y*Pt.y));_t+=Bt*Pt.x,Je+=Bt*Pt.y,mt=Ke}Zg(this.layoutVertexArray,_t,Je,0,0,1,1,0),we.vertexLength++,be.push(st.x,st.y),D&&Xg(this.layoutVertexExtArray,C.projectTilePoint(_t,Je,m),C.upVector(m,_t,Je))}}const Fe=DT(be,We);for(let Qe=0;Qe<Fe.length;Qe+=3)this.indexArray.emplaceBack(fe+Fe[Qe],fe+Fe[Qe+2],fe+Fe[Qe+1]),we.primitiveLength++}for(const be of de){$&&be.length&&$.startRing(be[0]);let We,Fe,Qe,mt=be.length>4&&TD(be[be.length-2],be[0],be[1]),Ke=oe?R9(be[be.length-2],be[0],be[1],oe):0;Fe=be[1].sub(be[0])._perp()._unit();let ot=!0;for(let st=1,dt=0;st<be.length;st++){let _t=be[st-1],Je=be[st];const Pt=be[st===be.length-1?1:st+1];if($&&U&&$.currentPolyCount.top++,SD(Je,_t,xe)){oe&&(Fe=Pt.sub(Je)._perp()._unit(),ot=!ot);continue}$&&$.append(Je,_t);const Bt=Je.sub(_t)._perp(),kt=Bt.x/(Math.abs(Bt.x)+Math.abs(Bt.y)),ar=Bt.y>0?1:0,bt=_t.dist(Je);if(dt+bt>32768&&(dt=0),oe){Qe=Pt.sub(Je)._perp()._unit();let cr=wD(_t,Je,Pt,bD(Fe,Qe),oe);isNaN(cr)&&(cr=0);const Qt=Je.sub(_t)._unit();_t=_t.add(Qt.mult(Ke))._round(),Je=Je.add(Qt.mult(-cr))._round(),Ke=cr,Fe=Qe}const Gt=we.vertexLength,lr=be.length>4&&TD(_t,Je,Pt);let Rr=ED(dt,mt,ot);if(Zg(this.layoutVertexArray,_t.x,_t.y,kt,ar,0,0,Rr),Zg(this.layoutVertexArray,_t.x,_t.y,kt,ar,0,1,Rr),dt+=bt,Rr=ED(dt,lr,!ot),mt=lr,Zg(this.layoutVertexArray,Je.x,Je.y,kt,ar,0,0,Rr),Zg(this.layoutVertexArray,Je.x,Je.y,kt,ar,0,1,Rr),we.vertexLength+=4,this.indexArray.emplaceBack(Gt+0,Gt+1,Gt+2),this.indexArray.emplaceBack(Gt+1,Gt+3,Gt+2),we.primitiveLength+=2,oe){const cr=fe+(st===1?be.length-2:st-2),Qt=st===1?fe:cr+1;if(this.indexArray.emplaceBack(Gt+1,cr,Gt+3),this.indexArray.emplaceBack(cr,Qt,Gt+3),we.primitiveLength+=2,We===void 0&&(We=Gt),!SD(Pt,be[st],xe)){const an=st===be.length-1?We:we.vertexLength;this.indexArray.emplaceBack(Gt+2,Gt+3,an),this.indexArray.emplaceBack(Gt+3,an+1,an),this.indexArray.emplaceBack(Gt+3,Qt,an+1),we.primitiveLength+=3}ot=!ot}if(D){const cr=this.layoutVertexExtArray,Qt=C.projectTilePoint(_t.x,_t.y,m),an=C.projectTilePoint(Je.x,Je.y,m),ur=C.upVector(m,_t.x,_t.y),hr=C.upVector(m,Je.x,Je.y);Xg(cr,Qt,ur),Xg(cr,Qt,ur),Xg(cr,an,hr),Xg(cr,an,hr)}}U&&(fe+=be.length-1)}}if($&&$.polyCount.length>0){if($.borders){$.vertexArrayOffset=this.centroidVertexArray.length;const de=$.borders,xe=this.featuresOnBorder.push($)-1;for(let fe=0;fe<4;fe++)de[fe][0]!==Number.MAX_VALUE&&this.borders[fe].push(xe)}this.encodeCentroid($.borders?void 0:$.centroid(),$)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,d,v,x,m)}sortBorders(){for(let i=0;i<4;i++)this.borders[i].sort((c,d)=>this.featuresOnBorder[c].borders[i][0]-this.featuresOnBorder[d].borders[i][0])}encodeCentroid(i,c,d=!0){let m,v;if(i)if(i.y!==0){const T=c.span()._mult(this.tileToMeter);m=(Math.max(i.x,1)<<3)+Math.min(7,Math.round(T.x/10)),v=(Math.max(i.y,1)<<3)+Math.min(7,Math.round(T.y/10))}else m=Math.ceil(7*(i.x+450)),v=0;else m=0,v=+d;let x=d?this.centroidVertexArray.length:c.vertexArrayOffset;for(const T of c.polyCount){d&&this.centroidVertexArray.resize(this.centroidVertexArray.length+4*T.edges+T.top);for(let P=0;P<T.top;P++)this.centroidVertexArray.emplace(x++,m,v);for(let P=0;P<2*T.edges;P++)this.centroidVertexArray.emplace(x++,0,v),this.centroidVertexArray.emplace(x++,m,v)}}}function bD(a,i){const c=a.add(i)._unit();return a.x*c.x+a.y*c.y}function R9(a,i,c,d){const m=i.sub(a)._perp()._unit(),v=c.sub(i)._perp()._unit();return wD(a,i,c,bD(m,v),d)}function wD(a,i,c,d,m){const v=Math.sqrt(1-d*d);return Math.min(a.dist(i)/3,i.dist(c)/3,m*v/d)}function SD(a,i,c){return a.x<c[0].x&&i.x<c[0].x||a.x>c[1].x&&i.x>c[1].x||a.y<c[0].y&&i.y<c[0].y||a.y>c[1].y&&i.y>c[1].y}function TD(a,i,c){if(a.x<0||a.x>=Zt||i.x<0||i.x>=Zt||c.x<0||c.x>=Zt)return!1;const d=c.sub(i),m=d.perp(),v=a.sub(i);return(d.x*v.x+d.y*v.y)/Math.sqrt((d.x*d.x+d.y*d.y)*(v.x*v.x+v.y*v.y))>-.866&&m.x*v.x+m.y*v.y<0}function ED(a,i,c){const d=i?2|a:-3&a;return c?1|d:-2&d}function AD(){const a=Math.PI/32,i=Math.tan(a),c=Gg;return c*Math.sqrt(1+2*i*i)-c}function PD(a,i,c){const d=1<<c.z,m=ps(c.x/d),v=ps((c.x+1)/d),x=Ui(c.y/d),T=Ui((c.y+1)/d);return function(P,C,D,$,U=0,q){const K=[];if(!P.length||!D||!$)return K;const Q=(be,We)=>{for(const Fe of be)K.push({polygon:Fe,bounds:We})},oe=Math.ceil(Math.log2(D)),de=Math.ceil(Math.log2($)),xe=oe-de,fe=[];for(let be=0;be<Math.abs(xe);be++)fe.push(xe>0?0:1);for(let be=0;be<Math.min(oe,de);be++)fe.push(0),fe.push(1);let _e=P;if(_e=X0(_e,C[0].y-U,C[1].y+U,1),_e=X0(_e,C[0].x-U,C[1].x+U,0),!_e.length)return K;const we=[];for(fe.length?we.push({polygons:_e,bounds:C,depth:0}):Q(_e,C);we.length;){const be=we.pop(),We=be.depth,Fe=fe[We],Qe=be.bounds[0],mt=be.bounds[1],Ke=Fe===0?Qe.x:Qe.y,ot=Fe===0?mt.x:mt.y,st=q?q(Fe,Ke,ot):.5*(Ke+ot),dt=X0(be.polygons,Ke-U,st+U,Fe),_t=X0(be.polygons,st-U,ot+U,Fe);if(dt.length){const Je=[Qe,new ue(Fe===0?st:mt.x,Fe===1?st:mt.y)];fe.length>We+1?we.push({polygons:dt,bounds:Je,depth:We+1}):Q(dt,Je)}if(_t.length){const Je=[new ue(Fe===0?st:Qe.x,Fe===1?st:Qe.y),mt];fe.length>We+1?we.push({polygons:_t,bounds:Je,depth:We+1}):Q(_t,Je)}}return K}(a,i,Math.ceil((v-m)/11.25),Math.ceil((x-T)/11.25),1,(P,C,D)=>{if(P===0)return .5*(C+D);{const $=Ui((c.y+C/Zt)/d);return(sl(.5*(Ui((c.y+D/Zt)/d)+$))*d-c.y)*Zt}})}jt(Yg,"FillExtrusionBucket",{omit:["layers","features"]}),jt(xD,"PartMetadata");const D9=new ge({"fill-extrusion-edge-radius":new J(Xe["layout_fill-extrusion"]["fill-extrusion-edge-radius"])});var L9={paint:new ge({"fill-extrusion-opacity":new J(Xe["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new se(Xe["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new J(Xe["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new J(Xe["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new se(Xe["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new se(Xe["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new se(Xe["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new J(Xe["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new J(Xe["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new J(Xe["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-rounded-roof":new J(Xe["paint_fill-extrusion"]["fill-extrusion-rounded-roof"])}),layout:D9};function CD(a,i,c){var d=2*Math.PI*6378137/256/Math.pow(2,c);return[a*d-2*Math.PI*6378137/2,i*d-2*Math.PI*6378137/2]}class Y0{constructor(i,c,d){this.z=i,this.x=c,this.y=d,this.key=Jg(0,i,i,c,d)}equals(i){return this.z===i.z&&this.x===i.x&&this.y===i.y}url(i,c){const d=function(v,x,T){var P=CD(256*v,256*(x=Math.pow(2,T)-x-1),T),C=CD(256*(v+1),256*(x+1),T);return P[0]+","+P[1]+","+C[0]+","+C[1]}(this.x,this.y,this.z),m=function(v,x,T){let P,C="";for(let D=v;D>0;D--)P=1<<D-1,C+=(x&P?1:0)+(T&P?2:0);return C}(this.z,this.x,this.y);return i[(this.x+this.y)%i.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(c==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",m).replace("{bbox-epsg-3857}",d)}toString(){return`${this.z}/${this.x}/${this.y}`}}class kD{constructor(i,c){this.wrap=i,this.canonical=c,this.key=Jg(i,c.z,c.z,c.x,c.y)}}class po{constructor(i,c,d,m,v){this.overscaledZ=i,this.wrap=c,this.canonical=new Y0(d,+m,+v),this.key=c===0&&i===d?this.canonical.key:Jg(c,i,d,m,v)}equals(i){return this.overscaledZ===i.overscaledZ&&this.wrap===i.wrap&&this.canonical.equals(i.canonical)}scaledTo(i){const c=this.canonical.z-i;return i>this.canonical.z?new po(i,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new po(i,this.wrap,i,this.canonical.x>>c,this.canonical.y>>c)}calculateScaledKey(i,c=!0){if(this.overscaledZ===i&&c)return this.key;if(i>this.canonical.z)return Jg(this.wrap*+c,i,this.canonical.z,this.canonical.x,this.canonical.y);{const d=this.canonical.z-i;return Jg(this.wrap*+c,i,i,this.canonical.x>>d,this.canonical.y>>d)}}isChildOf(i){if(i.wrap!==this.wrap)return!1;const c=this.canonical.z-i.canonical.z;return i.overscaledZ===0||i.overscaledZ<this.overscaledZ&&i.canonical.x===this.canonical.x>>c&&i.canonical.y===this.canonical.y>>c}children(i){if(this.overscaledZ>=i)return[new po(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const c=this.canonical.z+1,d=2*this.canonical.x,m=2*this.canonical.y;return[new po(c,this.wrap,c,d,m),new po(c,this.wrap,c,d+1,m),new po(c,this.wrap,c,d,m+1),new po(c,this.wrap,c,d+1,m+1)]}isLessThan(i){return this.wrap<i.wrap||!(this.wrap>i.wrap)&&(this.overscaledZ<i.overscaledZ||!(this.overscaledZ>i.overscaledZ)&&(this.canonical.x<i.canonical.x||!(this.canonical.x>i.canonical.x)&&this.canonical.y<i.canonical.y))}wrapped(){return new po(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(i){return new po(this.overscaledZ,i,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new kD(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function Jg(a,i,c,d,m){const v=1<<Math.min(c,22);let x=v*(m%v)+d%v;return a&&c<22&&(x+=v*v*((a<0?-2*a-1:2*a)%(1<<2*(22-c)))),16*(32*x+c)+(i-c)}jt(Y0,"CanonicalTileID"),jt(po,"OverscaledTileID",{omit:["projMatrix"]});class Tf extends ue{constructor(i,c,d){super(i,c),this.z=d}}function Qg(a,i){return a.x*i.x+a.y*i.y}function OD(a,i){if(a.length===1){let c=0;const d=i[c++];let m;for(;!m||d.equals(m);)if(m=i[c++],!m)return 1/0;for(;c<i.length;c++){const v=i[c],x=a[0],T=m.sub(d),P=v.sub(d),C=x.sub(d),D=Qg(T,T),$=Qg(T,P),U=Qg(P,P),q=Qg(C,T),K=Qg(C,P),Q=D*U-$*$,oe=(U*q-$*K)/Q,de=(D*K-$*q)/Q,xe=d.z*(1-oe-de)+m.z*oe+v.z*de;if(isFinite(xe))return xe}return 1/0}{let c=1/0;for(const d of i)c=Math.min(c,d.z);return c}}function MD(a,i,c,d,m,v,x,T){const P=x*m.getElevationAt(a,i,!0,!0),C=v[0]!==0,D=C?v[1]===0?x*(v[0]/7-450):x*function($,U,q){const K=Math.floor(U[0]/8),Q=Math.floor(U[1]/8),oe=10*(U[0]-8*K),de=10*(U[1]-8*Q),xe=$.getElevationAt(K,Q,!0,!0),fe=$.getMeterToDEM(q),_e=Math.floor(.5*(oe*fe-1)),we=Math.floor(.5*(de*fe-1)),be=$.tileCoordToPixel(K,Q),We=2*_e+1,Fe=2*we+1,Qe=function(_t,Je,Pt,Bt,kt){return[_t.getElevationAtPixel(Je,Pt,!0),_t.getElevationAtPixel(Je+kt,Pt,!0),_t.getElevationAtPixel(Je,Pt+kt,!0),_t.getElevationAtPixel(Je+Bt,Pt+kt,!0)]}($,be.x-_e,be.y-we,We,Fe),mt=Math.abs(Qe[0]-Qe[1]),Ke=Math.abs(Qe[2]-Qe[3]),ot=Math.abs(Qe[0]-Qe[2])+Math.abs(Qe[1]-Qe[3]),st=Math.min(.25,.5*fe*(mt+Ke)/We),dt=Math.min(.25,.5*fe*ot/Fe);return xe+Math.max(st*oe,dt*de)}(m,v,T):P;return{base:P+(c===0)?-1:c,top:C?Math.max(D+d,P+c+2):P+d}}const j9=Ie([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:z9}=j9,B9=Ie([{name:"a_packed",components:4,type:"Float32"}]),{members:N9}=B9,$9=Z0.types,F9=Math.cos(Math.PI/180*37.5);class J0{constructor(i){this.zoom=i.zoom,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(c=>c.id),this.index=i.index,this.projection=i.projection,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(c=>{this.gradients[c.id]={}}),this.layoutVertexArray=new He,this.layoutVertexArray2=new ft,this.indexArray=new Nt,this.programConfigurations=new wh(i.layers,i.zoom),this.segments=new Wn,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(c=>c.isStateDependent()).map(c=>c.id)}populate(i,c,d,m){this.hasPattern=jT("line",this.layers,c);const v=this.layers[0].layout.get("line-sort-key"),x=[];for(const{feature:D,id:$,index:U,sourceLayerIndex:q}of i){const K=this.layers[0]._featureFilter.needGeometry,Q=Ch(D,K);if(!this.layers[0]._featureFilter.filter(new N(this.zoom),Q,d))continue;const oe=v?v.evaluate(Q,{},d):void 0,de={id:$,properties:D.properties,type:D.type,sourceLayerIndex:q,index:U,geometry:K?Q.geometry:Gl(D,d,m),patterns:{},sortKey:oe};x.push(de)}v&&x.sort((D,$)=>D.sortKey-$.sortKey);const{lineAtlas:T,featureIndex:P}=c,C=this.addConstantDashes(T);for(const D of x){const{geometry:$,index:U,sourceLayerIndex:q}=D;if(C&&this.addFeatureDashes(D,T),this.hasPattern){const K=zT("line",this.layers,D,this.zoom,c);this.patternFeatures.push(K)}else this.addFeature(D,$,U,d,T.positions,c.availableImages);P.insert(i[U].feature,$,U,q,this.index)}}addConstantDashes(i){let c=!1;for(const d of this.layers){const m=d.paint.get("line-dasharray").value,v=d.layout.get("line-cap").value;if(m.kind!=="constant"||v.kind!=="constant")c=!0;else{const x=v.value,T=m.value;if(!T)continue;i.addDash(T,x)}}return c}addFeatureDashes(i,c){const d=this.zoom;for(const m of this.layers){const v=m.paint.get("line-dasharray").value,x=m.layout.get("line-cap").value;if(v.kind==="constant"&&x.kind==="constant")continue;let T,P;if(v.kind==="constant"){if(T=v.value,!T)continue}else T=v.evaluate({zoom:d},i);P=x.kind==="constant"?x.value:x.evaluate({zoom:d},i),c.addDash(T,P),i.patterns[m.id]=c.getKey(T,P)}}update(i,c,d,m){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(i,c,this.stateDependentLayers,d,m)}addFeatures(i,c,d,m,v){for(const x of this.patternFeatures)this.addFeature(x,x.geometry,x.index,c,d,m)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(i){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=i.createVertexBuffer(this.layoutVertexArray2,N9)),this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,z9),this.indexBuffer=i.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(i),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(i){if(i.properties&&i.properties.hasOwnProperty("mapbox_clip_start")&&i.properties.hasOwnProperty("mapbox_clip_end"))return{start:+i.properties.mapbox_clip_start,end:+i.properties.mapbox_clip_end}}addFeature(i,c,d,m,v,x){const T=this.layers[0].layout,P=T.get("line-join").evaluate(i,{}),C=T.get("line-cap").evaluate(i,{}),D=T.get("line-miter-limit"),$=T.get("line-round-limit");this.lineClips=this.lineFeatureClips(i);for(const U of c)this.addLine(U,i,P,C,D,$);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,d,v,x,m)}addLine(i,c,d,m,v,x){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let de=0;de<i.length-1;de++)this.totalDistance+=i[de].dist(i[de+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const T=$9[c.type]==="Polygon";let P=i.length;for(;P>=2&&i[P-1].equals(i[P-2]);)P--;let C=0;for(;C<P-1&&i[C].equals(i[C+1]);)C++;if(P<(T?3:2))return;d==="bevel"&&(v=1.05);const D=this.overscaling<=16?15*Zt/(512*this.overscaling):0,$=this.segments.prepareSegment(10*P,this.layoutVertexArray,this.indexArray);let U,q,K,Q,oe;this.e1=this.e2=-1,T&&(U=i[P-2],oe=i[C].sub(U)._unit()._perp());for(let de=C;de<P;de++){if(K=de===P-1?T?i[C+1]:void 0:i[de+1],K&&i[de].equals(K))continue;oe&&(Q=oe),U&&(q=U),U=i[de],oe=K?K.sub(U)._unit()._perp():Q,Q=Q||oe;let xe=Q.add(oe);xe.x===0&&xe.y===0||xe._unit();const fe=Q.x*oe.x+Q.y*oe.y,_e=xe.x*oe.x+xe.y*oe.y,we=_e!==0?1/_e:1/0,be=2*Math.sqrt(2-2*_e),We=_e<F9&&q&&K,Fe=Q.x*oe.y-Q.y*oe.x>0;if(We&&de>C){const Ke=U.dist(q);if(Ke>2*D){const ot=U.sub(U.sub(q)._mult(D/Ke)._round());this.updateDistance(q,ot),this.addCurrentVertex(ot,Q,0,0,$),q=ot}}const Qe=q&&K;let mt=Qe?d:T?"butt":m;if(Qe&&mt==="round"&&(we<x?mt="miter":we<=2&&(mt="fakeround")),mt==="miter"&&we>v&&(mt="bevel"),mt==="bevel"&&(we>2&&(mt="flipbevel"),we<v&&(mt="miter")),q&&this.updateDistance(q,U),mt==="miter")xe._mult(we),this.addCurrentVertex(U,xe,0,0,$);else if(mt==="flipbevel"){if(we>100)xe=oe.mult(-1);else{const Ke=we*Q.add(oe).mag()/Q.sub(oe).mag();xe._perp()._mult(Ke*(Fe?-1:1))}this.addCurrentVertex(U,xe,0,0,$),this.addCurrentVertex(U,xe.mult(-1),0,0,$)}else if(mt==="bevel"||mt==="fakeround"){const Ke=-Math.sqrt(we*we-1),ot=Fe?Ke:0,st=Fe?0:Ke;if(q&&this.addCurrentVertex(U,Q,ot,st,$),mt==="fakeround"){const dt=Math.round(180*be/Math.PI/20);for(let _t=1;_t<dt;_t++){let Je=_t/dt;if(Je!==.5){const Bt=Je-.5;Je+=Je*Bt*(Je-1)*((1.0904+fe*(fe*(3.55645-1.43519*fe)-3.2452))*Bt*Bt+(.848013+fe*(.215638*fe-1.06021)))}const Pt=oe.sub(Q)._mult(Je)._add(Q)._unit()._mult(Fe?-1:1);this.addHalfVertex(U,Pt.x,Pt.y,!1,Fe,0,$)}}K&&this.addCurrentVertex(U,oe,-ot,-st,$)}else if(mt==="butt")this.addCurrentVertex(U,xe,0,0,$);else if(mt==="square"){const Ke=q?1:-1;q||this.addCurrentVertex(U,xe,Ke,Ke,$),this.addCurrentVertex(U,xe,0,0,$),q&&this.addCurrentVertex(U,xe,Ke,Ke,$)}else mt==="round"&&(q&&(this.addCurrentVertex(U,Q,0,0,$),this.addCurrentVertex(U,Q,1,1,$,!0)),K&&(this.addCurrentVertex(U,oe,-1,-1,$,!0),this.addCurrentVertex(U,oe,0,0,$)));if(We&&de<P-1){const Ke=U.dist(K);if(Ke>2*D){const ot=U.add(K.sub(U)._mult(D/Ke)._round());this.updateDistance(U,ot),this.addCurrentVertex(ot,oe,0,0,$),U=ot}}}}addCurrentVertex(i,c,d,m,v,x=!1){const T=c.y*m-c.x,P=-c.y-c.x*m;this.addHalfVertex(i,c.x+c.y*d,c.y-c.x*d,x,!1,d,v),this.addHalfVertex(i,T,P,x,!0,-m,v)}addHalfVertex({x:i,y:c},d,m,v,x,T,P){this.layoutVertexArray.emplaceBack((i<<1)+(v?1:0),(c<<1)+(x?1:0),Math.round(63*d)+128,Math.round(63*m)+128,1+(T===0?0:T<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const C=P.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,C),P.primitiveLength++),x?this.e2=C:this.e1=C}updateScaledDistance(){if(this.lineClips){const i=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=i*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(i,c){this.distance+=i.dist(c),this.updateScaledDistance()}}jt(J0,"LineBucket",{omit:["layers","patternFeatures"]});const U9=new ge({"line-cap":new se(Xe.layout_line["line-cap"]),"line-join":new se(Xe.layout_line["line-join"]),"line-miter-limit":new J(Xe.layout_line["line-miter-limit"]),"line-round-limit":new J(Xe.layout_line["line-round-limit"]),"line-sort-key":new se(Xe.layout_line["line-sort-key"])});var ID={paint:new ge({"line-opacity":new se(Xe.paint_line["line-opacity"]),"line-color":new se(Xe.paint_line["line-color"]),"line-translate":new J(Xe.paint_line["line-translate"]),"line-translate-anchor":new J(Xe.paint_line["line-translate-anchor"]),"line-width":new se(Xe.paint_line["line-width"]),"line-gap-width":new se(Xe.paint_line["line-gap-width"]),"line-offset":new se(Xe.paint_line["line-offset"]),"line-blur":new se(Xe.paint_line["line-blur"]),"line-dasharray":new se(Xe.paint_line["line-dasharray"]),"line-pattern":new se(Xe.paint_line["line-pattern"]),"line-gradient":new me(Xe.paint_line["line-gradient"]),"line-trim-offset":new J(Xe.paint_line["line-trim-offset"])}),layout:U9};const RD=new class extends se{possiblyEvaluate(a,i){return i=new N(Math.floor(i.zoom),{now:i.now,fadeDuration:i.fadeDuration,transition:i.transition}),super.possiblyEvaluate(a,i)}evaluate(a,i,c,d){return i=$t({},i,{zoom:Math.floor(i.zoom)}),super.evaluate(a,i,c,d)}}(ID.paint.properties["line-width"].specification);function DD(a,i){return i>0?i+2*a:a}RD.useIntegerZoom=!0;const V9=Ie([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),G9=Ie([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),W9=Ie([{name:"a_projected_pos",components:4,type:"Float32"}],4);Ie([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const q9=Ie([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),H9=Ie([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"}]);Ie([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const LD=Ie([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),K9=Ie([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);Ie([{name:"triangle",components:3,type:"Uint16"}]),Ie([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),Ie([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),Ie([{type:"Float32",name:"offsetX"}]),Ie([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var Ai=24;const xa=128;function NT(a,i){const{expression:c}=i;if(c.kind==="constant")return{kind:"constant",layoutSize:c.evaluate(new N(a+1))};if(c.kind==="source")return{kind:"source"};{const{zoomStops:d,interpolationType:m}=c;let v=0;for(;v<d.length&&d[v]<=a;)v++;v=Math.max(0,v-1);let x=v;for(;x<d.length&&d[x]<a+1;)x++;x=Math.min(d.length-1,x);const T=d[v],P=d[x];return c.kind==="composite"?{kind:"composite",minZoom:T,maxZoom:P,interpolationType:m}:{kind:"camera",minZoom:T,maxZoom:P,minSize:c.evaluate(new N(T)),maxSize:c.evaluate(new N(P)),interpolationType:m}}}function Q0(a,{uSize:i,uSizeT:c},{lowerSize:d,upperSize:m}){return a.kind==="source"?d/xa:a.kind==="composite"?Or(d/xa,m/xa,c):i}function Ef(a,i){let c=0,d=0;if(a.kind==="constant")d=a.layoutSize;else if(a.kind!=="source"){const{interpolationType:m,minZoom:v,maxZoom:x}=a,T=m?De(Ds.interpolationFactor(m,i,v,x),0,1):0;a.kind==="camera"?d=Or(a.minSize,a.maxSize,T):c=T}return{uSizeT:c,uSize:d}}var Z9=Object.freeze({__proto__:null,SIZE_PACK_FACTOR:xa,evaluateSizeForFeature:Q0,evaluateSizeForZoom:Ef,getSizeData:NT});function X9(a,i,c){return a.sections.forEach(d=>{d.text=function(m,v,x){const T=v.layout.get("text-transform").evaluate(x,{});return T==="uppercase"?m=m.toLocaleUpperCase():T==="lowercase"&&(m=m.toLocaleLowerCase()),I.applyArabicShaping&&(m=I.applyArabicShaping(m)),m}(d.text,i,c)}),a}const ey={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};function Y9(a){return a===""||a===""||a===""||a===""||a===""||a===""||a===""||a===""||a===""||a===""||a===""||a===""||a===""||a===""||a===""||a===""||a===""}function J9(a){return a===""||a===""||a===""||a===""||a===""||a===""||a===""||a===""||a===""||a===""}var jD=tn,zD=function(a,i,c,d,m){var v,x,T=8*m-d-1,P=(1<<T)-1,C=P>>1,D=-7,$=m-1,U=-1,q=a[i+$];for($+=U,v=q&(1<<-D)-1,q>>=-D,D+=T;D>0;v=256*v+a[i+$],$+=U,D-=8);for(x=v&(1<<-D)-1,v>>=-D,D+=d;D>0;x=256*x+a[i+$],$+=U,D-=8);if(v===0)v=1-C;else{if(v===P)return x?NaN:1/0*(q?-1:1);x+=Math.pow(2,d),v-=C}return(q?-1:1)*x*Math.pow(2,v-d)},BD=function(a,i,c,d,m,v){var x,T,P,C=8*v-m-1,D=(1<<C)-1,$=D>>1,U=m===23?Math.pow(2,-24)-Math.pow(2,-77):0,q=0,K=1,Q=i<0||i===0&&1/i<0?1:0;for(i=Math.abs(i),isNaN(i)||i===1/0?(T=isNaN(i)?1:0,x=D):(x=Math.floor(Math.log(i)/Math.LN2),i*(P=Math.pow(2,-x))<1&&(x--,P*=2),(i+=x+$>=1?U/P:U*Math.pow(2,1-$))*P>=2&&(x++,P/=2),x+$>=D?(T=0,x=D):x+$>=1?(T=(i*P-1)*Math.pow(2,m),x+=$):(T=i*Math.pow(2,$-1)*Math.pow(2,m),x=0));m>=8;a[c+q]=255&T,q+=K,T/=256,m-=8);for(x=x<<m|T,C+=m;C>0;a[c+q]=255&x,q+=K,x/=256,C-=8);a[c+q-K]|=128*Q};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */function tn(a){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(a)?a:new Uint8Array(a||0),this.pos=0,this.type=0,this.length=this.buf.length}tn.Varint=0,tn.Fixed64=1,tn.Bytes=2,tn.Fixed32=5;var $T=4294967296,ND=1/$T,$D=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function ql(a){return a.type===tn.Bytes?a.readVarint()+a.pos:a.pos+1}function Af(a,i,c){return c?4294967296*i+(a>>>0):4294967296*(i>>>0)+(a>>>0)}function FD(a,i,c){var d=i<=16383?1:i<=2097151?2:i<=268435455?3:Math.floor(Math.log(i)/(7*Math.LN2));c.realloc(d);for(var m=c.pos-1;m>=a;m--)c.buf[m+d]=c.buf[m]}function Q9(a,i){for(var c=0;c<a.length;c++)i.writeVarint(a[c])}function e7(a,i){for(var c=0;c<a.length;c++)i.writeSVarint(a[c])}function t7(a,i){for(var c=0;c<a.length;c++)i.writeFloat(a[c])}function r7(a,i){for(var c=0;c<a.length;c++)i.writeDouble(a[c])}function n7(a,i){for(var c=0;c<a.length;c++)i.writeBoolean(a[c])}function i7(a,i){for(var c=0;c<a.length;c++)i.writeFixed32(a[c])}function o7(a,i){for(var c=0;c<a.length;c++)i.writeSFixed32(a[c])}function s7(a,i){for(var c=0;c<a.length;c++)i.writeFixed64(a[c])}function a7(a,i){for(var c=0;c<a.length;c++)i.writeSFixed64(a[c])}function ex(a,i){return(a[i]|a[i+1]<<8|a[i+2]<<16)+16777216*a[i+3]}function Pf(a,i,c){a[c]=i,a[c+1]=i>>>8,a[c+2]=i>>>16,a[c+3]=i>>>24}function UD(a,i){return(a[i]|a[i+1]<<8|a[i+2]<<16)+(a[i+3]<<24)}tn.prototype={destroy:function(){this.buf=null},readFields:function(a,i,c){for(c=c||this.length;this.pos<c;){var d=this.readVarint(),m=d>>3,v=this.pos;this.type=7&d,a(m,i,this),this.pos===v&&this.skip(d)}return i},readMessage:function(a,i){return this.readFields(a,i,this.readVarint()+this.pos)},readFixed32:function(){var a=ex(this.buf,this.pos);return this.pos+=4,a},readSFixed32:function(){var a=UD(this.buf,this.pos);return this.pos+=4,a},readFixed64:function(){var a=ex(this.buf,this.pos)+ex(this.buf,this.pos+4)*$T;return this.pos+=8,a},readSFixed64:function(){var a=ex(this.buf,this.pos)+UD(this.buf,this.pos+4)*$T;return this.pos+=8,a},readFloat:function(){var a=zD(this.buf,this.pos,!0,23,4);return this.pos+=4,a},readDouble:function(){var a=zD(this.buf,this.pos,!0,52,8);return this.pos+=8,a},readVarint:function(a){var i,c,d=this.buf;return i=127&(c=d[this.pos++]),c<128?i:(i|=(127&(c=d[this.pos++]))<<7,c<128?i:(i|=(127&(c=d[this.pos++]))<<14,c<128?i:(i|=(127&(c=d[this.pos++]))<<21,c<128?i:function(m,v,x){var T,P,C=x.buf;if(T=(112&(P=C[x.pos++]))>>4,P<128||(T|=(127&(P=C[x.pos++]))<<3,P<128)||(T|=(127&(P=C[x.pos++]))<<10,P<128)||(T|=(127&(P=C[x.pos++]))<<17,P<128)||(T|=(127&(P=C[x.pos++]))<<24,P<128)||(T|=(1&(P=C[x.pos++]))<<31,P<128))return Af(m,T,v);throw new Error("Expected varint not more than 10 bytes")}(i|=(15&(c=d[this.pos]))<<28,a,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var a=this.readVarint();return a%2==1?(a+1)/-2:a/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var a=this.readVarint()+this.pos,i=this.pos;return this.pos=a,a-i>=12&&$D?function(c,d,m){return $D.decode(c.subarray(d,m))}(this.buf,i,a):function(c,d,m){for(var v="",x=d;x<m;){var T,P,C,D=c[x],$=null,U=D>239?4:D>223?3:D>191?2:1;if(x+U>m)break;U===1?D<128&&($=D):U===2?(192&(T=c[x+1]))==128&&($=(31&D)<<6|63&T)<=127&&($=null):U===3?(P=c[x+2],(192&(T=c[x+1]))==128&&(192&P)==128&&(($=(15&D)<<12|(63&T)<<6|63&P)<=2047||$>=55296&&$<=57343)&&($=null)):U===4&&(P=c[x+2],C=c[x+3],(192&(T=c[x+1]))==128&&(192&P)==128&&(192&C)==128&&(($=(15&D)<<18|(63&T)<<12|(63&P)<<6|63&C)<=65535||$>=1114112)&&($=null)),$===null?($=65533,U=1):$>65535&&($-=65536,v+=String.fromCharCode($>>>10&1023|55296),$=56320|1023&$),v+=String.fromCharCode($),x+=U}return v}(this.buf,i,a)},readBytes:function(){var a=this.readVarint()+this.pos,i=this.buf.subarray(this.pos,a);return this.pos=a,i},readPackedVarint:function(a,i){if(this.type!==tn.Bytes)return a.push(this.readVarint(i));var c=ql(this);for(a=a||[];this.pos<c;)a.push(this.readVarint(i));return a},readPackedSVarint:function(a){if(this.type!==tn.Bytes)return a.push(this.readSVarint());var i=ql(this);for(a=a||[];this.pos<i;)a.push(this.readSVarint());return a},readPackedBoolean:function(a){if(this.type!==tn.Bytes)return a.push(this.readBoolean());var i=ql(this);for(a=a||[];this.pos<i;)a.push(this.readBoolean());return a},readPackedFloat:function(a){if(this.type!==tn.Bytes)return a.push(this.readFloat());var i=ql(this);for(a=a||[];this.pos<i;)a.push(this.readFloat());return a},readPackedDouble:function(a){if(this.type!==tn.Bytes)return a.push(this.readDouble());var i=ql(this);for(a=a||[];this.pos<i;)a.push(this.readDouble());return a},readPackedFixed32:function(a){if(this.type!==tn.Bytes)return a.push(this.readFixed32());var i=ql(this);for(a=a||[];this.pos<i;)a.push(this.readFixed32());return a},readPackedSFixed32:function(a){if(this.type!==tn.Bytes)return a.push(this.readSFixed32());var i=ql(this);for(a=a||[];this.pos<i;)a.push(this.readSFixed32());return a},readPackedFixed64:function(a){if(this.type!==tn.Bytes)return a.push(this.readFixed64());var i=ql(this);for(a=a||[];this.pos<i;)a.push(this.readFixed64());return a},readPackedSFixed64:function(a){if(this.type!==tn.Bytes)return a.push(this.readSFixed64());var i=ql(this);for(a=a||[];this.pos<i;)a.push(this.readSFixed64());return a},skip:function(a){var i=7&a;if(i===tn.Varint)for(;this.buf[this.pos++]>127;);else if(i===tn.Bytes)this.pos=this.readVarint()+this.pos;else if(i===tn.Fixed32)this.pos+=4;else{if(i!==tn.Fixed64)throw new Error("Unimplemented type: "+i);this.pos+=8}},writeTag:function(a,i){this.writeVarint(a<<3|i)},realloc:function(a){for(var i=this.length||16;i<this.pos+a;)i*=2;if(i!==this.length){var c=new Uint8Array(i);c.set(this.buf),this.buf=c,this.length=i}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(a){this.realloc(4),Pf(this.buf,a,this.pos),this.pos+=4},writeSFixed32:function(a){this.realloc(4),Pf(this.buf,a,this.pos),this.pos+=4},writeFixed64:function(a){this.realloc(8),Pf(this.buf,-1&a,this.pos),Pf(this.buf,Math.floor(a*ND),this.pos+4),this.pos+=8},writeSFixed64:function(a){this.realloc(8),Pf(this.buf,-1&a,this.pos),Pf(this.buf,Math.floor(a*ND),this.pos+4),this.pos+=8},writeVarint:function(a){(a=+a||0)>268435455||a<0?function(i,c){var d,m;if(i>=0?(d=i%4294967296|0,m=i/4294967296|0):(m=~(-i/4294967296),4294967295^(d=~(-i%4294967296))?d=d+1|0:(d=0,m=m+1|0)),i>=18446744073709552e3||i<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");c.realloc(10),function(v,x,T){T.buf[T.pos++]=127&v|128,v>>>=7,T.buf[T.pos++]=127&v|128,v>>>=7,T.buf[T.pos++]=127&v|128,v>>>=7,T.buf[T.pos++]=127&v|128,T.buf[T.pos]=127&(v>>>=7)}(d,0,c),function(v,x){var T=(7&v)<<4;x.buf[x.pos++]|=T|((v>>>=3)?128:0),v&&(x.buf[x.pos++]=127&v|((v>>>=7)?128:0),v&&(x.buf[x.pos++]=127&v|((v>>>=7)?128:0),v&&(x.buf[x.pos++]=127&v|((v>>>=7)?128:0),v&&(x.buf[x.pos++]=127&v|((v>>>=7)?128:0),v&&(x.buf[x.pos++]=127&v)))))}(m,c)}(a,this):(this.realloc(4),this.buf[this.pos++]=127&a|(a>127?128:0),a<=127||(this.buf[this.pos++]=127&(a>>>=7)|(a>127?128:0),a<=127||(this.buf[this.pos++]=127&(a>>>=7)|(a>127?128:0),a<=127||(this.buf[this.pos++]=a>>>7&127))))},writeSVarint:function(a){this.writeVarint(a<0?2*-a-1:2*a)},writeBoolean:function(a){this.writeVarint(!!a)},writeString:function(a){a=String(a),this.realloc(4*a.length),this.pos++;var i=this.pos;this.pos=function(d,m,v){for(var x,T,P=0;P<m.length;P++){if((x=m.charCodeAt(P))>55295&&x<57344){if(!T){x>56319||P+1===m.length?(d[v++]=239,d[v++]=191,d[v++]=189):T=x;continue}if(x<56320){d[v++]=239,d[v++]=191,d[v++]=189,T=x;continue}x=T-55296<<10|x-56320|65536,T=null}else T&&(d[v++]=239,d[v++]=191,d[v++]=189,T=null);x<128?d[v++]=x:(x<2048?d[v++]=x>>6|192:(x<65536?d[v++]=x>>12|224:(d[v++]=x>>18|240,d[v++]=x>>12&63|128),d[v++]=x>>6&63|128),d[v++]=63&x|128)}return v}(this.buf,a,this.pos);var c=this.pos-i;c>=128&&FD(i,c,this),this.pos=i-1,this.writeVarint(c),this.pos+=c},writeFloat:function(a){this.realloc(4),BD(this.buf,a,this.pos,!0,23,4),this.pos+=4},writeDouble:function(a){this.realloc(8),BD(this.buf,a,this.pos,!0,52,8),this.pos+=8},writeBytes:function(a){var i=a.length;this.writeVarint(i),this.realloc(i);for(var c=0;c<i;c++)this.buf[this.pos++]=a[c]},writeRawMessage:function(a,i){this.pos++;var c=this.pos;a(i,this);var d=this.pos-c;d>=128&&FD(c,d,this),this.pos=c-1,this.writeVarint(d),this.pos+=d},writeMessage:function(a,i,c){this.writeTag(a,tn.Bytes),this.writeRawMessage(i,c)},writePackedVarint:function(a,i){i.length&&this.writeMessage(a,Q9,i)},writePackedSVarint:function(a,i){i.length&&this.writeMessage(a,e7,i)},writePackedBoolean:function(a,i){i.length&&this.writeMessage(a,n7,i)},writePackedFloat:function(a,i){i.length&&this.writeMessage(a,t7,i)},writePackedDouble:function(a,i){i.length&&this.writeMessage(a,r7,i)},writePackedFixed32:function(a,i){i.length&&this.writeMessage(a,i7,i)},writePackedSFixed32:function(a,i){i.length&&this.writeMessage(a,o7,i)},writePackedFixed64:function(a,i){i.length&&this.writeMessage(a,s7,i)},writePackedSFixed64:function(a,i){i.length&&this.writeMessage(a,a7,i)},writeBytesField:function(a,i){this.writeTag(a,tn.Bytes),this.writeBytes(i)},writeFixed32Field:function(a,i){this.writeTag(a,tn.Fixed32),this.writeFixed32(i)},writeSFixed32Field:function(a,i){this.writeTag(a,tn.Fixed32),this.writeSFixed32(i)},writeFixed64Field:function(a,i){this.writeTag(a,tn.Fixed64),this.writeFixed64(i)},writeSFixed64Field:function(a,i){this.writeTag(a,tn.Fixed64),this.writeSFixed64(i)},writeVarintField:function(a,i){this.writeTag(a,tn.Varint),this.writeVarint(i)},writeSVarintField:function(a,i){this.writeTag(a,tn.Varint),this.writeSVarint(i)},writeStringField:function(a,i){this.writeTag(a,tn.Bytes),this.writeString(i)},writeFloatField:function(a,i){this.writeTag(a,tn.Fixed32),this.writeFloat(i)},writeDoubleField:function(a,i){this.writeTag(a,tn.Fixed64),this.writeDouble(i)},writeBooleanField:function(a,i){this.writeVarintField(a,!!i)}};var tx=Z(jD);const FT=3;function l7(a,i,c){i.glyphs=[],a===1&&c.readMessage(c7,i)}function c7(a,i,c){if(a===3){const{id:d,bitmap:m,width:v,height:x,left:T,top:P,advance:C}=c.readMessage(u7,{});i.glyphs.push({id:d,bitmap:new Wl({width:v+2*FT,height:x+2*FT},m),metrics:{width:v,height:x,left:T,top:P,advance:C}})}else a===4?i.ascender=c.readSVarint():a===5&&(i.descender=c.readSVarint())}function u7(a,i,c){a===1?i.id=c.readVarint():a===2?i.bitmap=c.readBytes():a===3?i.width=c.readVarint():a===4?i.height=c.readVarint():a===5?i.left=c.readSVarint():a===6?i.top=c.readSVarint():a===7&&(i.advance=c.readVarint())}const VD=FT;function UT(a){let i=0,c=0;for(const x of a)i+=x.w*x.h,c=Math.max(c,x.w);a.sort((x,T)=>T.h-x.h);const d=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(i/.95)),c),h:1/0}];let m=0,v=0;for(const x of a)for(let T=d.length-1;T>=0;T--){const P=d[T];if(!(x.w>P.w||x.h>P.h)){if(x.x=P.x,x.y=P.y,v=Math.max(v,x.y+x.h),m=Math.max(m,x.x+x.w),x.w===P.w&&x.h===P.h){const C=d.pop();T<d.length&&(d[T]=C)}else x.h===P.h?(P.x+=x.w,P.w-=x.w):x.w===P.w?(P.y+=x.h,P.h-=x.h):(d.push({x:P.x+x.w,y:P.y,w:P.w-x.w,h:x.h}),P.y+=x.h,P.h-=x.h);break}}return{w:m,h:v,fill:i/(m*v)||0}}const ko=1;class VT{constructor(i,{pixelRatio:c,version:d,stretchX:m,stretchY:v,content:x}){this.paddedRect=i,this.pixelRatio=c,this.stretchX=m,this.stretchY=v,this.content=x,this.version=d}get tl(){return[this.paddedRect.x+ko,this.paddedRect.y+ko]}get br(){return[this.paddedRect.x+this.paddedRect.w-ko,this.paddedRect.y+this.paddedRect.h-ko]}get displaySize(){return[(this.paddedRect.w-2*ko)/this.pixelRatio,(this.paddedRect.h-2*ko)/this.pixelRatio]}}class GD{constructor(i,c){const d={},m={};this.haveRenderCallbacks=[];const v=[];this.addImages(i,d,v),this.addImages(c,m,v);const{w:x,h:T}=UT(v),P=new Ho({width:x||1,height:T||1});for(const C in i){const D=i[C],$=d[C].paddedRect;Ho.copy(D.data,P,{x:0,y:0},{x:$.x+ko,y:$.y+ko},D.data)}for(const C in c){const D=c[C],$=m[C].paddedRect,U=$.x+ko,q=$.y+ko,K=D.data.width,Q=D.data.height;Ho.copy(D.data,P,{x:0,y:0},{x:U,y:q},D.data),Ho.copy(D.data,P,{x:0,y:Q-1},{x:U,y:q-1},{width:K,height:1}),Ho.copy(D.data,P,{x:0,y:0},{x:U,y:q+Q},{width:K,height:1}),Ho.copy(D.data,P,{x:K-1,y:0},{x:U-1,y:q},{width:1,height:Q}),Ho.copy(D.data,P,{x:0,y:0},{x:U+K,y:q},{width:1,height:Q})}this.image=P,this.iconPositions=d,this.patternPositions=m}addImages(i,c,d){for(const m in i){const v=i[m],x={x:0,y:0,w:v.data.width+2*ko,h:v.data.height+2*ko};d.push(x),c[m]=new VT(x,v),v.hasRenderCallback&&this.haveRenderCallbacks.push(m)}}patchUpdatedImages(i,c){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(d=>i.hasImage(d)),i.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const d in i.updatedImages)this.patchUpdatedImage(this.iconPositions[d],i.getImage(d),c),this.patchUpdatedImage(this.patternPositions[d],i.getImage(d),c)}patchUpdatedImage(i,c,d){if(!i||!c||i.version===c.version)return;i.version=c.version;const[m,v]=i.tl;d.update(c.data,void 0,{x:m,y:v})}}jt(VT,"ImagePosition"),jt(GD,"ImageAtlas");const ms={horizontal:1,vertical:2,horizontalOnly:3},WD=-17;class ty{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(i,c){const d=new ty;return d.scale=i||1,d.fontStack=c,d}static forImage(i){const c=new ty;return c.imageName=i,c}}class Cf{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(i,c){const d=new Cf;for(let m=0;m<i.sections.length;m++){const v=i.sections[m];v.image?d.addImageSection(v):d.addTextSection(v,c)}return d}length(){return this.text.length}getSection(i){return this.sections[this.sectionIndex[i]]}getSections(){return this.sections}getSectionIndex(i){return this.sectionIndex[i]}getCharCode(i){return this.text.charCodeAt(i)}verticalizePunctuation(i){this.text=function(c,d){let m="";for(let v=0;v<c.length;v++){const x=c.charCodeAt(v+1)||null,T=c.charCodeAt(v-1)||null;m+=!d&&(x&&O0(x)&&!ey[c[v+1]]||T&&O0(T)&&!ey[c[v-1]])||!ey[c[v]]?c[v]:ey[c[v]]}return m}(this.text,i)}trim(){let i=0;for(let d=0;d<this.text.length&&rx[this.text.charCodeAt(d)];d++)i++;let c=this.text.length;for(let d=this.text.length-1;d>=0&&d>=i&&rx[this.text.charCodeAt(d)];d--)c--;this.text=this.text.substring(i,c),this.sectionIndex=this.sectionIndex.slice(i,c)}substring(i,c){const d=new Cf;return d.text=this.text.substring(i,c),d.sectionIndex=this.sectionIndex.slice(i,c),d.sections=this.sections,d}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((i,c)=>Math.max(i,this.sections[c].scale),0)}addTextSection(i,c){this.text+=i.text,this.sections.push(ty.forText(i.scale,i.fontStack||c));const d=this.sections.length-1;for(let m=0;m<i.text.length;++m)this.sectionIndex.push(d)}addImageSection(i){const c=i.image?i.image.name:"";if(c.length===0)return void Et("Can't add FormattedSection with an empty image.");const d=this.getNextImageSectionCharCode();d?(this.text+=String.fromCharCode(d),this.sections.push(ty.forImage(c)),this.sectionIndex.push(this.sections.length-1)):Et("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function GT(a,i,c,d,m,v,x,T,P,C,D,$,U,q,K){const Q=Cf.fromFeature(a,m);$===ms.vertical&&Q.verticalizePunctuation(U);let oe=[];const de=function(be,We,Fe,Qe,mt,Ke){if(!be)return[];const ot=[],st=function(Pt,Bt,kt,ar,bt,Gt){let lr=0;for(let Rr=0;Rr<Pt.length();Rr++){const cr=Pt.getSection(Rr);lr+=qD(Pt.getCharCode(Rr),cr,ar,bt,Bt,Gt)}return lr/Math.max(1,Math.ceil(lr/kt))}(be,We,Fe,Qe,mt,Ke),dt=be.text.indexOf("")>=0;let _t=0;for(let Pt=0;Pt<be.length();Pt++){const Bt=be.getSection(Pt),kt=be.getCharCode(Pt);if(rx[kt]||(_t+=qD(kt,Bt,Qe,mt,We,Ke)),Pt<be.length()-1){const ar=!((Je=kt)<11904||!(Ot["Bopomofo Extended"](Je)||Ot.Bopomofo(Je)||Ot["CJK Compatibility Forms"](Je)||Ot["CJK Compatibility Ideographs"](Je)||Ot["CJK Compatibility"](Je)||Ot["CJK Radicals Supplement"](Je)||Ot["CJK Strokes"](Je)||Ot["CJK Symbols and Punctuation"](Je)||Ot["CJK Unified Ideographs Extension A"](Je)||Ot["CJK Unified Ideographs"](Je)||Ot["Enclosed CJK Letters and Months"](Je)||Ot["Halfwidth and Fullwidth Forms"](Je)||Ot.Hiragana(Je)||Ot["Ideographic Description Characters"](Je)||Ot["Kangxi Radicals"](Je)||Ot["Katakana Phonetic Extensions"](Je)||Ot.Katakana(Je)||Ot["Vertical Forms"](Je)||Ot["Yi Radicals"](Je)||Ot["Yi Syllables"](Je)));(h7[kt]||ar||Bt.imageName)&&ot.push(KD(Pt+1,_t,st,ot,d7(kt,be.getCharCode(Pt+1),ar&&dt),!1))}}var Je;return ZD(KD(be.length(),_t,st,ot,0,!0))}(Q,C,v,i,d,q),{processBidirectionalText:xe,processStyledBidirectionalText:fe}=I;if(xe&&Q.sections.length===1){const be=xe(Q.toString(),de);for(const We of be){const Fe=new Cf;Fe.text=We,Fe.sections=Q.sections;for(let Qe=0;Qe<We.length;Qe++)Fe.sectionIndex.push(0);oe.push(Fe)}}else if(fe){const be=fe(Q.text,Q.sectionIndex,de);for(const We of be){const Fe=new Cf;Fe.text=We[0],Fe.sectionIndex=We[1],Fe.sections=Q.sections,oe.push(Fe)}}else oe=function(be,We){const Fe=[],Qe=be.text;let mt=0;for(const Ke of We)Fe.push(be.substring(mt,Ke)),mt=Ke;return mt<Qe.length&&Fe.push(be.substring(mt,Qe.length)),Fe}(Q,de);const _e=[],we={positionedLines:_e,text:Q.toString(),top:D[1],bottom:D[1],left:D[0],right:D[0],writingMode:$,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(be,We,Fe,Qe,mt,Ke,ot,st,dt,_t,Je,Pt){let Bt=0,kt=0,ar=0;const bt=st==="right"?1:st==="left"?0:.5;let Gt=!1;for(const ur of mt){const hr=ur.getSections();for(const Xr of hr){if(Xr.imageName)continue;const rn=We[Xr.fontStack];if(rn&&(Gt=rn.ascender!==void 0&&rn.descender!==void 0,!Gt))break}if(!Gt)break}let lr=0;for(const ur of mt){ur.trim();const hr=ur.getMaxScale(),Xr=(hr-1)*Ai,rn={positionedGlyphs:[],lineOffset:0};be.positionedLines[lr]=rn;const nn=rn.positionedGlyphs;let Yr=0;if(!ur.length()){kt+=Ke,++lr;continue}let xn=0,kn=0;for(let Jr=0;Jr<ur.length();Jr++){const ri=ur.getSection(Jr),Kn=ur.getSectionIndex(Jr),wn=ur.getCharCode(Jr);let jr=ri.scale,Zn=null,on=null,mo=null,Xn=Ai,Pi=0;const pi=!(dt===ms.horizontal||!Je&&!Cg(wn)||Je&&(rx[wn]||(Rr=wn,Ot.Arabic(Rr)||Ot["Arabic Supplement"](Rr)||Ot["Arabic Extended-A"](Rr)||Ot["Arabic Presentation Forms-A"](Rr)||Ot["Arabic Presentation Forms-B"](Rr))));if(ri.imageName){const go=Qe[ri.imageName];if(!go)continue;mo=ri.imageName,be.iconsInText=be.iconsInText||!0,on=go.paddedRect;const mi=go.displaySize;jr=jr*Ai/Pt,Zn={width:mi[0],height:mi[1],left:ko,top:-VD,advance:pi?mi[1]:mi[0],localGlyph:!1},Pi=Gt?-Zn.height*jr:WD+hr*Ai-mi[1]*jr,Xn=Zn.advance;const Sa=(pi?mi[0]:mi[1])*jr-Ai*hr;Sa>0&&Sa>Yr&&(Yr=Sa)}else{const go=Fe[ri.fontStack];if(!go)continue;go[wn]&&(on=go[wn]);const mi=We[ri.fontStack];if(!mi)continue;const Sa=mi.glyphs[wn];if(!Sa)continue;if(Zn=Sa.metrics,Xn=wn!==8203?Ai:0,Gt){const Lf=mi.ascender!==void 0?Math.abs(mi.ascender):0,hy=mi.descender!==void 0?Math.abs(mi.descender):0,dy=(Lf+hy)*jr;xn<dy&&(xn=dy,kn=(Lf-hy)/2*jr),Pi=-Lf*jr}else Pi=WD+(hr-jr)*Ai}pi?(be.verticalizable=!0,nn.push({glyph:wn,imageName:mo,x:Bt,y:kt+Pi,vertical:pi,scale:jr,localGlyph:Zn.localGlyph,fontStack:ri.fontStack,sectionIndex:Kn,metrics:Zn,rect:on}),Bt+=Xn*jr+_t):(nn.push({glyph:wn,imageName:mo,x:Bt,y:kt+Pi,vertical:pi,scale:jr,localGlyph:Zn.localGlyph,fontStack:ri.fontStack,sectionIndex:Kn,metrics:Zn,rect:on}),Bt+=Zn.advance*jr+_t)}nn.length!==0&&(ar=Math.max(Bt-_t,ar),Gt?XD(nn,bt,Yr,kn,Ke*hr/2):XD(nn,bt,Yr,0,Ke/2)),Bt=0;const Hn=Ke*hr+Yr;rn.lineOffset=Math.max(Yr,Xr),kt+=Hn,++lr}var Rr;const cr=kt,{horizontalAlign:Qt,verticalAlign:an}=WT(ot);(function(ur,hr,Xr,rn,nn,Yr){const xn=(hr-Xr)*nn,kn=-Yr*rn;for(const Hn of ur)for(const Jr of Hn.positionedGlyphs)Jr.x+=xn,Jr.y+=kn})(be.positionedLines,bt,Qt,an,ar,cr),be.top+=-an*cr,be.bottom=be.top+cr,be.left+=-Qt*ar,be.right=be.left+ar,be.hasBaseline=Gt}(we,i,c,d,oe,x,T,P,$,C,U,K),!function(be){for(const We of be)if(We.positionedGlyphs.length!==0)return!1;return!0}(_e)&&we}const rx={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},h7={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function qD(a,i,c,d,m,v){if(i.imageName){const x=d[i.imageName];return x?x.displaySize[0]*i.scale*Ai/v+m:0}{const x=c[i.fontStack],T=x&&x.glyphs[a];return T?T.metrics.advance*i.scale+m:0}}function HD(a,i,c,d){const m=Math.pow(a-i,2);return d?a<i?m/2:2*m:m+Math.abs(c)*c}function d7(a,i,c){let d=0;return a===10&&(d-=1e4),c&&(d+=150),a!==40&&a!==65288||(d+=50),i!==41&&i!==65289||(d+=50),d}function KD(a,i,c,d,m,v){let x=null,T=HD(i,c,m,v);for(const P of d){const C=HD(i-P.x,c,m,v)+P.badness;C<=T&&(x=P,T=C)}return{index:a,x:i,priorBreak:x,badness:T}}function ZD(a){return a?ZD(a.priorBreak).concat(a.index):[]}function WT(a){let i=.5,c=.5;switch(a){case"right":case"top-right":case"bottom-right":i=1;break;case"left":case"top-left":case"bottom-left":i=0}switch(a){case"bottom":case"bottom-right":case"bottom-left":c=1;break;case"top":case"top-right":case"top-left":c=0}return{horizontalAlign:i,verticalAlign:c}}function XD(a,i,c,d,m){if(!(i||c||d||m))return;const v=a.length-1,x=a[v],T=(x.x+x.metrics.advance*x.scale)*i;for(let P=0;P<=v;P++)a[P].x-=T,a[P].y+=c+d+m}function f7(a,i,c){const{horizontalAlign:d,verticalAlign:m}=WT(c),v=i[0]-a.displaySize[0]*d,x=i[1]-a.displaySize[1]*m;return{image:a,top:x,bottom:x+a.displaySize[1],left:v,right:v+a.displaySize[0]}}function YD(a,i,c,d,m,v){const x=a.image;let T;if(x.content){const oe=x.content,de=x.pixelRatio||1;T=[oe[0]/de,oe[1]/de,x.displaySize[0]-oe[2]/de,x.displaySize[1]-oe[3]/de]}const P=i.left*v,C=i.right*v;let D,$,U,q;c==="width"||c==="both"?(q=m[0]+P-d[3],$=m[0]+C+d[1]):(q=m[0]+(P+C-x.displaySize[0])/2,$=q+x.displaySize[0]);const K=i.top*v,Q=i.bottom*v;return c==="height"||c==="both"?(D=m[1]+K-d[0],U=m[1]+Q+d[2]):(D=m[1]+(K+Q-x.displaySize[1])/2,U=D+x.displaySize[1]),{image:x,top:D,right:$,bottom:U,left:q,collisionPadding:T}}class Hl extends ue{constructor(i,c,d,m,v){super(i,c),this.angle=m,this.z=d,v!==void 0&&(this.segment=v)}clone(){return new Hl(this.x,this.y,this.z,this.angle,this.segment)}}function JD(a,i,c,d,m){if(i.segment===void 0)return!0;let v=i,x=i.segment+1,T=0;for(;T>-c/2;){if(x--,x<0)return!1;T-=a[x].dist(v),v=a[x]}T+=a[x].dist(a[x+1]),x++;const P=[];let C=0;for(;T<c/2;){const D=a[x],$=a[x+1];if(!$)return!1;let U=a[x-1].angleTo(D)-D.angleTo($);for(U=Math.abs((U+3*Math.PI)%(2*Math.PI)-Math.PI),P.push({distance:T,angleDelta:U}),C+=U;T-P[0].distance>d;)C-=P.shift().angleDelta;if(C>m)return!1;x++,T+=D.dist($)}return!0}function QD(a){let i=0;for(let c=0;c<a.length-1;c++)i+=a[c].dist(a[c+1]);return i}function eL(a,i,c){return a?.6*i*c:0}function tL(a,i){return Math.max(a?a.right-a.left:0,i?i.right-i.left:0)}function p7(a,i,c,d,m,v){const x=eL(c,m,v),T=tL(c,d)*v;let P=0;const C=QD(a)/2;for(let D=0;D<a.length-1;D++){const $=a[D],U=a[D+1],q=$.dist(U);if(P+q>C){const K=(C-P)/q,Q=Or($.x,U.x,K),oe=Or($.y,U.y,K),de=new Hl(Q,oe,0,U.angleTo($),D);return!x||JD(a,de,T,x,i)?de:void 0}P+=q}}function m7(a,i,c,d,m,v,x,T,P){const C=eL(d,v,x),D=tL(d,m),$=D*x,U=a[0].x===0||a[0].x===P||a[0].y===0||a[0].y===P;return i-$<i/4&&(i=$+i/4),rL(a,U?i/2*T%i:(D/2+2*v)*x*T%i,i,C,c,$,U,!1,P)}function rL(a,i,c,d,m,v,x,T,P){const C=v/2,D=QD(a);let $=0,U=i-c,q=[];for(let K=0;K<a.length-1;K++){const Q=a[K],oe=a[K+1],de=Q.dist(oe),xe=oe.angleTo(Q);for(;U+c<$+de;){U+=c;const fe=(U-$)/de,_e=Or(Q.x,oe.x,fe),we=Or(Q.y,oe.y,fe);if(_e>=0&&_e<P&&we>=0&&we<P&&U-C>=0&&U+C<=D){const be=new Hl(_e,we,0,xe,K);be._round(),d&&!JD(a,be,v,d,m)||q.push(be)}}$+=de}return T||q.length||x||(q=rL(a,$/2,c,d,m,v,x,!0,P)),q}function nL(a,i,c,d,m){const v=[];for(let x=0;x<a.length;x++){const T=a[x];let P;for(let C=0;C<T.length-1;C++){let D=T[C],$=T[C+1];D.x<i&&$.x<i||(D.x<i?D=new ue(i,D.y+(i-D.x)/($.x-D.x)*($.y-D.y))._round():$.x<i&&($=new ue(i,D.y+(i-D.x)/($.x-D.x)*($.y-D.y))._round()),D.y<c&&$.y<c||(D.y<c?D=new ue(D.x+(c-D.y)/($.y-D.y)*($.x-D.x),c)._round():$.y<c&&($=new ue(D.x+(c-D.y)/($.y-D.y)*($.x-D.x),c)._round()),D.x>=d&&$.x>=d||(D.x>=d?D=new ue(d,D.y+(d-D.x)/($.x-D.x)*($.y-D.y))._round():$.x>=d&&($=new ue(d,D.y+(d-D.x)/($.x-D.x)*($.y-D.y))._round()),D.y>=m&&$.y>=m||(D.y>=m?D=new ue(D.x+(m-D.y)/($.y-D.y)*($.x-D.x),m)._round():$.y>=m&&($=new ue(D.x+(m-D.y)/($.y-D.y)*($.x-D.x),m)._round()),P&&D.equals(P[P.length-1])||(P=[D],v.push(P)),P.push($)))))}}return v}jt(Hl,"Anchor");const ry=1e20;function iL(a,i,c,d,m,v,x,T,P){for(let C=i;C<i+d;C++)oL(a,c*v+C,v,m,x,T,P);for(let C=c;C<c+m;C++)oL(a,C*v+i,1,d,x,T,P)}function oL(a,i,c,d,m,v,x){v[0]=0,x[0]=-ry,x[1]=ry,m[0]=a[i];for(let T=1,P=0,C=0;T<d;T++){m[T]=a[i+T*c];const D=T*T;do{const $=v[P];C=(m[T]-m[$]+D-$*$)/(T-$)/2}while(C<=x[P]&&--P>-1);P++,v[P]=T,x[P]=C,x[P+1]=ry}for(let T=0,P=0;T<d;T++){for(;x[P+1]<T;)P++;const C=v[P],D=T-C;a[i+T*c]=m[C]+D*D}}const ba=2,qT={none:0,ideographs:1,all:2};class kf{constructor(i,c,d){this.requestManager=i,this.localGlyphMode=c,this.localFontFamily=d,this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(i){this.url=i}getGlyphs(i,c){const d=[];for(const m in i)for(const v of i[m])d.push({stack:m,id:v});at(d,({stack:m,id:v},x)=>{let T=this.entries[m];T||(T=this.entries[m]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let P=T.glyphs[v];if(P!==void 0)return void x(null,{stack:m,id:v,glyph:P});if(P=this._tinySDF(T,m,v),P)return T.glyphs[v]=P,void x(null,{stack:m,id:v,glyph:P});const C=Math.floor(v/256);if(256*C>65535)return void x(new Error("glyphs > 65535 not supported"));if(T.ranges[C])return void x(null,{stack:m,id:v,glyph:P});let D=T.requests[C];D||(D=T.requests[C]=[],kf.loadGlyphRange(m,C,this.url,this.requestManager,($,U)=>{if(U){T.ascender=U.ascender,T.descender=U.descender;for(const q in U.glyphs)this._doesCharSupportLocalGlyph(+q)||(T.glyphs[+q]=U.glyphs[+q]);T.ranges[C]=!0}for(const q of D)q($,U);delete T.requests[C]})),D.push(($,U)=>{$?x($):U&&x(null,{stack:m,id:v,glyph:U.glyphs[v]||null})})},(m,v)=>{if(m)c(m);else if(v){const x={};for(const{stack:T,id:P,glyph:C}of v)x[T]===void 0&&(x[T]={}),x[T].glyphs===void 0&&(x[T].glyphs={}),x[T].glyphs[P]=C&&{id:C.id,bitmap:C.bitmap.clone(),metrics:C.metrics},x[T].ascender=this.entries[T].ascender,x[T].descender=this.entries[T].descender;c(null,x)}})}_doesCharSupportLocalGlyph(i){return this.localGlyphMode!==qT.none&&(this.localGlyphMode===qT.all?!!this.localFontFamily:!!this.localFontFamily&&(Ot["CJK Unified Ideographs"](i)||Ot["Hangul Syllables"](i)||Ot.Hiragana(i)||Ot.Katakana(i)||Ot["CJK Symbols and Punctuation"](i)))}_tinySDF(i,c,d){const m=this.localFontFamily;if(!m||!this._doesCharSupportLocalGlyph(d))return;let v=i.tinySDF;if(!v){let Q="400";/bold/i.test(c)?Q="900":/medium/i.test(c)?Q="500":/light/i.test(c)&&(Q="200"),v=i.tinySDF=new kf.TinySDF({fontFamily:m,fontWeight:Q,fontSize:24*ba,buffer:3*ba,radius:8*ba}),v.fontWeight=Q}if(this.localGlyphs[v.fontWeight][d])return this.localGlyphs[v.fontWeight][d];const x=String.fromCharCode(d),{data:T,width:P,height:C,glyphWidth:D,glyphHeight:$,glyphLeft:U,glyphTop:q,glyphAdvance:K}=v.draw(x);return this.localGlyphs[v.fontWeight][d]={id:d,bitmap:new Wl({width:P,height:C},T),metrics:{width:D/ba,height:$/ba,left:U/ba,top:q/ba-27,advance:K/ba,localGlyph:!0}}}}kf.loadGlyphRange=function(a,i,c,d,m){const v=256*i,x=v+255,T=d.transformRequest(d.normalizeGlyphsURL(c).replace("{fontstack}",a).replace("{range}",`${v}-${x}`),Ms.Glyphs);cs(T,(P,C)=>{if(P)m(P);else if(C){const D={},$=function(U){return new tx(U).readFields(l7,{})}(C);for(const U of $.glyphs)D[U.id]=U;m(null,{glyphs:D,ascender:$.ascender,descender:$.descender})}})},kf.TinySDF=class{constructor({fontSize:a=24,buffer:i=3,radius:c=8,cutoff:d=.25,fontFamily:m="sans-serif",fontWeight:v="normal",fontStyle:x="normal"}={}){this.buffer=i,this.cutoff=d,this.radius=c;const T=this.size=a+4*i,P=this._createCanvas(T),C=this.ctx=P.getContext("2d",{willReadFrequently:!0});C.font=`${x} ${v} ${a}px ${m}`,C.textBaseline="alphabetic",C.textAlign="left",C.fillStyle="black",this.gridOuter=new Float64Array(T*T),this.gridInner=new Float64Array(T*T),this.f=new Float64Array(T),this.z=new Float64Array(T+1),this.v=new Uint16Array(T)}_createCanvas(a){const i=document.createElement("canvas");return i.width=i.height=a,i}draw(a){const{width:i,actualBoundingBoxAscent:c,actualBoundingBoxDescent:d,actualBoundingBoxLeft:m,actualBoundingBoxRight:v}=this.ctx.measureText(a),x=Math.ceil(c),T=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(v-m))),P=Math.min(this.size-this.buffer,x+Math.ceil(d)),C=T+2*this.buffer,D=P+2*this.buffer,$=Math.max(C*D,0),U=new Uint8ClampedArray($),q={data:U,width:C,height:D,glyphWidth:T,glyphHeight:P,glyphTop:x,glyphLeft:0,glyphAdvance:i};if(T===0||P===0)return q;const{ctx:K,buffer:Q,gridInner:oe,gridOuter:de}=this;K.clearRect(Q,Q,T,P),K.fillText(a,Q,Q+x);const xe=K.getImageData(Q,Q,T,P);de.fill(ry,0,$),oe.fill(0,0,$);for(let fe=0;fe<P;fe++)for(let _e=0;_e<T;_e++){const we=xe.data[4*(fe*T+_e)+3]/255;if(we===0)continue;const be=(fe+Q)*C+_e+Q;if(we===1)de[be]=0,oe[be]=ry;else{const We=.5-we;de[be]=We>0?We*We:0,oe[be]=We<0?We*We:0}}iL(de,0,0,C,D,C,this.f,this.v,this.z),iL(oe,Q,Q,T,P,C,this.f,this.v,this.z);for(let fe=0;fe<$;fe++){const _e=Math.sqrt(de[fe])-Math.sqrt(oe[fe]);U[fe]=Math.round(255-255*(_e/this.radius+this.cutoff))}return q}};const Of=ko;function sL(a,i,c,d){const m=[],v=a.image,x=v.pixelRatio,T=v.paddedRect.w-2*Of,P=v.paddedRect.h-2*Of,C=a.right-a.left,D=a.bottom-a.top,$=v.stretchX||[[0,T]],U=v.stretchY||[[0,P]],q=(Ke,ot)=>Ke+ot[1]-ot[0],K=$.reduce(q,0),Q=U.reduce(q,0),oe=T-K,de=P-Q;let xe=0,fe=K,_e=0,we=Q,be=0,We=oe,Fe=0,Qe=de;if(v.content&&d){const Ke=v.content;xe=nx($,0,Ke[0]),_e=nx(U,0,Ke[1]),fe=nx($,Ke[0],Ke[2]),we=nx(U,Ke[1],Ke[3]),be=Ke[0]-xe,Fe=Ke[1]-_e,We=Ke[2]-Ke[0]-fe,Qe=Ke[3]-Ke[1]-we}const mt=(Ke,ot,st,dt)=>{const _t=ix(Ke.stretch-xe,fe,C,a.left),Je=ox(Ke.fixed-be,We,Ke.stretch,K),Pt=ix(ot.stretch-_e,we,D,a.top),Bt=ox(ot.fixed-Fe,Qe,ot.stretch,Q),kt=ix(st.stretch-xe,fe,C,a.left),ar=ox(st.fixed-be,We,st.stretch,K),bt=ix(dt.stretch-_e,we,D,a.top),Gt=ox(dt.fixed-Fe,Qe,dt.stretch,Q),lr=new ue(_t,Pt),Rr=new ue(kt,Pt),cr=new ue(kt,bt),Qt=new ue(_t,bt),an=new ue(Je/x,Bt/x),ur=new ue(ar/x,Gt/x),hr=i*Math.PI/180;if(hr){const nn=Math.sin(hr),Yr=Math.cos(hr),xn=[Yr,-nn,nn,Yr];lr._matMult(xn),Rr._matMult(xn),Qt._matMult(xn),cr._matMult(xn)}const Xr=Ke.stretch+Ke.fixed,rn=ot.stretch+ot.fixed;return{tl:lr,tr:Rr,bl:Qt,br:cr,tex:{x:v.paddedRect.x+Of+Xr,y:v.paddedRect.y+Of+rn,w:st.stretch+st.fixed-Xr,h:dt.stretch+dt.fixed-rn},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:an,pixelOffsetBR:ur,minFontScaleX:We/x/C,minFontScaleY:Qe/x/D,isSDF:c}};if(d&&(v.stretchX||v.stretchY)){const Ke=aL($,oe,K),ot=aL(U,de,Q);for(let st=0;st<Ke.length-1;st++){const dt=Ke[st],_t=Ke[st+1];for(let Je=0;Je<ot.length-1;Je++)m.push(mt(dt,ot[Je],_t,ot[Je+1]))}}else m.push(mt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:T+1},{fixed:0,stretch:P+1}));return m}function nx(a,i,c){let d=0;for(const m of a)d+=Math.max(i,Math.min(c,m[1]))-Math.max(i,Math.min(c,m[0]));return d}function aL(a,i,c){const d=[{fixed:-Of,stretch:0}];for(const[m,v]of a){const x=d[d.length-1];d.push({fixed:m-x.stretch,stretch:x.stretch}),d.push({fixed:m-x.stretch,stretch:x.stretch+(v-m)})}return d.push({fixed:i+Of,stretch:c}),d}function ix(a,i,c,d){return a/i*c+d}function ox(a,i,c,d){return a-i*c/d}function g7(a,i,c,d){const m=i+a.positionedLines[d].lineOffset;return d===0?c+m/2:c+(m+(i+a.positionedLines[d-1].lineOffset))/2}class y7{constructor(i=[],c=v7){if(this.data=i,this.length=this.data.length,this.compare=c,this.length>0)for(let d=(this.length>>1)-1;d>=0;d--)this._down(d)}push(i){this.data.push(i),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const i=this.data[0],c=this.data.pop();return this.length--,this.length>0&&(this.data[0]=c,this._down(0)),i}peek(){return this.data[0]}_up(i){const{data:c,compare:d}=this,m=c[i];for(;i>0;){const v=i-1>>1,x=c[v];if(d(m,x)>=0)break;c[i]=x,i=v}c[i]=m}_down(i){const{data:c,compare:d}=this,m=this.length>>1,v=c[i];for(;i<m;){let x=1+(i<<1),T=c[x];const P=x+1;if(P<this.length&&d(c[P],T)<0&&(x=P,T=c[P]),d(T,v)>=0)break;c[i]=T,i=x}c[i]=v}}function v7(a,i){return a<i?-1:a>i?1:0}function _7(a,i=1,c=!1){let d=1/0,m=1/0,v=-1/0,x=-1/0;const T=a[0];for(let q=0;q<T.length;q++){const K=T[q];(!q||K.x<d)&&(d=K.x),(!q||K.y<m)&&(m=K.y),(!q||K.x>v)&&(v=K.x),(!q||K.y>x)&&(x=K.y)}const P=Math.min(v-d,x-m);let C=P/2;const D=new y7([],x7);if(P===0)return new ue(d,m);for(let q=d;q<v;q+=P)for(let K=m;K<x;K+=P)D.push(new Mf(q+C,K+C,C,a));let $=function(q){let K=0,Q=0,oe=0;const de=q[0];for(let xe=0,fe=de.length,_e=fe-1;xe<fe;_e=xe++){const we=de[xe],be=de[_e],We=we.x*be.y-be.x*we.y;Q+=(we.x+be.x)*We,oe+=(we.y+be.y)*We,K+=3*We}return new Mf(Q/K,oe/K,0,q)}(a),U=D.length;for(;D.length;){const q=D.pop();(q.d>$.d||!$.d)&&($=q,c&&console.log("found best %d after %d probes",Math.round(1e4*q.d)/1e4,U)),q.max-$.d<=i||(C=q.h/2,D.push(new Mf(q.p.x-C,q.p.y-C,C,a)),D.push(new Mf(q.p.x+C,q.p.y-C,C,a)),D.push(new Mf(q.p.x-C,q.p.y+C,C,a)),D.push(new Mf(q.p.x+C,q.p.y+C,C,a)),U+=4)}return c&&(console.log(`num probes: ${U}`),console.log(`best distance: ${$.d}`)),$.p}function x7(a,i){return i.max-a.max}class Mf{constructor(i,c,d,m){this.p=new ue(i,c),this.h=d,this.d=function(v,x){let T=!1,P=1/0;for(let C=0;C<x.length;C++){const D=x[C];for(let $=0,U=D.length,q=U-1;$<U;q=$++){const K=D[$],Q=D[q];K.y>v.y!=Q.y>v.y&&v.x<(Q.x-K.x)*(v.y-K.y)/(Q.y-K.y)+K.x&&(T=!T),P=Math.min(P,rD(v,K,Q))}}return(T?1:-1)*Math.sqrt(P)}(this.p,m),this.max=this.d+this.h*Math.SQRT2}}const If=7,HT=Number.POSITIVE_INFINITY,b7=Math.sqrt(2);function lL(a,[i,c]){let d=0,m=0;if(c===HT){i<0&&(i=0);const v=i/b7;switch(a){case"top-right":case"top-left":m=v-If;break;case"bottom-right":case"bottom-left":m=-v+If;break;case"bottom":m=-i+If;break;case"top":m=i-If}switch(a){case"top-right":case"bottom-right":d=-v;break;case"top-left":case"bottom-left":d=v;break;case"left":d=i;break;case"right":d=-i}}else{switch(i=Math.abs(i),c=Math.abs(c),a){case"top-right":case"top-left":case"top":m=c-If;break;case"bottom-right":case"bottom-left":case"bottom":m=-c+If}switch(a){case"top-right":case"bottom-right":case"right":d=-i;break;case"top-left":case"bottom-left":case"left":d=i}}return[d,m]}function w7(a,i,c,d,m,v,x,T,P,C){a.createArrays(),a.tilePixelRatio=Zt/(512*a.overscaling),a.compareText={},a.iconsNeedLinear=!1;const D=a.layers[0].layout,$=a.layers[0]._unevaluatedLayout._values,U={};if(a.textSizeData.kind==="composite"){const{minZoom:Q,maxZoom:oe}=a.textSizeData;U.compositeTextSizes=[$["text-size"].possiblyEvaluate(new N(Q),T),$["text-size"].possiblyEvaluate(new N(oe),T)]}if(a.iconSizeData.kind==="composite"){const{minZoom:Q,maxZoom:oe}=a.iconSizeData;U.compositeIconSizes=[$["icon-size"].possiblyEvaluate(new N(Q),T),$["icon-size"].possiblyEvaluate(new N(oe),T)]}U.layoutTextSize=$["text-size"].possiblyEvaluate(new N(P+1),T),U.layoutIconSize=$["icon-size"].possiblyEvaluate(new N(P+1),T),U.textMaxSize=$["text-size"].possiblyEvaluate(new N(18),T);const q=D.get("text-rotation-alignment")==="map"&&D.get("symbol-placement")!=="point",K=D.get("text-size");for(const Q of a.features){const oe=D.get("text-font").evaluate(Q,{},T).join(","),de=K.evaluate(Q,{},T),xe=U.layoutTextSize.evaluate(Q,{},T),fe=(U.layoutIconSize.evaluate(Q,{},T),{horizontal:{},vertical:void 0}),_e=Q.text;let we,be=[0,0];if(_e){const Qe=_e.toString(),mt=D.get("text-letter-spacing").evaluate(Q,{},T)*Ai,Ke=D.get("text-line-height").evaluate(Q,{},T)*Ai,ot=rT(Qe)?mt:0,st=D.get("text-anchor").evaluate(Q,{},T),dt=D.get("text-variable-anchor");if(!dt){const kt=D.get("text-radial-offset").evaluate(Q,{},T);be=kt?lL(st,[kt*Ai,HT]):D.get("text-offset").evaluate(Q,{},T).map(ar=>ar*Ai)}let _t=q?"center":D.get("text-justify").evaluate(Q,{},T);const Je=D.get("symbol-placement")==="point",Pt=Je?D.get("text-max-width").evaluate(Q,{},T)*Ai:1/0,Bt=kt=>{a.allowVerticalPlacement&&Pg(Qe)&&(fe.vertical=GT(_e,i,c,m,oe,Pt,Ke,st,kt,ot,be,ms.vertical,!0,xe,de))};if(!q&&dt){const kt=_t==="auto"?dt.map(bt=>KT(bt)):[_t];let ar=!1;for(let bt=0;bt<kt.length;bt++){const Gt=kt[bt];if(!fe.horizontal[Gt])if(ar)fe.horizontal[Gt]=fe.horizontal[0];else{const lr=GT(_e,i,c,m,oe,Pt,Ke,"center",Gt,ot,be,ms.horizontal,!1,xe,de);lr&&(fe.horizontal[Gt]=lr,ar=lr.positionedLines.length===1)}}Bt("left")}else{if(_t==="auto"&&(_t=KT(st)),Je||D.get("text-writing-mode").indexOf("horizontal")>=0||!Pg(Qe)){const kt=GT(_e,i,c,m,oe,Pt,Ke,st,_t,ot,be,ms.horizontal,!1,xe,de);kt&&(fe.horizontal[_t]=kt)}Bt(Je?"left":_t)}}let We=!1;if(Q.icon&&Q.icon.name){const Qe=d[Q.icon.name];Qe&&(we=f7(m[Q.icon.name],D.get("icon-offset").evaluate(Q,{},T),D.get("icon-anchor").evaluate(Q,{},T)),We=Qe.sdf,a.sdfIcons===void 0?a.sdfIcons=Qe.sdf:a.sdfIcons!==Qe.sdf&&Et("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Qe.pixelRatio!==a.pixelRatio||D.get("icon-rotate").constantOr(1)!==0)&&(a.iconsNeedLinear=!0))}const Fe=uL(fe.horizontal)||fe.vertical;a.iconsInText||(a.iconsInText=!!Fe&&Fe.iconsInText),(Fe||we)&&S7(a,Q,fe,we,d,U,xe,0,be,We,x,T,C)}v&&a.generateCollisionDebugBuffers(P,a.collisionBoxArray)}function KT(a){switch(a){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function S7(a,i,c,d,m,v,x,T,P,C,D,$,U){let q=v.textMaxSize.evaluate(i,{},$);q===void 0&&(q=x);const K=a.layers[0].layout,Q=K.get("icon-offset").evaluate(i,{},$),oe=uL(c.horizontal)||c.vertical,de=U.name==="globe",xe=Ai,fe=x/xe,_e=a.tilePixelRatio*q/xe,we=(st=a.overscaling,a.zoom>18&&st>2&&(st>>=1),Math.max(Zt/(512*st),1)*K.get("symbol-spacing")),be=K.get("text-padding")*a.tilePixelRatio,We=K.get("icon-padding")*a.tilePixelRatio,Fe=je(K.get("text-max-angle")),Qe=K.get("text-rotation-alignment")==="map"&&K.get("symbol-placement")!=="point",mt=K.get("icon-rotation-alignment")==="map"&&K.get("symbol-placement")!=="point",Ke=K.get("symbol-placement"),ot=we/2;var st;const dt=K.get("icon-text-fit");let _t;d&&dt!=="none"&&(a.allowVerticalPlacement&&c.vertical&&(_t=YD(d,c.vertical,dt,K.get("icon-text-fit-padding"),Q,fe)),oe&&(d=YD(d,oe,dt,K.get("icon-text-fit-padding"),Q,fe)));const Je=(Pt,Bt,kt)=>{if(Bt.x<0||Bt.x>=Zt||Bt.y<0||Bt.y>=Zt)return;let ar=null;if(de){const{x:bt,y:Gt,z:lr}=U.projectTilePoint(Bt.x,Bt.y,kt);ar={anchor:new Hl(bt,Gt,lr,0,void 0),up:U.upVector(kt,Bt.x,Bt.y)}}(function(bt,Gt,lr,Rr,cr,Qt,an,ur,hr,Xr,rn,nn,Yr,xn,kn,Hn,Jr,ri,Kn,wn,jr,Zn,on,mo,Xn){const Pi=bt.addToLineVertexArray(Gt,Rr);let pi,go,mi,Sa,Lf,hy,dy,VL=0,GL=0,WL=0,qL=0,cE=-1,uE=-1;const ul={};let HL=oT("");const Rh=lr?lr.anchor:Gt;let hE=0,dE=0;if(hr._unevaluatedLayout.getValue("text-radial-offset")===void 0?[hE,dE]=hr.layout.get("text-offset").evaluate(jr,{},Xn).map(Ko=>Ko*Ai):(hE=hr.layout.get("text-radial-offset").evaluate(jr,{},Xn)*Ai,dE=HT),bt.allowVerticalPlacement&&cr.vertical){const Ko=cr.vertical;if(kn)hy=ZT(Ko),ur&&(dy=ZT(ur));else{const Zo=hr.layout.get("text-rotate").evaluate(jr,{},Xn)+90;mi=sx(Xr,Rh,Gt,rn,nn,Yr,Ko,xn,Zo,Hn),ur&&(Sa=sx(Xr,Rh,Gt,rn,nn,Yr,ur,ri,Zo))}}if(Qt){const Ko=hr.layout.get("icon-rotate").evaluate(jr,{},Xn),Zo=hr.layout.get("icon-text-fit")!=="none",fy=sL(Qt,Ko,on,Zo),pE=ur?sL(ur,Ko,on,Zo):void 0;go=sx(Xr,Rh,Gt,rn,nn,Yr,Qt,ri,Ko),VL=4*fy.length;const KL=bt.iconSizeData;let Dh=null;KL.kind==="source"?(Dh=[xa*hr.layout.get("icon-size").evaluate(jr,{},Xn)],Dh[0]>Zc&&Et(`${bt.layerIds[0]}: Value for "icon-size" is >= ${ny}. Reduce your "icon-size".`)):KL.kind==="composite"&&(Dh=[xa*Zn.compositeIconSizes[0].evaluate(jr,{},Xn),xa*Zn.compositeIconSizes[1].evaluate(jr,{},Xn)],(Dh[0]>Zc||Dh[1]>Zc)&&Et(`${bt.layerIds[0]}: Value for "icon-size" is >= ${ny}. Reduce your "icon-size".`)),bt.addSymbols(bt.icon,fy,Dh,wn,Kn,jr,!1,lr,Gt,Pi.lineStartIndex,Pi.lineLength,-1,mo,Xn),cE=bt.icon.placedSymbolArray.length-1,pE&&(GL=4*pE.length,bt.addSymbols(bt.icon,pE,Dh,wn,Kn,jr,ms.vertical,lr,Gt,Pi.lineStartIndex,Pi.lineLength,-1,mo,Xn),uE=bt.icon.placedSymbolArray.length-1)}for(const Ko in cr.horizontal){const Zo=cr.horizontal[Ko];pi||(HL=oT(Zo.text),kn?Lf=ZT(Zo):pi=sx(Xr,Rh,Gt,rn,nn,Yr,Zo,xn,hr.layout.get("text-rotate").evaluate(jr,{},Xn),Hn));const fy=Zo.positionedLines.length===1;if(WL+=cL(bt,lr,Gt,Zo,an,hr,kn,jr,Hn,Pi,cr.vertical?ms.horizontal:ms.horizontalOnly,fy?Object.keys(cr.horizontal):[Ko],ul,cE,Zn,mo,Xn),fy)break}cr.vertical&&(qL+=cL(bt,lr,Gt,cr.vertical,an,hr,kn,jr,Hn,Pi,ms.vertical,["vertical"],ul,uE,Zn,mo,Xn));let tu=-1;const fE=(Ko,Zo)=>Ko?Math.max(Ko,Zo):Zo;tu=fE(Lf,tu),tu=fE(hy,tu),tu=fE(dy,tu);const Y7=tu>-1?1:0;bt.glyphOffsetArray.length>=Yc.MAX_GLYPHS&&Et("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),jr.sortKey!==void 0&&bt.addToSortKeyRanges(bt.symbolInstances.length,jr.sortKey),bt.symbolInstances.emplaceBack(Rh.x,Rh.y,Rh.z,Gt.x,Gt.y,ul.right>=0?ul.right:-1,ul.center>=0?ul.center:-1,ul.left>=0?ul.left:-1,ul.vertical>=0?ul.vertical:-1,cE,uE,HL,pi!==void 0?pi:bt.collisionBoxArray.length,pi!==void 0?pi+1:bt.collisionBoxArray.length,mi!==void 0?mi:bt.collisionBoxArray.length,mi!==void 0?mi+1:bt.collisionBoxArray.length,go!==void 0?go:bt.collisionBoxArray.length,go!==void 0?go+1:bt.collisionBoxArray.length,Sa||bt.collisionBoxArray.length,Sa?Sa+1:bt.collisionBoxArray.length,rn,WL,qL,VL,GL,Y7,0,hE,dE,tu)})(a,Bt,ar,Pt,c,d,m,_t,a.layers[0],a.collisionBoxArray,i.index,i.sourceLayerIndex,a.index,be,Qe,P,0,We,mt,Q,i,v,C,D,$)};if(Ke==="line")for(const Pt of nL(i.geometry,0,0,Zt,Zt)){const Bt=m7(Pt,we,Fe,c.vertical||oe,d,xe,_e,a.overscaling,Zt);for(const kt of Bt)oe&&T7(a,oe.text,ot,kt)||Je(Pt,kt,$)}else if(Ke==="line-center"){for(const Pt of i.geometry)if(Pt.length>1){const Bt=p7(Pt,Fe,c.vertical||oe,d,xe,_e);Bt&&Je(Pt,Bt,$)}}else if(i.type==="Polygon")for(const Pt of LT(i.geometry,0)){const Bt=_7(Pt,16);Je(Pt[0],new Hl(Bt.x,Bt.y,0,0,void 0),$)}else if(i.type==="LineString")for(const Pt of i.geometry)Je(Pt,new Hl(Pt[0].x,Pt[0].y,0,0,void 0),$);else if(i.type==="Point")for(const Pt of i.geometry)for(const Bt of Pt)Je([Bt],new Hl(Bt.x,Bt.y,0,0,void 0),$)}const ny=255,Zc=ny*xa;function cL(a,i,c,d,m,v,x,T,P,C,D,$,U,q,K,Q,oe){const de=function(_e,we,be,We,Fe,Qe,mt,Ke){const ot=[];if(we.positionedLines.length===0)return ot;const st=We.layout.get("text-rotate").evaluate(Qe,{})*Math.PI/180,dt=function(kt){const ar=kt[0],bt=kt[1],Gt=ar*bt;return Gt>0?[ar,-bt]:Gt<0?[-ar,bt]:ar===0?[bt,ar]:[bt,-ar]}(be);let _t=Math.abs(we.top-we.bottom);for(const kt of we.positionedLines)_t-=kt.lineOffset;const Je=we.positionedLines.length,Pt=_t/Je;let Bt=we.top-be[1];for(let kt=0;kt<Je;++kt){const ar=we.positionedLines[kt];Bt=g7(we,Pt,Bt,kt);for(const bt of ar.positionedGlyphs){if(!bt.rect)continue;const Gt=bt.rect||{};let lr=VD+1,Rr=!0,cr=1,Qt=0;if(bt.imageName){const on=mt[bt.imageName];if(!on)continue;if(on.sdf){Et("SDF images are not supported in formatted text and will be ignored.");continue}Rr=!1,cr=on.pixelRatio,lr=ko/cr}const an=(Fe||Ke)&&bt.vertical,ur=bt.metrics.advance*bt.scale/2,hr=bt.metrics,Xr=bt.rect;if(Xr===null)continue;Ke&&we.verticalizable&&(Qt=bt.imageName?ur-bt.metrics.width*bt.scale/2:0);const rn=Fe?[bt.x+ur,bt.y]:[0,0];let nn=[0,0],Yr=[0,0],xn=!1;Fe||(an?(Yr=[bt.x+ur+dt[0],bt.y+dt[1]-Qt],xn=!0):nn=[bt.x+ur+be[0],bt.y+be[1]-Qt]);const kn=Xr.w*bt.scale/(cr*(bt.localGlyph?ba:1)),Hn=Xr.h*bt.scale/(cr*(bt.localGlyph?ba:1));let Jr,ri,Kn,wn;if(an){const on=bt.y-Bt,mo=new ue(-ur,ur-on),Xn=-Math.PI/2,Pi=new ue(...Yr);Jr=new ue(-ur+nn[0],nn[1]),Jr._rotateAround(Xn,mo)._add(Pi),Jr.x+=-on+ur,Jr.y-=(hr.left-lr)*bt.scale;const pi=bt.imageName?hr.advance*bt.scale:Ai*bt.scale,go=String.fromCharCode(bt.glyph);Y9(go)?Jr.x+=(1-lr)*bt.scale:J9(go)?Jr.x+=pi-hr.height*bt.scale+(-lr-1)*bt.scale:Jr.x+=bt.imageName||hr.width+2*lr===Xr.w&&hr.height+2*lr===Xr.h?(pi-Hn)/2:(pi-(hr.height+2*lr)*bt.scale)/2,ri=new ue(Jr.x,Jr.y-kn),Kn=new ue(Jr.x+Hn,Jr.y),wn=new ue(Jr.x+Hn,Jr.y-kn)}else{const on=(hr.left-lr)*bt.scale-ur+nn[0],mo=(-hr.top-lr)*bt.scale+nn[1],Xn=on+kn,Pi=mo+Hn;Jr=new ue(on,mo),ri=new ue(Xn,mo),Kn=new ue(on,Pi),wn=new ue(Xn,Pi)}if(st){let on;on=Fe?new ue(0,0):xn?new ue(dt[0],dt[1]):new ue(be[0],be[1]),Jr._rotateAround(st,on),ri._rotateAround(st,on),Kn._rotateAround(st,on),wn._rotateAround(st,on)}const jr=new ue(0,0),Zn=new ue(0,0);ot.push({tl:Jr,tr:ri,bl:Kn,br:wn,tex:Gt,writingMode:we.writingMode,glyphOffset:rn,sectionIndex:bt.sectionIndex,isSDF:Rr,pixelOffsetTL:jr,pixelOffsetBR:Zn,minFontScaleX:0,minFontScaleY:0})}}return ot}(0,d,P,v,x,T,m,a.allowVerticalPlacement),xe=a.textSizeData;let fe=null;xe.kind==="source"?(fe=[xa*v.layout.get("text-size").evaluate(T,{},oe)],fe[0]>Zc&&Et(`${a.layerIds[0]}: Value for "text-size" is >= ${ny}. Reduce your "text-size".`)):xe.kind==="composite"&&(fe=[xa*K.compositeTextSizes[0].evaluate(T,{},oe),xa*K.compositeTextSizes[1].evaluate(T,{},oe)],(fe[0]>Zc||fe[1]>Zc)&&Et(`${a.layerIds[0]}: Value for "text-size" is >= ${ny}. Reduce your "text-size".`)),a.addSymbols(a.text,de,fe,P,x,T,D,i,c,C.lineStartIndex,C.lineLength,q,Q,oe);for(const _e of $)U[_e]=a.text.placedSymbolArray.length-1;return 4*de.length}function uL(a){for(const i in a)return a[i];return null}function sx(a,i,c,d,m,v,x,T,P,C){let D=x.top,$=x.bottom,U=x.left,q=x.right;const K=x.collisionPadding;if(K&&(U-=K[0],D-=K[1],q+=K[2],$+=K[3]),P){const Q=new ue(U,D),oe=new ue(q,D),de=new ue(U,$),xe=new ue(q,$),fe=je(P);let _e=new ue(0,0);C&&(_e=new ue(C[0],C[1])),Q._rotateAround(fe,_e),oe._rotateAround(fe,_e),de._rotateAround(fe,_e),xe._rotateAround(fe,_e),U=Math.min(Q.x,oe.x,de.x,xe.x),q=Math.max(Q.x,oe.x,de.x,xe.x),D=Math.min(Q.y,oe.y,de.y,xe.y),$=Math.max(Q.y,oe.y,de.y,xe.y)}return a.emplaceBack(i.x,i.y,i.z,c.x,c.y,U,D,q,$,T,d,m,v),a.length-1}function ZT(a){a.collisionPadding&&(a.top-=a.collisionPadding[1],a.bottom+=a.collisionPadding[3]);const i=a.bottom-a.top;return i>0?Math.max(10,i):null}function T7(a,i,c,d){const m=a.compareText;if(i in m){const v=m[i];for(let x=v.length-1;x>=0;x--)if(d.dist(v[x])<c)return!0}else m[i]=[];return m[i].push(d),!1}function hL(a,i){const c=a.fovAboveCenter,d=a.elevation?a.elevation.getMinElevationBelowMSL()*i:0,m=(a._camera.position[2]*a.worldSize-d)/Math.cos(a._pitch),v=Math.sin(c)*m/Math.sin(Math.max(Math.PI/2-a._pitch-c,.01)),x=Math.sin(a._pitch)*v+m;return Math.min(1.01*x,m*(1/a._horizonShift))}function Mh(a,i){if(!i.isReprojectedInTileSpace)return{scale:1<<a.z,x:a.x,y:a.y,x2:a.x+1,y2:a.y+1,projection:i};const c=Math.pow(2,-a.z),d=a.x*c,m=(a.x+1)*c,v=a.y*c,x=(a.y+1)*c,T=ps(d),P=ps(m),C=Ui(v),D=Ui(x),$=i.project(T,C),U=i.project(P,C),q=i.project(P,D),K=i.project(T,D);let Q=Math.min($.x,U.x,q.x,K.x),oe=Math.min($.y,U.y,q.y,K.y),de=Math.max($.x,U.x,q.x,K.x),xe=Math.max($.y,U.y,q.y,K.y);const fe=c/16;function _e(be,We,Fe,Qe,mt,Ke){const ot=(Fe+mt)/2,st=(Qe+Ke)/2,dt=i.project(ps(ot),Ui(st)),_t=Math.max(0,Q-dt.x,oe-dt.y,dt.x-de,dt.y-xe);Q=Math.min(Q,dt.x),de=Math.max(de,dt.x),oe=Math.min(oe,dt.y),xe=Math.max(xe,dt.y),_t>fe&&(_e(be,dt,Fe,Qe,ot,st),_e(dt,We,ot,st,mt,Ke))}_e($,U,d,v,m,v),_e(U,q,m,v,m,x),_e(q,K,m,x,d,x),_e(K,$,d,x,d,v),Q-=fe,oe-=fe,de+=fe,xe+=fe;const we=1/Math.max(de-Q,xe-oe);return{scale:we,x:Q*we,y:oe*we,x2:de*we,y2:xe*we,projection:i}}const E7=ya(new Float32Array(16));class Xc{constructor(i){this.spec=i,this.name=i.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(i,c){return{x:0,y:0,z:0}}unproject(i,c){return new Zr(0,0)}projectTilePoint(i,c,d){return{x:i,y:c,z:0}}locationPoint(i,c,d=!0){return i._coordinatePoint(i.locationCoordinate(c),d)}pixelsPerMeter(i,c){return _a(1,i)*c}pixelSpaceConversion(i,c,d){return 1}farthestPixelDistance(i){return hL(i,i.pixelsPerMeter)}pointCoordinate(i,c,d,m){const v=i.horizonLineFromTop(!1),x=new ue(c,Math.max(v,d));return i.rayIntersectionCoordinate(i.pointRayIntersection(x,m))}pointCoordinate3D(i,c,d){const m=new ue(c,d);if(i.elevation)return i.elevation.pointCoordinate(m);{const v=this.pointCoordinate(i,m.x,m.y,0);return[v.x,v.y,v.z]}}isPointAboveHorizon(i,c){if(i.elevation)return!this.pointCoordinate3D(i,c.x,c.y);const d=i.horizonLineFromTop();return c.y<d}createInversionMatrix(i,c){return E7}createTileMatrix(i,c,d){let m,v,x;const T=d.canonical,P=ya(new Float64Array(16));if(this.isReprojectedInTileSpace){const C=Mh(T,this);m=1,v=C.x+d.wrap*C.scale,x=C.y,Th(P,P,[m/C.scale,m/C.scale,i.pixelsPerMeter/c])}else m=c/i.zoomScale(T.z),v=(T.x+Math.pow(2,T.z)*d.wrap)*m,x=T.y*m;return Dg(P,P,[v,x,0]),Th(P,P,[m/Zt,m/Zt,1]),P}upVector(i,c,d){return[0,0,1]}upVectorScale(i,c,d){return{metersToTile:1}}}class A7 extends Xc{constructor(i){super(i),this.range=[4,7],this.center=i.center||[-96,37.5];const[c,d]=this.parallels=i.parallels||[29.5,45.5],m=Math.sin(je(c));this.n=(m+Math.sin(je(d)))/2,this.c=1+m*(2*this.n-m),this.r0=Math.sqrt(this.c)/this.n}project(i,c){const{n:d,c:m,r0:v}=this,x=je(i-this.center[0]),T=je(c),P=Math.sqrt(m-2*d*Math.sin(T))/d;return{x:P*Math.sin(x*d),y:P*Math.cos(x*d)-v,z:0}}unproject(i,c){const{n:d,c:m,r0:v}=this,x=v+c;let T=Math.atan2(i,Math.abs(x))*Math.sign(x);x*d<0&&(T-=Math.PI*Math.sign(i)*Math.sign(x));const P=je(this.center[0])*d;T=ht(T,-Math.PI-P,Math.PI-P);const C=De(Ge(T/d)+this.center[0],-180,180),D=Math.asin(De((m-(i*i+x*x)*d*d)/(2*d),-1,1)),$=De(Ge(D),-Vi,Vi);return new Zr(C,$)}}const iy=1.340264,oy=-.081106,sy=893e-6,ay=.003796,ax=Math.sqrt(3)/2;class P7 extends Xc{project(i,c){c=c/180*Math.PI,i=i/180*Math.PI;const d=Math.asin(ax*Math.sin(c)),m=d*d,v=m*m*m;return{x:.5*(i*Math.cos(d)/(ax*(iy+3*oy*m+v*(7*sy+9*ay*m)))/Math.PI+.5),y:1-.5*(d*(iy+oy*m+v*(sy+ay*m))/Math.PI+1),z:0}}unproject(i,c){i=(2*i-.5)*Math.PI;let d=c=(2*(1-c)-1)*Math.PI,m=d*d,v=m*m*m;for(let D,$,U,q=0;q<12&&($=d*(iy+oy*m+v*(sy+ay*m))-c,U=iy+3*oy*m+v*(7*sy+9*ay*m),D=$/U,d=De(d-D,-Math.PI/3,Math.PI/3),m=d*d,v=m*m*m,!(Math.abs(D)<1e-12));++q);const x=ax*i*(iy+3*oy*m+v*(7*sy+9*ay*m))/Math.cos(d),T=Math.asin(Math.sin(d)/ax),P=De(180*x/Math.PI,-180,180),C=De(180*T/Math.PI,-Vi,Vi);return new Zr(P,C)}}class C7 extends Xc{constructor(i){super(i),this.wrap=!0,this.supportsWorldCopies=!0}project(i,c){return{x:.5+i/360,y:.5-c/360,z:0}}unproject(i,c){const d=360*(i-.5),m=De(360*(.5-c),-Vi,Vi);return new Zr(d,m)}}const Rf=Math.PI/2;function lx(a){return Math.tan((Rf+a)/2)}class k7 extends Xc{constructor(i){super(i),this.center=i.center||[0,30];const[c,d]=this.parallels=i.parallels||[30,30];let m=je(c),v=je(d);this.southernCenter=m+v<0,this.southernCenter&&(m=-m,v=-v);const x=Math.cos(m),T=lx(m);this.n=m===v?Math.sin(m):Math.log(x/Math.cos(v))/Math.log(lx(v)/T),this.f=x*Math.pow(lx(m),this.n)/this.n}project(i,c){c=je(c),this.southernCenter&&(c=-c),i=je(i-this.center[0]);const d=1e-6,{n:m,f:v}=this;v>0?c<-Rf+d&&(c=-Rf+d):c>Rf-d&&(c=Rf-d);const x=v/Math.pow(lx(c),m);let T=x*Math.sin(m*i),P=v-x*Math.cos(m*i);return T=.5*(T/Math.PI+.5),P=.5*(P/Math.PI+.5),{x:T,y:this.southernCenter?P:1-P,z:0}}unproject(i,c){i=(2*i-.5)*Math.PI,this.southernCenter&&(c=1-c),c=(2*(1-c)-.5)*Math.PI;const{n:d,f:m}=this,v=m-c,x=Math.sign(v),T=Math.sign(d)*Math.sqrt(i*i+v*v);let P=Math.atan2(i,Math.abs(v))*x;v*d<0&&(P-=Math.PI*Math.sign(i)*x);const C=De(Ge(P/d)+this.center[0],-180,180),D=De(Ge(2*Math.atan(Math.pow(m/T,1/d))-Rf),-Vi,Vi);return new Zr(C,this.southernCenter?-D:D)}}class dL extends Xc{constructor(i){super(i),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(i,c){return{x:ol(i),y:sl(c),z:0}}unproject(i,c){const d=ps(i),m=Ui(c);return new Zr(d,m)}}const fL=je(Vi);class O7 extends Xc{project(i,c){const d=(c=je(c))*c,m=d*d;return{x:.5*((i=je(i))*(.8707-.131979*d+m*(m*(.003971*d-.001529*m)-.013791))/Math.PI+.5),y:1-.5*(c*(1.007226+d*(.015085+m*(.028874*d-.044475-.005916*m)))/Math.PI+1),z:0}}unproject(i,c){i=(2*i-.5)*Math.PI;let d=c=(2*(1-c)-1)*Math.PI,m=25,v=0,x=d*d;do{x=d*d;const C=x*x;v=(d*(1.007226+x*(.015085+C*(.028874*x-.044475-.005916*C)))-c)/(1.007226+x*(.045255+C*(.259866*x-.311325-.005916*11*C))),d=De(d-v,-fL,fL)}while(Math.abs(v)>1e-6&&--m>0);x=d*d;const T=De(Ge(i/(.8707+x*(x*(x*x*x*(.003971-.001529*x)-.013791)-.131979))),-180,180),P=Ge(d);return new Zr(T,P)}}const pL=je(Vi);class M7 extends Xc{project(i,c){c=je(c),i=je(i);const d=Math.cos(c),m=2/Math.PI,v=Math.acos(d*Math.cos(i/2)),x=Math.sin(v)/v,T=.5*(i*m+2*d*Math.sin(i/2)/x)||0,P=.5*(c+Math.sin(c)/x)||0;return{x:.5*(T/Math.PI+.5),y:1-.5*(P/Math.PI+1),z:0}}unproject(i,c){let d=i=(2*i-.5)*Math.PI,m=c=(2*(1-c)-1)*Math.PI,v=25;const x=1e-6;let T=0,P=0;do{const C=Math.cos(m),D=Math.sin(m),$=2*D*C,U=D*D,q=C*C,K=Math.cos(d/2),Q=Math.sin(d/2),oe=2*K*Q,de=Q*Q,xe=1-q*K*K,fe=xe?1/xe:0,_e=xe?Math.acos(C*K)*Math.sqrt(1/xe):0,we=.5*(2*_e*C*Q+2*d/Math.PI)-i,be=.5*(_e*D+m)-c,We=.5*fe*(q*de+_e*C*K*U)+1/Math.PI,Fe=fe*(oe*$/4-_e*D*Q),Qe=.125*fe*($*Q-_e*D*q*oe),mt=.5*fe*(U*K+_e*de*C)+.5,Ke=Fe*Qe-mt*We;T=(be*Fe-we*mt)/Ke,P=(we*Qe-be*We)/Ke,d=De(d-T,-Math.PI,Math.PI),m=De(m-P,-pL,pL)}while((Math.abs(T)>x||Math.abs(P)>x)&&--v>0);return new Zr(Ge(d),Ge(m))}}class mL extends Xc{constructor(i){super(i),this.center=i.center||[0,0],this.parallels=i.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(je(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(i,c){const{scale:d,cosPhi:m}=this;return{x:je(i)*m*d+.5,y:-Math.sin(je(c))/m*d+.5,z:0}}unproject(i,c){const{scale:d,cosPhi:m}=this,v=-(c-.5)/d,x=De(Ge((i-.5)/d)/m,-180,180),T=Math.asin(De(v*m,-1,1)),P=De(Ge(T),-Vi,Vi);return new Zr(x,P)}}class I7 extends dL{constructor(i){super(i),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(i,c,d){const m=Ug(i,c,d);return Fn(m,m,Vg(il(d))),{x:m[0],y:m[1],z:m[2]}}locationPoint(i,c){const d=vf(c.lat,c.lng),m=ho([],d),v=i.elevation?i.elevation.getAtPointOrZero(i.locationCoordinate(c),i._centerAltitude):i._centerAltitude;Bg(d,d,m,_a(1,0)*Zt*v);const x=ya(new Float64Array(16));return Sh(x,i.pixelMatrix,i.globeMatrix),Fn(d,d,x),new ue(d[0],d[1])}pixelsPerMeter(i,c){return _a(1,0)*c}pixelSpaceConversion(i,c,d){const m=_a(1,i)*c,v=Or(_a(1,45)*c,m,d);return this.pixelsPerMeter(i,c)/v}createTileMatrix(i,c,d){const m=_T(il(d.canonical));return Sh(new Float64Array(16),i.globeMatrix,m)}createInversionMatrix(i,c){const{center:d}=i,m=Vg(il(c));return j0(m,m,je(d.lng)),cT(m,m,je(d.lat)),Th(m,m,[i._pixelsPerMercatorPixel,i._pixelsPerMercatorPixel,1]),Float32Array.from(m)}pointCoordinate(i,c,d,m){return UR(i,c,d,!0)||new xf(0,0)}pointCoordinate3D(i,c,d){const m=this.pointCoordinate(i,c,d,0);return[m.x,m.y,m.z]}isPointAboveHorizon(i,c){return!UR(i,c.x,c.y,!1)}farthestPixelDistance(i){const c=function(m,v){const x=m.cameraToCenterDistance,T=m._centerAltitude*v,P=m._camera,C=m._camera.forward(),D=Vl([],fs([],C,-x),[0,0,T]),$=m.worldSize/(2*Math.PI),U=[0,0,-$],q=m.width/m.height,K=Math.tan(m.fovAboveCenter),Q=fs([],P.up(),K),oe=fs([],P.right(),K*q),de=ho([],Vl([],Vl([],C,Q),oe)),xe=[];let fe;if(new fT(D,de).closestPointOnSphere(U,$,xe)){const _e=Vl([],xe,U),we=va([],_e,D);fe=Math.cos(m.fovAboveCenter)*Lg(we)}else{const _e=va([],D,U),we=va([],U,D);ho(we,we);const be=Lg(_e)-$;fe=Math.sqrt(be*(be+2*$));const We=Math.acos(fe/($+be))-Math.acos(zs(C,we));fe*=Math.cos(We)}return 1.01*fe}(i,this.pixelsPerMeter(i.center.lat,i.worldSize)),d=_f(i.zoom);if(d>0){const m=hL(i,_a(1,i.center.lat)*i.worldSize),v=i.worldSize/(2*Math.PI),x=Math.max(i.width,i.height)/i.worldSize*Math.PI;return Or(c,m+v*(1-Math.cos(x)),Math.pow(d,10))}return c}upVector(i,c,d){return Ug(c,d,i,1)}upVectorScale(i){return{metersToTile:z0(N0(il(i)))}}}function gL(a){const i=a.parallels,c=!!i&&Math.abs(i[0]+i[1])<.01;switch(a.name){case"mercator":return new dL(a);case"equirectangular":return new C7(a);case"naturalEarth":return new O7(a);case"equalEarth":return new P7(a);case"winkelTripel":return new M7(a);case"albers":return c?new mL(a):new A7(a);case"lambertConformalConic":return c?new mL(a):new k7(a);case"globe":return new I7(a)}throw new Error(`Invalid projection name: ${a.name}`)}const R7=Z0.types,D7=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function cx(a,i,c,d,m,v,x,T,P,C,D,$,U){const q=T?Math.min(Zc,Math.round(T[0])):0,K=T?Math.min(Zc,Math.round(T[1])):0;a.emplaceBack(i,c,Math.round(32*d),Math.round(32*m),v,x,(q<<1)+(P?1:0),K,16*C,16*D,256*$,256*U)}function ux(a,i,c,d,m,v,x){a.emplaceBack(i,c,d,m,v,x)}function hx(a,i,c,d,m){a.emplaceBack(i,c,d,m),a.emplaceBack(i,c,d,m),a.emplaceBack(i,c,d,m),a.emplaceBack(i,c,d,m)}function L7(a){for(const i of a.sections)if(iT(i.text))return!0;return!1}class XT{constructor(i){this.layoutVertexArray=new lt,this.indexArray=new Nt,this.programConfigurations=i,this.segments=new Wn,this.dynamicLayoutVertexArray=new ft,this.opacityVertexArray=new Vt,this.placedSymbolArray=new Gn,this.globeExtVertexArray=new vt}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(i,c,d,m){this.isEmpty()||(d&&(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,V9.members),this.indexBuffer=i.createIndexBuffer(this.indexArray,c),this.dynamicLayoutVertexBuffer=i.createVertexBuffer(this.dynamicLayoutVertexArray,W9.members,!0),this.opacityVertexBuffer=i.createVertexBuffer(this.opacityVertexArray,D7,!0),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=i.createVertexBuffer(this.globeExtVertexArray,G9.members,!0)),this.opacityVertexBuffer.itemSize=1),(d||m)&&this.programConfigurations.upload(i))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}}jt(XT,"SymbolBuffers");class YT{constructor(i,c,d){this.layoutVertexArray=new i,this.layoutAttributes=c,this.indexArray=new d,this.segments=new Wn,this.collisionVertexArray=new br,this.collisionVertexArrayExt=new yr}upload(i){this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=i.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=i.createVertexBuffer(this.collisionVertexArray,q9.members,!0),this.collisionVertexBufferExt=i.createVertexBuffer(this.collisionVertexArrayExt,H9.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}jt(YT,"CollisionBuffers");class Yc{constructor(i){this.collisionBoxArray=i.collisionBoxArray,this.zoom=i.zoom,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(x=>x.id),this.index=i.index,this.pixelRatio=i.pixelRatio,this.sourceLayerIndex=i.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=ya([]),this.placementViewportMatrix=ya([]);const c=this.layers[0]._unevaluatedLayout._values;this.textSizeData=NT(this.zoom,c["text-size"]),this.iconSizeData=NT(this.zoom,c["icon-size"]);const d=this.layers[0].layout,m=d.get("symbol-sort-key"),v=d.get("symbol-z-order");this.canOverlap=d.get("text-allow-overlap")||d.get("icon-allow-overlap")||d.get("text-ignore-placement")||d.get("icon-ignore-placement"),this.sortFeaturesByKey=v!=="viewport-y"&&m.constantOr(1)!==void 0,this.sortFeaturesByY=(v==="viewport-y"||v==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=d.get("text-writing-mode").map(x=>ms[x]),this.stateDependentLayerIds=this.layers.filter(x=>x.isStateDependent()).map(x=>x.id),this.sourceID=i.sourceID,this.projection=i.projection}createArrays(){this.text=new XT(new wh(this.layers,this.zoom,i=>/^text/.test(i))),this.icon=new XT(new wh(this.layers,this.zoom,i=>/^icon/.test(i))),this.glyphOffsetArray=new uo,this.lineVertexArray=new ff,this.symbolInstances=new fn}calculateGlyphDependencies(i,c,d,m,v){for(let x=0;x<i.length;x++)if(c[i.charCodeAt(x)]=!0,m&&v){const T=ey[i.charAt(x)];T&&(c[T.charCodeAt(0)]=!0)}}populate(i,c,d,m){const v=this.layers[0],x=v.layout,T=this.projection.name==="globe",P=x.get("text-font"),C=x.get("text-field"),D=x.get("icon-image"),$=(C.value.kind!=="constant"||C.value.value instanceof co&&!C.value.value.isEmpty()||C.value.value.toString().length>0)&&(P.value.kind!=="constant"||P.value.value.length>0),U=D.value.kind!=="constant"||!!D.value.value||Object.keys(D.parameters).length>0,q=x.get("symbol-sort-key");if(this.features=[],!$&&!U)return;const K=c.iconDependencies,Q=c.glyphDependencies,oe=c.availableImages,de=new N(this.zoom);for(const{feature:xe,id:fe,index:_e,sourceLayerIndex:we}of i){const be=v._featureFilter.needGeometry,We=Ch(xe,be);if(!v._featureFilter.filter(de,We,d))continue;if(be||(We.geometry=Gl(xe,d,m)),T&&xe.type!==1&&d.z<=5){const Ke=We.geometry,ot=.98078528056,st=(dt,_t)=>zs(Ug(dt.x,dt.y,d,1),Ug(_t.x,_t.y,d,1))<ot;for(let dt=0;dt<Ke.length;dt++)Ke[dt]=WH(Ke[dt],st)}let Fe,Qe;if($){const Ke=v.getValueAndResolveTokens("text-field",We,d,oe),ot=co.factory(Ke);L7(ot)&&(this.hasRTLText=!0),(!this.hasRTLText||E()==="unavailable"||this.hasRTLText&&I.isParsed())&&(Fe=X9(ot,v,We))}if(U){const Ke=v.getValueAndResolveTokens("icon-image",We,d,oe);Qe=Ke instanceof Uo?Ke:Uo.fromString(Ke)}if(!Fe&&!Qe)continue;const mt=this.sortFeaturesByKey?q.evaluate(We,{},d):void 0;if(this.features.push({id:fe,text:Fe,icon:Qe,index:_e,sourceLayerIndex:we,geometry:We.geometry,properties:xe.properties,type:R7[xe.type],sortKey:mt}),Qe&&(K[Qe.name]=!0),Fe){const Ke=P.evaluate(We,{},d).join(","),ot=x.get("text-rotation-alignment")==="map"&&x.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(ms.vertical)>=0;for(const st of Fe.sections)if(st.image)K[st.image.name]=!0;else{const dt=Pg(Fe.toString()),_t=st.fontStack||Ke,Je=Q[_t]=Q[_t]||{};this.calculateGlyphDependencies(st.text,Je,ot,this.allowVerticalPlacement,dt)}}}x.get("symbol-placement")==="line"&&(this.features=function(xe){const fe={},_e={},we=[];let be=0;function We(Ke){we.push(xe[Ke]),be++}function Fe(Ke,ot,st){const dt=_e[Ke];return delete _e[Ke],_e[ot]=dt,we[dt].geometry[0].pop(),we[dt].geometry[0]=we[dt].geometry[0].concat(st[0]),dt}function Qe(Ke,ot,st){const dt=fe[ot];return delete fe[ot],fe[Ke]=dt,we[dt].geometry[0].shift(),we[dt].geometry[0]=st[0].concat(we[dt].geometry[0]),dt}function mt(Ke,ot,st){const dt=st?ot[0][ot[0].length-1]:ot[0][0];return`${Ke}:${dt.x}:${dt.y}`}for(let Ke=0;Ke<xe.length;Ke++){const ot=xe[Ke],st=ot.geometry,dt=ot.text?ot.text.toString():null;if(!dt){We(Ke);continue}const _t=mt(dt,st),Je=mt(dt,st,!0);if(_t in _e&&Je in fe&&_e[_t]!==fe[Je]){const Pt=Qe(_t,Je,st),Bt=Fe(_t,Je,we[Pt].geometry);delete fe[_t],delete _e[Je],_e[mt(dt,we[Bt].geometry,!0)]=Bt,we[Pt].geometry=null}else _t in _e?Fe(_t,Je,st):Je in fe?Qe(_t,Je,st):(We(Ke),fe[_t]=be-1,_e[Je]=be-1)}return we.filter(Ke=>Ke.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((xe,fe)=>xe.sortKey-fe.sortKey)}update(i,c,d,m){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(i,c,this.layers,d,m),this.icon.programConfigurations.updatePaintArrays(i,c,this.layers,d,m))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(i){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(i),this.iconCollisionBox.upload(i)),this.text.upload(i,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(i,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=gL(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(i,c){const d=this.lineVertexArray.length;if(i.segment!==void 0)for(const{x:m,y:v}of c)this.lineVertexArray.emplaceBack(m,v);return{lineStartIndex:d,lineLength:this.lineVertexArray.length-d}}addSymbols(i,c,d,m,v,x,T,P,C,D,$,U,q,K){const Q=i.indexArray,oe=i.layoutVertexArray,de=i.globeExtVertexArray,xe=i.segments.prepareSegment(4*c.length,oe,Q,this.canOverlap?x.sortKey:void 0),fe=this.glyphOffsetArray.length,_e=xe.vertexLength,we=this.allowVerticalPlacement&&T===ms.vertical?Math.PI/2:0,be=x.text&&x.text.sections;for(let Fe=0;Fe<c.length;Fe++){const{tl:Qe,tr:mt,bl:Ke,br:ot,tex:st,pixelOffsetTL:dt,pixelOffsetBR:_t,minFontScaleX:Je,minFontScaleY:Pt,glyphOffset:Bt,isSDF:kt,sectionIndex:ar}=c[Fe],bt=xe.vertexLength,Gt=Bt[1];if(cx(oe,C.x,C.y,Qe.x,Gt+Qe.y,st.x,st.y,d,kt,dt.x,dt.y,Je,Pt),cx(oe,C.x,C.y,mt.x,Gt+mt.y,st.x+st.w,st.y,d,kt,_t.x,dt.y,Je,Pt),cx(oe,C.x,C.y,Ke.x,Gt+Ke.y,st.x,st.y+st.h,d,kt,dt.x,_t.y,Je,Pt),cx(oe,C.x,C.y,ot.x,Gt+ot.y,st.x+st.w,st.y+st.h,d,kt,_t.x,_t.y,Je,Pt),P){const{x:lr,y:Rr,z:cr}=P.anchor,[Qt,an,ur]=P.up;ux(de,lr,Rr,cr,Qt,an,ur),ux(de,lr,Rr,cr,Qt,an,ur),ux(de,lr,Rr,cr,Qt,an,ur),ux(de,lr,Rr,cr,Qt,an,ur),hx(i.dynamicLayoutVertexArray,lr,Rr,cr,we)}else hx(i.dynamicLayoutVertexArray,C.x,C.y,C.z,we);Q.emplaceBack(bt,bt+1,bt+2),Q.emplaceBack(bt+1,bt+2,bt+3),xe.vertexLength+=4,xe.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Bt[0]),Fe!==c.length-1&&ar===c[Fe+1].sectionIndex||i.programConfigurations.populatePaintArrays(oe.length,x,x.index,{},q,K,be&&be[ar])}const We=P?P.anchor:C;i.placedSymbolArray.emplaceBack(We.x,We.y,We.z,C.x,C.y,fe,this.glyphOffsetArray.length-fe,_e,D,$,C.segment,d?d[0]:0,d?d[1]:0,m[0],m[1],T,0,!1,0,U,0)}_commitLayoutVertex(i,c,d,m,v,x,T){i.emplaceBack(c,d,m,v,x,Math.round(T.x),Math.round(T.y))}_addCollisionDebugVertices(i,c,d,m,v,x,T){const P=d.segments.prepareSegment(4,d.layoutVertexArray,d.indexArray),C=P.vertexLength,D=T.tileAnchorX,$=T.tileAnchorY;for(let q=0;q<4;q++)d.collisionVertexArray.emplaceBack(0,0,0,0);d.collisionVertexArrayExt.emplaceBack(c,-i.padding,-i.padding),d.collisionVertexArrayExt.emplaceBack(c,i.padding,-i.padding),d.collisionVertexArrayExt.emplaceBack(c,i.padding,i.padding),d.collisionVertexArrayExt.emplaceBack(c,-i.padding,i.padding),this._commitLayoutVertex(d.layoutVertexArray,m,v,x,D,$,new ue(i.x1,i.y1)),this._commitLayoutVertex(d.layoutVertexArray,m,v,x,D,$,new ue(i.x2,i.y1)),this._commitLayoutVertex(d.layoutVertexArray,m,v,x,D,$,new ue(i.x2,i.y2)),this._commitLayoutVertex(d.layoutVertexArray,m,v,x,D,$,new ue(i.x1,i.y2)),P.vertexLength+=4;const U=d.indexArray;U.emplaceBack(C,C+1),U.emplaceBack(C+1,C+2),U.emplaceBack(C+2,C+3),U.emplaceBack(C+3,C),P.primitiveLength+=4}_addTextDebugCollisionBoxes(i,c,d,m,v,x){for(let T=m;T<v;T++){const P=d.get(T),C=this.getSymbolInstanceTextSize(i,x,c,T);this._addCollisionDebugVertices(P,C,this.textCollisionBox,P.projectedAnchorX,P.projectedAnchorY,P.projectedAnchorZ,x)}}_addIconDebugCollisionBoxes(i,c,d,m,v,x){for(let T=m;T<v;T++){const P=d.get(T),C=this.getSymbolInstanceIconSize(i,c,x.placedIconSymbolIndex);this._addCollisionDebugVertices(P,C,this.iconCollisionBox,P.projectedAnchorX,P.projectedAnchorY,P.projectedAnchorZ,x)}}generateCollisionDebugBuffers(i,c){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new YT(zt,LD.members,fi),this.iconCollisionBox=new YT(zt,LD.members,fi);const d=Ef(this.iconSizeData,i),m=Ef(this.textSizeData,i);for(let v=0;v<this.symbolInstances.length;v++){const x=this.symbolInstances.get(v);this._addTextDebugCollisionBoxes(m,i,c,x.textBoxStartIndex,x.textBoxEndIndex,x),this._addTextDebugCollisionBoxes(m,i,c,x.verticalTextBoxStartIndex,x.verticalTextBoxEndIndex,x),this._addIconDebugCollisionBoxes(d,i,c,x.iconBoxStartIndex,x.iconBoxEndIndex,x),this._addIconDebugCollisionBoxes(d,i,c,x.verticalIconBoxStartIndex,x.verticalIconBoxEndIndex,x)}}getSymbolInstanceTextSize(i,c,d,m){const v=this.text.placedSymbolArray.get(c.rightJustifiedTextSymbolIndex>=0?c.rightJustifiedTextSymbolIndex:c.centerJustifiedTextSymbolIndex>=0?c.centerJustifiedTextSymbolIndex:c.leftJustifiedTextSymbolIndex>=0?c.leftJustifiedTextSymbolIndex:c.verticalPlacedTextSymbolIndex>=0?c.verticalPlacedTextSymbolIndex:m),x=Q0(this.textSizeData,i,v)/Ai;return this.tilePixelRatio*x}getSymbolInstanceIconSize(i,c,d){const m=this.icon.placedSymbolArray.get(d),v=Q0(this.iconSizeData,i,m);return this.tilePixelRatio*v}_commitDebugCollisionVertexUpdate(i,c,d){i.emplaceBack(c,-d,-d),i.emplaceBack(c,d,-d),i.emplaceBack(c,d,d),i.emplaceBack(c,-d,d)}_updateTextDebugCollisionBoxes(i,c,d,m,v,x){for(let T=m;T<v;T++){const P=d.get(T),C=this.getSymbolInstanceTextSize(i,x,c,T);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,C,P.padding)}}_updateIconDebugCollisionBoxes(i,c,d,m,v,x){for(let T=m;T<v;T++){const P=d.get(T),C=this.getSymbolInstanceIconSize(i,c,x);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,C,P.padding)}}updateCollisionDebugBuffers(i,c){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const d=Ef(this.iconSizeData,i),m=Ef(this.textSizeData,i);for(let v=0;v<this.symbolInstances.length;v++){const x=this.symbolInstances.get(v);this._updateTextDebugCollisionBoxes(m,i,c,x.textBoxStartIndex,x.textBoxEndIndex,x),this._updateTextDebugCollisionBoxes(m,i,c,x.verticalTextBoxStartIndex,x.verticalTextBoxEndIndex,x),this._updateIconDebugCollisionBoxes(d,i,c,x.iconBoxStartIndex,x.iconBoxEndIndex,x.placedIconSymbolIndex),this._updateIconDebugCollisionBoxes(d,i,c,x.verticalIconBoxStartIndex,x.verticalIconBoxEndIndex,x.placedIconSymbolIndex)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(i,c,d,m,v,x,T,P,C){const D={};if(c<d){const{x1:$,y1:U,x2:q,y2:K,padding:Q,projectedAnchorX:oe,projectedAnchorY:de,projectedAnchorZ:xe,tileAnchorX:fe,tileAnchorY:_e,featureIndex:we}=i.get(c);D.textBox={x1:$,y1:U,x2:q,y2:K,padding:Q,projectedAnchorX:oe,projectedAnchorY:de,projectedAnchorZ:xe,tileAnchorX:fe,tileAnchorY:_e},D.textFeatureIndex=we}if(m<v){const{x1:$,y1:U,x2:q,y2:K,padding:Q,projectedAnchorX:oe,projectedAnchorY:de,projectedAnchorZ:xe,tileAnchorX:fe,tileAnchorY:_e,featureIndex:we}=i.get(m);D.verticalTextBox={x1:$,y1:U,x2:q,y2:K,padding:Q,projectedAnchorX:oe,projectedAnchorY:de,projectedAnchorZ:xe,tileAnchorX:fe,tileAnchorY:_e},D.verticalTextFeatureIndex=we}if(x<T){const{x1:$,y1:U,x2:q,y2:K,padding:Q,projectedAnchorX:oe,projectedAnchorY:de,projectedAnchorZ:xe,tileAnchorX:fe,tileAnchorY:_e,featureIndex:we}=i.get(x);D.iconBox={x1:$,y1:U,x2:q,y2:K,padding:Q,projectedAnchorX:oe,projectedAnchorY:de,projectedAnchorZ:xe,tileAnchorX:fe,tileAnchorY:_e},D.iconFeatureIndex=we}if(P<C){const{x1:$,y1:U,x2:q,y2:K,padding:Q,projectedAnchorX:oe,projectedAnchorY:de,projectedAnchorZ:xe,tileAnchorX:fe,tileAnchorY:_e,featureIndex:we}=i.get(P);D.verticalIconBox={x1:$,y1:U,x2:q,y2:K,padding:Q,projectedAnchorX:oe,projectedAnchorY:de,projectedAnchorZ:xe,tileAnchorX:fe,tileAnchorY:_e},D.verticalIconFeatureIndex=we}return D}deserializeCollisionBoxes(i){this.collisionArrays=[];for(let c=0;c<this.symbolInstances.length;c++){const d=this.symbolInstances.get(c);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(i,d.textBoxStartIndex,d.textBoxEndIndex,d.verticalTextBoxStartIndex,d.verticalTextBoxEndIndex,d.iconBoxStartIndex,d.iconBoxEndIndex,d.verticalIconBoxStartIndex,d.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(i,c){const d=i.placedSymbolArray.get(c),m=d.vertexStartIndex+4*d.numGlyphs;for(let v=d.vertexStartIndex;v<m;v+=4)i.indexArray.emplaceBack(v,v+1,v+2),i.indexArray.emplaceBack(v+1,v+2,v+3)}getSortedSymbolIndexes(i){if(this.sortedAngle===i&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const c=Math.sin(i),d=Math.cos(i),m=[],v=[],x=[];for(let T=0;T<this.symbolInstances.length;++T){x.push(T);const P=this.symbolInstances.get(T);m.push(0|Math.round(c*P.tileAnchorX+d*P.tileAnchorY)),v.push(P.featureIndex)}return x.sort((T,P)=>m[T]-m[P]||v[P]-v[T]),x}addToSortKeyRanges(i,c){const d=this.sortKeyRanges[this.sortKeyRanges.length-1];d&&d.sortKey===c?d.symbolInstanceEnd=i+1:this.sortKeyRanges.push({sortKey:c,symbolInstanceStart:i,symbolInstanceEnd:i+1})}sortFeatures(i){if(this.sortFeaturesByY&&this.sortedAngle!==i&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(i),this.sortedAngle=i,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const c of this.symbolInstanceIndexes){const d=this.symbolInstances.get(c);this.featureSortOrder.push(d.featureIndex);const{rightJustifiedTextSymbolIndex:m,centerJustifiedTextSymbolIndex:v,leftJustifiedTextSymbolIndex:x,verticalPlacedTextSymbolIndex:T,placedIconSymbolIndex:P,verticalPlacedIconSymbolIndex:C}=d;m>=0&&this.addIndicesForPlacedSymbol(this.text,m),v>=0&&v!==m&&this.addIndicesForPlacedSymbol(this.text,v),x>=0&&x!==v&&x!==m&&this.addIndicesForPlacedSymbol(this.text,x),T>=0&&this.addIndicesForPlacedSymbol(this.text,T),P>=0&&this.addIndicesForPlacedSymbol(this.icon,P),C>=0&&this.addIndicesForPlacedSymbol(this.icon,C)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}jt(Yc,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),Yc.MAX_GLYPHS=65535,Yc.addDynamicAttributes=hx;const j7=new ge({"symbol-placement":new J(Xe.layout_symbol["symbol-placement"]),"symbol-spacing":new J(Xe.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new J(Xe.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new se(Xe.layout_symbol["symbol-sort-key"]),"symbol-z-order":new J(Xe.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new J(Xe.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new J(Xe.layout_symbol["icon-ignore-placement"]),"icon-optional":new J(Xe.layout_symbol["icon-optional"]),"icon-rotation-alignment":new J(Xe.layout_symbol["icon-rotation-alignment"]),"icon-size":new se(Xe.layout_symbol["icon-size"]),"icon-text-fit":new J(Xe.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new J(Xe.layout_symbol["icon-text-fit-padding"]),"icon-image":new se(Xe.layout_symbol["icon-image"]),"icon-rotate":new se(Xe.layout_symbol["icon-rotate"]),"icon-padding":new J(Xe.layout_symbol["icon-padding"]),"icon-keep-upright":new J(Xe.layout_symbol["icon-keep-upright"]),"icon-offset":new se(Xe.layout_symbol["icon-offset"]),"icon-anchor":new se(Xe.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new J(Xe.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new J(Xe.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new J(Xe.layout_symbol["text-rotation-alignment"]),"text-field":new se(Xe.layout_symbol["text-field"]),"text-font":new se(Xe.layout_symbol["text-font"]),"text-size":new se(Xe.layout_symbol["text-size"]),"text-max-width":new se(Xe.layout_symbol["text-max-width"]),"text-line-height":new se(Xe.layout_symbol["text-line-height"]),"text-letter-spacing":new se(Xe.layout_symbol["text-letter-spacing"]),"text-justify":new se(Xe.layout_symbol["text-justify"]),"text-radial-offset":new se(Xe.layout_symbol["text-radial-offset"]),"text-variable-anchor":new J(Xe.layout_symbol["text-variable-anchor"]),"text-anchor":new se(Xe.layout_symbol["text-anchor"]),"text-max-angle":new J(Xe.layout_symbol["text-max-angle"]),"text-writing-mode":new J(Xe.layout_symbol["text-writing-mode"]),"text-rotate":new se(Xe.layout_symbol["text-rotate"]),"text-padding":new J(Xe.layout_symbol["text-padding"]),"text-keep-upright":new J(Xe.layout_symbol["text-keep-upright"]),"text-transform":new se(Xe.layout_symbol["text-transform"]),"text-offset":new se(Xe.layout_symbol["text-offset"]),"text-allow-overlap":new J(Xe.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new J(Xe.layout_symbol["text-ignore-placement"]),"text-optional":new J(Xe.layout_symbol["text-optional"])});var JT={paint:new ge({"icon-opacity":new se(Xe.paint_symbol["icon-opacity"]),"icon-color":new se(Xe.paint_symbol["icon-color"]),"icon-halo-color":new se(Xe.paint_symbol["icon-halo-color"]),"icon-halo-width":new se(Xe.paint_symbol["icon-halo-width"]),"icon-halo-blur":new se(Xe.paint_symbol["icon-halo-blur"]),"icon-translate":new J(Xe.paint_symbol["icon-translate"]),"icon-translate-anchor":new J(Xe.paint_symbol["icon-translate-anchor"]),"text-opacity":new se(Xe.paint_symbol["text-opacity"]),"text-color":new se(Xe.paint_symbol["text-color"],{runtimeType:Po,getOverride:a=>a.textColor,hasOverride:a=>!!a.textColor}),"text-halo-color":new se(Xe.paint_symbol["text-halo-color"]),"text-halo-width":new se(Xe.paint_symbol["text-halo-width"]),"text-halo-blur":new se(Xe.paint_symbol["text-halo-blur"]),"text-translate":new J(Xe.paint_symbol["text-translate"]),"text-translate-anchor":new J(Xe.paint_symbol["text-translate-anchor"])}),layout:j7};class yL{constructor(i){this.type=i.property.overrides?i.property.overrides.runtimeType:Pc,this.defaultValue=i}evaluate(i){if(i.formattedSection){const c=this.defaultValue.property.overrides;if(c&&c.hasOverride(i.formattedSection))return c.getOverride(i.formattedSection)}return i.feature&&i.featureState?this.defaultValue.evaluate(i.feature,i.featureState):this.defaultValue.property.specification.default}eachChild(i){this.defaultValue.isConstant()||i(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}jt(yL,"FormatSectionOverride",{omit:["defaultValue"]});class dx extends ga{constructor(i){super(i,JT)}recalculate(i,c){super.recalculate(i,c),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const d=this.layout.get("text-writing-mode");if(d){const m=[];for(const v of d)m.indexOf(v)<0&&m.push(v);this.layout._values["text-writing-mode"]=m}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getValueAndResolveTokens(i,c,d,m){const v=this.layout.get(i).evaluate(c,{},d,m),x=this._unevaluatedLayout._values[i];return x.isDataDriven()||Nc(x.value)||!v?v:function(T,P){return P.replace(/{([^{}]+)}/g,(C,D)=>D in T?String(T[D]):"")}(c.properties,v)}createBucket(i){return new Yc(i)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const i of JT.paint.overridableProperties){if(!dx.hasPaintOverride(this.layout,i))continue;const c=this.paint.get(i),d=new yL(c),m=new of(d,c.property.specification);let v=null;v=c.value.kind==="constant"||c.value.kind==="source"?new gg("source",m):new fh("composite",m,c.value.zoomStops,c.value._interpolationType),this.paint._values[i]=new le(c.property,v,c.parameters)}}_handleOverridablePaintPropertyUpdate(i,c,d){return!(!this.layout||c.isDataDriven()||d.isDataDriven())&&dx.hasPaintOverride(this.layout,i)}static hasPaintOverride(i,c){const d=i.get("text-field"),m=JT.paint.properties[c];let v=!1;const x=T=>{for(const P of T)if(m.overrides&&m.overrides.hasOverride(P))return void(v=!0)};if(d.value.kind==="constant"&&d.value.value instanceof co)x(d.value.value.sections);else if(d.value.kind==="source"){const T=C=>{v||(C instanceof Il&&Cn(C.value)===Xu?x(C.value.sections):C instanceof el?x(C.sections):C.eachChild(T))},P=d.value;P._styleExpression&&T(P._styleExpression.expression)}return v}getProgramConfiguration(i){return new qc(this,i)}}var z7={paint:new ge({"background-color":new J(Xe.paint_background["background-color"]),"background-pattern":new J(Xe.paint_background["background-pattern"]),"background-opacity":new J(Xe.paint_background["background-opacity"])})},B7={paint:new ge({"raster-opacity":new J(Xe.paint_raster["raster-opacity"]),"raster-hue-rotate":new J(Xe.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new J(Xe.paint_raster["raster-brightness-min"]),"raster-brightness-max":new J(Xe.paint_raster["raster-brightness-max"]),"raster-saturation":new J(Xe.paint_raster["raster-saturation"]),"raster-contrast":new J(Xe.paint_raster["raster-contrast"]),"raster-resampling":new J(Xe.paint_raster["raster-resampling"]),"raster-fade-duration":new J(Xe.paint_raster["raster-fade-duration"])})};class N7 extends ga{constructor(i){super(i,{}),this.implementation=i}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}isLayerDraped(){return this.implementation.renderToTile!==void 0}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(i){this.implementation.onAdd&&this.implementation.onAdd(i,i.painter.context.gl)}onRemove(i){this.implementation.onRemove&&this.implementation.onRemove(i,i.painter.context.gl)}}var $7={paint:new ge({"sky-type":new J(Xe.paint_sky["sky-type"]),"sky-atmosphere-sun":new J(Xe.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new J(Xe.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new J(Xe.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new J(Xe.paint_sky["sky-gradient-radius"]),"sky-gradient":new me(Xe.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new J(Xe.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new J(Xe.paint_sky["sky-atmosphere-color"]),"sky-opacity":new J(Xe.paint_sky["sky-opacity"])})};function QT(a,i,c){const d=[0,0,1],m=jR([]);return BR(m,m,c?-je(a)+Math.PI:je(a)),zR(m,m,-je(i)),IR(d,d,m),ho(d,d)}const F7={circle:class extends ga{constructor(a){super(a,JH)}createBucket(a){return new ET(a)}queryRadius(a){const i=a;return bf("circle-radius",this,i)+bf("circle-stroke-width",this,i)+U0(this.paint.get("circle-translate"))}queryIntersectsFeature(a,i,c,d,m,v,x,T){const P=sD(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),v.angle,a.pixelToTileUnitsFactor),C=this.paint.get("circle-radius").evaluate(i,c)+this.paint.get("circle-stroke-width").evaluate(i,c);return aD(a,d,v,x,T,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",P,C)}getProgramIds(){return["circle"]}getProgramConfiguration(a){return new qc(this,a)}},heatmap:class extends ga{createBucket(a){return new cD(a)}constructor(a){super(a,r9),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(a){a==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=kT({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(a){return bf("heatmap-radius",this,a)}queryIntersectsFeature(a,i,c,d,m,v,x,T){const P=this.paint.get("heatmap-radius").evaluate(i,c);return aD(a,d,v,x,T,!0,!0,new ue(0,0),P)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getProgramConfiguration(a){return new qc(this,a)}},hillshade:class extends ga{constructor(a){super(a,n9)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}},fill:class extends ga{constructor(a){super(a,_9)}getProgramIds(){const a=this.paint.get("fill-pattern"),i=a&&a.constantOr(1),c=[i?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&c.push(i&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),c}getProgramConfiguration(a){return new qc(this,a)}recalculate(a,i){super.recalculate(a,i);const c=this.paint._values["fill-outline-color"];c.value.kind==="constant"&&c.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(a){return new H0(a)}queryRadius(){return U0(this.paint.get("fill-translate"))}queryIntersectsFeature(a,i,c,d,m,v){return!a.queryGeometry.isAboveHorizon&&tD(oD(a.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),v.angle,a.pixelToTileUnitsFactor),d)}isTileClipped(){return!0}},"fill-extrusion":class extends ga{constructor(a){super(a,L9)}createBucket(a){return new Yg(a)}queryRadius(){return U0(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}getProgramConfiguration(a){return new qc(this,a)}queryIntersectsFeature(a,i,c,d,m,v,x,T,P){const C=sD(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),v.angle,a.pixelToTileUnitsFactor),D=this.paint.get("fill-extrusion-height").evaluate(i,c),$=this.paint.get("fill-extrusion-base").evaluate(i,c),U=[0,0],q=T&&v.elevation,K=v.elevation?v.elevation.exaggeration():1,Q=a.tile.getBucket(this);if(q&&Q instanceof Yg){const _e=Q.centroidVertexArray,we=P+1;we<_e.length&&(U[0]=_e.geta_centroid_pos0(we),U[1]=_e.geta_centroid_pos1(we))}if(U[0]===0&&U[1]===1)return!1;v.projection.name==="globe"&&(d=PD([d],[new ue(0,0),new ue(Zt,Zt)],a.tileID.canonical).map(_e=>_e.polygon).flat());const oe=q?T:null,[de,xe]=function(_e,we,be,We,Fe,Qe,mt,Ke,ot,st,dt){return _e.projection.name==="globe"?function(_t,Je,Pt,Bt,kt,ar,bt,Gt,lr,Rr,cr){const Qt=[],an=[],ur=_t.projection.upVectorScale(cr,_t.center.lat,_t.worldSize).metersToTile,hr=[0,0,0,1],Xr=[0,0,0,1],rn=(Yr,xn,kn,Hn)=>{Yr[0]=xn,Yr[1]=kn,Yr[2]=Hn,Yr[3]=1},nn=AD();Pt>0&&(Pt+=nn),Bt+=nn;for(const Yr of Je){const xn=[],kn=[];for(const Hn of Yr){const Jr=Hn.x+kt.x,ri=Hn.y+kt.y,Kn=_t.projection.projectTilePoint(Jr,ri,cr),wn=_t.projection.upVector(cr,Hn.x,Hn.y);let jr=Pt,Zn=Bt;if(bt){const on=MD(Jr,ri,Pt,Bt,bt,Gt,lr,Rr);jr+=on.base,Zn+=on.top}Pt!==0?rn(hr,Kn.x+wn[0]*ur*jr,Kn.y+wn[1]*ur*jr,Kn.z+wn[2]*ur*jr):rn(hr,Kn.x,Kn.y,Kn.z),rn(Xr,Kn.x+wn[0]*ur*Zn,Kn.y+wn[1]*ur*Zn,Kn.z+wn[2]*ur*Zn),Fn(hr,hr,ar),Fn(Xr,Xr,ar),xn.push(new Tf(hr[0],hr[1],hr[2])),kn.push(new Tf(Xr[0],Xr[1],Xr[2]))}Qt.push(xn),an.push(kn)}return[Qt,an]}(_e,we,be,We,Fe,Qe,mt,Ke,ot,st,dt):mt?function(_t,Je,Pt,Bt,kt,ar,bt,Gt,lr){const Rr=[],cr=[],Qt=[0,0,0,1];for(const an of _t){const ur=[],hr=[];for(const Xr of an){const rn=Xr.x+Bt.x,nn=Xr.y+Bt.y,Yr=MD(rn,nn,Je,Pt,ar,bt,Gt,lr);Qt[0]=rn,Qt[1]=nn,Qt[2]=Yr.base,Qt[3]=1,Eh(Qt,Qt,kt),Qt[3]=Math.max(Qt[3],1e-5);const xn=new Tf(Qt[0]/Qt[3],Qt[1]/Qt[3],Qt[2]/Qt[3]);Qt[0]=rn,Qt[1]=nn,Qt[2]=Yr.top,Qt[3]=1,Eh(Qt,Qt,kt),Qt[3]=Math.max(Qt[3],1e-5);const kn=new Tf(Qt[0]/Qt[3],Qt[1]/Qt[3],Qt[2]/Qt[3]);ur.push(xn),hr.push(kn)}Rr.push(ur),cr.push(hr)}return[Rr,cr]}(we,be,We,Fe,Qe,mt,Ke,ot,st):function(_t,Je,Pt,Bt,kt){const ar=[],bt=[],Gt=kt[8]*Je,lr=kt[9]*Je,Rr=kt[10]*Je,cr=kt[11]*Je,Qt=kt[8]*Pt,an=kt[9]*Pt,ur=kt[10]*Pt,hr=kt[11]*Pt;for(const Xr of _t){const rn=[],nn=[];for(const Yr of Xr){const xn=Yr.x+Bt.x,kn=Yr.y+Bt.y,Hn=kt[0]*xn+kt[4]*kn+kt[12],Jr=kt[1]*xn+kt[5]*kn+kt[13],ri=kt[2]*xn+kt[6]*kn+kt[14],Kn=kt[3]*xn+kt[7]*kn+kt[15],wn=Hn+Gt,jr=Jr+lr,Zn=ri+Rr,on=Math.max(Kn+cr,1e-5),mo=Hn+Qt,Xn=Jr+an,Pi=ri+ur,pi=Math.max(Kn+hr,1e-5);rn.push(new Tf(wn/on,jr/on,Zn/on)),nn.push(new Tf(mo/pi,Xn/pi,Pi/pi))}ar.push(rn),bt.push(nn)}return[ar,bt]}(we,be,We,Fe,Qe)}(v,d,$,D,C,x,oe,U,K,v.center.lat,a.tileID.canonical),fe=a.queryGeometry;return function(_e,we,be){let We=1/0;tD(be,we)&&(We=OD(be,we[0]));for(let Fe=0;Fe<we.length;Fe++){const Qe=we[Fe],mt=_e[Fe];for(let Ke=0;Ke<Qe.length-1;Ke++){const ot=Qe[Ke],st=[ot,Qe[Ke+1],mt[Ke+1],mt[Ke],ot];eD(be,st)&&(We=Math.min(We,OD(be,st)))}}return We!==1/0&&We}(de,xe,fe.isPointQuery()?fe.screenBounds:fe.screenGeometry)}},line:class extends ga{constructor(a){super(a,ID),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(a){if(a==="line-gradient"){const i=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=i._styleExpression&&i._styleExpression.expression instanceof ng,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(a,i){super.recalculate(a,i),this.paint._values["line-floorwidth"]=RD.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,a)}createBucket(a){return new J0(a)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getProgramConfiguration(a){return new qc(this,a)}queryRadius(a){const i=a,c=DD(bf("line-width",this,i),bf("line-gap-width",this,i)),d=bf("line-offset",this,i);return c/2+Math.abs(d)+U0(this.paint.get("line-translate"))}queryIntersectsFeature(a,i,c,d,m,v){if(a.queryGeometry.isAboveHorizon)return!1;const x=oD(a.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),v.angle,a.pixelToTileUnitsFactor),T=a.pixelToTileUnitsFactor/2*DD(this.paint.get("line-width").evaluate(i,c),this.paint.get("line-gap-width").evaluate(i,c)),P=this.paint.get("line-offset").evaluate(i,c);return P&&(d=function(C,D){const $=[],U=new ue(0,0);for(let q=0;q<C.length;q++){const K=C[q],Q=[];for(let oe=0;oe<K.length;oe++){const de=K[oe],xe=K[oe+1],fe=oe===0?U:de.sub(K[oe-1])._unit()._perp(),_e=oe===K.length-1?U:xe.sub(de)._unit()._perp(),we=fe._add(_e)._unit();we._mult(1/(we.x*_e.x+we.y*_e.y)),Q.push(we._mult(D)._add(de))}$.push(Q)}return $}(d,P*a.pixelToTileUnitsFactor)),function(C,D,$){for(let U=0;U<D.length;U++){const q=D[U];if(C.length>=3){for(let K=0;K<q.length;K++)if(kh(C,q[K]))return!0}if(KH(C,q,$))return!0}return!1}(x,d,T)}isTileClipped(){return!0}},symbol:dx,background:class extends ga{constructor(a){super(a,z7)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}},raster:class extends ga{constructor(a){super(a,B7)}getProgramIds(){return["raster"]}},sky:class extends ga{constructor(a){super(a,$7),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(a){a==="sky-gradient"?this._updateColorRamp():a!=="sky-atmosphere-sun"&&a!=="sky-atmosphere-halo-color"&&a!=="sky-atmosphere-color"&&a!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=kT({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(a){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const i=a.style.light.properties.get("position");return this._lightPosition.azimuthal!==i.azimuthal||this._lightPosition.polar!==i.polar}return!1}getCenter(a,i){if(this.paint.get("sky-type")==="atmosphere"){const d=this.paint.get("sky-atmosphere-sun"),m=!d,v=a.style.light,x=v.properties.get("position");return m&&v.properties.get("anchor")==="viewport"&&Et("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),m?QT(x.azimuthal,90-x.polar,i):QT(d[0],90-d[1],i)}const c=this.paint.get("sky-gradient-center");return QT(c[0],90-c[1],i)}is3D(){return!1}isSky(){return!0}markSkyboxValid(a){this._skyboxInvalidated=!1,this._lightPosition=a.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const a=this.paint.get("sky-type");return a==="atmosphere"?["skyboxCapture","skybox"]:a==="gradient"?["skyboxGradient"]:null}}};class ly{constructor(i,c,d,m){this.context=i,this.format=d,this.texture=i.gl.createTexture(),this.update(c,m)}update(i,c,d){const{width:m,height:v}=i,{context:x}=this,{gl:T}=x,{HTMLImageElement:P,HTMLCanvasElement:C,HTMLVideoElement:D,ImageData:$,ImageBitmap:U}=y;if(T.bindTexture(T.TEXTURE_2D,this.texture),x.pixelStoreUnpackFlipY.set(!1),x.pixelStoreUnpack.set(1),x.pixelStoreUnpackPremultiplyAlpha.set(this.format===T.RGBA&&(!c||c.premultiply!==!1)),d||this.size&&this.size[0]===m&&this.size[1]===v){const{x:q,y:K}=d||{x:0,y:0};i instanceof P||i instanceof C||i instanceof D||i instanceof $||U&&i instanceof U?T.texSubImage2D(T.TEXTURE_2D,0,q,K,T.RGBA,T.UNSIGNED_BYTE,i):T.texSubImage2D(T.TEXTURE_2D,0,q,K,m,v,T.RGBA,T.UNSIGNED_BYTE,i.data)}else this.size=[m,v],i instanceof P||i instanceof C||i instanceof D||i instanceof $||U&&i instanceof U?T.texImage2D(T.TEXTURE_2D,0,this.format,this.format,T.UNSIGNED_BYTE,i):T.texImage2D(T.TEXTURE_2D,0,this.format,m,v,0,this.format,T.UNSIGNED_BYTE,i.data);this.useMipmap=!!(c&&c.useMipmap&&this.isSizePowerOfTwo()),this.useMipmap&&T.generateMipmap(T.TEXTURE_2D)}bind(i,c){const{context:d}=this,{gl:m}=d;m.bindTexture(m.TEXTURE_2D,this.texture),i!==this.filter&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MAG_FILTER,i),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MIN_FILTER,this.useMipmap?i===m.NEAREST?m.NEAREST_MIPMAP_NEAREST:m.LINEAR_MIPMAP_NEAREST:i),this.filter=i),c!==this.wrap&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_S,c),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_T,c),this.wrap=c)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:i}=this.context;i.deleteTexture(this.texture),this.texture=null}}class U7{constructor(i){this._callback=i,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class V7{constructor(){this.tasks={},this.taskQueue=[],Jt(["process"],this),this.invoker=new U7(this.process),this.nextId=0}add(i,c){const d=this.nextId++,m=function({type:v,isSymbolTile:x,zoom:T}){return T=T||0,v==="message"?0:v!=="maybePrepare"||x?v!=="parseTile"||x?v==="parseTile"&&x?300-T:v==="maybePrepare"&&x?400-T:500:200-T:100-T}(c);if(m===0){Gr();try{i()}finally{}return{cancel:()=>{}}}return this.tasks[d]={fn:i,metadata:c,priority:m,id:d},this.taskQueue.push(d),this.invoker.trigger(),{cancel:()=>{delete this.tasks[d]}}}process(){Gr();try{if(this.taskQueue=this.taskQueue.filter(d=>!!this.tasks[d]),!this.taskQueue.length)return;const i=this.pick();if(i===null)return;const c=this.tasks[i];if(delete this.tasks[i],this.taskQueue.length&&this.invoker.trigger(),!c)return;c.fn()}finally{}}pick(){let i=null,c=1/0;for(let m=0;m<this.taskQueue.length;m++){const v=this.tasks[this.taskQueue[m]];v.priority<c&&(c=v.priority,i=m)}if(i===null)return null;const d=this.taskQueue[i];return this.taskQueue.splice(i,1),d}remove(){this.invoker.remove()}}class vL{constructor(i){this._stringToNumber={},this._numberToString=[];for(let c=0;c<i.length;c++){const d=i[c];this._stringToNumber[d]=c,this._numberToString[c]=d}}encode(i){return this._stringToNumber[i]}decode(i){return this._numberToString[i]}}const G7=["tile","layer","source","sourceLayer","state"];class _L{constructor(i,c,d,m,v){this.type="Feature",this._vectorTileFeature=i,this._z=c,this._x=d,this._y=m,this.properties=i.properties,this.id=v}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(i){this._geometry=i}toJSON(){const i={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};this.id!==void 0&&(i.id=this.id);for(const c of G7)this[c]!==void 0&&(i[c]=this[c]);return i}}const $s=32,al=33,Jc=new Uint16Array(8184);for(let a=0;a<2046;a++){let i=a+2,c=0,d=0,m=0,v=0,x=0,T=0;for(1&i?m=v=x=$s:c=d=T=$s;(i>>=1)>1;){const C=c+m>>1,D=d+v>>1;1&i?(m=c,v=d,c=x,d=T):(c=m,d=v,m=x,v=T),x=C,T=D}const P=4*a;Jc[P+0]=c,Jc[P+1]=d,Jc[P+2]=m,Jc[P+3]=v}const ll=new Uint16Array(2178),Qc=new Uint8Array(1089),fx=new Uint16Array(1089);function xL(a){return a===0?-.03125:a===32?.03125:0}var bL=Ie([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);const wL={type:2,extent:Zt,loadGeometry:()=>[[new ue(0,0),new ue(Zt+1,0),new ue(Zt+1,Zt+1),new ue(0,Zt+1),new ue(0,0)]]};class eE{constructor(i,c,d,m,v){this.tileID=i,this.uid=Br(),this.uses=0,this.tileSize=c,this.tileZoom=d,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=v,this.expiredRequestCount=0,this.state="loading",m&&m.transform&&(this.projection=m.transform.projection)}registerFadeDuration(i){const c=i+this.timeAdded;c<nr.now()||this.fadeEndTime&&c<this.fadeEndTime||(this.fadeEndTime=c)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=Mh(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(i,c,d){if(this.unloadVectorData(),this.state="loaded",i){i.featureIndex&&(this.latestFeatureIndex=i.featureIndex,i.rawTileData?(this.latestRawTileData=i.rawTileData,this.latestFeatureIndex.rawTileData=i.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=i.collisionBoxArray,this.buckets=function(m,v){const x={};if(!v)return x;for(const T of m){const P=T.layerIds.map(C=>v.getLayer(C)).filter(Boolean);if(P.length!==0){T.layers=P,T.stateDependentLayerIds&&(T.stateDependentLayers=T.stateDependentLayerIds.map(C=>P.filter(D=>D.id===C)[0]));for(const C of P)x[C.id]=T}}return x}(i.buckets,c.style),this.hasSymbolBuckets=!1;for(const m in this.buckets){const v=this.buckets[m];if(v instanceof Yc){if(this.hasSymbolBuckets=!0,!d)break;v.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const m in this.buckets){const v=this.buckets[m];if(v instanceof Yc&&v.hasRTLText){this.hasRTLText=!0,I.isLoading()||I.isLoaded()||E()!=="deferred"||O();break}}this.queryPadding=0;for(const m in this.buckets){const v=this.buckets[m];this.queryPadding=Math.max(this.queryPadding,c.style.getLayer(m).queryRadius(v))}i.imageAtlas&&(this.imageAtlas=i.imageAtlas),i.glyphAtlasImage&&(this.glyphAtlasImage=i.glyphAtlasImage),i.lineAtlas&&(this.lineAtlas=i.lineAtlas)}else this.collisionBoxArray=new Kr}unloadVectorData(){if(this.hasData()){for(const i in this.buckets)this.buckets[i].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(i){return this.buckets[i.id]}upload(i){for(const d in this.buckets){const m=this.buckets[d];m.uploadPending()&&m.upload(i)}const c=i.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new ly(i,this.imageAtlas.image,c.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new ly(i,this.glyphAtlasImage,c.ALPHA),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new ly(i,this.lineAtlas.image,c.ALPHA),this.lineAtlas.uploaded=!0)}prepare(i){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(i,this.imageAtlasTexture)}queryRenderedFeatures(i,c,d,m,v,x,T,P){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({tileResult:m,pixelPosMatrix:T,transform:x,params:v,tileTransform:this.tileTransform},i,c,d):{}}querySourceFeatures(i,c){const d=this.latestFeatureIndex;if(!d||!d.rawTileData)return;const m=d.loadVTLayers(),v=c?c.sourceLayer:"",x=m._geojsonTileLayer||m[v];if(!x)return;const T=cf(c&&c.filter),{z:P,x:C,y:D}=this.tileID.canonical,$={z:P,x:C,y:D};for(let U=0;U<x.length;U++){const q=x.feature(U);if(T.needGeometry){const oe=Ch(q,!0);if(!T.filter(new N(this.tileID.overscaledZ),oe,this.tileID.canonical))continue}else if(!T.filter(new N(this.tileID.overscaledZ),q))continue;const K=d.getId(q,v),Q=new _L(q,P,C,D,K);Q.tile=$,i.push(Q)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(i){const c=this.expirationTime;if(i.cacheControl){const d=hn(i.cacheControl);d["max-age"]&&(this.expirationTime=Date.now()+1e3*d["max-age"])}else i.expires&&(this.expirationTime=new Date(i.expires).getTime());if(this.expirationTime){const d=Date.now();let m=!1;if(this.expirationTime>d)m=!1;else if(c)if(this.expirationTime<c)m=!0;else{const v=this.expirationTime-c;v?this.expirationTime=d+Math.max(v,3e4):m=!0}else m=!0;m?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(i,c){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(i).length===0||!c)return;const d=this.latestFeatureIndex.loadVTLayers(),m=c.style.listImages();for(const v in this.buckets){if(!c.style.hasLayer(v))continue;const x=this.buckets[v],T=x.layers[0].sourceLayer||"_geojsonTileLayer",P=d[T],C=i[T];if(!P||!C||Object.keys(C).length===0)continue;if(x.update(C,P,m,this.imageAtlas&&this.imageAtlas.patternPositions||{}),x instanceof J0||x instanceof H0){const $=c.style._getSourceCache(x.layers[0].source);c._terrain&&c._terrain.enabled&&$&&x.programConfigurations.needsUpload&&c._terrain._clearRenderCacheForTile($.id,this.tileID)}const D=c&&c.style&&c.style.getLayer(v);D&&(this.queryPadding=Math.max(this.queryPadding,D.queryRadius(x)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<nr.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(i){this.symbolFadeHoldUntil=nr.now()+i}setTexture(i,c){const d=c.context,m=d.gl;this.texture=this.texture||c.getTileTexture(i.width),this.texture?this.texture.update(i,{useMipmap:!0}):(this.texture=new ly(d,i,m.RGBA,{useMipmap:!0}),this.texture.bind(m.LINEAR,m.CLAMP_TO_EDGE))}setDependencies(i,c){const d={};for(const m of c)d[m]=!0;this.dependencies[i]=d}hasDependency(i,c){for(const d of i){const m=this.dependencies[d];if(m){for(const v of c)if(m[v])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(i,c){if(!c||c.name==="mercator"||this._tileDebugBuffer)return;const d=Gl(wL,this.tileID.canonical,this.tileTransform)[0],m=new pt,v=new Wo;for(let x=0;x<d.length;x++){const{x:T,y:P}=d[x];m.emplaceBack(T,P),v.emplaceBack(x)}v.emplaceBack(0),this._tileDebugIndexBuffer=i.createIndexBuffer(v),this._tileDebugBuffer=i.createVertexBuffer(m,$g.members),this._tileDebugSegments=Wn.simpleSegment(0,0,m.length,v.length)}_makeTileBoundsBuffers(i,c){if(this._tileBoundsBuffer||!c||c.name==="mercator")return;const d=Gl(wL,this.tileID.canonical,this.tileTransform)[0];let m,v;if(this.isRaster){const x=function(T,P){const C=Mh(T,P),D=Math.pow(2,T.z);for(let oe=0;oe<al;oe++)for(let de=0;de<al;de++){const xe=ps((T.x+(de+xL(de))/$s)/D),fe=Ui((T.y+(oe+xL(oe))/$s)/D),_e=P.project(xe,fe),we=oe*al+de;ll[2*we+0]=Math.round((_e.x*C.scale-C.x)*Zt),ll[2*we+1]=Math.round((_e.y*C.scale-C.y)*Zt)}Qc.fill(0),fx.fill(0);for(let oe=2045;oe>=0;oe--){const de=4*oe,xe=Jc[de+0],fe=Jc[de+1],_e=Jc[de+2],we=Jc[de+3],be=xe+_e>>1,We=fe+we>>1,Fe=be+We-fe,Qe=We+xe-be,mt=fe*al+xe,Ke=we*al+_e,ot=We*al+be,st=Math.hypot((ll[2*mt+0]+ll[2*Ke+0])/2-ll[2*ot+0],(ll[2*mt+1]+ll[2*Ke+1])/2-ll[2*ot+1])>=16;Qc[ot]=Qc[ot]||(st?1:0),oe<1022&&(Qc[ot]=Qc[ot]||Qc[(fe+Qe>>1)*al+(xe+Fe>>1)]||Qc[(we+Qe>>1)*al+(_e+Fe>>1)])}const $=new it,U=new Nt;let q=0;function K(oe,de){const xe=de*al+oe;return fx[xe]===0&&($.emplaceBack(ll[2*xe+0],ll[2*xe+1],oe*Zt/$s,de*Zt/$s),fx[xe]=++q),fx[xe]-1}function Q(oe,de,xe,fe,_e,we){const be=oe+xe>>1,We=de+fe>>1;if(Math.abs(oe-_e)+Math.abs(de-we)>1&&Qc[We*al+be])Q(_e,we,oe,de,be,We),Q(xe,fe,_e,we,be,We);else{const Fe=K(oe,de),Qe=K(xe,fe),mt=K(_e,we);U.emplaceBack(Fe,Qe,mt)}}return Q(0,0,$s,$s,$s,0),Q($s,$s,0,0,0,$s),{vertices:$,indices:U}}(this.tileID.canonical,c);m=x.vertices,v=x.indices}else{m=new it,v=new Nt;for(const{x:T,y:P}of d)m.emplaceBack(T,P,0,0);const x=DT(m.int16,void 0,4);for(let T=0;T<x.length;T+=3)v.emplaceBack(x[T],x[T+1],x[T+2])}this._tileBoundsBuffer=i.createVertexBuffer(m,bL.members),this._tileBoundsIndexBuffer=i.createIndexBuffer(v),this._tileBoundsSegments=Wn.simpleSegment(0,0,m.length,v.length)}_makeGlobeTileDebugBuffers(i,c){const d=c.projection;if(!d||d.name!=="globe"||c.freezeTileCoverage)return;const m=this.tileID.canonical,v=Vg(VR(m,c)),x=_f(c.zoom);let T;x>0&&(T=lT(new Float64Array(16),c.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(i,m,c,v,T,x),this._makeGlobeTileDebugTextBuffer(i,m,c,v,T,x)}_globePoint(i,c,d,m,v,x,T){let P=Ug(i,c,d);if(x){const C=1<<d.z,D=ol(m.center.lng),$=sl(m.center.lat),U=(d.x+.5)/C-D;let q=0;U>.5?q=-1:U<-.5&&(q=1);let K=(i/Zt+d.x)/C+q,Q=(c/Zt+d.y)/C;K=(K-D)*m._pixelsPerMercatorPixel+D,Q=(Q-$)*m._pixelsPerMercatorPixel+$;const oe=[K*m.worldSize,Q*m.worldSize,0];Fn(oe,oe,x),P=Ph(P,oe,T)}return Fn(P,P,v)}_makeGlobeTileDebugBorderBuffer(i,c,d,m,v,x){const T=new pt,P=new Wo,C=new $e,D=(U,q,K,Q,oe)=>{const de=(K-U)/(oe-1),xe=(Q-q)/(oe-1),fe=T.length;for(let _e=0;_e<oe;_e++){const we=U+_e*de,be=q+_e*xe;T.emplaceBack(we,be);const We=this._globePoint(we,be,c,d,m,v,x);C.emplaceBack(We[0],We[1],We[2]),P.emplaceBack(fe+_e)}},$=Zt;D(0,0,$,0,16),D($,0,$,$,16),D($,$,0,$,16),D(0,$,0,0,16),this._tileDebugIndexBuffer=i.createIndexBuffer(P),this._tileDebugBuffer=i.createVertexBuffer(T,$g.members),this._globeTileDebugBorderBuffer=i.createVertexBuffer(C,$R.members),this._tileDebugSegments=Wn.simpleSegment(0,0,T.length,P.length)}_makeGlobeTileDebugTextBuffer(i,c,d,m,v,x){const T=Zt/4,P=new pt,C=new Nt,D=new $e,$=25;C.reserve(32),P.reserve($),D.reserve($);const U=(q,K)=>$*q+K;for(let q=0;q<$;q++){const K=q*T;for(let Q=0;Q<$;Q++){const oe=Q*T;P.emplaceBack(oe,K);const de=this._globePoint(oe,K,c,d,m,v,x);D.emplaceBack(de[0],de[1],de[2])}}for(let q=0;q<4;q++)for(let K=0;K<4;K++){const Q=U(q,K),oe=U(q,K+1),de=U(q+1,K),xe=U(q+1,K+1);C.emplaceBack(Q,oe,de),C.emplaceBack(de,oe,xe)}this._tileDebugTextIndexBuffer=i.createIndexBuffer(C),this._tileDebugTextBuffer=i.createVertexBuffer(P,$g.members),this._globeTileDebugTextBuffer=i.createVertexBuffer(D,$R.members),this._tileDebugTextSegments=Wn.simpleSegment(0,0,$,32)}}class W7{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(i,c,d){const m=String(c);if(this.stateChanges[i]=this.stateChanges[i]||{},this.stateChanges[i][m]=this.stateChanges[i][m]||{},$t(this.stateChanges[i][m],d),this.deletedStates[i]===null){this.deletedStates[i]={};for(const v in this.state[i])v!==m&&(this.deletedStates[i][v]=null)}else if(this.deletedStates[i]&&this.deletedStates[i][m]===null){this.deletedStates[i][m]={};for(const v in this.state[i][m])d[v]||(this.deletedStates[i][m][v]=null)}else for(const v in d)this.deletedStates[i]&&this.deletedStates[i][m]&&this.deletedStates[i][m][v]===null&&delete this.deletedStates[i][m][v]}removeFeatureState(i,c,d){if(this.deletedStates[i]===null)return;const m=String(c);if(this.deletedStates[i]=this.deletedStates[i]||{},d&&c!==void 0)this.deletedStates[i][m]!==null&&(this.deletedStates[i][m]=this.deletedStates[i][m]||{},this.deletedStates[i][m][d]=null);else if(c!==void 0)if(this.stateChanges[i]&&this.stateChanges[i][m])for(d in this.deletedStates[i][m]={},this.stateChanges[i][m])this.deletedStates[i][m][d]=null;else this.deletedStates[i][m]=null;else this.deletedStates[i]=null}getState(i,c){const d=String(c),m=$t({},(this.state[i]||{})[d],(this.stateChanges[i]||{})[d]);if(this.deletedStates[i]===null)return{};if(this.deletedStates[i]){const v=this.deletedStates[i][c];if(v===null)return{};for(const x in v)delete m[x]}return m}initializeTileState(i,c){i.setFeatureState(this.state,c)}coalesceChanges(i,c){const d={};for(const m in this.stateChanges){this.state[m]=this.state[m]||{};const v={};for(const x in this.stateChanges[m])this.state[m][x]||(this.state[m][x]={}),$t(this.state[m][x],this.stateChanges[m][x]),v[x]=this.state[m][x];d[m]=v}for(const m in this.deletedStates){this.state[m]=this.state[m]||{};const v={};if(this.deletedStates[m]===null)for(const x in this.state[m])v[x]={},this.state[m][x]={};else for(const x in this.deletedStates[m]){if(this.deletedStates[m][x]===null)this.state[m][x]={};else if(this.state[m][x])for(const T of Object.keys(this.deletedStates[m][x]))delete this.state[m][x][T];v[x]=this.state[m][x]}d[m]=d[m]||{},$t(d[m],v)}if(this.stateChanges={},this.deletedStates={},Object.keys(d).length!==0)for(const m in i)i[m].setFeatureState(d,c)}}class SL{constructor(i){this.size=i,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(i,c){const d=this.toIdx(i,c);return{min:this.minimums[d],max:this.maximums[d]}}isLeaf(i,c){return this.leaves[this.toIdx(i,c)]}toIdx(i,c){return c*this.size+i}}function TL(a,i,c,d){let m=0,v=Number.MAX_VALUE;for(let x=0;x<3;x++)if(Math.abs(d[x])<1e-15){if(c[x]<a[x]||c[x]>i[x])return null}else{const T=1/d[x];let P=(a[x]-c[x])*T,C=(i[x]-c[x])*T;if(P>C){const D=P;P=C,C=D}if(P>m&&(m=P),C<v&&(v=C),m>v)return null}return m}function EL(a,i,c,d,m,v,x,T,P,C,D){const $=d-a,U=m-i,q=v-c,K=x-a,Q=T-i,oe=P-c,de=D[1]*oe-D[2]*Q,xe=D[2]*K-D[0]*oe,fe=D[0]*Q-D[1]*K,_e=$*de+U*xe+q*fe;if(Math.abs(_e)<1e-15)return null;const we=1/_e,be=C[0]-a,We=C[1]-i,Fe=C[2]-c,Qe=(be*de+We*xe+Fe*fe)*we;if(Qe<0||Qe>1)return null;const mt=We*q-Fe*U,Ke=Fe*$-be*q,ot=be*U-We*$,st=(D[0]*mt+D[1]*Ke+D[2]*ot)*we;return st<0||Qe+st>1?null:(K*mt+Q*Ke+oe*ot)*we}function AL(a,i,c){return(a-i)/(c-i)}function PL(a,i,c,d,m,v,x,T,P){const C=1<<c,D=v-d,$=x-m,U=(a+1)/C*D+d,q=(i+0)/C*$+m,K=(i+1)/C*$+m;T[0]=(a+0)/C*D+d,T[1]=q,P[0]=U,P[1]=K}class CL{constructor(i){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=i,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const c=function(v){const x=Math.ceil(Math.log2(v.dim/8)),T=[];let P=Math.ceil(Math.pow(2,x));const C=1/P,D=(q,K,Q,oe,de)=>{const xe=oe?1:0,fe=(q+1)*Q-xe,_e=K*Q,we=(K+1)*Q-xe;de[0]=q*Q,de[1]=_e,de[2]=fe,de[3]=we};let $=new SL(P);const U=[];for(let q=0;q<P*P;q++){D(q%P,Math.floor(q/P),C,!1,U);const K=eu(U[0],U[1],v),Q=eu(U[2],U[1],v),oe=eu(U[2],U[3],v),de=eu(U[0],U[3],v);$.minimums.push(Math.min(K,Q,oe,de)),$.maximums.push(Math.max(K,Q,oe,de)),$.leaves.push(1)}for(T.push($),P/=2;P>=1;P/=2){const q=T[T.length-1];$=new SL(P);for(let K=0;K<P*P;K++){D(K%P,Math.floor(K/P),2,!0,U);const Q=q.getElevation(U[0],U[1]),oe=q.getElevation(U[2],U[1]),de=q.getElevation(U[2],U[3]),xe=q.getElevation(U[0],U[3]),fe=q.isLeaf(U[0],U[1]),_e=q.isLeaf(U[2],U[1]),we=q.isLeaf(U[2],U[3]),be=q.isLeaf(U[0],U[3]),We=Math.min(Q.min,oe.min,de.min,xe.min),Fe=Math.max(Q.max,oe.max,de.max,xe.max),Qe=fe&&_e&&we&&be;$.maximums.push(Fe),$.minimums.push(We),$.leaves.push(Fe-We<=5&&Qe?1:0)}T.push($)}return T}(this.dem),d=c.length-1,m=c[d];this._addNode(m.minimums[0],m.maximums[0],m.leaves[0]),this._construct(c,0,0,d,0)}raycastRoot(i,c,d,m,v,x,T=1){return TL([i,c,-100],[d,m,this.maximums[0]*T],v,x)}raycast(i,c,d,m,v,x,T=1){if(!this.nodeCount)return null;const P=this.raycastRoot(i,c,d,m,v,x,T);if(P==null)return null;const C=[],D=[],$=[],U=[],q=[{idx:0,t:P,nodex:0,nodey:0,depth:0}];for(;q.length>0;){const{idx:K,t:Q,nodex:oe,nodey:de,depth:xe}=q.pop();if(this.leaves[K]){PL(oe,de,xe,i,c,d,m,$,U);const _e=1<<xe,we=(oe+0)/_e,be=(oe+1)/_e,We=(de+0)/_e,Fe=(de+1)/_e,Qe=eu(we,We,this.dem)*T,mt=eu(be,We,this.dem)*T,Ke=eu(be,Fe,this.dem)*T,ot=eu(we,Fe,this.dem)*T,st=EL($[0],$[1],Qe,U[0],$[1],mt,U[0],U[1],Ke,v,x),dt=EL(U[0],U[1],Ke,$[0],U[1],ot,$[0],$[1],Qe,v,x),_t=Math.min(st!==null?st:Number.MAX_VALUE,dt!==null?dt:Number.MAX_VALUE);if(_t!==Number.MAX_VALUE)return _t;{const Je=Bg([],v,x,Q);if(kL(Qe,mt,ot,Ke,AL(Je[0],$[0],U[0]),AL(Je[1],$[1],U[1]))>=Je[2])return Q}continue}let fe=0;for(let _e=0;_e<this._siblingOffset.length;_e++){PL((oe<<1)+this._siblingOffset[_e][0],(de<<1)+this._siblingOffset[_e][1],xe+1,i,c,d,m,$,U),$[2]=-100,U[2]=this.maximums[this.childOffsets[K]+_e]*T;const we=TL($,U,v,x);if(we!=null){const be=we;C[_e]=be;let We=!1;for(let Fe=0;Fe<fe&&!We;Fe++)be>=C[D[Fe]]&&(D.splice(Fe,0,_e),We=!0);We||(D[fe]=_e),fe++}}for(let _e=0;_e<fe;_e++){const we=D[_e];q.push({idx:this.childOffsets[K]+we,t:C[we],nodex:(oe<<1)+this._siblingOffset[we][0],nodey:(de<<1)+this._siblingOffset[we][1],depth:xe+1})}}return null}_addNode(i,c,d){return this.minimums.push(i),this.maximums.push(c),this.leaves.push(d),this.childOffsets.push(0),this.nodeCount++}_construct(i,c,d,m,v){if(i[m].isLeaf(c,d)===1)return;this.childOffsets[v]||(this.childOffsets[v]=this.nodeCount);const x=m-1,T=i[x];let P=0,C=0;for(let D=0;D<this._siblingOffset.length;D++){const $=2*c+this._siblingOffset[D][0],U=2*d+this._siblingOffset[D][1],q=T.getElevation($,U),K=T.isLeaf($,U),Q=this._addNode(q.min,q.max,K);K&&(P|=1<<D),C||(C=Q)}for(let D=0;D<this._siblingOffset.length;D++)P&1<<D||this._construct(i,2*c+this._siblingOffset[D][0],2*d+this._siblingOffset[D][1],x,C+D)}}function kL(a,i,c,d,m,v){return Or(Or(a,c,v),Or(i,d,v),m)}function eu(a,i,c){const d=c.dim,m=De(a*d-.5,0,d-1),v=De(i*d-.5,0,d-1),x=Math.floor(m),T=Math.floor(v),P=Math.min(x+1,d-1),C=Math.min(T+1,d-1);return kL(c.get(x,T),c.get(P,T),c.get(x,C),c.get(P,C),m-x,v-T)}const OL={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function q7(a,i,c){return(256*a*256+256*i+c)/10-1e4}function H7(a,i,c){return 256*a+i+c/256-32768}class px{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(i,c,d,m=!1,v=!1){if(this.uid=i,c.height!==c.width)throw new RangeError("DEM tiles must be square");if(d&&d!=="mapbox"&&d!=="terrarium")return Et(`"${d}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=c.height;const x=this.dim=c.height-2,T=new Uint32Array(c.data.buffer);if(this.pixels=new Uint8Array(c.data.buffer),this.encoding=d||"mapbox",this.borderReady=m,!m){for(let P=0;P<x;P++)T[this._idx(-1,P)]=T[this._idx(0,P)],T[this._idx(x,P)]=T[this._idx(x-1,P)],T[this._idx(P,-1)]=T[this._idx(P,0)],T[this._idx(P,x)]=T[this._idx(P,x-1)];T[this._idx(-1,-1)]=T[this._idx(0,0)],T[this._idx(x,-1)]=T[this._idx(x-1,0)],T[this._idx(-1,x)]=T[this._idx(0,x-1)],T[this._idx(x,x)]=T[this._idx(x-1,x-1)],v&&this._buildQuadTree()}}_buildQuadTree(){this._tree=new CL(this)}get(i,c,d=!1){d&&(i=De(i,-1,this.dim),c=De(c,-1,this.dim));const m=4*this._idx(i,c);return(this.encoding==="terrarium"?H7:q7)(this.pixels[m],this.pixels[m+1],this.pixels[m+2])}static getUnpackVector(i){return OL[i]}get unpackVector(){return OL[this.encoding]}_idx(i,c){if(i<-1||i>=this.dim+1||c<-1||c>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(c+1)*this.stride+(i+1)}static pack(i,c){const d=[0,0,0,0],m=px.getUnpackVector(c);let v=Math.floor((i+m[3])/m[2]);return d[2]=v%256,v=Math.floor(v/256),d[1]=v%256,v=Math.floor(v/256),d[0]=v,d}getPixels(){return new Ho({width:this.stride,height:this.stride},this.pixels)}backfillBorder(i,c,d){if(this.dim!==i.dim)throw new Error("dem dimension mismatch");let m=c*this.dim,v=c*this.dim+this.dim,x=d*this.dim,T=d*this.dim+this.dim;switch(c){case-1:m=v-1;break;case 1:v=m+1}switch(d){case-1:x=T-1;break;case 1:T=x+1}const P=-c*this.dim,C=-d*this.dim;for(let D=x;D<T;D++)for(let $=m;$<v;$++){const U=4*this._idx($,D),q=4*this._idx($+P,D+C);this.pixels[U+0]=i.pixels[q+0],this.pixels[U+1]=i.pixels[q+1],this.pixels[U+2]=i.pixels[q+2],this.pixels[U+3]=i.pixels[q+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}jt(px,"DEMData"),jt(CL,"DemMinMaxQuadTree",{omit:["dem"]});class K7{constructor(i,c){this.max=i,this.onRemove=c,this.reset()}reset(){for(const i in this.data)for(const c of this.data[i])c.timeout&&clearTimeout(c.timeout),this.onRemove(c.value);return this.data={},this.order=[],this}add(i,c,d){const m=i.wrapped().key;this.data[m]===void 0&&(this.data[m]=[]);const v={value:c,timeout:void 0};if(d!==void 0&&(v.timeout=setTimeout(()=>{this.remove(i,v)},d)),this.data[m].push(v),this.order.push(m),this.order.length>this.max){const x=this._getAndRemoveByKey(this.order[0]);x&&this.onRemove(x)}return this}has(i){return i.wrapped().key in this.data}getAndRemove(i){return this.has(i)?this._getAndRemoveByKey(i.wrapped().key):null}_getAndRemoveByKey(i){const c=this.data[i].shift();return c.timeout&&clearTimeout(c.timeout),this.data[i].length===0&&delete this.data[i],this.order.splice(this.order.indexOf(i),1),c.value}getByKey(i){const c=this.data[i];return c?c[0].value:null}get(i){return this.has(i)?this.data[i.wrapped().key][0].value:null}remove(i,c){if(!this.has(i))return this;const d=i.wrapped().key,m=c===void 0?0:this.data[d].indexOf(c),v=this.data[d][m];return this.data[d].splice(m,1),v.timeout&&clearTimeout(v.timeout),this.data[d].length===0&&delete this.data[d],this.onRemove(v.value),this.order.splice(this.order.indexOf(d),1),this}setMaxSize(i){for(this.max=i;this.order.length>this.max;){const c=this._getAndRemoveByKey(this.order[0]);c&&this.onRemove(c)}return this}filter(i){const c=[];for(const d in this.data)for(const m of this.data[d])i(m.value)||c.push(m);for(const d of c)this.remove(d.value.tileID,d)}}class Df{constructor(i,c,d){this.func=i,this.mask=c,this.range=d}}Df.ReadOnly=!1,Df.ReadWrite=!0,Df.disabled=new Df(519,Df.ReadOnly,[0,1]);const tE=7680;class rE{constructor(i,c,d,m,v,x){this.test=i,this.ref=c,this.mask=d,this.fail=m,this.depthFail=v,this.pass=x}}rE.disabled=new rE({func:519,mask:0},0,0,tE,tE,tE);class cl{constructor(i,c,d){this.blendFunction=i,this.blendColor=c,this.mask=d}}cl.Replace=[1,0],cl.disabled=new cl(cl.Replace,$n.transparent,[!1,!1,!1,!1]),cl.unblended=new cl(cl.Replace,$n.transparent,[!0,!0,!0,!0]),cl.alphaBlended=new cl([1,771],$n.transparent,[!0,!0,!0,!0]);const nE=1029,iE=2305;class wa{constructor(i,c,d){this.enable=i,this.mode=c,this.frontFace=d}}wa.disabled=new wa(!1,nE,iE),wa.backCCW=new wa(!0,nE,iE),wa.backCW=new wa(!0,nE,2304),wa.frontCW=new wa(!0,1028,2304),wa.frontCCW=new wa(!0,1028,iE);class Ih extends Si{constructor(i,c,d){super(),this.id=i,this._onlySymbols=d,c.on("data",m=>{m.dataType==="source"&&m.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&m.dataType==="source"&&m.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))}),c.on("error",()=>{this._sourceErrored=!0}),this._source=c,this._tiles={},this._cache=new K7(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=c.minTileCacheSize,this._maxTileCacheSize=c.maxTileCacheSize,this._loadedParentTiles={},this._coveredTiles={},this._state=new W7,this._isRaster=this._source.type==="raster"||this._source.type==="raster-dem"||this._source.type==="custom"&&this._source._dataType==="raster"}onAdd(i){this.map=i,this._minTileCacheSize=this._minTileCacheSize===void 0&&i?i._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=this._maxTileCacheSize===void 0&&i?i._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const i in this._tiles){const c=this._tiles[i];if(c.state!=="loaded"&&c.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const i=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,i&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(i,c){return i.isSymbolTile=this._onlySymbols,this._source.loadTile(i,c)}_unloadTile(i){if(this._source.unloadTile)return this._source.unloadTile(i,()=>{})}_abortTile(i){if(this._source.abortTile)return this._source.abortTile(i,()=>{})}serialize(){return this._source.serialize()}prepare(i){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const c in this._tiles){const d=this._tiles[c];d.upload(i),d.prepare(this.map.style.imageManager)}}getIds(){return Lt(this._tiles).map(i=>i.tileID).sort(ML).map(i=>i.key)}getRenderableIds(i){const c=[];for(const d in this._tiles)this._isIdRenderable(+d,i)&&c.push(this._tiles[d]);return i?c.sort((d,m)=>{const v=d.tileID,x=m.tileID,T=new ue(v.canonical.x,v.canonical.y)._rotate(this.transform.angle),P=new ue(x.canonical.x,x.canonical.y)._rotate(this.transform.angle);return v.overscaledZ-x.overscaledZ||P.y-T.y||P.x-T.x}).map(d=>d.tileID.key):c.map(d=>d.tileID).sort(ML).map(d=>d.key)}hasRenderableParent(i){const c=this.findLoadedParent(i,0);return!!c&&this._isIdRenderable(c.tileID.key)}_isIdRenderable(i,c){return this._tiles[i]&&this._tiles[i].hasData()&&!this._coveredTiles[i]&&(c||!this._tiles[i].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const i in this._tiles)this._tiles[i].state!=="errored"&&this._reloadTile(+i,"reloading")}}_reloadTile(i,c){const d=this._tiles[i];d&&(d.state!=="loading"&&(d.state=c),this._loadTile(d,this._tileLoaded.bind(this,d,i,c)))}_tileLoaded(i,c,d,m){if(m)if(i.state="errored",m.status!==404)this._source.fire(new Dr(m,{tile:i}));else if(this._source.type==="raster-dem"&&this.usedForTerrain&&this.map.painter.terrain){const v=this.map.painter.terrain;this.update(this.transform,v.getScaledDemTileSize(),!0),v.resetTileLookupCache(this.id)}else this.update(this.transform);else i.timeAdded=nr.now(),d==="expired"&&(i.refreshedUponExpiration=!0),this._setTileReloadTimer(c,i),this._source.type==="raster-dem"&&i.dem&&this._backfillDEM(i),this._state.initializeTileState(i,this.map?this.map.painter:null),this._source.fire(new tr("data",{dataType:"source",tile:i,coord:i.tileID,sourceCacheId:this.id}))}_backfillDEM(i){const c=this.getRenderableIds();for(let m=0;m<c.length;m++){const v=c[m];if(i.neighboringTiles&&i.neighboringTiles[v]){const x=this.getTileByID(v);d(i,x),d(x,i)}}function d(m,v){if(!m.dem||m.dem.borderReady)return;m.needsHillshadePrepare=!0,m.needsDEMTextureUpload=!0;let x=v.tileID.canonical.x-m.tileID.canonical.x;const T=v.tileID.canonical.y-m.tileID.canonical.y,P=Math.pow(2,m.tileID.canonical.z),C=v.tileID.key;x===0&&T===0||Math.abs(T)>1||(Math.abs(x)>1&&(Math.abs(x+P)===1?x+=P:Math.abs(x-P)===1&&(x-=P)),v.dem&&m.dem&&(m.dem.backfillBorder(v.dem,x,T),m.neighboringTiles&&m.neighboringTiles[C]&&(m.neighboringTiles[C].backfilled=!0)))}}getTile(i){return this.getTileByID(i.key)}getTileByID(i){return this._tiles[i]}_retainLoadedChildren(i,c,d,m){for(const v in this._tiles){let x=this._tiles[v];if(m[v]||!x.hasData()||x.tileID.overscaledZ<=c||x.tileID.overscaledZ>d)continue;let T=x.tileID;for(;x&&x.tileID.overscaledZ>c+1;){const C=x.tileID.scaledTo(x.tileID.overscaledZ-1);x=this._tiles[C.key],x&&x.hasData()&&(T=C)}let P=T;for(;P.overscaledZ>c;)if(P=P.scaledTo(P.overscaledZ-1),i[P.key]){m[T.key]=T;break}}}findLoadedParent(i,c){if(i.key in this._loadedParentTiles){const d=this._loadedParentTiles[i.key];return d&&d.tileID.overscaledZ>=c?d:null}for(let d=i.overscaledZ-1;d>=c;d--){const m=i.scaledTo(d),v=this._getLoadedTile(m);if(v)return v}}_getLoadedTile(i){const c=this._tiles[i.key];return c&&c.hasData()?c:this._cache.getByKey(this._source.reparseOverscaled?i.wrapped().key:i.canonical.key)}updateCacheSize(i,c){c=c||this._source.tileSize;const d=Math.ceil(i.width/c)+1,m=Math.ceil(i.height/c)+1,v=Math.floor(d*m*5),x=typeof this._minTileCacheSize=="number"?Math.max(this._minTileCacheSize,v):v,T=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,x):x;this._cache.setMaxSize(T)}handleWrapJump(i){const c=Math.round((i-(this._prevLng===void 0?i:this._prevLng))/360);if(this._prevLng=i,c){const d={};for(const m in this._tiles){const v=this._tiles[m];v.tileID=v.tileID.unwrapTo(v.tileID.wrap+c),d[v.tileID.key]=v}this._tiles=d;for(const m in this._timers)clearTimeout(this._timers[m]),delete this._timers[m];for(const m in this._tiles)this._setTileReloadTimer(+m,this._tiles[m])}}update(i,c,d){if(this.transform=i,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!d)return;let m;this.updateCacheSize(i,c),this.transform.projection.name!=="globe"&&this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?m=i.getVisibleUnwrappedCoordinates(this._source.tileID).map(T=>new po(T.canonical.z,T.wrap,T.canonical.z,T.canonical.x,T.canonical.y)):(m=i.coveringTiles({tileSize:c||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!d,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(m=m.filter(T=>this._source.hasTile(T)))):m=[];const v=this._updateRetainedTiles(m);if(IL(this._source.type)&&m.length!==0){const T={},P={},C=Object.keys(v);for(const $ of C){const U=v[$],q=this._tiles[$];if(!q||q.fadeEndTime&&q.fadeEndTime<=nr.now())continue;const K=this.findLoadedParent(U,Math.max(U.overscaledZ-Ih.maxOverzooming,this._source.minzoom));K&&(this._addTile(K.tileID),T[K.tileID.key]=K.tileID),P[$]=U}const D=m[m.length-1].overscaledZ;for(const $ in this._tiles){const U=this._tiles[$];if(v[$]||!U.hasData())continue;let q=U.tileID;for(;q.overscaledZ>D;){q=q.scaledTo(q.overscaledZ-1);const K=this._tiles[q.key];if(K&&K.hasData()&&P[q.key]){v[$]=U.tileID;break}}}for(const $ in T)v[$]||(this._coveredTiles[$]=!0,v[$]=T[$])}for(const T in v)this._tiles[T].clearFadeHold();const x=function(T,P){const C=[];for(const D in T)D in P||C.push(D);return C}(this._tiles,v);for(const T of x){const P=this._tiles[T];P.hasSymbolBuckets&&!P.holdingForFade()?P.setHoldDuration(this.map._fadeDuration):P.hasSymbolBuckets&&!P.symbolFadeFinished()||this._removeTile(+T)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const i in this._tiles)this._tiles[i].holdingForFade()&&this._removeTile(+i)}_updateRetainedTiles(i){const c={};if(i.length===0)return c;const d={},m=i.reduce((C,D)=>Math.min(C,D.overscaledZ),1/0),v=i[0].overscaledZ,x=Math.max(v-Ih.maxOverzooming,this._source.minzoom),T=Math.max(v+Ih.maxUnderzooming,this._source.minzoom),P={};for(const C of i){const D=this._addTile(C);c[C.key]=C,D.hasData()||m<this._source.maxzoom&&(P[C.key]=C)}this._retainLoadedChildren(P,m,T,c);for(const C of i){let D=this._tiles[C.key];if(D.hasData())continue;if(C.canonical.z>=this._source.maxzoom){const U=C.children(this._source.maxzoom)[0],q=this.getTile(U);if(q&&q.hasData()){c[U.key]=U;continue}}else{const U=C.children(this._source.maxzoom);if(c[U[0].key]&&c[U[1].key]&&c[U[2].key]&&c[U[3].key])continue}let $=D.wasRequested();for(let U=C.overscaledZ-1;U>=x;--U){const q=C.scaledTo(U);if(d[q.key]||(d[q.key]=!0,D=this.getTile(q),!D&&$&&(D=this._addTile(q)),D&&(c[q.key]=q,$=D.wasRequested(),D.hasData())))break}}return c}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const i in this._tiles){const c=[];let d,m=this._tiles[i].tileID;for(;m.overscaledZ>0;){if(m.key in this._loadedParentTiles){d=this._loadedParentTiles[m.key];break}c.push(m.key);const v=m.scaledTo(m.overscaledZ-1);if(d=this._getLoadedTile(v),d)break;m=v}for(const v of c)this._loadedParentTiles[v]=d}}_addTile(i){let c=this._tiles[i.key];if(c)return c;c=this._cache.getAndRemove(i),c&&(this._setTileReloadTimer(i.key,c),c.tileID=i,this._state.initializeTileState(c,this.map?this.map.painter:null),this._cacheTimers[i.key]&&(clearTimeout(this._cacheTimers[i.key]),delete this._cacheTimers[i.key],this._setTileReloadTimer(i.key,c)));const d=!!c;if(!d){const m=this.map?this.map.painter:null;c=new eE(i,this._source.tileSize*i.overscaleFactor(),this.transform.tileZoom,m,this._isRaster),this._loadTile(c,this._tileLoaded.bind(this,c,i.key,c.state))}return c?(c.uses++,this._tiles[i.key]=c,d||this._source.fire(new tr("dataloading",{tile:c,coord:c.tileID,dataType:"source"})),c):null}_setTileReloadTimer(i,c){i in this._timers&&(clearTimeout(this._timers[i]),delete this._timers[i]);const d=c.getExpiryTimeout();d&&(this._timers[i]=setTimeout(()=>{this._reloadTile(i,"expired"),delete this._timers[i]},d))}_removeTile(i){const c=this._tiles[i];c&&(c.uses--,delete this._tiles[i],this._timers[i]&&(clearTimeout(this._timers[i]),delete this._timers[i]),c.uses>0||(c.hasData()&&c.state!=="reloading"?this._cache.add(c.tileID,c,c.getExpiryTimeout()):(c.aborted=!0,this._abortTile(c),this._unloadTile(c))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const i in this._tiles)this._removeTile(+i);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(i,c,d){const m=[],v=this.transform;if(!v)return m;const x=v.projection.name==="globe",T=ol(v.center.lng);for(const P in this._tiles){const C=this._tiles[P];if(d&&C.clearQueryDebugViz(),C.holdingForFade())continue;let D;if(x){const $=C.tileID.canonical;if($.z===0){const U=[Math.abs(De(T,...cy($,-1))-T),Math.abs(De(T,...cy($,1))-T)];D=[0,2*U.indexOf(Math.min(...U))-1]}else{const U=[Math.abs(De(T,...cy($,-1))-T),Math.abs(De(T,...cy($,0))-T),Math.abs(De(T,...cy($,1))-T)];D=[U.indexOf(Math.min(...U))-1]}}else D=[0];for(const $ of D){const U=i.containsTile(C,v,c,$);U&&m.push(U)}}return m}getVisibleCoordinates(i){const c=this.getRenderableIds(i).map(d=>this._tiles[d].tileID);for(const d of c)d.projMatrix=this.transform.calculateProjMatrix(d.toUnwrapped());return c}hasTransition(){if(this._source.hasTransition())return!0;if(IL(this._source.type))for(const i in this._tiles){const c=this._tiles[i];if(c.fadeEndTime!==void 0&&c.fadeEndTime>=nr.now())return!0}return!1}setFeatureState(i,c,d){this._state.updateState(i=i||"_geojsonTileLayer",c,d)}removeFeatureState(i,c,d){this._state.removeFeatureState(i=i||"_geojsonTileLayer",c,d)}getFeatureState(i,c){return this._state.getState(i=i||"_geojsonTileLayer",c)}setDependencies(i,c,d){const m=this._tiles[i];m&&m.setDependencies(c,d)}reloadTilesForDependencies(i,c){for(const d in this._tiles)this._tiles[d].hasDependency(i,c)&&this._reloadTile(+d,"reloading");this._cache.filter(d=>!d.hasDependency(i,c))}_preloadTiles(i,c){if(!this._sourceLoaded){const T=()=>{this._sourceLoaded&&(this._source.off("data",T),this._preloadTiles(i,c))};return void this._source.on("data",T)}const d=new Map,m=Array.isArray(i)?i:[i],v=this.map.painter.terrain,x=this.usedForTerrain&&v?v.getScaledDemTileSize():this._source.tileSize;for(const T of m){const P=T.coveringTiles({tileSize:x,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const C of P)d.set(C.key,C);this.usedForTerrain&&T.updateElevation(!1)}at(Array.from(d.values()),(T,P)=>{const C=new eE(T,this._source.tileSize*T.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(C,D=>{this._source.type==="raster-dem"&&C.dem&&this._backfillDEM(C),P(D,C)})},c)}}function ML(a,i){const c=Math.abs(2*a.wrap)-+(a.wrap<0),d=Math.abs(2*i.wrap)-+(i.wrap<0);return a.overscaledZ-i.overscaledZ||d-c||i.canonical.y-a.canonical.y||i.canonical.x-a.canonical.x}function IL(a){return a==="raster"||a==="image"||a==="video"||a==="custom"}function cy(a,i){const c=1<<a.z;return[a.x/c+i,(a.x+1)/c+i]}Ih.maxOverzooming=10,Ih.maxUnderzooming=3;class mx{constructor(i,c,d){this._demTile=i,this._dem=this._demTile.dem,this._scale=c,this._offset=d}static create(i,c,d){const m=d||i.findDEMTileFor(c);if(!m||!m.dem)return;const v=m.dem,x=m.tileID,T=1<<c.canonical.z-x.canonical.z;return new mx(m,m.tileSize/Zt/T,[(c.canonical.x/T-x.canonical.x)*v.dim,(c.canonical.y/T-x.canonical.y)*v.dim])}tileCoordToPixel(i,c){const d=c*this._scale+this._offset[1],m=Math.floor(i*this._scale+this._offset[0]),v=Math.floor(d);return new ue(m,v)}getElevationAt(i,c,d,m){const v=i*this._scale+this._offset[0],x=c*this._scale+this._offset[1],T=Math.floor(v),P=Math.floor(x),C=this._dem;return m=!!m,d?Or(Or(C.get(T,P,m),C.get(T,P+1,m),x-P),Or(C.get(T+1,P,m),C.get(T+1,P+1,m),x-P),v-T):C.get(T,P,m)}getElevationAtPixel(i,c,d){return this._dem.get(i,c,!!d)}getMeterToDEM(i){return(1<<this._demTile.tileID.canonical.z)*_a(1,i)*this._dem.stride}}class RL{constructor(i,c){this.tileID=i,this.x=i.canonical.x,this.y=i.canonical.y,this.z=i.canonical.z,this.grid=new zl(Zt,16,0),this.featureIndexArray=new xh,this.promoteId=c}insert(i,c,d,m,v,x=0){const T=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(d,m,v,x);const P=this.grid;for(let C=0;C<c.length;C++){const D=c[C],$=[1/0,1/0,-1/0,-1/0];for(let U=0;U<D.length;U++){const q=D[U];$[0]=Math.min($[0],q.x),$[1]=Math.min($[1],q.y),$[2]=Math.max($[2],q.x),$[3]=Math.max($[3],q.y)}$[0]<Zt&&$[1]<Zt&&$[2]>=0&&$[3]>=0&&P.insert(T,$[0],$[1],$[2],$[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new BT(new tx(this.rawTileData)).layers,this.sourceLayerCoder=new vL(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const i in this.vtLayers)this.vtFeatures[i]=[]}return this.vtLayers}query(i,c,d,m){this.loadVTLayers();const v=i.params||{},x=cf(v.filter),T=i.tileResult,P=i.transform,C=T.bufferedTilespaceBounds,D=this.grid.query(C.min.x,C.min.y,C.max.x,C.max.y,(K,Q,oe,de)=>iD(T.bufferedTilespaceGeometry,K,Q,oe,de));D.sort(Z7);let $=null;P.elevation&&D.length>0&&($=mx.create(P.elevation,this.tileID));const U={};let q;for(let K=0;K<D.length;K++){const Q=D[K];if(Q===q)continue;q=Q;const oe=this.featureIndexArray.get(Q);let de=null;this.loadMatchingFeature(U,oe,x,v.layers,v.availableImages,c,d,m,(xe,fe,_e,we=0)=>(de||(de=Gl(xe,this.tileID.canonical,i.tileTransform)),fe.queryIntersectsFeature(T,xe,_e,de,this.z,i.transform,i.pixelPosMatrix,$,we)))}return U}loadMatchingFeature(i,c,d,m,v,x,T,P,C){const{featureIndex:D,bucketIndex:$,sourceLayerIndex:U,layoutVertexArrayOffset:q}=c,K=this.bucketLayerIDs[$];if(m&&!function(xe,fe){for(let _e=0;_e<xe.length;_e++)if(fe.indexOf(xe[_e])>=0)return!0;return!1}(m,K))return;const Q=this.sourceLayerCoder.decode(U),oe=this.vtLayers[Q].feature(D);if(d.needGeometry){const xe=Ch(oe,!0);if(!d.filter(new N(this.tileID.overscaledZ),xe,this.tileID.canonical))return}else if(!d.filter(new N(this.tileID.overscaledZ),oe))return;const de=this.getId(oe,Q);for(let xe=0;xe<K.length;xe++){const fe=K[xe];if(m&&m.indexOf(fe)<0)continue;const _e=x[fe];if(!_e)continue;let we={};de!==void 0&&P&&(we=P.getState(_e.sourceLayer||"_geojsonTileLayer",de));const be=$t({},T[fe]);be.paint=DL(be.paint,_e.paint,oe,we,v),be.layout=DL(be.layout,_e.layout,oe,we,v);const We=!C||C(oe,_e,we,q);if(!We)continue;const Fe=new _L(oe,this.z,this.x,this.y,de);Fe.layer=be;let Qe=i[fe];Qe===void 0&&(Qe=i[fe]=[]),Qe.push({featureIndex:D,feature:Fe,intersectionZ:We})}}lookupSymbolFeatures(i,c,d,m,v,x,T,P){const C={};this.loadVTLayers();const D=cf(v);for(const $ of i)this.loadMatchingFeature(C,{bucketIndex:d,sourceLayerIndex:m,featureIndex:$,layoutVertexArrayOffset:0},D,x,T,P,c);return C}loadFeature(i){const{featureIndex:c,sourceLayerIndex:d}=i;this.loadVTLayers();const m=this.sourceLayerCoder.decode(d),v=this.vtFeatures[m];if(v[c])return v[c];const x=this.vtLayers[m].feature(c);return v[c]=x,x}hasLayer(i){for(const c of this.bucketLayerIDs)for(const d of c)if(i===d)return!0;return!1}getId(i,c){let d=i.id;if(this.promoteId){const m=typeof this.promoteId=="string"?this.promoteId:this.promoteId[c];m!=null&&(d=i.properties[m]),typeof d=="boolean"&&(d=Number(d))}return d}}function DL(a,i,c,d,m){return Le(a,(v,x)=>{const T=i instanceof he?i.get(x):null;return T&&T.evaluate?T.evaluate(c,d,m):T})}function Z7(a,i){return i-a}jt(RL,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});class LL{constructor(i,c){this.width=i,this.height=c,this.nextRow=0,this.image=new Wl({width:i,height:c}),this.positions={},this.uploaded=!1}getDash(i,c){const d=this.getKey(i,c);return this.positions[d]}trim(){const i=this.width,c=this.height=Vr(this.nextRow);this.image.resize({width:i,height:c})}getKey(i,c){return i.join(",")+c}getDashRanges(i,c,d){const m=[];let v=i.length%2==1?-i[i.length-1]*d:0,x=i[0]*d,T=!0;m.push({left:v,right:x,isDash:T,zeroLength:i[0]===0});let P=i[0];for(let C=1;C<i.length;C++){T=!T;const D=i[C];v=P*d,P+=D,x=P*d,m.push({left:v,right:x,isDash:T,zeroLength:D===0})}return m}addRoundDash(i,c,d){const m=c/2;for(let v=-d;v<=d;v++){const x=this.width*(this.nextRow+d+v);let T=0,P=i[T];for(let C=0;C<this.width;C++){C/P.right>1&&(P=i[++T]);const D=Math.abs(C-P.left),$=Math.abs(C-P.right),U=Math.min(D,$);let q;const K=v/d*(m+1);if(P.isDash){const Q=m-Math.abs(K);q=Math.sqrt(U*U+Q*Q)}else q=m-Math.sqrt(U*U+K*K);this.image.data[x+C]=Math.max(0,Math.min(255,q+128))}}}addRegularDash(i,c){for(let P=i.length-1;P>=0;--P){const C=i[P],D=i[P+1];C.zeroLength?i.splice(P,1):D&&D.isDash===C.isDash&&(D.left=C.left,i.splice(P,1))}const d=i[0],m=i[i.length-1];d.isDash===m.isDash&&(d.left=m.left-this.width,m.right=d.right+this.width);const v=this.width*this.nextRow;let x=0,T=i[x];for(let P=0;P<this.width;P++){P/T.right>1&&(T=i[++x]);const C=Math.abs(P-T.left),D=Math.abs(P-T.right),$=Math.min(C,D);this.image.data[v+P]=Math.max(0,Math.min(255,(T.isDash?$:-$)+c+128))}}addDash(i,c){const d=this.getKey(i,c);if(this.positions[d])return this.positions[d];const m=c==="round",v=m?7:0,x=2*v+1;if(this.nextRow+x>this.height)return Et("LineAtlas out of space"),null;i.length===0&&i.push(1);let T=0;for(let D=0;D<i.length;D++)i[D]<0&&(Et("Negative value is found in line dasharray, replacing values with 0"),i[D]=0),T+=i[D];if(T!==0){const D=this.width/T,$=this.getDashRanges(i,this.width,D);m?this.addRoundDash($,D,v):this.addRegularDash($,c==="square"?.5*D:0)}const P=this.nextRow+v;this.nextRow+=x;const C={tl:[P,v],br:[T,0]};return this.positions[d]=C,C}}jt(LL,"LineAtlas");const jL=1*ba;class zL{constructor(i){const c={},d=[];for(const T in i){const P=i[T],C=c[T]={};for(const D in P.glyphs){const $=P.glyphs[+D];if(!$||$.bitmap.width===0||$.bitmap.height===0)continue;const U=$.metrics.localGlyph?jL:1,q={x:0,y:0,w:$.bitmap.width+2*U,h:$.bitmap.height+2*U};d.push(q),C[D]=q}}const{w:m,h:v}=UT(d),x=new Wl({width:m||1,height:v||1});for(const T in i){const P=i[T];for(const C in P.glyphs){const D=P.glyphs[+C];if(!D||D.bitmap.width===0||D.bitmap.height===0)continue;const $=c[T][C],U=D.metrics.localGlyph?jL:1;Wl.copy(D.bitmap,x,{x:0,y:0},{x:$.x+U,y:$.y+U},D.bitmap)}}this.image=x,this.positions=c}}jt(zL,"GlyphAtlas");class X7{constructor(i){this.tileID=new po(i.tileID.overscaledZ,i.tileID.wrap,i.tileID.canonical.z,i.tileID.canonical.x,i.tileID.canonical.y),this.tileZoom=i.tileZoom,this.uid=i.uid,this.zoom=i.zoom,this.canonical=i.tileID.canonical,this.pixelRatio=i.pixelRatio,this.tileSize=i.tileSize,this.source=i.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=i.showCollisionBoxes,this.collectResourceTiming=!!i.collectResourceTiming,this.returnDependencies=!!i.returnDependencies,this.promoteId=i.promoteId,this.enableTerrain=!!i.enableTerrain,this.isSymbolTile=i.isSymbolTile,this.tileTransform=Mh(i.tileID.canonical,i.projection),this.projection=i.projection}parse(i,c,d,m,v){this.status="parsing",this.data=i,this.collisionBoxArray=new Kr;const x=new vL(Object.keys(i.layers).sort()),T=new RL(this.tileID,this.promoteId);T.bucketLayerIDs=[];const P={},C=new LL(256,256),D={featureIndex:T,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:C,availableImages:d},$=c.familiesBySource[this.source];for(const we in $){const be=i.layers[we];if(!be)continue;let We=!1,Fe=!1;for(const Ke of $[we])Ke[0].type==="symbol"?We=!0:Fe=!0;if(this.isSymbolTile===!0&&!We||this.isSymbolTile===!1&&!Fe)continue;be.version===1&&Et(`Vector tile source "${this.source}" layer "${we}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Qe=x.encode(we),mt=[];for(let Ke=0;Ke<be.length;Ke++){const ot=be.feature(Ke),st=T.getId(ot,we);mt.push({feature:ot,id:st,index:Ke,sourceLayerIndex:Qe})}for(const Ke of $[we]){const ot=Ke[0];this.isSymbolTile!==void 0&&ot.type==="symbol"!==this.isSymbolTile||ot.minzoom&&this.zoom<Math.floor(ot.minzoom)||ot.maxzoom&&this.zoom>=ot.maxzoom||ot.visibility!=="none"&&(oE(Ke,this.zoom,d),(P[ot.id]=ot.createBucket({index:T.bucketLayerIDs.length,layers:Ke,zoom:this.zoom,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Qe,sourceID:this.source,enableTerrain:this.enableTerrain,projection:this.projection.spec,availableImages:d})).populate(mt,D,this.tileID.canonical,this.tileTransform),T.bucketLayerIDs.push(Ke.map(st=>st.id)))}}let U,q,K,Q;C.trim();const oe={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},de=()=>{if(U)return v(U);if(q&&K&&Q){const we=new zL(q),be=new GD(K,Q);for(const We in P){const Fe=P[We];Fe instanceof Yc?(oE(Fe.layers,this.zoom,d),w7(Fe,q,we.positions,K,be.iconPositions,this.showCollisionBoxes,d,this.tileID.canonical,this.tileZoom,this.projection)):Fe.hasPattern&&(Fe instanceof J0||Fe instanceof H0||Fe instanceof Yg)&&(oE(Fe.layers,this.zoom,d),Fe.addFeatures(D,this.tileID.canonical,be.patternPositions,d,this.tileTransform))}this.status="done",v(null,{buckets:Lt(P).filter(We=>!We.isEmpty()),featureIndex:T,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:we.image,lineAtlas:C,imageAtlas:be,glyphMap:this.returnDependencies?q:null,iconMap:this.returnDependencies?K:null,glyphPositions:this.returnDependencies?we.positions:null})}},xe=Le(D.glyphDependencies,we=>Object.keys(we).map(Number));Object.keys(xe).length?m.send("getGlyphs",{uid:this.uid,stacks:xe},(we,be)=>{U||(U=we,q=be,de())},void 0,!1,oe):q={};const fe=Object.keys(D.iconDependencies);fe.length?m.send("getImages",{icons:fe,source:this.source,tileID:this.tileID,type:"icons"},(we,be)=>{U||(U=we,K=be,de())},void 0,!1,oe):K={};const _e=Object.keys(D.patternDependencies);_e.length?m.send("getImages",{icons:_e,source:this.source,tileID:this.tileID,type:"patterns"},(we,be)=>{U||(U=we,Q=be,de())},void 0,!1,oe):Q={},de()}}function oE(a,i,c){const d=new N(i);for(const m of a)m.recalculate(d,c)}class BL{constructor(i){this.entries={},this.scheduler=i}request(i,c,d,m){const v=this.entries[i]=this.entries[i]||{callbacks:[]};if(v.result){const[x,T]=v.result;return this.scheduler?this.scheduler.add(()=>{m(x,T)},c):m(x,T),()=>{}}return v.callbacks.push(m),v.cancel||(v.cancel=d((x,T)=>{v.result=[x,T];for(const P of v.callbacks)this.scheduler?this.scheduler.add(()=>{P(x,T)},c):P(x,T);setTimeout(()=>delete this.entries[i],3e3)})),()=>{v.result||(v.callbacks=v.callbacks.filter(x=>x!==m),v.callbacks.length||(v.cancel(),delete this.entries[i]))}}}function NL(a,i,c){const d=JSON.stringify(a.request);return a.data&&(this.deduped.entries[d]={result:[null,a.data]}),this.deduped.request(d,{type:"parseTile",isSymbolTile:a.isSymbolTile,zoom:a.tileZoom},m=>{const v=cs(a.request,(x,T,P,C)=>{x?m(x):T&&m(null,{vectorTile:c?void 0:new BT(new tx(T)),rawData:T,cacheControl:P,expires:C})});return()=>{v.cancel(),m()}},i)}const $L=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class sE{static from(i){if(!(i instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[c,d]=new Uint8Array(i,0,2);if(c!==219)throw new Error("Data does not appear to be in a KDBush format.");const m=d>>4;if(m!==1)throw new Error(`Got v${m} data when expected v1.`);const v=$L[15&d];if(!v)throw new Error("Unrecognized array type.");const[x]=new Uint16Array(i,2,1),[T]=new Uint32Array(i,4,1);return new sE(T,x,v,i)}constructor(i,c=64,d=Float64Array,m){if(isNaN(i)||i<0)throw new Error(`Unpexpected numItems value: ${i}.`);this.numItems=+i,this.nodeSize=Math.min(Math.max(+c,2),65535),this.ArrayType=d,this.IndexArrayType=i<65536?Uint16Array:Uint32Array;const v=$L.indexOf(this.ArrayType),x=2*i*this.ArrayType.BYTES_PER_ELEMENT,T=i*this.IndexArrayType.BYTES_PER_ELEMENT,P=(8-T%8)%8;if(v<0)throw new Error(`Unexpected typed array class: ${d}.`);m&&m instanceof ArrayBuffer?(this.data=m,this.ids=new this.IndexArrayType(this.data,8,i),this.coords=new this.ArrayType(this.data,8+T+P,2*i),this._pos=2*i,this._finished=!0):(this.data=new ArrayBuffer(8+x+T+P),this.ids=new this.IndexArrayType(this.data,8,i),this.coords=new this.ArrayType(this.data,8+T+P,2*i),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+v]),new Uint16Array(this.data,2,1)[0]=c,new Uint32Array(this.data,4,1)[0]=i)}add(i,c){const d=this._pos>>1;return this.ids[d]=d,this.coords[this._pos++]=i,this.coords[this._pos++]=c,d}finish(){const i=this._pos>>1;if(i!==this.numItems)throw new Error(`Added ${i} items when expected ${this.numItems}.`);return aE(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(i,c,d,m){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:v,coords:x,nodeSize:T}=this,P=[0,v.length-1,0],C=[];for(;P.length;){const D=P.pop()||0,$=P.pop()||0,U=P.pop()||0;if($-U<=T){for(let oe=U;oe<=$;oe++){const de=x[2*oe],xe=x[2*oe+1];de>=i&&de<=d&&xe>=c&&xe<=m&&C.push(v[oe])}continue}const q=U+$>>1,K=x[2*q],Q=x[2*q+1];K>=i&&K<=d&&Q>=c&&Q<=m&&C.push(v[q]),(D===0?i<=K:c<=Q)&&(P.push(U),P.push(q-1),P.push(1-D)),(D===0?d>=K:m>=Q)&&(P.push(q+1),P.push($),P.push(1-D))}return C}within(i,c,d){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:m,coords:v,nodeSize:x}=this,T=[0,m.length-1,0],P=[],C=d*d;for(;T.length;){const D=T.pop()||0,$=T.pop()||0,U=T.pop()||0;if($-U<=x){for(let oe=U;oe<=$;oe++)UL(v[2*oe],v[2*oe+1],i,c)<=C&&P.push(m[oe]);continue}const q=U+$>>1,K=v[2*q],Q=v[2*q+1];UL(K,Q,i,c)<=C&&P.push(m[q]),(D===0?i-d<=K:c-d<=Q)&&(T.push(U),T.push(q-1),T.push(1-D)),(D===0?i+d>=K:c+d>=Q)&&(T.push(q+1),T.push($),T.push(1-D))}return P}}function aE(a,i,c,d,m,v){if(m-d<=c)return;const x=d+m>>1;FL(a,i,x,d,m,v),aE(a,i,c,d,x-1,1-v),aE(a,i,c,x+1,m,1-v)}function FL(a,i,c,d,m,v){for(;m>d;){if(m-d>600){const C=m-d+1,D=c-d+1,$=Math.log(C),U=.5*Math.exp(2*$/3),q=.5*Math.sqrt($*U*(C-U)/C)*(D-C/2<0?-1:1);FL(a,i,c,Math.max(d,Math.floor(c-D*U/C+q)),Math.min(m,Math.floor(c+(C-D)*U/C+q)),v)}const x=i[2*c+v];let T=d,P=m;for(uy(a,i,d,c),i[2*m+v]>x&&uy(a,i,d,m);T<P;){for(uy(a,i,T,P),T++,P--;i[2*T+v]<x;)T++;for(;i[2*P+v]>x;)P--}i[2*d+v]===x?uy(a,i,d,P):(P++,uy(a,i,P,m)),P<=c&&(d=P+1),c<=P&&(m=P-1)}}function uy(a,i,c,d){lE(a,c,d),lE(i,2*c,2*d),lE(i,2*c+1,2*d+1)}function lE(a,i,c){const d=a[i];a[i]=a[c],a[c]=d}function UL(a,i,c,d){const m=a-c,v=i-d;return m*m+v*v}s.ARRAY_TYPE=qo,s.AUTH_ERR_MSG=Se,s.Aabb=fo,s.Actor=class{constructor(a,i,c){this.target=a,this.parent=i,this.mapId=c,this.callbacks={},this.cancelCallbacks={},Jt(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.globalScope=Gr()?a:y,this.scheduler=new V7}send(a,i,c,d,m=!1,v){const x=Math.round(1e18*Math.random()).toString(36).substring(0,10);c&&(c.metadata=v,this.callbacks[x]=c);const T=jn(this.globalScope)?void 0:[];return this.target.postMessage({id:x,type:a,hasCallback:!!c,targetMapId:d,mustQueue:m,sourceMapId:this.mapId,data:Vc(i,T)},T),{cancel:()=>{c&&delete this.callbacks[x],this.target.postMessage({id:x,type:"<cancel>",targetMapId:d,sourceMapId:this.mapId})}}}receive(a){const i=a.data,c=i.id;if(c&&(!i.targetMapId||this.mapId===i.targetMapId))if(i.type==="<cancel>"){const d=this.cancelCallbacks[c];delete this.cancelCallbacks[c],d&&d.cancel()}else if(i.mustQueue||Gr()){const d=this.callbacks[c];this.cancelCallbacks[c]=this.scheduler.add(()=>this.processTask(c,i),d&&d.metadata||{type:"message"})}else this.processTask(c,i)}processTask(a,i){if(i.type==="<response>"){const c=this.callbacks[a];delete this.callbacks[a],c&&(i.error?c(Bl(i.error)):c(null,Bl(i.data)))}else{const c=jn(this.globalScope)?void 0:[],d=i.hasCallback?(v,x)=>{delete this.cancelCallbacks[a],this.target.postMessage({id:a,type:"<response>",sourceMapId:this.mapId,error:v?Vc(v):null,data:Vc(x,c)},c)}:v=>{},m=Bl(i.data);if(this.parent[i.type])this.parent[i.type](i.sourceMapId,m,d);else if(this.parent.getWorkerSource){const v=i.type.split(".");this.parent.getWorkerSource(i.sourceMapId,v[0],m.source)[v[1]](m,d)}else d(new Error(`Could not find function ${i.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}},s.CanonicalTileID=Y0,s.Color=$n,s.ColorMode=cl,s.CullFaceMode=wa,s.DEMData=px,s.DataConstantProperty=J,s.DedupedRequest=BL,s.DepthMode=Df,s.EXTENT=Zt,s.Elevation=class{isDataAvailableAtPoint(a){const i=this._source();if(this.isUsingMockSource()||!i||a.y<0||a.y>1)return!1;const c=i.getSource().maxzoom,d=1<<c,m=Math.floor(a.x),v=Math.floor((a.x-m)*d),x=Math.floor(a.y*d),T=this.findDEMTileFor(new po(c,m,c,v,x));return!(!T||!T.dem)}getAtPointOrZero(a,i=0){return this.getAtPoint(a,i)||0}getAtPoint(a,i,c=!0){if(this.isUsingMockSource())return null;i==null&&(i=null);const d=this._source();if(!d||a.y<0||a.y>1)return i;const m=d.getSource().maxzoom,v=1<<m,x=Math.floor(a.x),T=a.x-x,P=new po(m,x,m,Math.floor(T*v),Math.floor(a.y*v)),C=this.findDEMTileFor(P);if(!C||!C.dem)return i;const D=C.dem,$=1<<C.tileID.canonical.z,U=(T*$-C.tileID.canonical.x)*D.dim,q=(a.y*$-C.tileID.canonical.y)*D.dim,K=Math.floor(U),Q=Math.floor(q);return(c?this.exaggeration():1)*Or(Or(D.get(K,Q),D.get(K,Q+1),q-Q),Or(D.get(K+1,Q),D.get(K+1,Q+1),q-Q),U-K)}getAtTileOffset(a,i,c){const d=1<<a.canonical.z;return this.getAtPointOrZero(new xf(a.wrap+(a.canonical.x+i/Zt)/d,(a.canonical.y+c/Zt)/d))}getAtTileOffsetFunc(a,i,c,d){return m=>{const v=this.getAtTileOffset(a,m.x,m.y),x=d.upVector(a.canonical,m.x,m.y);return fs(x,x,v*d.upVectorScale(a.canonical,i,c).metersToTile),x}}getForTilePoints(a,i,c,d){if(this.isUsingMockSource())return!1;const m=mx.create(this,a,d);return!!m&&(i.forEach(v=>{v[2]=this.exaggeration()*m.getElevationAt(v[0],v[1],c)}),!0)}getMinMaxForTile(a){if(this.isUsingMockSource())return null;const i=this.findDEMTileFor(a);if(!i||!i.dem)return null;const c=i.dem.tree,d=i.tileID,m=1<<a.canonical.z-d.canonical.z;let v=a.canonical.x/m-d.canonical.x,x=a.canonical.y/m-d.canonical.y,T=0;for(let P=0;P<a.canonical.z-d.canonical.z&&!c.leaves[T];P++){v*=2,x*=2;const C=2*Math.floor(x)+Math.floor(v);T=c.childOffsets[T]+C,v%=1,x%=1}return{min:this.exaggeration()*c.minimums[T],max:this.exaggeration()*c.maximums[T]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(a,i,c){throw new Error("Pure virtual method called.")}pointCoordinate(a){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(a){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}},s.ErrorEvent=Dr,s.EvaluationParameters=N,s.Event=tr,s.Evented=Si,s.FillExtrusionBucket=Yg,s.Frustum=mT,s.FrustumCorners=pT,s.GLOBE_RADIUS=nl,s.GLOBE_SCALE_MATCH_LATITUDE=45,s.GLOBE_ZOOM_THRESHOLD_MAX=FR,s.GLOBE_ZOOM_THRESHOLD_MIN=gT,s.GlobeSharedBuffers=class{constructor(a){this._createGrid(a),this._createPoles(a)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const a of this._poleSegments)a.destroy();for(const a of this._gridSegments)a.withSkirts.destroy(),a.withoutSkirts.destroy();if(this._wireframeIndexBuffer){this._wireframeIndexBuffer.destroy();for(const a of this._wireframeSegments)a.destroy()}}_fillGridMeshWithLods(a,i){const c=new pt,d=new Nt,m=[],v=a+1+2,x=i[0]+1,T=i[0]+1+(1+i.length),P=(C,D,$)=>{let U=C===v-1?C-2:C===0?C:C-1;return U+=$?24575:0,[U,D]};for(let C=0;C<v;++C)c.emplaceBack(...P(C,0,!0));for(let C=0;C<x;++C)for(let D=0;D<v;++D)c.emplaceBack(...P(D,C,(D===0||D===v-1)&&!0));for(let C=0;C<i.length;++C){const D=i[C];for(let $=0;$<v;++$)c.emplaceBack(...P($,D,!0))}for(let C=0;C<i.length;++C){const D=d.length,$=i[C]+1+2,U=new Nt;for(let Q=0;Q<$-1;Q++){const oe=Q===$-2,de=oe?v*(T-i.length+C-Q):v;for(let xe=0;xe<v-1;xe++){const fe=Q*v+xe;Q===0||oe||xe===0||xe===v-2?(U.emplaceBack(fe+1,fe,fe+de),U.emplaceBack(fe+de,fe+de+1,fe+1)):(d.emplaceBack(fe+1,fe,fe+de),d.emplaceBack(fe+de,fe+de+1,fe+1))}}const q=Wn.simpleSegment(0,D,c.length,d.length-D);for(let Q=0;Q<U.uint16.length;Q+=3)d.emplaceBack(U.uint16[Q],U.uint16[Q+1],U.uint16[Q+2]);const K=Wn.simpleSegment(0,D,c.length,d.length-D);m.push({withoutSkirts:q,withSkirts:K})}return{vertices:c,indices:d,segments:m}}_createGrid(a){const i=this._fillGridMeshWithLods(Ah,Fg);this._gridSegments=i.segments,this._gridBuffer=a.createVertexBuffer(i.vertices,$g.members),this._gridIndexBuffer=a.createIndexBuffer(i.indices,!0)}_createPoles(a){const i=new Nt;for(let m=0;m<=Ah;m++)i.emplaceBack(0,m+1,m+2);this._poleIndexBuffer=a.createIndexBuffer(i,!0);const c=new Hr,d=new Hr;this._poleSegments=[];for(let m=0,v=0;m<gT;m++){const x=360/(1<<m);c.emplaceBack(0,-nl,0,.5,0),d.emplaceBack(0,-nl,0,.5,1);for(let T=0;T<=Ah;T++){const P=T/Ah,C=Or(0,x,P),[D,$,U]=yf(VH,GH,C,nl);c.emplaceBack(D,$,U,P,0),d.emplaceBack(D,$,U,P,1)}this._poleSegments.push(Wn.simpleSegment(v,0,66,64)),v+=66}this._poleNorthVertexBuffer=a.createVertexBuffer(c,NR,!1),this._poleSouthVertexBuffer=a.createVertexBuffer(d,NR,!1)}getGridBuffers(a,i){return[this._gridBuffer,this._gridIndexBuffer,i?this._gridSegments[a].withSkirts:this._gridSegments[a].withoutSkirts]}getPoleBuffers(a){return[this._poleNorthVertexBuffer,this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[a]]}getWirefameBuffers(a,i){if(!this._wireframeSegments){const c=new fi,d=Ah,m=d+1+2,v=1;this._wireframeSegments=[];for(let x=0,T=0;x<Fg.length;x++){const P=Fg[x];for(let D=v;D<P+v;D++)for(let $=v;$<d+v;$++){const U=D*m+$;c.emplaceBack(U,U+1),c.emplaceBack(U,U+m),c.emplaceBack(U,U+m+1)}const C=P*d*3;this._wireframeSegments.push(Wn.simpleSegment(0,T,(P+1)*m,C)),T+=C}this._wireframeIndexBuffer=a.createIndexBuffer(c)}return[this._gridBuffer,this._wireframeIndexBuffer,this._wireframeSegments[i]]}},s.GlyphManager=kf,s.ImagePosition=VT,s.KDBush=sE,s.LivePerformanceUtils=jd,s.LngLat=Zr,s.LngLatBounds=Hc,s.LocalGlyphMode=qT,s.MAX_MERCATOR_LATITUDE=Vi,s.MercatorCoordinate=xf,s.ONE_EM=Ai,s.OverscaledTileID=po,s.PerformanceMarkers=Ya,s.Point=ue,s.Properties=ge,s.RGBAImage=Ho,s.Ray=fT,s.RequestManager=class{constructor(a,i,c){this._transformRequestFn=a,this._customAccessToken=i,this._silenceAuthErrors=!!c,this._createSkuToken()}_createSkuToken(){const a=function(){let i="";for(let c=0;c<10;c++)i+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",B,i].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=a.token,this._skuTokenExpiresAt=a.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(a,i){return this._transformRequestFn&&this._transformRequestFn(a,i)||{url:a}}normalizeStyleURL(a,i){if(!Me(a))return a;const c=wt(a);return c.path=`/styles/v1${c.path}`,this._makeAPIURL(c,this._customAccessToken||i)}normalizeGlyphsURL(a,i){if(!Me(a))return a;const c=wt(a);return c.path=`/fonts/v1${c.path}`,this._makeAPIURL(c,this._customAccessToken||i)}normalizeSourceURL(a,i,c,d){if(!Me(a))return a;const m=wt(a);return m.path=`/v4/${m.authority}.json`,m.params.push("secure"),c&&m.params.push(`language=${c}`),d&&m.params.push(`worldview=${d}`),this._makeAPIURL(m,this._customAccessToken||i)}normalizeSpriteURL(a,i,c,d){const m=wt(a);return Me(a)?(m.path=`/styles/v1${m.path}/sprite${i}${c}`,this._makeAPIURL(m,this._customAccessToken||d)):(m.path+=`${i}${c}`,gt(m))}normalizeTileURL(a,i,c){if(this._isSkuTokenExpired()&&this._createSkuToken(),a&&!Me(a))return a;const d=wt(a);d.path=d.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${i||c&&d.authority!=="raster"&&c===512?"@2x":""}${k.supported?".webp":"$1"}`),d.authority==="raster"?d.path=`/${A.RASTER_URL_PREFIX}${d.path}`:(d.path=d.path.replace(/^.+\/v4\//,"/"),d.path=`/${A.TILE_URL_VERSION}${d.path}`);const m=this._customAccessToken||function(v){for(const x of v){const T=x.match(/^access_token=(.*)$/);if(T)return T[1]}return null}(d.params)||A.ACCESS_TOKEN;return A.REQUIRE_ACCESS_TOKEN&&m&&this._skuToken&&d.params.push(`sku=${this._skuToken}`),this._makeAPIURL(d,m)}canonicalizeTileURL(a,i){const c=wt(a);if(!c.path.match(/^(\/v4\/|\/raster\/v1\/)/)||!c.path.match(/\.[\w]+$/))return a;let d="mapbox://";c.path.match(/^\/raster\/v1\//)?d+=`raster/${c.path.replace(`/${A.RASTER_URL_PREFIX}/`,"")}`:d+=`tiles/${c.path.replace(`/${A.TILE_URL_VERSION}/`,"")}`;let m=c.params;return i&&(m=m.filter(v=>!v.match(/^access_token=/))),m.length&&(d+=`?${m.join("&")}`),d}canonicalizeTileset(a,i){const c=!!i&&Me(i),d=[];for(const m of a.tiles||[])Ne(m)?d.push(this.canonicalizeTileURL(m,c)):d.push(m);return d}_makeAPIURL(a,i){const c="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",d=wt(A.API_URL);if(a.protocol=d.protocol,a.authority=d.authority,a.protocol==="http"){const m=a.params.indexOf("secure");m>=0&&a.params.splice(m,1)}if(d.path!=="/"&&(a.path=`${d.path}${a.path}`),!A.REQUIRE_ACCESS_TOKEN)return gt(a);if(i=i||A.ACCESS_TOKEN,!this._silenceAuthErrors){if(!i)throw new Error(`An API access token is required to use Mapbox GL. ${c}`);if(i[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${c}`)}return a.params=a.params.filter(m=>m.indexOf("access_token")===-1),a.params.push(`access_token=${i||""}`),gt(a)}},s.ResourceType=Ms,s.SegmentVector=Wn,s.SourceCache=Ih,s.StencilMode=rE,s.StructArrayLayout1ui2=Wo,s.StructArrayLayout2f1f2i16=Yt,s.StructArrayLayout2i4=pt,s.StructArrayLayout2ui4=fi,s.StructArrayLayout3f12=yr,s.StructArrayLayout3ui6=Nt,s.StructArrayLayout4i8=it,s.StructArrayLayout5f20=Hr,s.Texture=ly,s.Tile=eE,s.Transitionable=X,s.Uniform1f=D0,s.Uniform1i=class extends Fl{constructor(a){super(a),this.current=0}set(a,i,c){this.fetchUniformLocation(a,i)&&this.current!==c&&(this.current=c,this.gl.uniform1i(this.location,c))}},s.Uniform2f=class extends Fl{constructor(a){super(a),this.current=[0,0]}set(a,i,c){this.fetchUniformLocation(a,i)&&(c[0]===this.current[0]&&c[1]===this.current[1]||(this.current=c,this.gl.uniform2f(this.location,c[0],c[1])))}},s.Uniform3f=class extends Fl{constructor(a){super(a),this.current=[0,0,0]}set(a,i,c){this.fetchUniformLocation(a,i)&&(c[0]===this.current[0]&&c[1]===this.current[1]&&c[2]===this.current[2]||(this.current=c,this.gl.uniform3f(this.location,c[0],c[1],c[2])))}},s.Uniform4f=wR,s.UniformColor=SR,s.UniformMatrix2f=class extends Fl{constructor(a){super(a),this.current=PH}set(a,i,c){if(this.fetchUniformLocation(a,i)){for(let d=0;d<4;d++)if(c[d]!==this.current[d]){this.current=c,this.gl.uniformMatrix2fv(this.location,!1,c);break}}}},s.UniformMatrix3f=class extends Fl{constructor(a){super(a),this.current=AH}set(a,i,c){if(this.fetchUniformLocation(a,i)){for(let d=0;d<9;d++)if(c[d]!==this.current[d]){this.current=c,this.gl.uniformMatrix3fv(this.location,!1,c);break}}}},s.UniformMatrix4f=class extends Fl{constructor(a){super(a),this.current=EH}set(a,i,c){if(this.fetchUniformLocation(a,i)){if(c[12]!==this.current[12]||c[0]!==this.current[0])return this.current=c,void this.gl.uniformMatrix4fv(this.location,!1,c);for(let d=1;d<16;d++)if(c[d]!==this.current[d]){this.current=c,this.gl.uniformMatrix4fv(this.location,!1,c);break}}}},s.UnwrappedTileID=kD,s.ValidationError=Rt,s.VectorTileFeature=Z0,s.VectorTileWorkerSource=class extends Si{constructor(a,i,c,d,m){super(),this.actor=a,this.layerIndex=i,this.availableImages=c,this.loadVectorData=m||NL,this.loading={},this.loaded={},this.deduped=new BL(a.scheduler),this.isSpriteLoaded=d,this.scheduler=a.scheduler}loadTile(a,i){const c=a.uid,d=a&&a.request,m=d&&d.collectResourceTiming,v=this.loading[c]=new X7(a);v.abort=this.loadVectorData(a,(x,T)=>{const P=!this.loading[c];if(delete this.loading[c],P||x||!T)return v.status="done",P||(this.loaded[c]=v),i(x);const C=T.rawData,D={};T.expires&&(D.expires=T.expires),T.cacheControl&&(D.cacheControl=T.cacheControl),v.vectorTile=T.vectorTile||new BT(new tx(C));const $=()=>{v.parse(v.vectorTile,this.layerIndex,this.availableImages,this.actor,(U,q)=>{if(U||!q)return i(U);const K={};if(m){const Q=Ec(d);Q.length>0&&(K.resourceTiming=JSON.parse(JSON.stringify(Q)))}i(null,$t({rawTileData:C.slice(0)},q,D,K))})};this.isSpriteLoaded?$():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add($,{type:"parseTile",isSymbolTile:a.isSymbolTile,zoom:a.tileZoom}):$()}),this.loaded=this.loaded||{},this.loaded[c]=v})}reloadTile(a,i){const c=this.loaded,d=a.uid,m=this;if(c&&c[d]){const v=c[d];v.showCollisionBoxes=a.showCollisionBoxes,v.enableTerrain=!!a.enableTerrain,v.projection=a.projection,v.tileTransform=Mh(a.tileID.canonical,a.projection);const x=(T,P)=>{const C=v.reloadCallback;C&&(delete v.reloadCallback,v.parse(v.vectorTile,m.layerIndex,this.availableImages,m.actor,C)),i(T,P)};v.status==="parsing"?v.reloadCallback=x:v.status==="done"&&(v.vectorTile?v.parse(v.vectorTile,this.layerIndex,this.availableImages,this.actor,x):x())}}abortTile(a,i){const c=a.uid,d=this.loading[c];d&&(d.abort&&d.abort(),delete this.loading[c]),i()}removeTile(a,i){const c=this.loaded,d=a.uid;c&&c[d]&&delete c[d],i()}},s.WritingMode=ms,s.ZoomDependentExpression=fh,s.add=Vl,s.addDynamicAttributes=hx,s.adjoint=function(a,i){var c=i[0],d=i[1],m=i[2],v=i[3],x=i[4],T=i[5],P=i[6],C=i[7],D=i[8];return a[0]=x*D-T*C,a[1]=m*C-d*D,a[2]=d*T-m*x,a[3]=T*P-v*D,a[4]=c*D-m*P,a[5]=m*v-c*T,a[6]=v*C-x*P,a[7]=d*P-c*C,a[8]=c*x-d*v,a},s.asyncAll=at,s.bezier=tt,s.bindAll=Jt,s.boundsAttributes=bL,s.bufferConvexPolygon=function(a,i){const c=[];for(let d=0;d<a.length;d++){const m=ht(d-1,-1,a.length-1),v=ht(d+1,-1,a.length-1),x=a[d],T=a[v],P=a[m].sub(x).unit(),C=T.sub(x).unit(),D=C.angleWithSep(P.x,P.y),$=P.add(C).unit().mult(-1*i/Math.sin(D/2));c.push(x.add($))}return c},s.cacheEntryPossiblyAdded=function(a){Za++,Za>Ol&&(a.getActor().send("enforceCacheSizeLimit",Ha),Za=0)},s.calculateGlobeLabelMatrix=function(a,i){const{x:c,y:d}=a.point,m=qR(c,d,a.worldSize/a._pixelsPerMercatorPixel,0,0);return Sh(m,m,_T(il(i)))},s.calculateGlobeMatrix=function(a){const{x:i,y:c}=a.point,{lng:d,lat:m}=a._center;return qR(i,c,a.worldSize,d,m)},s.calculateGlobeMercatorMatrix=function(a){const i=a.pixelsPerMeter,c=i/_a(1,a.center.lat),d=ya(new Float64Array(16));return Dg(d,d,[a.point.x,a.point.y,0]),Th(d,d,[c,c,i]),Float32Array.from(d)},s.circumferenceAtLatitude=bT,s.clamp=De,s.clearTileCache=function(a){if(!Ka())return;const i=y.caches.delete(so);a&&i.catch(a).then(()=>a())},s.clipLine=nL,s.clone=function(a){var i=new qo(16);return i[0]=a[0],i[1]=a[1],i[2]=a[2],i[3]=a[3],i[4]=a[4],i[5]=a[5],i[6]=a[6],i[7]=a[7],i[8]=a[8],i[9]=a[9],i[10]=a[10],i[11]=a[11],i[12]=a[12],i[13]=a[13],i[14]=a[14],i[15]=a[15],i},s.clone$1=Tt,s.collisionCircleLayout=K9,s.config=A,s.conjugate=function(a,i){return a[0]=-i[0],a[1]=-i[1],a[2]=-i[2],a[3]=i[3],a},s.create=function(){var a=new qo(16);return qo!=Float32Array&&(a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[11]=0,a[12]=0,a[13]=0,a[14]=0),a[0]=1,a[5]=1,a[10]=1,a[15]=1,a},s.create$1=AR,s.createExpression=$c,s.createLayout=Ie,s.createStyleLayer=function(a){return a.type==="custom"?new N7(a):new F7[a.type](a)},s.cross=dT,s.degToRad=je,s.distance=function(a,i){return Math.hypot(i[0]-a[0],i[1]-a[1],i[2]-a[2])},s.div=function(a,i,c){return a[0]=i[0]/c[0],a[1]=i[1]/c[1],a[2]=i[2]/c[2],a},s.dot=zs,s.earthRadius=Gg,s.ease=ze,s.easeCubicInOut=Ye,s.ecefToLatLng=function([a,i,c]){const d=Math.hypot(a,i,c),m=Math.atan2(a,c),v=.5*Math.PI-Math.acos(-i/d);return new Zr(Ge(m),Ge(v))},s.emitValidationErrors=C0,s.endsWith=rr,s.enforceCacheSizeLimit=function(a){ao(),Bi&&Bi.then(i=>{i.keys().then(c=>{for(let d=0;d<c.length-a;d++)i.delete(c[d])})})},s.evaluateSizeForFeature=Q0,s.evaluateSizeForZoom=Ef,s.evaluateVariableOffset=lL,s.evented=S,s.exactEquals=function(a,i){return a[0]===i[0]&&a[1]===i[1]&&a[2]===i[2]&&a[3]===i[3]},s.exactEquals$1=function(a,i){return a[0]===i[0]&&a[1]===i[1]&&a[2]===i[2]},s.exported=nr,s.exported$1=k,s.extend=$t,s.extend$1=Ti,s.fillExtrusionHeightLift=AD,s.filterObject=qt,s.fromMat4=function(a,i){return a[0]=i[0],a[1]=i[1],a[2]=i[2],a[3]=i[4],a[4]=i[5],a[5]=i[6],a[6]=i[8],a[7]=i[9],a[8]=i[10],a},s.fromQuat=function(a,i){var c=i[0],d=i[1],m=i[2],v=i[3],x=c+c,T=d+d,P=m+m,C=c*x,D=d*x,$=d*T,U=m*x,q=m*T,K=m*P,Q=v*x,oe=v*T,de=v*P;return a[0]=1-$-K,a[1]=D+de,a[2]=U-oe,a[3]=0,a[4]=D-de,a[5]=1-C-K,a[6]=q+Q,a[7]=0,a[8]=U+oe,a[9]=q-Q,a[10]=1-C-$,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a},s.fromRotation=function(a,i){var c=Math.sin(i),d=Math.cos(i);return a[0]=d,a[1]=c,a[2]=0,a[3]=-c,a[4]=d,a[5]=0,a[6]=0,a[7]=0,a[8]=1,a},s.fromScaling=CR,s.furthestTileCorner=function(a){const i=Math.round((a+45+360)%360/90)%4;return Ze[i]},s.getAABBPointSquareDist=function(a,i,c){let d=0;for(let m=0;m<2;++m){const v=c?c[m]:0;a[m]>v&&(d+=(a[m]-v)*(a[m]-v)),i[m]<v&&(d+=(v-i[m])*(v-i[m]))}return d},s.getAnchorAlignment=WT,s.getAnchorJustification=KT,s.getBounds=function(a){let i=1/0,c=1/0,d=-1/0,m=-1/0;for(const v of a)i=Math.min(i,v.x),c=Math.min(c,v.y),d=Math.max(d,v.x),m=Math.max(m,v.y);return{min:new ue(i,c),max:new ue(d,m)}},s.getColumn=Zi,s.getDefaultExportFromCjs=Z,s.getGridMatrix=function(a,i,c,d){const m=i.getNorth(),v=i.getSouth(),x=i.getWest(),T=i.getEast(),P=1<<a.z,C=T-x,D=m-v,$=C/Ah,U=-D/Fg[c],q=[0,$,0,U,0,0,m,x,0];if(a.z>0){const K=180/d;PR(q,q,[K/C+1,0,0,0,K/D+1,0,-.5*K/$,.5*K/U,1])}return q[2]=P,q[5]=a.x,q[8]=a.y,q},s.getImage=ye,s.getJSON=function(a,i){return ls($t(a,{type:"json"}),i)},s.getLatitudinalLod=function(a){const i=Vi-5;a=De(a,-i,i)/i*90;const c=Math.pow(Math.abs(Math.sin(je(a))),3);return Math.round(c*(Fg.length-1))},s.getMapSessionAPI=Bn,s.getPerformanceMeasurement=Ec,s.getProjection=gL,s.getRTLTextPluginStatus=E,s.getReferrer=No,s.getTilePoint=function(a,{x:i,y:c},d=0){return new ue(((i-d)*a.scale-a.x)*Zt,(c*a.scale-a.y)*Zt)},s.getTileVec3=function(a,i,c=0){return gf(((i.x-c)*a.scale-a.x)*Zt,(i.y*a.scale-a.y)*Zt,XR(i.z,i.y))},s.getVideo=function(a,i){const c=y.document.createElement("video");c.muted=!0,c.onloadstart=function(){i(null,c)};for(let d=0;d<a.length;d++){const m=y.document.createElement("source");Xa(a[d])||(c.crossOrigin="Anonymous"),m.src=a[d],c.appendChild(m)}return{cancel:()=>{}}},s.globeCenterToScreenPoint=function(a){const i=[0,0,0],c=ya(new Float64Array(16));return Sh(c,a.pixelMatrix,a.globeMatrix),Fn(i,i,c),new ue(i[0],i[1])},s.globeDenormalizeECEF=_T,s.globeECEFOrigin=function(a,i){const c=[0,0,0];return Fn(c,c,Vg(il(i.canonical))),Fn(c,c,a),c},s.globeMetersToEcef=z0,s.globeNormalizeECEF=Vg,s.globePixelsToTileUnits=function(a,i){return Zt/(512*Math.pow(2,a))*N0(il(i))},s.globePoleMatrixForTile=function(a,i,c){const d=ya(new Float64Array(16)),m=(i/(1<<a)-.5)*Math.PI*2;return j0(d,c.globeMatrix,m),Float32Array.from(d)},s.globeTileBounds=il,s.globeTiltAtLngLat=HR,s.globeToMercatorTransition=_f,s.globeUseCustomAntiAliasing=function(a,i,c){const d=_f(c.zoom),m=a.style.map._antialias,v=!!i.extStandardDerivatives,x=i.extStandardDerivativesForceOff||a.terrain&&a.terrain.exaggeration()>0;return d===0&&!m&&!x&&v},s.identity=ya,s.identity$1=jR,s.invert=lT,s.isFullscreen=function(){return!!y.document.fullscreenElement||!!y.document.webkitFullscreenElement},s.isLngLatBehindGlobe=xT,s.isMapAuthenticated=function(a){return wi.has(a)},s.isMapboxURL=Me,s.isSafariWithAntialiasingBug=function(a){const i=a.navigator?a.navigator.userAgent:null;return!!jn(a)&&i&&(i.match("Version/15.4")||i.match("Version/15.5")||i.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},s.latFromMercatorY=Ui,s.latLngToECEF=vf,s.len=jH,s.length=Lg,s.length$1=function(a){return Math.hypot(a[0],a[1],a[2],a[3])},s.lngFromMercatorX=ps,s.loadVectorTile=NL,s.makeRequest=ls,s.mapValue=function(a,i,c,d,m){return De((a-i)/(c-i)*(m-d)+d,d,m)},s.mercatorScale=YR,s.mercatorXfromLng=ol,s.mercatorYfromLat=sl,s.mercatorZfromAltitude=_a,s.mul=DH,s.mul$1=LH,s.multiply=Sh,s.multiply$1=PR,s.multiply$2=MR,s.nextPowerOfTwo=Vr,s.normalize=ho,s.normalize$1=zH,s.normalize$2=DR,s.number=Or,s.ortho=function(a,i,c,d,m,v,x){var T=1/(i-c),P=1/(d-m),C=1/(v-x);return a[0]=-2*T,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=-2*P,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=2*C,a[11]=0,a[12]=(i+c)*T,a[13]=(m+d)*P,a[14]=(x+v)*C,a[15]=1,a},s.pbf=jD,s.perspective=function(a,i,c,d,m){var v,x=1/Math.tan(i/2);return a[0]=x/c,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=x,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[11]=-1,a[12]=0,a[13]=0,a[15]=0,m!=null&&m!==1/0?(a[10]=(m+d)*(v=1/(d-m)),a[14]=2*m*d*v):(a[10]=-1,a[14]=-2*d),a},s.pick=function(a,i){const c={};for(let d=0;d<i.length;d++){const m=i[d];m in a&&(c[m]=a[m])}return c},s.plugin=I,s.pointGeometry=te,s.polesInViewport=function(a){const i=ya(new Float64Array(16));Sh(i,a.pixelMatrix,a.globeMatrix);const c=[0,Bs,0],d=[0,Ns,0];return Fn(c,c,i),Fn(d,d,i),[c[0]>0&&c[0]<=a.width&&c[1]>0&&c[1]<=a.height&&!xT(a,new Zr(a.center.lat,90)),d[0]>0&&d[0]<=a.width&&d[1]>0&&d[1]<=a.height&&!xT(a,new Zr(a.center.lat,-90))]},s.polygonContainsPoint=kh,s.polygonIntersectsBox=iD,s.polygonIntersectsPolygon=eD,s.polygonizeBounds=function(a,i,c=0,d=!0){const m=new ue(c,c),v=a.sub(m),x=i.add(m),T=[v,new ue(x.x,v.y),x,new ue(v.x,x.y)];return d&&T.push(v.clone()),T},s.posAttributes=$g,s.postMapLoadEvent=An,s.postPerformanceEvent=Pn,s.postTurnstileEvent=vr,s.potpack=UT,s.prevPowerOfTwo=function(a){return a<=1?1:Math.pow(2,Math.floor(Math.log(a)/Math.LN2))},s.radToDeg=Ge,s.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],s.registerForPluginStateChange=function(a){return a({pluginStatus:g,pluginURL:u}),S.on("pluginStateChange",a),a},s.removeAuthState=function(a){wi.delete(a)},s.renderColorRamp=kT,s.resample=JR,s.rotateX=cT,s.rotateX$1=zR,s.rotateY=j0,s.rotateY$1=BR,s.rotateZ=function(a,i,c){var d=Math.sin(c),m=Math.cos(c),v=i[0],x=i[1],T=i[2],P=i[3],C=i[4],D=i[5],$=i[6],U=i[7];return i!==a&&(a[8]=i[8],a[9]=i[9],a[10]=i[10],a[11]=i[11],a[12]=i[12],a[13]=i[13],a[14]=i[14],a[15]=i[15]),a[0]=v*m+C*d,a[1]=x*m+D*d,a[2]=T*m+$*d,a[3]=P*m+U*d,a[4]=C*m-v*d,a[5]=D*m-x*d,a[6]=$*m-T*d,a[7]=U*m-P*d,a},s.rotateZ$1=function(a,i,c){c*=.5;var d=i[0],m=i[1],v=i[2],x=i[3],T=Math.sin(c),P=Math.cos(c);return a[0]=d*P+m*T,a[1]=m*P-d*T,a[2]=v*P+x*T,a[3]=x*P-v*T,a},s.scale=Th,s.scale$1=RR,s.scale$2=fs,s.scaleAndAdd=Bg,s.set=function(a,i,c,d){return a[0]=i,a[1]=c,a[2]=d,a},s.setCacheLimits=function(a,i){Ha=a,Ol=i},s.setColumn=function(a,i,c){a[4*i+0]=c[0],a[4*i+1]=c[1],a[4*i+2]=c[2],a[4*i+3]=c[3]},s.setRTLTextPlugin=function(a,i,c=!1){if(g===kg||g===Og||g===Mg)throw new Error("setRTLTextPlugin cannot be called multiple times.");u=nr.resolveURL(a),g=kg,Gc=i,_(),c||O()},s.smoothstep=ut,s.spec=Xe,s.squaredLength=function(a){var i=a[0],c=a[1],d=a[2];return i*i+c*c+d*d},s.storeAuthState=function(a,i){i?wi.add(a):wi.delete(a)},s.sub=va,s.subtract=hT,s.symbolSize=Z9,s.tileAABB=function(a,i,c,d,m,v,x,T,P){if(P.name==="globe")return UH(a,i,new Y0(c,d,m));const C=Mh({z:c,x:d,y:m},P);return new fo([(v+C.x/C.scale)*i,i*(C.y/C.scale),x],[(v+C.x2/C.scale)*i,i*(C.y2/C.scale),T])},s.tileCornersToBounds=B0,s.tileTransform=Mh,s.transformMat3=function(a,i,c){var d=i[0],m=i[1],v=i[2];return a[0]=d*c[0]+m*c[3]+v*c[6],a[1]=d*c[1]+m*c[4]+v*c[7],a[2]=d*c[2]+m*c[5]+v*c[8],a},s.transformMat4=Fn,s.transformMat4$1=Eh,s.transformQuat=IR,s.transitionTileAABBinECEF=VR,s.translate=Dg,s.transpose=function(a,i){if(a===i){var c=i[1],d=i[2],m=i[5];a[1]=i[3],a[2]=i[6],a[3]=c,a[5]=i[7],a[6]=d,a[7]=m}else a[0]=i[0],a[1]=i[3],a[2]=i[6],a[3]=i[1],a[4]=i[4],a[5]=i[7],a[6]=i[2],a[7]=i[5],a[8]=i[8];return a},s.triggerPluginCompletionEvent=p,s.uniqueId=Br,s.updateGlobeVertexNormal=function(a,i,c,d,m){const v=5*i+2;a.float32[v+0]=c,a.float32[v+1]=d,a.float32[v+2]=m},s.validateCustomStyleLayer=function(a){const i=[],c=a.id;return c===void 0&&i.push({message:`layers.${c}: missing required property "id"`}),a.render===void 0&&i.push({message:`layers.${c}: missing required method "render"`}),a.renderingMode&&a.renderingMode!=="2d"&&a.renderingMode!=="3d"&&i.push({message:`layers.${c}: property "renderingMode" must be either "2d" or "3d"`}),i},s.validateFilter=a=>Go(vh(a)),s.validateFog=a=>Go(E0(a)),s.validateLayer=a=>Go(b0(a)),s.validateLight=a=>Go(T0(a)),s.validateSource=a=>Go(S0(a)),s.validateStyle=P0,s.validateTerrain=a=>Go(Tg(a)),s.values=Lt,s.vectorTile=K0,s.version=b,s.warnOnce=Et,s.window=y,s.wrap=ht}),h(["./shared"],function(s){function y(ve){if(typeof ve=="number"||typeof ve=="boolean"||typeof ve=="string"||ve==null)return JSON.stringify(ve);if(Array.isArray(ve)){let ne="[";for(const ye of ve)ne+=`${y(ye)},`;return`${ne}]`}let ee="{";for(const ne of Object.keys(ve).sort())ee+=`${ne}:${y(ve[ne])},`;return`${ee}}`}function b(ve){let ee="";for(const ne of s.refProperties)ee+=`/${y(ve[ne])}`;return ee}class w{constructor(ee){this.keyCache={},ee&&this.replace(ee)}replace(ee){this._layerConfigs={},this._layers={},this.update(ee,[])}update(ee,ne){for(const Se of ee)this._layerConfigs[Se.id]=Se,(this._layers[Se.id]=s.createStyleLayer(Se)).compileFilter(),this.keyCache[Se.id]&&delete this.keyCache[Se.id];for(const Se of ne)delete this.keyCache[Se],delete this._layerConfigs[Se],delete this._layers[Se];this.familiesBySource={};const ye=function(Se,Me){const Ne={};for(let ke=0;ke<Se.length;ke++){const qe=Me&&Me[Se[ke].id]||b(Se[ke]);Me&&(Me[Se[ke].id]=qe);let xt=Ne[qe];xt||(xt=Ne[qe]=[]),xt.push(Se[ke])}const Be=[];for(const ke in Ne)Be.push(Ne[ke]);return Be}(s.values(this._layerConfigs),this.keyCache);for(const Se of ye){const Me=Se.map(wt=>this._layers[wt.id]),Ne=Me[0];if(Ne.visibility==="none")continue;const Be=Ne.source||"";let ke=this.familiesBySource[Be];ke||(ke=this.familiesBySource[Be]={});const qe=Ne.sourceLayer||"_geojsonTileLayer";let xt=ke[qe];xt||(xt=ke[qe]=[]),xt.push(Me)}}}class A{loadTile(ee,ne){const{uid:ye,encoding:Se,rawImageData:Me,padding:Ne,buildQuadTree:Be}=ee,ke=s.window.ImageBitmap&&Me instanceof s.window.ImageBitmap?this.getImageData(Me,Ne):Me;ne(null,new s.DEMData(ye,ke,Se,Ne<1,Be))}getImageData(ee,ne){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(ee.width,ee.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=ee.width,this.offscreenCanvas.height=ee.height,this.offscreenCanvasContext.drawImage(ee,0,0,ee.width,ee.height);const ye=this.offscreenCanvasContext.getImageData(-ne,-ne,ee.width+2*ne,ee.height+2*ne);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),ye}}function k(ve,ee){if(ve.length!==0){M(ve[0],ee);for(var ne=1;ne<ve.length;ne++)M(ve[ne],!ee)}}function M(ve,ee){for(var ne=0,ye=0,Se=0,Me=ve.length,Ne=Me-1;Se<Me;Ne=Se++){var Be=(ve[Se][0]-ve[Ne][0])*(ve[Ne][1]+ve[Se][1]),ke=ne+Be;ye+=Math.abs(ne)>=Math.abs(Be)?ne-ke+Be:Be-ke+ne,ne=ke}ne+ye>=0!=!!ee&&ve.reverse()}var R=s.getDefaultExportFromCjs(function ve(ee,ne){var ye,Se=ee&&ee.type;if(Se==="FeatureCollection")for(ye=0;ye<ee.features.length;ye++)ve(ee.features[ye],ne);else if(Se==="GeometryCollection")for(ye=0;ye<ee.geometries.length;ye++)ve(ee.geometries[ye],ne);else if(Se==="Feature")ve(ee.geometry,ne);else if(Se==="Polygon")k(ee.coordinates,ne);else if(Se==="MultiPolygon")for(ye=0;ye<ee.coordinates.length;ye++)k(ee.coordinates[ye],ne);return ee});const j=s.VectorTileFeature.prototype.toGeoJSON;var L={exports:{}},z=s.pointGeometry,B=s.vectorTile.VectorTileFeature,Z=F;function F(ve,ee){this.options=ee||{},this.features=ve,this.length=ve.length}function H(ve,ee){this.id=typeof ve.id=="number"?ve.id:void 0,this.type=ve.type,this.rawGeometry=ve.type===1?[ve.geometry]:ve.geometry,this.properties=ve.tags,this.extent=ee||4096}F.prototype.feature=function(ve){return new H(this.features[ve],this.options.extent)},H.prototype.loadGeometry=function(){var ve=this.rawGeometry;this.geometry=[];for(var ee=0;ee<ve.length;ee++){for(var ne=ve[ee],ye=[],Se=0;Se<ne.length;Se++)ye.push(new z(ne[Se][0],ne[Se][1]));this.geometry.push(ye)}return this.geometry},H.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var ve=this.geometry,ee=1/0,ne=-1/0,ye=1/0,Se=-1/0,Me=0;Me<ve.length;Me++)for(var Ne=ve[Me],Be=0;Be<Ne.length;Be++){var ke=Ne[Be];ee=Math.min(ee,ke.x),ne=Math.max(ne,ke.x),ye=Math.min(ye,ke.y),Se=Math.max(Se,ke.y)}return[ee,ye,ne,Se]},H.prototype.toGeoJSON=B.prototype.toGeoJSON;var Y=s.pbf,te=Z;function pe(ve){var ee=new Y;return function(ne,ye){for(var Se in ne.layers)ye.writeMessage(3,ue,ne.layers[Se])}(ve,ee),ee.finish()}function ue(ve,ee){var ne;ee.writeVarintField(15,ve.version||1),ee.writeStringField(1,ve.name||""),ee.writeVarintField(5,ve.extent||4096);var ye={keys:[],values:[],keycache:{},valuecache:{}};for(ne=0;ne<ve.length;ne++)ye.feature=ve.feature(ne),ee.writeMessage(2,Ee,ye);var Se=ye.keys;for(ne=0;ne<Se.length;ne++)ee.writeStringField(3,Se[ne]);var Me=ye.values;for(ne=0;ne<Me.length;ne++)ee.writeMessage(4,Ye,Me[ne])}function Ee(ve,ee){var ne=ve.feature;ne.id!==void 0&&ee.writeVarintField(1,ne.id),ee.writeMessage(2,Oe,ve),ee.writeVarintField(3,ne.type),ee.writeMessage(4,Ze,ne)}function Oe(ve,ee){var ne=ve.feature,ye=ve.keys,Se=ve.values,Me=ve.keycache,Ne=ve.valuecache;for(var Be in ne.properties){var ke=ne.properties[Be],qe=Me[Be];if(ke!==null){qe===void 0&&(ye.push(Be),Me[Be]=qe=ye.length-1),ee.writeVarint(qe);var xt=typeof ke;xt!=="string"&&xt!=="boolean"&&xt!=="number"&&(ke=JSON.stringify(ke));var wt=xt+":"+ke,gt=Ne[wt];gt===void 0&&(Se.push(ke),Ne[wt]=gt=Se.length-1),ee.writeVarint(gt)}}}function je(ve,ee){return(ee<<3)+(7&ve)}function Ge(ve){return ve<<1^ve>>31}function Ze(ve,ee){for(var ne=ve.loadGeometry(),ye=ve.type,Se=0,Me=0,Ne=ne.length,Be=0;Be<Ne;Be++){var ke=ne[Be],qe=1;ye===1&&(qe=ke.length),ee.writeVarint(je(1,qe));for(var xt=ye===3?ke.length-1:ke.length,wt=0;wt<xt;wt++){wt===1&&ye!==1&&ee.writeVarint(je(2,xt-1));var gt=ke[wt].x-Se,or=ke[wt].y-Me;ee.writeVarint(Ge(gt)),ee.writeVarint(Ge(or)),Se+=gt,Me+=or}ye===3&&ee.writeVarint(je(7,1))}}function Ye(ve,ee){var ne=typeof ve;ne==="string"?ee.writeStringField(1,ve):ne==="boolean"?ee.writeBooleanField(7,ve):ne==="number"&&(ve%1!=0?ee.writeDoubleField(3,ve):ve<0?ee.writeSVarintField(6,ve):ee.writeVarintField(5,ve))}L.exports=pe,L.exports.fromVectorTileJs=pe,L.exports.fromGeojsonVt=function(ve,ee){ee=ee||{};var ne={};for(var ye in ve)ne[ye]=new te(ve[ye].features,ee),ne[ye].name=ye,ne[ye].version=ee.version,ne[ye].extent=ee.extent;return pe({layers:ne})},L.exports.GeoJSONWrapper=te;var tt=s.getDefaultExportFromCjs(L.exports);const ze={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:ve=>ve},De=Math.fround||(ut=new Float32Array(1),ve=>(ut[0]=+ve,ut[0]));var ut;const ht=3,at=5,Lt=6;class $t{constructor(ee){this.options=Object.assign(Object.create(ze),ee),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(ee){const{log:ne,minZoom:ye,maxZoom:Se}=this.options;ne&&console.time("total time");const Me=`prepare ${ee.length} points`;ne&&console.time(Me),this.points=ee;const Ne=[];for(let ke=0;ke<ee.length;ke++){const qe=ee[ke];if(!qe.geometry)continue;const[xt,wt]=qe.geometry.coordinates,gt=De(cn(xt)),or=De(Vr(wt));Ne.push(gt,or,1/0,ke,-1,1),this.options.reduce&&Ne.push(0)}let Be=this.trees[Se+1]=this._createTree(Ne);ne&&console.timeEnd(Me);for(let ke=Se;ke>=ye;ke--){const qe=+Date.now();Be=this.trees[ke]=this._createTree(this._cluster(Be,ke)),ne&&console.log("z%d: %d clusters in %dms",ke,Be.numItems,+Date.now()-qe)}return ne&&console.timeEnd("total time"),this}getClusters(ee,ne){let ye=((ee[0]+180)%360+360)%360-180;const Se=Math.max(-90,Math.min(90,ee[1]));let Me=ee[2]===180?180:((ee[2]+180)%360+360)%360-180;const Ne=Math.max(-90,Math.min(90,ee[3]));if(ee[2]-ee[0]>=360)ye=-180,Me=180;else if(ye>Me){const wt=this.getClusters([ye,Se,180,Ne],ne),gt=this.getClusters([-180,Se,Me,Ne],ne);return wt.concat(gt)}const Be=this.trees[this._limitZoom(ne)],ke=Be.range(cn(ye),Vr(Ne),cn(Me),Vr(Se)),qe=Be.data,xt=[];for(const wt of ke){const gt=this.stride*wt;xt.push(qe[gt+at]>1?Tr(qe,gt,this.clusterProps):this.points[qe[gt+ht]])}return xt}getChildren(ee){const ne=this._getOriginId(ee),ye=this._getOriginZoom(ee),Se="No cluster with the specified id.",Me=this.trees[ye];if(!Me)throw new Error(Se);const Ne=Me.data;if(ne*this.stride>=Ne.length)throw new Error(Se);const Be=this.options.radius/(this.options.extent*Math.pow(2,ye-1)),ke=Me.within(Ne[ne*this.stride],Ne[ne*this.stride+1],Be),qe=[];for(const xt of ke){const wt=xt*this.stride;Ne[wt+4]===ee&&qe.push(Ne[wt+at]>1?Tr(Ne,wt,this.clusterProps):this.points[Ne[wt+ht]])}if(qe.length===0)throw new Error(Se);return qe}getLeaves(ee,ne,ye){const Se=[];return this._appendLeaves(Se,ee,ne=ne||10,ye=ye||0,0),Se}getTile(ee,ne,ye){const Se=this.trees[this._limitZoom(ee)],Me=Math.pow(2,ee),{extent:Ne,radius:Be}=this.options,ke=Be/Ne,qe=(ye-ke)/Me,xt=(ye+1+ke)/Me,wt={features:[]};return this._addTileFeatures(Se.range((ne-ke)/Me,qe,(ne+1+ke)/Me,xt),Se.data,ne,ye,Me,wt),ne===0&&this._addTileFeatures(Se.range(1-ke/Me,qe,1,xt),Se.data,Me,ye,Me,wt),ne===Me-1&&this._addTileFeatures(Se.range(0,qe,ke/Me,xt),Se.data,-1,ye,Me,wt),wt.features.length?wt:null}getClusterExpansionZoom(ee){let ne=this._getOriginZoom(ee)-1;for(;ne<=this.options.maxZoom;){const ye=this.getChildren(ee);if(ne++,ye.length!==1)break;ee=ye[0].properties.cluster_id}return ne}_appendLeaves(ee,ne,ye,Se,Me){const Ne=this.getChildren(ne);for(const Be of Ne){const ke=Be.properties;if(ke&&ke.cluster?Me+ke.point_count<=Se?Me+=ke.point_count:Me=this._appendLeaves(ee,ke.cluster_id,ye,Se,Me):Me<Se?Me++:ee.push(Be),ee.length===ye)break}return Me}_createTree(ee){const ne=new s.KDBush(ee.length/this.stride|0,this.options.nodeSize,Float32Array);for(let ye=0;ye<ee.length;ye+=this.stride)ne.add(ee[ye],ee[ye+1]);return ne.finish(),ne.data=ee,ne}_addTileFeatures(ee,ne,ye,Se,Me,Ne){for(const Be of ee){const ke=Be*this.stride,qe=ne[ke+at]>1;let xt,wt,gt;if(qe)xt=Br(ne,ke,this.clusterProps),wt=ne[ke],gt=ne[ke+1];else{const sr=this.points[ne[ke+ht]];xt=sr.properties;const[gr,vr]=sr.geometry.coordinates;wt=cn(gr),gt=Vr(vr)}const or={type:1,geometry:[[Math.round(this.options.extent*(wt*Me-ye)),Math.round(this.options.extent*(gt*Me-Se))]],tags:xt};let mr;mr=qe||this.options.generateId?ne[ke+ht]:this.points[ne[ke+ht]].id,mr!==void 0&&(or.id=mr),Ne.features.push(or)}}_limitZoom(ee){return Math.max(this.options.minZoom,Math.min(Math.floor(+ee),this.options.maxZoom+1))}_cluster(ee,ne){const{radius:ye,extent:Se,reduce:Me,minPoints:Ne}=this.options,Be=ye/(Se*Math.pow(2,ne)),ke=ee.data,qe=[],xt=this.stride;for(let wt=0;wt<ke.length;wt+=xt){if(ke[wt+2]<=ne)continue;ke[wt+2]=ne;const gt=ke[wt],or=ke[wt+1],mr=ee.within(ke[wt],ke[wt+1],Be),sr=ke[wt+at];let gr=sr;for(const vr of mr){const dn=vr*xt;ke[dn+2]>ne&&(gr+=ke[dn+at])}if(gr>sr&&gr>=Ne){let vr,dn=gt*sr,An=or*sr,hi=-1;const Pn=((wt/xt|0)<<5)+(ne+1)+this.points.length;for(const $o of mr){const Bn=$o*xt;if(ke[Bn+2]<=ne)continue;ke[Bn+2]=ne;const wi=ke[Bn+at];dn+=ke[Bn]*wi,An+=ke[Bn+1]*wi,ke[Bn+4]=Pn,Me&&(vr||(vr=this._map(ke,wt,!0),hi=this.clusterProps.length,this.clusterProps.push(vr)),Me(vr,this._map(ke,Bn)))}ke[wt+4]=Pn,qe.push(dn/gr,An/gr,1/0,Pn,-1,gr),Me&&qe.push(hi)}else{for(let vr=0;vr<xt;vr++)qe.push(ke[wt+vr]);if(gr>1)for(const vr of mr){const dn=vr*xt;if(!(ke[dn+2]<=ne)){ke[dn+2]=ne;for(let An=0;An<xt;An++)qe.push(ke[dn+An])}}}}return qe}_getOriginId(ee){return ee-this.points.length>>5}_getOriginZoom(ee){return(ee-this.points.length)%32}_map(ee,ne,ye){if(ee[ne+at]>1){const Ne=this.clusterProps[ee[ne+Lt]];return ye?Object.assign({},Ne):Ne}const Se=this.points[ee[ne+ht]].properties,Me=this.options.map(Se);return ye&&Me===Se?Object.assign({},Me):Me}}function Tr(ve,ee,ne){return{type:"Feature",id:ve[ee+ht],properties:Br(ve,ee,ne),geometry:{type:"Point",coordinates:[(ye=ve[ee],360*(ye-.5)),Dt(ve[ee+1])]}};var ye}function Br(ve,ee,ne){const ye=ve[ee+at],Se=ye>=1e4?`${Math.round(ye/1e3)}k`:ye>=1e3?Math.round(ye/100)/10+"k":ye,Me=ve[ee+Lt],Ne=Me===-1?{}:Object.assign({},ne[Me]);return Object.assign(Ne,{cluster:!0,cluster_id:ve[ee+ht],point_count:ye,point_count_abbreviated:Se})}function cn(ve){return ve/360+.5}function Vr(ve){const ee=Math.sin(ve*Math.PI/180),ne=.5-.25*Math.log((1+ee)/(1-ee))/Math.PI;return ne<0?0:ne>1?1:ne}function Dt(ve){const ee=(180-360*ve)*Math.PI/180;return 360*Math.atan(Math.exp(ee))/Math.PI-90}function Jt(ve,ee,ne,ye){for(var Se,Me=ye,Ne=ne-ee>>1,Be=ne-ee,ke=ve[ee],qe=ve[ee+1],xt=ve[ne],wt=ve[ne+1],gt=ee+3;gt<ne;gt+=3){var or=rr(ve[gt],ve[gt+1],ke,qe,xt,wt);if(or>Me)Se=gt,Me=or;else if(or===Me){var mr=Math.abs(gt-Ne);mr<Be&&(Se=gt,Be=mr)}}Me>ye&&(Se-ee>3&&Jt(ve,ee,Se,ye),ve[Se+2]=Me,ne-Se>3&&Jt(ve,Se,ne,ye))}function rr(ve,ee,ne,ye,Se,Me){var Ne=Se-ne,Be=Me-ye;if(Ne!==0||Be!==0){var ke=((ve-ne)*Ne+(ee-ye)*Be)/(Ne*Ne+Be*Be);ke>1?(ne=Se,ye=Me):ke>0&&(ne+=Ne*ke,ye+=Be*ke)}return(Ne=ve-ne)*Ne+(Be=ee-ye)*Be}function Le(ve,ee,ne,ye){var Se={id:ve===void 0?null:ve,type:ee,geometry:ne,tags:ye,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(Me){var Ne=Me.geometry,Be=Me.type;if(Be==="Point"||Be==="MultiPoint"||Be==="LineString")qt(Me,Ne);else if(Be==="Polygon"||Be==="MultiLineString")for(var ke=0;ke<Ne.length;ke++)qt(Me,Ne[ke]);else if(Be==="MultiPolygon")for(ke=0;ke<Ne.length;ke++)for(var qe=0;qe<Ne[ke].length;qe++)qt(Me,Ne[ke][qe])}(Se),Se}function qt(ve,ee){for(var ne=0;ne<ee.length;ne+=3)ve.minX=Math.min(ve.minX,ee[ne]),ve.minY=Math.min(ve.minY,ee[ne+1]),ve.maxX=Math.max(ve.maxX,ee[ne]),ve.maxY=Math.max(ve.maxY,ee[ne+1])}function Tt(ve,ee,ne,ye){if(ee.geometry){var Se=ee.geometry.coordinates,Me=ee.geometry.type,Ne=Math.pow(ne.tolerance/((1<<ne.maxZoom)*ne.extent),2),Be=[],ke=ee.id;if(ne.promoteId?ke=ee.properties[ne.promoteId]:ne.generateId&&(ke=ye||0),Me==="Point")St(Se,Be);else if(Me==="MultiPoint")for(var qe=0;qe<Se.length;qe++)St(Se[qe],Be);else if(Me==="LineString")Et(Se,Be,Ne,!1);else if(Me==="MultiLineString"){if(ne.lineMetrics){for(qe=0;qe<Se.length;qe++)Et(Se[qe],Be=[],Ne,!1),ve.push(Le(ke,"LineString",Be,ee.properties));return}Ft(Se,Be,Ne,!1)}else if(Me==="Polygon")Ft(Se,Be,Ne,!0);else{if(Me!=="MultiPolygon"){if(Me==="GeometryCollection"){for(qe=0;qe<ee.geometry.geometries.length;qe++)Tt(ve,{id:ke,geometry:ee.geometry.geometries[qe],properties:ee.properties},ne,ye);return}throw new Error("Input data is not a valid GeoJSON object.")}for(qe=0;qe<Se.length;qe++){var xt=[];Ft(Se[qe],xt,Ne,!0),Be.push(xt)}}ve.push(Le(ke,Me,Be,ee.properties))}}function St(ve,ee){ee.push(un(ve[0])),ee.push(Gr(ve[1])),ee.push(0)}function Et(ve,ee,ne,ye){for(var Se,Me,Ne=0,Be=0;Be<ve.length;Be++){var ke=un(ve[Be][0]),qe=Gr(ve[Be][1]);ee.push(ke),ee.push(qe),ee.push(0),Be>0&&(Ne+=ye?(Se*qe-ke*Me)/2:Math.sqrt(Math.pow(ke-Se,2)+Math.pow(qe-Me,2))),Se=ke,Me=qe}var xt=ee.length-3;ee[2]=1,Jt(ee,0,xt,ne),ee[xt+2]=1,ee.size=Math.abs(Ne),ee.start=0,ee.end=ee.size}function Ft(ve,ee,ne,ye){for(var Se=0;Se<ve.length;Se++){var Me=[];Et(ve[Se],Me,ne,ye),ee.push(Me)}}function un(ve){return ve/360+.5}function Gr(ve){var ee=Math.sin(ve*Math.PI/180),ne=.5-.25*Math.log((1+ee)/(1-ee))/Math.PI;return ne<0?0:ne>1?1:ne}function hn(ve,ee,ne,ye,Se,Me,Ne,Be){if(ye/=ee,Me>=(ne/=ee)&&Ne<ye)return ve;if(Ne<ne||Me>=ye)return null;for(var ke=[],qe=0;qe<ve.length;qe++){var xt=ve[qe],wt=xt.geometry,gt=xt.type,or=Se===0?xt.minX:xt.minY,mr=Se===0?xt.maxX:xt.maxY;if(or>=ne&&mr<ye)ke.push(xt);else if(!(mr<ne||or>=ye)){var sr=[];if(gt==="Point"||gt==="MultiPoint")zi(wt,sr,ne,ye,Se);else if(gt==="LineString")jn(wt,sr,ne,ye,Se,!1,Be.lineMetrics);else if(gt==="MultiLineString")Zi(wt,sr,ne,ye,Se,!1);else if(gt==="Polygon")Zi(wt,sr,ne,ye,Se,!0);else if(gt==="MultiPolygon")for(var gr=0;gr<wt.length;gr++){var vr=[];Zi(wt[gr],vr,ne,ye,Se,!0),vr.length&&sr.push(vr)}if(sr.length){if(Be.lineMetrics&&gt==="LineString"){for(gr=0;gr<sr.length;gr++)ke.push(Le(xt.id,gt,sr[gr],xt.tags));continue}gt!=="LineString"&&gt!=="MultiLineString"||(sr.length===1?(gt="LineString",sr=sr[0]):gt="MultiLineString"),gt!=="Point"&&gt!=="MultiPoint"||(gt=sr.length===3?"Point":"MultiPoint"),ke.push(Le(xt.id,gt,sr,xt.tags))}}}return ke.length?ke:null}function zi(ve,ee,ne,ye,Se){for(var Me=0;Me<ve.length;Me+=3){var Ne=ve[Me+Se];Ne>=ne&&Ne<=ye&&(ee.push(ve[Me]),ee.push(ve[Me+1]),ee.push(ve[Me+2]))}}function jn(ve,ee,ne,ye,Se,Me,Ne){for(var Be,ke,qe=oo(ve),xt=Se===0?Ha:Ol,wt=ve.start,gt=0;gt<ve.length-3;gt+=3){var or=ve[gt],mr=ve[gt+1],sr=ve[gt+2],gr=ve[gt+3],vr=ve[gt+4],dn=Se===0?or:mr,An=Se===0?gr:vr,hi=!1;Ne&&(Be=Math.sqrt(Math.pow(or-gr,2)+Math.pow(mr-vr,2))),dn<ne?An>ne&&(ke=xt(qe,or,mr,gr,vr,ne),Ne&&(qe.start=wt+Be*ke)):dn>ye?An<ye&&(ke=xt(qe,or,mr,gr,vr,ye),Ne&&(qe.start=wt+Be*ke)):so(qe,or,mr,sr),An<ne&&dn>=ne&&(ke=xt(qe,or,mr,gr,vr,ne),hi=!0),An>ye&&dn<=ye&&(ke=xt(qe,or,mr,gr,vr,ye),hi=!0),!Me&&hi&&(Ne&&(qe.end=wt+Be*ke),ee.push(qe),qe=oo(ve)),Ne&&(wt+=Be)}var Pn=ve.length-3;or=ve[Pn],mr=ve[Pn+1],sr=ve[Pn+2],(dn=Se===0?or:mr)>=ne&&dn<=ye&&so(qe,or,mr,sr),Pn=qe.length-3,Me&&Pn>=3&&(qe[Pn]!==qe[0]||qe[Pn+1]!==qe[1])&&so(qe,qe[0],qe[1],qe[2]),qe.length&&ee.push(qe)}function oo(ve){var ee=[];return ee.size=ve.size,ee.start=ve.start,ee.end=ve.end,ee}function Zi(ve,ee,ne,ye,Se,Me){for(var Ne=0;Ne<ve.length;Ne++)jn(ve[Ne],ee,ne,ye,Se,Me,!1)}function so(ve,ee,ne,ye){ve.push(ee),ve.push(ne),ve.push(ye)}function Ha(ve,ee,ne,ye,Se,Me){var Ne=(Me-ee)/(ye-ee);return ve.push(Me),ve.push(ne+(Se-ne)*Ne),ve.push(1),Ne}function Ol(ve,ee,ne,ye,Se,Me){var Ne=(Me-ne)/(Se-ne);return ve.push(ee+(ye-ee)*Ne),ve.push(Me),ve.push(1),Ne}function Bi(ve,ee){for(var ne=[],ye=0;ye<ve.length;ye++){var Se,Me=ve[ye],Ne=Me.type;if(Ne==="Point"||Ne==="MultiPoint"||Ne==="LineString")Se=as(Me.geometry,ee);else if(Ne==="MultiLineString"||Ne==="Polygon"){Se=[];for(var Be=0;Be<Me.geometry.length;Be++)Se.push(as(Me.geometry[Be],ee))}else if(Ne==="MultiPolygon")for(Se=[],Be=0;Be<Me.geometry.length;Be++){for(var ke=[],qe=0;qe<Me.geometry[Be].length;qe++)ke.push(as(Me.geometry[Be][qe],ee));Se.push(ke)}ne.push(Le(Me.id,Ne,Se,Me.tags))}return ne}function as(ve,ee){var ne=[];ne.size=ve.size,ve.start!==void 0&&(ne.start=ve.start,ne.end=ve.end);for(var ye=0;ye<ve.length;ye+=3)ne.push(ve[ye]+ee,ve[ye+1],ve[ye+2]);return ne}function Ka(ve,ee){if(ve.transformed)return ve;var ne,ye,Se,Me=1<<ve.z,Ne=ve.x,Be=ve.y;for(ne=0;ne<ve.features.length;ne++){var ke=ve.features[ne],qe=ke.geometry,xt=ke.type;if(ke.geometry=[],xt===1)for(ye=0;ye<qe.length;ye+=2)ke.geometry.push(ao(qe[ye],qe[ye+1],ee,Me,Ne,Be));else for(ye=0;ye<qe.length;ye++){var wt=[];for(Se=0;Se<qe[ye].length;Se+=2)wt.push(ao(qe[ye][Se],qe[ye][Se+1],ee,Me,Ne,Be));ke.geometry.push(wt)}}return ve.transformed=!0,ve}function ao(ve,ee,ne,ye,Se,Me){return[Math.round(ne*(ve*ye-Se)),Math.round(ne*(ee*ye-Me))]}function zn(ve,ee,ne,ye,Se){for(var Me=ee===Se.maxZoom?0:Se.tolerance/((1<<ee)*Se.extent),Ne={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:ne,y:ye,z:ee,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},Be=0;Be<ve.length;Be++){Ne.numFeatures++,Za(Ne,ve[Be],Me,Se);var ke=ve[Be].minX,qe=ve[Be].minY,xt=ve[Be].maxX,wt=ve[Be].maxY;ke<Ne.minX&&(Ne.minX=ke),qe<Ne.minY&&(Ne.minY=qe),xt>Ne.maxX&&(Ne.maxX=xt),wt>Ne.maxY&&(Ne.maxY=wt)}return Ne}function Za(ve,ee,ne,ye){var Se=ee.geometry,Me=ee.type,Ne=[];if(Me==="Point"||Me==="MultiPoint")for(var Be=0;Be<Se.length;Be+=3)Ne.push(Se[Be]),Ne.push(Se[Be+1]),ve.numPoints++,ve.numSimplified++;else if(Me==="LineString")Ms(Ne,Se,ve,ne,!1,!1);else if(Me==="MultiLineString"||Me==="Polygon")for(Be=0;Be<Se.length;Be++)Ms(Ne,Se[Be],ve,ne,Me==="Polygon",Be===0);else if(Me==="MultiPolygon")for(var ke=0;ke<Se.length;ke++){var qe=Se[ke];for(Be=0;Be<qe.length;Be++)Ms(Ne,qe[Be],ve,ne,!0,Be===0)}if(Ne.length){var xt=ee.tags||null;if(Me==="LineString"&&ye.lineMetrics){for(var wt in xt={},ee.tags)xt[wt]=ee.tags[wt];xt.mapbox_clip_start=Se.start/Se.size,xt.mapbox_clip_end=Se.end/Se.size}var gt={geometry:Ne,type:Me==="Polygon"||Me==="MultiPolygon"?3:Me==="LineString"||Me==="MultiLineString"?2:1,tags:xt};ee.id!==null&&(gt.id=ee.id),ve.features.push(gt)}}function Ms(ve,ee,ne,ye,Se,Me){var Ne=ye*ye;if(ye>0&&ee.size<(Se?Ne:ye))ne.numPoints+=ee.length/3;else{for(var Be=[],ke=0;ke<ee.length;ke+=3)(ye===0||ee[ke+2]>Ne)&&(ne.numSimplified++,Be.push(ee[ke]),Be.push(ee[ke+1])),ne.numPoints++;Se&&function(qe,xt){for(var wt=0,gt=0,or=qe.length,mr=or-2;gt<or;mr=gt,gt+=2)wt+=(qe[gt]-qe[mr])*(qe[gt+1]+qe[mr+1]);if(wt>0===xt)for(gt=0,or=qe.length;gt<or/2;gt+=2){var sr=qe[gt],gr=qe[gt+1];qe[gt]=qe[or-2-gt],qe[gt+1]=qe[or-1-gt],qe[or-2-gt]=sr,qe[or-1-gt]=gr}}(Be,Me),ve.push(Be)}}function Ao(ve,ee){var ne=(ee=this.options=function(Se,Me){for(var Ne in Me)Se[Ne]=Me[Ne];return Se}(Object.create(this.options),ee)).debug;if(ne&&console.time("preprocess data"),ee.maxZoom<0||ee.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(ee.promoteId&&ee.generateId)throw new Error("promoteId and generateId cannot be used together.");var ye=function(Se,Me){var Ne=[];if(Se.type==="FeatureCollection")for(var Be=0;Be<Se.features.length;Be++)Tt(Ne,Se.features[Be],Me,Be);else Tt(Ne,Se.type==="Feature"?Se:{geometry:Se},Me);return Ne}(ve,ee);this.tiles={},this.tileCoords=[],ne&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",ee.indexMaxZoom,ee.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),ye=function(Se,Me){var Ne=Me.buffer/Me.extent,Be=Se,ke=hn(Se,1,-1-Ne,Ne,0,-1,2,Me),qe=hn(Se,1,1-Ne,2+Ne,0,-1,2,Me);return(ke||qe)&&(Be=hn(Se,1,-Ne,1+Ne,0,-1,2,Me)||[],ke&&(Be=Bi(ke,1).concat(Be)),qe&&(Be=Be.concat(Bi(qe,-1)))),Be}(ye,ee),ye.length&&this.splitTile(ye,0,0,0),ne&&(ye.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function No(ve,ee,ne){return 32*((1<<ve)*ne+ee)+ve}function ls(ve,ee){const ne=ve.tileID.canonical;if(!this._geoJSONIndex)return ee(null,null);const ye=this._geoJSONIndex.getTile(ne.z,ne.x,ne.y);if(!ye)return ee(null,null);const Se=new class{constructor(Ne){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=s.EXTENT,this.length=Ne.length,this._features=Ne}feature(Ne){return new class{constructor(Be){this._feature=Be,this.extent=s.EXTENT,this.type=Be.type,this.properties=Be.tags,"id"in Be&&!isNaN(Be.id)&&(this.id=parseInt(Be.id,10))}loadGeometry(){if(this._feature.type===1){const Be=[];for(const ke of this._feature.geometry)Be.push([new s.Point(ke[0],ke[1])]);return Be}{const Be=[];for(const ke of this._feature.geometry){const qe=[];for(const xt of ke)qe.push(new s.Point(xt[0],xt[1]));Be.push(qe)}return Be}}toGeoJSON(Be,ke,qe){return j.call(this,Be,ke,qe)}}(this._features[Ne])}}(ye.features);let Me=tt(Se);Me.byteOffset===0&&Me.byteLength===Me.buffer.byteLength||(Me=new Uint8Array(Me)),ee(null,{vectorTile:Se,rawData:Me.buffer})}Ao.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Ao.prototype.splitTile=function(ve,ee,ne,ye,Se,Me,Ne){for(var Be=[ve,ee,ne,ye],ke=this.options,qe=ke.debug;Be.length;){ye=Be.pop(),ne=Be.pop(),ee=Be.pop(),ve=Be.pop();var xt=1<<ee,wt=No(ee,ne,ye),gt=this.tiles[wt];if(!gt&&(qe>1&&console.time("creation"),gt=this.tiles[wt]=zn(ve,ee,ne,ye,ke),this.tileCoords.push({z:ee,x:ne,y:ye}),qe)){qe>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",ee,ne,ye,gt.numFeatures,gt.numPoints,gt.numSimplified),console.timeEnd("creation"));var or="z"+ee;this.stats[or]=(this.stats[or]||0)+1,this.total++}if(gt.source=ve,Se){if(ee===ke.maxZoom||ee===Se)continue;var mr=1<<Se-ee;if(ne!==Math.floor(Me/mr)||ye!==Math.floor(Ne/mr))continue}else if(ee===ke.indexMaxZoom||gt.numPoints<=ke.indexMaxPoints)continue;if(gt.source=null,ve.length!==0){qe>1&&console.time("clipping");var sr,gr,vr,dn,An,hi,Pn=.5*ke.buffer/ke.extent,$o=.5-Pn,Bn=.5+Pn,wi=1+Pn;sr=gr=vr=dn=null,An=hn(ve,xt,ne-Pn,ne+Bn,0,gt.minX,gt.maxX,ke),hi=hn(ve,xt,ne+$o,ne+wi,0,gt.minX,gt.maxX,ke),ve=null,An&&(sr=hn(An,xt,ye-Pn,ye+Bn,1,gt.minY,gt.maxY,ke),gr=hn(An,xt,ye+$o,ye+wi,1,gt.minY,gt.maxY,ke),An=null),hi&&(vr=hn(hi,xt,ye-Pn,ye+Bn,1,gt.minY,gt.maxY,ke),dn=hn(hi,xt,ye+$o,ye+wi,1,gt.minY,gt.maxY,ke),hi=null),qe>1&&console.timeEnd("clipping"),Be.push(sr||[],ee+1,2*ne,2*ye),Be.push(gr||[],ee+1,2*ne,2*ye+1),Be.push(vr||[],ee+1,2*ne+1,2*ye),Be.push(dn||[],ee+1,2*ne+1,2*ye+1)}}},Ao.prototype.getTile=function(ve,ee,ne){var ye=this.options,Se=ye.extent,Me=ye.debug;if(ve<0||ve>24)return null;var Ne=1<<ve,Be=No(ve,ee=(ee%Ne+Ne)%Ne,ne);if(this.tiles[Be])return Ka(this.tiles[Be],Se);Me>1&&console.log("drilling down to z%d-%d-%d",ve,ee,ne);for(var ke,qe=ve,xt=ee,wt=ne;!ke&&qe>0;)qe--,xt=Math.floor(xt/2),wt=Math.floor(wt/2),ke=this.tiles[No(qe,xt,wt)];return ke&&ke.source?(Me>1&&console.log("found parent tile z%d-%d-%d",qe,xt,wt),Me>1&&console.time("drilling down"),this.splitTile(ke.source,qe,xt,wt,ve,ee,ne),Me>1&&console.timeEnd("drilling down"),this.tiles[Be]?Ka(this.tiles[Be],Se):null):null};class cs extends s.VectorTileWorkerSource{constructor(ee,ne,ye,Se,Me){super(ee,ne,ye,Se,ls),Me&&(this.loadGeoJSON=Me)}loadData(ee,ne){const ye=ee&&ee.request,Se=ye&&ye.collectResourceTiming;this.loadGeoJSON(ee,(Me,Ne)=>{if(Me||!Ne)return ne(Me);if(typeof Ne!="object")return ne(new Error(`Input data given to '${ee.source}' is not a valid GeoJSON object.`));{R(Ne,!0);try{if(ee.filter){const ke=s.createExpression(ee.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(ke.result==="error")throw new Error(ke.value.map(xt=>`${xt.key}: ${xt.message}`).join(", "));Ne={type:"FeatureCollection",features:Ne.features.filter(xt=>ke.value.evaluate({zoom:0},xt))}}this._geoJSONIndex=ee.cluster?new $t(function({superclusterOptions:ke,clusterProperties:qe}){if(!qe||!ke)return ke;const xt={},wt={},gt={accumulated:null,zoom:0},or={properties:null},mr=Object.keys(qe);for(const sr of mr){const[gr,vr]=qe[sr],dn=s.createExpression(vr),An=s.createExpression(typeof gr=="string"?[gr,["accumulated"],["get",sr]]:gr);xt[sr]=dn.value,wt[sr]=An.value}return ke.map=sr=>{or.properties=sr;const gr={};for(const vr of mr)gr[vr]=xt[vr].evaluate(gt,or);return gr},ke.reduce=(sr,gr)=>{or.properties=gr;for(const vr of mr)gt.accumulated=sr[vr],sr[vr]=wt[vr].evaluate(gt,or)},ke}(ee)).load(Ne.features):function(ke,qe){return new Ao(ke,qe)}(Ne,ee.geojsonVtOptions)}catch(ke){return ne(ke)}this.loaded={};const Be={};if(Se){const ke=s.getPerformanceMeasurement(ye);ke&&(Be.resourceTiming={},Be.resourceTiming[ee.source]=JSON.parse(JSON.stringify(ke)))}ne(null,Be)}})}reloadTile(ee,ne){const ye=this.loaded;return ye&&ye[ee.uid]?super.reloadTile(ee,ne):this.loadTile(ee,ne)}loadGeoJSON(ee,ne){if(ee.request)s.getJSON(ee.request,ne);else{if(typeof ee.data!="string")return ne(new Error(`Input data given to '${ee.source}' is not a valid GeoJSON object.`));try{return ne(null,JSON.parse(ee.data))}catch{return ne(new Error(`Input data given to '${ee.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(ee,ne){try{ne(null,this._geoJSONIndex.getClusterExpansionZoom(ee.clusterId))}catch(ye){ne(ye)}}getClusterChildren(ee,ne){try{ne(null,this._geoJSONIndex.getChildren(ee.clusterId))}catch(ye){ne(ye)}}getClusterLeaves(ee,ne){try{ne(null,this._geoJSONIndex.getLeaves(ee.clusterId,ee.limit,ee.offset))}catch(ye){ne(ye)}}}class Xa{constructor(ee){this.self=ee,this.actor=new s.Actor(ee,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=s.getProjection({name:"mercator"}),this.workerSourceTypes={vector:s.VectorTileWorkerSource,geojson:cs},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(ne,ye)=>{if(this.workerSourceTypes[ne])throw new Error(`Worker source with name "${ne}" already registered.`);this.workerSourceTypes[ne]=ye},this.self.registerRTLTextPlugin=ne=>{if(s.plugin.isParsed())throw new Error("RTL text plugin already registered.");s.plugin.applyArabicShaping=ne.applyArabicShaping,s.plugin.processBidirectionalText=ne.processBidirectionalText,s.plugin.processStyledBidirectionalText=ne.processStyledBidirectionalText}}clearCaches(ee,ne,ye){delete this.layerIndexes[ee],delete this.availableImages[ee],delete this.workerSources[ee],delete this.demWorkerSources[ee],ye()}checkIfReady(ee,ne,ye){ye()}setReferrer(ee,ne){this.referrer=ne}spriteLoaded(ee,ne){this.isSpriteLoaded[ee]=ne;for(const ye in this.workerSources[ee]){const Se=this.workerSources[ee][ye];for(const Me in Se)Se[Me]instanceof s.VectorTileWorkerSource&&(Se[Me].isSpriteLoaded=ne,Se[Me].fire(new s.Event("isSpriteLoaded")))}}setImages(ee,ne,ye){this.availableImages[ee]=ne;for(const Se in this.workerSources[ee]){const Me=this.workerSources[ee][Se];for(const Ne in Me)Me[Ne].availableImages=ne}ye()}enableTerrain(ee,ne,ye){this.terrain=ne,ye()}setProjection(ee,ne){this.projections[ee]=s.getProjection(ne)}setLayers(ee,ne,ye){this.getLayerIndex(ee).replace(ne),ye()}updateLayers(ee,ne,ye){this.getLayerIndex(ee).update(ne.layers,ne.removedIds),ye()}loadTile(ee,ne,ye){const Se=this.enableTerrain?s.extend({enableTerrain:this.terrain},ne):ne;Se.projection=this.projections[ee]||this.defaultProjection,this.getWorkerSource(ee,ne.type,ne.source).loadTile(Se,ye)}loadDEMTile(ee,ne,ye){const Se=this.enableTerrain?s.extend({buildQuadTree:this.terrain},ne):ne;this.getDEMWorkerSource(ee,ne.source).loadTile(Se,ye)}reloadTile(ee,ne,ye){const Se=this.enableTerrain?s.extend({enableTerrain:this.terrain},ne):ne;Se.projection=this.projections[ee]||this.defaultProjection,this.getWorkerSource(ee,ne.type,ne.source).reloadTile(Se,ye)}abortTile(ee,ne,ye){this.getWorkerSource(ee,ne.type,ne.source).abortTile(ne,ye)}removeTile(ee,ne,ye){this.getWorkerSource(ee,ne.type,ne.source).removeTile(ne,ye)}removeSource(ee,ne,ye){if(!this.workerSources[ee]||!this.workerSources[ee][ne.type]||!this.workerSources[ee][ne.type][ne.source])return;const Se=this.workerSources[ee][ne.type][ne.source];delete this.workerSources[ee][ne.type][ne.source],Se.removeSource!==void 0?Se.removeSource(ne,ye):ye()}loadWorkerSource(ee,ne,ye){try{this.self.importScripts(ne.url),ye()}catch(Se){ye(Se.toString())}}syncRTLPluginState(ee,ne,ye){try{s.plugin.setState(ne);const Se=s.plugin.getPluginURL();if(s.plugin.isLoaded()&&!s.plugin.isParsed()&&Se!=null){this.self.importScripts(Se);const Me=s.plugin.isParsed();ye(Me?void 0:new Error(`RTL Text Plugin failed to import scripts from ${Se}`),Me)}}catch(Se){ye(Se.toString())}}getAvailableImages(ee){let ne=this.availableImages[ee];return ne||(ne=[]),ne}getLayerIndex(ee){let ne=this.layerIndexes[ee];return ne||(ne=this.layerIndexes[ee]=new w),ne}getWorkerSource(ee,ne,ye){if(this.workerSources[ee]||(this.workerSources[ee]={}),this.workerSources[ee][ne]||(this.workerSources[ee][ne]={}),!this.workerSources[ee][ne][ye]){const Se={send:(Me,Ne,Be,ke,qe,xt)=>{this.actor.send(Me,Ne,Be,ee,qe,xt)},scheduler:this.actor.scheduler};this.workerSources[ee][ne][ye]=new this.workerSourceTypes[ne](Se,this.getLayerIndex(ee),this.getAvailableImages(ee),this.isSpriteLoaded[ee])}return this.workerSources[ee][ne][ye]}getDEMWorkerSource(ee,ne){return this.demWorkerSources[ee]||(this.demWorkerSources[ee]={}),this.demWorkerSources[ee][ne]||(this.demWorkerSources[ee][ne]=new A),this.demWorkerSources[ee][ne]}enforceCacheSizeLimit(ee,ne){s.enforceCacheSizeLimit(ne)}getWorkerPerformanceMetrics(ee,ne,ye){ye(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new Xa(self)),Xa}),h(["./shared"],function(s){function y(g,u){if(Array.isArray(g)){if(!Array.isArray(u)||g.length!==u.length)return!1;for(let p=0;p<g.length;p++)if(!y(g[p],u[p]))return!1;return!0}if(typeof g=="object"&&g!==null&&u!==null){if(typeof u!="object"||Object.keys(g).length!==Object.keys(u).length)return!1;for(const p in g)if(!y(g[p],u[p]))return!1;return!0}return g===u}var b=w;function w(g){return!function(u){return typeof window>"u"||typeof document>"u"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var _,S,E=new Blob([""],{type:"text/javascript"}),O=URL.createObjectURL(E);try{S=new Worker(O),_=!0}catch{_=!1}return S&&S.terminate(),URL.revokeObjectURL(O),_}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var _=document.createElement("canvas");_.width=_.height=1;var S=_.getContext("2d");if(!S)return!1;var E=S.getImageData(0,0,1,1);return E&&E.width===_.width}()?(A[p=u&&u.failIfMajorPerformanceCaveat]===void 0&&(A[p]=function(_){var S,E=function(O){var I=document.createElement("canvas"),N=Object.create(w.webGLContextAttributes);return N.failIfMajorPerformanceCaveat=O,I.getContext("webgl",N)||I.getContext("experimental-webgl",N)}(_);if(!E)return!1;try{S=E.createShader(E.VERTEX_SHADER)}catch{return!1}return!(!S||E.isContextLost())&&(E.shaderSource(S,"void main() {}"),E.compileShader(S),E.getShaderParameter(S,E.COMPILE_STATUS)===!0)}(p)),A[p]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var p}(g)}var A={};function k(g,u,p){const _=s.window.document.createElement(g);return u!==void 0&&(_.className=u),p&&p.appendChild(_),_}function M(g,u,p){const _=s.window.document.createElementNS("http://www.w3.org/2000/svg",g);for(const S of Object.keys(u))_.setAttributeNS(null,S,u[S]);return p&&p.appendChild(_),_}w.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const R=s.window.document&&s.window.document.documentElement.style,j=R&&R.userSelect!==void 0?"userSelect":"WebkitUserSelect";let L;function z(){R&&j&&(L=R[j],R[j]="none")}function B(){R&&j&&(R[j]=L)}function Z(g){g.preventDefault(),g.stopPropagation(),s.window.removeEventListener("click",Z,!0)}function F(){s.window.addEventListener("click",Z,!0),s.window.setTimeout(()=>{s.window.removeEventListener("click",Z,!0)},0)}function H(g,u){const p=g.getBoundingClientRect();return pe(g,p,u)}function Y(g,u){const p=g.getBoundingClientRect(),_=[];for(let S=0;S<u.length;S++)_.push(pe(g,p,u[S]));return _}function te(g){return s.window.InstallTrigger!==void 0&&g.button===2&&g.ctrlKey&&s.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:g.button}function pe(g,u,p){const _=g.offsetWidth===u.width?1:g.offsetWidth/u.width;return new s.Point((p.clientX-u.left)*_,(p.clientY-u.top)*_)}function ue(g,u){var p=u[0],_=u[1],S=u[2],E=u[3],O=p*E-S*_;return O?(g[0]=E*(O=1/O),g[1]=-_*O,g[2]=-S*O,g[3]=p*O,g):null}function Ee(g){const{userImage:u}=g;return!!(u&&u.render&&u.render())&&(g.data.replace(new Uint8Array(u.data.buffer)),!0)}class Oe extends s.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new s.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(u){if(this.loaded!==u&&(this.loaded=u,u)){for(const{ids:p,callback:_}of this.requestors)this._notify(p,_);this.requestors=[]}}hasImage(u){return!!this.getImage(u)}getImage(u){return this.images[u]}addImage(u,p){this._validate(u,p)&&(this.images[u]=p)}_validate(u,p){let _=!0;return this._validateStretch(p.stretchX,p.data&&p.data.width)||(this.fire(new s.ErrorEvent(new Error(`Image "${u}" has invalid "stretchX" value`))),_=!1),this._validateStretch(p.stretchY,p.data&&p.data.height)||(this.fire(new s.ErrorEvent(new Error(`Image "${u}" has invalid "stretchY" value`))),_=!1),this._validateContent(p.content,p)||(this.fire(new s.ErrorEvent(new Error(`Image "${u}" has invalid "content" value`))),_=!1),_}_validateStretch(u,p){if(!u)return!0;let _=0;for(const S of u){if(S[0]<_||S[1]<S[0]||p<S[1])return!1;_=S[1]}return!0}_validateContent(u,p){return!(u&&(u.length!==4||u[0]<0||p.data.width<u[0]||u[1]<0||p.data.height<u[1]||u[2]<0||p.data.width<u[2]||u[3]<0||p.data.height<u[3]||u[2]<u[0]||u[3]<u[1]))}updateImage(u,p){p.version=this.images[u].version+1,this.images[u]=p,this.updatedImages[u]=!0}removeImage(u){const p=this.images[u];delete this.images[u],delete this.patterns[u],p.userImage&&p.userImage.onRemove&&p.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(u,p){let _=!0;if(!this.isLoaded())for(const S of u)this.images[S]||(_=!1);this.isLoaded()||_?this._notify(u,p):this.requestors.push({ids:u,callback:p})}_notify(u,p){const _={};for(const S of u){this.images[S]||this.fire(new s.Event("styleimagemissing",{id:S}));const E=this.images[S];E?_[S]={data:E.data.clone(),pixelRatio:E.pixelRatio,sdf:E.sdf,version:E.version,stretchX:E.stretchX,stretchY:E.stretchY,content:E.content,hasRenderCallback:!!(E.userImage&&E.userImage.render)}:s.warnOnce(`Image "${S}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}p(null,_)}getPixelSize(){const{width:u,height:p}=this.atlasImage;return{width:u,height:p}}getPattern(u){const p=this.patterns[u],_=this.getImage(u);if(!_)return null;if(p&&p.position.version===_.version)return p.position;if(p)p.position.version=_.version;else{const S={w:_.data.width+2,h:_.data.height+2,x:0,y:0},E=new s.ImagePosition(S,_);this.patterns[u]={bin:S,position:E}}return this._updatePatternAtlas(),this.patterns[u].position}bind(u){const p=u.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new s.Texture(u,this.atlasImage,p.RGBA),this.atlasTexture&&this.atlasTexture.bind(p.LINEAR,p.CLAMP_TO_EDGE)}_updatePatternAtlas(){const u=[];for(const E in this.patterns)u.push(this.patterns[E].bin);const{w:p,h:_}=s.potpack(u),S=this.atlasImage;S.resize({width:p||1,height:_||1});for(const E in this.patterns){const{bin:O}=this.patterns[E],I=O.x+1,N=O.y+1,G=this.images[E].data,V=G.width,X=G.height;s.RGBAImage.copy(G,S,{x:0,y:0},{x:I,y:N},{width:V,height:X}),s.RGBAImage.copy(G,S,{x:0,y:X-1},{x:I,y:N-1},{width:V,height:1}),s.RGBAImage.copy(G,S,{x:0,y:0},{x:I,y:N+X},{width:V,height:1}),s.RGBAImage.copy(G,S,{x:V-1,y:0},{x:I-1,y:N},{width:1,height:X}),s.RGBAImage.copy(G,S,{x:0,y:0},{x:I+V,y:N},{width:1,height:X})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(u){for(const p of u){if(this.callbackDispatchedThisFrame[p])continue;this.callbackDispatchedThisFrame[p]=!0;const _=this.images[p];Ee(_)&&this.updateImage(p,_)}}}const je=new s.Properties({anchor:new s.DataConstantProperty(s.spec.light.anchor),position:new class{constructor(){this.specification=s.spec.light.position}possiblyEvaluate(g,u){return function([p,_,S]){const E=s.degToRad(_+90),O=s.degToRad(S);return{x:p*Math.cos(E)*Math.sin(O),y:p*Math.sin(E)*Math.sin(O),z:p*Math.cos(O),azimuthal:_,polar:S}}(g.expression.evaluate(u))}interpolate(g,u,p){return{x:s.number(g.x,u.x,p),y:s.number(g.y,u.y,p),z:s.number(g.z,u.z,p),azimuthal:s.number(g.azimuthal,u.azimuthal,p),polar:s.number(g.polar,u.polar,p)}}},color:new s.DataConstantProperty(s.spec.light.color),intensity:new s.DataConstantProperty(s.spec.light.intensity)});class Ge extends s.Evented{constructor(u){super(),this._transitionable=new s.Transitionable(je),this.setLight(u),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(u,p={}){if(!this._validate(s.validateLight,u,p))for(const _ in u){const S=u[_];s.endsWith(_,"-transition")?this._transitionable.setTransition(_.slice(0,-11),S):this._transitionable.setValue(_,S)}}updateTransitions(u){this._transitioning=this._transitionable.transitioned(u,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(u){this.properties=this._transitioning.possiblyEvaluate(u)}_validate(u,p,_){return(!_||_.validate!==!1)&&s.emitValidationErrors(this,u.call(s.validateStyle,s.extend({value:p,style:{glyphs:!0,sprite:!0},styleSpec:s.spec})))}}const Ze=new s.Properties({source:new s.DataConstantProperty(s.spec.terrain.source),exaggeration:new s.DataConstantProperty(s.spec.terrain.exaggeration)});let Ye=class extends s.Evented{constructor(g,u){super(),this._transitionable=new s.Transitionable(Ze),this.set(g),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=u}get(){return this._transitionable.serialize()}set(g){for(const u in g){const p=g[u];s.endsWith(u,"-transition")?this._transitionable.setTransition(u.slice(0,-11),p):this._transitionable.setValue(u,p)}}updateTransitions(g){this._transitioning=this._transitionable.transitioned(g,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(g){this.properties=this._transitioning.possiblyEvaluate(g)}};function tt(g,u,p,_){const S=s.smoothstep(45,65,p),[E,O]=ze(g,_),I=s.length(u);let N=1-Math.min(1,Math.exp((I-E)/(O-E)*-6));return N*=N*N,N=Math.min(1,1.00747*N),N*S*g.alpha}function ze(g,u){const p=.5/Math.tan(.5*u);return[g.range[0]+p,g.range[1]+p]}const De=new s.Properties({range:new s.DataConstantProperty(s.spec.fog.range),color:new s.DataConstantProperty(s.spec.fog.color),"high-color":new s.DataConstantProperty(s.spec.fog["high-color"]),"space-color":new s.DataConstantProperty(s.spec.fog["space-color"]),"horizon-blend":new s.DataConstantProperty(s.spec.fog["horizon-blend"]),"star-intensity":new s.DataConstantProperty(s.spec.fog["star-intensity"])});class ut extends s.Evented{constructor(u,p){super(),this._transitionable=new s.Transitionable(De),this.set(u),this._transitioning=this._transitionable.untransitioned(),this._transform=p}get state(){const u=this._transform,p=u.projection.name==="globe",_=s.globeToMercatorTransition(u.zoom),S=this.properties.get("range"),E=[.5,3];return{range:p?[s.number(E[0],S[0],_),s.number(E[1],S[1],_)]:S,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(u,p={}){if(!this._validate(s.validateFog,u,p)){for(const _ of Object.keys(s.spec.fog))u&&u[_]===void 0&&(u[_]=s.spec.fog[_].default);for(const _ in u){const S=u[_];s.endsWith(_,"-transition")?this._transitionable.setTransition(_.slice(0,-11),S):this._transitionable.setValue(_,S)}}}getOpacity(u){if(!this._transform.projection.supportsFog)return 0;const p=this.properties&&this.properties.get("color")||1;return(this._transform.projection.name==="globe"?1:s.smoothstep(45,65,u))*p.a}getOpacityAtLatLng(u,p){return this._transform.projection.supportsFog?function(_,S,E){const O=s.MercatorCoordinate.fromLngLat(S),I=E.elevation?E.elevation.getAtPointOrZero(O):0,N=[O.x,O.y,I];return s.transformMat4(N,N,E.mercatorFogMatrix),tt(_,N,E.pitch,E._fov)}(this.state,u,p):0}getFovAdjustedRange(u){return this._transform.projection.supportsFog?ze(this.state,u):[0,1]}updateTransitions(u){this._transitioning=this._transitionable.transitioned(u,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(u){this.properties=this._transitioning.possiblyEvaluate(u)}_validate(u,p,_){return(!_||_.validate!==!1)&&s.emitValidationErrors(this,u.call(s.validateStyle,s.extend({value:p,style:{glyphs:!0,sprite:!0},styleSpec:s.spec})))}}class ht{constructor(u,p){this.workerPool=u,this.actors=[],this.currentActor=0,this.id=s.uniqueId();const _=this.workerPool.acquire(this.id);for(let S=0;S<_.length;S++){const E=new ht.Actor(_[S],p,this.id);E.name=`Worker ${S}`,this.actors.push(E)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(u,p,_){s.asyncAll(this.actors,(S,E)=>{S.send(u,p,E)},_=_||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(u=>{u.remove()}),this.actors=[],this.workerPool.release(this.id)}}function at(g,u,p){return u*(s.EXTENT/(g.tileSize*Math.pow(2,p-g.tileID.overscaledZ)))}ht.Actor=s.Actor;class Lt{constructor(u,p,_,S){this.screenBounds=u,this.cameraPoint=p,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=_,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,S)}static createFromScreenPoints(u,p){let _,S;if(u instanceof s.Point||typeof u[0]=="number"){const E=s.Point.convert(u);_=[E],S=p.isPointAboveHorizon(E)}else{const E=s.Point.convert(u[0]),O=s.Point.convert(u[1]);_=[E,O],S=s.polygonizeBounds(E,O).every(I=>p.isPointAboveHorizon(I))}return new Lt(_,p.getCameraPoint(),S,p)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(u){return s.polygonizeBounds(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],u)}bufferedCameraGeometry(u){const p=this.screenBounds[0],_=this.screenBounds.length===1?this.screenBounds[0].add(new s.Point(1,1)):this.screenBounds[1],S=s.polygonizeBounds(p,_,0,!1);return this.cameraPoint.y>_.y&&(this.cameraPoint.x>p.x&&this.cameraPoint.x<_.x?S.splice(3,0,this.cameraPoint):this.cameraPoint.x>=_.x?S[2]=this.cameraPoint:this.cameraPoint.x<=p.x&&(S[3]=this.cameraPoint)),s.bufferConvexPolygon(S,u)}bufferedCameraGeometryGlobe(u){const p=this.screenBounds[0],_=this.screenBounds.length===1?this.screenBounds[0].add(new s.Point(1,1)):this.screenBounds[1],S=s.polygonizeBounds(p,_,u),E=this.cameraPoint.clone();switch(3*((E.y>p.y)+(E.y>_.y))+((E.x>p.x)+(E.x>_.x))){case 0:S[0]=E,S[4]=E.clone();break;case 1:S.splice(1,0,E);break;case 2:S[1]=E;break;case 3:S.splice(4,0,E);break;case 5:S.splice(2,0,E);break;case 6:S[3]=E;break;case 7:S.splice(3,0,E);break;case 8:S[2]=E}return S}containsTile(u,p,_,S=0){const E=u.queryPadding/p._pixelsPerMercatorPixel+1,O=_?this._bufferedCameraMercator(E,p):this._bufferedScreenMercator(E,p);let I=u.tileID.wrap+(O.unwrapped?S:0);const N=O.polygon.map(he=>s.getTilePoint(u.tileTransform,he,I));if(!s.polygonIntersectsBox(N,0,0,s.EXTENT,s.EXTENT))return;I=u.tileID.wrap+(this.screenGeometryMercator.unwrapped?S:0);const G=this.screenGeometryMercator.polygon.map(he=>s.getTileVec3(u.tileTransform,he,I)),V=G.map(he=>new s.Point(he[0],he[1])),X=p.getFreeCameraOptions().position||new s.MercatorCoordinate(0,0,0),ie=s.getTileVec3(u.tileTransform,X,I),ae=G.map(he=>{const J=s.sub(he,he,ie);return s.normalize(J,J),new s.Ray(ie,J)}),ce=at(u,1,p.zoom)*p._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:V,tilespaceRays:ae,bufferedTilespaceGeometry:N,bufferedTilespaceBounds:(le=s.getBounds(N),le.min.x=s.clamp(le.min.x,0,s.EXTENT),le.min.y=s.clamp(le.min.y,0,s.EXTENT),le.max.x=s.clamp(le.max.x,0,s.EXTENT),le.max.y=s.clamp(le.max.y,0,s.EXTENT),le),tile:u,tileID:u.tileID,pixelToTileUnitsFactor:ce};var le}_bufferedScreenMercator(u,p){const _=Br(u);if(this._screenRaycastCache[_])return this._screenRaycastCache[_];{let S;return S=p.projection.name==="globe"?this._projectAndResample(this.bufferedScreenGeometry(u),p):{polygon:this.bufferedScreenGeometry(u).map(E=>p.pointCoordinate3D(E)),unwrapped:!0},this._screenRaycastCache[_]=S,S}}_bufferedCameraMercator(u,p){const _=Br(u);if(this._cameraRaycastCache[_])return this._cameraRaycastCache[_];{let S;return S=p.projection.name==="globe"?this._projectAndResample(this.bufferedCameraGeometryGlobe(u),p):{polygon:this.bufferedCameraGeometry(u).map(E=>p.pointCoordinate3D(E)),unwrapped:!0},this._cameraRaycastCache[_]=S,S}}_projectAndResample(u,p){const _=function(E,O){const I=s.multiply([],O.pixelMatrix,O.globeMatrix),N=[0,-s.GLOBE_RADIUS,0,1],G=[0,s.GLOBE_RADIUS,0,1],V=[0,0,0,1];s.transformMat4$1(N,N,I),s.transformMat4$1(G,G,I),s.transformMat4$1(V,V,I);const X=new s.Point(N[0]/N[3],N[1]/N[3]),ie=new s.Point(G[0]/G[3],G[1]/G[3]),ae=s.polygonContainsPoint(E,X)&&N[3]<V[3],ce=s.polygonContainsPoint(E,ie)&&G[3]<V[3];if(!ae&&!ce)return null;const le=function(Ae,Re,Ie){for(let Ve=1;Ve<Ae.length;Ve++){const pt=Tr(Re.pointCoordinate3D(Ae[Ve-1]).x),$e=Tr(Re.pointCoordinate3D(Ae[Ve]).x);if(Ie<0){if(pt<$e)return{idx:Ve,t:-pt/($e-1-pt)}}else if($e<pt)return{idx:Ve,t:(1-pt)/($e+1-pt)}}return null}(E,O,ae?-1:1);if(!le)return null;const{idx:he,t:J}=le;let se=he>1?$t(E.slice(0,he),O):[],me=he<E.length?$t(E.slice(he),O):[];se=se.map(Ae=>new s.Point(Tr(Ae.x),Ae.y)),me=me.map(Ae=>new s.Point(Tr(Ae.x),Ae.y));const ge=[...se];ge.length===0&&ge.push(me[me.length-1]);const Te=s.number(ge[ge.length-1].y,(me.length===0?se[0]:me[0]).y,J);let Pe;return Pe=ae?[new s.Point(0,Te),new s.Point(0,0),new s.Point(1,0),new s.Point(1,Te)]:[new s.Point(1,Te),new s.Point(1,1),new s.Point(0,1),new s.Point(0,Te)],ge.push(...Pe),me.length===0?ge.push(se[0]):ge.push(...me),{polygon:ge.map(Ae=>new s.MercatorCoordinate(Ae.x,Ae.y)),unwrapped:!1}}(u,p);if(_)return _;const S=function(E,O){let I=!1,N=-1/0,G=0;for(let X=0;X<E.length-1;X++)E[X].x>N&&(N=E[X].x,G=X);for(let X=0;X<E.length-1;X++){const ie=(G+X)%(E.length-1),ae=E[ie],ce=E[ie+1];Math.abs(ae.x-ce.x)>.5&&(ae.x<ce.x?(ae.x+=1,ie===0&&(E[E.length-1].x+=1)):(ce.x+=1,ie+1===E.length-1&&(E[0].x+=1)),I=!0)}const V=s.mercatorXfromLng(O.center.lng);return I&&V<Math.abs(V-1)&&E.forEach(X=>{X.x-=1}),{polygon:E,unwrapped:I}}($t(u,p).map(E=>new s.Point(Tr(E.x),E.y)),p);return{polygon:S.polygon.map(E=>new s.MercatorCoordinate(E.x,E.y)),unwrapped:S.unwrapped}}}function $t(g,u){return s.resample(g,p=>{const _=u.pointCoordinate3D(p);p.x=_.x,p.y=_.y},1/256)}function Tr(g){return g<0?1+g%1:g%1}function Br(g){return 100*g|0}function cn(g,u,p,_,S){const E=function(O,I){if(O)return S(O);if(I){g.url&&I.tiles&&g.tiles&&delete g.tiles;const N=s.pick(s.extend(I,g),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);I.vector_layers&&(N.vectorLayers=I.vector_layers,N.vectorLayerIds=N.vectorLayers.map(G=>G.id)),N.tiles=u.canonicalizeTileset(N,g.url),S(null,N)}};return g.url?s.getJSON(u.transformRequest(u.normalizeSourceURL(g.url,null,p,_),s.ResourceType.Source),E):s.exported.frame(()=>E(null,g))}class Vr{constructor(u,p,_){this.bounds=s.LngLatBounds.convert(this.validateBounds(u)),this.minzoom=p||0,this.maxzoom=_||24}validateBounds(u){return Array.isArray(u)&&u.length===4?[Math.max(-180,u[0]),Math.max(-90,u[1]),Math.min(180,u[2]),Math.min(90,u[3])]:[-180,-90,180,90]}contains(u){const p=Math.pow(2,u.z),_=Math.floor(s.mercatorXfromLng(this.bounds.getWest())*p),S=Math.floor(s.mercatorYfromLat(this.bounds.getNorth())*p),E=Math.ceil(s.mercatorXfromLng(this.bounds.getEast())*p),O=Math.ceil(s.mercatorYfromLat(this.bounds.getSouth())*p);return u.x>=_&&u.x<E&&u.y>=S&&u.y<O}}class Dt{constructor(u,p,_){this.context=u;const S=u.gl;this.buffer=S.createBuffer(),this.dynamicDraw=!!_,this.context.unbindVAO(),u.bindElementBuffer.set(this.buffer),S.bufferData(S.ELEMENT_ARRAY_BUFFER,p.arrayBuffer,this.dynamicDraw?S.DYNAMIC_DRAW:S.STATIC_DRAW),this.dynamicDraw||p.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(u){const p=this.context.gl;this.context.unbindVAO(),this.bind(),p.bufferSubData(p.ELEMENT_ARRAY_BUFFER,0,u.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Jt={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class rr{constructor(u,p,_,S){this.length=p.length,this.attributes=_,this.itemSize=p.bytesPerElement,this.dynamicDraw=S,this.context=u;const E=u.gl;this.buffer=E.createBuffer(),u.bindVertexBuffer.set(this.buffer),E.bufferData(E.ARRAY_BUFFER,p.arrayBuffer,this.dynamicDraw?E.DYNAMIC_DRAW:E.STATIC_DRAW),this.dynamicDraw||p.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(u){const p=this.context.gl;this.bind(),p.bufferSubData(p.ARRAY_BUFFER,0,u.arrayBuffer)}enableAttributes(u,p){for(let _=0;_<this.attributes.length;_++){const S=p.attributes[this.attributes[_].name];S!==void 0&&u.enableVertexAttribArray(S)}}setVertexAttribPointers(u,p,_){for(let S=0;S<this.attributes.length;S++){const E=this.attributes[S],O=p.attributes[E.name];O!==void 0&&u.vertexAttribPointer(O,E.components,u[Jt[E.type]],!1,this.itemSize,E.offset+this.itemSize*(_||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Le{constructor(u){this.gl=u.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(u){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class qt extends Le{getDefault(){return s.Color.transparent}set(u){const p=this.current;(u.r!==p.r||u.g!==p.g||u.b!==p.b||u.a!==p.a||this.dirty)&&(this.gl.clearColor(u.r,u.g,u.b,u.a),this.current=u,this.dirty=!1)}}class Tt extends Le{getDefault(){return 1}set(u){(u!==this.current||this.dirty)&&(this.gl.clearDepth(u),this.current=u,this.dirty=!1)}}class St extends Le{getDefault(){return 0}set(u){(u!==this.current||this.dirty)&&(this.gl.clearStencil(u),this.current=u,this.dirty=!1)}}class Et extends Le{getDefault(){return[!0,!0,!0,!0]}set(u){const p=this.current;(u[0]!==p[0]||u[1]!==p[1]||u[2]!==p[2]||u[3]!==p[3]||this.dirty)&&(this.gl.colorMask(u[0],u[1],u[2],u[3]),this.current=u,this.dirty=!1)}}class Ft extends Le{getDefault(){return!0}set(u){(u!==this.current||this.dirty)&&(this.gl.depthMask(u),this.current=u,this.dirty=!1)}}class un extends Le{getDefault(){return 255}set(u){(u!==this.current||this.dirty)&&(this.gl.stencilMask(u),this.current=u,this.dirty=!1)}}class Gr extends Le{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(u){const p=this.current;(u.func!==p.func||u.ref!==p.ref||u.mask!==p.mask||this.dirty)&&(this.gl.stencilFunc(u.func,u.ref,u.mask),this.current=u,this.dirty=!1)}}class hn extends Le{getDefault(){const u=this.gl;return[u.KEEP,u.KEEP,u.KEEP]}set(u){const p=this.current;(u[0]!==p[0]||u[1]!==p[1]||u[2]!==p[2]||this.dirty)&&(this.gl.stencilOp(u[0],u[1],u[2]),this.current=u,this.dirty=!1)}}class zi extends Le{getDefault(){return!1}set(u){if(u===this.current&&!this.dirty)return;const p=this.gl;u?p.enable(p.STENCIL_TEST):p.disable(p.STENCIL_TEST),this.current=u,this.dirty=!1}}class jn extends Le{getDefault(){return[0,1]}set(u){const p=this.current;(u[0]!==p[0]||u[1]!==p[1]||this.dirty)&&(this.gl.depthRange(u[0],u[1]),this.current=u,this.dirty=!1)}}class oo extends Le{getDefault(){return!1}set(u){if(u===this.current&&!this.dirty)return;const p=this.gl;u?p.enable(p.DEPTH_TEST):p.disable(p.DEPTH_TEST),this.current=u,this.dirty=!1}}class Zi extends Le{getDefault(){return this.gl.LESS}set(u){(u!==this.current||this.dirty)&&(this.gl.depthFunc(u),this.current=u,this.dirty=!1)}}class so extends Le{getDefault(){return!1}set(u){if(u===this.current&&!this.dirty)return;const p=this.gl;u?p.enable(p.BLEND):p.disable(p.BLEND),this.current=u,this.dirty=!1}}class Ha extends Le{getDefault(){const u=this.gl;return[u.ONE,u.ZERO]}set(u){const p=this.current;(u[0]!==p[0]||u[1]!==p[1]||this.dirty)&&(this.gl.blendFunc(u[0],u[1]),this.current=u,this.dirty=!1)}}class Ol extends Le{getDefault(){return s.Color.transparent}set(u){const p=this.current;(u.r!==p.r||u.g!==p.g||u.b!==p.b||u.a!==p.a||this.dirty)&&(this.gl.blendColor(u.r,u.g,u.b,u.a),this.current=u,this.dirty=!1)}}class Bi extends Le{getDefault(){return this.gl.FUNC_ADD}set(u){(u!==this.current||this.dirty)&&(this.gl.blendEquation(u),this.current=u,this.dirty=!1)}}class as extends Le{getDefault(){return!1}set(u){if(u===this.current&&!this.dirty)return;const p=this.gl;u?p.enable(p.CULL_FACE):p.disable(p.CULL_FACE),this.current=u,this.dirty=!1}}class Ka extends Le{getDefault(){return this.gl.BACK}set(u){(u!==this.current||this.dirty)&&(this.gl.cullFace(u),this.current=u,this.dirty=!1)}}class ao extends Le{getDefault(){return this.gl.CCW}set(u){(u!==this.current||this.dirty)&&(this.gl.frontFace(u),this.current=u,this.dirty=!1)}}let zn,Za=class extends Le{getDefault(){return null}set(g){(g!==this.current||this.dirty)&&(this.gl.useProgram(g),this.current=g,this.dirty=!1)}};class Ms extends Le{getDefault(){return this.gl.TEXTURE0}set(u){(u!==this.current||this.dirty)&&(this.gl.activeTexture(u),this.current=u,this.dirty=!1)}}class Ao extends Le{getDefault(){const u=this.gl;return[0,0,u.drawingBufferWidth,u.drawingBufferHeight]}set(u){const p=this.current;(u[0]!==p[0]||u[1]!==p[1]||u[2]!==p[2]||u[3]!==p[3]||this.dirty)&&(this.gl.viewport(u[0],u[1],u[2],u[3]),this.current=u,this.dirty=!1)}}class No extends Le{getDefault(){return null}set(u){if(u===this.current&&!this.dirty)return;const p=this.gl;p.bindFramebuffer(p.FRAMEBUFFER,u),this.current=u,this.dirty=!1}}class ls extends Le{getDefault(){return null}set(u){if(u===this.current&&!this.dirty)return;const p=this.gl;p.bindRenderbuffer(p.RENDERBUFFER,u),this.current=u,this.dirty=!1}}class cs extends Le{getDefault(){return null}set(u){if(u===this.current&&!this.dirty)return;const p=this.gl;p.bindTexture(p.TEXTURE_2D,u),this.current=u,this.dirty=!1}}class Xa extends Le{getDefault(){return null}set(u){if(u===this.current&&!this.dirty)return;const p=this.gl;p.bindBuffer(p.ARRAY_BUFFER,u),this.current=u,this.dirty=!1}}class ve extends Le{getDefault(){return null}set(u){const p=this.gl;p.bindBuffer(p.ELEMENT_ARRAY_BUFFER,u),this.current=u,this.dirty=!1}}class ee extends Le{constructor(u){super(u),this.vao=u.extVertexArrayObject}getDefault(){return null}set(u){this.vao&&(u!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(u),this.current=u,this.dirty=!1)}}class ne extends Le{getDefault(){return 4}set(u){if(u===this.current&&!this.dirty)return;const p=this.gl;p.pixelStorei(p.UNPACK_ALIGNMENT,u),this.current=u,this.dirty=!1}}class ye extends Le{getDefault(){return!1}set(u){if(u===this.current&&!this.dirty)return;const p=this.gl;p.pixelStorei(p.UNPACK_PREMULTIPLY_ALPHA_WEBGL,u),this.current=u,this.dirty=!1}}class Se extends Le{getDefault(){return!1}set(u){if(u===this.current&&!this.dirty)return;const p=this.gl;p.pixelStorei(p.UNPACK_FLIP_Y_WEBGL,u),this.current=u,this.dirty=!1}}class Me extends Le{constructor(u,p){super(u),this.context=u,this.parent=p}getDefault(){return null}}class Ne extends Me{setDirty(){this.dirty=!0}set(u){if(u===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const p=this.gl;p.framebufferTexture2D(p.FRAMEBUFFER,p.COLOR_ATTACHMENT0,p.TEXTURE_2D,u,0),this.current=u,this.dirty=!1}}class Be extends Me{attachment(){return this.gl.DEPTH_ATTACHMENT}set(u){if(u===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const p=this.gl;p.framebufferRenderbuffer(p.FRAMEBUFFER,this.attachment(),p.RENDERBUFFER,u),this.current=u,this.dirty=!1}}class ke extends Be{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class qe{constructor(u,p,_,S){this.context=u,this.width=p,this.height=_;const E=this.framebuffer=u.gl.createFramebuffer();this.colorAttachment=new Ne(u,E),S&&(this.depthAttachment=new Be(u,E))}destroy(){const u=this.context.gl,p=this.colorAttachment.get();if(p&&u.deleteTexture(p),this.depthAttachment){const _=this.depthAttachment.get();_&&u.deleteRenderbuffer(_)}u.deleteFramebuffer(this.framebuffer)}}class xt{constructor(u,p=!1){if(this.gl=u,this.isWebGL2=p,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),p){const _=u;this.extVertexArrayObject={createVertexArrayOES:_.createVertexArray.bind(u),deleteVertexArrayOES:_.deleteVertexArray.bind(u),bindVertexArrayOES:_.bindVertexArray.bind(u)}}this.clearColor=new qt(this),this.clearDepth=new Tt(this),this.clearStencil=new St(this),this.colorMask=new Et(this),this.depthMask=new Ft(this),this.stencilMask=new un(this),this.stencilFunc=new Gr(this),this.stencilOp=new hn(this),this.stencilTest=new zi(this),this.depthRange=new jn(this),this.depthTest=new oo(this),this.depthFunc=new Zi(this),this.blend=new so(this),this.blendFunc=new Ha(this),this.blendColor=new Ol(this),this.blendEquation=new Bi(this),this.cullFace=new as(this),this.cullFaceSide=new Ka(this),this.frontFace=new ao(this),this.program=new Za(this),this.activeTexture=new Ms(this),this.viewport=new Ao(this),this.bindFramebuffer=new No(this),this.bindRenderbuffer=new ls(this),this.bindTexture=new cs(this),this.bindVertexBuffer=new Xa(this),this.bindElementBuffer=new ve(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new ee(this),this.pixelStoreUnpack=new ne(this),this.pixelStoreUnpackPremultiplyAlpha=new ye(this),this.pixelStoreUnpackFlipY=new Se(this),this.extTextureFilterAnisotropic=u.getExtension("EXT_texture_filter_anisotropic")||u.getExtension("MOZ_EXT_texture_filter_anisotropic")||u.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=u.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureFilterAnisotropicForceOff=!1,this.extStandardDerivativesForceOff=!1,this.extDebugRendererInfo=u.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=u.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=u.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),p||(this.extTextureHalfFloat=u.getExtension("OES_texture_half_float")),(p||this.extTextureHalfFloat&&u.getExtension("OES_texture_half_float_linear"))&&(this.extRenderToTextureHalfFloat=u.getExtension("EXT_color_buffer_half_float")),this.extStandardDerivatives=p||u.getExtension("OES_standard_derivatives"),this.extTimerQuery=u.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=u.getParameter(u.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(u,p){return new Dt(this,u,p)}createVertexBuffer(u,p,_){return new rr(this,u,p,_)}createRenderbuffer(u,p,_){const S=this.gl,E=S.createRenderbuffer();return this.bindRenderbuffer.set(E),S.renderbufferStorage(S.RENDERBUFFER,u,p,_),this.bindRenderbuffer.set(null),E}createFramebuffer(u,p,_){return new qe(this,u,p,_)}clear({color:u,depth:p,stencil:_}){const S=this.gl;let E=0;u&&(E|=S.COLOR_BUFFER_BIT,this.clearColor.set(u),this.colorMask.set([!0,!0,!0,!0])),p!==void 0&&(E|=S.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(p),this.depthMask.set(!0)),_!==void 0&&(E|=S.STENCIL_BUFFER_BIT,this.clearStencil.set(_),this.stencilMask.set(255)),S.clear(E)}setCullFace(u){u.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(u.mode),this.frontFace.set(u.frontFace))}setDepthMode(u){u.func!==this.gl.ALWAYS||u.mask?(this.depthTest.set(!0),this.depthFunc.set(u.func),this.depthMask.set(u.mask),this.depthRange.set(u.range)):this.depthTest.set(!1)}setStencilMode(u){u.test.func!==this.gl.ALWAYS||u.mask?(this.stencilTest.set(!0),this.stencilMask.set(u.mask),this.stencilOp.set([u.fail,u.depthFail,u.pass]),this.stencilFunc.set({func:u.test.func,ref:u.ref,mask:u.test.mask})):this.stencilTest.set(!1)}setColorMode(u){y(u.blendFunction,s.ColorMode.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(u.blendFunction),this.blendColor.set(u.blendColor)),this.colorMask.set(u.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class wt extends s.Evented{constructor(u,p,_,S){if(super(),this.id=u,this.dispatcher=_,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,s.extend(this,s.pick(p,["url","scheme","tileSize","promoteId"])),this._options=s.extend({type:"vector"},p),this._collectResourceTiming=p.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(S),this._tileWorkers={},this._deduped=new s.DedupedRequest}load(u){this._loaded=!1,this.fire(new s.Event("dataloading",{dataType:"source"}));const p=Array.isArray(this.map._language)?this.map._language.join():this.map._language,_=this.map._worldview;this._tileJSONRequest=cn(this._options,this.map._requestManager,p,_,(S,E)=>{this._tileJSONRequest=null,this._loaded=!0,S?(p&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${p}`),_&&_.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${_}`),this.fire(new s.ErrorEvent(S))):E&&(s.extend(this,E),E.bounds&&(this.tileBounds=new Vr(E.bounds,this.minzoom,this.maxzoom)),s.postTurnstileEvent(E.tiles,this.map._requestManager._customAccessToken),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"}))),u&&u(S)})}loaded(){return this._loaded}hasTile(u){return!this.tileBounds||this.tileBounds.contains(u.canonical)}onAdd(u){this.map=u,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>this.map.style._clearSource(this.id))}setTiles(u){return this._options.tiles=u,this.reload(),this}setUrl(u){return this.url=u,this._options.url=u,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return s.extend({},this._options)}loadTile(u,p){const _=this.map._requestManager.normalizeTileURL(u.tileID.canonical.url(this.tiles,this.scheme)),S={request:this.map._requestManager.transformRequest(_,s.ResourceType.Tile),data:void 0,uid:u.uid,tileID:u.tileID,tileZoom:u.tileZoom,zoom:u.tileID.overscaledZ,tileSize:this.tileSize*u.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:s.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:u.isSymbolTile};if(S.request.collectResourceTiming=this._collectResourceTiming,u.actor&&u.state!=="expired")u.state==="loading"?u.reloadCallback=p:u.request=u.actor.send("reloadTile",S,E.bind(this));else if(u.actor=this._tileWorkers[_]=this._tileWorkers[_]||this.dispatcher.getActor(),this.dispatcher.ready)u.request=u.actor.send("loadTile",S,E.bind(this),void 0,!0);else{const O=s.loadVectorTile.call({deduped:this._deduped},S,(I,N)=>{I||!N?E.call(this,I):(S.data={cacheControl:N.cacheControl,expires:N.expires,rawData:N.rawData.slice(0)},u.actor&&u.actor.send("loadTile",S,E.bind(this),void 0,!0))},!0);u.request={cancel:O}}function E(O,I){return delete u.request,u.aborted?p(null):O&&O.status!==404?p(O):(I&&I.resourceTiming&&(u.resourceTiming=I.resourceTiming),this.map._refreshExpiredTiles&&I&&u.setExpiryData(I),u.loadVectorData(I,this.map.painter),s.cacheEntryPossiblyAdded(this.dispatcher),p(null),void(u.reloadCallback&&(this.loadTile(u,u.reloadCallback),u.reloadCallback=null)))}}abortTile(u){u.request&&(u.request.cancel(),delete u.request),u.actor&&u.actor.send("abortTile",{uid:u.uid,type:this.type,source:this.id})}unloadTile(u){u.unloadVectorData(),u.actor&&u.actor.send("removeTile",{uid:u.uid,type:this.type,source:this.id})}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class gt extends s.Evented{constructor(u,p,_,S){super(),this.id=u,this.dispatcher=_,this.setEventedParent(S),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=s.extend({type:"raster"},p),s.extend(this,s.pick(p,["url","scheme","tileSize"]))}load(u){this._loaded=!1,this.fire(new s.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=cn(this._options,this.map._requestManager,null,null,(p,_)=>{this._tileJSONRequest=null,this._loaded=!0,p?this.fire(new s.ErrorEvent(p)):_&&(s.extend(this,_),_.bounds&&(this.tileBounds=new Vr(_.bounds,this.minzoom,this.maxzoom)),s.postTurnstileEvent(_.tiles),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"}))),u&&u(p)})}loaded(){return this._loaded}onAdd(u){this.map=u,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>this.map.style._clearSource(this.id))}setTiles(u){return this._options.tiles=u,this.reload(),this}setUrl(u){return this.url=u,this._options.url=u,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return s.extend({},this._options)}hasTile(u){return!this.tileBounds||this.tileBounds.contains(u.canonical)}loadTile(u,p){const _=s.exported.devicePixelRatio>=2,S=this.map._requestManager.normalizeTileURL(u.tileID.canonical.url(this.tiles,this.scheme),_,this.tileSize);u.request=s.getImage(this.map._requestManager.transformRequest(S,s.ResourceType.Tile),(E,O,I,N)=>(delete u.request,u.aborted?(u.state="unloaded",p(null)):E?(u.state="errored",p(E)):O?(this.map._refreshExpiredTiles&&u.setExpiryData({cacheControl:I,expires:N}),u.setTexture(O,this.map.painter),u.state="loaded",s.cacheEntryPossiblyAdded(this.dispatcher),void p(null)):p(null)))}static loadTileData(u,p,_){u.setTexture(p,_)}static unloadTileData(u,p){u.texture&&p.saveTileTexture(u.texture)}abortTile(u,p){u.request&&(u.request.cancel(),delete u.request),p()}unloadTile(u,p){u.texture&&this.map.painter.saveTileTexture(u.texture),p()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}function or(g,u,p,_,S,E,O,I){const N=[g,p,S,u,_,E,1,1,1],G=[O,I,1],V=s.adjoint([],N),[X,ie,ae]=s.transformMat3(G,G,s.transpose(V,V));return s.multiply$1(N,[X,0,0,0,ie,0,0,0,ae],N)}class mr extends s.Evented{constructor(u,p,_,S){super(),this.id=u,this.dispatcher=_,this.coordinates=p.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(S),this.options=p,this._dirty=!1}load(u,p){this._loaded=p||!1,this.fire(new s.Event("dataloading",{dataType:"source"})),this.url=this.options.url,this._imageRequest=s.getImage(this.map._requestManager.transformRequest(this.url,s.ResourceType.Image),(_,S)=>{if(this._imageRequest=null,this._loaded=!0,_)this.fire(new s.ErrorEvent(_));else if(S){const{HTMLImageElement:E}=s.window;this.image=S instanceof E?s.exported.getImageData(S):S,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,u&&(this.coordinates=u),this._finishLoading()}})}loaded(){return this._loaded}updateImage(u){return this.image&&u.url?(this._imageRequest&&u.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=u.url,this.load(u.coordinates,this._loaded),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(u){this.map=u,this.load()}onRemove(){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),this.texture&&this.texture.destroy()}setCoordinates(u){this.coordinates=u,this._boundsArray=void 0;const p=u.map(s.MercatorCoordinate.fromLngLat);return this.tileID=function(_){let S=1/0,E=1/0,O=-1/0,I=-1/0;for(const X of _)S=Math.min(S,X.x),E=Math.min(E,X.y),O=Math.max(O,X.x),I=Math.max(I,X.y);const N=Math.max(O-S,I-E),G=Math.max(0,Math.floor(-Math.log(N)/Math.LN2)),V=Math.pow(2,G);return new s.CanonicalTileID(G,Math.floor((S+O)/2*V),Math.floor((E+I)/2*V))}(p),this.minzoom=this.maxzoom=this.tileID.z,this.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0}_prepareData(u){for(const N in this.tiles){const G=this.tiles[N];G.state!=="loaded"&&(G.state="loaded",G.texture=this.texture)}if(this._boundsArray)return;const p=s.tileTransform(this.tileID,this.map.transform.projection),[_,S,E,O]=this.coordinates.map(N=>{const G=p.projection.project(N[0],N[1]);return s.getTilePoint(p,G)._round()});this.perspectiveTransform=function(N,G,V,X,ie,ae,ce,le,he,J){const se=or(0,0,N,0,0,G,N,G),me=or(V,X,ie,ae,ce,le,he,J);return s.multiply$1(me,s.adjoint(se,se),me),[me[6]/me[8]*N/s.EXTENT,me[7]/me[8]*G/s.EXTENT]}(this.width,this.height,_.x,_.y,S.x,S.y,O.x,O.y,E.x,E.y);const I=this._boundsArray=new s.StructArrayLayout4i8;I.emplaceBack(_.x,_.y,0,0),I.emplaceBack(S.x,S.y,s.EXTENT,0),I.emplaceBack(O.x,O.y,0,s.EXTENT),I.emplaceBack(E.x,E.y,s.EXTENT,s.EXTENT),this.boundsBuffer&&this.boundsBuffer.destroy(),this.boundsBuffer=u.createVertexBuffer(I,s.boundsAttributes.members),this.boundsSegments=s.SegmentVector.simpleSegment(0,0,4,2)}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const u=this.map.painter.context,p=u.gl;this._dirty&&(this.texture?this.texture.update(this.image):(this.texture=new s.Texture(u,this.image,p.RGBA),this.texture.bind(p.LINEAR,p.CLAMP_TO_EDGE)),this._dirty=!1),this._prepareData(u)}loadTile(u,p){this.tileID&&this.tileID.equals(u.tileID.canonical)?(this.tiles[String(u.tileID.wrap)]=u,u.buckets={},p(null)):(u.state="errored",p(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}const sr={vector:wt,raster:gt,"raster-dem":class extends gt{constructor(g,u,p,_){super(g,u,p,_),this.type="raster-dem",this.maxzoom=22,this._options=s.extend({type:"raster-dem"},u),this.encoding=u.encoding||"mapbox"}loadTile(g,u){const p=this.map._requestManager.normalizeTileURL(g.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function _(S,E){S&&(g.state="errored",u(S)),E&&(g.dem=E,g.dem.onDeserialize(),g.needsHillshadePrepare=!0,g.needsDEMTextureUpload=!0,g.state="loaded",u(null))}g.request=s.getImage(this.map._requestManager.transformRequest(p,s.ResourceType.Tile),(function(S,E,O,I){if(delete g.request,g.aborted)g.state="unloaded",u(null);else if(S)g.state="errored",u(S);else if(E){this.map._refreshExpiredTiles&&g.setExpiryData({cacheControl:O,expires:I});const N=s.window.ImageBitmap&&E instanceof s.window.ImageBitmap&&(zn==null&&(zn=s.window.OffscreenCanvas&&new s.window.OffscreenCanvas(1,1).getContext("2d")&&typeof s.window.createImageBitmap=="function"),zn),G=1-(E.width-s.prevPowerOfTwo(E.width))/2;G<1||g.neighboringTiles||(g.neighboringTiles=this._getNeighboringTiles(g.tileID));const V=N?E:s.exported.getImageData(E,G),X={uid:g.uid,coord:g.tileID,source:this.id,rawImageData:V,encoding:this.encoding,padding:G};g.actor&&g.state!=="expired"||(g.actor=this.dispatcher.getActor(),g.actor.send("loadDEMTile",X,_.bind(this),void 0,!0))}}).bind(this))}_getNeighboringTiles(g){const u=g.canonical,p=Math.pow(2,u.z),_=(u.x-1+p)%p,S=u.x===0?g.wrap-1:g.wrap,E=(u.x+1+p)%p,O=u.x+1===p?g.wrap+1:g.wrap,I={};return I[new s.OverscaledTileID(g.overscaledZ,S,u.z,_,u.y).key]={backfilled:!1},I[new s.OverscaledTileID(g.overscaledZ,O,u.z,E,u.y).key]={backfilled:!1},u.y>0&&(I[new s.OverscaledTileID(g.overscaledZ,S,u.z,_,u.y-1).key]={backfilled:!1},I[new s.OverscaledTileID(g.overscaledZ,g.wrap,u.z,u.x,u.y-1).key]={backfilled:!1},I[new s.OverscaledTileID(g.overscaledZ,O,u.z,E,u.y-1).key]={backfilled:!1}),u.y+1<p&&(I[new s.OverscaledTileID(g.overscaledZ,S,u.z,_,u.y+1).key]={backfilled:!1},I[new s.OverscaledTileID(g.overscaledZ,g.wrap,u.z,u.x,u.y+1).key]={backfilled:!1},I[new s.OverscaledTileID(g.overscaledZ,O,u.z,E,u.y+1).key]={backfilled:!1}),I}unloadTile(g){g.demTexture&&this.map.painter.saveTileTexture(g.demTexture),g.fbo&&(g.fbo.destroy(),delete g.fbo),g.dem&&delete g.dem,delete g.neighboringTiles,g.state="unloaded"}},geojson:class extends s.Evented{constructor(g,u,p,_){super(),this.id=g,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=p.getActor(),this.setEventedParent(_),this._data=u.data,this._options=s.extend({},u),this._collectResourceTiming=u.collectResourceTiming,u.maxzoom!==void 0&&(this.maxzoom=u.maxzoom),u.type&&(this.type=u.type),u.attribution&&(this.attribution=u.attribution),this.promoteId=u.promoteId;const S=s.EXTENT/this.tileSize;this.workerOptions=s.extend({source:this.id,cluster:u.cluster||!1,geojsonVtOptions:{buffer:(u.buffer!==void 0?u.buffer:128)*S,tolerance:(u.tolerance!==void 0?u.tolerance:.375)*S,extent:s.EXTENT,maxZoom:this.maxzoom,lineMetrics:u.lineMetrics||!1,generateId:u.generateId||!1},superclusterOptions:{maxZoom:u.clusterMaxZoom!==void 0?u.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,u.clusterMinPoints||2),extent:s.EXTENT,radius:(u.clusterRadius!==void 0?u.clusterRadius:50)*S,log:!1,generateId:u.generateId||!1},clusterProperties:u.clusterProperties,filter:u.filter},u.workerOptions)}onAdd(g){this.map=g,this.setData(this._data)}setData(g){return this._data=g,this._updateWorkerData(),this}getClusterExpansionZoom(g,u){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:g,source:this.id},u),this}getClusterChildren(g,u){return this.actor.send("geojson.getClusterChildren",{clusterId:g,source:this.id},u),this}getClusterLeaves(g,u,p,_){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:g,limit:u,offset:p},_),this}_updateWorkerData(){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new s.Event("dataloading",{dataType:"source"})),this._loaded=!1;const g=s.extend({},this.workerOptions),u=this._data;typeof u=="string"?(g.request=this.map._requestManager.transformRequest(s.exported.resolveURL(u),s.ResourceType.Source),g.request.collectResourceTiming=this._collectResourceTiming):g.data=JSON.stringify(u),this._pendingLoad=this.actor.send(`${this.type}.loadData`,g,(p,_)=>{if(this._loaded=!0,this._pendingLoad=null,p)this.fire(new s.ErrorEvent(p));else{const S={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&_&&_.resourceTiming&&_.resourceTiming[this.id]&&(S.resourceTiming=_.resourceTiming[this.id]),this.fire(new s.Event("data",S)),this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(g,u){const p=g.actor?"reloadTile":"loadTile";g.actor=this.actor,g.request=this.actor.send(p,{type:this.type,uid:g.uid,tileID:g.tileID,tileZoom:g.tileZoom,zoom:g.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:s.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},(_,S)=>(delete g.request,g.unloadVectorData(),g.aborted?u(null):_?u(_):(g.loadVectorData(S,this.map.painter,p==="reloadTile"),u(null))),void 0,p==="loadTile")}abortTile(g){g.request&&(g.request.cancel(),delete g.request),g.aborted=!0}unloadTile(g){g.unloadVectorData(),this.actor.send("removeTile",{uid:g.uid,type:this.type,source:this.id})}onRemove(){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return s.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends mr{constructor(g,u,p,_){super(g,u,p,_),this.roundZoom=!0,this.type="video",this.options=u}load(){this._loaded=!1;const g=this.options;this.urls=[];for(const u of g.urls)this.urls.push(this.map._requestManager.transformRequest(u,s.ResourceType.Source).url);s.getVideo(this.urls,(u,p)=>{this._loaded=!0,u?this.fire(new s.ErrorEvent(u)):p&&(this.video=p,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(g){if(this.video){const u=this.video.seekable;g<u.start(0)||g>u.end(0)?this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${u.start(0)} and ${u.end(0)}-second mark.`))):this.video.currentTime=g}}getVideo(){return this.video}onAdd(g){this.map||(this.map=g,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const g=this.map.painter.context,u=g.gl;this.texture?this.video.paused||(this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE),u.texSubImage2D(u.TEXTURE_2D,0,0,0,u.RGBA,u.UNSIGNED_BYTE,this.video)):(this.texture=new s.Texture(g,this.video,u.RGBA),this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(g)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:mr,canvas:class extends mr{constructor(g,u,p,_){super(g,u,p,_),u.coordinates?Array.isArray(u.coordinates)&&u.coordinates.length===4&&!u.coordinates.some(S=>!Array.isArray(S)||S.length!==2||S.some(E=>typeof E!="number"))||this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${g}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${g}`,null,'missing required property "coordinates"'))),u.animate&&typeof u.animate!="boolean"&&this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${g}`,null,'optional "animate" property must be a boolean value'))),u.canvas?typeof u.canvas=="string"||u.canvas instanceof s.window.HTMLCanvasElement||this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${g}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${g}`,null,'missing required property "canvas"'))),this.options=u,this.animate=u.animate===void 0||u.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof s.window.HTMLCanvasElement?this.options.canvas:s.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new s.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(g){this.map=g,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let g=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,g=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,g=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const u=this.map.painter.context;this.texture?(g||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new s.Texture(u,this.canvas,u.gl.RGBA,{premultiply:!0}),this._prepareData(u)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const g of[this.canvas.width,this.canvas.height])if(isNaN(g)||g<=0)return!0;return!1}},custom:class extends s.Evented{constructor(g,u,p,_){super(),this.id=g,this.type="custom",this._dataType="raster",this._dispatcher=p,this._implementation=u,this.setEventedParent(_),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new s.ErrorEvent(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new s.ErrorEvent(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new Vr(this._implementation.bounds,this.minzoom,this.maxzoom)),u.update=this._update.bind(this),u.clearTiles=this._clearTiles.bind(this),u.coveringTiles=this._coveringTiles.bind(this),s.extend(this,s.pick(u,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return s.pick(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new s.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(g){this._map=g,this._loaded=!1,this.fire(new s.Event("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(g),this.load()}onRemove(g){this._implementation.onRemove&&this._implementation.onRemove(g)}hasTile(g){if(this._implementation.hasTile){const{x:u,y:p,z:_}=g.canonical;return this._implementation.hasTile({x:u,y:p,z:_})}return!this.tileBounds||this.tileBounds.contains(g.canonical)}loadTile(g,u){const{x:p,y:_,z:S}=g.tileID.canonical,E=new s.window.AbortController;g.request=Promise.resolve(this._implementation.loadTile({x:p,y:_,z:S},{signal:E.signal})).then((function(O){return delete g.request,g.aborted?(g.state="unloaded",u(null)):O===void 0?(g.state="errored",u(null)):O===null?(this.loadTileData(g,{width:this.tileSize,height:this.tileSize,data:null}),g.state="loaded",u(null)):function(I){return I instanceof s.window.ImageData||I instanceof s.window.HTMLCanvasElement||I instanceof s.window.ImageBitmap||I instanceof s.window.HTMLImageElement}(O)?(this.loadTileData(g,O),g.state="loaded",void u(null)):(g.state="errored",u(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)))}).bind(this)).catch(O=>{O.code!==20&&(g.state="errored",u(O))}),g.request.cancel=()=>E.abort()}loadTileData(g,u){gt.loadTileData(g,u,this._map.painter)}unloadTileData(g){gt.unloadTileData(g,this._map.painter)}unloadTile(g,u){if(this.unloadTileData(g),this._implementation.unloadTile){const{x:p,y:_,z:S}=g.tileID.canonical;this._implementation.unloadTile({x:p,y:_,z:S})}u()}abortTile(g,u){g.request&&g.request.cancel&&(g.request.cancel(),delete g.request),u()}hasTransition(){return!1}_coveringTiles(){return this._map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(g=>({x:g.canonical.x,y:g.canonical.y,z:g.canonical.z}))}_clearTiles(){this._map.style._clearSource(this.id)}_update(){this.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"}))}}},gr=function(g,u,p,_){const S=new sr[u.type](g,u,p,_);if(S.id!==g)throw new Error(`Expected Source id to be ${g} instead of ${S.id}`);return s.bindAll(["load","abort","unload","serialize","prepare"],S),S};function vr(g,u){const p=s.identity([]);return s.scale(p,p,[.5*g.width,.5*-g.height,1]),s.translate(p,p,[1,-1,0]),s.multiply(p,p,g.calculateProjMatrix(u.toUnwrapped())),Float32Array.from(p)}function dn(g,u,p,_,S,E,O,I=!1){const N=g.tilesIn(_,O,I);N.sort(hi);const G=[];for(const X of N)G.push({wrappedTileID:X.tile.tileID.wrapped().key,queryResults:X.tile.queryRenderedFeatures(u,p,g._state,X,S,E,vr(g.transform,X.tile.tileID),I)});const V=function(X){const ie={},ae={};for(const ce of X){const le=ce.queryResults,he=ce.wrappedTileID,J=ae[he]=ae[he]||{};for(const se in le){const me=le[se],ge=J[se]=J[se]||{},Te=ie[se]=ie[se]||[];for(const Pe of me)ge[Pe.featureIndex]||(ge[Pe.featureIndex]=!0,Te.push(Pe))}}return ie}(G);for(const X in V)V[X].forEach(ie=>{const ae=ie.feature,ce=ae.layer;ce&&ce.type!=="background"&&ce.type!=="sky"&&(ae.source=ce.source,ce["source-layer"]&&(ae.sourceLayer=ce["source-layer"]),ae.state=ae.id!==void 0?g.getFeatureState(ce["source-layer"],ae.id):{})});return V}function An(g,u){const p=g.getRenderableIds().map(E=>g.getTileByID(E)),_=[],S={};for(let E=0;E<p.length;E++){const O=p[E],I=O.tileID.canonical.key;S[I]||(S[I]=!0,O.querySourceFeatures(_,u))}return _}function hi(g,u){const p=g.tileID,_=u.tileID;return p.overscaledZ-_.overscaledZ||p.canonical.y-_.canonical.y||p.wrap-_.wrap||p.canonical.x-_.canonical.x}function Pn(){return Gc.workerClass!=null?new Gc.workerClass:new s.window.Worker(Gc.workerUrl)}const $o="mapboxgl_preloaded_worker_pool";class Bn{constructor(){this.active={}}acquire(u){if(!this.workers)for(this.workers=[];this.workers.length<Bn.workerCount;)this.workers.push(new Pn);return this.active[u]=!0,this.workers.slice()}release(u){delete this.active[u],this.numActive()===0&&(this.workers.forEach(p=>{p.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[$o]}numActive(){return Object.keys(this.active).length}}let wi;function Ya(){return wi||(wi=new Bn),wi}function jd(g,u){const p={};for(const _ in g)_!=="ref"&&(p[_]=g[_]);return s.refProperties.forEach(_=>{_ in u&&(p[_]=u[_])}),p}function zd(g){g=g.slice();const u=Object.create(null);for(let p=0;p<g.length;p++)u[g[p].id]=g[p];for(let p=0;p<g.length;p++)"ref"in g[p]&&(g[p]=jd(g[p],u[g[p].ref]));return g}Bn.workerCount=2;const Mr={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setProjection:"setProjection"};function Ec(g,u,p){p.push({command:Mr.addSource,args:[g,u[g]]})}function Ja(g,u,p){u.push({command:Mr.removeSource,args:[g]}),p[g]=!0}function Ac(g,u,p,_){Ja(g,p,_),Ec(g,u,p)}function rt(g,u,p){let _;for(_ in g[p])if(g[p].hasOwnProperty(_)&&_!=="data"&&!y(g[p][_],u[p][_]))return!1;for(_ in u[p])if(u[p].hasOwnProperty(_)&&_!=="data"&&!y(g[p][_],u[p][_]))return!1;return!0}function Ct(g,u,p,_,S,E){let O;for(O in u=u||{},g=g||{})g.hasOwnProperty(O)&&(y(g[O],u[O])||p.push({command:E,args:[_,O,u[O],S]}));for(O in u)u.hasOwnProperty(O)&&!g.hasOwnProperty(O)&&(y(g[O],u[O])||p.push({command:E,args:[_,O,u[O],S]}))}function nr(g){return g.id}function Xt(g,u){return g[u.id]=u,g}class Ut{constructor(u,p){this.reset(u,p)}reset(u,p){this.points=u||[],this._distances=[0];for(let _=1;_<this.points.length;_++)this._distances[_]=this._distances[_-1]+this.points[_].dist(this.points[_-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(p||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(u){if(this.points.length===1)return this.points[0];u=s.clamp(u,0,1);let p=1,_=this._distances[p];const S=u*this.paddedLength+this.padding;for(;_<S&&p<this._distances.length;)_=this._distances[++p];const E=p-1,O=this._distances[E],I=_-O,N=I>0?(S-O)/I:0;return this.points[E].mult(1-N).add(this.points[p].mult(N))}}class tr{constructor(u,p,_){const S=this.boxCells=[],E=this.circleCells=[];this.xCellCount=Math.ceil(u/_),this.yCellCount=Math.ceil(p/_);for(let O=0;O<this.xCellCount*this.yCellCount;O++)S.push([]),E.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=u,this.height=p,this.xScale=this.xCellCount/u,this.yScale=this.yCellCount/p,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(u,p,_,S,E){this._forEachCell(p,_,S,E,this._insertBoxCell,this.boxUid++),this.boxKeys.push(u),this.bboxes.push(p),this.bboxes.push(_),this.bboxes.push(S),this.bboxes.push(E)}insertCircle(u,p,_,S){this._forEachCell(p-S,_-S,p+S,_+S,this._insertCircleCell,this.circleUid++),this.circleKeys.push(u),this.circles.push(p),this.circles.push(_),this.circles.push(S)}_insertBoxCell(u,p,_,S,E,O){this.boxCells[E].push(O)}_insertCircleCell(u,p,_,S,E,O){this.circleCells[E].push(O)}_query(u,p,_,S,E,O){if(_<0||u>this.width||S<0||p>this.height)return!E&&[];const I=[];if(u<=0&&p<=0&&this.width<=_&&this.height<=S){if(E)return!0;for(let N=0;N<this.boxKeys.length;N++)I.push({key:this.boxKeys[N],x1:this.bboxes[4*N],y1:this.bboxes[4*N+1],x2:this.bboxes[4*N+2],y2:this.bboxes[4*N+3]});for(let N=0;N<this.circleKeys.length;N++){const G=this.circles[3*N],V=this.circles[3*N+1],X=this.circles[3*N+2];I.push({key:this.circleKeys[N],x1:G-X,y1:V-X,x2:G+X,y2:V+X})}return O?I.filter(O):I}return this._forEachCell(u,p,_,S,this._queryCell,I,{hitTest:E,seenUids:{box:{},circle:{}}},O),E?I.length>0:I}_queryCircle(u,p,_,S,E){const O=u-_,I=u+_,N=p-_,G=p+_;if(I<0||O>this.width||G<0||N>this.height)return!S&&[];const V=[];return this._forEachCell(O,N,I,G,this._queryCellCircle,V,{hitTest:S,circle:{x:u,y:p,radius:_},seenUids:{box:{},circle:{}}},E),S?V.length>0:V}query(u,p,_,S,E){return this._query(u,p,_,S,!1,E)}hitTest(u,p,_,S,E){return this._query(u,p,_,S,!0,E)}hitTestCircle(u,p,_,S){return this._queryCircle(u,p,_,!0,S)}_queryCell(u,p,_,S,E,O,I,N){const G=I.seenUids,V=this.boxCells[E];if(V!==null){const ie=this.bboxes;for(const ae of V)if(!G.box[ae]){G.box[ae]=!0;const ce=4*ae;if(u<=ie[ce+2]&&p<=ie[ce+3]&&_>=ie[ce+0]&&S>=ie[ce+1]&&(!N||N(this.boxKeys[ae]))){if(I.hitTest)return O.push(!0),!0;O.push({key:this.boxKeys[ae],x1:ie[ce],y1:ie[ce+1],x2:ie[ce+2],y2:ie[ce+3]})}}}const X=this.circleCells[E];if(X!==null){const ie=this.circles;for(const ae of X)if(!G.circle[ae]){G.circle[ae]=!0;const ce=3*ae;if(this._circleAndRectCollide(ie[ce],ie[ce+1],ie[ce+2],u,p,_,S)&&(!N||N(this.circleKeys[ae]))){if(I.hitTest)return O.push(!0),!0;{const le=ie[ce],he=ie[ce+1],J=ie[ce+2];O.push({key:this.circleKeys[ae],x1:le-J,y1:he-J,x2:le+J,y2:he+J})}}}}}_queryCellCircle(u,p,_,S,E,O,I,N){const G=I.circle,V=I.seenUids,X=this.boxCells[E];if(X!==null){const ae=this.bboxes;for(const ce of X)if(!V.box[ce]){V.box[ce]=!0;const le=4*ce;if(this._circleAndRectCollide(G.x,G.y,G.radius,ae[le+0],ae[le+1],ae[le+2],ae[le+3])&&(!N||N(this.boxKeys[ce])))return O.push(!0),!0}}const ie=this.circleCells[E];if(ie!==null){const ae=this.circles;for(const ce of ie)if(!V.circle[ce]){V.circle[ce]=!0;const le=3*ce;if(this._circlesCollide(ae[le],ae[le+1],ae[le+2],G.x,G.y,G.radius)&&(!N||N(this.circleKeys[ce])))return O.push(!0),!0}}}_forEachCell(u,p,_,S,E,O,I,N){const G=this._convertToXCellCoord(u),V=this._convertToYCellCoord(p),X=this._convertToXCellCoord(_),ie=this._convertToYCellCoord(S);for(let ae=G;ae<=X;ae++)for(let ce=V;ce<=ie;ce++)if(E.call(this,u,p,_,S,this.xCellCount*ce+ae,O,I,N))return}_convertToXCellCoord(u){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(u*this.xScale)))}_convertToYCellCoord(u){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(u*this.yScale)))}_circlesCollide(u,p,_,S,E,O){const I=S-u,N=E-p,G=_+O;return G*G>I*I+N*N}_circleAndRectCollide(u,p,_,S,E,O,I){const N=(O-S)/2,G=Math.abs(u-(S+N));if(G>N+_)return!1;const V=(I-E)/2,X=Math.abs(p-(E+V));if(X>V+_)return!1;if(G<=N||X<=V)return!0;const ie=G-N,ae=X-V;return ie*ie+ae*ae<=_*_}}const Dr={unknown:0,flipRequired:1,flipNotRequired:2},Si=Math.tan(85*Math.PI/180);function Xe(g,u,p,_,S,E,O){const I=s.create();if(p)if(E.name==="globe"){const N=s.calculateGlobeLabelMatrix(S,u);s.multiply(I,I,N)}else{const N=ue([],O);I[0]=N[0],I[1]=N[1],I[4]=N[2],I[5]=N[3],_||s.rotateZ(I,I,S.angle)}else s.multiply(I,S.labelPlaneMatrix,g);return I}function Ti(g,u,p,_,S,E,O){const I=Xe(g,u,p,_,S,E,O);return E.name==="globe"&&p||(I[2]=I[6]=I[10]=I[14]=0),I}function en(g,u,p,_,S,E,O){if(p){if(E.name==="globe"){const I=Xe(g,u,p,_,S,E,O);return s.invert(I,I),s.multiply(I,g,I),I}{const I=s.clone(g),N=s.identity([]);return N[0]=O[0],N[1]=O[1],N[4]=O[2],N[5]=O[3],s.multiply(I,I,N),_||s.rotateZ(I,I,-S.angle),I}}return S.glCoordMatrix}function Nn(g,u,p,_){const S=[g,u,p,1];p?s.transformMat4$1(S,S,_):xr(S,S,_);const E=S[3];return S[0]/=E,S[1]/=E,S[2]/=E,S}function Is(g,u){return Math.min(.5+g/u*.5,1.5)}function Ni(g,u){const p=g[0]/g[3],_=g[1]/g[3];return p>=-u[0]&&p<=u[0]&&_>=-u[1]&&_<=u[1]}function Qa(g,u,p,_,S,E,O,I,N,G){const V=p.transform,X=_?g.textSizeData:g.iconSizeData,ie=s.evaluateSizeForZoom(X,p.transform.zoom),ae=V.projection.name==="globe",ce=[256/p.width*2+1,256/p.height*2+1],le=_?g.text.dynamicLayoutVertexArray:g.icon.dynamicLayoutVertexArray;le.clear();let he=null;ae&&(he=_?g.text.globeExtVertexArray:g.icon.globeExtVertexArray);const J=g.lineVertexArray,se=_?g.text.placedSymbolArray:g.icon.placedSymbolArray,me=p.transform.width/p.transform.height;let ge,Te=!1;for(let Pe=0;Pe<se.length;Pe++){const Ae=se.get(Pe),{numGlyphs:Re,writingMode:Ie}=Ae;if(Ie!==s.WritingMode.vertical||Te||ge===s.WritingMode.horizontal||(Te=!0),ge=Ie,(Ae.hidden||Ie===s.WritingMode.vertical)&&!Te){us(Re,le);continue}Te=!1;const Ve=new s.Point(Ae.tileAnchorX,Ae.tileAnchorY);let{x:pt,y:$e,z:it}=V.projection.projectTilePoint(Ve.x,Ve.y,G.canonical);if(N){const[ir,zt,Yt]=N(Ve);pt+=ir,$e+=zt,it+=Yt}const He=[pt,$e,it,1];if(s.transformMat4$1(He,He,u),!Ni(He,ce)){us(Re,le);continue}const ft=Is(p.transform.cameraToCenterDistance,He[3]),Ue=s.evaluateSizeForFeature(X,ie,Ae),nt=O?Ue/ft:Ue*ft,yt=Nn(pt,$e,it,S);if(yt[3]<=0){us(Re,le);continue}let lt={};const vt=O?null:N,Vt=Mt(Ae,nt,!1,I,u,S,E,g.glyphOffsetArray,J,le,he,yt,Ve,lt,me,vt,V.projection,G,O);Te=Vt.useVertical,vt&&Vt.needsFlipping&&(lt={}),(Vt.notEnoughRoom||Te||Vt.needsFlipping&&Mt(Ae,nt,!0,I,u,S,E,g.glyphOffsetArray,J,le,he,yt,Ve,lt,me,vt,V.projection,G,O).notEnoughRoom)&&us(Re,le)}_?(g.text.dynamicLayoutVertexBuffer.updateData(le),he&&g.text.globeExtVertexBuffer.updateData(he)):(g.icon.dynamicLayoutVertexBuffer.updateData(le),he&&g.icon.globeExtVertexBuffer.updateData(he))}function Bd(g,u,p,_,S,E,O,I,N,G,V,X,ie,ae,ce,le){const{lineStartIndex:he,glyphStartIndex:J,segment:se}=I,me=J+I.numGlyphs,ge=he+I.lineLength,Te=u.getoffsetX(J),Pe=u.getoffsetX(me-1),Ae=Po(g*Te,p,_,S,E,O,se,he,ge,N,G,V,X,ie,!0,ae,ce,le);if(!Ae)return null;const Re=Po(g*Pe,p,_,S,E,O,se,he,ge,N,G,V,X,ie,!0,ae,ce,le);return Re?{first:Ae,last:Re}:null}function Pc(g,u,p,_){return g===s.WritingMode.horizontal&&Math.abs(_)>Math.abs(p)?{useVertical:!0}:g===s.WritingMode.vertical?_>0?{needsFlipping:!0}:null:u!==Dr.unknown&&function(S,E){return S===0||Math.abs(E/S)>Si}(p,_)?u===Dr.flipRequired?{needsFlipping:!0}:null:p<0?{needsFlipping:!0}:null}function Mt(g,u,p,_,S,E,O,I,N,G,V,X,ie,ae,ce,le,he,J,se){const me=u/24,ge=g.lineOffsetX*me,Te=g.lineOffsetY*me,{lineStartIndex:Pe,glyphStartIndex:Ae,numGlyphs:Re,segment:Ie,writingMode:Ve,flipState:pt}=g,$e=Pe+g.lineLength,it=He=>{if(V){const[yt,lt,vt]=He.up,Vt=G.length;s.updateGlobeVertexNormal(V,Vt+0,yt,lt,vt),s.updateGlobeVertexNormal(V,Vt+1,yt,lt,vt),s.updateGlobeVertexNormal(V,Vt+2,yt,lt,vt),s.updateGlobeVertexNormal(V,Vt+3,yt,lt,vt)}const[ft,Ue,nt]=He.point;s.addDynamicAttributes(G,ft,Ue,nt,He.angle)};if(Re>1){const He=Bd(me,I,ge,Te,p,X,ie,g,N,E,ae,le,!1,he,J,se);if(!He)return{notEnoughRoom:!0};if(_&&!p){let[ft,Ue,nt]=He.first.point,[yt,lt,vt]=He.last.point;[ft,Ue]=Nn(ft,Ue,nt,O),[yt,lt]=Nn(yt,lt,vt,O);const Vt=Pc(Ve,pt,(yt-ft)*ce,lt-Ue);if(g.flipState=Vt&&Vt.needsFlipping?Dr.flipRequired:Dr.flipNotRequired,Vt)return Vt}it(He.first);for(let ft=Ae+1;ft<Ae+Re-1;ft++){const Ue=Po(me*I.getoffsetX(ft),ge,Te,p,X,ie,Ie,Pe,$e,N,E,ae,le,!1,!1,he,J,se);if(!Ue)return G.length-=4*(ft-Ae),{notEnoughRoom:!0};it(Ue)}it(He.last)}else{if(_&&!p){const ft=Nn(ie.x,ie.y,0,S),Ue=Pe+Ie+1,nt=new s.Point(N.getx(Ue),N.gety(Ue)),yt=Nn(nt.x,nt.y,0,S),lt=yt[3]>0?yt:_r(ie,nt,ft,1,S,void 0,he,J.canonical),vt=Pc(Ve,pt,(lt[0]-ft[0])*ce,lt[1]-ft[1]);if(g.flipState=vt&&vt.needsFlipping?Dr.flipRequired:Dr.flipNotRequired,vt)return vt}const He=Po(me*I.getoffsetX(Ae),ge,Te,p,X,ie,Ie,Pe,$e,N,E,ae,le,!1,!1,he,J,se);if(!He)return{notEnoughRoom:!0};it(He)}return{}}function Er(g,u,p,_,S){const{x:E,y:O,z:I}=_.projectTilePoint(g.x,g.y,u);if(!S)return Nn(E,O,I,p);const[N,G,V]=S(g);return Nn(E+N,O+G,I+V,p)}function _r(g,u,p,_,S,E,O,I){const N=Er(g.sub(u)._unit()._add(g),I,S,O,E);return s.sub(N,p,N),s.normalize(N,N),s.scaleAndAdd(N,p,N,_)}function Po(g,u,p,_,S,E,O,I,N,G,V,X,ie,ae,ce,le,he,J){const se=_?g-u:g+u;let me=se>0?1:-1,ge=0;_&&(me*=-1,ge=Math.PI),me<0&&(ge+=Math.PI);let Te=I+O+(me>0?0:1)|0,Pe=S,Ae=S,Re=0,Ie=0;const Ve=Math.abs(se),pt=[],$e=[];let it=E,He=it;const ft=()=>_r(He,it,Ae,Ve-Re+1,V,ie,le,he.canonical);for(;Re+Ie<=Ve;){if(Te+=me,Te<I||Te>=N)return null;if(Ae=Pe,He=it,pt.push(Ae),ae&&$e.push(He),it=new s.Point(G.getx(Te),G.gety(Te)),Pe=X[Te],!Pe){const Yt=Er(it,he.canonical,V,le,ie);Pe=Yt[3]>0?X[Te]=Yt:ft()}Re+=Ie,Ie=s.distance(Ae,Pe)}ce&&ie&&(X[Te]&&(Pe=ft(),Ie=s.distance(Ae,Pe)),X[Te]=Pe);const Ue=(Ve-Re)/Ie,nt=it.sub(He)._mult(Ue)._add(He),yt=s.sub([],Pe,Ae),lt=s.scaleAndAdd([],Ae,yt,Ue);let vt=[0,0,1],Vt=yt[0],ir=yt[1];if(J&&(vt=le.upVector(he.canonical,nt.x,nt.y),vt[0]!==0||vt[1]!==0||vt[2]!==1)){const Yt=[vt[2],0,-vt[0]],br=s.cross([],vt,Yt);s.normalize(Yt,Yt),s.normalize(br,br),Vt=s.dot(yt,Yt),ir=s.dot(yt,br)}if(p){const Yt=s.cross([],vt,yt);s.normalize(Yt,Yt),s.scaleAndAdd(lt,lt,Yt,p*me)}const zt=ge+Math.atan2(ir,Vt);return pt.push(lt),ae&&$e.push(nt),{point:lt,angle:zt,path:pt,tilePath:$e,up:vt}}function us(g,u){const p=u.length,_=p+4*g;u.resize(_),u.float32.fill(-1/0,4*p,4*_)}function xr(g,u,p){const _=u[0],S=u[1];return g[0]=p[0]*_+p[4]*S+p[12],g[1]=p[1]*_+p[5]*S+p[13],g[3]=p[3]*_+p[7]*S+p[15],g}const Co=100;class Xu{constructor(u,p,_=new tr(u.width+200,u.height+200,25),S=new tr(u.width+200,u.height+200,25)){this.transform=u,this.grid=_,this.ignoredGrid=S,this.pitchfactor=Math.cos(u._pitch)*u.cameraToCenterDistance,this.screenRightBoundary=u.width+Co,this.screenBottomBoundary=u.height+Co,this.gridRightBoundary=u.width+200,this.gridBottomBoundary=u.height+200,this.fogState=p}placeCollisionBox(u,p,_,S,E,O,I,N){let G=_.projectedAnchorX,V=_.projectedAnchorY,X=_.projectedAnchorZ;const ie=_.elevation,ae=_.tileID,ce=u.getProjection();if(ie&&ae){const[Pe,Ae,Re]=ce.upVector(ae.canonical,_.tileAnchorX,_.tileAnchorY),Ie=ce.upVectorScale(ae.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;G+=Pe*ie*Ie,V+=Ae*ie*Ie,X+=Re*ie*Ie}const le=this.projectAndGetPerspectiveRatio(I,G,V,X,_.tileID,ce.name==="globe"||!!ie||this.transform.pitch>0,ce),he=O*le.perspectiveRatio,J=(_.x1*p+S.x-_.padding)*he+le.point.x,se=(_.y1*p+S.y-_.padding)*he+le.point.y,me=(_.x2*p+S.x+_.padding)*he+le.point.x,ge=(_.y2*p+S.y+_.padding)*he+le.point.y,Te=le.perspectiveRatio<=.55||le.occluded;return!this.isInsideGrid(J,se,me,ge)||!E&&this.grid.hitTest(J,se,me,ge,N)||Te?{box:[],offscreen:!1,occluded:le.occluded}:{box:[J,se,me,ge],offscreen:this.isOffscreen(J,se,me,ge),occluded:!1}}placeCollisionCircles(u,p,_,S,E,O,I,N,G,V,X,ie,ae,ce,le){const he=[],J=this.transform.elevation,se=u.getProjection(),me=J?J.getAtTileOffsetFunc(le,this.transform.center.lat,this.transform.worldSize,se):null,ge=new s.Point(_.tileAnchorX,_.tileAnchorY);let{x:Te,y:Pe,z:Ae}=se.projectTilePoint(ge.x,ge.y,le.canonical);if(me){const[nt,yt,lt]=me(ge);Te+=nt,Pe+=yt,Ae+=lt}const Re=se.name==="globe",Ie=this.projectAndGetPerspectiveRatio(I,Te,Pe,Ae,le,Re||!!J||this.transform.pitch>0,se),{perspectiveRatio:Ve}=Ie,pt=(X?O/Ve:O*Ve)/s.ONE_EM,$e=Nn(Te,Pe,Ae,N),it=Ie.signedDistanceFromCamera>0?Bd(pt,E,_.lineOffsetX*pt,_.lineOffsetY*pt,!1,$e,ge,_,S,N,{},J&&!X?me:null,X&&!!J,se,le,X):null;let He=!1,ft=!1,Ue=!0;if(it&&!Ie.occluded){const nt=.5*ae*Ve+ce,yt=new s.Point(-100,-100),lt=new s.Point(this.screenRightBoundary,this.screenBottomBoundary),vt=new Ut,{first:Vt,last:ir}=it,zt=Vt.path.length;let Yt=[];for(let Nt=zt-1;Nt>=1;Nt--)Yt.push(Vt.path[Nt]);for(let Nt=1;Nt<ir.path.length;Nt++)Yt.push(ir.path[Nt]);const br=2.5*nt;G&&(Yt=Yt.map(([Nt,Fr,Wr],qr)=>(me&&!Re&&(Wr=me(qr<zt-1?Vt.tilePath[zt-1-qr]:ir.tilePath[qr-zt+2])[2]),Nn(Nt,Fr,Wr,G))),Yt.some(Nt=>Nt[3]<=0)&&(Yt=[]));let yr=[];if(Yt.length>0){let Nt=1/0,Fr=-1/0,Wr=1/0,qr=-1/0;for(const Hr of Yt)Nt=Math.min(Nt,Hr[0]),Wr=Math.min(Wr,Hr[1]),Fr=Math.max(Fr,Hr[0]),qr=Math.max(qr,Hr[1]);Fr>=yt.x&&Nt<=lt.x&&qr>=yt.y&&Wr<=lt.y&&(yr=[Yt.map(Hr=>new s.Point(Hr[0],Hr[1]))],(Nt<yt.x||Fr>lt.x||Wr<yt.y||qr>lt.y)&&(yr=s.clipLine(yr,yt.x,yt.y,lt.x,lt.y)))}for(const Nt of yr){vt.reset(Nt,.25*nt);let Fr=0;Fr=vt.length<=.5*nt?1:Math.ceil(vt.paddedLength/br)+1;for(let Wr=0;Wr<Fr;Wr++){const qr=Wr/Math.max(Fr-1,1),Hr=vt.lerp(qr),Fi=Hr.x+Co,fi=Hr.y+Co;he.push(Fi,fi,nt,0);const Wo=Fi-nt,js=fi-nt,vn=Fi+nt,Kr=fi+nt;if(Ue=Ue&&this.isOffscreen(Wo,js,vn,Kr),ft=ft||this.isInsideGrid(Wo,js,vn,Kr),!p&&this.grid.hitTestCircle(Fi,fi,nt,ie)&&(He=!0,!V))return{circles:[],offscreen:!1,collisionDetected:He,occluded:!1}}}}return{circles:!V&&He||!ft?[]:he,offscreen:Ue,collisionDetected:He,occluded:Ie.occluded}}queryRenderedSymbols(u){if(u.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const p=[];let _=1/0,S=1/0,E=-1/0,O=-1/0;for(const V of u){const X=new s.Point(V.x+Co,V.y+Co);_=Math.min(_,X.x),S=Math.min(S,X.y),E=Math.max(E,X.x),O=Math.max(O,X.y),p.push(X)}const I=this.grid.query(_,S,E,O).concat(this.ignoredGrid.query(_,S,E,O)),N={},G={};for(const V of I){const X=V.key;if(N[X.bucketInstanceId]===void 0&&(N[X.bucketInstanceId]={}),N[X.bucketInstanceId][X.featureIndex])continue;const ie=[new s.Point(V.x1,V.y1),new s.Point(V.x2,V.y1),new s.Point(V.x2,V.y2),new s.Point(V.x1,V.y2)];s.polygonIntersectsPolygon(p,ie)&&(N[X.bucketInstanceId][X.featureIndex]=!0,G[X.bucketInstanceId]===void 0&&(G[X.bucketInstanceId]=[]),G[X.bucketInstanceId].push(X.featureIndex))}return G}insertCollisionBox(u,p,_,S,E){(p?this.ignoredGrid:this.grid).insert({bucketInstanceId:_,featureIndex:S,collisionGroupID:E},u[0],u[1],u[2],u[3])}insertCollisionCircles(u,p,_,S,E){const O=p?this.ignoredGrid:this.grid,I={bucketInstanceId:_,featureIndex:S,collisionGroupID:E};for(let N=0;N<u.length;N+=4)O.insertCircle(I,u[N],u[N+1],u[N+2])}projectAndGetPerspectiveRatio(u,p,_,S,E,O,I){const N=[p,_,S,1];let G=!1;S||this.transform.pitch>0?(s.transformMat4$1(N,N,u),this.fogState&&E&&I.name!=="globe"&&(G=function(ie,ae,ce,le,he,J){const se=J.calculateFogTileMatrix(he),me=[ae,ce,le];return s.transformMat4(me,me,se),tt(ie,me,J.pitch,J._fov)}(this.fogState,p,_,S,E.toUnwrapped(),this.transform)>.9)):xr(N,N,u);const V=N[3];return{point:new s.Point((N[0]/V+1)/2*this.transform.width+Co,(-N[1]/V+1)/2*this.transform.height+Co),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(I)/V*.5,1.5),signedDistanceFromCamera:V,occluded:O&&N[2]>V||G}}isOffscreen(u,p,_,S){return _<Co||u>=this.screenRightBoundary||S<Co||p>this.screenBottomBoundary}isInsideGrid(u,p,_,S){return _>=0&&u<this.gridRightBoundary&&S>=0&&p<this.gridBottomBoundary}getViewportMatrix(){const u=s.identity([]);return s.translate(u,u,[-100,-100,0]),u}}function Ml(g,u,p){const _=u.createTileMatrix(g,g.worldSize,p.toUnwrapped());return s.multiply(new Float32Array(16),g.projMatrix,_)}function Fo(g,u,p){if(u.projection.name===p.projection.name)return g.projMatrix;const _=p.clone();return _.setProjection(u.projection),Ml(_,u.getProjection(),g)}function yn(g,u,p){return u.name===p.projection.name?g.projMatrix:Ml(p,u,g)}class K_{constructor(u,p,_,S){this.opacity=u?Math.max(0,Math.min(1,u.opacity+(u.placed?p:-p))):S&&_?1:0,this.placed=_}isHidden(){return this.opacity===0&&!this.placed}}class aa{constructor(u,p,_,S,E,O=!1){this.text=new K_(u?u.text:null,p,_,E),this.icon=new K_(u?u.icon:null,p,S,E),this.clipped=O}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Yu{constructor(u,p,_,S=!1){this.text=u,this.icon=p,this.skipFade=_,this.clipped=S}}class Ju{constructor(){this.invProjMatrix=s.create(),this.viewportMatrix=s.create(),this.circles=[]}}class Um{constructor(u,p,_,S,E){this.bucketInstanceId=u,this.featureIndex=p,this.sourceLayerIndex=_,this.bucketIndex=S,this.tileID=E}}class Z_{constructor(u){this.crossSourceCollisions=u,this.maxGroupID=0,this.collisionGroups={}}get(u){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[u]){const p=++this.maxGroupID;this.collisionGroups[u]={ID:p,predicate:_=>_.collisionGroupID===p}}return this.collisionGroups[u]}}function Qu(g,u,p,_,S){const{horizontalAlign:E,verticalAlign:O}=s.getAnchorAlignment(g),I=-(E-.5)*u,N=-(O-.5)*p,G=s.evaluateVariableOffset(g,_);return new s.Point(I+G[0]*S,N+G[1]*S)}function eh(g,u,p,_,S){const E=new s.Point(g,u);return p&&E._rotate(_?S:-S),E}class Nd{constructor(u,p,_,S,E){this.transform=u.clone(),this.projection=u.projection.name,this.collisionIndex=new Xu(this.transform,E),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=p,this.retainedQueryData={},this.collisionGroups=new Z_(_),this.collisionCircleArrays={},this.prevPlacement=S,S&&(S.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(u,p,_,S){const E=_.getBucket(p),O=_.latestFeatureIndex;if(!E||!O||p.id!==E.layerIds[0])return;const I=E.layers[0].layout,N=_.collisionBoxArray,G=Math.pow(2,this.transform.zoom-_.tileID.overscaledZ),V=_.tileSize/s.EXTENT,X=_.tileID.toUnwrapped();this.transform.setProjection(E.projection);const ie=(ae=_.tileID,ce=E.getProjection(),le=this.transform,ce.name===this.projection?le.calculateProjMatrix(ae.toUnwrapped()):Ml(le,ce,ae));var ae,ce,le;const he=I.get("text-pitch-alignment")==="map",J=I.get("text-rotation-alignment")==="map";p.compileFilter();const se=p.dynamicFilter(),me=p.dynamicFilterNeedsFeature(),ge=this.transform.calculatePixelsToTileUnitsMatrix(_),Te=Ti(ie,_.tileID.canonical,he,J,this.transform,E.getProjection(),ge);let Pe=null;if(he){const Ie=en(ie,_.tileID.canonical,he,J,this.transform,E.getProjection(),ge);Pe=s.multiply([],this.transform.labelPlaneMatrix,Ie)}let Ae=null;se&&_.latestFeatureIndex&&(Ae={unwrappedTileID:X,dynamicFilter:se,dynamicFilterNeedsFeature:me,featureIndex:_.latestFeatureIndex}),this.retainedQueryData[E.bucketInstanceId]=new Um(E.bucketInstanceId,O,E.sourceLayerIndex,E.index,_.tileID);const Re={bucket:E,layout:I,posMatrix:ie,textLabelPlaneMatrix:Te,labelToScreenMatrix:Pe,clippingData:Ae,scale:G,textPixelRatio:V,holdingForFade:_.holdingForFade(),collisionBoxArray:N,partiallyEvaluatedTextSize:s.evaluateSizeForZoom(E.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:s.evaluateSizeForZoom(E.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(E.sourceID)};if(S)for(const Ie of E.sortKeyRanges){const{sortKey:Ve,symbolInstanceStart:pt,symbolInstanceEnd:$e}=Ie;u.push({sortKey:Ve,symbolInstanceStart:pt,symbolInstanceEnd:$e,parameters:Re})}else u.push({symbolInstanceStart:0,symbolInstanceEnd:E.symbolInstances.length,parameters:Re})}attemptAnchorPlacement(u,p,_,S,E,O,I,N,G,V,X,ie,ae,ce,le,he,J,se){const{textOffset0:me,textOffset1:ge,crossTileID:Te}=ie,Pe=[me,ge],Ae=Qu(u,_,S,Pe,E),Re=this.collisionIndex.placeCollisionBox(ce,E,p,eh(Ae.x,Ae.y,O,I,this.transform.angle),X,N,G,V.predicate);if(he){const Ie=ce.getSymbolInstanceIconSize(se,this.transform.zoom,ie.placedIconSymbolIndex);if(this.collisionIndex.placeCollisionBox(ce,Ie,he,eh(Ae.x,Ae.y,O,I,this.transform.angle),X,N,G,V.predicate).box.length===0)return}if(Re.box.length>0){let Ie;return this.prevPlacement&&this.prevPlacement.variableOffsets[Te]&&this.prevPlacement.placements[Te]&&this.prevPlacement.placements[Te].text&&(Ie=this.prevPlacement.variableOffsets[Te].anchor),this.variableOffsets[Te]={textOffset:Pe,width:_,height:S,anchor:u,textScale:E,prevAnchor:Ie},this.markUsedJustification(ce,u,ie,le),ce.allowVerticalPlacement&&(this.markUsedOrientation(ce,le,ie),this.placedOrientations[Te]=le),{shift:Ae,placedGlyphBoxes:Re}}}placeLayerBucketPart(u,p,_,S){const{bucket:E,layout:O,posMatrix:I,textLabelPlaneMatrix:N,labelToScreenMatrix:G,clippingData:V,textPixelRatio:X,holdingForFade:ie,collisionBoxArray:ae,partiallyEvaluatedTextSize:ce,partiallyEvaluatedIconSize:le,collisionGroup:he}=u.parameters,J=O.get("text-optional"),se=O.get("icon-optional"),me=O.get("text-allow-overlap"),ge=O.get("icon-allow-overlap"),Te=O.get("text-rotation-alignment")==="map",Pe=O.get("text-pitch-alignment")==="map",Ae=O.get("icon-text-fit")!=="none",Re=O.get("symbol-z-order")==="viewport-y";this.transform.setProjection(E.projection);let Ie=me&&(ge||!E.hasIconData()||se),Ve=ge&&(me||!E.hasTextData()||J);!E.collisionArrays&&ae&&E.deserializeCollisionBoxes(ae),_&&S&&E.updateCollisionDebugBuffers(this.transform.zoom,ae);const pt=($e,it,He)=>{const{crossTileID:ft,numVerticalGlyphVertices:Ue}=$e;if(V){const vn={zoom:this.transform.zoom,pitch:this.transform.pitch};let Kr=null;if(V.dynamicFilterNeedsFeature){const Lr=this.retainedQueryData[E.bucketInstanceId];Kr=V.featureIndex.loadFeature({featureIndex:$e.featureIndex,bucketIndex:Lr.bucketIndex,sourceLayerIndex:Lr.sourceLayerIndex,layoutVertexArrayOffset:0})}if(!(0,V.dynamicFilter)(vn,Kr,this.retainedQueryData[E.bucketInstanceId].tileID.canonical,new s.Point($e.tileAnchorX,$e.tileAnchorY),this.transform.calculateDistanceTileData(V.unwrappedTileID)))return this.placements[ft]=new Yu(!1,!1,!1,!0),void p.add(ft)}if(p.has(ft))return;if(ie)return void(this.placements[ft]=new Yu(!1,!1,!1));let nt=!1,yt=!1,lt=!0,vt=!1,Vt=!1,ir=null,zt={box:null,offscreen:null,occluded:null},Yt={box:null},br=null,yr=null,Nt=null,Fr=0,Wr=0,qr=0;He.textFeatureIndex?Fr=He.textFeatureIndex:$e.useRuntimeCollisionCircles&&(Fr=$e.featureIndex),He.verticalTextFeatureIndex&&(Wr=He.verticalTextFeatureIndex);const Hr=vn=>{vn.tileID=this.retainedQueryData[E.bucketInstanceId].tileID;const Kr=this.transform.elevation;(Kr||vn.elevation)&&(vn.elevation=Kr?Kr.getAtTileOffset(vn.tileID,vn.tileAnchorX,vn.tileAnchorY):0)},Fi=He.textBox;if(Fi){Hr(Fi);const vn=Lr=>{let Gn=s.WritingMode.horizontal;if(E.allowVerticalPlacement&&!Lr&&this.prevPlacement){const Xi=this.prevPlacement.placedOrientations[ft];Xi&&(this.placedOrientations[ft]=Xi,Gn=Xi,this.markUsedOrientation(E,Gn,$e))}return Gn},Kr=(Lr,Gn)=>{if(E.allowVerticalPlacement&&Ue>0&&He.verticalTextBox){for(const Xi of E.writingModes)if(Xi===s.WritingMode.vertical?(zt=Gn(),Yt=zt):zt=Lr(),zt&&zt.box&&zt.box.length)break}else zt=Lr()};if(O.get("text-variable-anchor")){let Lr=O.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[ft]){const fn=this.prevPlacement.variableOffsets[ft];Lr.indexOf(fn.anchor)>0&&(Lr=Lr.filter(uo=>uo!==fn.anchor),Lr.unshift(fn.anchor))}const Gn=(fn,uo,ff)=>{const Nl=E.getSymbolInstanceTextSize(ce,$e,this.transform.zoom,it),xh=(fn.x2-fn.x1)*Nl+2*fn.padding,pa=(fn.y2-fn.y1)*Nl+2*fn.padding,rl=Ae&&!ge?uo:null;rl&&Hr(rl);let $l={box:[],offscreen:!1,occluded:!1};const pf=me?2*Lr.length:Lr.length;for(let bh=0;bh<pf;++bh){const Ig=this.attemptAnchorPlacement(Lr[bh%Lr.length],fn,xh,pa,Nl,Te,Pe,X,I,he,bh>=Lr.length,$e,it,E,ff,rl,ce,le);if(Ig&&($l=Ig.placedGlyphBoxes,$l&&$l.box&&$l.box.length)){nt=!0,ir=Ig.shift;break}}return $l};Kr(()=>Gn(Fi,He.iconBox,s.WritingMode.horizontal),()=>{const fn=He.verticalTextBox;return fn&&Hr(fn),E.allowVerticalPlacement&&!(zt&&zt.box&&zt.box.length)&&Ue>0&&fn?Gn(fn,He.verticalIconBox,s.WritingMode.vertical):{box:null,offscreen:null,occluded:null}}),zt&&(nt=zt.box,lt=zt.offscreen,vt=zt.occluded);const Xi=vn(!(!zt||!zt.box));if(!nt&&this.prevPlacement){const fn=this.prevPlacement.variableOffsets[ft];fn&&(this.variableOffsets[ft]=fn,this.markUsedJustification(E,fn.anchor,$e,Xi))}}else{const Lr=(Gn,Xi)=>{const fn=E.getSymbolInstanceTextSize(ce,$e,this.transform.zoom,it),uo=this.collisionIndex.placeCollisionBox(E,fn,Gn,new s.Point(0,0),me,X,I,he.predicate);return uo&&uo.box&&uo.box.length&&(this.markUsedOrientation(E,Xi,$e),this.placedOrientations[ft]=Xi),uo};Kr(()=>Lr(Fi,s.WritingMode.horizontal),()=>{const Gn=He.verticalTextBox;return E.allowVerticalPlacement&&Ue>0&&Gn?(Hr(Gn),Lr(Gn,s.WritingMode.vertical)):{box:null,offscreen:null,occluded:null}}),vn(!!(zt&&zt.box&&zt.box.length))}}if(br=zt,nt=br&&br.box&&br.box.length>0,lt=br&&br.offscreen,vt=br&&br.occluded,$e.useRuntimeCollisionCircles){const vn=E.text.placedSymbolArray.get($e.centerJustifiedTextSymbolIndex>=0?$e.centerJustifiedTextSymbolIndex:$e.verticalPlacedTextSymbolIndex),Kr=s.evaluateSizeForFeature(E.textSizeData,ce,vn),Lr=O.get("text-padding");yr=this.collisionIndex.placeCollisionCircles(E,me,vn,E.lineVertexArray,E.glyphOffsetArray,Kr,I,N,G,_,Pe,he.predicate,$e.collisionCircleDiameter*Kr/s.ONE_EM,Lr,this.retainedQueryData[E.bucketInstanceId].tileID),nt=me||yr.circles.length>0&&!yr.collisionDetected,lt=lt&&yr.offscreen,vt=yr.occluded}if(He.iconFeatureIndex&&(qr=He.iconFeatureIndex),He.iconBox){const vn=Kr=>{Hr(Kr);const Lr=Ae&&ir?eh(ir.x,ir.y,Te,Pe,this.transform.angle):new s.Point(0,0),Gn=E.getSymbolInstanceIconSize(le,this.transform.zoom,$e.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(E,Gn,Kr,Lr,ge,X,I,he.predicate)};Yt&&Yt.box&&Yt.box.length&&He.verticalIconBox?(Nt=vn(He.verticalIconBox),yt=Nt.box.length>0):(Nt=vn(He.iconBox),yt=Nt.box.length>0),lt=lt&&Nt.offscreen,Vt=Nt.occluded}const fi=J||$e.numHorizontalGlyphVertices===0&&Ue===0,Wo=se||$e.numIconVertices===0;if(fi||Wo?Wo?fi||(yt=yt&&nt):nt=yt&&nt:yt=nt=yt&&nt,nt&&br&&br.box&&this.collisionIndex.insertCollisionBox(br.box,O.get("text-ignore-placement"),E.bucketInstanceId,Yt&&Yt.box&&Wr?Wr:Fr,he.ID),yt&&Nt&&this.collisionIndex.insertCollisionBox(Nt.box,O.get("icon-ignore-placement"),E.bucketInstanceId,qr,he.ID),yr&&(nt&&this.collisionIndex.insertCollisionCircles(yr.circles,O.get("text-ignore-placement"),E.bucketInstanceId,Fr,he.ID),_)){const vn=E.bucketInstanceId;let Kr=this.collisionCircleArrays[vn];Kr===void 0&&(Kr=this.collisionCircleArrays[vn]=new Ju);for(let Lr=0;Lr<yr.circles.length;Lr+=4)Kr.circles.push(yr.circles[Lr+0]),Kr.circles.push(yr.circles[Lr+1]),Kr.circles.push(yr.circles[Lr+2]),Kr.circles.push(yr.collisionDetected?1:0)}const js=E.projection.name!=="globe";Ie=Ie&&(js||!vt),Ve=Ve&&(js||!Vt),this.placements[ft]=new Yu(nt||Ie,yt||Ve,lt||E.justReloaded),p.add(ft)};if(Re){const $e=E.getSortedSymbolIndexes(this.transform.angle);for(let it=$e.length-1;it>=0;--it){const He=$e[it];pt(E.symbolInstances.get(He),He,E.collisionArrays[He])}}else for(let $e=u.symbolInstanceStart;$e<u.symbolInstanceEnd;$e++)pt(E.symbolInstances.get($e),$e,E.collisionArrays[$e]);if(_&&E.bucketInstanceId in this.collisionCircleArrays){const $e=this.collisionCircleArrays[E.bucketInstanceId];s.invert($e.invProjMatrix,I),$e.viewportMatrix=this.collisionIndex.getViewportMatrix()}E.justReloaded=!1}markUsedJustification(u,p,_,S){const{leftJustifiedTextSymbolIndex:E,centerJustifiedTextSymbolIndex:O,rightJustifiedTextSymbolIndex:I,verticalPlacedTextSymbolIndex:N,crossTileID:G}=_,V=s.getAnchorJustification(p),X=S===s.WritingMode.vertical?N:V==="left"?E:V==="center"?O:V==="right"?I:-1;E>=0&&(u.text.placedSymbolArray.get(E).crossTileID=X>=0&&E!==X?0:G),O>=0&&(u.text.placedSymbolArray.get(O).crossTileID=X>=0&&O!==X?0:G),I>=0&&(u.text.placedSymbolArray.get(I).crossTileID=X>=0&&I!==X?0:G),N>=0&&(u.text.placedSymbolArray.get(N).crossTileID=X>=0&&N!==X?0:G)}markUsedOrientation(u,p,_){const S=p===s.WritingMode.horizontal||p===s.WritingMode.horizontalOnly?p:0,E=p===s.WritingMode.vertical?p:0,{leftJustifiedTextSymbolIndex:O,centerJustifiedTextSymbolIndex:I,rightJustifiedTextSymbolIndex:N,verticalPlacedTextSymbolIndex:G}=_,V=u.text.placedSymbolArray;O>=0&&(V.get(O).placedOrientation=S),I>=0&&(V.get(I).placedOrientation=S),N>=0&&(V.get(N).placedOrientation=S),G>=0&&(V.get(G).placedOrientation=E)}commit(u){this.commitTime=u,this.zoomAtLastRecencyCheck=this.transform.zoom;const p=this.prevPlacement;let _=!1;this.prevZoomAdjustment=p?p.zoomAdjustment(this.transform.zoom):0;const S=p?p.symbolFadeChange(u):1,E=p?p.opacities:{},O=p?p.variableOffsets:{},I=p?p.placedOrientations:{};for(const N in this.placements){const G=this.placements[N],V=E[N];V?(this.opacities[N]=new aa(V,S,G.text,G.icon,null,G.clipped),_=_||G.text!==V.text.placed||G.icon!==V.icon.placed):(this.opacities[N]=new aa(null,S,G.text,G.icon,G.skipFade,G.clipped),_=_||G.text||G.icon)}for(const N in E){const G=E[N];if(!this.opacities[N]){const V=new aa(G,S,!1,!1);V.isHidden()||(this.opacities[N]=V,_=_||G.text.placed||G.icon.placed)}}for(const N in O)this.variableOffsets[N]||!this.opacities[N]||this.opacities[N].isHidden()||(this.variableOffsets[N]=O[N]);for(const N in I)this.placedOrientations[N]||!this.opacities[N]||this.opacities[N].isHidden()||(this.placedOrientations[N]=I[N]);_?this.lastPlacementChangeTime=u:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=p?p.lastPlacementChangeTime:u)}updateLayerOpacities(u,p){const _=new Set;for(const S of p){const E=S.getBucket(u);E&&S.latestFeatureIndex&&u.id===E.layerIds[0]&&this.updateBucketOpacities(E,_,S.collisionBoxArray)}}updateBucketOpacities(u,p,_){u.hasTextData()&&u.text.opacityVertexArray.clear(),u.hasIconData()&&u.icon.opacityVertexArray.clear(),u.hasIconCollisionBoxData()&&u.iconCollisionBox.collisionVertexArray.clear(),u.hasTextCollisionBoxData()&&u.textCollisionBox.collisionVertexArray.clear();const S=u.layers[0].layout,E=!!u.layers[0].dynamicFilter(),O=new aa(null,0,!1,!1,!0),I=S.get("text-allow-overlap"),N=S.get("icon-allow-overlap"),G=S.get("text-variable-anchor"),V=S.get("text-rotation-alignment")==="map",X=S.get("text-pitch-alignment")==="map",ie=S.get("icon-text-fit")!=="none",ae=new aa(null,0,I&&(N||!u.hasIconData()||S.get("icon-optional")),N&&(I||!u.hasTextData()||S.get("text-optional")),!0);!u.collisionArrays&&_&&(u.hasIconCollisionBoxData()||u.hasTextCollisionBoxData())&&u.deserializeCollisionBoxes(_);const ce=(he,J,se)=>{for(let me=0;me<J/4;me++)he.opacityVertexArray.emplaceBack(se)};let le=0;for(let he=0;he<u.symbolInstances.length;he++){const J=u.symbolInstances.get(he),{numHorizontalGlyphVertices:se,numVerticalGlyphVertices:me,crossTileID:ge,numIconVertices:Te}=J,Pe=p.has(ge);let Ae=this.opacities[ge];Pe?Ae=O:Ae||(Ae=ae,this.opacities[ge]=Ae),p.add(ge);const Re=se>0||me>0,Ie=Te>0,Ve=this.placedOrientations[ge],pt=Ve===s.WritingMode.vertical,$e=Ve===s.WritingMode.horizontal||Ve===s.WritingMode.horizontalOnly;if(!Re&&!Ie||Ae.isHidden()||le++,Re){const it=th(Ae.text);ce(u.text,se,pt?Cn:it),ce(u.text,me,$e?Cn:it);const He=Ae.text.isHidden(),{leftJustifiedTextSymbolIndex:ft,centerJustifiedTextSymbolIndex:Ue,rightJustifiedTextSymbolIndex:nt,verticalPlacedTextSymbolIndex:yt}=J,lt=u.text.placedSymbolArray,vt=He||pt?1:0;ft>=0&&(lt.get(ft).hidden=vt),Ue>=0&&(lt.get(Ue).hidden=vt),nt>=0&&(lt.get(nt).hidden=vt),yt>=0&&(lt.get(yt).hidden=He||$e?1:0);const Vt=this.variableOffsets[ge];Vt&&this.markUsedJustification(u,Vt.anchor,J,Ve);const ir=this.placedOrientations[ge];ir&&(this.markUsedJustification(u,"left",J,ir),this.markUsedOrientation(u,ir,J))}if(Ie){const it=th(Ae.icon),{placedIconSymbolIndex:He,verticalPlacedIconSymbolIndex:ft}=J,Ue=u.icon.placedSymbolArray,nt=Ae.icon.isHidden()?1:0;He>=0&&(ce(u.icon,Te,pt?Cn:it),Ue.get(He).hidden=nt),ft>=0&&(ce(u.icon,J.numVerticalIconVertices,$e?Cn:it),Ue.get(ft).hidden=nt)}if(u.hasIconCollisionBoxData()||u.hasTextCollisionBoxData()){const it=u.collisionArrays[he];if(it){let He=new s.Point(0,0),ft=!0;if(it.textBox||it.verticalTextBox){if(G){const nt=this.variableOffsets[ge];nt?(He=Qu(nt.anchor,nt.width,nt.height,nt.textOffset,nt.textScale),V&&He._rotate(X?this.transform.angle:-this.transform.angle)):ft=!1}E&&(ft=!Ae.clipped),it.textBox&&Cc(u.textCollisionBox.collisionVertexArray,Ae.text.placed,!ft||pt,He.x,He.y),it.verticalTextBox&&Cc(u.textCollisionBox.collisionVertexArray,Ae.text.placed,!ft||$e,He.x,He.y)}const Ue=ft&&!!(!$e&&it.verticalIconBox);it.iconBox&&Cc(u.iconCollisionBox.collisionVertexArray,Ae.icon.placed,Ue,ie?He.x:0,ie?He.y:0),it.verticalIconBox&&Cc(u.iconCollisionBox.collisionVertexArray,Ae.icon.placed,!Ue,ie?He.x:0,ie?He.y:0)}}}if(u.fullyClipped=le===0,u.sortFeatures(this.transform.angle),this.retainedQueryData[u.bucketInstanceId]&&(this.retainedQueryData[u.bucketInstanceId].featureSortOrder=u.featureSortOrder),u.hasTextData()&&u.text.opacityVertexBuffer&&u.text.opacityVertexBuffer.updateData(u.text.opacityVertexArray),u.hasIconData()&&u.icon.opacityVertexBuffer&&u.icon.opacityVertexBuffer.updateData(u.icon.opacityVertexArray),u.hasIconCollisionBoxData()&&u.iconCollisionBox.collisionVertexBuffer&&u.iconCollisionBox.collisionVertexBuffer.updateData(u.iconCollisionBox.collisionVertexArray),u.hasTextCollisionBoxData()&&u.textCollisionBox.collisionVertexBuffer&&u.textCollisionBox.collisionVertexBuffer.updateData(u.textCollisionBox.collisionVertexArray),u.bucketInstanceId in this.collisionCircleArrays){const he=this.collisionCircleArrays[u.bucketInstanceId];u.placementInvProjMatrix=he.invProjMatrix,u.placementViewportMatrix=he.viewportMatrix,u.collisionCircleArray=he.circles,delete this.collisionCircleArrays[u.bucketInstanceId]}}symbolFadeChange(u){return this.fadeDuration===0?1:(u-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(u){return Math.max(0,(this.transform.zoom-u)/1.5)}hasTransitions(u){return this.stale||u-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(u,p){const _=this.zoomAtLastRecencyCheck===p?1-this.zoomAdjustment(p):1;return this.zoomAtLastRecencyCheck=p,this.commitTime+this.fadeDuration*_>u}setStale(){this.stale=!0}}function Cc(g,u,p,_,S){g.emplaceBack(u?1:0,p?1:0,_||0,S||0),g.emplaceBack(u?1:0,p?1:0,_||0,S||0),g.emplaceBack(u?1:0,p?1:0,_||0,S||0),g.emplaceBack(u?1:0,p?1:0,_||0,S||0)}const lo=Math.pow(2,25),$n=Math.pow(2,24),Vm=Math.pow(2,17),Gm=Math.pow(2,16),co=Math.pow(2,9),Uo=Math.pow(2,8),X_=Math.pow(2,1);function th(g){if(g.opacity===0&&!g.placed)return 0;if(g.opacity===1&&g.placed)return 4294967295;const u=g.placed?1:0,p=Math.floor(127*g.opacity);return p*lo+u*$n+p*Vm+u*Gm+p*co+u*Uo+p*X_+u}const Cn=0;class rh{constructor(u){this._sortAcrossTiles=u.layout.get("symbol-z-order")!=="viewport-y"&&u.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(u,p,_,S,E){const O=this._bucketParts;for(;this._currentTileIndex<u.length;)if(p.getBucketParts(O,S,u[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,E())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,O.sort((I,N)=>I.sortKey-N.sortKey));this._currentPartIndex<O.length;){const I=O[this._currentPartIndex];if(p.placeLayerBucketPart(I,this._seenCrossTileIDs,_,I.symbolInstanceStart===0),this._currentPartIndex++,E())return!0}return!1}}class Wm{constructor(u,p,_,S,E,O,I,N){this.placement=new Nd(u,E,O,I,N),this._currentPlacementIndex=p.length-1,this._forceFullPlacement=_,this._showCollisionBoxes=S,this._done=!1}isDone(){return this._done}continuePlacement(u,p,_){const S=s.exported.now(),E=()=>{const O=s.exported.now()-S;return!this._forceFullPlacement&&O>2};for(;this._currentPlacementIndex>=0;){const O=p[u[this._currentPlacementIndex]],I=this.placement.collisionIndex.transform.zoom;if(O.type==="symbol"&&(!O.minzoom||O.minzoom<=I)&&(!O.maxzoom||O.maxzoom>I)){if(this._inProgressLayer||(this._inProgressLayer=new rh(O)),this._inProgressLayer.continuePlacement(_[O.source],this.placement,this._showCollisionBoxes,O,E))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(u){return this.placement.commit(u),this.placement}}const Il=512/s.EXTENT/2;class Ei{constructor(u,p,_){this.tileID=u,this.bucketInstanceId=_,this.index=new s.KDBush(p.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];const S=u.canonical.x*s.EXTENT,E=u.canonical.y*s.EXTENT;for(let O=0;O<p.length;O++){const{key:I,crossTileID:N,tileAnchorX:G,tileAnchorY:V}=p.get(O),X=Math.floor((S+G)*Il),ie=Math.floor((E+V)*Il);this.index.add(X,ie),this.keys.push(I),this.crossTileIDs.push(N)}this.index.finish()}findMatches(u,p,_){const S=this.tileID.canonical.z<p.canonical.z?1:Math.pow(2,this.tileID.canonical.z-p.canonical.z),E=Il/Math.pow(2,p.canonical.z-this.tileID.canonical.z),O=p.canonical.x*s.EXTENT,I=p.canonical.y*s.EXTENT;for(let N=0;N<u.length;N++){const G=u.get(N);if(G.crossTileID)continue;const{key:V,tileAnchorX:X,tileAnchorY:ie}=G,ae=Math.floor((O+X)*E),ce=Math.floor((I+ie)*E),le=this.index.range(ae-S,ce-S,ae+S,ce+S);for(const he of le){const J=this.crossTileIDs[he];if(this.keys[he]===V&&!_.has(J)){_.add(J),G.crossTileID=J;break}}}}}class qm{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Hm{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(u){const p=Math.round((u-this.lng)/360);if(p!==0)for(const _ in this.indexes){const S=this.indexes[_],E={};for(const O in S){const I=S[O];I.tileID=I.tileID.unwrapTo(I.tileID.wrap+p),E[I.tileID.key]=I}this.indexes[_]=E}this.lng=u}addBucket(u,p,_){if(this.indexes[u.overscaledZ]&&this.indexes[u.overscaledZ][u.key]){if(this.indexes[u.overscaledZ][u.key].bucketInstanceId===p.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(u.overscaledZ,this.indexes[u.overscaledZ][u.key])}for(let E=0;E<p.symbolInstances.length;E++)p.symbolInstances.get(E).crossTileID=0;this.usedCrossTileIDs[u.overscaledZ]||(this.usedCrossTileIDs[u.overscaledZ]=new Set);const S=this.usedCrossTileIDs[u.overscaledZ];for(const E in this.indexes){const O=this.indexes[E];if(Number(E)>u.overscaledZ)for(const I in O){const N=O[I];N.tileID.isChildOf(u)&&N.findMatches(p.symbolInstances,u,S)}else{const I=O[u.scaledTo(Number(E)).key];I&&I.findMatches(p.symbolInstances,u,S)}}for(let E=0;E<p.symbolInstances.length;E++){const O=p.symbolInstances.get(E);O.crossTileID||(O.crossTileID=_.generate(),S.add(O.crossTileID))}return this.indexes[u.overscaledZ]===void 0&&(this.indexes[u.overscaledZ]={}),this.indexes[u.overscaledZ][u.key]=new Ei(u,p.symbolInstances,p.bucketInstanceId),!0}removeBucketCrossTileIDs(u,p){for(const _ of p.crossTileIDs)this.usedCrossTileIDs[u].delete(_)}removeStaleBuckets(u){let p=!1;for(const _ in this.indexes){const S=this.indexes[_];for(const E in S)u[S[E].bucketInstanceId]||(this.removeBucketCrossTileIDs(_,S[E]),delete S[E],p=!0)}return p}}class la{constructor(){this.layerIndexes={},this.crossTileIDs=new qm,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(u,p,_,S){let E=this.layerIndexes[u.id];E===void 0&&(E=this.layerIndexes[u.id]=new Hm);let O=!1;const I={};S.name!=="globe"&&E.handleWrapJump(_);for(const N of p){const G=N.getBucket(u);G&&u.id===G.layerIds[0]&&(G.bucketInstanceId||(G.bucketInstanceId=++this.maxBucketInstanceId),E.addBucket(N.tileID,G,this.crossTileIDs)&&(O=!0),I[G.bucketInstanceId]=!0)}return E.removeStaleBuckets(I)&&(O=!0),O}pruneUnusedLayers(u){const p={};u.forEach(_=>{p[_]=!0});for(const _ in this.layerIndexes)p[_]||delete this.layerIndexes[_]}}const el=(g,u)=>s.emitValidationErrors(g,u&&u.filter(p=>p.identifier!=="source.canvas")),$d=s.pick(Mr,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection"]),zS=s.pick(Mr,["setCenter","setZoom","setBearing","setPitch"]),Km={version:8,layers:[],sources:{}},kc={fill:!0,line:!0,background:!0,hillshade:!0,raster:!0};class Rs extends s.Evented{constructor(u,p={}){super(),this.map=u,this.dispatcher=new ht(Ya(),this),this.imageManager=new Oe,this.imageManager.setEventedParent(this),this.glyphManager=new s.GlyphManager(u._requestManager,p.localFontFamily?s.LocalGlyphMode.all:p.localIdeographFontFamily?s.LocalGlyphMode.ideographs:s.LocalGlyphMode.none,p.localFontFamily||p.localIdeographFontFamily),this.crossTileSymbolIndex=new la,this._layers={},this._num3DLayers=0,this._numSymbolLayers=0,this._numCircleLayers=0,this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._availableImages=[],this._order=[],this._drapedFirstOrder=[],this._markersNeedUpdate=!1,this._resetUpdates(),this.dispatcher.broadcast("setReferrer",s.getReferrer());const _=this;this._rtlTextPluginCallback=Rs.registerForPluginStateChange(S=>{_.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:S.pluginStatus,pluginURL:S.pluginURL},(E,O)=>{if(s.triggerPluginCompletionEvent(E),O&&O.every(I=>I))for(const I in _._sourceCaches){const N=_._sourceCaches[I],G=N.getSource().type;G!=="vector"&&G!=="geojson"||N.reload()}})}),this.on("data",S=>{if(S.dataType!=="source"||S.sourceDataType!=="metadata")return;const E=this.getSource(S.sourceId);if(E&&E.vectorLayerIds)for(const O in this._layers){const I=this._layers[O];I.source===E.id&&this._validateLayer(I)}})}loadURL(u,p={}){this.fire(new s.Event("dataloading",{dataType:"style"}));const _=typeof p.validate=="boolean"?p.validate:!s.isMapboxURL(u);u=this.map._requestManager.normalizeStyleURL(u,p.accessToken);const S=this.map._requestManager.transformRequest(u,s.ResourceType.Style);this._request=s.getJSON(S,(E,O)=>{this._request=null,E?this.fire(new s.ErrorEvent(E)):O&&this._load(O,_)})}loadJSON(u,p={}){this.fire(new s.Event("dataloading",{dataType:"style"})),this._request=s.exported.frame(()=>{this._request=null,this._load(u,p.validate!==!1)})}loadEmpty(){this.fire(new s.Event("dataloading",{dataType:"style"})),this._load(Km,!1)}_updateLayerCount(u,p){const _=p?1:-1;u.is3D()&&(this._num3DLayers+=_),u.type==="circle"&&(this._numCircleLayers+=_),u.type==="symbol"&&(this._numSymbolLayers+=_)}_load(u,p){if(p&&el(this,s.validateStyle(u)))return;this._loaded=!0,this.stylesheet=s.clone$1(u),this._updateMapProjection();for(const S in u.sources)this.addSource(S,u.sources[S],{validate:!1});this._changed=!1,u.sprite?this._loadSprite(u.sprite):(this.imageManager.setLoaded(!0),this.dispatcher.broadcast("spriteLoaded",!0)),this.glyphManager.setURL(u.glyphs);const _=zd(this.stylesheet.layers);this._order=_.map(S=>S.id),this._layers={},this._serializedLayers={};for(const S of _){const E=s.createStyleLayer(S);E.setEventedParent(this,{layer:{id:E.id}}),this._layers[E.id]=E,this._serializedLayers[E.id]=E.serialize(),this._updateLayerCount(E,!0)}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new Ge(this.stylesheet.light),this.stylesheet.terrain&&!this.terrainSetForDrapingOnly()&&this._createTerrain(this.stylesheet.terrain,1),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this._updateDrapeFirstLayers(),this.fire(new s.Event("data",{dataType:"style"})),this.fire(new s.Event("style.load"))}terrainSetForDrapingOnly(){return!!this.terrain&&this.terrain.drapeRenderMode===0}setProjection(u){u?this.stylesheet.projection=u:delete this.stylesheet.projection,this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?this.getTerrain()||this.stylesheet.terrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null))}_updateMapProjection(){this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.stylesheet.projection)}_loadSprite(u){this._spriteRequest=function(p,_,S){let E,O,I;const N=s.exported.devicePixelRatio>1?"@2x":"";let G=s.getJSON(_.transformRequest(_.normalizeSpriteURL(p,N,".json"),s.ResourceType.SpriteJSON),(ie,ae)=>{G=null,I||(I=ie,E=ae,X())}),V=s.getImage(_.transformRequest(_.normalizeSpriteURL(p,N,".png"),s.ResourceType.SpriteImage),(ie,ae)=>{V=null,I||(I=ie,O=ae,X())});function X(){if(I)S(I);else if(E&&O){const ie=s.exported.getImageData(O),ae={};for(const ce in E){const{width:le,height:he,x:J,y:se,sdf:me,pixelRatio:ge,stretchX:Te,stretchY:Pe,content:Ae}=E[ce],Re=new s.RGBAImage({width:le,height:he});s.RGBAImage.copy(ie,Re,{x:J,y:se},{x:0,y:0},{width:le,height:he}),ae[ce]={data:Re,pixelRatio:ge,sdf:me,stretchX:Te,stretchY:Pe,content:Ae}}S(null,ae)}}return{cancel(){G&&(G.cancel(),G=null),V&&(V.cancel(),V=null)}}}(u,this.map._requestManager,(p,_)=>{if(this._spriteRequest=null,p)this.fire(new s.ErrorEvent(p));else if(_)for(const S in _)this.imageManager.addImage(S,_[S]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.dispatcher.broadcast("spriteLoaded",!0),this.fire(new s.Event("data",{dataType:"style"}))})}_validateLayer(u){const p=this.getSource(u.source);if(!p)return;const _=u.sourceLayer;_&&(p.type==="geojson"||p.vectorLayerIds&&p.vectorLayerIds.indexOf(_)===-1)&&this.fire(new s.ErrorEvent(new Error(`Source layer "${_}" does not exist on source "${p.id}" as specified by style layer "${u.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const u in this._sourceCaches)if(!this._sourceCaches[u].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(u){const p=[];for(const _ of u){const S=this._layers[_];S.type!=="custom"&&p.push(S.serialize())}return p}hasTransitions(){if(this.light&&this.light.hasTransition()||this.fog&&this.fog.hasTransition())return!0;for(const u in this._sourceCaches)if(this._sourceCaches[u].hasTransition())return!0;for(const u in this._layers)if(this._layers[u].hasTransition())return!0;return!1}get order(){return this.map._optimizeForTerrain&&this.terrain?this._drapedFirstOrder:this._order}isLayerDraped(u){return!!this.terrain&&(typeof u.isLayerDraped=="function"?u.isLayerDraped():kc[u.type])}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}update(u){if(!this._loaded)return;const p=this._changed;if(this._changed){const S=Object.keys(this._updatedLayers),E=Object.keys(this._removedLayers);(S.length||E.length)&&this._updateWorkerLayers(S,E);for(const O in this._updatedSources){const I=this._updatedSources[O];I==="reload"?this._reloadSource(O):I==="clear"&&this._clearSource(O)}this._updateTilesForChangedImages();for(const O in this._updatedPaintProps)this._layers[O].updateTransitions(u);this.light.updateTransitions(u),this.fog&&this.fog.updateTransitions(u),this._resetUpdates()}const _={};for(const S in this._sourceCaches){const E=this._sourceCaches[S];_[S]=E.used,E.used=!1}for(const S of this._order){const E=this._layers[S];if(E.recalculate(u,this._availableImages),!E.isHidden(u.zoom)){const I=this._getLayerSourceCache(E);I&&(I.used=!0)}const O=this.map.painter;if(O){const I=E.getProgramIds();if(!I)continue;const N=E.getProgramConfiguration(u.zoom);for(const G of I)O.useProgram(G,N)}}for(const S in _){const E=this._sourceCaches[S];_[S]!==E.used&&E.getSource().fire(new s.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:E.getSource().id}))}this.light.recalculate(u),this.terrain&&this.terrain.recalculate(u),this.fog&&this.fog.recalculate(u),this.z=u.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),p&&this.fire(new s.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const u=Object.keys(this._changedImages);if(u.length){for(const p in this._sourceCaches)this._sourceCaches[p].reloadTilesForDependencies(["icons","patterns"],u);this._changedImages={}}}_updateWorkerLayers(u,p){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(u),removedIds:p})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setState(u){if(this._checkLoaded(),el(this,s.validateStyle(u)))return!1;(u=s.clone$1(u)).layers=zd(u.layers);const p=function(S,E){if(!S)return[{command:Mr.setStyle,args:[E]}];let O=[];try{if(!y(S.version,E.version))return[{command:Mr.setStyle,args:[E]}];y(S.center,E.center)||O.push({command:Mr.setCenter,args:[E.center]}),y(S.zoom,E.zoom)||O.push({command:Mr.setZoom,args:[E.zoom]}),y(S.bearing,E.bearing)||O.push({command:Mr.setBearing,args:[E.bearing]}),y(S.pitch,E.pitch)||O.push({command:Mr.setPitch,args:[E.pitch]}),y(S.sprite,E.sprite)||O.push({command:Mr.setSprite,args:[E.sprite]}),y(S.glyphs,E.glyphs)||O.push({command:Mr.setGlyphs,args:[E.glyphs]}),y(S.transition,E.transition)||O.push({command:Mr.setTransition,args:[E.transition]}),y(S.light,E.light)||O.push({command:Mr.setLight,args:[E.light]}),y(S.fog,E.fog)||O.push({command:Mr.setFog,args:[E.fog]}),y(S.projection,E.projection)||O.push({command:Mr.setProjection,args:[E.projection]});const I={},N=[];(function(X,ie,ae,ce){let le;for(le in ie=ie||{},X=X||{})X.hasOwnProperty(le)&&(ie.hasOwnProperty(le)||Ja(le,ae,ce));for(le in ie){if(!ie.hasOwnProperty(le))continue;const he=ie[le];X.hasOwnProperty(le)?y(X[le],he)||(X[le].type==="geojson"&&he.type==="geojson"&&rt(X,ie,le)?ae.push({command:Mr.setGeoJSONSourceData,args:[le,he.data]}):Ac(le,ie,ae,ce)):Ec(le,ie,ae)}})(S.sources,E.sources,N,I);const G=[];S.layers&&S.layers.forEach(X=>{X.source&&I[X.source]?O.push({command:Mr.removeLayer,args:[X.id]}):G.push(X)});let V=S.terrain;V&&I[V.source]&&(O.push({command:Mr.setTerrain,args:[void 0]}),V=void 0),O=O.concat(N),y(V,E.terrain)||O.push({command:Mr.setTerrain,args:[E.terrain]}),function(X,ie,ae){ie=ie||[];const ce=(X=X||[]).map(nr),le=ie.map(nr),he=X.reduce(Xt,{}),J=ie.reduce(Xt,{}),se=ce.slice(),me=Object.create(null);let ge,Te,Pe,Ae,Re,Ie,Ve;for(ge=0,Te=0;ge<ce.length;ge++)Pe=ce[ge],J.hasOwnProperty(Pe)?Te++:(ae.push({command:Mr.removeLayer,args:[Pe]}),se.splice(se.indexOf(Pe,Te),1));for(ge=0,Te=0;ge<le.length;ge++)Pe=le[le.length-1-ge],se[se.length-1-ge]!==Pe&&(he.hasOwnProperty(Pe)?(ae.push({command:Mr.removeLayer,args:[Pe]}),se.splice(se.lastIndexOf(Pe,se.length-Te),1)):Te++,Ie=se[se.length-ge],ae.push({command:Mr.addLayer,args:[J[Pe],Ie]}),se.splice(se.length-ge,0,Pe),me[Pe]=!0);for(ge=0;ge<le.length;ge++)if(Pe=le[ge],Ae=he[Pe],Re=J[Pe],!me[Pe]&&!y(Ae,Re))if(y(Ae.source,Re.source)&&y(Ae["source-layer"],Re["source-layer"])&&y(Ae.type,Re.type)){for(Ve in Ct(Ae.layout,Re.layout,ae,Pe,null,Mr.setLayoutProperty),Ct(Ae.paint,Re.paint,ae,Pe,null,Mr.setPaintProperty),y(Ae.filter,Re.filter)||ae.push({command:Mr.setFilter,args:[Pe,Re.filter]}),y(Ae.minzoom,Re.minzoom)&&y(Ae.maxzoom,Re.maxzoom)||ae.push({command:Mr.setLayerZoomRange,args:[Pe,Re.minzoom,Re.maxzoom]}),Ae)Ae.hasOwnProperty(Ve)&&Ve!=="layout"&&Ve!=="paint"&&Ve!=="filter"&&Ve!=="metadata"&&Ve!=="minzoom"&&Ve!=="maxzoom"&&(Ve.indexOf("paint.")===0?Ct(Ae[Ve],Re[Ve],ae,Pe,Ve.slice(6),Mr.setPaintProperty):y(Ae[Ve],Re[Ve])||ae.push({command:Mr.setLayerProperty,args:[Pe,Ve,Re[Ve]]}));for(Ve in Re)Re.hasOwnProperty(Ve)&&!Ae.hasOwnProperty(Ve)&&Ve!=="layout"&&Ve!=="paint"&&Ve!=="filter"&&Ve!=="metadata"&&Ve!=="minzoom"&&Ve!=="maxzoom"&&(Ve.indexOf("paint.")===0?Ct(Ae[Ve],Re[Ve],ae,Pe,Ve.slice(6),Mr.setPaintProperty):y(Ae[Ve],Re[Ve])||ae.push({command:Mr.setLayerProperty,args:[Pe,Ve,Re[Ve]]}))}else ae.push({command:Mr.removeLayer,args:[Pe]}),Ie=se[se.lastIndexOf(Pe)+1],ae.push({command:Mr.addLayer,args:[Re,Ie]})}(G,E.layers,O)}catch(I){console.warn("Unable to compute style diff:",I),O=[{command:Mr.setStyle,args:[E]}]}return O}(this.serialize(),u).filter(S=>!(S.command in zS));if(p.length===0)return!1;const _=p.filter(S=>!(S.command in $d));if(_.length>0)throw new Error(`Unimplemented: ${_.map(S=>S.command).join(", ")}.`);return p.forEach(S=>{S.command!=="setTransition"&&S.command!=="setProjection"&&this[S.command].apply(this,S.args)}),this.stylesheet=u,this._updateMapProjection(),!0}addImage(u,p){return this.getImage(u)?this.fire(new s.ErrorEvent(new Error("An image with this name already exists."))):(this.imageManager.addImage(u,p),this._afterImageUpdated(u),this)}updateImage(u,p){this.imageManager.updateImage(u,p)}getImage(u){return this.imageManager.getImage(u)}removeImage(u){return this.getImage(u)?(this.imageManager.removeImage(u),this._afterImageUpdated(u),this):this.fire(new s.ErrorEvent(new Error("No image with this name exists.")))}_afterImageUpdated(u){this._availableImages=this.imageManager.listImages(),this._changedImages[u]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new s.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addSource(u,p,_={}){if(this._checkLoaded(),this.getSource(u)!==void 0)throw new Error("There is already a source with this ID");if(!p.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(p).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(p.type)>=0&&this._validate(s.validateSource,`sources.${u}`,p,null,_))return;this.map&&this.map._collectResourceTiming&&(p.collectResourceTiming=!0);const S=gr(u,p,this.dispatcher,this);S.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(u),source:S.serialize(),sourceId:u}));const E=O=>{const I=(O?"symbol:":"other:")+u,N=this._sourceCaches[I]=new s.SourceCache(I,S,O);(O?this._symbolSourceCaches:this._otherSourceCaches)[u]=N,N.style=this,N.onAdd(this.map)};E(!1),p.type!=="vector"&&p.type!=="geojson"||E(!0),S.onAdd&&S.onAdd(this.map),this._changed=!0}removeSource(u){this._checkLoaded();const p=this.getSource(u);if(!p)throw new Error("There is no source with this ID");for(const S in this._layers)if(this._layers[S].source===u)return this.fire(new s.ErrorEvent(new Error(`Source "${u}" cannot be removed while layer "${S}" is using it.`)));if(this.terrain&&this.terrain.get().source===u)return this.fire(new s.ErrorEvent(new Error(`Source "${u}" cannot be removed while terrain is using it.`)));const _=this._getSourceCaches(u);for(const S of _)delete this._sourceCaches[S.id],delete this._updatedSources[S.id],S.fire(new s.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:S.getSource().id})),S.setEventedParent(null),S.clearTiles();return delete this._otherSourceCaches[u],delete this._symbolSourceCaches[u],p.setEventedParent(null),p.onRemove&&p.onRemove(this.map),this._changed=!0,this}setGeoJSONSourceData(u,p){this._checkLoaded(),this.getSource(u).setData(p),this._changed=!0}getSource(u){const p=this._getSourceCache(u);return p&&p.getSource()}_getSources(){const u=[];for(const p in this._otherSourceCaches){const _=this._getSourceCache(p);_&&u.push(_.getSource())}return u}addLayer(u,p,_={}){this._checkLoaded();const S=u.id;if(this.getLayer(S))return void this.fire(new s.ErrorEvent(new Error(`Layer with id "${S}" already exists on this map`)));let E;if(u.type==="custom"){if(el(this,s.validateCustomStyleLayer(u)))return;E=s.createStyleLayer(u)}else{if(typeof u.source=="object"&&(this.addSource(S,u.source),u=s.clone$1(u),u=s.extend(u,{source:S})),this._validate(s.validateLayer,`layers.${S}`,u,{arrayIndex:-1},_))return;E=s.createStyleLayer(u),this._validateLayer(E),E.setEventedParent(this,{layer:{id:S}}),this._serializedLayers[E.id]=E.serialize(),this._updateLayerCount(E,!0)}const O=p?this._order.indexOf(p):this._order.length;if(p&&O===-1)return void this.fire(new s.ErrorEvent(new Error(`Layer with id "${p}" does not exist on this map.`)));this._order.splice(O,0,S),this._layerOrderChanged=!0,this._layers[S]=E;const I=this._getLayerSourceCache(E);if(this._removedLayers[S]&&E.source&&I&&E.type!=="custom"){const N=this._removedLayers[S];delete this._removedLayers[S],N.type!==E.type?this._updatedSources[E.source]="clear":(this._updatedSources[E.source]="reload",I.pause())}this._updateLayer(E),E.onAdd&&E.onAdd(this.map),this._updateDrapeFirstLayers()}moveLayer(u,p){if(this._checkLoaded(),this._changed=!0,!this._layers[u])return void this.fire(new s.ErrorEvent(new Error(`The layer '${u}' does not exist in the map's style and cannot be moved.`)));if(u===p)return;const _=this._order.indexOf(u);this._order.splice(_,1);const S=p?this._order.indexOf(p):this._order.length;p&&S===-1?this.fire(new s.ErrorEvent(new Error(`Layer with id "${p}" does not exist on this map.`))):(this._order.splice(S,0,u),this._layerOrderChanged=!0,this._updateDrapeFirstLayers())}removeLayer(u){this._checkLoaded();const p=this._layers[u];if(!p)return void this.fire(new s.ErrorEvent(new Error(`The layer '${u}' does not exist in the map's style and cannot be removed.`)));p.setEventedParent(null),this._updateLayerCount(p,!1);const _=this._order.indexOf(u);this._order.splice(_,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[u]=p,delete this._layers[u],delete this._serializedLayers[u],delete this._updatedLayers[u],delete this._updatedPaintProps[u],p.onRemove&&p.onRemove(this.map),this._updateDrapeFirstLayers()}getLayer(u){return this._layers[u]}hasLayer(u){return u in this._layers}hasLayerType(u){for(const p in this._layers)if(this._layers[p].type===u)return!0;return!1}setLayerZoomRange(u,p,_){this._checkLoaded();const S=this.getLayer(u);S?S.minzoom===p&&S.maxzoom===_||(p!=null&&(S.minzoom=p),_!=null&&(S.maxzoom=_),this._updateLayer(S)):this.fire(new s.ErrorEvent(new Error(`The layer '${u}' does not exist in the map's style and cannot have zoom extent.`)))}setFilter(u,p,_={}){this._checkLoaded();const S=this.getLayer(u);if(S){if(!y(S.filter,p))return p==null?(S.filter=void 0,void this._updateLayer(S)):void(this._validate(s.validateFilter,`layers.${S.id}.filter`,p,{layerType:S.type},_)||(S.filter=s.clone$1(p),this._updateLayer(S)))}else this.fire(new s.ErrorEvent(new Error(`The layer '${u}' does not exist in the map's style and cannot be filtered.`)))}getFilter(u){const p=this.getLayer(u);return p&&s.clone$1(p.filter)}setLayoutProperty(u,p,_,S={}){this._checkLoaded();const E=this.getLayer(u);E?y(E.getLayoutProperty(p),_)||(E.setLayoutProperty(p,_,S),this._updateLayer(E)):this.fire(new s.ErrorEvent(new Error(`The layer '${u}' does not exist in the map's style and cannot be styled.`)))}getLayoutProperty(u,p){const _=this.getLayer(u);if(_)return _.getLayoutProperty(p);this.fire(new s.ErrorEvent(new Error(`The layer '${u}' does not exist in the map's style.`)))}setPaintProperty(u,p,_,S={}){this._checkLoaded();const E=this.getLayer(u);E?y(E.getPaintProperty(p),_)||(E.setPaintProperty(p,_,S)&&this._updateLayer(E),this._changed=!0,this._updatedPaintProps[u]=!0):this.fire(new s.ErrorEvent(new Error(`The layer '${u}' does not exist in the map's style and cannot be styled.`)))}getPaintProperty(u,p){const _=this.getLayer(u);return _&&_.getPaintProperty(p)}setFeatureState(u,p){this._checkLoaded();const _=u.source,S=u.sourceLayer,E=this.getSource(_);if(!E)return void this.fire(new s.ErrorEvent(new Error(`The source '${_}' does not exist in the map's style.`)));const O=E.type;if(O==="geojson"&&S)return void this.fire(new s.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(O==="vector"&&!S)return void this.fire(new s.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));u.id===void 0&&this.fire(new s.ErrorEvent(new Error("The feature id parameter must be provided.")));const I=this._getSourceCaches(_);for(const N of I)N.setFeatureState(S,u.id,p)}removeFeatureState(u,p){this._checkLoaded();const _=u.source,S=this.getSource(_);if(!S)return void this.fire(new s.ErrorEvent(new Error(`The source '${_}' does not exist in the map's style.`)));const E=S.type,O=E==="vector"?u.sourceLayer:void 0;if(E==="vector"&&!O)return void this.fire(new s.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));if(p&&typeof u.id!="string"&&typeof u.id!="number")return void this.fire(new s.ErrorEvent(new Error("A feature id is required to remove its specific state property.")));const I=this._getSourceCaches(_);for(const N of I)N.removeFeatureState(O,u.id,p)}getFeatureState(u){this._checkLoaded();const p=u.source,_=u.sourceLayer,S=this.getSource(p);if(S){if(S.type!=="vector"||_)return u.id===void 0&&this.fire(new s.ErrorEvent(new Error("The feature id parameter must be provided."))),this._getSourceCaches(p)[0].getFeatureState(_,u.id);this.fire(new s.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new s.ErrorEvent(new Error(`The source '${p}' does not exist in the map's style.`)))}getTransition(){return s.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){const u={};for(const p in this._sourceCaches){const _=this._sourceCaches[p].getSource();u[_.id]||(u[_.id]=_.serialize())}return s.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,terrain:this.getTerrain()||void 0,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:u,layers:this._serializeLayers(this._order)},p=>p!==void 0)}_updateLayer(u){this._updatedLayers[u.id]=!0;const p=this._getLayerSourceCache(u);u.source&&!this._updatedSources[u.source]&&p&&p.getSource().type!=="raster"&&(this._updatedSources[u.source]="reload",p.pause()),this._changed=!0,u.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(u){const p=O=>this._layers[O].type==="fill-extrusion",_={},S=[];for(let O=this._order.length-1;O>=0;O--){const I=this._order[O];if(p(I)){_[I]=O;for(const N of u){const G=N[I];if(G)for(const V of G)S.push(V)}}}S.sort((O,I)=>I.intersectionZ-O.intersectionZ);const E=[];for(let O=this._order.length-1;O>=0;O--){const I=this._order[O];if(p(I))for(let N=S.length-1;N>=0;N--){const G=S[N].feature;if(_[G.layer.id]<O)break;E.push(G),S.pop()}else for(const N of u){const G=N[I];if(G)for(const V of G)E.push(V.feature)}}return E}queryRenderedFeatures(u,p,_){p&&p.filter&&this._validate(s.validateFilter,"queryRenderedFeatures.filter",p.filter,null,p);const S={};if(p&&p.layers){if(!Array.isArray(p.layers))return this.fire(new s.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const N of p.layers){const G=this._layers[N];if(!G)return this.fire(new s.ErrorEvent(new Error(`The layer '${N}' does not exist in the map's style and cannot be queried for features.`))),[];S[G.source]=!0}}const E=[];p.availableImages=this._availableImages;const O=p&&p.layers?p.layers.some(N=>{const G=this.getLayer(N);return G&&G.is3D()}):this.has3DLayers(),I=Lt.createFromScreenPoints(u,_);for(const N in this._sourceCaches){const G=this._sourceCaches[N].getSource().id;p.layers&&!S[G]||E.push(dn(this._sourceCaches[N],this._layers,this._serializedLayers,I,p,_,O,!!this.map._showQueryGeometry))}return this.placement&&E.push(function(N,G,V,X,ie,ae,ce){const le={},he=ae.queryRenderedSymbols(X),J=[];for(const se of Object.keys(he).map(Number))J.push(ce[se]);J.sort(hi);for(const se of J){const me=se.featureIndex.lookupSymbolFeatures(he[se.bucketInstanceId],G,se.bucketIndex,se.sourceLayerIndex,ie.filter,ie.layers,ie.availableImages,N);for(const ge in me){const Te=le[ge]=le[ge]||[],Pe=me[ge];Pe.sort((Ae,Re)=>{const Ie=se.featureSortOrder;if(Ie){const Ve=Ie.indexOf(Ae.featureIndex);return Ie.indexOf(Re.featureIndex)-Ve}return Re.featureIndex-Ae.featureIndex});for(const Ae of Pe)Te.push(Ae)}}for(const se in le)le[se].forEach(me=>{const ge=me.feature,Te=V(N[se]);if(!Te)return;const Pe=Te.getFeatureState(ge.layer["source-layer"],ge.id);ge.source=ge.layer.source,ge.layer["source-layer"]&&(ge.sourceLayer=ge.layer["source-layer"]),ge.state=Pe});return le}(this._layers,this._serializedLayers,this._getLayerSourceCache.bind(this),I.screenGeometry,p,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(E)}querySourceFeatures(u,p){p&&p.filter&&this._validate(s.validateFilter,"querySourceFeatures.filter",p.filter,null,p);const _=this._getSourceCaches(u);let S=[];for(const E of _)S=S.concat(An(E,p));return S}addSourceType(u,p,_){return Rs.getSourceType(u)?_(new Error(`A source type called "${u}" already exists.`)):(Rs.setSourceType(u,p),p.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:u,url:p.workerSourceURL},_):_(null,null))}getLight(){return this.light.getLight()}setLight(u,p={}){this._checkLoaded();const _=this.light.getLight();let S=!1;for(const O in u)if(!y(u[O],_[O])){S=!0;break}if(!S)return;const E=this._setTransitionParameters({duration:300,delay:0});this.light.setLight(u,p),this.light.updateTransitions(E)}getTerrain(){return this.terrain&&this.terrain.drapeRenderMode===1?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}setTerrain(u,p=1){if(this._checkLoaded(),!u)return delete this.terrain,delete this.stylesheet.terrain,this.dispatcher.broadcast("enableTerrain",!1),this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);let _=u;if(p===1){if(typeof _.source=="object"){const S="terrain-dem-src";this.addSource(S,_.source),_=s.clone$1(_),_=s.extend(_,{source:S})}if(this._validate(s.validateTerrain,"terrain",_))return}if(!this.terrain||this.terrain&&p!==this.terrain.drapeRenderMode){if(!_)return;this._createTerrain(_,p)}else{const S=this.terrain,E=S.get();for(const O of Object.keys(s.spec.terrain))!_.hasOwnProperty(O)&&s.spec.terrain[O].default&&(_[O]=s.spec.terrain[O].default);for(const O in _)if(!y(_[O],E[O])){S.set(_),this.stylesheet.terrain=_;const I=this._setTransitionParameters({duration:0});S.updateTransitions(I);break}}this._updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(u){const p=this.fog=new ut(u,this.map.transform);this.stylesheet.fog=u;const _=this._setTransitionParameters({duration:0});p.updateTransitions(_)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask(()=>{for(const u of this.map._markers)u._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(u){if(this._checkLoaded(),!u)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const p=this.fog,_=p.get();Object.keys(u).length===0&&p.set(u);for(const S in u)if(!y(u[S],_[S])){p.set(u),this.stylesheet.fog=u;const E=this._setTransitionParameters({duration:0});p.updateTransitions(E);break}}else this._createFog(u);this._markersNeedUpdate=!0}_setTransitionParameters(u){return{now:s.exported.now(),transition:s.extend(u,this.stylesheet.transition)}}_updateDrapeFirstLayers(){if(!this.map._optimizeForTerrain||!this.terrain)return;const u=this._order.filter(_=>this.isLayerDraped(this._layers[_])),p=this._order.filter(_=>!this.isLayerDraped(this._layers[_]));this._drapedFirstOrder=[],this._drapedFirstOrder.push(...u),this._drapedFirstOrder.push(...p)}_createTerrain(u,p){const _=this.terrain=new Ye(u,p);this.stylesheet.terrain=u,this.dispatcher.broadcast("enableTerrain",!this.terrainSetForDrapingOnly()),this._force3DLayerUpdate();const S=this._setTransitionParameters({duration:0});_.updateTransitions(S)}_force3DLayerUpdate(){for(const u in this._layers){const p=this._layers[u];p.type==="fill-extrusion"&&this._updateLayer(p)}}_forceSymbolLayerUpdate(){for(const u in this._layers){const p=this._layers[u];p.type==="symbol"&&this._updateLayer(p)}}_validate(u,p,_,S,E={}){return(!E||E.validate!==!1)&&el(this,u.call(s.validateStyle,s.extend({key:p,style:this.serialize(),value:_,styleSpec:s.spec},S)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),s.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const u in this._layers)this._layers[u].setEventedParent(null);for(const u in this._sourceCaches)this._sourceCaches[u].clearTiles(),this._sourceCaches[u].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(u){const p=this._getSourceCaches(u);for(const _ of p)_.clearTiles()}_reloadSource(u){const p=this._getSourceCaches(u);for(const _ of p)_.resume(),_.reload()}_reloadSources(){for(const u of this._getSources())u.reload&&u.reload()}_updateSources(u){for(const p in this._sourceCaches)this._sourceCaches[p].update(u)}_generateCollisionBoxes(){for(const u in this._sourceCaches){const p=this._sourceCaches[u];p.resume(),p.reload()}}_updatePlacement(u,p,_,S,E=!1){let O=!1,I=!1;const N={};for(const G of this._order){const V=this._layers[G];if(V.type!=="symbol")continue;if(!N[V.source]){const ie=this._getLayerSourceCache(V);if(!ie)continue;N[V.source]=ie.getRenderableIds(!0).map(ae=>ie.getTileByID(ae)).sort((ae,ce)=>ce.tileID.overscaledZ-ae.tileID.overscaledZ||(ae.tileID.isLessThan(ce.tileID)?-1:1))}const X=this.crossTileSymbolIndex.addLayer(V,N[V.source],u.center.lng,u.projection);O=O||X}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),E=E||this._layerOrderChanged||_===0,this._layerOrderChanged&&this.fire(new s.Event("neworder")),(E||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(s.exported.now(),u.zoom))&&(this.pauseablePlacement=new Wm(u,this._order,E,p,_,S,this.placement,this.fog&&u.projection.supportsFog?this.fog.state:null),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,N),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(s.exported.now()),I=!0),O&&this.pauseablePlacement.placement.setStale()),I||O)for(const G of this._order){const V=this._layers[G];V.type==="symbol"&&this.placement.updateLayerOpacities(V,N[V.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(s.exported.now())}_releaseSymbolFadeTiles(){for(const u in this._sourceCaches)this._sourceCaches[u].releaseSymbolFadeTiles()}getImages(u,p,_){this.imageManager.getImages(p.icons,_),this._updateTilesForChangedImages();const S=E=>{E&&E.setDependencies(p.tileID.key,p.type,p.icons)};S(this._otherSourceCaches[p.source]),S(this._symbolSourceCaches[p.source])}getGlyphs(u,p,_){this.glyphManager.getGlyphs(p.stacks,_)}getResource(u,p,_){return s.makeRequest(p,_)}_getSourceCache(u){return this._otherSourceCaches[u]}_getLayerSourceCache(u){return u.type==="symbol"?this._symbolSourceCaches[u.source]:this._otherSourceCaches[u.source]}_getSourceCaches(u){const p=[];return this._otherSourceCaches[u]&&p.push(this._otherSourceCaches[u]),this._symbolSourceCaches[u]&&p.push(this._symbolSourceCaches[u]),p}_isSourceCacheLoaded(u){const p=this._getSourceCaches(u);return p.length===0?(this.fire(new s.ErrorEvent(new Error(`There is no source with ID '${u}'`))),!1):p.every(_=>_.loaded())}has3DLayers(){return this._num3DLayers>0}hasSymbolLayers(){return this._numSymbolLayers>0}hasCircleLayers(){return this._numCircleLayers>0}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}Rs.getSourceType=function(g){return sr[g]},Rs.setSourceType=function(g,u){sr[g]=u},Rs.registerForPluginStateChange=s.registerForPluginStateChange;var Zm=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#define EXTENT 8192.0
#define HALF_PI PI/2.0
#define QUARTER_PI PI/4.0
#define RAD_TO_DEG 180.0/PI
#define DEG_TO_RAD PI/180.0
#define GLOBE_RADIUS EXTENT/PI/2.0`,Rl="attribute highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;varying highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",ca=`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
const float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)
{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}
#ifdef TERRAIN
#ifdef TERRAIN_DEM_FLOAT_FORMAT
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;
#else
uniform sampler2D u_dem;uniform sampler2D u_dem_prev;
#endif
uniform vec4 u_dem_unpack;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float decodeElevation(vec4 v) {return dot(vec4(v.xyz*255.0,-1.0),u_dem_unpack);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem,pos).a;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem,pos));
#ifdef TERRAIN_DEM_NEAREST_FILTER
return u_exaggeration*tl;
#endif
float tr=decodeElevation(texture2D(u_dem,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem_prev,pos).a;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem_prev,pos));float tr=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem_prev,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
return currentElevation(apos);}
#endif
highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture2D(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(
unpack_depth(texture2D(u_depth,uv-df.xz)),unpack_depth(texture2D(u_depth,uv+df.xz)),unpack_depth(texture2D(u_depth,uv-df.zy)),unpack_depth(texture2D(u_depth,uv+df.zy))
);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
float tl=texture2D(u_dem,pos).a;float tr=texture2D(u_dem,pos+vec2(off.x,0.0)).a;float bl=texture2D(u_dem,pos+vec2(0.0,off.y)).a;float br=texture2D(u_dem,pos+off).a;
#else
vec4 demtl=vec4(texture2D(u_dem,pos).xyz*255.0,-1.0);float tl=dot(demtl,u_dem_unpack);vec4 demtr=vec4(texture2D(u_dem,pos+vec2(off.x,0.0)).xyz*255.0,-1.0);float tr=dot(demtr,u_dem_unpack);vec4 dembl=vec4(texture2D(u_dem,pos+vec2(0.0,off.y)).xyz*255.0,-1.0);float bl=dot(dembl,u_dem_unpack);vec4 dembr=vec4(texture2D(u_dem,pos+off).xyz*255.0,-1.0);float br=dot(dembr,u_dem_unpack);
#endif
return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }
#endif`,nh=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;varying vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,ua=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump float u_fog_temporal_offset;varying vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,opacity);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec3 fog_dither(vec3 color) {vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`;let Fd={},Oc={};const ih=[];Mc(Zm,ih),Mc(ca,ih),Mc(nh,ih),Mc(ua,ih),Fd=Nr("",ca),Oc=Nr(ua,nh);const Y_=Nr(`
#if __VERSION__ >=300
#define varying in
#define gl_FragColor glFragColor
#define texture2D texture
#define textureCube texture
out vec4 glFragColor;
#endif
highp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}`,`
#if __VERSION__ >=300
#define attribute in
#define varying out
#define texture2D texture
#endif
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#ifndef PROJECTED_POS_ON_VIEWPORT
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);//Normalized device coordinate that is not rendered.`),Ud=Zm,Xm=`
#ifdef GL_ES
precision mediump float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`;var Ym={background:Nr(`uniform vec4 u_color;uniform float u_opacity;
#ifdef LIGHTING_3D_MODE
varying vec4 v_color;
#endif
void main() {vec4 out_color;
#ifdef LIGHTING_3D_MODE
out_color=v_color;
#else
out_color=u_color;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#ifdef LIGHTING_3D_MODE
uniform vec4 u_color;varying vec4 v_color;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting(u_color);
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:Nr(`uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos;void main() {vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),circle:Nr(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
gl_FragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
#ifdef PROJECTION_GLOBE_VIEW
return u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );
#else
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#endif
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);
#else 
surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);
#endif
vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;
#else
occlusion_world_center=world_center;occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
#ifdef PROJECTION_GLOBE_VIEW
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:Nr("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Nr(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
if (u_is_globe==0) {gl_FragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#else
pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:Nr(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:Nr("varying float v_placed;varying float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);gl_FragColor =mix(red,blue,step(0.5,v_placed))*0.5;gl_FragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`attribute vec3 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;attribute float a_size_scale;attribute vec2 a_padding;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*elevation(a_anchor_pos),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:Nr("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}",`attribute vec2 a_pos_2f;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:Nr("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}",`attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;
#endif
varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);
#else
gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);
#endif
}`),fill:Nr(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutline:Nr(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:Nr(`uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;varying vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;varying vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:Nr(`uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:Nr(`varying vec4 v_color;
#ifdef RENDER_SHADOWS
varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef ZERO_ROOF_RADIUS
varying vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
varying highp vec3 v_normal;
#endif
void main() {
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
vec3 normal=v_normal;
#endif
float z;vec4 color;
#ifdef ZERO_ROOF_RADIUS
z=float(normal.z > 0.00001);color=mix(v_color,v_roof_color,z);
#else
color=v_color;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;
#ifdef ZERO_ROOF_RADIUS
concave*=(1.0-z);
#endif
float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);color.rgb=color.rgb*shade;
#endif
#ifdef RENDER_SHADOWS
#ifdef ZERO_ROOF_RADIUS
normal=mix(normal,vec3(0.0,0.0,1.0),z);
#endif
color.xyz=shadowed_color_normal(color.xyz,normalize(normal),v_pos_light_view_0,v_pos_light_view_1,v_depth);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
varying vec4 v_color;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;
#endif
#ifdef ZERO_ROOF_RADIUS
varying vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
varying highp vec3 v_normal;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
v_normal=normal;
#endif
base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=0.0;float c_ele;vec3 pos;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);pos=vec3(pos_nx.xy,h);
#else
h=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);
#ifdef RENDER_SHADOWS
v_pos_light_view_0=u_light_matrix_0*vec4(pos,1);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1);v_depth=gl_Position.w;
#endif
float NdotL=0.0;float colorvalue=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}v_color=vec4(0.0,0.0,0.0,1.0);
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting(color,NdotL);
#else
v_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));
#endif
v_color*=u_opacity;
#ifdef ZERO_ROOF_RADIUS
v_roof_color=vec4(0.0,0.0,0.0,1.0);
#ifdef LIGHTING_3D_MODE
v_roof_color=apply_lighting(color,calculate_NdotL(vec3(0.0,0.0,1.0)));
#else
float roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));
#endif
v_roof_color*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),fillExtrusionPattern:Nr(`uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
varying float v_NdotL;
#endif
varying vec2 v_pos;varying vec4 v_lighting;uniform lowp float u_opacity;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color,v_NdotL)*u_opacity;
#else
out_color=out_color*v_lighting;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
varying vec2 v_pos;varying vec4 v_lighting;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
varying float v_NdotL;
#endif
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=z;vec3 p;float c_ele;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);p=vec3(pos_nx.xy,h);
#else
p=vec3(pos_nx.xy,z);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_NdotL=NdotL;
#else
v_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#endif 
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),hillshadePrepare:Nr(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
return texture2D(u_image,coord).a/4.0;
#else
vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;
#endif
}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Nr(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef LIGHTING_3D_MODE
gl_FragColor=apply_lighting(gl_FragColor);
#endif
#ifdef FOG
gl_FragColor=fog_dither(fog_apply_premultiplied(gl_FragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:Nr(`uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;varying vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;
#endif
uniform float u_border_width;uniform vec4 u_border_color;float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
float linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist=texture2D(u_dash_image,v_tex).a;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;alpha*=linearstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);
#endif
highp vec4 out_color;
#ifdef RENDER_LINE_GRADIENT
out_color=texture2D(u_gradient_image,v_uv.xy);
#else
out_color=color;
#endif
float trimmed=1.0;
#ifdef RENDER_LINE_TRIM_OFFSET
highp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {out_color=vec4(0,0,0,0);trimmed=0.0;}}
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef RENDER_LINE_ALPHA_DISCARD
if (alpha < u_alpha_discard_threshold) {discard;}
#endif
#ifdef RENDER_LINE_BORDER
float edgeBlur=(u_border_width+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);
#ifdef RENDER_LINE_BORDER_AUTO
float Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}
#else
out_color.rgb=mix(u_border_color.rgb*u_border_color.a*trimmed,out_color.rgb,smoothAlpha);
#endif
}
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define EXTRUDE_SCALE 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
attribute highp vec4 a_packed;
#endif
#ifdef RENDER_LINE_DASH
attribute float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;varying vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
float a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];
#ifdef RENDER_LINE_GRADIENT
highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);
#else
v_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);
#endif
#endif
#ifdef RENDER_LINE_DASH
float scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/floorwidth,(-normal.y*height+dash.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),linePattern:Nr(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;vec2 pattern_size=vec2(display_size.x/u_tile_units_to_pixels,display_size.y);float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x=mod(v_linesofar/pattern_size.x*aspect,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));vec4 color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
color=apply_lighting(color);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),raster:Nr(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply(out_color,v_fog_pos));
#endif
gl_FragColor=vec4(out_color*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {float w=1.0+dot(a_texture_pos,u_perspective_transform);gl_Position=u_matrix*vec4(a_pos*w,0,w);v_pos0=a_texture_pos/8192.0;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),symbolIcon:Nr(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform vec3 u_up_vector;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjected_point;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetProjected_point=u_matrix*vec4(a_globe_anchor+displacement,1);
#else
offsetProjected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);
#endif
vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetProjected_point.xy/offsetProjected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;}`),symbolSDF:Nr(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);
#else
offsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);
#endif
vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float gamma_scale=gl_Position.w;float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade);}`),symbolTextAndIcon:Nr(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offset_projected_point=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offset_projected_point.xy/offset_projected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*font_scale);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade,is_sdf);}`),terrainRaster:Nr(`uniform sampler2D u_image0;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;
#endif
void main() {vec4 color=texture2D(u_image0,v_pos0);
#ifdef RENDER_SHADOWS
color.xyz=shadowed_color(color.xyz,v_pos_light_view_0,v_pos_light_view_1,v_depth);
#endif
#ifdef FOG
#ifdef ZERO_EXAGGERATION
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#else
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
#endif
gl_FragColor=color;
#ifdef TERRAIN_WIREFRAME
gl_FragColor=vec4(1.0,0.0,0.0,0.8);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_skirt_height;attribute vec2 a_pos;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;
#endif
const float wireframeOffset=0.00015;void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;
#ifdef TERRAIN_WIREFRAME
elevation+=wireframeOffset;
#endif
v_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
#ifdef ZERO_EXAGGERATION
v_fog_pos=fog_position(decodedPos);
#else
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
#endif
#ifdef RENDER_SHADOWS
vec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);v_depth=gl_Position.w;
#endif
}`),terrainDepth:Nr(`#ifdef GL_ES
precision highp float;
#endif
varying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}`,"uniform mat4 u_matrix;attribute vec2 a_pos;varying float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}"),skybox:Nr(`
varying lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=textureCube(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);gl_FragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Rl),skyboxGradient:Nr(`varying highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture2D(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Rl),skyboxCapture:Nr(`
varying highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;
#ifdef GL_ES
precision highp float;
#endif
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;gl_FragColor=vec4(color,1.0);}`,"attribute highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;varying highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:Nr(`uniform sampler2D u_image0;varying vec2 v_pos0;
#ifndef FOG
uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;
#endif
void main() {vec4 color;
#ifdef CUSTOM_ANTIALIASING
vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture2D(u_image0,v_pos0);color=vec4(raster.rgb*antialias,raster.a*antialias);
#else
color=texture2D(u_image0,v_pos0);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color;
#ifdef TERRAIN_WIREFRAME
gl_FragColor=vec4(1.0,0.0,0.0,0.8);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;
#ifdef GLOBE_POLES
attribute vec3 a_globe_pos;attribute vec2 a_uv;
#else
attribute vec2 a_pos;
#endif
varying vec2 v_pos0;const float wireframeOffset=1e3;float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(QUARTER_PI+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}void main() {
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;vec2 uv=a_uv;
#else
float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);
#endif
v_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;
#ifdef GLOBE_POLES
vec3 up_vector=globe_derived_up_vector;
#else
vec3 up_vector=elevationVector(tile_pos);
#endif
float height=elevation(tile_pos);
#ifdef TERRAIN_WIREFRAME
height+=wireframeOffset;
#endif
globe_pos+=up_vector*height;
#ifndef GLOBE_POLES
globe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;
#endif
#ifdef GLOBE_POLES
vec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);
#else
vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);
#endif
gl_Position=u_proj_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
}`),globeAtmosphere:Nr(`uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec3 u_start_color;uniform vec4 u_color;uniform vec4 u_space_color;uniform vec4 u_high_color;uniform float u_star_intensity;uniform float u_star_size;uniform float u_star_density;uniform float u_horizon_angle;uniform mat4 u_rotation_matrix;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;highp float random(highp vec3 p) {p=fract(p*vec3(23.2342,97.1231,91.2342));p+=dot(p.zxy,p.yxz+123.1234);return fract(p.x*p.y);}float stars(vec3 p,float scale,vec2 offset) {vec2 uv_scale=(u_viewport/u_star_size)*scale;vec3 position=vec3(p.xy*uv_scale+offset*u_viewport,p.z);vec3 q=fract(position)-0.5;vec3 id=floor(position);float random_visibility=step(random(id),u_star_density);float circle=smoothstep(0.5+u_star_intensity,0.5,length(q));return circle*random_visibility;}void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;
#ifdef PROJECTION_GLOBE_VIEW
globe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {discard;return;}
#endif
highp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?
0.0 : max(acos(dot(dir,horizon_dir)),0.0);float horizon_angle;
#ifdef PROJECTION_GLOBE_VIEW
highp vec3 closest_point=globe_pos_dot_dir*dir;float closest_point_to_center=length(closest_point-u_globe_pos);float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?
PI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);
#else
horizon_angle=horizon_angle_mercator;
#endif
horizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c =mix(color_stop_2,c2,t);float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);vec2 uv=gl_FragCoord.xy/u_viewport-0.5;float aspect_ratio=u_viewport.x/u_viewport.y;vec4 uv_dir=vec4(normalize(vec3(uv.x*aspect_ratio,uv.y,1.0)),1.0);uv_dir=u_rotation_matrix*uv_dir;vec3 n=abs(uv_dir.xyz);vec2 uv_remap=(n.x > n.y && n.x > n.z) ? uv_dir.yz/uv_dir.x:
(n.y > n.x && n.y > n.z) ? uv_dir.zx/uv_dir.y:
uv_dir.xy/uv_dir.z;uv_remap.x/=aspect_ratio;vec3 D=vec3(uv_remap,1.0);highp float star_field=0.0;if (u_star_intensity > 0.0) {star_field+=stars(D,1.2,vec2(0.0,0.0));star_field+=stars(D,1.0,vec2(1.0,0.0));star_field+=stars(D,0.8,vec2(0.0,1.0));star_field+=stars(D,0.6,vec2(1.0,1.0));star_field*=(1.0-pow(t,0.25+(1.0-u_high_color.a)*0.75));c+=star_field*alpha_2;}c=dither(c,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=vec4(c,a);}`,`attribute vec3 a_pos;attribute vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(
mix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}`)};function Mc(g,u){const p=g.replace(/\s*\/\/[^\n]*\n/g,`
`).split(`
`);for(let _ of p)if(_=_.trim(),_[0]==="#"&&_.includes("if")&&!_.includes("endif")){_=_.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const S=_.split(" ");for(const E of S)u.includes(E)||u.push(E)}}function Nr(g,u){const p=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,_=u.match(/attribute (highp |mediump |lowp )?([\w]+) ([\w]+)/g),S={},E=[...ih];return Mc(g,E),Mc(u,E),{fragmentSource:g=g.replace(p,(O,I,N,G,V)=>(S[V]=!0,I==="define"?`
#ifndef HAS_UNIFORM_u_${V}
varying ${N} ${G} ${V};
#else
uniform ${N} ${G} u_${V};
#endif
`:`
#ifdef HAS_UNIFORM_u_${V}
    ${N} ${G} ${V} = u_${V};
#endif
`)),vertexSource:u=u.replace(p,(O,I,N,G,V)=>{const X=G==="float"?"vec2":"vec4",ie=V.match(/color/)?"color":X;return S[V]?I==="define"?`
#ifndef HAS_UNIFORM_u_${V}
uniform lowp float u_${V}_t;
attribute ${N} ${X} a_${V};
varying ${N} ${G} ${V};
#else
uniform ${N} ${G} u_${V};
#endif
`:ie==="vec4"?`
#ifndef HAS_UNIFORM_u_${V}
    ${V} = a_${V};
#else
    ${N} ${G} ${V} = u_${V};
#endif
`:`
#ifndef HAS_UNIFORM_u_${V}
    ${V} = unpack_mix_${ie}(a_${V}, u_${V}_t);
#else
    ${N} ${G} ${V} = u_${V};
#endif
`:I==="define"?`
#ifndef HAS_UNIFORM_u_${V}
uniform lowp float u_${V}_t;
attribute ${N} ${X} a_${V};
#else
uniform ${N} ${G} u_${V};
#endif
`:ie==="vec4"?`
#ifndef HAS_UNIFORM_u_${V}
    ${N} ${G} ${V} = a_${V};
#else
    ${N} ${G} ${V} = u_${V};
#endif
`:`
#ifndef HAS_UNIFORM_u_${V}
    ${N} ${G} ${V} = unpack_mix_${ie}(a_${V}, u_${V}_t);
#else
    ${N} ${G} ${V} = u_${V};
#endif
`}),staticAttributes:_,usedDefines:E}}class BS{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(u,p,_,S,E,O,I){this.context=u;let N=this.boundPaintVertexBuffers.length!==S.length;for(let V=0;!N&&V<S.length;V++)this.boundPaintVertexBuffers[V]!==S[V]&&(N=!0);let G=this.boundDynamicVertexBuffers.length!==I.length;for(let V=0;!G&&V<I.length;V++)this.boundDynamicVertexBuffers[V]!==I[V]&&(G=!0);if(!u.extVertexArrayObject||!this.vao||this.boundProgram!==p||this.boundLayoutVertexBuffer!==_||N||G||this.boundIndexBuffer!==E||this.boundVertexOffset!==O)this.freshBind(p,_,S,E,O,I);else{u.bindVertexArrayOES.set(this.vao);for(const V of I)V&&V.bind();E&&E.dynamicDraw&&E.bind()}}freshBind(u,p,_,S,E,O){let I;const N=u.numAttributes,G=this.context,V=G.gl;if(G.extVertexArrayObject)this.vao&&this.destroy(),this.vao=G.extVertexArrayObject.createVertexArrayOES(),G.bindVertexArrayOES.set(this.vao),I=0,this.boundProgram=u,this.boundLayoutVertexBuffer=p,this.boundPaintVertexBuffers=_,this.boundIndexBuffer=S,this.boundVertexOffset=E,this.boundDynamicVertexBuffers=O;else{I=G.currentNumAttributes||0;for(let X=N;X<I;X++)V.disableVertexAttribArray(X)}p.enableAttributes(V,u),p.bind(),p.setVertexAttribPointers(V,u,E);for(const X of _)X.enableAttributes(V,u),X.bind(),X.setVertexAttribPointers(V,u,E);for(const X of O)X&&(X.enableAttributes(V,u),X.bind(),X.setVertexAttribPointers(V,u,E));S&&S.bind(),G.currentNumAttributes=N}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function Jm(g,u){const p=Math.pow(2,u.canonical.z),_=u.canonical.y;return[new s.MercatorCoordinate(0,_/p).toLngLat().lat,new s.MercatorCoordinate(0,(_+1)/p).toLngLat().lat]}function J_(g,u,p,_,S,E,O){const I=g.context,N=I.gl,G=p.fbo;if(!G)return;g.prepareDrawTile();const V=g.useProgram("hillshade");I.activeTexture.set(N.TEXTURE0),N.bindTexture(N.TEXTURE_2D,G.colorAttachment.get());const X=((le,he,J,se)=>{const me=J.paint.get("hillshade-shadow-color"),ge=J.paint.get("hillshade-highlight-color"),Te=J.paint.get("hillshade-accent-color");let Pe=J.paint.get("hillshade-illumination-direction")*(Math.PI/180);J.paint.get("hillshade-illumination-anchor")==="viewport"&&(Pe-=le.transform.angle);const Ae=!le.options.moving;return{u_matrix:se||le.transform.calculateProjMatrix(he.tileID.toUnwrapped(),Ae),u_image:0,u_latrange:Jm(0,he.tileID),u_light:[J.paint.get("hillshade-exaggeration"),Pe],u_shadow:me,u_highlight:ge,u_accent:Te}})(g,p,_,g.terrain?u.projMatrix:null);g.prepareDrawProgram(I,V,u.toUnwrapped());const{tileBoundsBuffer:ie,tileBoundsIndexBuffer:ae,tileBoundsSegments:ce}=g.getTileBoundsBuffers(p);V.draw(I,N.TRIANGLES,S,E,O,s.CullFaceMode.disabled,X,_.id,ie,ae,ce)}function Qm(g,u,p){if(!u.needsDEMTextureUpload)return;const _=g.context,S=_.gl;_.pixelStoreUnpackPremultiplyAlpha.set(!1),u.demTexture=u.demTexture||g.getTileTexture(p.stride);const E=p.getPixels();u.demTexture?u.demTexture.update(E,{premultiply:!1}):u.demTexture=new s.Texture(_,E,S.RGBA,{premultiply:!1}),u.needsDEMTextureUpload=!1}function Q_(g,u,p,_,S,E){const O=g.context,I=O.gl;if(!u.dem)return;const N=u.dem;if(O.activeTexture.set(I.TEXTURE1),Qm(g,u,N),!u.demTexture)return;u.demTexture.bind(I.NEAREST,I.CLAMP_TO_EDGE);const G=N.dim;O.activeTexture.set(I.TEXTURE0);let V=u.fbo;if(!V){const ce=new s.Texture(O,{width:G,height:G,data:null},I.RGBA);ce.bind(I.LINEAR,I.CLAMP_TO_EDGE),V=u.fbo=O.createFramebuffer(G,G,!0),V.colorAttachment.set(ce.texture)}O.bindFramebuffer.set(V.framebuffer),O.viewport.set([0,0,G,G]);const{tileBoundsBuffer:X,tileBoundsIndexBuffer:ie,tileBoundsSegments:ae}=g.getMercatorTileBoundsBuffers();g.useProgram("hillshadePrepare").draw(O,I.TRIANGLES,_,S,E,s.CullFaceMode.disabled,((ce,le)=>{const he=le.stride,J=s.create();return s.ortho(J,0,s.EXTENT,-s.EXTENT,0,0,1),s.translate(J,J,[0,-s.EXTENT,0]),{u_matrix:J,u_image:1,u_dimension:[he,he],u_zoom:ce.overscaledZ,u_unpack:le.unpackVector}})(u.tileID,N),p.id,X,ie,ae),u.needsHillshadePrepare=!1}const eg=g=>({u_matrix:new s.UniformMatrix4f(g),u_image0:new s.Uniform1i(g),u_skirt_height:new s.Uniform1f(g)}),Ic=(g,u)=>({u_matrix:g,u_image0:0,u_skirt_height:u}),Vd=(g,u,p,_,S,E,O,I,N,G,V,X,ie,ae,ce)=>({u_proj_matrix:Float32Array.from(g),u_globe_matrix:u,u_normalize_matrix:Float32Array.from(_),u_merc_matrix:p,u_zoom_transition:S,u_merc_center:E,u_image0:0,u_frustum_tl:O,u_frustum_tr:I,u_frustum_br:N,u_frustum_bl:G,u_globe_pos:V,u_globe_radius:X,u_viewport:ie,u_grid_matrix:ce?Float32Array.from(ce):new Float32Array(9),u_skirt_height:ae});function Rc(g,u){return g!=null&&u!=null&&!(!g.hasData()||!u.hasData())&&g.demTexture!=null&&u.demTexture!=null&&g.tileID.key!==u.tileID.key}const ha=new class{constructor(){this.operations={}}newMorphing(g,u,p,_,S){if(g in this.operations){const E=this.operations[g];E.to.tileID.key!==p.tileID.key&&(E.queued=p)}else this.operations[g]={startTime:_,phase:0,duration:S,from:u,to:p,queued:null}}getMorphValuesForProxy(g){if(!(g in this.operations))return null;const u=this.operations[g];return{from:u.from,to:u.to,phase:u.phase}}update(g){for(const u in this.operations){const p=this.operations[u];for(p.phase=(g-p.startTime)/p.duration;p.phase>=1||!this._validOp(p);)if(!this._nextOp(p,g)){delete this.operations[u];break}}}_nextOp(g,u){return!!g.queued&&(g.from=g.to,g.to=g.queued,g.queued=null,g.phase=0,g.startTime=u,!0)}_validOp(g){return g.from.hasData()&&g.to.hasData()}},Dl={0:null,1:"TERRAIN_VERTEX_MORPHING",2:"TERRAIN_WIREFRAME"};function Gd(g){return 6*Math.pow(1.5,22-g)}function e0(g,u){const p=1<<g.z;return!u&&(g.x===0||g.x===p-1)||g.y===0||g.y===p-1}const oh=g=>({u_matrix:g});function tg(g,u,p,_,S){if(S>0){const E=s.exported.now(),O=(E-g.timeAdded)/S,I=u?(E-u.timeAdded)/S:-1,N=p.getSource(),G=_.coveringZoomLevel({tileSize:N.tileSize,roundZoom:N.roundZoom}),V=!u||Math.abs(u.tileID.overscaledZ-G)>Math.abs(g.tileID.overscaledZ-G),X=V&&g.refreshedUponExpiration?1:s.clamp(V?O:1-I,0,1);return g.refreshedUponExpiration&&O>=1&&(g.refreshedUponExpiration=!1),u?{opacity:1,mix:1-X}:{opacity:X,mix:0}}return{opacity:1,mix:0}}class rg extends s.SourceCache{constructor(u){const p={type:"raster-dem",maxzoom:u.transform.maxZoom},_=new ht(Ya(),null),S=gr("mock-dem",p,_,u.style);super("mock-dem",S,!1),S.setEventedParent(this),this._sourceLoaded=!0}_loadTile(u,p){u.state="loaded",p(null)}}class Wd extends s.SourceCache{constructor(u){const p=gr("proxy",{type:"geojson",maxzoom:u.transform.maxZoom},new ht(Ya(),null),u.style);super("proxy",p,!1),p.setEventedParent(this),this.map=this.getSource().map=u,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(u,p,_){if(u.freezeTileCoverage)return;this.transform=u;const S=u.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((E,O)=>{if(E[O.key]="",!this._tiles[O.key]){const I=new s.Tile(O,this._source.tileSize*O.overscaleFactor(),u.tileZoom);I.state="loaded",this._tiles[O.key]=I}return E},{});for(const E in this._tiles)E in S||(this.freeFBO(E),this._tiles[E].unloadVectorData(),delete this._tiles[E])}freeFBO(u){const p=this.proxyCachedFBO[u];if(p!==void 0){const _=Object.values(p);this.renderCachePool.push(..._),delete this.proxyCachedFBO[u]}}deallocRenderCache(){this.renderCache.forEach(u=>u.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class qd extends s.OverscaledTileID{constructor(u,p,_){super(u.overscaledZ,u.wrap,u.canonical.z,u.canonical.x,u.canonical.y),this.proxyTileKey=p,this.projMatrix=_}}class ng extends s.Elevation{constructor(u,p){super(),this.painter=u,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[_,S,E]=function(N){const G=new s.StructArrayLayout2i4,V=new s.StructArrayLayout3ui6,X=131;G.reserve(17161),V.reserve(33800);const ie=s.EXTENT/128,ae=s.EXTENT+ie/2,ce=ae+ie;for(let he=-ie;he<ce;he+=ie)for(let J=-ie;J<ce;J+=ie){const se=J<0||J>ae||he<0||he>ae?24575:0,me=s.clamp(Math.round(J),0,s.EXTENT),ge=s.clamp(Math.round(he),0,s.EXTENT);G.emplaceBack(me+se,ge)}const le=(he,J)=>{const se=J*X+he;V.emplaceBack(se+1,se,se+X),V.emplaceBack(se+X,se+X+1,se+1)};for(let he=1;he<129;he++)for(let J=1;J<129;J++)le(J,he);return[0,129].forEach(he=>{for(let J=0;J<130;J++)le(J,he),le(he,J)}),[G,V,32768]}(),O=u.context;this.gridBuffer=O.createVertexBuffer(_,s.posAttributes.members),this.gridIndexBuffer=O.createIndexBuffer(S),this.gridSegments=s.SegmentVector.simpleSegment(0,0,_.length,S.length),this.gridNoSkirtSegments=s.SegmentVector.simpleSegment(0,0,_.length,E),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new Wd(p.map),this.orthoMatrix=s.create(),s.ortho(this.orthoMatrix,this.painter.transform.projection.name==="globe"?.015:0,s.EXTENT,0,s.EXTENT,0,1);const I=O.gl;this._overlapStencilMode=new s.StencilMode({func:I.GEQUAL,mask:255},0,255,I.KEEP,I.KEEP,I.REPLACE),this._previousZoom=u.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=p,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new rg(p.map)}set style(u){u.on("data",this._onStyleDataEvent.bind(this)),u.on("neworder",this._checkRenderCacheEfficiency.bind(this)),this._style=u,this._checkRenderCacheEfficiency(),this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(u,p,_){if(u&&u.terrain){this._style!==u&&(this.style=u),this.enabled=!0;const S=u.terrain.properties;this.sourceCache=u.terrain.drapeRenderMode===0?this._mockSourceCache:u._getSourceCache(S.get("source")),this._exaggeration=S.get("exaggeration");const E=()=>{this.sourceCache.used&&s.warnOnce(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const O=this.getScaledDemTileSize();this.sourceCache.update(p,O,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,E(),this._initializing=!0),E(),p.updateElevation(!0,_),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(p),this._emptyDEMTextureDirty=!0}else this._disable()}resetTileLookupCache(u){this._findCoveringTileCache[u]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_checkRenderCacheEfficiency(){const u=this.renderCacheEfficiency(this._style);this._style.map._optimizeForTerrain||u.efficiency!==100&&s.warnOnce(`Terrain render cache efficiency is not optimal (${u.efficiency}%) and performance
                may be affected negatively, consider placing all background, fill and line layers before layer
                with id '${u.firstUndrapedLayer}' or create a map using optimizeForTerrain: true option.`)}_onStyleDataEvent(u){u.coord&&u.dataType==="source"?this._clearRenderCacheForTile(u.sourceCacheId,u.coord):u.dataType==="style"&&(this._invalidateRenderCache=!0)}_disable(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const u in this._style._sourceCaches)this._style._sourceCaches[u].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this._emptyDepthBufferTexture&&this._emptyDepthBufferTexture.destroy(),this.pool.forEach(u=>u.fb.destroy()),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0)}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const u=2*this.proxySourceCache.getSource().tileSize;return[u,u]}set useVertexMorphing(u){this._useVertexMorphing=u}updateTileBinding(u){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const p=this.proxySourceCache,_=this.painter.transform;this._initializing&&(this._initializing=_._centerAltitude===0&&this.getAtPointOrZero(s.MercatorCoordinate.fromLngLat(_.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);const S=this.proxyCoords=p.getIds().map(N=>{const G=p.getTileByID(N).tileID;return G.projMatrix=_.calculateProjMatrix(G.toUnwrapped()),G});(function(N,G){const V=G.transform.pointCoordinate(G.transform.getCameraPoint()),X=new s.Point(V.x,V.y);N.sort((ie,ae)=>{if(ae.overscaledZ-ie.overscaledZ)return ae.overscaledZ-ie.overscaledZ;const ce=new s.Point(ie.canonical.x+(1<<ie.canonical.z)*ie.wrap,ie.canonical.y),le=new s.Point(ae.canonical.x+(1<<ae.canonical.z)*ae.wrap,ae.canonical.y),he=X.mult(1<<ie.canonical.z);return he.x-=.5,he.y-=.5,he.distSqr(ce)-he.distSqr(le)})})(S,this.painter),this._previousZoom=_.zoom;const E=this.proxyToSource||{};this.proxyToSource={},S.forEach(N=>{this.proxyToSource[N.key]={}}),this.terrainTileForTile={};const O=this._style._sourceCaches;for(const N in O){const G=O[N];if(!G.used||(G!==this.sourceCache&&this.resetTileLookupCache(G.id),this._setupProxiedCoordsForOrtho(G,u[N],E),G.usedForTerrain))continue;const V=u[N];G.getSource().reparseOverscaled&&this._assignTerrainTiles(V)}this.proxiedCoords[p.id]=S.map(N=>new qd(N,N.key,this.orthoMatrix)),this._assignTerrainTiles(S),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(E),this.renderingToTexture=!1,this._updateTimestamp=s.exported.now();const I={};this._visibleDemTiles=[];for(const N of this.proxyCoords){const G=this.terrainTileForTile[N.key];if(!G)continue;const V=G.tileID.key;V in I||(this._visibleDemTiles.push(G),I[V]=V)}}_assignTerrainTiles(u){this._initializing||u.forEach(p=>{if(this.terrainTileForTile[p.key])return;const _=this._findTileCoveringTileID(p,this.sourceCache);_&&(this.terrainTileForTile[p.key]=_)})}_prepareDEMTextures(){const u=this.painter.context,p=u.gl;for(const _ in this.terrainTileForTile){const S=this.terrainTileForTile[_],E=S.dem;!E||S.demTexture&&!S.needsDEMTextureUpload||(u.activeTexture.set(p.TEXTURE1),Qm(this.painter,S,E))}}_prepareDemTileUniforms(u,p,_,S){if(!p||p.demTexture==null)return!1;const E=u.tileID.canonical,O=Math.pow(2,p.tileID.canonical.z-E.z),I=S||"";return _[`u_dem_tl${I}`]=[E.x*O%1,E.y*O%1],_[`u_dem_scale${I}`]=O,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}get emptyDepthBufferTexture(){const u=this.painter.context,p=u.gl;if(!this._emptyDepthBufferTexture){const _=new s.RGBAImage({width:1,height:1},Uint8Array.of(255,255,255,255));this._emptyDepthBufferTexture=new s.Texture(u,_,p.RGBA,{premultiply:!1})}return this._emptyDepthBufferTexture}_getLoadedAreaMinimum(){let u=0;const p=this._visibleDemTiles.reduce((_,S)=>{if(!S.dem)return _;const E=S.dem.tree.minimums[0];return E>0&&u++,_+E},0);return u?p/u:0}_updateEmptyDEMTexture(){const u=this.painter.context,p=u.gl;u.activeTexture.set(p.TEXTURE2);const _=this._getLoadedAreaMinimum(),S=new s.RGBAImage({width:1,height:1},new Uint8Array(s.DEMData.pack(_,this.sourceCache.getSource().encoding)));this._emptyDEMTextureDirty=!1;let E=this._emptyDEMTexture;return E?E.update(S,{premultiply:!1}):E=this._emptyDEMTexture=new s.Texture(u,S,p.RGBA,{premultiply:!1}),E}setupElevationDraw(u,p,_){const S=this.painter.context,E=S.gl,O=(I=this.sourceCache.getSource().encoding,{u_dem:2,u_dem_prev:4,u_dem_unpack:s.DEMData.getUnpackVector(I),u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0});var I;O.u_dem_size=this.sourceCache.getSource().tileSize,O.u_exaggeration=this.exaggeration();let N=null,G=null,V=1;if(_&&_.morphing&&this._useVertexMorphing){const X=_.morphing.srcDemTile,ie=_.morphing.dstDemTile;V=_.morphing.phase,X&&ie&&(this._prepareDemTileUniforms(u,X,O,"_prev")&&(G=X),this._prepareDemTileUniforms(u,ie,O)&&(N=ie))}if(G&&N?(S.activeTexture.set(E.TEXTURE2),N.demTexture.bind(E.NEAREST,E.CLAMP_TO_EDGE,E.NEAREST),S.activeTexture.set(E.TEXTURE4),G.demTexture.bind(E.NEAREST,E.CLAMP_TO_EDGE,E.NEAREST),O.u_dem_lerp=V):(N=this.terrainTileForTile[u.tileID.key],S.activeTexture.set(E.TEXTURE2),(this._prepareDemTileUniforms(u,N,O)?N.demTexture:this.emptyDEMTexture).bind(E.NEAREST,E.CLAMP_TO_EDGE)),S.activeTexture.set(E.TEXTURE3),_&&_.useDepthForOcclusion?(this._depthTexture&&this._depthTexture.bind(E.NEAREST,E.CLAMP_TO_EDGE),this._depthFBO&&(O.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height])):(this.emptyDepthBufferTexture.bind(E.NEAREST,E.CLAMP_TO_EDGE),O.u_depth_size_inv=[1,1]),_&&_.useMeterToDem&&N){const X=(1<<N.tileID.canonical.z)*s.mercatorZfromAltitude(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;O.u_meter_to_dem=X}if(_&&_.labelPlaneMatrixInv&&(O.u_label_plane_matrix_inv=_.labelPlaneMatrixInv),p.setTerrainUniformValues(S,O),this.painter.transform.projection.name==="globe"){const X=this.globeUniformValues(this.painter.transform,u.tileID.canonical,_&&_.useDenormalizedUpVectorScale);p.setGlobeUniformValues(S,X)}}globeUniformValues(u,p,_){const S=u.projection;return{u_tile_tl_up:S.upVector(p,0,0),u_tile_tr_up:S.upVector(p,s.EXTENT,0),u_tile_br_up:S.upVector(p,s.EXTENT,s.EXTENT),u_tile_bl_up:S.upVector(p,0,s.EXTENT),u_tile_up_scale:_?s.globeMetersToEcef(1):S.upVectorScale(p,u.center.lat,u.worldSize).metersToTile}}renderToBackBuffer(u){const p=this.painter,_=this.painter.context;u.length!==0&&(_.bindFramebuffer.set(null),_.viewport.set([0,0,p.width,p.height]),p.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(S,E,O,I,N){if(S.transform.projection.name==="globe")(function(G,V,X,ie,ae){const ce=G.context,le=ce.gl;let he,J;const se=G.options.showTerrainWireframe?2:0,me=G.transform,ge=s.globeUseCustomAntiAliasing(G,ce,me),Te=(ft,Ue)=>{if(J===ft)return;const nt=[Dl[ft],"PROJECTION_GLOBE_VIEW"];ge&&nt.push("CUSTOM_ANTIALIASING"),Ue&&nt.push(Dl[se]),he=G.useProgram("globeRaster",null,nt),J=ft},Pe=G.colorModeForRenderPass(),Ae=new s.DepthMode(le.LEQUAL,s.DepthMode.ReadWrite,G.depthRangeFor3D);ha.update(ae);const Re=s.calculateGlobeMercatorMatrix(me),Ie=[s.mercatorXfromLng(me.center.lng),s.mercatorYfromLat(me.center.lat)],Ve=se?[!1,!0]:[!1],pt=G.globeSharedBuffers,$e=[me.width*s.exported.devicePixelRatio,me.height*s.exported.devicePixelRatio],it=Float32Array.from(me.globeMatrix),He={useDenormalizedUpVectorScale:!0};if(Ve.forEach(ft=>{const Ue=G.transform,nt=Gd(Ue.zoom)*V.exaggeration();J=-1;const yt=ft?le.LINES:le.TRIANGLES;for(const lt of ie){const vt=X.getTile(lt),Vt=s.StencilMode.disabled,ir=V.prevTerrainTileForTile[lt.key],zt=V.terrainTileForTile[lt.key];Rc(ir,zt)&&ha.newMorphing(lt.key,ir,zt,ae,250),ce.activeTexture.set(le.TEXTURE0),vt.texture.bind(le.LINEAR,le.CLAMP_TO_EDGE);const Yt=ha.getMorphValuesForProxy(lt.key),br=Yt?1:0;Yt&&s.extend$1(He,{morphing:{srcDemTile:Yt.from,dstDemTile:Yt.to,phase:s.easeCubicInOut(Yt.phase)}});const yr=s.tileCornersToBounds(lt.canonical),Nt=s.getLatitudinalLod(yr.getCenter().lat),Fr=s.getGridMatrix(lt.canonical,yr,Nt,Ue.worldSize/Ue._pixelsPerMercatorPixel),Wr=s.globeNormalizeECEF(s.globeTileBounds(lt.canonical)),qr=Vd(Ue.projMatrix,it,Re,Wr,s.globeToMercatorTransition(Ue.zoom),Ie,Ue.frustumCorners.TL,Ue.frustumCorners.TR,Ue.frustumCorners.BR,Ue.frustumCorners.BL,Ue.globeCenterInViewSpace,Ue.globeRadius,$e,nt,Fr);if(Te(br,ft),V.setupElevationDraw(vt,he,He),G.prepareDrawProgram(ce,he,lt.toUnwrapped()),pt){const[Hr,Fi,fi]=ft?pt.getWirefameBuffers(G.context,Nt):pt.getGridBuffers(Nt,nt!==0);he.draw(ce,yt,Ae,Vt,Pe,s.CullFaceMode.backCCW,qr,"globe_raster",Hr,Fi,fi)}}}),pt){const ft=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];ge&&ft.push("CUSTOM_ANTIALIASING"),he=G.useProgram("globeRaster",null,ft);for(const Ue of ie){const{x:nt,y:yt,z:lt}=Ue.canonical,vt=yt===0,Vt=yt===(1<<lt)-1,[ir,zt,Yt,br]=pt.getPoleBuffers(lt);if(br&&(vt||Vt)){const yr=X.getTile(Ue);ce.activeTexture.set(le.TEXTURE0),yr.texture.bind(le.LINEAR,le.CLAMP_TO_EDGE);let Nt=s.globePoleMatrixForTile(lt,nt,me);const Fr=s.globeNormalizeECEF(s.globeTileBounds(Ue.canonical)),Wr=(qr,Hr)=>qr.draw(ce,le.TRIANGLES,Ae,s.StencilMode.disabled,Pe,s.CullFaceMode.disabled,Vd(me.projMatrix,Nt,Nt,Fr,0,Ie,me.frustumCorners.TL,me.frustumCorners.TR,me.frustumCorners.BR,me.frustumCorners.BL,me.globeCenterInViewSpace,me.globeRadius,$e,0),"globe_pole_raster",Hr,Yt,br);V.setupElevationDraw(yr,he,He),G.prepareDrawProgram(ce,he,Ue.toUnwrapped()),vt&&Wr(he,ir),Vt&&(Nt=s.scale(s.create(),Nt,[1,-1,1]),Wr(he,zt))}}}})(S,E,O,I,N);else{const G=S.context,V=G.gl;let X,ie;const ae=S.options.showTerrainWireframe?2:0,ce=(me,ge)=>{if(ie===me)return;const Te=[Dl[me]];ge&&Te.push(Dl[ae]),X=S.useProgram("terrainRaster",null,Te),ie=me},le=S.colorModeForRenderPass(),he=new s.DepthMode(V.LEQUAL,s.DepthMode.ReadWrite,S.depthRangeFor3D);ha.update(N);const J=S.transform,se=Gd(J.zoom)*E.exaggeration();(ae?[!1,!0]:[!1]).forEach(me=>{ie=-1;const ge=me?V.LINES:V.TRIANGLES,[Te,Pe]=me?E.getWirefameBuffer():[E.gridIndexBuffer,E.gridSegments];for(const Ae of I){const Re=O.getTile(Ae),Ie=s.StencilMode.disabled,Ve=E.prevTerrainTileForTile[Ae.key],pt=E.terrainTileForTile[Ae.key];Rc(Ve,pt)&&ha.newMorphing(Ae.key,Ve,pt,N,250),G.activeTexture.set(V.TEXTURE0),Re.texture.bind(V.LINEAR,V.CLAMP_TO_EDGE,V.LINEAR_MIPMAP_NEAREST);const $e=ha.getMorphValuesForProxy(Ae.key),it=$e?1:0;let He;$e&&(He={morphing:{srcDemTile:$e.from,dstDemTile:$e.to,phase:s.easeCubicInOut($e.phase)}});const ft=Ic(Ae.projMatrix,e0(Ae.canonical,J.renderWorldCopies)?se/10:se);ce(it,me),E.setupElevationDraw(Re,X,He),S.prepareDrawProgram(G,X,Ae.toUnwrapped()),X.draw(G,ge,he,Ie,le,s.CullFaceMode.backCCW,ft,"terrain_raster",E.gridBuffer,Te,Pe)}})}}(p,this,this.proxySourceCache,u,this._updateTimestamp),this.renderingToTexture=!0,p.gpuTimingDeferredRenderEnd(),u.splice(0,u.length))}renderBatch(u){if(this._drapedRenderBatches.length===0)return u+1;this.renderingToTexture=!0;const p=this.painter,_=this.painter.context,S=this.proxySourceCache,E=this.proxiedCoords[S.id],O=this._drapedRenderBatches.shift(),I=[],N=p.style.order;let G=0;for(const V of E){const X=S.getTileByID(V.proxyTileKey),ie=S.proxyCachedFBO[V.key]?S.proxyCachedFBO[V.key][u]:void 0,ae=ie!==void 0?S.renderCache[ie]:this.pool[G++],ce=ie!==void 0;if(X.texture=ae.tex,ce&&!ae.dirty){I.push(X.tileID);continue}let le;_.bindFramebuffer.set(ae.fb.framebuffer),this.renderedToTile=!1,ae.dirty&&(_.clear({color:s.Color.transparent,stencil:0}),ae.dirty=!1);for(let he=O.start;he<=O.end;++he){const J=p.style._layers[N[he]];if(J.isHidden(p.transform.zoom))continue;const se=p.style._getLayerSourceCache(J),me=se?this.proxyToSource[V.key][se.id]:[V];if(!me)continue;const ge=me;_.viewport.set([0,0,ae.fb.width,ae.fb.height]),le!==(se?se.id:null)&&(this._setupStencil(ae,me,J,se),le=se?se.id:null),p.renderLayer(p,se,J,ge)}this.renderedToTile?(ae.dirty=!0,I.push(X.tileID)):ce||--G,G===5&&(G=0,this.renderToBackBuffer(I))}return this.renderToBackBuffer(I),this.renderingToTexture=!1,_.bindFramebuffer.set(null),_.viewport.set([0,0,p.width,p.height]),O.end+1}postRender(){}renderCacheEfficiency(u){const p=u.order.length;if(p===0)return{efficiency:100};let _,S=0,E=0,O=!1;for(let I=0;I<p;++I){const N=u._layers[u.order[I]];this._style.isLayerDraped(N)?(O&&++S,++E):O||(O=!0,_=N.id)}return E===0?{efficiency:100}:{efficiency:100*(1-S/E),firstUndrapedLayer:_}}getMinElevationBelowMSL(){let u=0;return this._visibleDemTiles.filter(p=>p.dem).forEach(p=>{u=Math.min(u,p.dem.tree.minimums[0])}),u===0?u:(u-30)*this._exaggeration}raycast(u,p,_){if(!this._visibleDemTiles)return null;const S=this._visibleDemTiles.filter(E=>E.dem).map(E=>{const O=E.tileID,I=1<<O.overscaledZ,{x:N,y:G}=O.canonical,V=N/I,X=(N+1)/I,ie=G/I,ae=(G+1)/I;return{minx:V,miny:ie,maxx:X,maxy:ae,t:E.dem.tree.raycastRoot(V,ie,X,ae,u,p,_),tile:E}});S.sort((E,O)=>(E.t!==null?E.t:Number.MAX_VALUE)-(O.t!==null?O.t:Number.MAX_VALUE));for(const E of S){if(E.t==null)return null;const O=E.tile.dem.tree.raycast(E.minx,E.miny,E.maxx,E.maxy,u,p,_);if(O!=null)return O}return null}_createFBO(){const u=this.painter.context,p=u.gl,_=this.drapeBufferSize;u.activeTexture.set(p.TEXTURE0);const S=new s.Texture(u,{width:_[0],height:_[1],data:null},p.RGBA);S.bind(p.LINEAR,p.CLAMP_TO_EDGE);const E=u.createFramebuffer(_[0],_[1],!1);return E.colorAttachment.set(S.texture),E.depthAttachment=new ke(u,E.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=u.createRenderbuffer(u.gl.DEPTH_STENCIL,_[0],_[1]),this._stencilRef=0,E.depthAttachment.set(this._sharedDepthStencil),u.clear({stencil:0})):E.depthAttachment.set(this._sharedDepthStencil),u.extTextureFilterAnisotropic&&!u.extTextureFilterAnisotropicForceOff&&p.texParameterf(p.TEXTURE_2D,u.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,u.extTextureFilterAnisotropicMax),{fb:E,tex:S,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._style.light&&this._style.light.hasTransition())return!0;for(const u in this._style._sourceCaches)if(this._style._sourceCaches[u].hasTransition())return!0;return this._style.order.some(u=>{const p=this._style._layers[u],_=p.isHidden(this.painter.transform.zoom);return p.type==="custom"?!_&&p.shouldRedrape():!_&&p.hasTransition()})}_clearLineLayersFromRenderCache(){let u=!1;for(const _ of this._style._getSources())if(_ instanceof wt){u=!0;break}if(!u)return;const p={};for(let _=0;_<this._style.order.length;++_){const S=this._style._layers[this._style.order[_]],E=this._style._getLayerSourceCache(S);if(E&&!p[E.id]&&!S.isHidden(this.painter.transform.zoom)&&S.type==="line"&&S.widthExpression()instanceof s.ZoomDependentExpression){p[E.id]=!0;for(const O of this.proxyCoords){const I=this.proxyToSource[O.key][E.id];if(I)for(const N of I)this._clearRenderCacheForTile(E.id,N)}}}}_clearRasterLayersFromRenderCache(){let u=!1;for(const _ in this._style._sourceCaches)if(this._style._sourceCaches[_]._source instanceof gt){u=!0;break}if(!u)return;const p={};for(let _=0;_<this._style.order.length;++_){const S=this._style._layers[this._style.order[_]],E=this._style._getLayerSourceCache(S);if(!E||p[E.id]||S.isHidden(this.painter.transform.zoom)||S.type!=="raster")continue;const O=S.paint.get("raster-fade-duration");for(const I of this.proxyCoords){const N=this.proxyToSource[I.key][E.id];if(N)for(const G of N){const V=tg(E.getTile(G),E.findLoadedParent(G,0),E,this.painter.transform,O);(V.opacity!==1||V.mix!==0)&&this._clearRenderCacheForTile(E.id,G)}}}}_setupDrapedRenderBatches(){const u=this._style.order,p=u.length;if(p===0)return;const _=[];let S,E=0,O=this._style._layers[u[E]];for(;!this._style.isLayerDraped(O)&&O.isHidden(this.painter.transform.zoom)&&++E<p;)O=this._style._layers[u[E]];for(;E<p;++E){const I=this._style._layers[u[E]];I.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(I)?S===void 0&&(S=E):S!==void 0&&(_.push({start:S,end:E-1}),S=void 0))}S!==void 0&&_.push({start:S,end:E-1}),this._drapedRenderBatches=_}_setupRenderCache(u){const p=this.proxySourceCache;if(this._shouldDisableRenderCache()||this._invalidateRenderCache){if(this._invalidateRenderCache=!1,p.renderCache.length>p.renderCachePool.length){const O=Object.values(p.proxyCachedFBO);p.proxyCachedFBO={};for(let I=0;I<O.length;++I){const N=Object.values(O[I]);p.renderCachePool.push(...N)}}return}this._clearRasterLayersFromRenderCache();const _=this.proxyCoords,S=this._tilesDirty;for(let O=_.length-1;O>=0;O--){const I=_[O];if(p.getTileByID(I.key),p.proxyCachedFBO[I.key]!==void 0){const N=u[I.key],G=this.proxyToSource[I.key];let V=0;for(const X in G){const ie=G[X],ae=N[X];if(!ae||ae.length!==ie.length||ie.some((ce,le)=>ce!==ae[le]||S[X]&&S[X].hasOwnProperty(ce.key))){V=-1;break}++V}for(const X in p.proxyCachedFBO[I.key])p.renderCache[p.proxyCachedFBO[I.key][X]].dirty=V<0||V!==Object.values(N).length}}const E=[...this._drapedRenderBatches];E.sort((O,I)=>I.end-I.start-(O.end-O.start));for(const O of E)for(const I of _){if(p.proxyCachedFBO[I.key])continue;let N=p.renderCachePool.pop();N===void 0&&p.renderCache.length<50&&(N=p.renderCache.length,p.renderCache.push(this._createFBO())),N!==void 0&&(p.proxyCachedFBO[I.key]={},p.proxyCachedFBO[I.key][O.start]=N,p.renderCache[N].dirty=!0)}this._tilesDirty={}}_setupStencil(u,p,_,S){if(!S||!this._sourceTilesOverlap[S.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const E=this.painter.context,O=E.gl;if(p.length<=1)return void(this._overlapStencilType=!1);let I;if(_.isTileClipped())I=p.length,this._overlapStencilMode.test={func:O.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(p[0].overscaledZ>p[p.length-1].overscaledZ))return void(this._overlapStencilType=!1);I=1,this._overlapStencilMode.test={func:O.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+I>255&&(E.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=I,this._overlapStencilMode.ref=this._stencilRef,_.isTileClipped()&&this._renderTileClippingMasks(p,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return this._overlapStencilType==="Clip"||this._overlapStencilType==="Mask"}stencilModeForRTTOverlap(u){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[u.key]),this._overlapStencilMode):s.StencilMode.disabled}_renderTileClippingMasks(u,p){const _=this.painter,S=this.painter.context,E=S.gl;_._tileClippingMaskIDs={},S.setColorMode(s.ColorMode.disabled),S.setDepthMode(s.DepthMode.disabled);const O=_.useProgram("clippingMask");for(const I of u){const N=_._tileClippingMaskIDs[I.key]=--p;O.draw(S,E.TRIANGLES,s.DepthMode.disabled,new s.StencilMode({func:E.ALWAYS,mask:0},N,255,E.KEEP,E.KEEP,E.REPLACE),s.ColorMode.disabled,s.CullFaceMode.disabled,oh(I.projMatrix),"$clipping",_.tileExtentBuffer,_.quadTriangleIndexBuffer,_.tileExtentSegments)}}pointCoordinate(u){const p=this.painter.transform;if(u.x<0||u.x>p.width||u.y<0||u.y>p.height)return null;const _=[u.x,u.y,1,1];s.transformMat4$1(_,_,p.pixelMatrixInverse),s.scale$1(_,_,1/_[3]),_[0]/=p.worldSize,_[1]/=p.worldSize;const S=p._camera.position,E=s.mercatorZfromAltitude(1,p.center.lat),O=[S[0],S[1],S[2]/E,0],I=s.subtract([],_.slice(0,3),O);s.normalize(I,I);const N=this.raycast(O,I,this._exaggeration);return N!==null&&N?(s.scaleAndAdd(O,O,I,N),O[3]=O[2],O[2]*=E,O):null}drawDepth(){const u=this.painter,p=u.context,_=this.proxySourceCache,S=Math.ceil(u.width),E=Math.ceil(u.height);if(!this._depthFBO||this._depthFBO.width===S&&this._depthFBO.height===E||(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),!this._depthFBO){const O=p.gl,I=p.createFramebuffer(S,E,!0);p.activeTexture.set(O.TEXTURE0);const N=new s.Texture(p,{width:S,height:E,data:null},O.RGBA);N.bind(O.NEAREST,O.CLAMP_TO_EDGE),I.colorAttachment.set(N.texture);const G=p.createRenderbuffer(p.gl.DEPTH_COMPONENT16,S,E);I.depthAttachment.set(G),this._depthFBO=I,this._depthTexture=N}p.bindFramebuffer.set(this._depthFBO.framebuffer),p.viewport.set([0,0,S,E]),function(O,I,N,G){if(O.transform.projection.name==="globe")return;const V=O.context,X=V.gl;V.clear({depth:1});const ie=O.useProgram("terrainDepth"),ae=new s.DepthMode(X.LESS,s.DepthMode.ReadWrite,O.depthRangeFor3D);for(const ce of G){const le=N.getTile(ce),he=Ic(ce.projMatrix,0);I.setupElevationDraw(le,ie),ie.draw(V,X.TRIANGLES,ae,s.StencilMode.disabled,s.ColorMode.unblended,s.CullFaceMode.backCCW,he,"terrain_depth",I.gridBuffer,I.gridIndexBuffer,I.gridNoSkirtSegments)}}(u,this,_,this.proxyCoords)}_setupProxiedCoordsForOrtho(u,p,_){if(u.getSource()instanceof mr)return this._setupProxiedCoordsForImageSource(u,p,_);this._findCoveringTileCache[u.id]=this._findCoveringTileCache[u.id]||{};const S=this.proxiedCoords[u.id]=[],E=this.proxyCoords;for(let I=0;I<E.length;I++){const N=E[I],G=this._findTileCoveringTileID(N,u);if(G){const V=this._createProxiedId(N,G,_[N.key]&&_[N.key][u.id]);S.push(V),this.proxyToSource[N.key][u.id]=[V]}}let O=!1;for(let I=0;I<p.length;I++){const N=u.getTile(p[I]);if(!N||!N.hasData())continue;const G=this._findTileCoveringTileID(N.tileID,this.proxySourceCache);if(G&&G.tileID.canonical.z!==N.tileID.canonical.z){const V=this.proxyToSource[G.tileID.key][u.id],X=this._createProxiedId(G.tileID,N,_[G.tileID.key]&&_[G.tileID.key][u.id]);V?V.splice(V.length-1,0,X):this.proxyToSource[G.tileID.key][u.id]=[X],S.push(X),O=!0}}this._sourceTilesOverlap[u.id]=O}_setupProxiedCoordsForImageSource(u,p,_){if(!u.getSource().loaded())return;const S=this.proxiedCoords[u.id]=[],E=this.proxyCoords,O=u.getSource(),I=new s.Point(O.tileID.x,O.tileID.y)._div(1<<O.tileID.z),N=O.coordinates.map(s.MercatorCoordinate.fromLngLat).reduce((V,X)=>(V.min.x=Math.min(V.min.x,X.x-I.x),V.min.y=Math.min(V.min.y,X.y-I.y),V.max.x=Math.max(V.max.x,X.x-I.x),V.max.y=Math.max(V.max.y,X.y-I.y),V),{min:new s.Point(Number.MAX_VALUE,Number.MAX_VALUE),max:new s.Point(-Number.MAX_VALUE,-Number.MAX_VALUE)}),G=(V,X)=>{const ie=V.wrap+V.canonical.x/(1<<V.canonical.z),ae=V.canonical.y/(1<<V.canonical.z),ce=s.EXTENT/(1<<V.canonical.z),le=X.wrap+X.canonical.x/(1<<X.canonical.z),he=X.canonical.y/(1<<X.canonical.z);return ie+ce<le+N.min.x||ie>le+N.max.x||ae+ce<he+N.min.y||ae>he+N.max.y};for(let V=0;V<E.length;V++){const X=E[V];for(let ie=0;ie<p.length;ie++){const ae=u.getTile(p[ie]);if(!ae||!ae.hasData()||G(X,ae.tileID))continue;const ce=this._createProxiedId(X,ae,_[X.key]&&_[X.key][u.id]),le=this.proxyToSource[X.key][u.id];le?le.push(ce):this.proxyToSource[X.key][u.id]=[ce],S.push(ce)}}}_createProxiedId(u,p,_){let S=this.orthoMatrix;if(_){const E=_.find(O=>O.key===p.tileID.key);if(E)return E}if(p.tileID.key!==u.key){const E=u.canonical.z-p.tileID.canonical.z;let O,I,N;S=s.create();const G=p.tileID.wrap-u.wrap<<u.overscaledZ;E>0?(O=s.EXTENT>>E,I=O*((p.tileID.canonical.x<<E)-u.canonical.x+G),N=O*((p.tileID.canonical.y<<E)-u.canonical.y)):(O=s.EXTENT<<-E,I=s.EXTENT*(p.tileID.canonical.x-(u.canonical.x+G<<-E)),N=s.EXTENT*(p.tileID.canonical.y-(u.canonical.y<<-E))),s.ortho(S,0,O,0,O,0,1),s.translate(S,S,[I,N,0])}return new qd(p.tileID,u.key,S)}_findTileCoveringTileID(u,p){let _=p.getTile(u);if(_&&_.hasData())return _;const S=this._findCoveringTileCache[p.id],E=S[u.key];if(_=E?p.getTileByID(E):null,_&&_.hasData()||E===null)return _;let O=_?_.tileID:u,I=O.overscaledZ;const N=p.getSource().minzoom,G=[];if(!E){const X=p.getSource().maxzoom;if(u.canonical.z>=X){const ie=u.canonical.z-X;p.getSource().reparseOverscaled?(I=Math.max(u.canonical.z+2,p.transform.tileZoom),O=new s.OverscaledTileID(I,u.wrap,X,u.canonical.x>>ie,u.canonical.y>>ie)):ie!==0&&(I=X,O=new s.OverscaledTileID(I,u.wrap,X,u.canonical.x>>ie,u.canonical.y>>ie))}O.key!==u.key&&(G.push(O.key),_=p.getTile(O))}const V=X=>{G.forEach(ie=>{S[ie]=X}),G.length=0};for(I-=1;I>=N&&(!_||!_.hasData());I--){_&&V(_.tileID.key);const X=O.calculateScaledKey(I);if(_=p.getTileByID(X),_&&_.hasData())break;const ie=S[X];if(ie===null)break;ie===void 0?G.push(X):_=p.getTileByID(ie)}return V(_?_.tileID.key:null),_&&_.hasData()?_:null}findDEMTileFor(u){return this.enabled?this._findTileCoveringTileID(u,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(u,p){let _=this._tilesDirty[u];_||(_=this._tilesDirty[u]={}),_[p.key]=!0}getWirefameBuffer(){if(!this.wireframeSegments){const u=function(p){let _=0;const S=new s.StructArrayLayout2ui4,E=131;for(let O=1;O<129;O++){for(let I=1;I<129;I++)_=O*E+I,S.emplaceBack(_,_+1),S.emplaceBack(_,_+E),S.emplaceBack(_+1,_+E),O===128&&S.emplaceBack(_+E,_+E+1);S.emplaceBack(_+1,_+1+E)}return S}();this.wireframeIndexBuffer=this.painter.context.createIndexBuffer(u),this.wireframeSegments=s.SegmentVector.simpleSegment(0,0,this.gridBuffer.length,u.length)}return[this.wireframeIndexBuffer,this.wireframeSegments]}}class Or{static cacheKey(u,p,_,S){let E=`${p}${S?S.cacheKey:""}`;for(const O of _)u.usedDefines.includes(O)&&(E+=`/${O}`);return E}constructor(u,p,_,S,E,O){const I=u.gl;this.program=I.createProgram();const N=function(J){const se=[];for(let me=0;me<J.length;me++){if(J[me]===null)continue;const ge=J[me].split(" ");se.push(ge.pop())}return se}(_.staticAttributes),G=S?S.getBinderAttributes():[],V=N.concat(G);let X=S?S.defines():[];X=X.concat(O.map(J=>`#define ${J}`));const ie=u.isWebGL2?`#version 300 es
`:"",ae=ie+X.concat(u.extStandardDerivatives&&ie.length===0?`#extension GL_OES_standard_derivatives : enable
`.concat(Xm):Xm,Xm,Ud,Y_.fragmentSource,Oc.fragmentSource,_.fragmentSource).join(`
`),ce=ie+X.concat(`
#ifdef GL_ES
precision highp float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`,Ud,Y_.vertexSource,Oc.vertexSource,Fd.vertexSource,_.vertexSource).join(`
`),le=I.createShader(I.FRAGMENT_SHADER);if(I.isContextLost())return void(this.failedToCreate=!0);I.shaderSource(le,ae),I.compileShader(le),I.attachShader(this.program,le);const he=I.createShader(I.VERTEX_SHADER);if(I.isContextLost())this.failedToCreate=!0;else{I.shaderSource(he,ce),I.compileShader(he),I.attachShader(this.program,he),this.attributes={},this.numAttributes=V.length;for(let J=0;J<this.numAttributes;J++)V[J]&&(I.bindAttribLocation(this.program,J,V[J]),this.attributes[V[J]]=J);I.linkProgram(this.program),I.deleteShader(he),I.deleteShader(le),this.fixedUniforms=E(u),this.binderUniforms=S?S.getUniforms(u):[],O.includes("TERRAIN")&&(this.terrainUniforms=(J=>({u_dem:new s.Uniform1i(J),u_dem_prev:new s.Uniform1i(J),u_dem_unpack:new s.Uniform4f(J),u_dem_tl:new s.Uniform2f(J),u_dem_scale:new s.Uniform1f(J),u_dem_tl_prev:new s.Uniform2f(J),u_dem_scale_prev:new s.Uniform1f(J),u_dem_size:new s.Uniform1f(J),u_dem_lerp:new s.Uniform1f(J),u_exaggeration:new s.Uniform1f(J),u_depth:new s.Uniform1i(J),u_depth_size_inv:new s.Uniform2f(J),u_meter_to_dem:new s.Uniform1f(J),u_label_plane_matrix_inv:new s.UniformMatrix4f(J)}))(u)),O.includes("GLOBE")&&(this.globeUniforms=(J=>({u_tile_tl_up:new s.Uniform3f(J),u_tile_tr_up:new s.Uniform3f(J),u_tile_br_up:new s.Uniform3f(J),u_tile_bl_up:new s.Uniform3f(J),u_tile_up_scale:new s.Uniform1f(J)}))(u)),O.includes("FOG")&&(this.fogUniforms=(J=>({u_fog_matrix:new s.UniformMatrix4f(J),u_fog_range:new s.Uniform2f(J),u_fog_color:new s.Uniform4f(J),u_fog_horizon_blend:new s.Uniform1f(J),u_fog_temporal_offset:new s.Uniform1f(J),u_frustum_tl:new s.Uniform3f(J),u_frustum_tr:new s.Uniform3f(J),u_frustum_br:new s.Uniform3f(J),u_frustum_bl:new s.Uniform3f(J),u_globe_pos:new s.Uniform3f(J),u_globe_radius:new s.Uniform1f(J),u_globe_transition:new s.Uniform1f(J),u_is_globe:new s.Uniform1i(J),u_viewport:new s.Uniform2f(J)}))(u))}}setTerrainUniformValues(u,p){if(!this.terrainUniforms)return;const _=this.terrainUniforms;if(!this.failedToCreate){u.program.set(this.program);for(const S in p)_[S]&&_[S].set(this.program,S,p[S])}}setGlobeUniformValues(u,p){if(!this.globeUniforms)return;const _=this.globeUniforms;if(!this.failedToCreate){u.program.set(this.program);for(const S in p)_[S]&&_[S].set(this.program,S,p[S])}}setFogUniformValues(u,p){if(!this.fogUniforms)return;const _=this.fogUniforms;if(!this.failedToCreate){u.program.set(this.program);for(const S in p)_[S].set(this.program,S,p[S])}}draw(u,p,_,S,E,O,I,N,G,V,X,ie,ae,ce,le){const he=u.gl;if(this.failedToCreate)return;u.program.set(this.program),u.setDepthMode(_),u.setStencilMode(S),u.setColorMode(E),u.setCullFace(O);for(const se of Object.keys(this.fixedUniforms))this.fixedUniforms[se].set(this.program,se,I[se]);ce&&ce.setUniforms(this.program,u,this.binderUniforms,ie,{zoom:ae});const J={[he.LINES]:2,[he.TRIANGLES]:3,[he.LINE_STRIP]:1}[p];for(const se of X.get()){const me=se.vaos||(se.vaos={});(me[N]||(me[N]=new BS)).bind(u,this,G,ce?ce.getPaintVertexBuffers():[],V,se.vertexOffset,le||[]),he.drawElements(p,se.primitiveLength*J,he.UNSIGNED_SHORT,se.primitiveOffset*J*2)}}}function sh(g,u){const p=Math.pow(2,u.tileID.overscaledZ),_=u.tileSize*Math.pow(2,g.transform.tileZoom)/p,S=_*(u.tileID.canonical.x+u.tileID.wrap*p),E=_*u.tileID.canonical.y;return{u_image:0,u_texsize:u.imageAtlasTexture.size,u_tile_units_to_pixels:1/at(u,1,g.transform.tileZoom),u_pixel_coord_upper:[S>>16,E>>16],u_pixel_coord_lower:[65535&S,65535&E]}}const t0=s.create(),ig=(g,u,p,_,S,E,O,I,N,G,V)=>{const X=u.style.light,ie=X.properties.get("position"),ae=[ie.x,ie.y,ie.z],ce=s.create$1();X.properties.get("anchor")==="viewport"&&(s.fromRotation(ce,-u.transform.angle),s.transformMat3(ae,ae,ce));const le=X.properties.get("color"),he=u.transform,J={u_matrix:g,u_lightpos:ae,u_lightintensity:X.properties.get("intensity"),u_lightcolor:[le.r,le.g,le.b],u_vertical_gradient:+p,u_opacity:_,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:t0,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_ao:S,u_edge_radius:E};return he.projection.name==="globe"&&(J.u_tile_id=[O.canonical.x,O.canonical.y,1<<O.canonical.z],J.u_zoom_transition=N,J.u_inv_rot_matrix=V,J.u_merc_center=G,J.u_up_dir=he.projection.upVector(new s.CanonicalTileID(0,0,0),G[0]*s.EXTENT,G[1]*s.EXTENT),J.u_height_lift=I),J},r0=(g,u,p,_,S,E,O,I,N,G,V,X)=>{const ie=ig(g,u,p,_,S,E,O,N,G,V,X),ae={u_height_factor:-Math.pow(2,O.overscaledZ)/I.tileSize/8};return s.extend(ie,sh(u,I),ae)},Ll=g=>({u_matrix:g}),og=(g,u,p)=>s.extend(Ll(g),sh(u,p)),NS=(g,u)=>({u_matrix:g,u_world:u}),$S=(g,u,p,_)=>s.extend(og(g,u,p),{u_world:_}),FS=s.create(),sg=(g,u,p,_,S,E)=>{const O=g.transform,I=O.projection.name==="globe";let N;if(E.paint.get("circle-pitch-alignment")==="map")if(I){const V=s.globePixelsToTileUnits(O.zoom,u.canonical)*O._pixelsPerMercatorPixel;N=Float32Array.from([V,0,0,V])}else N=O.calculatePixelsToTileUnitsMatrix(p);else N=new Float32Array([O.pixelsToGLUnits[0],0,0,O.pixelsToGLUnits[1]]);const G={u_camera_to_center_distance:O.cameraToCenterDistance,u_matrix:g.translatePosMatrix(u.projMatrix,p,E.paint.get("circle-translate"),E.paint.get("circle-translate-anchor")),u_device_pixel_ratio:s.exported.devicePixelRatio,u_extrude_scale:N,u_inv_rot_matrix:FS,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(I){G.u_inv_rot_matrix=_,G.u_merc_center=S,G.u_tile_id=[u.canonical.x,u.canonical.y,1<<u.canonical.z],G.u_zoom_transition=s.globeToMercatorTransition(O.zoom);const V=S[0]*s.EXTENT,X=S[1]*s.EXTENT;G.u_up_dir=O.projection.upVector(new s.CanonicalTileID(0,0,0),V,X)}return G},ag=g=>{const u=[];return g.paint.get("circle-pitch-alignment")==="map"&&u.push("PITCH_WITH_MAP"),g.paint.get("circle-pitch-scale")==="map"&&u.push("SCALE_WITH_MAP"),u},lg=(g,u,p,_)=>{const S=s.EXTENT/p.tileSize;return{u_matrix:g,u_camera_to_center_distance:u.getCameraToCenterDistance(_),u_extrude_scale:[u.pixelsToGLUnits[0]/S,u.pixelsToGLUnits[1]/S]}},Hd=(g,u,p=1)=>({u_matrix:g,u_color:u,u_overlay:0,u_overlay_scale:p}),n0=s.create(),i0=(g,u,p,_,S,E,O)=>{const I=g.transform,N=I.projection.name==="globe",G=N?s.globePixelsToTileUnits(I.zoom,u.canonical)*I._pixelsPerMercatorPixel:at(p,1,E),V={u_matrix:u.projMatrix,u_extrude_scale:G,u_intensity:O,u_inv_rot_matrix:n0,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(N){V.u_inv_rot_matrix=_,V.u_merc_center=S,V.u_tile_id=[u.canonical.x,u.canonical.y,1<<u.canonical.z],V.u_zoom_transition=s.globeToMercatorTransition(I.zoom);const X=S[0]*s.EXTENT,ie=S[1]*s.EXTENT;V.u_up_dir=I.projection.upVector(new s.CanonicalTileID(0,0,0),X,ie)}return V},US=(g,u,p,_,S,E,O)=>{const I=g.transform,N=I.calculatePixelsToTileUnitsMatrix(u);return{u_matrix:cg(g,u,p,_),u_pixels_to_tile_units:N,u_device_pixel_ratio:E,u_units_to_pixels:[1/I.pixelsToGLUnits[0],1/I.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:S,u_texsize:lh(p)?u.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:Dc(u,g.transform),u_alpha_discard_threshold:0,u_trim_offset:O}},ah=(g,u,p,_,S)=>{const E=g.transform;return{u_matrix:cg(g,u,p,_),u_texsize:u.imageAtlasTexture.size,u_pixels_to_tile_units:E.calculatePixelsToTileUnitsMatrix(u),u_device_pixel_ratio:S,u_image:0,u_tile_units_to_pixels:Dc(u,E),u_units_to_pixels:[1/E.pixelsToGLUnits[0],1/E.pixelsToGLUnits[1]],u_alpha_discard_threshold:0}};function Dc(g,u){return 1/at(g,1,u.tileZoom)}function cg(g,u,p,_){return g.translatePosMatrix(_||u.tileID.projMatrix,u,p.paint.get("line-translate"),p.paint.get("line-translate-anchor"))}function lh(g){const u=g.paint.get("line-dasharray").value;return u.value||u.kind!=="constant"}const ug=(g,u,p,_,S,E)=>{return{u_matrix:g,u_tl_parent:u,u_scale_parent:p,u_fade_t:_.mix,u_opacity:_.opacity*S.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:S.paint.get("raster-brightness-min"),u_brightness_high:S.paint.get("raster-brightness-max"),u_saturation_factor:(I=S.paint.get("raster-saturation"),I>0?1-1/(1.001-I):-I),u_contrast_factor:(O=S.paint.get("raster-contrast"),O>0?1/(1-O):1+O),u_spin_weights:Ds(S.paint.get("raster-hue-rotate")),u_perspective_transform:E};var O,I};function Ds(g){g*=Math.PI/180;const u=Math.sin(g),p=Math.cos(g);return[(2*p+1)/3,(-Math.sqrt(3)*u-p+1)/3,(Math.sqrt(3)*u-p+1)/3]}const Kd=s.create(),hg=(g,u,p,_,S,E,O,I,N,G,V,X,ie,ae,ce,le)=>{const he=S.transform,J={u_is_size_zoom_constant:+(g==="constant"||g==="source"),u_is_size_feature_constant:+(g==="constant"||g==="camera"),u_size_t:u?u.uSizeT:0,u_size:u?u.uSize:0,u_camera_to_center_distance:he.cameraToCenterDistance,u_rotate_symbol:+p,u_aspect_ratio:he.width/he.height,u_fade_change:S.options.fadeDuration?S.symbolFadeChange:1,u_matrix:E,u_label_plane_matrix:O,u_coord_matrix:I,u_is_text:+N,u_pitch_with_map:+_,u_texsize:G,u_texture:0,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Kd,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:Kd,u_up_vector:[0,-1,0]};return le.name==="globe"&&(J.u_tile_id=[V.canonical.x,V.canonical.y,1<<V.canonical.z],J.u_zoom_transition=X,J.u_inv_rot_matrix=ae,J.u_merc_center=ie,J.u_camera_forward=he._camera.forward(),J.u_ecef_origin=s.globeECEFOrigin(he.globeMatrix,V.toUnwrapped()),J.u_tile_matrix=Float32Array.from(he.globeMatrix),J.u_up_vector=ce),J},Zd=(g,u,p,_,S,E,O,I,N,G,V,X,ie,ae,ce,le,he)=>s.extend(hg(g,u,p,_,S,E,O,I,N,G,X,ie,ae,ce,le,he),{u_gamma_scale:_?S.transform.cameraToCenterDistance*Math.cos(S.terrain?0:S.transform._pitch):1,u_device_pixel_ratio:s.exported.devicePixelRatio,u_is_halo:1}),o0=(g,u,p,_,S,E,O,I,N,G,V,X,ie,ae,ce,le)=>s.extend(Zd(g,u,p,_,S,E,O,I,!0,N,!0,V,X,ie,ae,ce,le),{u_texsize_icon:G,u_texture_icon:1}),dg=(g,u,p)=>({u_matrix:g,u_opacity:u,u_color:p}),VS=(g,u,p,_,S)=>s.extend(function(E,O,I){const N=O.imageManager.getPattern(E.toString()),{width:G,height:V}=O.imageManager.getPixelSize(),X=Math.pow(2,I.tileID.overscaledZ),ie=I.tileSize*Math.pow(2,O.transform.tileZoom)/X,ae=ie*(I.tileID.canonical.x+I.tileID.wrap*X),ce=ie*I.tileID.canonical.y;return{u_image:0,u_pattern_tl:N.tl,u_pattern_br:N.br,u_texsize:[G,V],u_pattern_size:N.displaySize,u_tile_units_to_pixels:1/at(I,1,O.transform.tileZoom),u_pixel_coord_upper:[ae>>16,ce>>16],u_pixel_coord_lower:[65535&ae,65535&ce]}}(_,p,S),{u_matrix:g,u_opacity:u}),fg={fillExtrusion:g=>({u_matrix:new s.UniformMatrix4f(g),u_lightpos:new s.Uniform3f(g),u_lightintensity:new s.Uniform1f(g),u_lightcolor:new s.Uniform3f(g),u_vertical_gradient:new s.Uniform1f(g),u_opacity:new s.Uniform1f(g),u_edge_radius:new s.Uniform1f(g),u_ao:new s.Uniform2f(g),u_tile_id:new s.Uniform3f(g),u_zoom_transition:new s.Uniform1f(g),u_inv_rot_matrix:new s.UniformMatrix4f(g),u_merc_center:new s.Uniform2f(g),u_up_dir:new s.Uniform3f(g),u_height_lift:new s.Uniform1f(g)}),fillExtrusionPattern:g=>({u_matrix:new s.UniformMatrix4f(g),u_lightpos:new s.Uniform3f(g),u_lightintensity:new s.Uniform1f(g),u_lightcolor:new s.Uniform3f(g),u_vertical_gradient:new s.Uniform1f(g),u_height_factor:new s.Uniform1f(g),u_edge_radius:new s.Uniform1f(g),u_ao:new s.Uniform2f(g),u_tile_id:new s.Uniform3f(g),u_zoom_transition:new s.Uniform1f(g),u_inv_rot_matrix:new s.UniformMatrix4f(g),u_merc_center:new s.Uniform2f(g),u_up_dir:new s.Uniform3f(g),u_height_lift:new s.Uniform1f(g),u_image:new s.Uniform1i(g),u_texsize:new s.Uniform2f(g),u_pixel_coord_upper:new s.Uniform2f(g),u_pixel_coord_lower:new s.Uniform2f(g),u_tile_units_to_pixels:new s.Uniform1f(g),u_opacity:new s.Uniform1f(g)}),fill:g=>({u_matrix:new s.UniformMatrix4f(g)}),fillPattern:g=>({u_matrix:new s.UniformMatrix4f(g),u_image:new s.Uniform1i(g),u_texsize:new s.Uniform2f(g),u_pixel_coord_upper:new s.Uniform2f(g),u_pixel_coord_lower:new s.Uniform2f(g),u_tile_units_to_pixels:new s.Uniform1f(g)}),fillOutline:g=>({u_matrix:new s.UniformMatrix4f(g),u_world:new s.Uniform2f(g)}),fillOutlinePattern:g=>({u_matrix:new s.UniformMatrix4f(g),u_world:new s.Uniform2f(g),u_image:new s.Uniform1i(g),u_texsize:new s.Uniform2f(g),u_pixel_coord_upper:new s.Uniform2f(g),u_pixel_coord_lower:new s.Uniform2f(g),u_tile_units_to_pixels:new s.Uniform1f(g)}),circle:g=>({u_camera_to_center_distance:new s.Uniform1f(g),u_extrude_scale:new s.UniformMatrix2f(g),u_device_pixel_ratio:new s.Uniform1f(g),u_matrix:new s.UniformMatrix4f(g),u_inv_rot_matrix:new s.UniformMatrix4f(g),u_merc_center:new s.Uniform2f(g),u_tile_id:new s.Uniform3f(g),u_zoom_transition:new s.Uniform1f(g),u_up_dir:new s.Uniform3f(g)}),collisionBox:g=>({u_matrix:new s.UniformMatrix4f(g),u_camera_to_center_distance:new s.Uniform1f(g),u_extrude_scale:new s.Uniform2f(g)}),collisionCircle:g=>({u_matrix:new s.UniformMatrix4f(g),u_inv_matrix:new s.UniformMatrix4f(g),u_camera_to_center_distance:new s.Uniform1f(g),u_viewport_size:new s.Uniform2f(g)}),debug:g=>({u_color:new s.UniformColor(g),u_matrix:new s.UniformMatrix4f(g),u_overlay:new s.Uniform1i(g),u_overlay_scale:new s.Uniform1f(g)}),clippingMask:g=>({u_matrix:new s.UniformMatrix4f(g)}),heatmap:g=>({u_extrude_scale:new s.Uniform1f(g),u_intensity:new s.Uniform1f(g),u_matrix:new s.UniformMatrix4f(g),u_inv_rot_matrix:new s.UniformMatrix4f(g),u_merc_center:new s.Uniform2f(g),u_tile_id:new s.Uniform3f(g),u_zoom_transition:new s.Uniform1f(g),u_up_dir:new s.Uniform3f(g)}),heatmapTexture:g=>({u_image:new s.Uniform1i(g),u_color_ramp:new s.Uniform1i(g),u_opacity:new s.Uniform1f(g)}),hillshade:g=>({u_matrix:new s.UniformMatrix4f(g),u_image:new s.Uniform1i(g),u_latrange:new s.Uniform2f(g),u_light:new s.Uniform2f(g),u_shadow:new s.UniformColor(g),u_highlight:new s.UniformColor(g),u_accent:new s.UniformColor(g)}),hillshadePrepare:g=>({u_matrix:new s.UniformMatrix4f(g),u_image:new s.Uniform1i(g),u_dimension:new s.Uniform2f(g),u_zoom:new s.Uniform1f(g),u_unpack:new s.Uniform4f(g)}),line:g=>({u_matrix:new s.UniformMatrix4f(g),u_pixels_to_tile_units:new s.UniformMatrix2f(g),u_device_pixel_ratio:new s.Uniform1f(g),u_units_to_pixels:new s.Uniform2f(g),u_dash_image:new s.Uniform1i(g),u_gradient_image:new s.Uniform1i(g),u_image_height:new s.Uniform1f(g),u_texsize:new s.Uniform2f(g),u_tile_units_to_pixels:new s.Uniform1f(g),u_alpha_discard_threshold:new s.Uniform1f(g),u_trim_offset:new s.Uniform2f(g)}),linePattern:g=>({u_matrix:new s.UniformMatrix4f(g),u_texsize:new s.Uniform2f(g),u_pixels_to_tile_units:new s.UniformMatrix2f(g),u_device_pixel_ratio:new s.Uniform1f(g),u_image:new s.Uniform1i(g),u_units_to_pixels:new s.Uniform2f(g),u_tile_units_to_pixels:new s.Uniform1f(g),u_alpha_discard_threshold:new s.Uniform1f(g)}),raster:g=>({u_matrix:new s.UniformMatrix4f(g),u_tl_parent:new s.Uniform2f(g),u_scale_parent:new s.Uniform1f(g),u_fade_t:new s.Uniform1f(g),u_opacity:new s.Uniform1f(g),u_image0:new s.Uniform1i(g),u_image1:new s.Uniform1i(g),u_brightness_low:new s.Uniform1f(g),u_brightness_high:new s.Uniform1f(g),u_saturation_factor:new s.Uniform1f(g),u_contrast_factor:new s.Uniform1f(g),u_spin_weights:new s.Uniform3f(g),u_perspective_transform:new s.Uniform2f(g)}),symbolIcon:g=>({u_is_size_zoom_constant:new s.Uniform1i(g),u_is_size_feature_constant:new s.Uniform1i(g),u_size_t:new s.Uniform1f(g),u_size:new s.Uniform1f(g),u_camera_to_center_distance:new s.Uniform1f(g),u_rotate_symbol:new s.Uniform1i(g),u_aspect_ratio:new s.Uniform1f(g),u_fade_change:new s.Uniform1f(g),u_matrix:new s.UniformMatrix4f(g),u_label_plane_matrix:new s.UniformMatrix4f(g),u_coord_matrix:new s.UniformMatrix4f(g),u_is_text:new s.Uniform1i(g),u_pitch_with_map:new s.Uniform1i(g),u_texsize:new s.Uniform2f(g),u_tile_id:new s.Uniform3f(g),u_zoom_transition:new s.Uniform1f(g),u_inv_rot_matrix:new s.UniformMatrix4f(g),u_merc_center:new s.Uniform2f(g),u_camera_forward:new s.Uniform3f(g),u_tile_matrix:new s.UniformMatrix4f(g),u_up_vector:new s.Uniform3f(g),u_ecef_origin:new s.Uniform3f(g),u_texture:new s.Uniform1i(g)}),symbolSDF:g=>({u_is_size_zoom_constant:new s.Uniform1i(g),u_is_size_feature_constant:new s.Uniform1i(g),u_size_t:new s.Uniform1f(g),u_size:new s.Uniform1f(g),u_camera_to_center_distance:new s.Uniform1f(g),u_rotate_symbol:new s.Uniform1i(g),u_aspect_ratio:new s.Uniform1f(g),u_fade_change:new s.Uniform1f(g),u_matrix:new s.UniformMatrix4f(g),u_label_plane_matrix:new s.UniformMatrix4f(g),u_coord_matrix:new s.UniformMatrix4f(g),u_is_text:new s.Uniform1i(g),u_pitch_with_map:new s.Uniform1i(g),u_texsize:new s.Uniform2f(g),u_texture:new s.Uniform1i(g),u_gamma_scale:new s.Uniform1f(g),u_device_pixel_ratio:new s.Uniform1f(g),u_tile_id:new s.Uniform3f(g),u_zoom_transition:new s.Uniform1f(g),u_inv_rot_matrix:new s.UniformMatrix4f(g),u_merc_center:new s.Uniform2f(g),u_camera_forward:new s.Uniform3f(g),u_tile_matrix:new s.UniformMatrix4f(g),u_up_vector:new s.Uniform3f(g),u_ecef_origin:new s.Uniform3f(g),u_is_halo:new s.Uniform1i(g)}),symbolTextAndIcon:g=>({u_is_size_zoom_constant:new s.Uniform1i(g),u_is_size_feature_constant:new s.Uniform1i(g),u_size_t:new s.Uniform1f(g),u_size:new s.Uniform1f(g),u_camera_to_center_distance:new s.Uniform1f(g),u_rotate_symbol:new s.Uniform1i(g),u_aspect_ratio:new s.Uniform1f(g),u_fade_change:new s.Uniform1f(g),u_matrix:new s.UniformMatrix4f(g),u_label_plane_matrix:new s.UniformMatrix4f(g),u_coord_matrix:new s.UniformMatrix4f(g),u_is_text:new s.Uniform1i(g),u_pitch_with_map:new s.Uniform1i(g),u_texsize:new s.Uniform2f(g),u_texsize_icon:new s.Uniform2f(g),u_texture:new s.Uniform1i(g),u_texture_icon:new s.Uniform1i(g),u_gamma_scale:new s.Uniform1f(g),u_device_pixel_ratio:new s.Uniform1f(g),u_is_halo:new s.Uniform1i(g)}),background:g=>({u_matrix:new s.UniformMatrix4f(g),u_opacity:new s.Uniform1f(g),u_color:new s.UniformColor(g)}),backgroundPattern:g=>({u_matrix:new s.UniformMatrix4f(g),u_opacity:new s.Uniform1f(g),u_image:new s.Uniform1i(g),u_pattern_tl:new s.Uniform2f(g),u_pattern_br:new s.Uniform2f(g),u_texsize:new s.Uniform2f(g),u_pattern_size:new s.Uniform2f(g),u_pixel_coord_upper:new s.Uniform2f(g),u_pixel_coord_lower:new s.Uniform2f(g),u_tile_units_to_pixels:new s.Uniform1f(g)}),terrainRaster:eg,terrainDepth:eg,skybox:g=>({u_matrix:new s.UniformMatrix4f(g),u_sun_direction:new s.Uniform3f(g),u_cubemap:new s.Uniform1i(g),u_opacity:new s.Uniform1f(g),u_temporal_offset:new s.Uniform1f(g)}),skyboxGradient:g=>({u_matrix:new s.UniformMatrix4f(g),u_color_ramp:new s.Uniform1i(g),u_center_direction:new s.Uniform3f(g),u_radius:new s.Uniform1f(g),u_opacity:new s.Uniform1f(g),u_temporal_offset:new s.Uniform1f(g)}),skyboxCapture:g=>({u_matrix_3f:new s.UniformMatrix3f(g),u_sun_direction:new s.Uniform3f(g),u_sun_intensity:new s.Uniform1f(g),u_color_tint_r:new s.Uniform4f(g),u_color_tint_m:new s.Uniform4f(g),u_luminance:new s.Uniform1f(g)}),globeRaster:g=>({u_proj_matrix:new s.UniformMatrix4f(g),u_globe_matrix:new s.UniformMatrix4f(g),u_normalize_matrix:new s.UniformMatrix4f(g),u_merc_matrix:new s.UniformMatrix4f(g),u_zoom_transition:new s.Uniform1f(g),u_merc_center:new s.Uniform2f(g),u_image0:new s.Uniform1i(g),u_grid_matrix:new s.UniformMatrix3f(g),u_skirt_height:new s.Uniform1f(g),u_frustum_tl:new s.Uniform3f(g),u_frustum_tr:new s.Uniform3f(g),u_frustum_br:new s.Uniform3f(g),u_frustum_bl:new s.Uniform3f(g),u_globe_pos:new s.Uniform3f(g),u_globe_radius:new s.Uniform1f(g),u_viewport:new s.Uniform2f(g)}),globeAtmosphere:g=>({u_frustum_tl:new s.Uniform3f(g),u_frustum_tr:new s.Uniform3f(g),u_frustum_br:new s.Uniform3f(g),u_frustum_bl:new s.Uniform3f(g),u_horizon:new s.Uniform1f(g),u_transition:new s.Uniform1f(g),u_fadeout_range:new s.Uniform1f(g),u_color:new s.Uniform4f(g),u_high_color:new s.Uniform4f(g),u_space_color:new s.Uniform4f(g),u_star_intensity:new s.Uniform1f(g),u_star_density:new s.Uniform1f(g),u_star_size:new s.Uniform1f(g),u_temporal_offset:new s.Uniform1f(g),u_horizon_angle:new s.Uniform1f(g),u_rotation_matrix:new s.UniformMatrix4f(g)})};let Xd;function ch(g,u,p,_,S,E,O){const I=g.context,N=I.gl,G=g.transform,V=g.useProgram("collisionBox"),X=[];let ie=0,ae=0;for(let ge=0;ge<_.length;ge++){const Te=_[ge],Pe=u.getTile(Te),Ae=Pe.getBucket(p);if(!Ae)continue;const Re=Fo(Te,Ae,G);let Ie=Re;S[0]===0&&S[1]===0||(Ie=g.translatePosMatrix(Re,Pe,S,E));const Ve=O?Ae.textCollisionBox:Ae.iconCollisionBox,pt=Ae.collisionCircleArray;if(pt.length>0){const $e=s.create(),it=Ie;s.mul($e,Ae.placementInvProjMatrix,G.glCoordMatrix),s.mul($e,$e,Ae.placementViewportMatrix),X.push({circleArray:pt,circleOffset:ae,transform:it,invTransform:$e,projection:Ae.getProjection()}),ie+=pt.length/4,ae=ie}Ve&&(g.terrain&&g.terrain.setupElevationDraw(Pe,V),V.draw(I,N.LINES,s.DepthMode.disabled,s.StencilMode.disabled,g.colorModeForRenderPass(),s.CullFaceMode.disabled,lg(Ie,G,Pe,Ae.getProjection()),p.id,Ve.layoutVertexBuffer,Ve.indexBuffer,Ve.segments,null,G.zoom,null,[Ve.collisionVertexBuffer,Ve.collisionVertexBufferExt]))}if(!O||!X.length)return;const ce=g.useProgram("collisionCircle"),le=new s.StructArrayLayout2f1f2i16;le.resize(4*ie),le._trim();let he=0;for(const ge of X)for(let Te=0;Te<ge.circleArray.length/4;Te++){const Pe=4*Te,Ae=ge.circleArray[Pe+0],Re=ge.circleArray[Pe+1],Ie=ge.circleArray[Pe+2],Ve=ge.circleArray[Pe+3];le.emplace(he++,Ae,Re,Ie,Ve,0),le.emplace(he++,Ae,Re,Ie,Ve,1),le.emplace(he++,Ae,Re,Ie,Ve,2),le.emplace(he++,Ae,Re,Ie,Ve,3)}(!Xd||Xd.length<2*ie)&&(Xd=function(ge){const Te=2*ge,Pe=new s.StructArrayLayout3ui6;Pe.resize(Te),Pe._trim();for(let Ae=0;Ae<Te;Ae++){const Re=6*Ae;Pe.uint16[Re+0]=4*Ae+0,Pe.uint16[Re+1]=4*Ae+1,Pe.uint16[Re+2]=4*Ae+2,Pe.uint16[Re+3]=4*Ae+2,Pe.uint16[Re+4]=4*Ae+3,Pe.uint16[Re+5]=4*Ae+0}return Pe}(ie));const J=I.createIndexBuffer(Xd,!0),se=I.createVertexBuffer(le,s.collisionCircleLayout.members,!0);for(const ge of X){const Te={u_matrix:ge.transform,u_inv_matrix:ge.invTransform,u_camera_to_center_distance:(me=G).getCameraToCenterDistance(ge.projection),u_viewport_size:[me.width,me.height]};ce.draw(I,N.TRIANGLES,s.DepthMode.disabled,s.StencilMode.disabled,g.colorModeForRenderPass(),s.CullFaceMode.disabled,Te,p.id,se,J,s.SegmentVector.simpleSegment(0,2*ge.circleOffset,ge.circleArray.length,ge.circleArray.length/2),null,G.zoom)}var me;se.destroy(),J.destroy()}const s0=s.create();function pg({width:g,height:u,anchor:p,textOffset:_,textScale:S},E){const{horizontalAlign:O,verticalAlign:I}=s.getAnchorAlignment(p),N=-(O-.5)*g,G=-(I-.5)*u,V=s.evaluateVariableOffset(p,_);return new s.Point((N/S+V[0])*E,(G/S+V[1])*E)}function GS(g,u,p,_,S,E,O,I,N,G,V){const X=g.text.placedSymbolArray,ie=g.text.dynamicLayoutVertexArray,ae=g.icon.dynamicLayoutVertexArray,ce={},le=g.getProjection(),he=yn(I,le,E),J=E.elevation,se=le.upVectorScale(I.canonical,E.center.lat,E.worldSize).metersToTile;ie.clear();for(let me=0;me<X.length;me++){const ge=X.get(me),{tileAnchorX:Te,tileAnchorY:Pe,numGlyphs:Ae}=ge,Re=ge.hidden||!ge.crossTileID||g.allowVerticalPlacement&&!ge.placedOrientation?null:_[ge.crossTileID];if(Re){let Ie=0,Ve=0,pt=0;if(J){const vt=J?J.getAtTileOffset(I,Te,Pe):0,[Vt,ir,zt]=le.upVector(I.canonical,Te,Pe);Ie=vt*Vt*se,Ve=vt*ir*se,pt=vt*zt*se}let[$e,it,He,ft]=Nn(ge.projectedAnchorX+Ie,ge.projectedAnchorY+Ve,ge.projectedAnchorZ+pt,p?he:O);const Ue=Is(E.getCameraToCenterDistance(le),ft);let nt=S.evaluateSizeForFeature(g.textSizeData,G,ge)*Ue/s.ONE_EM;p&&(nt*=g.tilePixelRatio/N);const yt=pg(Re,nt);p?({x:$e,y:it,z:He}=le.projectTilePoint(Te+yt.x,Pe+yt.y,I.canonical),[$e,it,He]=Nn($e+Ie,it+Ve,He+pt,O)):(u&&yt._rotate(-E.angle),$e+=yt.x,it+=yt.y,He=0);const lt=g.allowVerticalPlacement&&ge.placedOrientation===s.WritingMode.vertical?Math.PI/2:0;for(let vt=0;vt<Ae;vt++)s.addDynamicAttributes(ie,$e,it,He,lt);V&&ge.associatedIconIndex>=0&&(ce[ge.associatedIconIndex]={x:$e,y:it,z:He,angle:lt})}else us(Ae,ie)}if(V){ae.clear();const me=g.icon.placedSymbolArray;for(let ge=0;ge<me.length;ge++){const Te=me.get(ge),{numGlyphs:Pe}=Te,Ae=ce[ge];if(Te.hidden||!Ae)us(Pe,ae);else{const{x:Re,y:Ie,z:Ve,angle:pt}=Ae;for(let $e=0;$e<Pe;$e++)s.addDynamicAttributes(ae,Re,Ie,Ve,pt)}}g.icon.dynamicLayoutVertexBuffer.updateData(ae)}g.text.dynamicLayoutVertexBuffer.updateData(ie)}function mg(g,u,p){return p.iconsInText&&u?"symbolTextAndIcon":g?"symbolSDF":"symbolIcon"}function a0(g,u,p,_,S,E,O,I,N,G,V,X){const ie=g.context,ae=ie.gl,ce=g.transform,le=I==="map",he=N==="map",J=le&&p.layout.get("symbol-placement")!=="point",se=le&&!he&&!J,me=p.layout.get("symbol-sort-key").constantOr(1)!==void 0;let ge=!1;const Te=g.depthModeForSublayer(0,s.DepthMode.ReadOnly),Pe=[s.mercatorXfromLng(ce.center.lng),s.mercatorYfromLat(ce.center.lat)],Ae=p.layout.get("text-variable-anchor"),Re=ce.projection.name==="globe",Ie=[],Ve=[0,-1,0];let pt=Ve;!Re&&!ce.mercatorFromTransition||le||(pt=function($e){const it=$e._camera.getWorldToCamera($e.worldSize,1),He=s.multiply([],it,$e.globeMatrix);s.invert(He,He);const ft=[0,0,0],Ue=[0,1,0,0];return s.transformMat4$1(Ue,Ue,He),ft[0]=Ue[0],ft[1]=Ue[1],ft[2]=Ue[2],s.normalize(ft,ft),ft}(ce));for(const $e of _){const it=u.getTile($e),He=it.getBucket(p);if(!He||He.projection.name==="mercator"&&Re)continue;const ft=S?He.text:He.icon;if(!ft||He.fullyClipped||!ft.segments.get().length)continue;const Ue=ft.programConfigurations.get(p.id),nt=S||He.sdfIcons,yt=S?He.textSizeData:He.iconSizeData,lt=he||ce.pitch!==0,vt=s.evaluateSizeForZoom(yt,ce.zoom);let Vt,ir,zt,Yt,br=[0,0],yr=null;if(S)ir=it.glyphAtlasTexture,zt=ae.LINEAR,Vt=it.glyphAtlasTexture.size,He.iconsInText&&(br=it.imageAtlasTexture.size,yr=it.imageAtlasTexture,Yt=lt||g.options.rotating||g.options.zooming||yt.kind==="composite"||yt.kind==="camera"?ae.LINEAR:ae.NEAREST);else{const pa=p.layout.get("icon-size").constantOr(0)!==1||He.iconsNeedLinear;ir=it.imageAtlasTexture,zt=nt||g.options.rotating||g.options.zooming||pa||lt?ae.LINEAR:ae.NEAREST,Vt=it.imageAtlasTexture.size}const Nt=He.projection.name==="globe",Fr=Nt?pt:Ve,Wr=Nt?s.globeToMercatorTransition(ce.zoom):0,qr=yn($e,He.getProjection(),ce),Hr=ce.calculatePixelsToTileUnitsMatrix(it),Fi=Xe(qr,it.tileID.canonical,he,le,ce,He.getProjection(),Hr),fi=g.terrain&&he&&J?s.invert(s.create(),Fi):s0,Wo=en(qr,it.tileID.canonical,he,le,ce,He.getProjection(),Hr),js=Ae&&He.hasTextData(),vn=p.layout.get("icon-text-fit")!=="none"&&js&&He.hasIconData();if(J){const pa=ce.elevation,rl=pa?pa.getAtTileOffsetFunc($e,ce.center.lat,ce.worldSize,He.getProjection()):null,$l=Ti(qr,it.tileID.canonical,he,le,ce,He.getProjection(),Hr);Qa(He,qr,g,S,$l,Wo,he,G,rl,$e)}const Kr=J||S&&Ae||vn,Lr=g.translatePosMatrix(qr,it,E,O),Gn=Kr?s0:Fi,Xi=g.translatePosMatrix(Wo,it,E,O,!0),fn=He.getProjection().createInversionMatrix(ce,$e.canonical),uo=[];g.terrainRenderModeElevated()&&he&&uo.push("PITCH_WITH_MAP_TERRAIN"),Nt&&uo.push("PROJECTION_GLOBE_VIEW"),Kr&&uo.push("PROJECTED_POS_ON_VIEWPORT");const ff=nt&&p.paint.get(S?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let Nl;Nl=nt?He.iconsInText?o0(yt.kind,vt,se,he,g,Lr,Gn,Xi,Vt,br,$e,Wr,Pe,fn,Fr,He.getProjection()):Zd(yt.kind,vt,se,he,g,Lr,Gn,Xi,S,Vt,!0,$e,Wr,Pe,fn,Fr,He.getProjection()):hg(yt.kind,vt,se,he,g,Lr,Gn,Xi,S,Vt,$e,Wr,Pe,fn,Fr,He.getProjection());const xh={program:g.useProgram(mg(nt,S,He),Ue,uo),buffers:ft,uniformValues:Nl,atlasTexture:ir,atlasTextureIcon:yr,atlasInterpolation:zt,atlasInterpolationIcon:Yt,isSDF:nt,hasHalo:ff,tile:it,labelPlaneMatrixInv:fi};if(me&&He.canOverlap){ge=!0;const pa=ft.segments.get();for(const rl of pa)Ie.push({segments:new s.SegmentVector([rl]),sortKey:rl.sortKey,state:xh})}else Ie.push({segments:ft.segments,sortKey:0,state:xh})}ge&&Ie.sort(($e,it)=>$e.sortKey-it.sortKey);for(const $e of Ie){const it=$e.state;if(g.terrain&&g.terrain.setupElevationDraw(it.tile,it.program,{useDepthForOcclusion:!Re,labelPlaneMatrixInv:it.labelPlaneMatrixInv}),ie.activeTexture.set(ae.TEXTURE0),it.atlasTexture.bind(it.atlasInterpolation,ae.CLAMP_TO_EDGE),it.atlasTextureIcon&&(ie.activeTexture.set(ae.TEXTURE1),it.atlasTextureIcon&&it.atlasTextureIcon.bind(it.atlasInterpolationIcon,ae.CLAMP_TO_EDGE)),it.isSDF){const He=it.uniformValues;it.hasHalo&&(He.u_is_halo=1,uh(it.buffers,$e.segments,p,g,it.program,Te,V,X,He)),He.u_is_halo=0}uh(it.buffers,$e.segments,p,g,it.program,Te,V,X,it.uniformValues)}}function uh(g,u,p,_,S,E,O,I,N){const G=_.context,V=[g.dynamicLayoutVertexBuffer,g.opacityVertexBuffer,g.globeExtVertexBuffer];S.draw(G,G.gl.TRIANGLES,E,O,I,s.CullFaceMode.disabled,N,p.id,g.layoutVertexBuffer,g.indexBuffer,u,p.paint,_.transform.zoom,g.programConfigurations.get(p.id),V)}function l0(g,u,p,_,S,E,O){const I=g.context.gl,N=p.paint.get("fill-pattern"),G=N&&N.constantOr(1);let V,X,ie,ae,ce;O?(X=G&&!p.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",V=I.LINES):(X=G?"fillPattern":"fill",V=I.TRIANGLES);for(const le of _){const he=u.getTile(le);if(G&&!he.patternsLoaded())continue;const J=he.getBucket(p);if(!J)continue;g.prepareDrawTile();const se=J.programConfigurations.get(p.id),me=g.useProgram(X,se);G&&(g.context.activeTexture.set(I.TEXTURE0),he.imageAtlasTexture.bind(I.LINEAR,I.CLAMP_TO_EDGE),se.updatePaintBuffers());const ge=N.constantOr(null);if(ge&&he.imageAtlas){const Pe=he.imageAtlas.patternPositions[ge.toString()];Pe&&se.setConstantPatternPositions(Pe)}const Te=g.translatePosMatrix(le.projMatrix,he,p.paint.get("fill-translate"),p.paint.get("fill-translate-anchor"));if(O){ae=J.indexBuffer2,ce=J.segments2;const Pe=g.terrain&&g.terrain.renderingToTexture?g.terrain.drapeBufferSize:[I.drawingBufferWidth,I.drawingBufferHeight];ie=X==="fillOutlinePattern"&&G?$S(Te,g,he,Pe):NS(Te,Pe)}else ae=J.indexBuffer,ce=J.segments,ie=G?og(Te,g,he):Ll(Te);g.prepareDrawProgram(g.context,me,le.toUnwrapped()),me.draw(g.context,V,S,g.stencilModeForClipping(le),E,s.CullFaceMode.disabled,ie,p.id,J.layoutVertexBuffer,ae,ce,p.paint,g.transform.zoom,se)}}function Yd(g,u,p,_,S,E,O){const I=g.context,N=I.gl,G=g.transform,V=p.paint.get("fill-extrusion-pattern"),X=V.constantOr(1),ie=p.paint.get("fill-extrusion-opacity"),ae=[p.paint.get("fill-extrusion-ambient-occlusion-intensity"),p.paint.get("fill-extrusion-ambient-occlusion-radius")],ce=p.layout.get("fill-extrusion-edge-radius"),le=ce>0&&!p.paint.get("fill-extrusion-rounded-roof"),he=le?0:ce,J=G.projection.name==="globe"?s.fillExtrusionHeightLift():0,se=G.projection.name==="globe",me=se?s.globeToMercatorTransition(G.zoom):0,ge=[s.mercatorXfromLng(G.center.lng),s.mercatorYfromLat(G.center.lat)],Te=[];se&&Te.push("PROJECTION_GLOBE_VIEW"),ae[0]>0&&Te.push("FAUX_AO"),le&&Te.push("ZERO_ROOF_RADIUS");for(const Pe of _){const Ae=u.getTile(Pe),Re=Ae.getBucket(p);if(!Re||Re.projection.name!==G.projection.name)continue;const Ie=Re.programConfigurations.get(p.id),Ve=g.useProgram(X?"fillExtrusionPattern":"fillExtrusion",Ie,Te);if(g.terrain){const nt=g.terrain;if(g.style.terrainSetForDrapingOnly())nt.setupElevationDraw(Ae,Ve,{useMeterToDem:!0});else{if(!Re.enableTerrain)continue;if(nt.setupElevationDraw(Ae,Ve,{useMeterToDem:!0}),c0(I,u,Pe,Re,p,nt),!Re.centroidVertexBuffer){const yt=Ve.attributes.a_centroid_pos;yt!==void 0&&N.vertexAttrib2f(yt,0,0)}}}X&&(g.context.activeTexture.set(N.TEXTURE0),Ae.imageAtlasTexture.bind(N.LINEAR,N.CLAMP_TO_EDGE),Ie.updatePaintBuffers());const pt=V.constantOr(null);if(pt&&Ae.imageAtlas){const nt=Ae.imageAtlas.patternPositions[pt.toString()];nt&&Ie.setConstantPatternPositions(nt)}const $e=g.translatePosMatrix(Pe.projMatrix,Ae,p.paint.get("fill-extrusion-translate"),p.paint.get("fill-extrusion-translate-anchor")),it=G.projection.createInversionMatrix(G,Pe.canonical),He=p.paint.get("fill-extrusion-vertical-gradient"),ft=X?r0($e,g,He,ie,ae,he,Pe,Ae,J,me,ge,it):ig($e,g,He,ie,ae,he,Pe,J,me,ge,it);g.prepareDrawProgram(I,Ve,Pe.toUnwrapped());const Ue=[];g.terrain&&Ue.push(Re.centroidVertexBuffer),se&&Ue.push(Re.layoutVertexExtBuffer),Ve.draw(I,I.gl.TRIANGLES,S,E,O,s.CullFaceMode.backCCW,ft,p.id,Re.layoutVertexBuffer,Re.indexBuffer,Re.segments,p.paint,g.transform.zoom,Ie,Ue)}}function c0(g,u,p,_,S,E){const O=[J=>{let se=J.canonical.x-1,me=J.wrap;return se<0&&(se=(1<<J.canonical.z)-1,me--),new s.OverscaledTileID(J.overscaledZ,me,J.canonical.z,se,J.canonical.y)},J=>{let se=J.canonical.x+1,me=J.wrap;return se===1<<J.canonical.z&&(se=0,me++),new s.OverscaledTileID(J.overscaledZ,me,J.canonical.z,se,J.canonical.y)},J=>new s.OverscaledTileID(J.overscaledZ,J.wrap,J.canonical.z,J.canonical.x,(J.canonical.y===0?1<<J.canonical.z:J.canonical.y)-1),J=>new s.OverscaledTileID(J.overscaledZ,J.wrap,J.canonical.z,J.canonical.x,J.canonical.y===(1<<J.canonical.z)-1?0:J.canonical.y+1)],I=J=>{const se=u.getSource().minzoom,me=Te=>{const Pe=u.getTileByID(Te);if(Pe&&Pe.hasData())return Pe.getBucket(S)},ge=[0,-1,1];for(const Te of ge){if(J.overscaledZ+Te<se)continue;const Pe=me(J.calculateScaledKey(J.overscaledZ+Te));if(Pe)return Pe}},N=[0,0,0],G=(J,se)=>(N[0]=Math.min(J.min.y,se.min.y),N[1]=Math.max(J.max.y,se.max.y),N[2]=s.EXTENT-se.min.x>J.max.x?se.min.x-s.EXTENT:J.max.x,N),V=(J,se)=>(N[0]=Math.min(J.min.x,se.min.x),N[1]=Math.max(J.max.x,se.max.x),N[2]=s.EXTENT-se.min.y>J.max.y?se.min.y-s.EXTENT:J.max.y,N),X=[(J,se)=>G(J,se),(J,se)=>G(se,J),(J,se)=>V(J,se),(J,se)=>V(se,J)],ie=new s.Point(0,0);let ae,ce,le;const he=(J,se,me,ge,Te)=>{const Pe=[[ge?me:J,ge?J:me,0],[ge?me:se,ge?se:me,0]],Ae=Te<0?s.EXTENT+Te:Te,Re=[ge?Ae:(J+se)/2,ge?(J+se)/2:Ae,0];return me===0&&Te<0||me!==0&&Te>0?E.getForTilePoints(le,[Re],!0,ce):Pe.push(Re),E.getForTilePoints(p,Pe,!0,ae),Math.max(Pe[0][2],Pe[1][2],Re[2])/E.exaggeration()};for(let J=0;J<4;J++){const se=(J<2?1:5)-J,me=_.borders[J];if(me.length===0)continue;const ge=le=O[J](p),Te=I(ge);if(!(Te&&Te instanceof s.FillExtrusionBucket&&Te.enableTerrain)||_.borderDoneWithNeighborZ[J]===Te.canonical.z&&Te.borderDoneWithNeighborZ[se]===_.canonical.z||(ce=E.findDEMTileFor(ge),!ce||!ce.dem))continue;if(!ae){const Ie=E.findDEMTileFor(p);if(!Ie||!Ie.dem)return;ae=Ie}const Pe=Te.borders[se];let Ae=0;const Re=Te.borderDoneWithNeighborZ[se]!==_.canonical.z;if(_.canonical.z===Te.canonical.z){for(let Ie=0;Ie<me.length;Ie++){const Ve=_.featuresOnBorder[me[Ie]],pt=Ve.borders[J];let $e;for(;Ae<Pe.length&&($e=Te.featuresOnBorder[Pe[Ae]],!($e.borders[se][1]>pt[0]+3));)Re&&Te.encodeCentroid(void 0,$e,!1),Ae++;if($e&&Ae<Pe.length){const it=Ae;let He=0;for(;!($e.borders[se][0]>pt[1]-3)&&(He++,++Ae!==Pe.length);)$e=Te.featuresOnBorder[Pe[Ae]];if($e=Te.featuresOnBorder[Pe[it]],Ve.intersectsCount()>1||$e.intersectsCount()>1||He!==1){He!==1&&(Ae=it),_.encodeCentroid(void 0,Ve,!1),Re&&Te.encodeCentroid(void 0,$e,!1);continue}const ft=X[J](Ve,$e),Ue=J%2?s.EXTENT-1:0;ie.x=he(ft[0],Math.min(s.EXTENT-1,ft[1]),Ue,J<2,ft[2]),ie.y=0,_.encodeCentroid(ie,Ve,!1),Re&&Te.encodeCentroid(ie,$e,!1)}else _.encodeCentroid(void 0,Ve,!1)}_.borderDoneWithNeighborZ[J]=Te.canonical.z,_.needsCentroidUpdate=!0,Re&&(Te.borderDoneWithNeighborZ[se]=_.canonical.z,Te.needsCentroidUpdate=!0)}else{for(const Ie of me)_.encodeCentroid(void 0,_.featuresOnBorder[Ie],!1);if(Re){for(const Ie of Pe)Te.encodeCentroid(void 0,Te.featuresOnBorder[Ie],!1);Te.borderDoneWithNeighborZ[se]=_.canonical.z,Te.needsCentroidUpdate=!0}_.borderDoneWithNeighborZ[J]=Te.canonical.z,_.needsCentroidUpdate=!0}}(_.needsCentroidUpdate||!_.centroidVertexBuffer&&_.centroidVertexArray.length!==0)&&_.uploadCentroid(g)}const Lc=new s.Color(1,0,0,1),WS=new s.Color(0,1,0,1),qS=new s.Color(0,0,1,1),HS=new s.Color(1,0,1,1),KS=new s.Color(0,1,1,1);function ZS(g,u,p){const _=g.context,S=g.transform,E=_.gl,O=S.projection.name==="globe",I=O?["PROJECTION_GLOBE_VIEW"]:null;let N=p.projMatrix;if(O&&s.globeToMercatorTransition(S.zoom)>0){const Ve=s.transitionTileAABBinECEF(p.canonical,S),pt=s.globeDenormalizeECEF(Ve);N=s.multiply(new Float32Array(16),S.globeMatrix,pt),s.multiply(N,S.projMatrix,N)}const G=g.useProgram("debug",null,I),V=u.getTileByID(p.key);g.terrain&&g.terrain.setupElevationDraw(V,G);const X=s.DepthMode.disabled,ie=s.StencilMode.disabled,ae=g.colorModeForRenderPass(),ce="$debug";_.activeTexture.set(E.TEXTURE0),g.emptyTexture.bind(E.LINEAR,E.CLAMP_TO_EDGE),O?V._makeGlobeTileDebugBuffers(g.context,S):V._makeDebugTileBoundsBuffers(g.context,S.projection);const le=V._tileDebugBuffer||g.debugBuffer,he=V._tileDebugIndexBuffer||g.debugIndexBuffer,J=V._tileDebugSegments||g.debugSegments;G.draw(_,E.LINE_STRIP,X,ie,ae,s.CullFaceMode.disabled,Hd(N,s.Color.red),ce,le,he,J,null,null,null,[V._globeTileDebugBorderBuffer]);const se=V.latestRawTileData,me=Math.floor((se&&se.byteLength||0)/1024),ge=u.getTile(p).tileSize,Te=512/Math.min(ge,512)*(p.overscaledZ/S.zoom)*.5;let Pe=p.canonical.toString();p.overscaledZ!==p.canonical.z&&(Pe+=` => ${p.overscaledZ}`),Pe+=` ${me}kb`,function(Ve,pt){Ve.initDebugOverlayCanvas();const $e=Ve.debugOverlayCanvas,it=Ve.context.gl,He=Ve.debugOverlayCanvas.getContext("2d");He.clearRect(0,0,$e.width,$e.height),He.shadowColor="white",He.shadowBlur=2,He.lineWidth=1.5,He.strokeStyle="white",He.textBaseline="top",He.font="bold 36px Open Sans, sans-serif",He.fillText(pt,5,5),He.strokeText(pt,5,5),Ve.debugOverlayTexture.update($e),Ve.debugOverlayTexture.bind(it.LINEAR,it.CLAMP_TO_EDGE)}(g,Pe);const Ae=V._tileDebugTextBuffer||g.debugBuffer,Re=V._tileDebugTextIndexBuffer||g.quadTriangleIndexBuffer,Ie=V._tileDebugTextSegments||g.debugSegments;G.draw(_,E.TRIANGLES,X,ie,s.ColorMode.alphaBlended,s.CullFaceMode.disabled,Hd(N,s.Color.transparent,Te),ce,Ae,Re,Ie,null,null,null,[V._globeTileDebugTextBuffer])}function u0(g,u,p,_){jc(g,0,u+p/2,g.transform.width,p,_)}function Jd(g,u,p,_){jc(g,u-p/2,0,p,g.transform.height,_)}function jc(g,u,p,_,S,E){const O=g.context,I=O.gl;I.enable(I.SCISSOR_TEST),I.scissor(u*s.exported.devicePixelRatio,p*s.exported.devicePixelRatio,_*s.exported.devicePixelRatio,S*s.exported.devicePixelRatio),O.clear({color:E}),I.disable(I.SCISSOR_TEST)}const h0=s.createLayout([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:d0}=h0;function da(g,u,p,_){g.emplaceBack(u,p,_)}class Qd{constructor(u){this.vertexArray=new s.StructArrayLayout3f12,this.indices=new s.StructArrayLayout3ui6,da(this.vertexArray,-1,-1,1),da(this.vertexArray,1,-1,1),da(this.vertexArray,-1,1,1),da(this.vertexArray,1,1,1),da(this.vertexArray,-1,-1,-1),da(this.vertexArray,1,-1,-1),da(this.vertexArray,-1,1,-1),da(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=u.createVertexBuffer(this.vertexArray,d0),this.indexBuffer=u.createIndexBuffer(this.indices),this.segment=s.SegmentVector.simpleSegment(0,0,36,12)}}function Vo(g,u,p,_,S,E){const O=g.gl,I=u.paint.get("sky-atmosphere-color"),N=u.paint.get("sky-atmosphere-halo-color"),G=u.paint.get("sky-atmosphere-sun-intensity"),V=((X,ie,ae,ce,le)=>({u_matrix_3f:X,u_sun_direction:ie,u_sun_intensity:ae,u_color_tint_r:[ce.r,ce.g,ce.b,ce.a],u_color_tint_m:[le.r,le.g,le.b,le.a],u_luminance:5e-5}))(s.fromMat4(s.create$1(),_),S,G,I,N);O.framebufferTexture2D(O.FRAMEBUFFER,O.COLOR_ATTACHMENT0,O.TEXTURE_CUBE_MAP_POSITIVE_X+E,u.skyboxTexture,0),p.draw(g,O.TRIANGLES,s.DepthMode.disabled,s.StencilMode.disabled,s.ColorMode.unblended,s.CullFaceMode.frontCW,V,"skyboxCapture",u.skyboxGeometry.vertexBuffer,u.skyboxGeometry.indexBuffer,u.skyboxGeometry.segment)}const hh=s.createLayout([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class f0{constructor(u){const p=new s.StructArrayLayout5f20;p.emplaceBack(-1,1,1,0,0),p.emplaceBack(1,1,1,1,0),p.emplaceBack(1,-1,1,1,1),p.emplaceBack(-1,-1,1,0,1);const _=new s.StructArrayLayout3ui6;_.emplaceBack(0,1,2),_.emplaceBack(2,3,0),this.vertexBuffer=u.createVertexBuffer(p,hh.members),this.indexBuffer=u.createIndexBuffer(_),this.segments=s.SegmentVector.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const jl={symbol:function(g,u,p,_,S){if(g.renderPass!=="translucent")return;const E=s.StencilMode.disabled,O=g.colorModeForRenderPass();p.layout.get("text-variable-anchor")&&function(I,N,G,V,X,ie,ae){const ce=N.transform,le=X==="map",he=ie==="map";for(const J of I){const se=V.getTile(J),me=se.getBucket(G);if(!me||!me.text||!me.text.segments.get().length)continue;const ge=s.evaluateSizeForZoom(me.textSizeData,ce.zoom),Te=yn(J,me.getProjection(),ce),Pe=ce.calculatePixelsToTileUnitsMatrix(se),Ae=Xe(Te,se.tileID.canonical,he,le,ce,me.getProjection(),Pe),Re=G.layout.get("icon-text-fit")!=="none"&&me.hasIconData();if(ge){const Ie=Math.pow(2,ce.zoom-se.tileID.overscaledZ);GS(me,le,he,ae,s.symbolSize,ce,Ae,J,Ie,ge,Re)}}}(_,g,p,u,p.layout.get("text-rotation-alignment"),p.layout.get("text-pitch-alignment"),S),p.paint.get("icon-opacity").constantOr(1)!==0&&a0(g,u,p,_,!1,p.paint.get("icon-translate"),p.paint.get("icon-translate-anchor"),p.layout.get("icon-rotation-alignment"),p.layout.get("icon-pitch-alignment"),p.layout.get("icon-keep-upright"),E,O),p.paint.get("text-opacity").constantOr(1)!==0&&a0(g,u,p,_,!0,p.paint.get("text-translate"),p.paint.get("text-translate-anchor"),p.layout.get("text-rotation-alignment"),p.layout.get("text-pitch-alignment"),p.layout.get("text-keep-upright"),E,O),u.map.showCollisionBoxes&&(ch(g,u,p,_,p.paint.get("text-translate"),p.paint.get("text-translate-anchor"),!0),ch(g,u,p,_,p.paint.get("icon-translate"),p.paint.get("icon-translate-anchor"),!1))},circle:function(g,u,p,_){if(g.renderPass!=="translucent")return;const S=p.paint.get("circle-opacity"),E=p.paint.get("circle-stroke-width"),O=p.paint.get("circle-stroke-opacity"),I=p.layout.get("circle-sort-key").constantOr(1)!==void 0;if(S.constantOr(1)===0&&(E.constantOr(1)===0||O.constantOr(1)===0))return;const N=g.context,G=N.gl,V=g.transform,X=g.depthModeForSublayer(0,s.DepthMode.ReadOnly),ie=s.StencilMode.disabled,ae=g.colorModeForRenderPass(),ce=V.projection.name==="globe",le=[s.mercatorXfromLng(V.center.lng),s.mercatorYfromLat(V.center.lat)],he=[];for(let se=0;se<_.length;se++){const me=_[se],ge=u.getTile(me),Te=ge.getBucket(p);if(!Te||Te.projection.name!==V.projection.name)continue;const Pe=Te.programConfigurations.get(p.id),Ae=ag(p);ce&&Ae.push("PROJECTION_GLOBE_VIEW");const Re=g.useProgram("circle",Pe,Ae),Ie=Te.layoutVertexBuffer,Ve=Te.globeExtVertexBuffer,pt=Te.indexBuffer,$e=V.projection.createInversionMatrix(V,me.canonical),it={programConfiguration:Pe,program:Re,layoutVertexBuffer:Ie,globeExtVertexBuffer:Ve,indexBuffer:pt,uniformValues:sg(g,me,ge,$e,le,p),tile:ge};if(I){const He=Te.segments.get();for(const ft of He)he.push({segments:new s.SegmentVector([ft]),sortKey:ft.sortKey,state:it})}else he.push({segments:Te.segments,sortKey:0,state:it})}I&&he.sort((se,me)=>se.sortKey-me.sortKey);const J={useDepthForOcclusion:!ce};for(const se of he){const{programConfiguration:me,program:ge,layoutVertexBuffer:Te,globeExtVertexBuffer:Pe,indexBuffer:Ae,uniformValues:Re,tile:Ie}=se.state,Ve=se.segments;g.terrain&&g.terrain.setupElevationDraw(Ie,ge,J),g.prepareDrawProgram(N,ge,Ie.tileID.toUnwrapped()),ge.draw(N,G.TRIANGLES,X,ie,ae,s.CullFaceMode.disabled,Re,p.id,Te,Ae,Ve,p.paint,V.zoom,me,[Pe])}},heatmap:function(g,u,p,_){if(p.paint.get("heatmap-opacity")!==0)if(g.renderPass==="offscreen"){const S=g.context,E=S.gl,O=s.StencilMode.disabled,I=new s.ColorMode([E.ONE,E.ONE],s.Color.transparent,[!0,!0,!0,!0]);(function(ae,ce,le,he){const J=ae.gl,se=ce.width*he,me=ce.height*he;ae.activeTexture.set(J.TEXTURE1),ae.viewport.set([0,0,se,me]);let ge=le.heatmapFbo;if(!ge||ge&&(ge.width!==se||ge.height!==me)){ge&&ge.destroy();const Te=J.createTexture();J.bindTexture(J.TEXTURE_2D,Te),J.texParameteri(J.TEXTURE_2D,J.TEXTURE_WRAP_S,J.CLAMP_TO_EDGE),J.texParameteri(J.TEXTURE_2D,J.TEXTURE_WRAP_T,J.CLAMP_TO_EDGE),J.texParameteri(J.TEXTURE_2D,J.TEXTURE_MIN_FILTER,J.LINEAR),J.texParameteri(J.TEXTURE_2D,J.TEXTURE_MAG_FILTER,J.LINEAR),ge=le.heatmapFbo=ae.createFramebuffer(se,me,!1),function(Pe,Ae,Re,Ie,Ve,pt){const $e=Pe.gl;$e.texImage2D($e.TEXTURE_2D,0,Pe.isWebGL2&&Pe.extRenderToTextureHalfFloat?$e.RGBA16F:$e.RGBA,Ve,pt,0,$e.RGBA,Pe.extRenderToTextureHalfFloat?Pe.isWebGL2?$e.HALF_FLOAT:Pe.extTextureHalfFloat.HALF_FLOAT_OES:$e.UNSIGNED_BYTE,null),Ie.colorAttachment.set(Re)}(ae,0,Te,ge,se,me)}else J.bindTexture(J.TEXTURE_2D,ge.colorAttachment.get()),ae.bindFramebuffer.set(ge.framebuffer)})(S,g,p,g.transform.projection.name==="globe"?.5:.25),S.clear({color:s.Color.transparent});const N=g.transform,G=N.projection.name==="globe",V=G?["PROJECTION_GLOBE_VIEW"]:null,X=G?s.CullFaceMode.frontCCW:s.CullFaceMode.disabled,ie=[s.mercatorXfromLng(N.center.lng),s.mercatorYfromLat(N.center.lat)];for(let ae=0;ae<_.length;ae++){const ce=_[ae];if(u.hasRenderableParent(ce))continue;const le=u.getTile(ce),he=le.getBucket(p);if(!he||he.projection.name!==N.projection.name)continue;const J=he.programConfigurations.get(p.id),se=g.useProgram("heatmap",J,V),{zoom:me}=g.transform;g.terrain&&g.terrain.setupElevationDraw(le,se),g.prepareDrawProgram(S,se,ce.toUnwrapped());const ge=N.projection.createInversionMatrix(N,ce.canonical);se.draw(S,E.TRIANGLES,s.DepthMode.disabled,O,I,X,i0(g,ce,le,ge,ie,me,p.paint.get("heatmap-intensity")),p.id,he.layoutVertexBuffer,he.indexBuffer,he.segments,p.paint,g.transform.zoom,J,G?[he.globeExtVertexBuffer]:null)}S.viewport.set([0,0,g.width,g.height])}else g.renderPass==="translucent"&&(g.context.setColorMode(g.colorModeForRenderPass()),function(S,E){const O=S.context,I=O.gl,N=E.heatmapFbo;if(!N)return;O.activeTexture.set(I.TEXTURE0),I.bindTexture(I.TEXTURE_2D,N.colorAttachment.get()),O.activeTexture.set(I.TEXTURE1);let G=E.colorRampTexture;G||(G=E.colorRampTexture=new s.Texture(O,E.colorRamp,I.RGBA)),G.bind(I.LINEAR,I.CLAMP_TO_EDGE),S.useProgram("heatmapTexture").draw(O,I.TRIANGLES,s.DepthMode.disabled,s.StencilMode.disabled,S.colorModeForRenderPass(),s.CullFaceMode.disabled,((V,X,ie,ae)=>({u_image:0,u_color_ramp:1,u_opacity:X.paint.get("heatmap-opacity")}))(0,E),E.id,S.viewportBuffer,S.quadTriangleIndexBuffer,S.viewportSegments,E.paint,S.transform.zoom)}(g,p))},line:function(g,u,p,_){if(g.renderPass!=="translucent")return;const S=p.paint.get("line-opacity"),E=p.paint.get("line-width");if(S.constantOr(1)===0||E.constantOr(1)===0)return;const O=g.depthModeForSublayer(0,s.DepthMode.ReadOnly),I=g.colorModeForRenderPass(),N=g.terrain&&g.terrain.renderingToTexture?1:s.exported.devicePixelRatio,G=p.paint.get("line-dasharray"),V=G.constantOr(1),X=p.layout.get("line-cap"),ie=p.paint.get("line-pattern"),ae=ie.constantOr(1),ce=p.paint.get("line-gradient"),le=ae?"linePattern":"line",he=g.context,J=he.gl,se=(ge=>{const Te=[];lh(ge)&&Te.push("RENDER_LINE_DASH"),ge.paint.get("line-gradient")&&Te.push("RENDER_LINE_GRADIENT");const Pe=ge.paint.get("line-trim-offset");Pe[0]===0&&Pe[1]===0||Te.push("RENDER_LINE_TRIM_OFFSET");const Ae=ge.paint.get("line-pattern").constantOr(1),Re=ge.paint.get("line-opacity").constantOr(1)!==1;return!Ae&&Re&&Te.push("RENDER_LINE_ALPHA_DISCARD"),Te})(p);let me=se.includes("RENDER_LINE_ALPHA_DISCARD");g.terrain&&g.terrain.clipOrMaskOverlapStencilType()&&(me=!1);for(const ge of _){const Te=u.getTile(ge);if(ae&&!Te.patternsLoaded())continue;const Pe=Te.getBucket(p);if(!Pe)continue;g.prepareDrawTile();const Ae=Pe.programConfigurations.get(p.id),Re=g.useProgram(le,Ae,se),Ie=ie.constantOr(null);if(Ie&&Te.imageAtlas){const nt=Te.imageAtlas.patternPositions[Ie.toString()];nt&&Ae.setConstantPatternPositions(nt)}const Ve=G.constantOr(null),pt=X.constantOr(null);if(!ae&&Ve&&pt&&Te.lineAtlas){const nt=Te.lineAtlas.getDash(Ve,pt);nt&&Ae.setConstantPatternPositions(nt)}let[$e,it]=p.paint.get("line-trim-offset");(pt==="round"||pt==="square")&&$e!==it&&($e===0&&($e-=1),it===1&&(it+=1));const He=g.terrain?ge.projMatrix:null,ft=ae?ah(g,Te,p,He,N):US(g,Te,p,He,Pe.lineClipsArray.length,N,[$e,it]);if(ce){const nt=Pe.gradients[p.id];let yt=nt.texture;if(p.gradientVersion!==nt.version){let lt=256;if(p.stepInterpolant){const vt=u.getSource().maxzoom,Vt=ge.canonical.z===vt?Math.ceil(1<<g.transform.maxZoom-ge.canonical.z):1;lt=s.clamp(s.nextPowerOfTwo(Pe.maxLineLength/s.EXTENT*1024*Vt),256,he.maxTextureSize)}nt.gradient=s.renderColorRamp({expression:p.gradientExpression(),evaluationKey:"lineProgress",resolution:lt,image:nt.gradient||void 0,clips:Pe.lineClipsArray}),nt.texture?nt.texture.update(nt.gradient):nt.texture=new s.Texture(he,nt.gradient,J.RGBA),nt.version=p.gradientVersion,yt=nt.texture}he.activeTexture.set(J.TEXTURE1),yt.bind(p.stepInterpolant?J.NEAREST:J.LINEAR,J.CLAMP_TO_EDGE)}V&&(he.activeTexture.set(J.TEXTURE0),Te.lineAtlasTexture.bind(J.LINEAR,J.REPEAT),Ae.updatePaintBuffers()),ae&&(he.activeTexture.set(J.TEXTURE0),Te.imageAtlasTexture.bind(J.LINEAR,J.CLAMP_TO_EDGE),Ae.updatePaintBuffers()),g.prepareDrawProgram(he,Re,ge.toUnwrapped());const Ue=nt=>{Re.draw(he,J.TRIANGLES,O,nt,I,s.CullFaceMode.disabled,ft,p.id,Pe.layoutVertexBuffer,Pe.indexBuffer,Pe.segments,p.paint,g.transform.zoom,Ae,[Pe.layoutVertexBuffer2])};if(me){const nt=g.stencilModeForClipping(ge).ref;nt===0&&g.terrain&&he.clear({stencil:0});const yt={func:J.EQUAL,mask:255};ft.u_alpha_discard_threshold=.8,Ue(new s.StencilMode(yt,nt,255,J.KEEP,J.KEEP,J.INVERT)),ft.u_alpha_discard_threshold=0,Ue(new s.StencilMode(yt,nt,255,J.KEEP,J.KEEP,J.KEEP))}else Ue(g.stencilModeForClipping(ge))}me&&(g.resetStencilClippingMasks(),g.terrain&&he.clear({stencil:0}))},fill:function(g,u,p,_){const S=p.paint.get("fill-color"),E=p.paint.get("fill-opacity");if(E.constantOr(1)===0)return;const O=g.colorModeForRenderPass(),I=p.paint.get("fill-pattern"),N=g.opaquePassEnabledForLayer()&&!I.constantOr(1)&&S.constantOr(s.Color.transparent).a===1&&E.constantOr(0)===1?"opaque":"translucent";if(g.renderPass===N){const G=g.depthModeForSublayer(1,g.renderPass==="opaque"?s.DepthMode.ReadWrite:s.DepthMode.ReadOnly);l0(g,u,p,_,G,O,!1)}if(g.renderPass==="translucent"&&p.paint.get("fill-antialias")){const G=g.depthModeForSublayer(p.getPaintProperty("fill-outline-color")?2:0,s.DepthMode.ReadOnly);l0(g,u,p,_,G,O,!0)}},"fill-extrusion":function(g,u,p,_){const S=p.paint.get("fill-extrusion-opacity");if(S!==0&&g.renderPass==="translucent"){const E=new s.DepthMode(g.context.gl.LEQUAL,s.DepthMode.ReadWrite,g.depthRangeFor3D);if(S!==1||p.paint.get("fill-extrusion-pattern").constantOr(1))Yd(g,u,p,_,E,s.StencilMode.disabled,s.ColorMode.disabled),Yd(g,u,p,_,E,g.stencilModeFor3D(),g.colorModeForRenderPass()),g.resetStencilClippingMasks();else{const O=g.colorModeForRenderPass();Yd(g,u,p,_,E,s.StencilMode.disabled,O)}}},hillshade:function(g,u,p,_){if(g.renderPass!=="offscreen"&&g.renderPass!=="translucent")return;const S=g.context,E=g.depthModeForSublayer(0,s.DepthMode.ReadOnly),O=g.colorModeForRenderPass(),I=g.terrain&&g.terrain.renderingToTexture,[N,G]=g.renderPass!=="translucent"||I?[{},_]:g.stencilConfigForOverlap(_);for(const V of G){const X=u.getTile(V);if(X.needsHillshadePrepare&&g.renderPass==="offscreen")Q_(g,X,p,E,s.StencilMode.disabled,O);else if(g.renderPass==="translucent"){const ie=I&&g.terrain?g.terrain.stencilModeForRTTOverlap(V):N[V.overscaledZ];J_(g,V,X,p,E,ie,O)}}S.viewport.set([0,0,g.width,g.height]),g.resetStencilClippingMasks()},raster:function(g,u,p,_,S,E){if(g.renderPass!=="translucent"||p.paint.get("raster-opacity")===0||!_.length)return;const O=g.context,I=O.gl,N=u.getSource(),G=g.useProgram("raster"),V=g.colorModeForRenderPass(),X=g.terrain&&g.terrain.renderingToTexture,[ie,ae]=N instanceof mr||X?[{},_]:g.stencilConfigForOverlap(_),ce=ae[ae.length-1].overscaledZ,le=!g.options.moving;for(const he of ae){const J=X?s.DepthMode.disabled:g.depthModeForSublayer(he.overscaledZ-ce,p.paint.get("raster-opacity")===1?s.DepthMode.ReadWrite:s.DepthMode.ReadOnly,I.LESS),se=he.toUnwrapped(),me=u.getTile(he);if(X&&(!me||!me.hasData()))continue;const ge=X?he.projMatrix:g.transform.calculateProjMatrix(se,le),Te=g.terrain&&X?g.terrain.stencilModeForRTTOverlap(he):ie[he.overscaledZ],Pe=E?0:p.paint.get("raster-fade-duration");me.registerFadeDuration(Pe);const Ae=u.findLoadedParent(he,0),Re=tg(me,Ae,u,g.transform,Pe);let Ie,Ve;g.terrain&&g.terrain.prepareDrawTile();const pt=p.paint.get("raster-resampling")==="nearest"?I.NEAREST:I.LINEAR;O.activeTexture.set(I.TEXTURE0),me.texture.bind(pt,I.CLAMP_TO_EDGE),O.activeTexture.set(I.TEXTURE1),Ae?(Ae.texture.bind(pt,I.CLAMP_TO_EDGE),Ie=Math.pow(2,Ae.tileID.overscaledZ-me.tileID.overscaledZ),Ve=[me.tileID.canonical.x*Ie%1,me.tileID.canonical.y*Ie%1]):me.texture.bind(pt,I.CLAMP_TO_EDGE),me.texture.useMipmap&&O.extTextureFilterAnisotropic&&g.transform.pitch>20&&I.texParameterf(I.TEXTURE_2D,O.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,O.extTextureFilterAnisotropicMax);const $e=ug(ge,Ve||[0,0],Ie||1,Re,p,N instanceof mr?N.perspectiveTransform:[0,0]);if(g.prepareDrawProgram(O,G,se),N instanceof mr)N.boundsBuffer&&N.boundsSegments&&G.draw(O,I.TRIANGLES,J,s.StencilMode.disabled,V,s.CullFaceMode.disabled,$e,p.id,N.boundsBuffer,g.quadTriangleIndexBuffer,N.boundsSegments);else{const{tileBoundsBuffer:it,tileBoundsIndexBuffer:He,tileBoundsSegments:ft}=g.getTileBoundsBuffers(me);G.draw(O,I.TRIANGLES,J,Te,V,s.CullFaceMode.disabled,$e,p.id,it,He,ft)}}g.resetStencilClippingMasks()},background:function(g,u,p,_){const S=p.paint.get("background-color"),E=p.paint.get("background-opacity");if(E===0)return;const O=g.context,I=O.gl,N=g.transform,G=N.tileSize,V=p.paint.get("background-pattern");if(g.isPatternMissing(V))return;const X=!V&&S.a===1&&E===1&&g.opaquePassEnabledForLayer()?"opaque":"translucent";if(g.renderPass!==X)return;const ie=s.StencilMode.disabled,ae=g.depthModeForSublayer(0,X==="opaque"?s.DepthMode.ReadWrite:s.DepthMode.ReadOnly),ce=g.colorModeForRenderPass(),le=g.useProgram(V?"backgroundPattern":"background");let he,J=_;J||(he=g.getBackgroundTiles(),J=Object.values(he).map(se=>se.tileID)),V&&(O.activeTexture.set(I.TEXTURE0),g.imageManager.bind(g.context));for(const se of J){const me=se.toUnwrapped(),ge=_?se.projMatrix:g.transform.calculateProjMatrix(me);g.prepareDrawTile();const Te=u?u.getTile(se):he?he[se.key]:new s.Tile(se,G,N.zoom,g),Pe=V?VS(ge,E,g,V,{tileID:se,tileSize:G}):dg(ge,E,S);g.prepareDrawProgram(O,le,me);const{tileBoundsBuffer:Ae,tileBoundsIndexBuffer:Re,tileBoundsSegments:Ie}=g.getTileBoundsBuffers(Te);le.draw(O,I.TRIANGLES,ae,ie,ce,s.CullFaceMode.disabled,Pe,p.id,Ae,Re,Ie)}},sky:function(g,u,p){const _=g.transform,S=_.projection.name==="mercator"||_.projection.name==="globe"?1:s.smoothstep(7,8,_.zoom),E=p.paint.get("sky-opacity")*S;if(E===0)return;const O=g.context,I=p.paint.get("sky-type"),N=new s.DepthMode(O.gl.LEQUAL,s.DepthMode.ReadOnly,[0,1]),G=g.frameCounter/1e3%1;I==="atmosphere"?g.renderPass==="offscreen"?p.needsSkyboxCapture(g)&&(function(V,X,ie,ae){const ce=V.context,le=ce.gl;let he=X.skyboxFbo;if(!he){he=X.skyboxFbo=ce.createFramebuffer(32,32,!1),X.skyboxGeometry=new Qd(ce),X.skyboxTexture=ce.gl.createTexture(),le.bindTexture(le.TEXTURE_CUBE_MAP,X.skyboxTexture),le.texParameteri(le.TEXTURE_CUBE_MAP,le.TEXTURE_WRAP_S,le.CLAMP_TO_EDGE),le.texParameteri(le.TEXTURE_CUBE_MAP,le.TEXTURE_WRAP_T,le.CLAMP_TO_EDGE),le.texParameteri(le.TEXTURE_CUBE_MAP,le.TEXTURE_MIN_FILTER,le.LINEAR),le.texParameteri(le.TEXTURE_CUBE_MAP,le.TEXTURE_MAG_FILTER,le.LINEAR);for(let ge=0;ge<6;++ge)le.texImage2D(le.TEXTURE_CUBE_MAP_POSITIVE_X+ge,0,le.RGBA,32,32,0,le.RGBA,le.UNSIGNED_BYTE,null)}ce.bindFramebuffer.set(he.framebuffer),ce.viewport.set([0,0,32,32]);const J=X.getCenter(V,!0),se=V.useProgram("skyboxCapture"),me=new Float64Array(16);s.identity(me),s.rotateY(me,me,.5*-Math.PI),Vo(ce,X,se,me,J,0),s.identity(me),s.rotateY(me,me,.5*Math.PI),Vo(ce,X,se,me,J,1),s.identity(me),s.rotateX(me,me,.5*-Math.PI),Vo(ce,X,se,me,J,2),s.identity(me),s.rotateX(me,me,.5*Math.PI),Vo(ce,X,se,me,J,3),s.identity(me),Vo(ce,X,se,me,J,4),s.identity(me),s.rotateY(me,me,Math.PI),Vo(ce,X,se,me,J,5),ce.viewport.set([0,0,V.width,V.height])}(g,p),p.markSkyboxValid(g)):g.renderPass==="sky"&&function(V,X,ie,ae,ce){const le=V.context,he=le.gl,J=V.transform,se=V.useProgram("skybox");le.activeTexture.set(he.TEXTURE0),he.bindTexture(he.TEXTURE_CUBE_MAP,X.skyboxTexture);const me=((ge,Te,Pe,Ae,Re)=>({u_matrix:ge,u_sun_direction:Te,u_cubemap:0,u_opacity:Ae,u_temporal_offset:Re}))(J.skyboxMatrix,X.getCenter(V,!1),0,ae,ce);V.prepareDrawProgram(le,se),se.draw(le,he.TRIANGLES,ie,s.StencilMode.disabled,V.colorModeForRenderPass(),s.CullFaceMode.backCW,me,"skybox",X.skyboxGeometry.vertexBuffer,X.skyboxGeometry.indexBuffer,X.skyboxGeometry.segment)}(g,p,N,E,G):I==="gradient"&&g.renderPass==="sky"&&function(V,X,ie,ae,ce){const le=V.context,he=le.gl,J=V.transform,se=V.useProgram("skyboxGradient");X.skyboxGeometry||(X.skyboxGeometry=new Qd(le)),le.activeTexture.set(he.TEXTURE0);let me=X.colorRampTexture;me||(me=X.colorRampTexture=new s.Texture(le,X.colorRamp,he.RGBA)),me.bind(he.LINEAR,he.CLAMP_TO_EDGE);const ge=((Te,Pe,Ae,Re,Ie)=>({u_matrix:Te,u_color_ramp:0,u_center_direction:Pe,u_radius:s.degToRad(Ae),u_opacity:Re,u_temporal_offset:Ie}))(J.skyboxMatrix,X.getCenter(V,!1),X.paint.get("sky-gradient-radius"),ae,ce);V.prepareDrawProgram(le,se),se.draw(le,he.TRIANGLES,ie,s.StencilMode.disabled,V.colorModeForRenderPass(),s.CullFaceMode.backCW,ge,"skyboxGradient",X.skyboxGeometry.vertexBuffer,X.skyboxGeometry.indexBuffer,X.skyboxGeometry.segment)}(g,p,N,E,G)},debug:function(g,u,p){for(let _=0;_<p.length;_++)ZS(g,u,p[_])},custom:function(g,u,p,_){const S=g.context,E=p.implementation;if(!g.transform.projection.unsupportedLayers||!g.transform.projection.unsupportedLayers.includes("custom")||g.terrain&&(g.terrain.renderingToTexture||g.renderPass==="offscreen")&&p.isLayerDraped()){if(g.renderPass==="offscreen"){const O=E.prerender;if(O){if(g.setCustomLayerDefaults(),S.setColorMode(g.colorModeForRenderPass()),g.transform.projection.name==="globe"){const I=g.transform.pointMerc;O.call(E,S.gl,g.transform.customLayerMatrix(),g.transform.getProjection(),g.transform.globeToMercatorMatrix(),s.globeToMercatorTransition(g.transform.zoom),[I.x,I.y],g.transform.pixelsPerMeterRatio)}else O.call(E,S.gl,g.transform.customLayerMatrix());S.setDirty(),g.setBaseState()}}else if(g.renderPass==="translucent"){if(g.terrain&&g.terrain.renderingToTexture){const I=E.renderToTile;if(I){const N=_[0].canonical,G=new s.MercatorCoordinate(N.x+_[0].wrap*(1<<N.z),N.y,N.z);S.setDepthMode(s.DepthMode.disabled),S.setStencilMode(s.StencilMode.disabled),S.setColorMode(g.colorModeForRenderPass()),g.setCustomLayerDefaults(),I.call(E,S.gl,G),S.setDirty(),g.setBaseState()}return}g.setCustomLayerDefaults(),S.setColorMode(g.colorModeForRenderPass()),S.setStencilMode(s.StencilMode.disabled);const O=E.renderingMode==="3d"?new s.DepthMode(g.context.gl.LEQUAL,s.DepthMode.ReadWrite,g.depthRangeFor3D):g.depthModeForSublayer(0,s.DepthMode.ReadOnly);if(S.setDepthMode(O),g.transform.projection.name==="globe"){const I=g.transform.pointMerc;E.render(S.gl,g.transform.customLayerMatrix(),g.transform.getProjection(),g.transform.globeToMercatorMatrix(),s.globeToMercatorTransition(g.transform.zoom),[I.x,I.y],g.transform.pixelsPerMeterRatio)}else E.render(S.gl,g.transform.customLayerMatrix());S.setDirty(),g.setBaseState(),S.bindFramebuffer.set(null)}}else s.warnOnce("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")}};class zc{constructor(u,p,_=!1){this.context=new xt(u,_),this.transform=p,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.setup(),this.numSublayers=s.SourceCache.maxUnderzooming+s.SourceCache.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={}}updateTerrain(u,p){const _=!!u&&!!u.terrain&&this.transform.projection.supportsTerrain;if(!(_||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new ng(this,u));const S=this._terrain;this.transform.elevation=_?S:null,S.update(u,this.transform,p)}_updateFog(u){const p=u.fog;if(!p||this.transform.projection.name==="globe"||p.getOpacity(this.transform.pitch)<1||p.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[_,S]=p.getFovAdjustedRange(this.transform._fov);if(_>S)return void(this.transform.fogCullDistSq=null);const E=_+.78*(S-_);this.transform.fogCullDistSq=E*E}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled?this._terrain:null}resize(u,p){if(this.width=u*s.exported.devicePixelRatio,this.height=p*s.exported.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const _ of this.style.order)this.style._layers[_].resize()}setup(){const u=this.context,p=new s.StructArrayLayout2i4;p.emplaceBack(0,0),p.emplaceBack(s.EXTENT,0),p.emplaceBack(0,s.EXTENT),p.emplaceBack(s.EXTENT,s.EXTENT),this.tileExtentBuffer=u.createVertexBuffer(p,s.posAttributes.members),this.tileExtentSegments=s.SegmentVector.simpleSegment(0,0,4,2);const _=new s.StructArrayLayout2i4;_.emplaceBack(0,0),_.emplaceBack(s.EXTENT,0),_.emplaceBack(0,s.EXTENT),_.emplaceBack(s.EXTENT,s.EXTENT),this.debugBuffer=u.createVertexBuffer(_,s.posAttributes.members),this.debugSegments=s.SegmentVector.simpleSegment(0,0,4,5);const S=new s.StructArrayLayout2i4;S.emplaceBack(-1,-1),S.emplaceBack(1,-1),S.emplaceBack(-1,1),S.emplaceBack(1,1),this.viewportBuffer=u.createVertexBuffer(S,s.posAttributes.members),this.viewportSegments=s.SegmentVector.simpleSegment(0,0,4,2);const E=new s.StructArrayLayout4i8;E.emplaceBack(0,0,0,0),E.emplaceBack(s.EXTENT,0,s.EXTENT,0),E.emplaceBack(0,s.EXTENT,0,s.EXTENT),E.emplaceBack(s.EXTENT,s.EXTENT,s.EXTENT,s.EXTENT),this.mercatorBoundsBuffer=u.createVertexBuffer(E,s.boundsAttributes.members),this.mercatorBoundsSegments=s.SegmentVector.simpleSegment(0,0,4,2);const O=new s.StructArrayLayout3ui6;O.emplaceBack(0,1,2),O.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=u.createIndexBuffer(O);const I=new s.StructArrayLayout1ui2;for(const G of[0,1,3,2,0])I.emplaceBack(G);this.debugIndexBuffer=u.createIndexBuffer(I),this.emptyTexture=new s.Texture(u,new s.RGBAImage({width:1,height:1},Uint8Array.of(0,0,0,0)),u.gl.RGBA),this.identityMat=s.create();const N=this.context.gl;this.stencilClearMode=new s.StencilMode({func:N.ALWAYS,mask:0},0,255,N.ZERO,N.ZERO,N.ZERO),this.loadTimeStamps.push(s.window.performance.now()),this.atmosphereBuffer=new f0(this.context)}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(u){return u._makeTileBoundsBuffers(this.context,this.transform.projection),u._tileBoundsBuffer?{tileBoundsBuffer:u._tileBoundsBuffer,tileBoundsIndexBuffer:u._tileBoundsIndexBuffer,tileBoundsSegments:u._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const u=this.context,p=u.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.useProgram("clippingMask").draw(u,p.TRIANGLES,s.DepthMode.disabled,this.stencilClearMode,s.ColorMode.disabled,s.CullFaceMode.disabled,oh(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(u,p,_){if(!p||this.currentStencilSource===p.id||!u.isTileClipped()||!_||_.length===0)return;if(this._tileClippingMaskIDs&&!this.terrain){let I=!1;for(const N of _)if(this._tileClippingMaskIDs[N.key]===void 0){I=!0;break}if(!I)return}this.currentStencilSource=p.id;const S=this.context,E=S.gl;this.nextStencilID+_.length>256&&this.clearStencil(),S.setColorMode(s.ColorMode.disabled),S.setDepthMode(s.DepthMode.disabled);const O=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const I of _){const N=p.getTile(I),G=this._tileClippingMaskIDs[I.key]=this.nextStencilID++,{tileBoundsBuffer:V,tileBoundsIndexBuffer:X,tileBoundsSegments:ie}=this.getTileBoundsBuffers(N);O.draw(S,E.TRIANGLES,s.DepthMode.disabled,new s.StencilMode({func:E.ALWAYS,mask:0},G,255,E.KEEP,E.KEEP,E.REPLACE),s.ColorMode.disabled,s.CullFaceMode.disabled,oh(I.projMatrix),"$clipping",V,X,ie)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const u=this.nextStencilID++,p=this.context.gl;return new s.StencilMode({func:p.NOTEQUAL,mask:255},u,255,p.KEEP,p.KEEP,p.REPLACE)}stencilModeForClipping(u){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(u);const p=this.context.gl;return new s.StencilMode({func:p.EQUAL,mask:255},this._tileClippingMaskIDs[u.key],0,p.KEEP,p.KEEP,p.REPLACE)}stencilConfigForOverlap(u){const p=this.context.gl,_=u.sort((O,I)=>I.overscaledZ-O.overscaledZ),S=_[_.length-1].overscaledZ,E=_[0].overscaledZ-S+1;if(E>1){this.currentStencilSource=void 0,this.nextStencilID+E>256&&this.clearStencil();const O={};for(let I=0;I<E;I++)O[I+S]=new s.StencilMode({func:p.GEQUAL,mask:255},I+this.nextStencilID,255,p.KEEP,p.KEEP,p.REPLACE);return this.nextStencilID+=E,[O,_]}return[{[S]:s.StencilMode.disabled},_]}colorModeForRenderPass(){const u=this.context.gl;return this._showOverdrawInspector?new s.ColorMode([u.CONSTANT_COLOR,u.ONE],new s.Color(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?s.ColorMode.unblended:s.ColorMode.alphaBlended}depthModeForSublayer(u,p,_){if(!this.opaquePassEnabledForLayer())return s.DepthMode.disabled;const S=1-((1+this.currentLayer)*this.numSublayers+u)*this.depthEpsilon;return new s.DepthMode(_||this.context.gl.LEQUAL,p,[S,S])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(u,p){this.style=u,this.options=p,this.imageManager=u.imageManager,this.glyphManager=u.glyphManager,this.symbolFadeChange=u.placement.symbolFadeChange(s.exported.now()),this.imageManager.beginFrame();const _=this.style.order,S=this.style._sourceCaches;for(const G in S){const V=S[G];V.used&&V.prepare(this.context)}const E={},O={},I={};for(const G in S){const V=S[G];E[G]=V.getVisibleCoordinates(),O[G]=E[G].slice().reverse(),I[G]=V.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let G=0;G<_.length;G++)if(this.style._layers[_[G]].is3D()){this.opaquePassCutoff=G;break}if(this.terrain&&(this.terrain.updateTileBinding(I),this.opaquePassCutoff=0),this.transform.projection.name!=="globe"||this.globeSharedBuffers||(this.globeSharedBuffers=new s.GlobeSharedBuffers(this.context)),!s.isMapAuthenticated(this.context.gl))return;this.renderPass="offscreen";for(const G of _){const V=this.style._layers[G],X=u._getLayerSourceCache(V);if(!V.hasOffscreenPass()||V.isHidden(this.transform.zoom))continue;const ie=X?O[X.id]:void 0;(V.type==="custom"||V.isSky()||ie&&ie.length)&&this.renderLayer(this,X,V,ie)}this.depthRangeFor3D=[0,1-(u.order.length+2)*this.numSublayers*this.depthEpsilon];const N=this.terrain;if(N&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&N.drawDepth(),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]),this.context.clear({color:p.showOverdrawInspector?s.Color.black:s.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=p.showOverdrawInspector,this.renderPass="opaque",!this.terrain)for(this.currentLayer=_.length-1;this.currentLayer>=0;this.currentLayer--){const G=this.style._layers[_[this.currentLayer]],V=u._getLayerSourceCache(G);if(G.isSky())continue;const X=V?O[V.id]:void 0;this._renderTileClippingMasks(G,V,X),this.renderLayer(this,V,G,X)}if(this.style.fog&&this.transform.projection.supportsFog&&function(G,V){const X=G.context,ie=X.gl,ae=G.transform,ce=new s.DepthMode(ie.LEQUAL,s.DepthMode.ReadOnly,[0,1]),le=G.useProgram("globeAtmosphere",null,ae.projection.name==="globe"?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"]),he=s.globeToMercatorTransition(ae.zoom),J=V.properties.get("color").toArray01(),se=V.properties.get("high-color").toArray01(),me=V.properties.get("space-color").toArray01PremultipliedAlpha(),ge=s.identity$1([]);s.rotateY$1(ge,ge,-s.degToRad(ae._center.lng)),s.rotateX$1(ge,ge,s.degToRad(ae._center.lat)),s.rotateZ$1(ge,ge,ae.angle),s.rotateX$1(ge,ge,-ae._pitch);const Te=s.fromQuat(new Float32Array(16),ge),Pe=s.mapValue(V.properties.get("star-intensity"),0,1,0,.25),Ae=5e-4,Re=s.mapValue(V.properties.get("horizon-blend"),0,1,Ae,.25),Ie=s.globeUseCustomAntiAliasing(G,X,ae)&&Re===Ae?ae.worldSize/(2*Math.PI*1.025)-1:ae.globeRadius,Ve=G.frameCounter/1e3%1,pt=s.length(ae.globeCenterInViewSpace),$e=Math.sqrt(Math.pow(pt,2)-Math.pow(Ie,2)),it=Math.acos($e/pt),He=((Ue,nt,yt,lt,vt,Vt,ir,zt,Yt,br,yr,Nt,Fr,Wr)=>({u_frustum_tl:Ue,u_frustum_tr:nt,u_frustum_br:yt,u_frustum_bl:lt,u_horizon:vt,u_transition:Vt,u_fadeout_range:ir,u_color:zt,u_high_color:Yt,u_space_color:br,u_star_intensity:yr,u_star_size:5*s.exported.devicePixelRatio,u_star_density:0,u_temporal_offset:Nt,u_horizon_angle:Fr,u_rotation_matrix:Wr}))(ae.frustumCorners.TL,ae.frustumCorners.TR,ae.frustumCorners.BR,ae.frustumCorners.BL,ae.frustumCorners.horizon,he,Re,J,se,me,Pe,Ve,it,Te);G.prepareDrawProgram(X,le);const ft=G.atmosphereBuffer;ft&&le.draw(X,ie.TRIANGLES,ce,s.StencilMode.disabled,s.ColorMode.alphaBlended,s.CullFaceMode.backCW,He,"skybox",ft.vertexBuffer,ft.indexBuffer,ft.segments)}(this,this.style.fog),this.renderPass="sky",(s.globeToMercatorTransition(this.transform.zoom)>0||this.transform.projection.name!=="globe")&&this.transform.isHorizonVisible())for(this.currentLayer=0;this.currentLayer<_.length;this.currentLayer++){const G=this.style._layers[_[this.currentLayer]],V=u._getLayerSourceCache(G);G.isSky()&&this.renderLayer(this,V,G,V?O[V.id]:void 0)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<_.length;){const G=this.style._layers[_[this.currentLayer]],V=u._getLayerSourceCache(G);if(G.isSky()){++this.currentLayer;continue}if(this.terrain&&this.style.isLayerDraped(G)){if(G.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer);continue}const X=V?(G.type==="symbol"?I:O)[V.id]:void 0;this._renderTileClippingMasks(G,V,V?E[V.id]:void 0),this.renderLayer(this,V,G,X),++this.currentLayer}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let G=null;s.values(this.style._layers).forEach(V=>{const X=u._getLayerSourceCache(V);X&&!V.isHidden(this.transform.zoom)&&(!G||G.getSource().maxzoom<X.getSource().maxzoom)&&(G=X)}),G&&this.options.showTileBoundaries&&jl.debug(this,G,G.getVisibleCoordinates())}this.options.showPadding&&function(G){const V=G.transform.padding;u0(G,G.transform.height-(V.top||0),3,Lc),u0(G,V.bottom||0,3,WS),Jd(G,V.left||0,3,qS),Jd(G,G.transform.width-(V.right||0),3,HS);const X=G.transform.centerPoint;(function(ie,ae,ce,le){jc(ie,ae-1,ce-10,2,20,le),jc(ie,ae-10,ce-1,20,2,le)})(G,X.x,G.transform.height-X.y,KS)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(s.window.performance.now()),this.saveCanvasCopy())}renderLayer(u,p,_,S){_.isHidden(this.transform.zoom)||(_.type==="background"||_.type==="sky"||_.type==="custom"||S&&S.length)&&(this.id=_.id,this.gpuTimingStart(_),(!u.transform.projection.unsupportedLayers||!u.transform.projection.unsupportedLayers.includes(_.type)||u.terrain&&_.type==="custom")&&jl[_.type](u,p,_,S,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(u){if(!this.options.gpuTiming)return;const p=this.context.extTimerQuery;let _=this.gpuTimers[u.id];_||(_=this.gpuTimers[u.id]={calls:0,cpuTime:0,query:p.createQueryEXT()}),_.calls++,p.beginQueryEXT(p.TIME_ELAPSED_EXT,_.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const u=this.context.extTimerQuery,p=u.createQueryEXT();this.deferredRenderGpuTimeQueries.push(p),u.beginQueryEXT(u.TIME_ELAPSED_EXT,p)}}gpuTimingDeferredRenderEnd(){if(!this.options.gpuTimingDeferredRender)return;const u=this.context.extTimerQuery;u.endQueryEXT(u.TIME_ELAPSED_EXT)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const u=this.context.extTimerQuery;u.endQueryEXT(u.TIME_ELAPSED_EXT)}collectGpuTimers(){const u=this.gpuTimers;return this.gpuTimers={},u}collectDeferredRenderGpuQueries(){const u=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],u}queryGpuTimers(u){const p={};for(const _ in u){const S=u[_],E=this.context.extTimerQuery,O=E.getQueryObjectEXT(S.query,E.QUERY_RESULT_EXT)/1e6;E.deleteQueryEXT(S.query),p[_]=O}return p}queryGpuTimeDeferredRender(u){if(!this.options.gpuTimingDeferredRender)return 0;const p=this.context.extTimerQuery;let _=0;for(const S of u)_+=p.getQueryObjectEXT(S,p.QUERY_RESULT_EXT)/1e6,p.deleteQueryEXT(S);return _}translatePosMatrix(u,p,_,S,E){if(!_[0]&&!_[1])return u;const O=E?S==="map"?this.transform.angle:0:S==="viewport"?-this.transform.angle:0;if(O){const G=Math.sin(O),V=Math.cos(O);_=[_[0]*V-_[1]*G,_[0]*G+_[1]*V]}const I=[E?_[0]:at(p,_[0],this.transform.zoom),E?_[1]:at(p,_[1],this.transform.zoom),0],N=new Float32Array(16);return s.translate(N,u,I),N}saveTileTexture(u){const p=this._tileTextures[u.size[0]];p?p.push(u):this._tileTextures[u.size[0]]=[u]}getTileTexture(u){const p=this._tileTextures[u];return p&&p.length>0?p.pop():null}isPatternMissing(u){return u===null||u!==void 0&&!this.imageManager.getPattern(u.toString())}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture}currentGlobalDefines(){const u=this.terrain&&this.terrain.renderingToTexture,p=this.terrain&&this.terrain.exaggeration()===0,_=this.style&&this.style.fog,S=[];return this.terrainRenderModeElevated()&&S.push("TERRAIN"),this.transform.projection.name==="globe"&&S.push("GLOBE"),p&&S.push("ZERO_EXAGGERATION"),_&&!u&&_.getOpacity(this.transform.pitch)!==0&&S.push("FOG"),u&&S.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&S.push("OVERDRAW_INSPECTOR"),S}useProgram(u,p,_){this.cache=this.cache||{};const S=_||[],E=this.currentGlobalDefines().concat(S),O=Or.cacheKey(Ym[u],u,E,p);return this.cache[O]||(this.cache[O]=new Or(this.context,u,Ym[u],p,fg[u],E)),this.cache[O]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const u=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(u.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=s.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new s.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this.atmosphereBuffer&&this.atmosphereBuffer.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}prepareDrawProgram(u,p,_){if(this.terrain&&this.terrain.renderingToTexture)return;const S=this.style.fog;if(S){const E=S.getOpacity(this.transform.pitch),O=((I,N,G,V,X,ie,ae,ce,le,he,J)=>{const se=I.transform,me=N.properties.get("color").toArray01();me[3]=V;const ge=I.frameCounter/1e3%1;return{u_fog_matrix:G?se.calculateFogTileMatrix(G):I.identityMat,u_fog_range:N.getFovAdjustedRange(se._fov),u_fog_color:me,u_fog_horizon_blend:N.properties.get("horizon-blend"),u_fog_temporal_offset:ge,u_frustum_tl:X,u_frustum_tr:ie,u_frustum_br:ae,u_frustum_bl:ce,u_globe_pos:le,u_globe_radius:he,u_viewport:J,u_globe_transition:s.globeToMercatorTransition(se.zoom),u_is_globe:+(se.projection.name==="globe")}})(this,S,_,E,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*s.exported.devicePixelRatio,this.transform.height*s.exported.devicePixelRatio]);p.setFogUniformValues(u,O)}}setTileLoadedFlag(u){this.tileLoaded=u}saveCanvasCopy(){const u=this.canvasCopy();u&&(this.frameCopies.push(u),this.tileLoaded=!1)}canvasCopy(){const u=this.context.gl,p=u.createTexture();return u.bindTexture(u.TEXTURE_2D,p),u.copyTexImage2D(u.TEXTURE_2D,0,u.RGBA,0,0,u.drawingBufferWidth,u.drawingBufferHeight,0),p}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const u=this.style&&this.style.fog;return!!u&&u.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){const u=this._backgroundTiles,p=this._backgroundTiles={},_=this.transform.coveringTiles({tileSize:512});for(const S of _)p[S.key]=u[S.key]||new s.Tile(S,512,this.transform.tileZoom,this);return p}clearBackgroundTiles(){this._backgroundTiles={}}}class ef{constructor(u=0,p=0,_=0,S=0){if(isNaN(u)||u<0||isNaN(p)||p<0||isNaN(_)||_<0||isNaN(S)||S<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=u,this.bottom=p,this.left=_,this.right=S}interpolate(u,p,_){return p.top!=null&&u.top!=null&&(this.top=s.number(u.top,p.top,_)),p.bottom!=null&&u.bottom!=null&&(this.bottom=s.number(u.bottom,p.bottom,_)),p.left!=null&&u.left!=null&&(this.left=s.number(u.left,p.left,_)),p.right!=null&&u.right!=null&&(this.right=s.number(u.right,p.right,_)),this}getCenter(u,p){const _=s.clamp((this.left+u-this.right)/2,0,u),S=s.clamp((this.top+p-this.bottom)/2,0,p);return new s.Point(_,S)}equals(u){return this.top===u.top&&this.bottom===u.bottom&&this.left===u.left&&this.right===u.right}clone(){return new ef(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function tf(g,u){const p=s.getColumn(g,3);s.fromQuat(g,u),s.setColumn(g,3,p)}function Ir(g,u){const p=s.identity$1([]);return s.rotateZ$1(p,p,-u),s.rotateX$1(p,p,-g),p}function dh(g,u){const p=[g[0],g[1],0],_=[u[0],u[1],0];if(s.length(p)>=1e-15){const O=s.normalize([],p);s.scale$2(_,O,s.dot(_,O)),u[0]=_[0],u[1]=_[1]}const S=s.cross([],u,g);if(s.len(S)<1e-15)return null;const E=Math.atan2(-S[1],S[0]);return Ir(Math.atan2(Math.sqrt(g[0]*g[0]+g[1]*g[1]),-g[2]),E)}class p0{constructor(u,p){this.position=u,this.orientation=p}get position(){return this._position}set position(u){if(u){const p=u instanceof s.MercatorCoordinate?u:new s.MercatorCoordinate(u[0],u[1],u[2]);this._renderWorldCopies&&(p.x=s.wrap(p.x,0,1)),this._position=p}else this._position=null}lookAtPoint(u,p){if(this.orientation=null,!this.position)return;const _=this.position,S=this._elevation?this._elevation.getAtPointOrZero(s.MercatorCoordinate.fromLngLat(u)):0,E=s.MercatorCoordinate.fromLngLat(u,S),O=[E.x-_.x,E.y-_.y,E.z-_.z];p||(p=[0,0,1]),p[2]=Math.abs(p[2]),this.orientation=dh(O,p)}setPitchBearing(u,p){this.orientation=Ir(s.degToRad(u),s.degToRad(-p))}}class rf{constructor(u,p){this._transform=s.identity([]),this.orientation=p,this.position=u}get mercatorPosition(){const u=this.position;return new s.MercatorCoordinate(u[0],u[1],u[2])}get position(){const u=s.getColumn(this._transform,3);return[u[0],u[1],u[2]]}set position(u){var p;u&&s.setColumn(this._transform,3,[(p=u)[0],p[1],p[2],1])}get orientation(){return this._orientation}set orientation(u){this._orientation=u||s.identity$1([]),u&&tf(this._transform,this._orientation)}getPitchBearing(){const u=this.forward(),p=this.right();return{bearing:Math.atan2(-p[1],p[0]),pitch:Math.atan2(Math.sqrt(u[0]*u[0]+u[1]*u[1]),-u[2])}}setPitchBearing(u,p){this._orientation=Ir(u,p),tf(this._transform,this._orientation)}forward(){const u=s.getColumn(this._transform,2);return[-u[0],-u[1],-u[2]]}up(){const u=s.getColumn(this._transform,1);return[-u[0],-u[1],-u[2]]}right(){const u=s.getColumn(this._transform,0);return[u[0],u[1],u[2]]}getCameraToWorld(u,p){const _=new Float64Array(16);return s.invert(_,this.getWorldToCamera(u,p)),_}getWorldToCameraPosition(u,p,_){const S=this.position;s.scale$2(S,S,-u);const E=new Float64Array(16);return s.fromScaling(E,[_,_,_]),s.translate(E,E,S),E[10]*=p,E}getWorldToCamera(u,p){const _=new Float64Array(16),S=new Float64Array(4),E=this.position;return s.conjugate(S,this._orientation),s.scale$2(E,E,-u),s.fromQuat(_,S),s.translate(_,_,E),_[1]*=-1,_[5]*=-1,_[9]*=-1,_[13]*=-1,_[8]*=p,_[9]*=p,_[10]*=p,_[11]*=p,_}getCameraToClipPerspective(u,p,_,S){const E=new Float64Array(16);return s.perspective(E,u,p,_,S),E}getDistanceToElevation(u,p=!1){const _=u===0?0:s.mercatorZfromAltitude(u,p?s.latFromMercatorY(this.position[1]):this.position[1]),S=this.forward();return(_-this.position[2])/S[2]}clone(){return new rf([...this.position],[...this.orientation])}}function Bc(g,u){const p=nf(g.projection,g.zoom,g.width,g.height),_=function(E,O,I,N,G){const V=new s.LngLat(I.lng-180*fa,I.lat),X=new s.LngLat(I.lng+180*fa,I.lat),ie=E.project(V.lng,V.lat),ae=E.project(X.lng,X.lat),ce=-Math.atan2(ae.y-ie.y,ae.x-ie.x),le=s.MercatorCoordinate.fromLngLat(I);le.y=s.clamp(le.y,-1+fa,1-fa);const he=le.toLngLat(),J=E.project(he.lng,he.lat),se=s.MercatorCoordinate.fromLngLat(he);se.x+=fa;const me=se.toLngLat(),ge=E.project(me.lng,me.lat),Te=of(ge.x-J.x,ge.y-J.y,ce),Pe=s.MercatorCoordinate.fromLngLat(he);Pe.y+=fa;const Ae=Pe.toLngLat(),Re=E.project(Ae.lng,Ae.lat),Ie=of(Re.x-J.x,Re.y-J.y,ce),Ve=Math.abs(Te.x)/Math.abs(Ie.y),pt=s.identity([]);s.rotateZ(pt,pt,-ce*(1-(G?0:N)));const $e=s.identity([]);return s.scale($e,$e,[1,1-(1-Ve)*N,1]),$e[4]=-Ie.x/Ie.y*N,s.rotateZ($e,$e,ce),s.multiply($e,pt,$e),$e}(g.projection,0,g.center,p,u),S=m0(g);return s.scale(_,_,[S,S,1]),_}function m0(g){const u=g.projection,p=nf(g.projection,g.zoom,g.width,g.height),_=g0(u,g.center),S=g0(u,s.LngLat.convert(u.center));return Math.pow(2,_*p+(1-p)*S)}function nf(g,u,p,_,S=1/0){const E=g.range;if(!E)return 0;const O=Math.min(S,Math.max(p,_)),I=Math.log(O/1024)/Math.LN2;return s.smoothstep(E[0]+I,E[1]+I,u)}const fa=1/4e4;function g0(g,u){const p=s.clamp(u.lat,-s.MAX_MERCATOR_LATITUDE,s.MAX_MERCATOR_LATITUDE),_=new s.LngLat(u.lng-180*fa,p),S=new s.LngLat(u.lng+180*fa,p),E=g.project(_.lng,p),O=g.project(S.lng,p),I=s.MercatorCoordinate.fromLngLat(_),N=s.MercatorCoordinate.fromLngLat(S),G=O.x-E.x,V=O.y-E.y,X=N.x-I.x,ie=N.y-I.y,ae=Math.sqrt((X*X+ie*ie)/(G*G+V*V));return Math.log(ae)/Math.LN2}function of(g,u,p){const _=Math.cos(p),S=Math.sin(p);return{x:g*_-u*S,y:g*S+u*_}}class Nc{constructor(u,p,_,S,E,O,I){this.tileSize=512,this._renderWorldCopies=E===void 0||E,this._minZoom=u||0,this._maxZoom=p||22,this._minPitch=_??0,this._maxPitch=S??60,this.setProjection(O),this.setMaxBounds(I),this.width=0,this.height=0,this._center=new s.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new ef,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._distanceTileDataCache={},this._camera=new rf,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._horizonShift=.1}clone(){const u=new Nc(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return u._elevation=this._elevation,u._centerAltitude=this._centerAltitude,u._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,u.tileSize=this.tileSize,u.mercatorFromTransition=this.mercatorFromTransition,u.width=this.width,u.height=this.height,u.cameraElevationReference=this.cameraElevationReference,u._center=this._center,u._setZoom(this.zoom),u._seaLevelZoom=this._seaLevelZoom,u.angle=this.angle,u._fov=this._fov,u._pitch=this._pitch,u._nearZ=this._nearZ,u._farZ=this._farZ,u._averageElevation=this._averageElevation,u._unmodified=this._unmodified,u._edgeInsets=this._edgeInsets.clone(),u._camera=this._camera.clone(),u._calcMatrices(),u.freezeTileCoverage=this.freezeTileCoverage,u.frustumCorners=this.frustumCorners,u}get elevation(){return this._elevation}set elevation(u){this._elevation!==u&&(this._elevation=u,this._updateCameraOnTerrain(),this._calcMatrices())}updateElevation(u,p=!1){const _=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(this._seaLevelZoom==null||_)&&this._updateCameraOnTerrain(),(u||_)&&this._constrainCamera(p),this._calcMatrices()}getProjection(){return s.pick(this.projection,["name","center","parallels"])}setProjection(u){this.projectionOptions=u||{name:"mercator"};const p=this.projection?this.getProjection():void 0;this.projection=s.getProjection(this.projectionOptions);const _=!y(p,this.getProjection());return _&&this._calcMatrices(),this.mercatorFromTransition=!1,_}setMercatorFromTransition(){const u=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=s.getProjection({name:"mercator"});const p=u!==this.projection.name;return p&&this._calcMatrices(),p}get minZoom(){return this._minZoom}set minZoom(u){this._minZoom!==u&&(this._minZoom=u,this.zoom=Math.max(this.zoom,u))}get maxZoom(){return this._maxZoom}set maxZoom(u){this._maxZoom!==u&&(this._maxZoom=u,this.zoom=Math.min(this.zoom,u))}get minPitch(){return this._minPitch}set minPitch(u){this._minPitch!==u&&(this._minPitch=u,this.pitch=Math.max(this.pitch,u))}get maxPitch(){return this._maxPitch}set maxPitch(u){this._maxPitch!==u&&(this._maxPitch=u,this.pitch=Math.min(this.pitch,u))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.supportsWorldCopies===!0}set renderWorldCopies(u){u===void 0?u=!0:u===null&&(u=!1),this._renderWorldCopies=u}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const u=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(u))}get cameraWorldSize(){const u=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(u))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return s.mercatorZfromAltitude(this.center.lat,this.cameraWorldSizeForFog)}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new s.Point(this.width,this.height)}get bearing(){return s.wrap(this.rotation,-180,180)}set bearing(u){this.rotation=u}get rotation(){return-this.angle/Math.PI*180}set rotation(u){const p=-u*Math.PI/180;var _;this.angle!==p&&(this._unmodified=!1,this.angle=p,this._calcMatrices(),this.rotationMatrix=(_=new s.ARRAY_TYPE(4),s.ARRAY_TYPE!=Float32Array&&(_[1]=0,_[2]=0),_[0]=1,_[3]=1,_),function(S,E,O){var I=E[0],N=E[1],G=E[2],V=E[3],X=Math.sin(O),ie=Math.cos(O);S[0]=I*ie+G*X,S[1]=N*ie+V*X,S[2]=I*-X+G*ie,S[3]=N*-X+V*ie}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(u){const p=s.clamp(u,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==p&&(this._unmodified=!1,this._pitch=p,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}get fovX(){return this._fov}get fovY(){const u=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/u)}set fov(u){u=Math.max(.01,Math.min(60,u)),this._fov!==u&&(this._unmodified=!1,this._fov=s.degToRad(u),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(u){this._averageElevation=u,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(u){const p=Math.min(Math.max(u,this.minZoom),this.maxZoom);this._zoom!==p&&(this._unmodified=!1,this._setZoom(p),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(u){this._zoom=u,this.scale=this.zoomScale(u),this.tileZoom=Math.floor(u),this.zoomFraction=u-this.tileZoom}_updateCameraOnTerrain(){if(!this._elevation||!this._elevation.isDataAvailableAtPoint(this.locationCoordinate(this.center)))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const u=this._elevation;this._centerAltitude=u.getAtPointOrZero(this.locationCoordinate(this.center)),this._centerAltitudeValidForExaggeration=u.exaggeration(),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){this._centerAltitudeValidForExaggeration!==void 0&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const u=this._elevation,p=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],_=this.horizonLineFromTop();let S=0,E=0;for(let O=0;O<p.length;O++){const I=new s.Point(p[O][0]*this.width,_+p[O][1]*(this.height-_)),N=u.pointCoordinate(I);if(!N)continue;const G=1/Math.hypot(N[0]-this._camera.position[0],N[1]-this._camera.position[1]);S+=N[3]*G,E+=G}return E===0?NaN:S/E}get center(){return this._center}set center(u){u.lat===this._center.lat&&u.lng===this._center.lng||(this._unmodified=!1,this._center=u,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._seaLevelZoom==null||!this._elevation)return;const u=this._seaLevelZoom,p=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),_=this.pixelsPerMeter/this.worldSize*p,S=this._mercatorZfromZoom(u),E=this._mercatorZfromZoom(this._maxZoom),O=Math.max(S-_,E);this._setZoom(this._zoomFromMercatorZ(O))}get padding(){return this._edgeInsets.toJSON()}set padding(u){this._edgeInsets.equals(u)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,u,1),this._calcMatrices())}computeZoomRelativeTo(u){const p=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,u.toAltitude()));let _;_=u.z<this._camera.position[2]?[p.x,p.y,p.z]:[u.x,u.y,u.z];const S=s.length(s.sub([],this._camera.position,_));return s.clamp(this._zoomFromMercatorZ(S),this._minZoom,this._maxZoom)}setFreeCameraOptions(u){if(!this.height||!u.position&&!u.orientation)return;this._updateCameraState();let p=!1;if(u.orientation&&!s.exactEquals(u.orientation,this._camera.orientation)&&(p=this._setCameraOrientation(u.orientation)),u.position){const _=[u.position.x,u.position.y,u.position.z];s.exactEquals$1(_,this._camera.position)||(this._setCameraPosition(_),p=!0)}p&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const u=this._camera.position,p=new p0;return p.position=new s.MercatorCoordinate(u[0],u[1],u[2]),p.orientation=this._camera.orientation,p._elevation=this.elevation,p._renderWorldCopies=this.renderWorldCopies,p}_setCameraOrientation(u){if(!s.length$1(u))return!1;s.normalize$1(u,u);const p=s.transformQuat([],[0,0,-1],u),_=s.transformQuat([],[0,-1,0],u);if(_[2]<0)return!1;const S=dh(p,_);return!!S&&(this._camera.orientation=S,!0)}_setCameraPosition(u){const p=this.zoomScale(this.minZoom)*this.tileSize,_=this.zoomScale(this.maxZoom)*this.tileSize,S=this.cameraToCenterDistance;u[2]=s.clamp(u[2],S/_,S/p),this._camera.position=u}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(u){return this._edgeInsets.equals(u)}interpolatePadding(u,p,_){this._unmodified=!1,this._edgeInsets.interpolate(u,p,_),this._constrain(),this._calcMatrices()}coveringZoomLevel(u){const p=(u.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/u.tileSize));return Math.max(0,p)}getVisibleUnwrappedCoordinates(u){const p=[new s.UnwrappedTileID(0,u)];if(this.renderWorldCopies){const _=this.pointCoordinate(new s.Point(0,0)),S=this.pointCoordinate(new s.Point(this.width,0)),E=this.pointCoordinate(new s.Point(this.width,this.height)),O=this.pointCoordinate(new s.Point(0,this.height)),I=Math.floor(Math.min(_.x,S.x,E.x,O.x)),N=Math.floor(Math.max(_.x,S.x,E.x,O.x)),G=1;for(let V=I-G;V<=N+G;V++)V!==0&&p.push(new s.UnwrappedTileID(V,u))}return p}coveringTiles(u){let p=this.coveringZoomLevel(u);const _=p,S=this.elevation&&!u.isTerrainDEM,E=this.projection.name==="mercator";if(u.minzoom!==void 0&&p<u.minzoom)return[];u.maxzoom!==void 0&&p>u.maxzoom&&(p=u.maxzoom);const O=this.locationCoordinate(this.center),I=this.center.lat,N=1<<p,G=[N*O.x,N*O.y,0],V=this.projection.name==="globe",X=!V,ie=s.Frustum.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,p,X),ae=V?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),ce=N*s.mercatorZfromAltitude(1,this.center.lat),le=this._camera.position[2]/s.mercatorZfromAltitude(1,this.center.lat),he=[N*ae.x,N*ae.y,le*(X?1:ce)],J=this.cameraToCenterDistance/u.tileSize*(u.roundZoom?1:.502),se=this.pitch<=60&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace?p:0,me=u.isTerrainDEM&&this._elevation?1e4*this._elevation.exaggeration():this._centerAltitude,ge=u.isTerrainDEM?-me:this._elevation?this._elevation.getMinElevationBelowMSL():0,Te=this.projection.isReprojectedInTileSpace?m0(this):1,Pe=Ue=>{const yt=new s.MercatorCoordinate(Ue.x+25e-6,Ue.y,Ue.z),lt=new s.MercatorCoordinate(Ue.x,Ue.y+25e-6,Ue.z),vt=Ue.toLngLat(),Vt=yt.toLngLat(),ir=lt.toLngLat(),zt=this.locationCoordinate(vt),Yt=this.locationCoordinate(Vt),br=this.locationCoordinate(ir),yr=Math.hypot(Yt.x-zt.x,Yt.y-zt.y),Nt=Math.hypot(br.x-zt.x,br.y-zt.y);return Math.sqrt(yr*Nt)*Te/25e-6},Ae=Ue=>{const nt=me,yt=ge;return{aabb:s.tileAABB(this,N,0,0,0,Ue,yt,nt,this.projection),zoom:0,x:0,y:0,minZ:yt,maxZ:nt,wrap:Ue,fullyVisible:!1}},Re=[];let Ie=[];const Ve=p,pt=u.reparseOverscaled?_:p,$e=Ue=>Ue*Ue,it=$e((le-this._centerAltitude)*ce),He=Ue=>{if(!this._elevation||!Ue.tileID||!E)return;const nt=this._elevation.getMinMaxForTile(Ue.tileID),yt=Ue.aabb;nt?(yt.min[2]=nt.min,yt.max[2]=nt.max,yt.center[2]=(yt.min[2]+yt.max[2])/2):(Ue.shouldSplit=ft(Ue),Ue.shouldSplit||(yt.min[2]=yt.max[2]=yt.center[2]=this._centerAltitude))},ft=Ue=>{if(Ue.zoom<se)return!0;if(Ue.zoom===Ve)return!1;if(Ue.shouldSplit!=null)return Ue.shouldSplit;const nt=Ue.aabb.distanceX(he),yt=Ue.aabb.distanceY(he);let lt=it,vt=1;if(V){lt=$e(Ue.aabb.distanceZ(he));const zt=Math.pow(2,Ue.zoom),Yt=s.latFromMercatorY((Ue.y+1)/zt),br=s.latFromMercatorY(Ue.y/zt),yr=Math.min(Math.max(I,Yt),br),Nt=s.circumferenceAtLatitude(yr)/s.circumferenceAtLatitude(I);if(vt=yr===I?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,Nt/this._mercatorScaleRatio),this.zoom<=s.GLOBE_ZOOM_THRESHOLD_MIN&&Ue.zoom===Ve-1&&Nt>=.9)return!0}else if(S&&(lt=$e(Ue.aabb.distanceZ(he)*ce)),this.projection.isReprojectedInTileSpace&&_<=5){const zt=Math.pow(2,Ue.zoom),Yt=Pe(new s.MercatorCoordinate((Ue.x+.5)/zt,(Ue.y+.5)/zt));vt=Yt>.85?1:Yt}const Vt=nt*nt+yt*yt+lt,ir=$e((1<<Ve-Ue.zoom)*J*vt*((zt,Yt)=>{if(Yt*$e(.707)<zt)return 1;const br=Math.sqrt(Yt/zt);return br/(1.4144271570014144+(Math.pow(1.1,br-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(lt,it),Vt));return Vt<ir};if(this.renderWorldCopies)for(let Ue=1;Ue<=3;Ue++)Re.push(Ae(-Ue)),Re.push(Ae(Ue));for(Re.push(Ae(0));Re.length>0;){const Ue=Re.pop(),nt=Ue.x,yt=Ue.y;let lt=Ue.fullyVisible;if(!lt){const vt=Ue.aabb.intersects(ie);if(vt===0)continue;lt=vt===2}if(Ue.zoom!==Ve&&ft(Ue))for(let vt=0;vt<4;vt++){const Vt=(nt<<1)+vt%2,ir=(yt<<1)+(vt>>1),zt={aabb:E?Ue.aabb.quadrant(vt):s.tileAABB(this,N,Ue.zoom+1,Vt,ir,Ue.wrap,Ue.minZ,Ue.maxZ,this.projection),zoom:Ue.zoom+1,x:Vt,y:ir,wrap:Ue.wrap,fullyVisible:lt,tileID:void 0,shouldSplit:void 0,minZ:Ue.minZ,maxZ:Ue.maxZ};S&&!V&&(zt.tileID=new s.OverscaledTileID(Ue.zoom+1===Ve?pt:Ue.zoom+1,Ue.wrap,Ue.zoom+1,Vt,ir),He(zt)),Re.push(zt)}else{const vt=Ue.zoom===Ve?pt:Ue.zoom;if(u.minzoom&&u.minzoom>vt)continue;const Vt=G[0]-(.5+nt+(Ue.wrap<<Ue.zoom))*(1<<p-Ue.zoom),ir=G[1]-.5-yt,zt=Ue.tileID?Ue.tileID:new s.OverscaledTileID(vt,Ue.wrap,Ue.zoom,nt,yt);Ie.push({tileID:zt,distanceSq:Vt*Vt+ir*ir})}}if(this.fogCullDistSq){const Ue=this.fogCullDistSq,nt=this.horizonLineFromTop();Ie=Ie.filter(yt=>{const lt=[0,0,0,1],vt=[s.EXTENT,s.EXTENT,0,1],Vt=this.calculateFogTileMatrix(yt.tileID.toUnwrapped());s.transformMat4$1(lt,lt,Vt),s.transformMat4$1(vt,vt,Vt);const ir=s.getAABBPointSquareDist(lt,vt);if(ir===0)return!0;let zt=!1;const Yt=this._elevation;if(Yt&&ir>Ue&&nt!==0){const br=this.calculateProjMatrix(yt.tileID.toUnwrapped());let yr;u.isTerrainDEM||(yr=Yt.getMinMaxForTile(yt.tileID)),yr||(yr={min:ge,max:me});const Nt=s.furthestTileCorner(this.rotation),Fr=[Nt[0]*s.EXTENT,Nt[1]*s.EXTENT,yr.max];s.transformMat4(Fr,Fr,br),zt=(1-Fr[1])*this.height*.5<nt}return ir<Ue||zt})}return Ie.sort((Ue,nt)=>Ue.distanceSq-nt.distanceSq).map(Ue=>Ue.tileID)}resize(u,p){this.width=u,this.height=p,this.pixelsToGLUnits=[2/u,-2/p],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(u){return Math.pow(2,u)}scaleZoom(u){return Math.log(u)/Math.LN2}project(u){const p=s.clamp(u.lat,-s.MAX_MERCATOR_LATITUDE,s.MAX_MERCATOR_LATITUDE),_=this.projection.project(u.lng,p);return new s.Point(_.x*this.worldSize,_.y*this.worldSize)}unproject(u){return this.projection.unproject(u.x/this.worldSize,u.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/s.mercatorZfromAltitude(1,this.center.lat)/this.worldSize}setLocationAtPoint(u,p){let _,S;const E=this.centerPoint;if(this.projection.name==="globe"){const I=this.worldSize;_=(p.x-E.x)/I,S=(p.y-E.y)/I}else{const I=this.pointCoordinate(p),N=this.pointCoordinate(E);_=I.x-N.x,S=I.y-N.y}const O=this.locationCoordinate(u);this.setLocation(new s.MercatorCoordinate(O.x-_,O.y-S))}setLocation(u){this.center=this.coordinateLocation(u),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(u){return this.projection.locationPoint(this,u)}locationPoint3D(u){return this.projection.locationPoint(this,u,!0)}pointLocation(u){return this.coordinateLocation(this.pointCoordinate(u))}pointLocation3D(u){return this.coordinateLocation(this.pointCoordinate3D(u))}locationCoordinate(u,p){const _=p?s.mercatorZfromAltitude(p,u.lat):void 0,S=this.projection.project(u.lng,u.lat);return new s.MercatorCoordinate(S.x,S.y,_)}coordinateLocation(u){return this.projection.unproject(u.x,u.y)}pointRayIntersection(u,p){const _=p??this._centerAltitude,S=[u.x,u.y,0,1],E=[u.x,u.y,1,1];s.transformMat4$1(S,S,this.pixelMatrixInverse),s.transformMat4$1(E,E,this.pixelMatrixInverse);const O=E[3];s.scale$1(S,S,1/S[3]),s.scale$1(E,E,1/O);const I=S[2],N=E[2];return{p0:S,p1:E,t:I===N?0:(_-I)/(N-I)}}screenPointToMercatorRay(u){const p=[u.x,u.y,0,1],_=[u.x,u.y,1,1];return s.transformMat4$1(p,p,this.pixelMatrixInverse),s.transformMat4$1(_,_,this.pixelMatrixInverse),s.scale$1(p,p,1/p[3]),s.scale$1(_,_,1/_[3]),p[2]=s.mercatorZfromAltitude(p[2],this._center.lat)*this.worldSize,_[2]=s.mercatorZfromAltitude(_[2],this._center.lat)*this.worldSize,s.scale$1(p,p,1/this.worldSize),s.scale$1(_,_,1/this.worldSize),new s.Ray([p[0],p[1],p[2]],s.normalize([],s.sub([],_,p)))}rayIntersectionCoordinate(u){const{p0:p,p1:_,t:S}=u,E=s.mercatorZfromAltitude(p[2],this._center.lat),O=s.mercatorZfromAltitude(_[2],this._center.lat);return new s.MercatorCoordinate(s.number(p[0],_[0],S)/this.worldSize,s.number(p[1],_[1],S)/this.worldSize,s.number(E,O,S))}pointCoordinate(u,p=this._centerAltitude){return this.projection.pointCoordinate(this,u.x,u.y,p)}pointCoordinate3D(u){if(!this.elevation)return this.pointCoordinate(u);let p=this.projection.pointCoordinate3D(this,u.x,u.y);if(p)return new s.MercatorCoordinate(p[0],p[1],p[2]);let _=0,S=this.horizonLineFromTop();if(u.y>S)return this.pointCoordinate(u);const E=.02*S,O=u.clone();for(let I=0;I<10&&S-_>E;I++){O.y=s.number(_,S,.66);const N=this.projection.pointCoordinate3D(this,O.x,O.y);N?(S=O.y,p=N):_=O.y}return p?new s.MercatorCoordinate(p[0],p[1],p[2]):this.pointCoordinate(u)}isPointAboveHorizon(u){return this.projection.isPointAboveHorizon(this,u)}isPointOnSurface(u){if(u.y<0||u.y>this.height||u.x<0||u.x>this.width)return!1;if(this.elevation||this.zoom>=s.GLOBE_ZOOM_THRESHOLD_MAX)return!this.isPointAboveHorizon(u);const p=this.pointCoordinate(u);return p.y>=0&&p.y<=1}_coordinatePoint(u,p){const _=p&&this.elevation?this.elevation.getAtPointOrZero(u,this._centerAltitude):this._centerAltitude,S=[u.x*this.worldSize,u.y*this.worldSize,_+u.toAltitude(),1];return s.transformMat4$1(S,S,this.pixelMatrix),S[3]>0?new s.Point(S[0]/S[3],S[1]/S[3]):new s.Point(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:u,left:p}=this._edgeInsets,_=this.height-this._edgeInsets.bottom,S=this.width-this._edgeInsets.right,E=this.pointLocation3D(new s.Point(p,u)),O=this.pointLocation3D(new s.Point(S,u)),I=this.pointLocation3D(new s.Point(S,_)),N=this.pointLocation3D(new s.Point(p,_));let G=Math.min(E.lng,O.lng,I.lng,N.lng),V=Math.max(E.lng,O.lng,I.lng,N.lng),X=Math.min(E.lat,O.lat,I.lat,N.lat),ie=Math.max(E.lat,O.lat,I.lat,N.lat);const ae=Math.pow(2,-this.zoom)/16*270,ce=this.projection.name==="globe"?1:4,le=(he,J,se,me,ge)=>{const Te=(he+se)/2,Pe=(J+me)/2,Ae=new s.Point(Te,Pe),{lng:Re,lat:Ie}=this.pointLocation3D(Ae),Ve=Math.max(0,G-Re,X-Ie,Re-V,Ie-ie);G=Math.min(G,Re),V=Math.max(V,Re),X=Math.min(X,Ie),ie=Math.max(ie,Ie),(ge<ce||Ve>ae)&&(le(he,J,Te,Pe,ge+1),le(Te,Pe,se,me,ge+1))};if(le(p,u,S,u,1),le(S,u,S,_,1),le(S,_,p,_,1),le(p,_,p,u,1),this.projection.name==="globe"){const[he,J]=s.polesInViewport(this);he?(ie=90,V=180,G=-180):J&&(X=-90,V=180,G=-180)}return new s.LngLatBounds(new s.LngLat(G,X),new s.LngLat(V,ie))}_getBoundsRectangular(u,p){const{top:_,left:S}=this._edgeInsets,E=this.height-this._edgeInsets.bottom,O=this.width-this._edgeInsets.right,I=new s.Point(S,_),N=new s.Point(O,_),G=new s.Point(O,E),V=new s.Point(S,E);let X=this.pointCoordinate(I,u),ie=this.pointCoordinate(N,u);const ae=this.pointCoordinate(G,p),ce=this.pointCoordinate(V,p),le=(he,J)=>(J.y-he.y)/(J.x-he.x);return X.y>1&&ie.y>=0?X=new s.MercatorCoordinate((1-ce.y)/le(ce,X)+ce.x,1):X.y<0&&ie.y<=1&&(X=new s.MercatorCoordinate(-ce.y/le(ce,X)+ce.x,0)),ie.y>1&&X.y>=0?ie=new s.MercatorCoordinate((1-ae.y)/le(ae,ie)+ae.x,1):ie.y<0&&X.y<=1&&(ie=new s.MercatorCoordinate(-ae.y/le(ae,ie)+ae.x,0)),new s.LngLatBounds().extend(this.coordinateLocation(X)).extend(this.coordinateLocation(ie)).extend(this.coordinateLocation(ce)).extend(this.coordinateLocation(ae))}_getBoundsRectangularTerrain(){const u=this.elevation;if(!u.visibleDemTiles.length||u.isUsingMockSource())return this._getBoundsRectangular(0,0);const p=u.visibleDemTiles.reduce((_,S)=>{if(S.dem){const E=S.dem.tree;_.min=Math.min(_.min,E.minimums[0]),_.max=Math.max(_.max,E.maximums[0])}return _},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(p.min*u.exaggeration(),p.max*u.exaggeration())}getBounds(){return this.projection.name==="mercator"||this.projection.name==="equirectangular"?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(u=!0){const p=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))+this.centerOffset.y,_=this.height/2-p*(1-this._horizonShift);return u?Math.max(0,_):_}getMaxBounds(){return this.maxBounds}setMaxBounds(u){this.maxBounds=u,this.minLat=-s.MAX_MERCATOR_LATITUDE,this.maxLat=s.MAX_MERCATOR_LATITUDE,this.minLng=-180,this.maxLng=180,u&&(this.minLat=u.getSouth(),this.maxLat=u.getNorth(),this.minLng=u.getWest(),this.maxLng=u.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=s.mercatorXfromLng(this.minLng)*this.tileSize,this.worldMaxX=s.mercatorXfromLng(this.maxLng)*this.tileSize,this.worldMinY=s.mercatorYfromLat(this.maxLat)*this.tileSize,this.worldMaxY=s.mercatorYfromLat(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(u,p){return this.projection.createTileMatrix(this,p,u)}calculateDistanceTileData(u){const p=u.key,_=this._distanceTileDataCache;if(_[p])return _[p];const S=u.canonical,E=1/this.height,O=this.cameraWorldSize,I=O/this.zoomScale(S.z),N=(S.x+Math.pow(2,S.z)*u.wrap)*I,G=S.y*I,V=this.point;V.x*=O/this.worldSize,V.y*=O/this.worldSize;const X=this.angle,ie=Math.sin(-X),ae=-Math.cos(-X);return _[p]={bearing:[ie,ae],center:[(V.x-N)*E,(V.y-G)*E],scale:I/s.EXTENT*E},_[p]}calculateFogTileMatrix(u){const p=u.key,_=this._fogTileMatrixCache;if(_[p])return _[p];const S=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,u);return s.multiply(S,this.worldToFogMatrix,S),_[p]=new Float32Array(S),_[p]}calculateProjMatrix(u,p=!1){const _=u.key,S=p?this._alignedProjMatrixCache:this._projMatrixCache;if(S[_])return S[_];const E=this.calculatePosMatrix(u,this.worldSize);return s.multiply(E,this.projection.isReprojectedInTileSpace?this.mercatorMatrix:p?this.alignedProjMatrix:this.projMatrix,E),S[_]=new Float32Array(E),S[_]}calculatePixelsToTileUnitsMatrix(u){const p=u.tileID.key,_=this._pixelsToTileUnitsCache;if(_[p])return _[p];const S=function(E,O){const{scale:I}=E.tileTransform,N=I*s.EXTENT/(E.tileSize*Math.pow(2,O.zoom-E.tileID.overscaledZ+E.tileID.canonical.z));return G=new Float32Array(4),ie=(V=O.inverseAdjustmentMatrix)[1],ae=V[2],ce=V[3],he=(X=[N,N])[1],G[0]=V[0]*(le=X[0]),G[1]=ie*le,G[2]=ae*he,G[3]=ce*he,G;var G,V,X,ie,ae,ce,le,he}(u,this);return _[p]=S,_[p]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if(this.projection.name==="globe"){const u=1/this.worldSize,p=s.fromScaling([],[u,u,u]);return s.multiply(p,p,this.globeMatrix),p}}recenterOnTerrain(){if(!this._elevation||this.projection.name==="globe")return;const u=this._elevation;this._updateCameraState();const p=s.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,_=this._computeCameraPosition(p),S=this._camera.forward(),E=s.mercatorZfromAltitude(1,this._center.lat);_[2]/=E,S[2]/=E,s.normalize(S,S);const O=u.raycast(_,S,u.exaggeration());if(O){const I=s.scaleAndAdd([],_,S,O),N=new s.MercatorCoordinate(I[0],I[1],s.mercatorZfromAltitude(I[2],s.latFromMercatorY(I[1]))),G=(N.z+s.length([N.x-_[0],N.y-_[1],N.z-_[2]*E]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(G),this._centerAltitude=N.toAltitude(),this._center=this.coordinateLocation(N),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(u=!1){if(!this._elevation)return;const p=this._elevation,_=s.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,S=this._computeCameraPosition(_),E=p.getAtPointOrZero(new s.MercatorCoordinate(...S)),O=this.pixelsPerMeter/this.worldSize*E,I=this._minimumHeightOverTerrain(),N=S[2]-O;if(N<=I)if(N<0||u){const G=this.locationCoordinate(this._center,this._centerAltitude),V=[S[0],S[1],G.z-S[2]],X=s.length(V);V[2]-=(I-N)/this._pixelsPerMercatorPixel;const ie=s.length(V);if(ie===0)return;s.scale$2(V,V,X/ie*this._pixelsPerMercatorPixel),this._camera.position=[S[0],S[1],G.z*this._pixelsPerMercatorPixel-V[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const u=this.projection.name==="globe"||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||u){const ie=this.center;return ie.lat=s.clamp(ie.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!u)&&(ie.lng=s.clamp(ie.lng,this.minLng,this.maxLng)),this.center=ie,void(this._constraining=!1)}const p=this._unmodified,{x:_,y:S}=this.point;let E=0,O=_,I=S;const N=this.width/2,G=this.height/2,V=this.worldMinY*this.scale,X=this.worldMaxY*this.scale;if(S-G<V&&(I=V+G),S+G>X&&(I=X-G),X-V<this.height&&(E=Math.max(E,this.height/(X-V)),I=(X+V)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const ie=this.worldMinX*this.scale,ae=this.worldMaxX*this.scale,ce=this.worldSize/2-(ie+ae)/2;O=(_+ce+this.worldSize)%this.worldSize-ce,O-N<ie&&(O=ie+N),O+N>ae&&(O=ae-N),ae-ie<this.width&&(E=Math.max(E,this.width/(ae-ie)),O=(ae+ie)/2)}O===_&&I===S||(this.center=this.unproject(new s.Point(O,I))),E&&(this.zoom+=this.scaleZoom(E)),this._constrainCamera(),this._unmodified=p,this._constraining=!1}_minZoomForBounds(){let u=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(u=Math.max(u,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),u}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const u=this.centerOffset,p=this.pixelsPerMeter;this.projection.name==="globe"&&(this._mercatorScaleRatio=s.mercatorZfromAltitude(1,this.center.lat)/s.mercatorZfromAltitude(1,s.GLOBE_SCALE_MATCH_LATITUDE));const _=nf(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,_),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const S=this.projection.zAxisUnit==="meters"?p:1,E=this._camera.getWorldToCamera(this.worldSize,S),O=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);O[8]=2*-u.x/this.width,O[9]=2*u.y/this.height;let I=s.mul([],O,E);if(this.projection.isReprojectedInTileSpace){const Pe=this.locationCoordinate(this.center),Ae=s.identity([]);s.translate(Ae,Ae,[Pe.x*this.worldSize,Pe.y*this.worldSize,0]),s.multiply(Ae,Ae,Bc(this)),s.translate(Ae,Ae,[-Pe.x*this.worldSize,-Pe.y*this.worldSize,0]),s.multiply(I,I,Ae),this.inverseAdjustmentMatrix=function(Re){const Ie=Bc(Re,!0);return ue([],[Ie[0],Ie[1],Ie[4],Ie[5]])}(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];this.mercatorMatrix=s.scale([],I,[this.worldSize,this.worldSize,this.worldSize/S,1]),this.projMatrix=I,this.invProjMatrix=s.invert(new Float64Array(16),this.projMatrix);const N=s.invert([],O);this.frustumCorners=s.FrustumCorners.fromInvProjectionMatrix(N,this.horizonLineFromTop(),this.height);const G=new Float32Array(16);s.identity(G),s.scale(G,G,[1,-1,1]),s.rotateX(G,G,this._pitch),s.rotateZ(G,G,this.angle);const V=s.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ),X=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;V[8]=2*-u.x/this.width,V[9]=2*(u.y+X)/this.height,this.skyboxMatrix=s.multiply(G,V,G);const ie=this.point,ae=ie.x,ce=ie.y,le=this.width%2/2,he=this.height%2/2,J=Math.cos(this.angle),se=Math.sin(this.angle),me=ae-Math.round(ae)+J*le+se*he,ge=ce-Math.round(ce)+J*he+se*le,Te=new Float64Array(I);if(s.translate(Te,Te,[me>.5?me-1:me,ge>.5?ge-1:ge,0]),this.alignedProjMatrix=Te,I=s.create(),s.scale(I,I,[this.width/2,-this.height/2,1]),s.translate(I,I,[1,-1,0]),this.labelPlaneMatrix=I,I=s.create(),s.scale(I,I,[1,-1,1]),s.translate(I,I,[-1,-1,0]),s.scale(I,I,[2/this.width,2/this.height,1]),this.glCoordMatrix=I,this.pixelMatrix=s.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),this._calcFogMatrices(),this._distanceTileDataCache={},I=s.invert(new Float64Array(16),this.pixelMatrix),!I)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=I,this.projection.name==="globe"||this.mercatorFromTransition){this.globeMatrix=s.calculateGlobeMatrix(this);const Pe=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=s.transformMat4(Pe,Pe,E),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=I;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const u=this.cameraWorldSizeForFog,p=this.cameraPixelsPerMeter,_=this._camera.position,S=1/this.height/this._pixelsPerMercatorPixel,E=[u,u,p];s.scale$2(E,E,S),s.scale$2(_,_,-1),s.multiply$2(_,_,E);const O=s.create();s.translate(O,O,_),s.scale(O,O,E),this.mercatorFogMatrix=O,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(u,p,S)}_computeCameraPosition(u){const p=(u=u||this.pixelsPerMeter)/this.pixelsPerMeter,_=this._camera.forward(),S=this.point,E=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*p-u/this.worldSize*this._centerAltitude;return[S.x/this.worldSize-_[0]*E,S.y/this.worldSize-_[1]*E,u/this.worldSize*this._centerAltitude-_[2]*E]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(u){const p=this._maxCameraBoundsDistance()*Math.cos(this._pitch),_=this._camera.position[2],S=u[2];let E=1;this.projection.wrap&&(this.center=this.center.wrap()),S>0&&(E=Math.min((p-_)/S,1)),this._camera.position=s.scaleAndAdd([],this._camera.position,u,E),this._updateStateFromCamera()}_updateStateFromCamera(){const u=this._camera.position,p=this._camera.forward(),{pitch:_,bearing:S}=this._camera.getPitchBearing(),E=s.mercatorZfromAltitude(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,O=this._mercatorZfromZoom(this._maxZoom)*Math.cos(s.degToRad(this._maxPitch)),I=Math.max((u[2]-E)/Math.cos(_),O),N=this._zoomFromMercatorZ(I);s.scaleAndAdd(u,u,p,I),this._pitch=s.clamp(_,s.degToRad(this.minPitch),s.degToRad(this.maxPitch)),this.angle=s.wrap(S,-Math.PI,Math.PI),this._setZoom(s.clamp(N,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new s.MercatorCoordinate(u[0],u[1],u[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(u){return Math.pow(2,u)*this.tileSize}_mercatorZfromZoom(u){return this.cameraToCenterDistance/this._worldSizeFromZoom(u)}_minimumHeightOverTerrain(){const u=Math.min((this._seaLevelZoom!=null?this._seaLevelZoom:this._zoom)+4,this._maxZoom);return this._mercatorZfromZoom(u)}_zoomFromMercatorZ(u){return this.scaleZoom(this.cameraToCenterDistance/(u*this.tileSize))}zoomFromMercatorZAdjusted(u){let p=0,_=s.GLOBE_ZOOM_THRESHOLD_MAX,S=0,E=1/0;for(;_-p>1e-6&&_>p;){const O=p+.5*(_-p),I=this.tileSize*Math.pow(2,O),N=this.getCameraToCenterDistance(this.projection,O,I),G=this.scaleZoom(N/(u*this.tileSize)),V=Math.abs(O-G);V<E&&(E=V,S=O),O<G?p=O:_=O}return S}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(s.warnOnce("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(u,p){const _=Math.min(u.x,p.x),S=Math.max(u.x,p.x),E=Math.min(u.y,p.y),O=Math.max(u.y,p.y);if(E<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;const I=[new s.Point(_,E),new s.Point(S,O),new s.Point(_,O),new s.Point(S,E)],N=this.renderWorldCopies?-3:0,G=this.renderWorldCopies?4:1;for(const V of I){const X=this.pointRayIntersection(V);if(X.t<0)return!0;const ie=this.rayIntersectionCoordinate(X);if(ie.x<N||ie.y<0||ie.x>G||ie.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+s.radToDeg(this.fovAboveCenter)>88||this.anyCornerOffEdge(new s.Point(0,0),new s.Point(this.width,this.height))}zoomDeltaToMovement(u,p){const _=s.length(s.sub([],this._camera.position,u)),S=this._zoomFromMercatorZ(_)+p;return _-this._mercatorZfromZoom(S)}getCameraPoint(){if(this.projection.name==="globe"){const u=function([p,_,S],E){const O=[p,_,S,1];s.transformMat4$1(O,O,E);const I=O[3]=Math.max(O[3],1e-6);return O[0]/=I,O[1]/=I,O[2]/=I,O}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new s.Point(u[0],u[1])}{const u=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new s.Point(0,u))}}getCameraToCenterDistance(u,p=this.zoom,_=this.worldSize){const S=nf(u,p,this.width,this.height,1024),E=u.pixelSpaceConversion(this.center.lat,_,S);return .5/Math.tan(.5*this._fov)*this.height*E}getWorldToCameraMatrix(){const u=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?this.pixelsPerMeter:1);return this.projection.name==="globe"&&s.multiply(u,u,this.globeMatrix),u}}function $c(g,u){let p=!1,_=null;const S=()=>{_=null,p&&(g(),_=setTimeout(S,u),p=!1)};return()=>(p=!0,_||S(),_)}class gg{constructor(u){this._hashName=u&&encodeURIComponent(u),s.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=$c(this._updateHashUnthrottled.bind(this),300)}addTo(u){return this._map=u,s.window.addEventListener("hashchange",this._onHashChange,!1),u.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),s.window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const u=this._map;if(!u)return"";const p=fh(u);if(this._hashName){const _=this._hashName;let S=!1;const E=s.window.location.hash.slice(1).split("&").map(O=>{const I=O.split("=")[0];return I===_?(S=!0,`${I}=${p}`):O}).filter(O=>O);return S||E.push(`${_}=${p}`),`#${E.join("&")}`}return`#${p}`}_getCurrentHash(){const u=s.window.location.hash.replace("#","");if(this._hashName){let p;return u.split("&").map(_=>_.split("=")).forEach(_=>{_[0]===this._hashName&&(p=_)}),(p&&p[1]||"").split("/")}return u.split("/")}_onHashChange(){const u=this._map;if(!u)return!1;const p=this._getCurrentHash();if(p.length>=3&&!p.some(_=>isNaN(_))){const _=u.dragRotate.isEnabled()&&u.touchZoomRotate.isEnabled()?+(p[3]||0):u.getBearing();return u.jumpTo({center:[+p[2],+p[1]],zoom:+p[0],bearing:_,pitch:+(p[4]||0)}),!0}return!1}_updateHashUnthrottled(){const u=s.window.location.href.replace(/(#.+)?$/,this.getHashString());s.window.history.replaceState(s.window.history.state,null,u)}}function fh(g,u){const p=g.getCenter(),_=Math.round(100*g.getZoom())/100,S=Math.ceil((_*Math.LN2+Math.log(512/360/.5))/Math.LN10),E=Math.pow(10,S),O=Math.round(p.lng*E)/E,I=Math.round(p.lat*E)/E,N=g.getBearing(),G=g.getPitch();let V=u?`/${O}/${I}/${_}`:`${_}/${I}/${O}`;return(N||G)&&(V+="/"+Math.round(10*N)/10),G&&(V+=`/${Math.round(G)}`),V}const ph={linearity:.3,easing:s.bezier(0,0,.3,1)},sf=s.extend({deceleration:2500,maxSpeed:1400},ph),af=s.extend({deceleration:20,maxSpeed:1400},ph),Rt=s.extend({deceleration:1e3,maxSpeed:360},ph),hs=s.extend({deceleration:1e3,maxSpeed:90},ph);class y0{constructor(u){this._map=u,this.clear()}clear(){this._inertiaBuffer=[]}record(u){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:s.exported.now(),settings:u})}_drainInertiaBuffer(){const u=this._inertiaBuffer,p=s.exported.now();for(;u.length>0&&p-u[0].time>160;)u.shift()}_onMoveEnd(u){if(this._map._prefersReducedMotion()||(this._drainInertiaBuffer(),this._inertiaBuffer.length<2))return;const p={zoom:0,bearing:0,pitch:0,pan:new s.Point(0,0),pinchAround:void 0,around:void 0};for(const{settings:E}of this._inertiaBuffer)p.zoom+=E.zoomDelta||0,p.bearing+=E.bearingDelta||0,p.pitch+=E.pitchDelta||0,E.panDelta&&p.pan._add(E.panDelta),E.around&&(p.around=E.around),E.pinchAround&&(p.pinchAround=E.pinchAround);const _=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,S={};if(p.pan.mag()){const E=gh(p.pan.mag(),_,s.extend({},sf,u||{}));S.offset=p.pan.mult(E.amount/p.pan.mag()),S.center=this._map.transform.center,mh(S,E)}if(p.zoom){const E=gh(p.zoom,_,af);S.zoom=this._map.transform.zoom+E.amount,mh(S,E)}if(p.bearing){const E=gh(p.bearing,_,Rt);S.bearing=this._map.transform.bearing+s.clamp(E.amount,-179,179),mh(S,E)}if(p.pitch){const E=gh(p.pitch,_,hs);S.pitch=this._map.transform.pitch+E.amount,mh(S,E)}if(S.zoom||S.bearing){const E=p.pinchAround===void 0?p.around:p.pinchAround;S.around=E?this._map.unproject(E):this._map.getCenter()}return this.clear(),S.noMoveStart=!0,S}}function mh(g,u){(!g.duration||g.duration<u.duration)&&(g.duration=u.duration,g.easing=u.easing)}function gh(g,u,p){const{maxSpeed:_,linearity:S,deceleration:E}=p,O=s.clamp(g*S/(u/1e3),-_,_),I=Math.abs(O)/(E*S);return{easing:p.easing,duration:1e3*I,amount:O*(I/2)}}class di extends s.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(u,p,_,S={}){const E=H(p.getCanvasContainer(),_),O=p.unproject(E);super(u,s.extend({point:E,lngLat:O,originalEvent:_},S)),this._defaultPrevented=!1,this.target=p}}class yh extends s.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(u,p,_){const S=u==="touchend"?_.changedTouches:_.touches,E=Y(p.getCanvasContainer(),S),O=E.map(N=>p.unproject(N)),I=E.reduce((N,G,V,X)=>N.add(G.div(X.length)),new s.Point(0,0));super(u,{points:E,point:I,lngLats:O,lngLat:p.unproject(I),originalEvent:_}),this._defaultPrevented=!1}}class lf extends s.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(u,p,_){super(u,{originalEvent:_}),this._defaultPrevented=!1}}class yg{constructor(u,p){this._map=u,this._clickTolerance=p.clickTolerance}reset(){this._mousedownPos=void 0}wheel(u){return this._firePreventable(new lf(u.type,this._map,u))}mousedown(u,p){return this._mousedownPos=p,this._firePreventable(new di(u.type,this._map,u))}mouseup(u){this._map.fire(new di(u.type,this._map,u))}preclick(u){const p=s.extend({},u);p.type="preclick",this._map.fire(new di(p.type,this._map,p))}click(u,p){this._mousedownPos&&this._mousedownPos.dist(p)>=this._clickTolerance||(this.preclick(u),this._map.fire(new di(u.type,this._map,u)))}dblclick(u){return this._firePreventable(new di(u.type,this._map,u))}mouseover(u){this._map.fire(new di(u.type,this._map,u))}mouseout(u){this._map.fire(new di(u.type,this._map,u))}touchstart(u){return this._firePreventable(new yh(u.type,this._map,u))}touchmove(u){this._map.fire(new yh(u.type,this._map,u))}touchend(u){this._map.fire(new yh(u.type,this._map,u))}touchcancel(u){this._map.fire(new yh(u.type,this._map,u))}_firePreventable(u){if(this._map.fire(u),u.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class cf{constructor(u){this._map=u}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(u){this._map.fire(new di(u.type,this._map,u))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new di("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(u){this._delayContextMenu?this._contextMenuEvent=u:this._map.fire(new di(u.type,this._map,u)),this._map.listens("contextmenu")&&u.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class v0{constructor(u,p){this._map=u,this._el=u.getCanvasContainer(),this._container=u.getContainer(),this._clickTolerance=p.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(u,p){this.isEnabled()&&u.shiftKey&&u.button===0&&(z(),this._startPos=this._lastPos=p,this._active=!0)}mousemoveWindow(u,p){if(!this._active)return;const _=p,S=this._startPos,E=this._lastPos;if(!S||!E||E.equals(_)||!this._box&&_.dist(S)<this._clickTolerance)return;this._lastPos=_,this._box||(this._box=k("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",u));const O=Math.min(S.x,_.x),I=Math.max(S.x,_.x),N=Math.min(S.y,_.y),G=Math.max(S.y,_.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${O}px,${N}px)`,this._box.style.width=I-O+"px",this._box.style.height=G-N+"px")})}mouseupWindow(u,p){if(!this._active)return;const _=this._startPos,S=p;if(_&&u.button===0){if(this.reset(),F(),_.x!==S.x||_.y!==S.y)return this._map.fire(new s.Event("boxzoomend",{originalEvent:u})),{cameraAnimation:E=>E.fitScreenCoordinates(_,S,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",u)}}keydown(u){this._active&&u.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",u))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),B(),delete this._startPos,delete this._lastPos}_fireEvent(u,p){return this._map.fire(new s.Event(u,{originalEvent:p}))}}function uf(g,u){const p={};for(let _=0;_<g.length;_++)p[g[_].identifier]=u[_];return p}class Fc{constructor(u){this.reset(),this.numTouches=u.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(u,p,_){(this.centroid||_.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===0&&(this.startTime=u.timeStamp),_.length===this.numTouches&&(this.centroid=function(S){const E=new s.Point(0,0);for(const O of S)E._add(O);return E.div(S.length)}(p),this.touches=uf(_,p)))}touchmove(u,p,_){if(this.aborted||!this.centroid)return;const S=uf(_,p);for(const E in this.touches){const O=S[E];(!O||O.dist(this.touches[E])>30)&&(this.aborted=!0)}}touchend(u,p,_){if((!this.centroid||u.timeStamp-this.startTime>500)&&(this.aborted=!0),_.length===0){const S=!this.aborted&&this.centroid;if(this.reset(),S)return S}}}class vg{constructor(u){this.singleTap=new Fc(u),this.numTaps=u.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(u,p,_){this.singleTap.touchstart(u,p,_)}touchmove(u,p,_){this.singleTap.touchmove(u,p,_)}touchend(u,p,_){const S=this.singleTap.touchend(u,p,_);if(S){const E=u.timeStamp-this.lastTime<500,O=!this.lastTap||this.lastTap.dist(S)<30;if(E&&O||this.reset(),this.count++,this.lastTime=u.timeStamp,this.lastTap=S,this.count===this.numTaps)return this.reset(),S}}}class XS{constructor(){this._zoomIn=new vg({numTouches:1,numTaps:2}),this._zoomOut=new vg({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(u,p,_){this._zoomIn.touchstart(u,p,_),this._zoomOut.touchstart(u,p,_)}touchmove(u,p,_){this._zoomIn.touchmove(u,p,_),this._zoomOut.touchmove(u,p,_)}touchend(u,p,_){const S=this._zoomIn.touchend(u,p,_),E=this._zoomOut.touchend(u,p,_);return S?(this._active=!0,u.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:O=>O.easeTo({duration:300,zoom:O.getZoom()+1,around:O.unproject(S)},{originalEvent:u})}):E?(this._active=!0,u.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:O=>O.easeTo({duration:300,zoom:O.getZoom()-1,around:O.unproject(E)},{originalEvent:u})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const _0={0:1,2:2};class Uc{constructor(u){this.reset(),this._clickTolerance=u.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(u,p){return!1}_move(u,p){return{}}mousedown(u,p){if(this._lastPoint)return;const _=te(u);this._correctButton(u,_)&&(this._lastPoint=p,this._eventButton=_)}mousemoveWindow(u,p){const _=this._lastPoint;if(_){if(u.preventDefault(),this._eventButton!=null&&function(S,E){const O=_0[E];return S.buttons===void 0||(S.buttons&O)!==O}(u,this._eventButton))this.reset();else if(this._moved||!(p.dist(_)<this._clickTolerance))return this._moved=!0,this._lastPoint=p,this._move(_,p)}}mouseupWindow(u){this._lastPoint&&te(u)===this._eventButton&&(this._moved&&F(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class _g extends Uc{mousedown(u,p){super.mousedown(u,p),this._lastPoint&&(this._active=!0)}_correctButton(u,p){return p===0&&!u.ctrlKey}_move(u,p){return{around:p,panDelta:p.sub(u)}}}class xg extends Uc{_correctButton(u,p){return p===0&&u.ctrlKey||p===2}_move(u,p){const _=.8*(p.x-u.x);if(_)return this._active=!0,{bearingDelta:_}}contextmenu(u){u.preventDefault()}}class bg extends Uc{_correctButton(u,p){return p===0&&u.ctrlKey||p===2}_move(u,p){const _=-.5*(p.y-u.y);if(_)return this._active=!0,{pitchDelta:_}}contextmenu(u){u.preventDefault()}}class hf{constructor(u,p){this._map=u,this._el=u.getCanvasContainer(),this._minTouches=1,this._clickTolerance=p.clickTolerance||1,this.reset(),s.bindAll(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new s.Point(0,0)}touchstart(u,p,_){return this._calculateTransform(u,p,_)}touchmove(u,p,_){if(this._active&&!(_.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(_.length===1&&!s.isFullscreen())return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return u.cancelable&&u.preventDefault(),this._calculateTransform(u,p,_)}}touchend(u,p,_){this._calculateTransform(u,p,_),this._active&&_.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(u,p,_){_.length>0&&(this._active=!0);const S=uf(_,p),E=new s.Point(0,0),O=new s.Point(0,0);let I=0;for(const G in S){const V=S[G],X=this._touches[G];X&&(E._add(V),O._add(V.sub(X)),I++,S[G]=V)}if(this._touches=S,I<this._minTouches||!O.mag())return;const N=O.div(I);return this._sum._add(N),this._sum.mag()<this._clickTolerance?void 0:{around:E.div(I),panDelta:N}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=k("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","null")},500)}}class vh{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(u){}_move(u,p,_){return{}}touchstart(u,p,_){this._firstTwoTouches||_.length<2||(this._firstTwoTouches=[_[0].identifier,_[1].identifier],this._start([p[0],p[1]]))}touchmove(u,p,_){const S=this._firstTwoTouches;if(!S)return;u.preventDefault();const[E,O]=S,I=_h(_,p,E),N=_h(_,p,O);if(!I||!N)return;const G=this._aroundCenter?null:I.add(N).div(2);return this._move([I,N],G,u)}touchend(u,p,_){if(!this._firstTwoTouches)return;const[S,E]=this._firstTwoTouches,O=_h(_,p,S),I=_h(_,p,E);O&&I||(this._active&&F(),this.reset())}touchcancel(){this.reset()}enable(u){this._enabled=!0,this._aroundCenter=!!u&&u.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function _h(g,u,p){for(let _=0;_<g.length;_++)if(g[_].identifier===p)return u[_]}function wg(g,u){return Math.log(g/u)/Math.LN2}class x0 extends vh{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(u){this._startDistance=this._distance=u[0].dist(u[1])}_move(u,p){const _=this._distance;if(this._distance=u[0].dist(u[1]),this._active||!(Math.abs(wg(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:wg(this._distance,_),pinchAround:p}}}function Sg(g,u){return 180*g.angleWith(u)/Math.PI}class b0 extends vh{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(u){this._startVector=this._vector=u[0].sub(u[1]),this._minDiameter=u[0].dist(u[1])}_move(u,p){const _=this._vector;if(this._vector=u[0].sub(u[1]),_&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:Sg(this._vector,_),pinchAround:p}}_isBelowThreshold(u){this._minDiameter=Math.min(this._minDiameter,u.mag());const p=25/(Math.PI*this._minDiameter)*360,_=this._startVector;if(!_)return!1;const S=Sg(u,_);return Math.abs(S)<p}}function tl(g){return Math.abs(g.y)>Math.abs(g.x)}class w0 extends vh{constructor(u){super(),this._map=u}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(u){this._lastPoints=u,tl(u[0].sub(u[1]))&&(this._valid=!1)}_move(u,p,_){const S=this._lastPoints;if(!S)return;const E=u[0].sub(S[0]),O=u[1].sub(S[1]);return this._map._cooperativeGestures&&!s.isFullscreen()&&_.touches.length<3||(this._valid=this.gestureBeginsVertically(E,O,_.timeStamp),!this._valid)?void 0:(this._lastPoints=u,this._active=!0,{pitchDelta:(E.y+O.y)/2*-.5})}gestureBeginsVertically(u,p,_){if(this._valid!==void 0)return this._valid;const S=u.mag()>=2,E=p.mag()>=2;if(!S&&!E)return;if(!S||!E)return this._firstMove==null&&(this._firstMove=_),_-this._firstMove<100&&void 0;const O=u.y>0==p.y>0;return tl(u)&&tl(p)&&O}}const S0={panStep:100,bearingStep:15,pitchStep:10};class YS{constructor(){const u=S0;this._panStep=u.panStep,this._bearingStep=u.bearingStep,this._pitchStep=u.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(u){if(u.altKey||u.ctrlKey||u.metaKey)return;let p=0,_=0,S=0,E=0,O=0;switch(u.keyCode){case 61:case 107:case 171:case 187:p=1;break;case 189:case 109:case 173:p=-1;break;case 37:u.shiftKey?_=-1:(u.preventDefault(),E=-1);break;case 39:u.shiftKey?_=1:(u.preventDefault(),E=1);break;case 38:u.shiftKey?S=1:(u.preventDefault(),O=-1);break;case 40:u.shiftKey?S=-1:(u.preventDefault(),O=1);break;default:return}return this._rotationDisabled&&(_=0,S=0),{cameraAnimation:I=>{const N=I.getZoom();I.easeTo({duration:300,easeId:"keyboardHandler",easing:T0,zoom:p?Math.round(N)+p*(u.shiftKey?2:1):N,bearing:I.getBearing()+_*this._bearingStep,pitch:I.getPitch()+S*this._pitchStep,offset:[-E*this._panStep,-O*this._panStep],center:I.getCenter()},{originalEvent:u})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function T0(g){return g*(2-g)}const Tg=4.000244140625;class E0{constructor(u,p){this._map=u,this._el=u.getCanvasContainer(),this._handler=p,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,s.bindAll(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(u){this._defaultZoomRate=u}setWheelZoomRate(u){this._wheelZoomRate=u}isEnabled(){return!!this._enabled}isActive(){return this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(u){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!u&&u.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(u){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(u.ctrlKey||u.metaKey||this.isZooming()||s.isFullscreen()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let p=u.deltaMode===s.window.WheelEvent.DOM_DELTA_LINE?40*u.deltaY:u.deltaY;const _=s.exported.now(),S=_-(this._lastWheelEventTime||0);this._lastWheelEventTime=_,p!==0&&p%Tg==0?this._type="wheel":p!==0&&Math.abs(p)<4?this._type="trackpad":S>400?(this._type=null,this._lastValue=p,this._timeout=setTimeout(this._onTimeout,40,u)):this._type||(this._type=Math.abs(S*p)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,p+=this._lastValue)),u.shiftKey&&p&&(p/=4),this._type&&(this._lastWheelEvent=u,this._delta-=p,this._active||this._start(u)),u.preventDefault()}_onTimeout(u){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(u)}_start(u){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const p=H(this._el,u);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:p,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const u=this._map.transform;this._type==="wheel"&&u.projection.wrap&&(u._center.lng>=180||u._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const p=()=>u._terrainEnabled()&&this._aroundCoord?u.computeZoomRelativeTo(this._aroundCoord):u.zoom;if(this._delta!==0){const N=this._type==="wheel"&&Math.abs(this._delta)>Tg?this._wheelZoomRate:this._defaultZoomRate;let G=2/(1+Math.exp(-Math.abs(this._delta*N)));this._delta<0&&G!==0&&(G=1/G);const V=p(),X=Math.pow(2,V),ie=typeof this._targetZoom=="number"?u.zoomScale(this._targetZoom):X;this._targetZoom=Math.min(u.maxZoom,Math.max(u.minZoom,u.scaleZoom(ie*G))),this._type==="wheel"&&(this._startZoom=V,this._easing=this._smoothOutEasing(200)),this._delta=0}const _=typeof this._targetZoom=="number"?this._targetZoom:p(),S=this._startZoom,E=this._easing;let O,I=!1;if(this._type==="wheel"&&S&&E){const N=Math.min((s.exported.now()-this._lastWheelEventTime)/200,1),G=E(N);O=s.number(S,_,G),N<1?this._frameId||(this._frameId=!0):I=!0}else O=_,I=!0;return this._active=!0,I&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!I,zoomDelta:O-p(),around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(u){let p=s.ease;if(this._prevEase){const _=this._prevEase,S=(s.exported.now()-_.start)/_.duration,E=_.easing(S+.01)-_.easing(S),O=.27/Math.sqrt(E*E+1e-4)*.01,I=Math.sqrt(.0729-O*O);p=s.bezier(O,I,.25,1)}return this._prevEase={start:s.exported.now(),duration:u,easing:p},p}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=k("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(s.window.navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","null")},200)}}class A0{constructor(u,p){this._clickZoom=u,this._tapZoom=p}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class $i{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(u,p){return u.preventDefault(),{cameraAnimation:_=>{_.easeTo({duration:300,zoom:_.getZoom()+(u.shiftKey?-1:1),around:_.unproject(p)},{originalEvent:u})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class JS{constructor(){this._tap=new vg({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(u,p,_){this._swipePoint||(this._tapTime&&u.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?_.length>0&&(this._swipePoint=p[0],this._swipeTouch=_[0].identifier):this._tap.touchstart(u,p,_))}touchmove(u,p,_){if(this._tapTime){if(this._swipePoint){if(_[0].identifier!==this._swipeTouch)return;const S=p[0],E=S.y-this._swipePoint.y;return this._swipePoint=S,u.preventDefault(),this._active=!0,{zoomDelta:E/128}}}else this._tap.touchmove(u,p,_)}touchend(u,p,_){this._tapTime?this._swipePoint&&_.length===0&&this.reset():this._tap.touchend(u,p,_)&&(this._tapTime=u.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class P0{constructor(u,p,_){this._el=u,this._mousePan=p,this._touchPan=_}enable(u){this._inertiaOptions=u||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class QS{constructor(u,p,_){this._pitchWithRotate=u.pitchWithRotate,this._mouseRotate=p,this._mousePitch=_}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class eT{constructor(u,p,_,S){this._el=u,this._touchZoom=p,this._touchRotate=_,this._tapDragZoom=S,this._rotationDisabled=!1,this._enabled=!0}enable(u){this._touchZoom.enable(u),this._rotationDisabled||this._touchRotate.enable(u),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Go=g=>g.zoom||g.drag||g.pitch||g.rotate;class C0 extends s.Event{}class tT{constructor(){this.constants=[1,1,.01],this.radius=0}setup(u,p){const _=s.sub([],p,u);this.radius=s.length(_[2]<0?s.div([],_,this.constants):[_[0],_[1],0])}projectRay(u){s.div(u,u,this.constants),s.normalize(u,u),s.mul$1(u,u,this.constants);const p=s.scale$2([],u,this.radius);if(p[2]>0){const _=s.scale$2([],[0,0,1],s.dot(p,[0,0,1])),S=s.scale$2([],s.normalize([],[p[0],p[1],0]),this.radius),E=s.add([],p,s.scale$2([],s.sub([],s.add([],S,_),p),2));p[0]=E[0],p[1]=E[1]}return p}}function ds(g){return g.panDelta&&g.panDelta.mag()||g.zoomDelta||g.bearingDelta||g.pitchDelta}class Ls{constructor(u,p){this._map=u,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new y0(u),this._bearingSnap=p.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new tT,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(p),s.bindAll(["handleEvent","handleWindowEvent"],this);const _=this._el;this._listeners=[[_,"touchstart",{passive:!0}],[_,"touchmove",{passive:!1}],[_,"touchend",void 0],[_,"touchcancel",void 0],[_,"mousedown",void 0],[_,"mousemove",void 0],[_,"mouseup",void 0],[s.window.document,"mousemove",{capture:!0}],[s.window.document,"mouseup",void 0],[_,"mouseover",void 0],[_,"mouseout",void 0],[_,"dblclick",void 0],[_,"click",void 0],[_,"keydown",{capture:!1}],[_,"keyup",void 0],[_,"wheel",{passive:!1}],[_,"contextmenu",void 0],[s.window,"blur",void 0]];for(const[S,E,O]of this._listeners)S.addEventListener(E,S===s.window.document?this.handleWindowEvent:this.handleEvent,O)}destroy(){for(const[u,p,_]of this._listeners)u.removeEventListener(p,u===s.window.document?this.handleWindowEvent:this.handleEvent,_)}_addDefaultHandlers(u){const p=this._map,_=p.getCanvasContainer();this._add("mapEvent",new yg(p,u));const S=p.boxZoom=new v0(p,u);this._add("boxZoom",S);const E=new XS,O=new $i;p.doubleClickZoom=new A0(O,E),this._add("tapZoom",E),this._add("clickZoom",O);const I=new JS;this._add("tapDragZoom",I);const N=p.touchPitch=new w0(p);this._add("touchPitch",N);const G=new xg(u),V=new bg(u);p.dragRotate=new QS(u,G,V),this._add("mouseRotate",G,["mousePitch"]),this._add("mousePitch",V,["mouseRotate"]);const X=new _g(u),ie=new hf(p,u);p.dragPan=new P0(_,X,ie),this._add("mousePan",X),this._add("touchPan",ie,["touchZoom","touchRotate"]);const ae=new b0,ce=new x0;p.touchZoomRotate=new eT(_,ce,ae,I),this._add("touchRotate",ae,["touchPan","touchZoom"]),this._add("touchZoom",ce,["touchPan","touchRotate"]),this._add("blockableMapEvent",new cf(p));const le=p.scrollZoom=new E0(p,this);this._add("scrollZoom",le,["mousePan"]);const he=p.keyboard=new YS;this._add("keyboard",he);for(const J of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])u.interactive&&u[J]&&p[J].enable(u[J])}_add(u,p,_){this._handlers.push({handlerName:u,handler:p,allowed:_}),this._handlersById[u]=p}stop(u){if(!this._updatingCamera){for(const{handler:p}of this._handlers)p.reset();this._inertia.clear(),this._fireEvents({},{},u),this._changes=[]}}isActive(){for(const{handler:u}of this._handlers)if(u.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Go(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(u,p,_){for(const S in u)if(S!==_&&(!p||p.indexOf(S)<0))return!0;return!1}handleWindowEvent(u){this.handleEvent(u,`${u.type}Window`)}_getMapTouches(u){const p=[];for(const _ of u)this._el.contains(_.target)&&p.push(_);return p}handleEvent(u,p){this._updatingCamera=!0;const _=u.type==="renderFrame",S=_?void 0:u,E={needsRenderFrame:!1},O={},I={},N=u.touches?this._getMapTouches(u.touches):void 0,G=N?Y(this._el,N):_?void 0:H(this._el,u);for(const{handlerName:ie,handler:ae,allowed:ce}of this._handlers){if(!ae.isEnabled())continue;let le;this._blockedByActive(I,ce,ie)?ae.reset():ae[p||u.type]&&(le=ae[p||u.type](u,G,N),this.mergeHandlerResult(E,O,le,ie,S),le&&le.needsRenderFrame&&this._triggerRenderFrame()),(le||ae.isActive())&&(I[ie]=ae)}const V={};for(const ie in this._previousActiveHandlers)I[ie]||(V[ie]=S);this._previousActiveHandlers=I,(Object.keys(V).length||ds(E))&&(this._changes.push([E,O,V]),this._triggerRenderFrame()),(Object.keys(I).length||ds(E))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:X}=E;X&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],X(this._map))}mergeHandlerResult(u,p,_,S,E){if(!_)return;s.extend(u,_);const O={handlerName:S,originalEvent:_.originalEvent||E};_.zoomDelta!==void 0&&(p.zoom=O),_.panDelta!==void 0&&(p.drag=O),_.pitchDelta!==void 0&&(p.pitch=O),_.bearingDelta!==void 0&&(p.rotate=O)}_applyChanges(){const u={},p={},_={};for(const[S,E,O]of this._changes)S.panDelta&&(u.panDelta=(u.panDelta||new s.Point(0,0))._add(S.panDelta)),S.zoomDelta&&(u.zoomDelta=(u.zoomDelta||0)+S.zoomDelta),S.bearingDelta&&(u.bearingDelta=(u.bearingDelta||0)+S.bearingDelta),S.pitchDelta&&(u.pitchDelta=(u.pitchDelta||0)+S.pitchDelta),S.around!==void 0&&(u.around=S.around),S.aroundCoord!==void 0&&(u.aroundCoord=S.aroundCoord),S.pinchAround!==void 0&&(u.pinchAround=S.pinchAround),S.noInertia&&(u.noInertia=S.noInertia),s.extend(p,E),s.extend(_,O);this._updateMapTransform(u,p,_),this._changes=[]}_updateMapTransform(u,p,_){const S=this._map,E=S.transform,O=se=>[se.x,se.y,se.z];if((se=>{const me=this._eventsInProgress.drag;return me&&!this._handlersById[me.handlerName].isActive()})()&&!ds(u)){const se=E.zoom;E.cameraElevationReference="sea",E.recenterOnTerrain(),E.cameraElevationReference="ground",se!==E.zoom&&this._map._update(!0)}if(E._isCameraConstrained&&S._stop(!0),!ds(u))return void this._fireEvents(p,_,!0);let{panDelta:I,zoomDelta:N,bearingDelta:G,pitchDelta:V,around:X,aroundCoord:ie,pinchAround:ae}=u;E._isCameraConstrained&&(N>0&&(N=0),E._isCameraConstrained=!1),ae!==void 0&&(X=ae),(N||(se=>p[se]&&!this._eventsInProgress[se])("drag"))&&X&&(this._dragOrigin=O(E.pointCoordinate3D(X)),this._trackingEllipsoid.setup(E._camera.position,this._dragOrigin)),E.cameraElevationReference="sea",S._stop(!0),X=X||S.transform.centerPoint,G&&(E.bearing+=G),V&&(E.pitch+=V),E._updateCameraState();const ce=[0,0,0];if(I)if(E.projection.name==="mercator"){const se=this._trackingEllipsoid.projectRay(E.screenPointToMercatorRay(X).dir),me=this._trackingEllipsoid.projectRay(E.screenPointToMercatorRay(X.sub(I)).dir);ce[0]=me[0]-se[0],ce[1]=me[1]-se[1]}else{const se=E.pointCoordinate(X);if(E.projection.name==="globe"){I=I.rotate(-E.angle);const me=E._pixelsPerMercatorPixel/E.worldSize;ce[0]=-I.x*s.mercatorScale(s.latFromMercatorY(se.y))*me,ce[1]=-I.y*s.mercatorScale(E.center.lat)*me}else{const me=E.pointCoordinate(X.sub(I));se&&me&&(ce[0]=me.x-se.x,ce[1]=me.y-se.y)}}const le=E.zoom,he=[0,0,0];if(N){const se=O(ie||E.pointCoordinate3D(X)),me={dir:s.normalize([],s.sub([],se,E._camera.position))};if(me.dir[2]<0){const ge=E.zoomDeltaToMovement(se,N);s.scale$2(he,me.dir,ge)}}const J=s.add(ce,ce,he);E._translateCameraConstrained(J),N&&Math.abs(E.zoom-le)>1e-4&&E.recenterOnTerrain(),E.cameraElevationReference="ground",this._map._update(),u.noInertia||this._inertia.record(u),this._fireEvents(p,_,!0)}_fireEvents(u,p,_){const S=Go(this._eventsInProgress),E=Go(u),O={};for(const V in u){const{originalEvent:X}=u[V];this._eventsInProgress[V]||(O[`${V}start`]=X),this._eventsInProgress[V]=u[V]}!S&&E&&this._fireEvent("movestart",E.originalEvent);for(const V in O)this._fireEvent(V,O[V]);E&&this._fireEvent("move",E.originalEvent);for(const V in u){const{originalEvent:X}=u[V];this._fireEvent(V,X)}const I={};let N;for(const V in this._eventsInProgress){const{handlerName:X,originalEvent:ie}=this._eventsInProgress[V];this._handlersById[X].isActive()||(delete this._eventsInProgress[V],N=p[X]||ie,I[`${V}end`]=N)}for(const V in I)this._fireEvent(V,I[V]);const G=Go(this._eventsInProgress);if(_&&(S||E)&&!G){this._updatingCamera=!0;const V=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),X=ie=>ie!==0&&-this._bearingSnap<ie&&ie<this._bearingSnap;V?(X(V.bearing||this._map.getBearing())&&(V.bearing=0),this._map.easeTo(V,{originalEvent:N})):(this._map.fire(new s.Event("moveend",{originalEvent:N})),X(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(u,p){this._map.fire(new s.Event(u,p?{originalEvent:p}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(u=>{this._frameId=void 0,this.handleEvent(new C0("renderFrame",{timeStamp:u})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const zl="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class df extends s.Evented{constructor(u,p){super(),this._moving=!1,this._zooming=!1,this.transform=u,this._bearingSnap=p.bearingSnap,this._respectPrefersReducedMotion=p.respectPrefersReducedMotion!==!1,s.bindAll(["_renderFrameCallback"],this)}getCenter(){return new s.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(u,p){return this.jumpTo({center:u},p)}panBy(u,p,_){return u=s.Point.convert(u).mult(-1),this.panTo(this.transform.center,s.extend({offset:u},p),_)}panTo(u,p,_){return this.easeTo(s.extend({center:u},p),_)}getZoom(){return this.transform.zoom}setZoom(u,p){return this.jumpTo({zoom:u},p),this}zoomTo(u,p,_){return this.easeTo(s.extend({zoom:u},p),_)}zoomIn(u,p){return this.zoomTo(this.getZoom()+1,u,p),this}zoomOut(u,p){return this.zoomTo(this.getZoom()-1,u,p),this}getBearing(){return this.transform.bearing}setBearing(u,p){return this.jumpTo({bearing:u},p),this}getPadding(){return this.transform.padding}setPadding(u,p){return this.jumpTo({padding:u},p),this}rotateTo(u,p,_){return this.easeTo(s.extend({bearing:u},p),_)}resetNorth(u,p){return this.rotateTo(0,s.extend({duration:1e3},u),p),this}resetNorthPitch(u,p){return this.easeTo(s.extend({bearing:0,pitch:0,duration:1e3},u),p),this}snapToNorth(u,p){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(u,p):this}getPitch(){return this.transform.pitch}setPitch(u,p){return this.jumpTo({pitch:u},p),this}cameraForBounds(u,p){u=s.LngLatBounds.convert(u);const _=p&&p.bearing||0,S=p&&p.pitch||0,E=u.getNorthWest(),O=u.getSouthEast();return this._cameraForBounds(this.transform,E,O,_,S,p)}_extendCameraOptions(u){const p={top:0,bottom:0,right:0,left:0};if(typeof(u=s.extend({padding:p,offset:[0,0],maxZoom:this.transform.maxZoom},u)).padding=="number"){const _=u.padding;u.padding={top:_,bottom:_,right:_,left:_}}return u.padding=s.extend(p,u.padding),u}_minimumAABBFrustumDistance(u,p){const _=p.max[0]-p.min[0],S=p.max[1]-p.min[1];return _/S>u.aspect?_/(2*Math.tan(.5*u.fovX)*u.aspect):S/(2*Math.tan(.5*u.fovY)*u.aspect)}_cameraForBoundsOnGlobe(u,p,_,S,E,O){const I=u.clone(),N=this._extendCameraOptions(O);I.bearing=S,I.pitch=E;const G=s.LngLat.convert(p),V=s.LngLat.convert(_),X=.5*(G.lat+V.lat),ie=.5*(G.lng+V.lng),ae=s.latLngToECEF(X,ie),ce=s.normalize([],ae),le=s.normalize([],s.cross([],ce,[0,1,0])),he=s.cross([],le,ce),J=[le[0],le[1],le[2],0,he[0],he[1],he[2],0,ce[0],ce[1],ce[2],0,0,0,0,1],se=[ae,s.latLngToECEF(G.lat,G.lng),s.latLngToECEF(V.lat,G.lng),s.latLngToECEF(V.lat,V.lng),s.latLngToECEF(G.lat,V.lng),s.latLngToECEF(X,G.lng),s.latLngToECEF(X,V.lng),s.latLngToECEF(G.lat,ie),s.latLngToECEF(V.lat,ie)];let me=s.Aabb.fromPoints(se.map(lt=>[s.dot(le,lt),s.dot(he,lt),s.dot(ce,lt)]));const ge=s.transformMat4([],me.center,J);s.squaredLength(ge)===0&&s.set(ge,0,0,1),s.normalize(ge,ge),s.scale$2(ge,ge,s.GLOBE_RADIUS),I.center=s.ecefToLatLng(ge);const Te=I.getWorldToCameraMatrix(),Pe=s.invert(new Float64Array(16),Te);me=s.Aabb.applyTransform(me,s.multiply([],Te,J)),s.transformMat4(ge,ge,Te);const Ae=.5*(me.max[2]-me.min[2]),Re=this._minimumAABBFrustumDistance(I,me),Ie=s.scale$2([],[0,0,1],Ae),Ve=s.add(Ie,ge,Ie),pt=Re+(I.pitch===0?0:s.distance(ge,Ve)),$e=I.globeCenterInViewSpace,it=s.sub([],ge,[$e[0],$e[1],$e[2]]);s.normalize(it,it),s.scale$2(it,it,pt);const He=s.add([],ge,it);s.transformMat4(He,He,Pe);const ft=s.earthRadius/s.GLOBE_RADIUS,Ue=s.length(He),nt=s.mercatorZfromAltitude(Math.max(Ue*ft-s.earthRadius,Number.EPSILON),0),yt=Math.min(I.zoomFromMercatorZAdjusted(nt),N.maxZoom);return yt>.5*(s.GLOBE_ZOOM_THRESHOLD_MIN+s.GLOBE_ZOOM_THRESHOLD_MAX)?(I.setProjection({name:"mercator"}),I.zoom=yt,this._cameraForBounds(I,p,_,S,E,O)):{center:I.center,zoom:yt,bearing:S,pitch:E}}queryTerrainElevation(u,p){const _=this.transform.elevation;return _?(p=s.extend({},{exaggerated:!0},p),_.getAtPoint(s.MercatorCoordinate.fromLngLat(u),null,p.exaggerated)):null}_cameraForBounds(u,p,_,S,E,O){if(u.projection.name==="globe")return this._cameraForBoundsOnGlobe(u,p,_,S,E,O);const I=u.clone(),N=this._extendCameraOptions(O),G=I.padding;I.bearing=S,I.pitch=E;const V=s.LngLat.convert(p),X=s.LngLat.convert(_),ie=new s.LngLat(V.lng,X.lat),ae=new s.LngLat(X.lng,V.lat),ce=I.project(V),le=I.project(X),he=this.queryTerrainElevation(V),J=this.queryTerrainElevation(X),se=this.queryTerrainElevation(ie),me=this.queryTerrainElevation(ae),ge=[[ce.x,ce.y,Math.min(he||0,J||0,se||0,me||0)],[le.x,le.y,Math.max(he||0,J||0,se||0,me||0)]];let Te=s.Aabb.fromPoints(ge);const Pe=I.getWorldToCameraMatrix(),Ae=s.invert(new Float64Array(16),Pe);Te=s.Aabb.applyTransform(Te,Pe);const Re=s.sub([],Te.max,Te.min),Ie=G.left||0,Ve=G.right||0,pt=G.bottom||0,$e=G.top||0,{left:it,right:He,top:ft,bottom:Ue}=N.padding,nt=.5*(Ie+Ve),yt=.5*($e+pt),lt=Math.min(I.scaleZoom(I.scale*Math.min((I.width-(Ie+Ve+it+He))/Re[0],(I.height-(pt+$e+Ue+ft))/Re[1])),N.maxZoom),vt=I.scale/I.zoomScale(lt);Te=new s.Aabb([Te.min[0]-(it+nt)*vt,Te.min[1]-(Ue+yt)*vt,Te.min[2]],[Te.max[0]+(He+nt)*vt,Te.max[1]+(ft+yt)*vt,Te.max[2]]);const Vt=.5*Re[2],ir=this._minimumAABBFrustumDistance(I,Te),zt=[0,0,1,0];s.transformMat4$1(zt,zt,Pe),s.normalize$2(zt,zt);const Yt=s.scale$2([],zt,ir+Vt),br=s.add([],Te.center,Yt),yr=(typeof N.offset.x=="number"&&typeof N.offset.y=="number"?new s.Point(N.offset.x,N.offset.y):s.Point.convert(N.offset)).rotate(-s.degToRad(S));Te.center[0]-=yr.x*vt,Te.center[1]+=yr.y*vt,s.transformMat4(Te.center,Te.center,Ae),s.transformMat4(br,br,Ae);const Nt=[Te.center[0],Te.center[1],br[2]*I.pixelsPerMeter];s.scale$2(Nt,Nt,1/I.worldSize);const Fr=s.lngFromMercatorX(Nt[0]),Wr=s.latFromMercatorY(Nt[1]),qr=Math.min(I._zoomFromMercatorZ(Nt[2]),N.maxZoom),Hr=new s.LngLat(Fr,Wr);return I.mercatorFromTransition&&qr<.5*(s.GLOBE_ZOOM_THRESHOLD_MIN+s.GLOBE_ZOOM_THRESHOLD_MAX)?(I.setProjection({name:"globe"}),I.zoom=qr,this._cameraForBounds(I,p,_,S,E,O)):{center:Hr,zoom:qr,bearing:S,pitch:E}}fitBounds(u,p,_){const S=this.cameraForBounds(u,p);return this._fitInternal(S,p,_)}fitScreenCoordinates(u,p,_,S,E){const O=s.Point.convert(u),I=s.Point.convert(p),N=new s.Point(Math.min(O.x,I.x),Math.min(O.y,I.y)),G=new s.Point(Math.max(O.x,I.x),Math.max(O.y,I.y));if(this.transform.projection.name==="mercator"&&this.transform.anyCornerOffEdge(O,I))return this;const V=this.transform.pointLocation3D(N),X=this.transform.pointLocation3D(G),ie=this.transform.pointLocation3D(new s.Point(N.x,G.y)),ae=this.transform.pointLocation3D(new s.Point(G.x,N.y)),ce=[Math.min(V.lng,X.lng,ie.lng,ae.lng),Math.min(V.lat,X.lat,ie.lat,ae.lat)],le=[Math.max(V.lng,X.lng,ie.lng,ae.lng),Math.max(V.lat,X.lat,ie.lat,ae.lat)],he=S&&S.pitch?S.pitch:this.getPitch(),J=this._cameraForBounds(this.transform,ce,le,_,he,S);return this._fitInternal(J,S,E)}_fitInternal(u,p,_){return u?(delete(p=s.extend(u,p)).padding,p.linear?this.easeTo(p,_):this.flyTo(p,_)):this}jumpTo(u,p){this.stop();const _=u.preloadOnly?this.transform.clone():this.transform;let S=!1,E=!1,O=!1;return"zoom"in u&&_.zoom!==+u.zoom&&(S=!0,_.zoom=+u.zoom),u.center!==void 0&&(_.center=s.LngLat.convert(u.center)),"bearing"in u&&_.bearing!==+u.bearing&&(E=!0,_.bearing=+u.bearing),"pitch"in u&&_.pitch!==+u.pitch&&(O=!0,_.pitch=+u.pitch),u.padding==null||_.isPaddingEqual(u.padding)||(_.padding=u.padding),u.preloadOnly?(this._preloadTiles(_),this):(this.fire(new s.Event("movestart",p)).fire(new s.Event("move",p)),S&&this.fire(new s.Event("zoomstart",p)).fire(new s.Event("zoom",p)).fire(new s.Event("zoomend",p)),E&&this.fire(new s.Event("rotatestart",p)).fire(new s.Event("rotate",p)).fire(new s.Event("rotateend",p)),O&&this.fire(new s.Event("pitchstart",p)).fire(new s.Event("pitch",p)).fire(new s.Event("pitchend",p)),this.fire(new s.Event("moveend",p)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||s.warnOnce(zl),this.transform.getFreeCameraOptions()}setFreeCameraOptions(u,p){const _=this.transform;if(!_.projection.supportsFreeCamera)return s.warnOnce(zl),this;this.stop();const S=_.zoom,E=_.pitch,O=_.bearing;_.setFreeCameraOptions(u);const I=S!==_.zoom,N=E!==_.pitch,G=O!==_.bearing;return this.fire(new s.Event("movestart",p)).fire(new s.Event("move",p)),I&&this.fire(new s.Event("zoomstart",p)).fire(new s.Event("zoom",p)).fire(new s.Event("zoomend",p)),G&&this.fire(new s.Event("rotatestart",p)).fire(new s.Event("rotate",p)).fire(new s.Event("rotateend",p)),N&&this.fire(new s.Event("pitchstart",p)).fire(new s.Event("pitch",p)).fire(new s.Event("pitchend",p)),this.fire(new s.Event("moveend",p)),this}easeTo(u,p){this._stop(!1,u.easeId),((u=s.extend({offset:[0,0],duration:500,easing:s.ease},u)).animate===!1||this._prefersReducedMotion(u))&&(u.duration=0);const _=this.transform,S=this.getZoom(),E=this.getBearing(),O=this.getPitch(),I=this.getPadding(),N="zoom"in u?+u.zoom:S,G="bearing"in u?this._normalizeBearing(u.bearing,E):E,V="pitch"in u?+u.pitch:O,X="padding"in u?u.padding:_.padding,ie=s.Point.convert(u.offset);let ae,ce,le;if(_.projection.name==="globe"){const Ie=s.MercatorCoordinate.fromLngLat(_.center),Ve=ie.rotate(-_.angle);Ie.x+=Ve.x/_.worldSize,Ie.y+=Ve.y/_.worldSize;const pt=Ie.toLngLat(),$e=s.LngLat.convert(u.center||pt);this._normalizeCenter($e),ae=_.centerPoint.add(Ve),ce=new s.Point(Ie.x,Ie.y).mult(_.worldSize),le=new s.Point(s.mercatorXfromLng($e.lng),s.mercatorYfromLat($e.lat)).mult(_.worldSize).sub(ce)}else{ae=_.centerPoint.add(ie);const Ie=_.pointLocation(ae),Ve=s.LngLat.convert(u.center||Ie);this._normalizeCenter(Ve),ce=_.project(Ie),le=_.project(Ve).sub(ce)}const he=_.zoomScale(N-S);let J,se;u.around&&(J=s.LngLat.convert(u.around),se=_.locationPoint(J));const me=this._zooming||N!==S,ge=this._rotating||E!==G,Te=this._pitching||V!==O,Pe=!_.isPaddingEqual(X),Ae=Ie=>Ve=>{if(me&&(Ie.zoom=s.number(S,N,Ve)),ge&&(Ie.bearing=s.number(E,G,Ve)),Te&&(Ie.pitch=s.number(O,V,Ve)),Pe&&(Ie.interpolatePadding(I,X,Ve),ae=Ie.centerPoint.add(ie)),J)Ie.setLocationAtPoint(J,se);else{const pt=Ie.zoomScale(Ie.zoom-S),$e=N>S?Math.min(2,he):Math.max(.5,he),it=Math.pow($e,1-Ve),He=Ie.unproject(ce.add(le.mult(Ve*it)).mult(pt));Ie.setLocationAtPoint(Ie.renderWorldCopies?He.wrap():He,ae)}return u.preloadOnly||this._fireMoveEvents(p),Ie};if(u.preloadOnly){const Ie=this._emulate(Ae,u.duration,_);return this._preloadTiles(Ie),this}const Re={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=me,this._rotating=ge,this._pitching=Te,this._padding=Pe,this._easeId=u.easeId,this._prepareEase(p,u.noMoveStart,Re),this._ease(Ae(_),Ie=>{_.recenterOnTerrain(),this._afterEase(p,Ie)},u),this}_prepareEase(u,p,_={}){this._moving=!0,this.transform.cameraElevationReference="sea",p||_.moving||this.fire(new s.Event("movestart",u)),this._zooming&&!_.zooming&&this.fire(new s.Event("zoomstart",u)),this._rotating&&!_.rotating&&this.fire(new s.Event("rotatestart",u)),this._pitching&&!_.pitching&&this.fire(new s.Event("pitchstart",u))}_fireMoveEvents(u){this.fire(new s.Event("move",u)),this._zooming&&this.fire(new s.Event("zoom",u)),this._rotating&&this.fire(new s.Event("rotate",u)),this._pitching&&this.fire(new s.Event("pitch",u))}_afterEase(u,p){if(this._easeId&&p&&this._easeId===p)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const _=this._zooming,S=this._rotating,E=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,_&&this.fire(new s.Event("zoomend",u)),S&&this.fire(new s.Event("rotateend",u)),E&&this.fire(new s.Event("pitchend",u)),this.fire(new s.Event("moveend",u))}flyTo(u,p){if(this._prefersReducedMotion(u)){const lt=s.pick(u,["center","zoom","bearing","pitch","around"]);return this.jumpTo(lt,p)}this.stop(),u=s.extend({offset:[0,0],speed:1.2,curve:1.42,easing:s.ease},u);const _=this.transform,S=this.getZoom(),E=this.getBearing(),O=this.getPitch(),I=this.getPadding(),N="zoom"in u?s.clamp(+u.zoom,_.minZoom,_.maxZoom):S,G="bearing"in u?this._normalizeBearing(u.bearing,E):E,V="pitch"in u?+u.pitch:O,X="padding"in u?u.padding:_.padding,ie=_.zoomScale(N-S),ae=s.Point.convert(u.offset);let ce=_.centerPoint.add(ae);const le=_.pointLocation(ce),he=s.LngLat.convert(u.center||le);this._normalizeCenter(he);const J=_.project(le),se=_.project(he).sub(J);let me=u.curve;const ge=Math.max(_.width,_.height),Te=ge/ie,Pe=se.mag();if("minZoom"in u){const lt=s.clamp(Math.min(u.minZoom,S,N),_.minZoom,_.maxZoom),vt=ge/_.zoomScale(lt-S);me=Math.sqrt(vt/Pe*2)}const Ae=me*me;function Re(lt){const vt=(Te*Te-ge*ge+(lt?-1:1)*Ae*Ae*Pe*Pe)/(2*(lt?Te:ge)*Ae*Pe);return Math.log(Math.sqrt(vt*vt+1)-vt)}function Ie(lt){return(Math.exp(lt)-Math.exp(-lt))/2}function Ve(lt){return(Math.exp(lt)+Math.exp(-lt))/2}const pt=Re(0);let $e=function(lt){return Ve(pt)/Ve(pt+me*lt)},it=function(lt){return ge*((Ve(pt)*(Ie(vt=pt+me*lt)/Ve(vt))-Ie(pt))/Ae)/Pe;var vt},He=(Re(1)-pt)/me;if(Math.abs(Pe)<1e-6||!isFinite(He)){if(Math.abs(ge-Te)<1e-6)return this.easeTo(u,p);const lt=Te<ge?-1:1;He=Math.abs(Math.log(Te/ge))/me,it=function(){return 0},$e=function(vt){return Math.exp(lt*me*vt)}}u.duration="duration"in u?+u.duration:1e3*He/("screenSpeed"in u?+u.screenSpeed/me:+u.speed),u.maxDuration&&u.duration>u.maxDuration&&(u.duration=0);const ft=E!==G,Ue=V!==O,nt=!_.isPaddingEqual(X),yt=lt=>vt=>{const Vt=vt*He,ir=1/$e(Vt);lt.zoom=vt===1?N:S+lt.scaleZoom(ir),ft&&(lt.bearing=s.number(E,G,vt)),Ue&&(lt.pitch=s.number(O,V,vt)),nt&&(lt.interpolatePadding(I,X,vt),ce=lt.centerPoint.add(ae));const zt=vt===1?he:lt.unproject(J.add(se.mult(it(Vt))).mult(ir));return lt.setLocationAtPoint(lt.renderWorldCopies?zt.wrap():zt,ce),lt._updateCameraOnTerrain(),u.preloadOnly||this._fireMoveEvents(p),lt};if(u.preloadOnly){const lt=this._emulate(yt,u.duration,_);return this._preloadTiles(lt),this}return this._zooming=!0,this._rotating=ft,this._pitching=Ue,this._padding=nt,this._prepareEase(p,!1),this._ease(yt(_),()=>this._afterEase(p),u),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(u,p){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const _=this._onEaseEnd;this._onEaseEnd=void 0,_.call(this,p)}if(!u){const _=this.handlers;_&&_.stop(!1)}return this}_ease(u,p,_){_.animate===!1||_.duration===0?(u(1),p()):(this._easeStart=s.exported.now(),this._easeOptions=_,this._onEaseFrame=u,this._onEaseEnd=p,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const u=Math.min((s.exported.now()-this._easeStart)/this._easeOptions.duration,1),p=this._onEaseFrame;p&&p(this._easeOptions.easing(u)),u<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(u,p){u=s.wrap(u,-180,180);const _=Math.abs(u-p);return Math.abs(u-360-p)<_&&(u-=360),Math.abs(u+360-p)<_&&(u+=360),u}_normalizeCenter(u){const p=this.transform;if(!p.renderWorldCopies||p.maxBounds)return;const _=u.lng-p.center.lng;u.lng+=_>180?-360:_<-180?360:0}_prefersReducedMotion(u){return this._respectPrefersReducedMotion&&s.exported.prefersReducedMotion&&!(u&&u.essential)}_emulate(u,p,_){const S=Math.ceil(15*p/1e3),E=[],O=u(_.clone());for(let I=0;I<=S;I++){const N=O(I/S);E.push(N.clone())}return E}}class jt{constructor(u={}){this.options=u,s.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(u){const p=this.options&&this.options.compact;return this._map=u,this._container=k("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=k("button","mapboxgl-ctrl-attrib-button",this._container),k("span","mapboxgl-ctrl-icon",this._compactButton).setAttribute("aria-hidden","true"),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=k("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),p&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),p===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(u,p){const _=this._map._getUIString(`AttributionControl.${p}`);u.setAttribute("aria-label",_),u.removeAttribute("title"),u.firstElementChild&&u.firstElementChild.setAttribute("title",_)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let u=this._editLink;u||(u=this._editLink=this._container.querySelector(".mapbox-improve-map"));const p=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||s.config.ACCESS_TOKEN}];if(u){const _=p.reduce((S,E,O)=>(E.value&&(S+=`${E.key}=${E.value}${O<p.length-1?"&":""}`),S),"?");u.href=`${s.config.FEEDBACK_URL}/${_}#${fh(this._map,!0)}`,u.rel="noopener nofollow",this._setElementTitle(u,"MapFeedback")}}_updateData(u){!u||u.sourceDataType!=="metadata"&&u.sourceDataType!=="visibility"&&u.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let u=[];if(this._map.style.stylesheet){const S=this._map.style.stylesheet;this.styleOwner=S.owner,this.styleId=S.id}const p=this._map.style._sourceCaches;for(const S in p){const E=p[S];if(E.used){const O=E.getSource();O.attribution&&u.indexOf(O.attribution)<0&&u.push(O.attribution)}}u.sort((S,E)=>S.length-E.length),u=u.filter((S,E)=>{for(let O=E+1;O<u.length;O++)if(u[O].indexOf(S)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?u=[...this.options.customAttribution,...u]:u.unshift(this.options.customAttribution));const _=u.join(" | ");_!==this._attribHTML&&(this._attribHTML=_,u.length?(this._innerContainer.innerHTML=_,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class Eg{constructor(){s.bindAll(["_updateLogo","_updateCompact"],this)}onAdd(u){this._map=u,this._container=k("div","mapboxgl-ctrl");const p=k("a","mapboxgl-ctrl-logo");return p.target="_blank",p.rel="noopener nofollow",p.href="https://www.mapbox.com/",p.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),p.setAttribute("rel","noopener nofollow"),this._container.appendChild(p),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(u){u&&u.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const u=this._map.style._sourceCaches;if(Object.entries(u).length===0)return!0;for(const p in u){const _=u[p].getSource();if(_.hasOwnProperty("mapbox_logo")&&!_.mapbox_logo)return!1}return!0}_updateCompact(){const u=this._container.children;if(u.length){const p=u[0];this._map.getCanvasContainer().offsetWidth<250?p.classList.add("mapboxgl-compact"):p.classList.remove("mapboxgl-compact")}}}class Ag{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(u){const p=++this._id;return this._queue.push({callback:u,id:p,cancelled:!1}),p}remove(u){const p=this._currentlyRunning,_=p?this._queue.concat(p):this._queue;for(const S of _)if(S.id===u)return void(S.cancelled=!0)}run(u=0){const p=this._currentlyRunning=this._queue;this._queue=[];for(const _ of p)if(!_.cancelled&&(_.callback(u),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function Vc(g,u,p){if(g=new s.LngLat(g.lng,g.lat),u){const _=new s.LngLat(g.lng-360,g.lat),S=new s.LngLat(g.lng+360,g.lat),E=360*Math.ceil(Math.abs(g.lng-p.center.lng)/360),O=p.locationPoint(g).distSqr(u),I=u.x<0||u.y<0||u.x>p.width||u.y>p.height;p.locationPoint(_).distSqr(u)<O&&(I||Math.abs(_.lng-p.center.lng)<E)?g=_:p.locationPoint(S).distSqr(u)<O&&(I||Math.abs(S.lng-p.center.lng)<E)&&(g=S)}for(;Math.abs(g.lng-p.center.lng)>180;){const _=p.locationPoint(g);if(_.x>=0&&_.y>=0&&_.x<=p.width&&_.y<=p.height)break;g.lng>p.center.lng?g.lng-=360:g.lng+=360}return g}const Bl={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class Ot extends s.Evented{constructor(u,p){if(super(),(u instanceof s.window.HTMLElement||p)&&(u=s.extend({element:u},p)),s.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=u&&u.anchor||"center",this._color=u&&u.color||"#3FB1CE",this._scale=u&&u.scale||1,this._draggable=u&&u.draggable||!1,this._clickTolerance=u&&u.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=u&&u.rotation||0,this._rotationAlignment=u&&u.rotationAlignment||"auto",this._pitchAlignment=u&&u.pitchAlignment&&u.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=u&&u.occludedOpacity||.2,u&&u.element)this._element=u.element,this._offset=s.Point.convert(u&&u.offset||[0,0]);else{this._defaultMarker=!0,this._element=k("div");const S=41,E=27,O=M("svg",{display:"block",height:S*this._scale+"px",width:E*this._scale+"px",viewBox:`0 0 ${E} ${S}`},this._element),I=M("radialGradient",{id:"shadowGradient"},M("defs",{},O));M("stop",{offset:"10%","stop-opacity":.4},I),M("stop",{offset:"100%","stop-opacity":.05},I),M("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},O),M("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},O),M("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},O),M("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},O),this._offset=s.Point.convert(u&&u.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",S=>{S.preventDefault()}),this._element.addEventListener("mousedown",S=>{S.preventDefault()});const _=this._element.classList;for(const S in Bl)_.remove(`mapboxgl-marker-anchor-${S}`);_.add(`mapboxgl-marker-anchor-${this._anchor}`),this._popup=null}addTo(u){return u===this._map||(this.remove(),this._map=u,u.getCanvasContainer().appendChild(this._element),u.on("move",this._updateMoving),u.on("moveend",this._update),u.on("remove",this._clearFadeTimer),u._addMarker(this),this.setDraggable(this._draggable),this._update(),u.on("click",this._onMapClick)),this}remove(){const u=this._map;return u&&(u.off("click",this._onMapClick),u.off("move",this._updateMoving),u.off("moveend",this._update),u.off("mousedown",this._addDragHandler),u.off("touchstart",this._addDragHandler),u.off("mouseup",this._onUp),u.off("touchend",this._onUp),u.off("mousemove",this._onMove),u.off("touchmove",this._onMove),u.off("remove",this._clearFadeTimer),u._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(u){return this._lngLat=s.LngLat.convert(u),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(u){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),u){if(!("offset"in u.options)){const S=Math.sqrt(Math.pow(13.5,2)/2);u.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[S,-1*(38.1-13.5+S)],"bottom-right":[-S,-1*(38.1-13.5+S)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=u,u._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(u){const p=u.code,_=u.charCode||u.keyCode;p!=="Space"&&p!=="Enter"&&_!==32&&_!==13||this.togglePopup()}_onMapClick(u){const p=u.originalEvent.target,_=this._element;this._popup&&(p===_||_.contains(p))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const u=this._popup;return u?(u.isOpen()?(u.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(u.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const u=this._map,p=this._pos;if(!u||!p)return!1;const _=u.unproject(p),S=u.getFreeCameraOptions();if(!S.position)return!1;const E=S.position.toLngLat();return E.distanceTo(_)<.9*E.distanceTo(this._lngLat)}_evaluateOpacity(){const u=this._map;if(!u)return;const p=this._pos;if(!p||p.x<0||p.x>u.transform.width||p.y<0||p.y>u.transform.height)return void this._clearFadeTimer();const _=u.unproject(p);let S;u._showingGlobe()&&s.isLngLatBehindGlobe(u.transform,this._lngLat)?S=0:(S=1-u._queryFogOpacity(_),u.transform._terrainEnabled()&&u.getTerrain()&&this._behindTerrain()&&(S*=this._occludedOpacity)),this._element.style.opacity=`${S}`,this._element.style.pointerEvents=S>0?"auto":"none",this._popup&&this._popup._setOpacity(S),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const u=this._pos;if(!u||!this._map)return;const p=this._offset.mult(this._scale);this._element.style.transform=`
            translate(${u.x}px,${u.y}px)
            ${Bl[this._anchor]}
            ${this._calculateXYTransform()} ${this._calculateZTransform()}
            translate(${p.x}px,${p.y}px)
        `}_calculateXYTransform(){const u=this._pos,p=this._map,_=this.getPitchAlignment();if(!p||!u||_!=="map")return"";if(!p._showingGlobe()){const N=p.getPitch();return N?`rotateX(${N}deg)`:""}const S=s.radToDeg(s.globeTiltAtLngLat(p.transform,this._lngLat)),E=u.sub(s.globeCenterToScreenPoint(p.transform)),O=Math.abs(E.x)+Math.abs(E.y);if(O===0)return"";const I=S/O;return`rotateX(${-E.y*I}deg) rotateY(${E.x*I}deg)`}_calculateZTransform(){const u=this._pos,p=this._map;if(!p||!u)return"";let _=0;const S=this.getRotationAlignment();if(S==="map")if(p._showingGlobe()){const E=p.project(new s.LngLat(this._lngLat.lng,this._lngLat.lat+.001)),O=p.project(new s.LngLat(this._lngLat.lng,this._lngLat.lat-.001)).sub(E);_=s.radToDeg(Math.atan2(O.y,O.x))-90}else _=-p.getBearing();else if(S==="horizon"){const E=s.smoothstep(4,6,p.getZoom()),O=s.globeCenterToScreenPoint(p.transform);O.y+=E*p.transform.height;const I=u.sub(O),N=s.radToDeg(Math.atan2(I.y,I.x));_=(N>90?N-270:N+90)*(1-E)}return _+=this._rotation,_?`rotateZ(${_}deg)`:""}_update(u){s.window.cancelAnimationFrame(this._updateFrameId);const p=this._map;p&&(p.transform.renderWorldCopies&&(this._lngLat=Vc(this._lngLat,this._pos,p.transform)),this._pos=p.project(this._lngLat),u===!0?this._updateFrameId=s.window.requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),p._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(p._showingGlobe()||p.getTerrain()||p.getFog())&&!this._fadeTimer&&(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(u){return this._offset=s.Point.convert(u),this._update(),this}_onMove(u){const p=this._map;if(!p)return;const _=this._pointerdownPos,S=this._positionDelta;if(_&&S){if(!this._isDragging){const E=this._clickTolerance||p._clickTolerance;if(u.point.dist(_)<E)return;this._isDragging=!0}this._pos=u.point.sub(S),this._lngLat=p.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new s.Event("dragstart"))),this.fire(new s.Event("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const u=this._map;u&&(u.off("mousemove",this._onMove),u.off("touchmove",this._onMove)),this._state==="active"&&this.fire(new s.Event("dragend")),this._state="inactive"}_addDragHandler(u){const p=this._map,_=this._pos;p&&_&&this._element.contains(u.originalEvent.target)&&(u.preventDefault(),this._positionDelta=u.point.sub(_),this._pointerdownPos=u.point,this._state="pending",p.on("mousemove",this._onMove),p.on("touchmove",this._onMove),p.once("mouseup",this._onUp),p.once("touchend",this._onUp))}setDraggable(u){this._draggable=!!u;const p=this._map;return p&&(u?(p.on("mousedown",this._addDragHandler),p.on("touchstart",this._addDragHandler)):(p.off("mousedown",this._addDragHandler),p.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(u){return this._rotation=u||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(u){return this._rotationAlignment=u||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment==="auto"||this._rotationAlignment==="horizon"&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(u){return this._pitchAlignment=u||"auto",this._update(),this}getPitchAlignment(){return this._pitchAlignment==="auto"?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(u){return this._occludedOpacity=u||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const Pg={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},rT=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function k0(g=new s.Point(0,0),u="bottom"){if(typeof g=="number"){const p=Math.round(Math.sqrt(.5*Math.pow(g,2)));switch(u){case"top":return new s.Point(0,g);case"top-left":return new s.Point(p,p);case"top-right":return new s.Point(-p,p);case"bottom":return new s.Point(0,-g);case"bottom-left":return new s.Point(p,-p);case"bottom-right":return new s.Point(-p,-p);case"left":return new s.Point(g,0);case"right":return new s.Point(-g,0)}return new s.Point(0,0)}return g instanceof s.Point||Array.isArray(g)?s.Point.convert(g):s.Point.convert(g[u]||[0,0])}class Cg{constructor(u){this.jumpTo(u)}getValue(u){if(u<=this._startTime)return this._start;if(u>=this._endTime)return this._end;const p=s.easeCubicInOut((u-this._startTime)/(this._endTime-this._startTime));return this._start*(1-p)+this._end*p}isEasing(u){return u>=this._startTime&&u<=this._endTime}jumpTo(u){this._startTime=-1/0,this._endTime=-1/0,this._start=u,this._end=u}easeTo(u,p,_){this._start=this.getValue(p),this._end=u,this._startTime=p,this._endTime=p+_}}const O0={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use  + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},M0={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,optimizeForTerrain:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0},nT={showCompass:!0,showZoom:!0,visualizePitch:!1};class iT{constructor(u,p,_=!1){this._clickTolerance=10,this.element=p,this.mouseRotate=new xg({clickTolerance:u.dragRotate._mouseRotate._clickTolerance}),this.map=u,_&&(this.mousePitch=new bg({clickTolerance:u.dragRotate._mousePitch._clickTolerance})),s.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),p.addEventListener("mousedown",this.mousedown),p.addEventListener("touchstart",this.touchstart,{passive:!1}),p.addEventListener("touchmove",this.touchmove),p.addEventListener("touchend",this.touchend),p.addEventListener("touchcancel",this.reset)}down(u,p){this.mouseRotate.mousedown(u,p),this.mousePitch&&this.mousePitch.mousedown(u,p),z()}move(u,p){const _=this.map,S=this.mouseRotate.mousemoveWindow(u,p),E=S&&S.bearingDelta;if(E&&_.setBearing(_.getBearing()+E),this.mousePitch){const O=this.mousePitch.mousemoveWindow(u,p),I=O&&O.pitchDelta;I&&_.setPitch(_.getPitch()+I)}}off(){const u=this.element;u.removeEventListener("mousedown",this.mousedown),u.removeEventListener("touchstart",this.touchstart,{passive:!1}),u.removeEventListener("touchmove",this.touchmove),u.removeEventListener("touchend",this.touchend),u.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){B(),s.window.removeEventListener("mousemove",this.mousemove),s.window.removeEventListener("mouseup",this.mouseup)}mousedown(u){this.down(s.extend({},u,{ctrlKey:!0,preventDefault:()=>u.preventDefault()}),H(this.element,u)),s.window.addEventListener("mousemove",this.mousemove),s.window.addEventListener("mouseup",this.mouseup)}mousemove(u){this.move(u,H(this.element,u))}mouseup(u){this.mouseRotate.mouseupWindow(u),this.mousePitch&&this.mousePitch.mouseupWindow(u),this.offTemp()}touchstart(u){u.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=Y(this.element,u.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>u.preventDefault()},this._startPos))}touchmove(u){u.targetTouches.length!==1?this.reset():(this._lastPos=Y(this.element,u.targetTouches)[0],this.move({preventDefault:()=>u.preventDefault()},this._lastPos))}touchend(u){u.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const kg={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},Og={maxWidth:100,unit:"metric"},Mg={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"},Gc={version:s.version,supported:b,setRTLTextPlugin:s.setRTLTextPlugin,getRTLTextPluginStatus:s.getRTLTextPluginStatus,Map:class extends df{constructor(g){if(s.LivePerformanceUtils.mark(s.PerformanceMarkers.create),(g=s.extend({},M0,g)).minZoom!=null&&g.maxZoom!=null&&g.minZoom>g.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(g.minPitch!=null&&g.maxPitch!=null&&g.minPitch>g.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(g.minPitch!=null&&g.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(g.maxPitch!=null&&g.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(g.antialias&&s.isSafariWithAntialiasingBug(s.window)&&(g.antialias=!1,s.warnOnce("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new Nc(g.minZoom,g.maxZoom,g.minPitch,g.maxPitch,g.renderWorldCopies),g),this._interactive=g.interactive,this._minTileCacheSize=g.minTileCacheSize,this._maxTileCacheSize=g.maxTileCacheSize,this._failIfMajorPerformanceCaveat=g.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=g.preserveDrawingBuffer,this._antialias=g.antialias,this._useWebGL2=g.useWebGL2,this._trackResize=g.trackResize,this._bearingSnap=g.bearingSnap,this._refreshExpiredTiles=g.refreshExpiredTiles,this._fadeDuration=g.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=g.crossSourceCollisions,this._collectResourceTiming=g.collectResourceTiming,this._optimizeForTerrain=g.optimizeForTerrain,this._language=this._parseLanguage(g.language),this._worldview=g.worldview,this._renderTaskQueue=new Ag,this._domRenderTaskQueue=new Ag,this._controls=[],this._markers=[],this._popups=[],this._mapId=s.uniqueId(),this._locale=s.extend({},O0,g.locale),this._clickTolerance=g.clickTolerance,this._cooperativeGestures=g.cooperativeGestures,this._performanceMetricsCollection=g.performanceMetricsCollection,this._containerWidth=0,this._containerHeight=0,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new Cg(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._requestManager=new s.RequestManager(g.transformRequest,g.accessToken,g.testMode),this._silenceAuthErrors=!!g.testMode,typeof g.container=="string"){if(this._container=s.window.document.getElementById(g.container),!this._container)throw new Error(`Container '${g.container}' not found.`)}else{if(!(g.container instanceof s.window.HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=g.container}if(this._container.childNodes.length>0&&s.warnOnce("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),g.maxBounds&&this.setMaxBounds(g.maxBounds),s.bindAll(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),s.window!==void 0&&(s.window.addEventListener("online",this._onWindowOnline,!1),s.window.addEventListener("resize",this._onWindowResize,!1),s.window.addEventListener("orientationchange",this._onWindowResize,!1),s.window.addEventListener("webkitfullscreenchange",this._onWindowResize,!1),s.window.addEventListener("visibilitychange",this._onVisibilityChange,!1)),this.handlers=new Ls(this,g),this._localFontFamily=g.localFontFamily,this._localIdeographFontFamily=g.localIdeographFontFamily,g.style&&this.setStyle(g.style,{localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),g.projection&&this.setProjection(g.projection),this._hash=g.hash&&new gg(typeof g.hash=="string"&&g.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:g.center,zoom:g.zoom,bearing:g.bearing,pitch:g.pitch}),g.bounds&&(this.resize(),this.fitBounds(g.bounds,s.extend({},g.fitBoundsOptions,{duration:0})))),this.resize(),g.attributionControl&&this.addControl(new jt({customAttribution:g.customAttribution})),this._logoControl=new Eg,this.addControl(this._logoControl,g.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",u=>{this._update(u.dataType==="style"),this.fire(new s.Event(`${u.dataType}data`,u))}),this.on("dataloading",u=>{this.fire(new s.Event(`${u.dataType}dataloading`,u))})}_getMapId(){return this._mapId}addControl(g,u){if(u===void 0&&(u=g.getDefaultPosition?g.getDefaultPosition():"top-right"),!g||!g.onAdd)return this.fire(new s.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const p=g.onAdd(this);this._controls.push(g);const _=this._controlPositions[u];return u.indexOf("bottom")!==-1?_.insertBefore(p,_.firstChild):_.appendChild(p),this}removeControl(g){if(!g||!g.onRemove)return this.fire(new s.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const u=this._controls.indexOf(g);return u>-1&&this._controls.splice(u,1),g.onRemove(this),this}hasControl(g){return this._controls.indexOf(g)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(g){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const u=!this._moving;return u&&this.fire(new s.Event("movestart",g)).fire(new s.Event("move",g)),this.fire(new s.Event("resize",g)),u&&this.fire(new s.Event("moveend",g)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(g){return this.transform.setMaxBounds(s.LngLatBounds.convert(g)),this._update()}setMinZoom(g){if((g=g??-2)>=-2&&g<=this.transform.maxZoom)return this.transform.minZoom=g,this._update(),this.getZoom()<g?this.setZoom(g):this.fire(new s.Event("zoomstart")).fire(new s.Event("zoom")).fire(new s.Event("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(g){if((g=g??22)>=this.transform.minZoom)return this.transform.maxZoom=g,this._update(),this.getZoom()>g?this.setZoom(g):this.fire(new s.Event("zoomstart")).fire(new s.Event("zoom")).fire(new s.Event("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(g){if((g=g??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(g>=0&&g<=this.transform.maxPitch)return this.transform.minPitch=g,this._update(),this.getPitch()<g?this.setPitch(g):this.fire(new s.Event("pitchstart")).fire(new s.Event("pitch")).fire(new s.Event("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(g){if((g=g??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(g>=this.transform.minPitch)return this.transform.maxPitch=g,this._update(),this.getPitch()>g?this.setPitch(g):this.fire(new s.Event("pitchstart")).fire(new s.Event("pitch")).fire(new s.Event("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(g){return this.transform.renderWorldCopies=g,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(g){return g==="auto"?s.window.navigator.language:Array.isArray(g)?g.length===0?void 0:g.map(u=>u==="auto"?s.window.navigator.language:u):g}setLanguage(g){const u=this._parseLanguage(g);if(!this.style||u===this._language)return this;this._language=u,this.style._reloadSources();for(const p of this._controls)p._setLanguage&&p._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(g){return this.style&&g!==this._worldview?(this._worldview=g,this.style._reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return this.transform.projection.name==="globe"}setProjection(g){return this._lazyInitEmptyStyle(),g?typeof g=="string"&&(g={name:g}):g=null,this._useExplicitProjection=!!g,this._prioritizeAndUpdateProjection(g,this.style.stylesheet?this.style.stylesheet.projection:null)}_updateProjectionTransition(){if(this.getProjection().name!=="globe")return;const g=this.transform,u=g.projection.name;let p;u==="globe"&&g.zoom>=s.GLOBE_ZOOM_THRESHOLD_MAX?(g.setMercatorFromTransition(),p=!0):u==="mercator"&&g.zoom<s.GLOBE_ZOOM_THRESHOLD_MAX&&(g.setProjection({name:"globe"}),p=!0),p&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(g,u){return this._updateProjection(g||u||{name:"mercator"})}_updateProjection(g){let u;if(u=g.name==="globe"&&this.transform.zoom>=s.GLOBE_ZOOM_THRESHOLD_MAX?this.transform.setMercatorFromTransition():this.transform.setProjection(g),this.style.applyProjectionUpdate(),u){this.painter.clearBackgroundTiles();for(const p in this.style._sourceCaches)this.style._sourceCaches[p].clearTiles();this._update(!0),this._forceMarkerAndPopupUpdate(!0)}return this}project(g){return this.transform.locationPoint3D(s.LngLat.convert(g))}unproject(g){return this.transform.pointLocation3D(s.Point.convert(g))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(g,u,p){if(g==="mouseenter"||g==="mouseover"){let _=!1;const S=O=>{const I=u.filter(G=>this.getLayer(G)),N=I.length?this.queryRenderedFeatures(O.point,{layers:I}):[];N.length?_||(_=!0,p.call(this,new di(g,this,O.originalEvent,{features:N}))):_=!1},E=()=>{_=!1};return{layers:new Set(u),listener:p,delegates:{mousemove:S,mouseout:E}}}if(g==="mouseleave"||g==="mouseout"){let _=!1;const S=O=>{const I=u.filter(N=>this.getLayer(N));(I.length?this.queryRenderedFeatures(O.point,{layers:I}):[]).length?_=!0:_&&(_=!1,p.call(this,new di(g,this,O.originalEvent)))},E=O=>{_&&(_=!1,p.call(this,new di(g,this,O.originalEvent)))};return{layers:new Set(u),listener:p,delegates:{mousemove:S,mouseout:E}}}{const _=S=>{const E=u.filter(I=>this.getLayer(I)),O=E.length?this.queryRenderedFeatures(S.point,{layers:E}):[];O.length&&(S.features=O,p.call(this,S),delete S.features)};return{layers:new Set(u),listener:p,delegates:{[g]:_}}}}on(g,u,p){if(p===void 0)return super.on(g,u);Array.isArray(u)||(u=[u]);const _=this._createDelegatedListener(g,u,p);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[g]=this._delegatedListeners[g]||[],this._delegatedListeners[g].push(_);for(const S in _.delegates)this.on(S,_.delegates[S]);return this}once(g,u,p){if(p===void 0)return super.once(g,u);Array.isArray(u)||(u=[u]);const _=this._createDelegatedListener(g,u,p);for(const S in _.delegates)this.once(S,_.delegates[S]);return this}off(g,u,p){if(p===void 0)return super.off(g,u);u=new Set(Array.isArray(u)?u:[u]);const _=(E,O)=>{if(E.size!==O.size)return!1;for(const I of E)if(!O.has(I))return!1;return!0},S=this._delegatedListeners?this._delegatedListeners[g]:void 0;return S&&(E=>{for(let O=0;O<E.length;O++){const I=E[O];if(I.listener===p&&_(I.layers,u)){for(const N in I.delegates)this.off(N,I.delegates[N]);return E.splice(O,1),this}}})(S),this}queryRenderedFeatures(g,u){return this.style?(u!==void 0||g===void 0||g instanceof s.Point||Array.isArray(g)||(u=g,g=void 0),this.style.queryRenderedFeatures(g=g||[[0,0],[this.transform.width,this.transform.height]],u=u||{},this.transform)):[]}querySourceFeatures(g,u){return this.style.querySourceFeatures(g,u)}isPointOnSurface(g){const{name:u}=this.transform.projection;return u!=="globe"&&u!=="mercator"&&s.warnOnce(`${u} projection does not support isPointOnSurface, this API may behave unexpectedly.`),this.transform.isPointOnSurface(s.Point.convert(g))}setStyle(g,u){return(u=s.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},u)).diff!==!1&&u.localIdeographFontFamily===this._localIdeographFontFamily&&u.localFontFamily===this._localFontFamily&&this.style&&g?(this._diffStyle(g,u),this):(this._localIdeographFontFamily=u.localIdeographFontFamily,this._localFontFamily=u.localFontFamily,this._updateStyle(g,u))}_getUIString(g){const u=this._locale[g];if(u==null)throw new Error(`Missing UI string '${g}'`);return u}_updateStyle(g,u){return this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),g&&(this.style=new Rs(this,u||{}),this.style.setEventedParent(this,{style:this.style}),typeof g=="string"?this.style.loadURL(g):this.style.loadJSON(g)),this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new Rs(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(g,u){if(typeof g=="string"){const p=this._requestManager.normalizeStyleURL(g),_=this._requestManager.transformRequest(p,s.ResourceType.Style);s.getJSON(_,(S,E)=>{S?this.fire(new s.ErrorEvent(S)):E&&this._updateDiff(E,u)})}else typeof g=="object"&&this._updateDiff(g,u)}_updateDiff(g,u){try{this.style.setState(g)&&this._update(!0)}catch(p){s.warnOnce(`Unable to perform style diff: ${p.message||p.error||p}.  Rebuilding the style from scratch.`),this._updateStyle(g,u)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(s.warnOnce("There is no style added to the map."),!1)}addSource(g,u){return this._lazyInitEmptyStyle(),this.style.addSource(g,u),this._update(!0)}isSourceLoaded(g){return!!this.style&&this.style._isSourceCacheLoaded(g)}areTilesLoaded(){const g=this.style&&this.style._sourceCaches;for(const u in g){const p=g[u]._tiles;for(const _ in p){const S=p[_];if(S.state!=="loaded"&&S.state!=="errored")return!1}}return!0}addSourceType(g,u,p){this._lazyInitEmptyStyle(),this.style.addSourceType(g,u,p)}removeSource(g){return this.style.removeSource(g),this._updateTerrain(),this._update(!0)}getSource(g){return this.style.getSource(g)}addImage(g,u,{pixelRatio:p=1,sdf:_=!1,stretchX:S,stretchY:E,content:O}={}){if(this._lazyInitEmptyStyle(),u instanceof s.window.HTMLImageElement||s.window.ImageBitmap&&u instanceof s.window.ImageBitmap){const{width:I,height:N,data:G}=s.exported.getImageData(u);this.style.addImage(g,{data:new s.RGBAImage({width:I,height:N},G),pixelRatio:p,stretchX:S,stretchY:E,content:O,sdf:_,version:0})}else if(u.width===void 0||u.height===void 0)this.fire(new s.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:I,height:N}=u,G=u;this.style.addImage(g,{data:new s.RGBAImage({width:I,height:N},new Uint8Array(G.data)),pixelRatio:p,stretchX:S,stretchY:E,content:O,sdf:_,version:0,userImage:G}),G.onAdd&&G.onAdd(this,g)}}updateImage(g,u){const p=this.style.getImage(g);if(!p)return void this.fire(new s.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const _=u instanceof s.window.HTMLImageElement||s.window.ImageBitmap&&u instanceof s.window.ImageBitmap?s.exported.getImageData(u):u,{width:S,height:E}=_;S!==void 0&&E!==void 0?S===p.data.width&&E===p.data.height?(p.data.replace(_.data,!(u instanceof s.window.HTMLImageElement||s.window.ImageBitmap&&u instanceof s.window.ImageBitmap)),this.style.updateImage(g,p)):this.fire(new s.ErrorEvent(new Error(`The width and height of the updated image (${S}, ${E})
                must be that same as the previous version of the image
                (${p.data.width}, ${p.data.height})`))):this.fire(new s.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")))}hasImage(g){return g?!!this.style.getImage(g):(this.fire(new s.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(g){this.style.removeImage(g)}loadImage(g,u){s.getImage(this._requestManager.transformRequest(g,s.ResourceType.Image),(p,_)=>{u(p,_ instanceof s.window.HTMLImageElement?s.exported.getImageData(_):_)})}listImages(){return this.style.listImages()}addLayer(g,u){return this._lazyInitEmptyStyle(),this.style.addLayer(g,u),this._update(!0)}moveLayer(g,u){return this.style.moveLayer(g,u),this._update(!0)}removeLayer(g){return this.style.removeLayer(g),this._update(!0)}getLayer(g){return this.style.getLayer(g)}setLayerZoomRange(g,u,p){return this.style.setLayerZoomRange(g,u,p),this._update(!0)}setFilter(g,u,p={}){return this.style.setFilter(g,u,p),this._update(!0)}getFilter(g){return this.style.getFilter(g)}setPaintProperty(g,u,p,_={}){return this.style.setPaintProperty(g,u,p,_),this._update(!0)}getPaintProperty(g,u){return this.style.getPaintProperty(g,u)}setLayoutProperty(g,u,p,_={}){return this.style.setLayoutProperty(g,u,p,_),this._update(!0)}getLayoutProperty(g,u){return this.style.getLayoutProperty(g,u)}setLight(g,u={}){return this._lazyInitEmptyStyle(),this.style.setLight(g,u),this._update(!0)}getLight(){return this.style.getLight()}setTerrain(g){return this._lazyInitEmptyStyle(),!g&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(g),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(g){return this._lazyInitEmptyStyle(),this.style.setFog(g),this._update(!0)}getFog(){return this.style?this.style.getFog():null}_queryFogOpacity(g){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(s.LngLat.convert(g),this.transform):0}setFeatureState(g,u){return this.style.setFeatureState(g,u),this._update()}removeFeatureState(g,u){return this.style.removeFeatureState(g,u),this._update()}getFeatureState(g){return this.style.getFeatureState(g)}_updateContainerDimensions(){if(!this._container)return;const g=this._container.getBoundingClientRect().width||400,u=this._container.getBoundingClientRect().height||300;let p,_,S,E=this._container;for(;E&&(!_||!S);){const O=s.window.getComputedStyle(E).transform;O&&O!=="none"&&(p=O.match(/matrix.*\((.+)\)/)[1].split(", "),p[0]&&p[0]!=="0"&&p[0]!=="1"&&(_=p[0]),p[3]&&p[3]!=="0"&&p[3]!=="1"&&(S=p[3])),E=E.parentElement}this._containerWidth=_?Math.abs(g/_):g,this._containerHeight=S?Math.abs(u/S):u}_detectMissingCSS(){s.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&s.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const g=this._container;g.classList.add("mapboxgl-map"),(this._missingCSSCanary=k("div","mapboxgl-canary",g)).style.visibility="hidden",this._detectMissingCSS();const u=this._canvasContainer=k("div","mapboxgl-canvas-container",g);this._interactive&&u.classList.add("mapboxgl-interactive"),this._canvas=k("canvas","mapboxgl-canvas",u),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const p=this._controlContainer=k("div","mapboxgl-control-container",g),_=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(S=>{_[S]=k("div",`mapboxgl-ctrl-${S}`,p)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(g,u){const p=s.exported.devicePixelRatio||1;this._canvas.width=p*Math.ceil(g),this._canvas.height=p*Math.ceil(u),this._canvas.style.width=`${g}px`,this._canvas.style.height=`${u}px`}_addMarker(g){this._markers.push(g)}_removeMarker(g){const u=this._markers.indexOf(g);u!==-1&&this._markers.splice(u,1)}_addPopup(g){this._popups.push(g)}_removePopup(g){const u=this._popups.indexOf(g);u!==-1&&this._popups.splice(u,1)}_setupPainter(){const g=s.extend({},b.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),u=this._useWebGL2&&this._canvas.getContext("webgl2",g),p=u||this._canvas.getContext("webgl",g)||this._canvas.getContext("experimental-webgl",g);p?(this._useWebGL2&&!u&&s.warnOnce("Failed to create WebGL 2 context. Using WebGL 1."),s.storeAuthState(p,!0),this.painter=new zc(p,this.transform,!!u),this.on("data",_=>{_.dataType==="source"&&this.painter.setTileLoadedFlag(!0)}),s.exported$1.testSupport(p)):this.fire(new s.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(g){g.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new s.Event("webglcontextlost",{originalEvent:g}))}_contextRestored(g){this._setupPainter(),this.resize(),this._update(),this.fire(new s.Event("webglcontextrestored",{originalEvent:g}))}_onMapScroll(g){if(g.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(g){return this.style?(this._styleDirty=this._styleDirty||g,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(g){return this._update(),this._renderTaskQueue.add(g)}_cancelRenderFrame(g){this._renderTaskQueue.remove(g)}_requestDomTask(g){!this.loaded()||this.loaded()&&!this.isMoving()?g():this._domRenderTaskQueue.add(g)}_render(g){let u;const p=this.painter.context.extTimerQuery,_=s.exported.now();if(this.listens("gpu-timing-frame")&&(u=p.createQueryEXT(),p.beginQueryEXT(p.TIME_ELAPSED_EXT,u)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],s.window.performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],s.window.performance.now())),this._renderTaskQueue.run(g),this._domRenderTaskQueue.run(g),this._removed)return;this._updateProjectionTransition();const S=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const I=this.transform.zoom,N=this.transform.pitch,G=s.exported.now(),V=new s.EvaluationParameters(I,{now:G,fadeDuration:S,pitch:N,transition:this.style.getTransition()});this.style.update(V)}this.style&&this.style.fog&&this.style.fog.hasTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let E=!1;if(this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),E=this._updateAverageElevation(_),this.style._updateSources(this.transform),this._forceMarkerAndPopupUpdate()):E=this._updateAverageElevation(_),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,S,this._crossSourceCollisions),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showTerrainWireframe:this.showTerrainWireframe,showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:S,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new s.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new s.Event("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),u){const I=s.exported.now()-_;p.endQueryEXT(p.TIME_ELAPSED_EXT,u),setTimeout(()=>{const N=p.getQueryObjectEXT(u,p.QUERY_RESULT_EXT)/1e6;p.deleteQueryEXT(u),this.fire(new s.Event("gpu-timing-frame",{cpuTime:I,gpuTime:N})),s.window.performance.mark("frame-gpu",{startTime:_,detail:{gpuTime:N}})},50)}if(this.listens("gpu-timing-layer")){const I=this.painter.collectGpuTimers();setTimeout(()=>{const N=this.painter.queryGpuTimers(I);this.fire(new s.Event("gpu-timing-layer",{layerTimes:N}))},50)}if(this.listens("gpu-timing-deferred-render")){const I=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const N=this.painter.queryGpuTimeDeferredRender(I);this.fire(new s.Event("gpu-timing-deferred-render",{gpuTime:N}))},50)}const O=this._sourcesDirty||this._styleDirty||this._placementDirty||E;if(O||this._repaint)this.triggerRepaint();else{const I=!this.isMoving()&&this.loaded();if(I&&(E=this._updateAverageElevation(_,!0)),E)this.triggerRepaint();else if(this._triggerFrame(!1),I&&(this.fire(new s.Event("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const N=this._calculateSpeedIndex();this.fire(new s.Event("speedindexcompleted",{speedIndex:N})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||O||(this._fullyLoaded=!0,s.LivePerformanceUtils.mark(s.PerformanceMarkers.fullLoad),this._performanceMetricsCollection&&s.postPerformanceEvent(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(g){for(const u of this._markers)g&&!this.getRenderWorldCopies()&&(u._lngLat=u._lngLat.wrap()),u._update();for(const u of this._popups)!g||this.getRenderWorldCopies()||u._trackPointer||(u._lngLat=u._lngLat.wrap()),u._update()}_updateAverageElevation(g,u=!1){const p=_=>(this.transform.averageElevation=_,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&p(0);if((u||g-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(g)){const _=this.transform.averageElevation;let S=this.transform.sampleAverageElevation(),E=!1;this.transform.elevation&&(E=this.transform.elevation.exaggeration()!==this._averageElevationExaggeration,this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(S)?S=0:this._averageElevationLastSampledAt=g;const O=Math.abs(_-S);if(O>1){if(this._isInitialLoad||E)return this._averageElevation.jumpTo(S),p(S);this._averageElevation.easeTo(S,g,300)}else if(O>1e-4)return this._averageElevation.jumpTo(S),p(S)}return!!this._averageElevation.isEasing(g)&&p(this._averageElevation.getValue(g))}_authenticate(){s.getMapSessionAPI(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,g=>{if(g&&(g.message===s.AUTH_ERR_MSG||g.status===401)){const u=this.painter.context.gl;s.storeAuthState(u,!1),this._logoControl instanceof Eg&&this._logoControl._updateLogo(),u&&u.clear(u.DEPTH_BUFFER_BIT|u.COLOR_BUFFER_BIT|u.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new s.ErrorEvent(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),s.postMapLoadEvent(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_updateTerrain(){const g=this._isDragging();this.painter.updateTerrain(this.style,g)}_calculateSpeedIndex(){const g=this.painter.canvasCopy(),u=this.painter.getCanvasCopiesAndTimestamps();u.timeStamps.push(performance.now());const p=this.painter.context.gl,_=p.createFramebuffer();function S(E){p.framebufferTexture2D(p.FRAMEBUFFER,p.COLOR_ATTACHMENT0,p.TEXTURE_2D,E,0);const O=new Uint8Array(p.drawingBufferWidth*p.drawingBufferHeight*4);return p.readPixels(0,0,p.drawingBufferWidth,p.drawingBufferHeight,p.RGBA,p.UNSIGNED_BYTE,O),O}return p.bindFramebuffer(p.FRAMEBUFFER,_),this._canvasPixelComparison(S(g),u.canvasCopies.map(S),u.timeStamps)}_canvasPixelComparison(g,u,p){let _=p[1]-p[0];const S=g.length/4;for(let E=0;E<u.length;E++){const O=u[E];let I=0;for(let N=0;N<O.length;N+=4)O[N]===g[N]&&O[N+1]===g[N+1]&&O[N+2]===g[N+2]&&O[N+3]===g[N+3]&&(I+=1);_+=(p[E+2]-p[E+1])*(1-I/S)}return _}remove(){this._hash&&this._hash.remove();for(const u of this._controls)u.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),s.window!==void 0&&(s.window.removeEventListener("resize",this._onWindowResize,!1),s.window.removeEventListener("orientationchange",this._onWindowResize,!1),s.window.removeEventListener("webkitfullscreenchange",this._onWindowResize,!1),s.window.removeEventListener("online",this._onWindowOnline,!1),s.window.removeEventListener("visibilitychange",this._onVisibilityChange,!1));const g=this.painter.context.gl.getExtension("WEBGL_lose_context");g&&g.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),s.removeAuthState(this.painter.context.gl),this._removed=!0,this.fire(new s.Event("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(g){this._renderNextFrame=this._renderNextFrame||g,this.style&&!this._frame&&(this._frame=s.exported.frame(u=>{const p=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,p&&this._render(u)}))}_preloadTiles(g){const u=this.style?Object.values(this.style._sourceCaches):[];return s.asyncAll(u,(p,_)=>p._preloadTiles(g,_),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(g){this._trackResize&&this.resize({originalEvent:g})._update()}_onVisibilityChange(){s.window.document.visibilityState==="hidden"&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(g){this._showTileBoundaries!==g&&(this._showTileBoundaries=g,this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(g){this._showTerrainWireframe!==g&&(this._showTerrainWireframe=g,this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(g){this._speedIndexTiming!==g&&(this._speedIndexTiming=g,this._update())}get showPadding(){return!!this._showPadding}set showPadding(g){this._showPadding!==g&&(this._showPadding=g,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(g){this._showCollisionBoxes!==g&&(this._showCollisionBoxes=g,g?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(g){this._showOverdrawInspector!==g&&(this._showOverdrawInspector=g,this._update())}get repaint(){return!!this._repaint}set repaint(g){this._repaint!==g&&(this._repaint=g,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(g){this._vertices=g,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(g){this._showTileAABBs!==g&&(this._showTileAABBs=g,g&&this._update())}_setCacheLimits(g,u){s.setCacheLimits(g,u)}get version(){return s.version}},NavigationControl:class{constructor(g){this.options=s.extend({},nT,g),this._container=k("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",u=>u.preventDefault()),this.options.showZoom&&(s.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",u=>{this._map&&this._map.zoomIn({},{originalEvent:u})}),k("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",u=>{this._map&&this._map.zoomOut({},{originalEvent:u})}),k("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(s.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",u=>{const p=this._map;p&&(this.options.visualizePitch?p.resetNorthPitch({},{originalEvent:u}):p.resetNorth({},{originalEvent:u}))}),this._compassIcon=k("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const g=this._map;if(!g)return;const u=g.getZoom(),p=u===g.getMaxZoom(),_=u===g.getMinZoom();this._zoomInButton.disabled=p,this._zoomOutButton.disabled=_,this._zoomInButton.setAttribute("aria-disabled",p.toString()),this._zoomOutButton.setAttribute("aria-disabled",_.toString())}_rotateCompassArrow(){const g=this._map;if(!g)return;const u=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(g.transform.pitch*(Math.PI/180)),.5)}) rotateX(${g.transform.pitch}deg) rotateZ(${g.transform.angle*(180/Math.PI)}deg)`:`rotate(${g.transform.angle*(180/Math.PI)}deg)`;g._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=u)})}onAdd(g){return this._map=g,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),g.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&g.on("pitch",this._rotateCompassArrow),g.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new iT(g,this._compass,this.options.visualizePitch)),this._container}onRemove(){const g=this._map;g&&(this._container.remove(),this.options.showZoom&&g.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&g.off("pitch",this._rotateCompassArrow),g.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(g,u){const p=k("button",g,this._container);return p.type="button",p.addEventListener("click",u),p}_setButtonTitle(g,u){if(!this._map)return;const p=this._map._getUIString(`NavigationControl.${u}`);g.setAttribute("aria-label",p),g.firstElementChild&&g.firstElementChild.setAttribute("title",p)}},GeolocateControl:class extends s.Evented{constructor(g){super(),this.options=s.extend({geolocation:s.window.navigator.geolocation},kg,g),s.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=$c(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(g){return this._map=g,this._container=k("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(g){const u=(p=!!this.options.geolocation)=>{this._supportsGeolocation=p,g(p)};this._supportsGeolocation!==void 0?g(this._supportsGeolocation):s.window.navigator.permissions!==void 0?s.window.navigator.permissions.query({name:"geolocation"}).then(p=>u(p.state!=="denied")).catch(()=>u()):u()}_isOutOfMapMaxBounds(g){const u=this._map.getMaxBounds(),p=g.coords;return!!u&&(p.longitude<u.getWest()||p.longitude>u.getEast()||p.latitude<u.getSouth()||p.latitude>u.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(g){if(this._map){if(this._isOutOfMapMaxBounds(g))return this._setErrorState(),this.fire(new s.Event("outofmaxbounds",g)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=g,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(g),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(g),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new s.Event("geolocate",g)),this._finish()}}_updateCamera(g){const u=new s.LngLat(g.coords.longitude,g.coords.latitude),p=g.coords.accuracy,_=this._map.getBearing(),S=s.extend({bearing:_},this.options.fitBoundsOptions);this._map.fitBounds(u.toBounds(p),S,{geolocateSource:!0})}_updateMarker(g){if(g){const u=new s.LngLat(g.coords.longitude,g.coords.latitude);this._accuracyCircleMarker.setLngLat(u).addTo(this._map),this._userLocationDotMarker.setLngLat(u).addTo(this._map),this._accuracy=g.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const g=this._map.transform,u=s.mercatorZfromAltitude(1,g._center.lat)*g.worldSize,p=Math.ceil(2*this._accuracy*u);this._circleElement.style.width=`${p}px`,this._circleElement.style.height=`${p}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._dotElement.classList.add("mapboxgl-user-location-show-heading")):(this._dotElement.classList.remove("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(g){if(this._map){if(this.options.trackUserLocation)if(g.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const u=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",u),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",u),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(g.code===3&&this._noTimeout)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new s.Event("error",g)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(g){if(this._map!==void 0){if(this._container.addEventListener("contextmenu",u=>u.preventDefault()),this._geolocateButton=k("button","mapboxgl-ctrl-geolocate",this._container),k("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",g===!1){s.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const u=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",u),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",u)}else{const u=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",u),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",u)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=k("div","mapboxgl-user-location"),this._dotElement.appendChild(k("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(k("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new Ot({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=k("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Ot({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",u=>{u.geolocateSource||this._watchState!=="ACTIVE_LOCK"||u.originalEvent&&u.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new s.Event("trackuserlocationend")))})}}_onDeviceOrientation(g){this._userLocationDotMarker&&(g.webkitCompassHeading?this._heading=g.webkitCompassHeading:g.absolute===!0&&(this._heading=-1*g.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return s.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new s.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new s.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new s.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let g;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(g={maximumAge:6e5,timeout:0},this._noTimeout=!0):(g=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,g),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const g=()=>{s.window.addEventListener("ondeviceorientationabsolute"in s.window?"deviceorientationabsolute":"deviceorientation",this._onDeviceOrientation)};s.window.DeviceMotionEvent!==void 0&&typeof s.window.DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(u=>{u==="granted"&&g()}).catch(console.error):g()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),s.window.removeEventListener("deviceorientation",this._onDeviceOrientation),s.window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:jt,ScaleControl:class{constructor(g){this.options=s.extend({},Og,g),this._isNumberFormatSupported=function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch{return!1}}(),s.bindAll(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const g=this.options.maxWidth||100,u=this._map,p=u._containerHeight/2,_=u._containerWidth/2-g/2,S=u.unproject([_,p]),E=u.unproject([_+g,p]),O=S.distanceTo(E);if(this.options.unit==="imperial"){const I=3.2808*O;I>5280?this._setScale(g,I/5280,"mile"):this._setScale(g,I,"foot")}else this.options.unit==="nautical"?this._setScale(g,O/1852,"nautical-mile"):O>=1e3?this._setScale(g,O/1e3,"kilometer"):this._setScale(g,O,"meter")}_setScale(g,u,p){this._map._requestDomTask(()=>{const _=function(E){const O=Math.pow(10,`${Math.floor(E)}`.length-1);let I=E/O;return I=I>=10?10:I>=5?5:I>=3?3:I>=2?2:I>=1?1:function(N){const G=Math.pow(10,Math.ceil(-Math.log(N)/Math.LN10));return Math.round(N*G)/G}(I),O*I}(u),S=_/u;this._container.innerHTML=this._isNumberFormatSupported&&p!=="nautical-mile"?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:p}).format(_):`${_}&nbsp;${Mg[p]}`,this._container.style.width=g*S+"px"})}onAdd(g){return this._map=g,this._language=g.getLanguage(),this._container=k("div","mapboxgl-ctrl mapboxgl-ctrl-scale",g.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(g){this._language=g,this._update()}setUnit(g){this.options.unit=g,this._update()}},FullscreenControl:class{constructor(g){this._fullscreen=!1,g&&g.container&&(g.container instanceof s.window.HTMLElement?this._container=g.container:s.warnOnce("Full screen control 'container' must be a DOM element.")),s.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in s.window.document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in s.window.document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(g){return this._map=g,this._container||(this._container=this._map.getContainer()),this._controlContainer=k("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",s.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,s.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!s.window.document.fullscreenEnabled&&!s.window.document.webkitFullscreenEnabled)}_setupUI(){const g=this._fullscreenButton=k("button","mapboxgl-ctrl-fullscreen",this._controlContainer);k("span","mapboxgl-ctrl-icon",g).setAttribute("aria-hidden","true"),g.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),s.window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const g=this._getTitle();this._fullscreenButton.setAttribute("aria-label",g),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",g)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(s.window.document.fullscreenElement||s.window.document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?s.window.document.exitFullscreen?s.window.document.exitFullscreen():s.window.document.webkitCancelFullScreen&&s.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends s.Evented{constructor(g){super(),this.options=s.extend(Object.create(Pg),g),s.bindAll(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(g&&g.className?g.className.trim().split(/\s+/):[])}addTo(g){return this._map&&this.remove(),this._map=g,this.options.closeOnClick&&g.on("preclick",this._onClose),this.options.closeOnMove&&g.on("move",this._onClose),g.on("remove",this.remove),this._update(),g._addPopup(this),this._focusFirstElement(),this._trackPointer?(g.on("mousemove",this._onMouseEvent),g.on("mouseup",this._onMouseEvent),g._canvasContainer.classList.add("mapboxgl-track-pointer")):g.on("move",this._update),this.fire(new s.Event("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const g=this._map;return g&&(g.off("move",this._update),g.off("move",this._onClose),g.off("preclick",this._onClose),g.off("click",this._onClose),g.off("remove",this.remove),g.off("mousemove",this._onMouseEvent),g.off("mouseup",this._onMouseEvent),g.off("drag",this._onMouseEvent),g._canvasContainer&&g._canvasContainer.classList.remove("mapboxgl-track-pointer"),g._removePopup(this),this._map=void 0),this.fire(new s.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(g){this._lngLat=s.LngLat.convert(g),this._pos=null,this._trackPointer=!1,this._update();const u=this._map;return u&&(u.on("move",this._update),u.off("mousemove",this._onMouseEvent),u._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const g=this._map;return g&&(g.off("move",this._update),g.on("mousemove",this._onMouseEvent),g.on("drag",this._onMouseEvent),g._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(g){return this.setDOMContent(s.window.document.createTextNode(g))}setHTML(g){const u=s.window.document.createDocumentFragment(),p=s.window.document.createElement("body");let _;for(p.innerHTML=g;_=p.firstChild,_;)u.appendChild(_);return this.setDOMContent(u)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(g){return this.options.maxWidth=g,this._update(),this}setDOMContent(g){let u=this._content;if(u)for(;u.hasChildNodes();)u.firstChild&&u.removeChild(u.firstChild);else u=this._content=k("div","mapboxgl-popup-content",this._container||void 0);if(u.appendChild(g),this.options.closeButton){const p=this._closeButton=k("button","mapboxgl-popup-close-button",u);p.type="button",p.setAttribute("aria-label","Close popup"),p.setAttribute("aria-hidden","true"),p.innerHTML="&#215;",p.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(g){return this._classList.add(g),this._updateClassList(),this}removeClassName(g){return this._classList.delete(g),this._updateClassList(),this}setOffset(g){return this.options.offset=g,this._update(),this}toggleClassName(g){let u;return this._classList.delete(g)?u=!1:(this._classList.add(g),u=!0),this._updateClassList(),u}_onMouseEvent(g){this._update(g.point)}_getAnchor(g){if(this.options.anchor)return this.options.anchor;const u=this._map,p=this._container,_=this._pos;if(!u||!p||!_)return"bottom";const S=p.offsetWidth,E=p.offsetHeight,O=_.x<S/2,I=_.x>u.transform.width-S/2;if(_.y+g<E)return O?"top-left":I?"top-right":"top";if(_.y>u.transform.height-E){if(O)return"bottom-left";if(I)return"bottom-right"}return O?"left":I?"right":"bottom"}_updateClassList(){const g=this._container;if(!g)return;const u=[...this._classList];u.push("mapboxgl-popup"),this._anchor&&u.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&u.push("mapboxgl-popup-track-pointer"),g.className=u.join(" ")}_update(g){const u=this._map,p=this._content;if(!u||!this._lngLat&&!this._trackPointer||!p)return;let _=this._container;if(_||(_=this._container=k("div","mapboxgl-popup",u.getContainer()),this._tip=k("div","mapboxgl-popup-tip",_),_.appendChild(p)),this.options.maxWidth&&_.style.maxWidth!==this.options.maxWidth&&(_.style.maxWidth=this.options.maxWidth),u.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Vc(this._lngLat,this._pos,u.transform)),!this._trackPointer||g){const S=this._pos=this._trackPointer&&g?g:u.project(this._lngLat),E=k0(this.options.offset),O=this._anchor=this._getAnchor(E.y),I=k0(this.options.offset,O),N=S.add(I).round();u._requestDomTask(()=>{this._container&&O&&(this._container.style.transform=`${Bl[O]} translate(${N.x}px,${N.y}px)`)})}if(!this._marker&&u._showingGlobe()){const S=s.isLngLatBehindGlobe(u.transform,this._lngLat)?0:1;this._setOpacity(S)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const g=this._container.querySelector(rT);g&&g.focus()}_onClose(){this.remove()}_setOpacity(g){this._container&&(this._container.style.opacity=`${g}`),this._content&&(this._content.style.pointerEvents=g?"auto":"none")}},Marker:Ot,Style:Rs,LngLat:s.LngLat,LngLatBounds:s.LngLatBounds,Point:s.Point,MercatorCoordinate:s.MercatorCoordinate,FreeCameraOptions:p0,Evented:s.Evented,config:s.config,prewarm:function(){Ya().acquire($o)},clearPrewarmedResources:function(){const g=wi;g&&(g.isPreloaded()&&g.numActive()===1?(g.release($o),wi=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return s.config.ACCESS_TOKEN},set accessToken(g){s.config.ACCESS_TOKEN=g},get baseApiUrl(){return s.config.API_URL},set baseApiUrl(g){s.config.API_URL=g},get workerCount(){return Bn.workerCount},set workerCount(g){Bn.workerCount=g},get maxParallelImageRequests(){return s.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(g){s.config.MAX_PARALLEL_IMAGE_REQUESTS=g},clearStorage(g){s.clearTileCache(g)},workerUrl:"",workerClass:null,setNow:s.exported.setNow,restoreNow:s.exported.restoreNow};return Gc});var f=l;return f})})(B8);var Uae=B8.exports;const Gf=mn(Uae),$8={async getRiskZones(){return(await Gi.get("/risk-zones")).data}};function uI({userLocation:e,sosMarkers:t=[],height:r="400px",onLocationUpdate:n,enableGeolocation:o=!0}){const l=re.useRef(null),h=re.useRef(null),[f,s]=re.useState([]),[y,b]=re.useState(!1),[w,A]=re.useState(!1),[k,M]=re.useState(null),R=re.useRef([]),j=re.useRef(null),L=re.useRef(null),z=re.useRef(!1),B=re.useRef([]),Z=re.useRef(!1);return re.useEffect(()=>{if(!l.current||z.current)return;if(!Gf.supported()){M("Mapbox is not supported in this browser/environment (WebGL unavailable).");return}const F="pk.eyJ1Ijoiaml0LXBhdGlsIiwiYSI6ImNta2U5ZzVxbjA0NDczanF6dzZqOG1keWYifQ.YHDoNLEbvo4UCoZJKiTrzg";z.current=!0,Gf.accessToken=F;const H=t.find(te=>Number.isFinite(te.lat)&&Number.isFinite(te.lng)),Y=e?[e.lng,e.lat]:H?[H.lng,H.lat]:[-122.4194,37.7749];try{h.current=new Gf.Map({container:l.current,style:"mapbox://styles/mapbox/satellite-streets-v12",center:Y,zoom:e||H?15:12}),h.current.on("load",()=>{var te;(te=h.current)==null||te.resize(),b(!0)}),h.current.on("error",te=>{var ue;const pe=((ue=te==null?void 0:te.error)==null?void 0:ue.message)||"Mapbox failed to load map resources.";M(pe)})}catch(te){M((te==null?void 0:te.message)||"Failed to initialize Mapbox map.");return}return o&&!e&&navigator.geolocation&&(navigator.geolocation.getCurrentPosition(te=>{const pe={lat:te.coords.latitude,lng:te.coords.longitude};h.current&&(h.current.setCenter([pe.lng,pe.lat]),n&&n(pe))},te=>{console.warn("Geolocation error:",te)}),L.current=navigator.geolocation.watchPosition(te=>{const pe={lat:te.coords.latitude,lng:te.coords.longitude};h.current&&j.current&&(j.current.setLngLat([pe.lng,pe.lat]),h.current.setCenter([pe.lng,pe.lat]),n&&n(pe))},te=>{console.warn("Geolocation watch error:",te)})),()=>{L.current!==null&&(navigator.geolocation.clearWatch(L.current),L.current=null),h.current&&(h.current.remove(),h.current=null,z.current=!1)}},[]),re.useEffect(()=>{$8.getRiskZones().then(F=>{s(F)}).catch(F=>{console.error("Failed to load risk zones:",F)})},[]),re.useEffect(()=>{if(!h.current||!y||f.length===0)return;const F=h.current;if(!F)return;const H=B.current,Y=f.map(te=>te.id);H.forEach(te=>{if(Y.includes(te))return;const pe=`risk-zone-${te}`,ue=`risk-zone-layer-${te}`,Ee=`${ue}-outline`;F.getLayer(Ee)&&F.removeLayer(Ee),F.getLayer(ue)&&F.removeLayer(ue),F.getSource(pe)&&F.removeSource(pe)}),f.forEach(te=>{var Oe;const pe=`risk-zone-${te.id}`,ue=`risk-zone-layer-${te.id}`,Ee=`${ue}-outline`;if(!(F!=null&&F.getSource(pe)))F==null||F.addSource(pe,{type:"geojson",data:{type:"Feature",geometry:te.polygon,properties:{name:te.name,type:te.type}}});else try{(Oe=F.getSource(pe))==null||Oe.setData({type:"Feature",geometry:te.polygon,properties:{name:te.name,type:te.type}})}catch{}F!=null&&F.getLayer(ue)?(F.setPaintProperty(ue,"fill-color",te.type==="high"?"#ef4444":"#10b981"),F.setPaintProperty(ue,"fill-opacity",te.type==="high"?.4:.3)):F==null||F.addLayer({id:ue,type:"fill",source:pe,paint:{"fill-color":te.type==="high"?"#ef4444":"#10b981","fill-opacity":te.type==="high"?.4:.3}}),F!=null&&F.getLayer(Ee)?(F.setPaintProperty(Ee,"line-color",te.type==="high"?"#dc2626":"#059669"),F.setPaintProperty(Ee,"line-width",2)):F==null||F.addLayer({id:Ee,type:"line",source:pe,paint:{"line-color":te.type==="high"?"#dc2626":"#059669","line-width":2}})}),B.current=Y},[y,f]),re.useEffect(()=>{if(!h.current||!y||!e)return;const F=h.current;if(F)if(j.current)j.current.setLngLat([e.lng,e.lat]);else{const H=document.createElement("div");H.className="user-marker",H.style.width="20px",H.style.height="20px",H.style.borderRadius="50%",H.style.backgroundColor="#4F46E5",H.style.border="3px solid white",H.style.boxShadow="0 0 10px rgba(79, 70, 229, 0.5)",j.current=new Gf.Marker(H).setLngLat([e.lng,e.lat]).addTo(F)}},[e,y]),re.useEffect(()=>{if(!h.current||!y)return;const F=h.current;if(F&&(R.current.forEach(H=>H.remove()),R.current=[],t.forEach(H=>{const Y=document.createElement("div");Y.className="sos-marker",Y.style.width="30px",Y.style.height="30px",Y.style.borderRadius="50%",Y.style.backgroundColor=H.riskScore>=50?"#ef4444":H.riskScore>=25?"#f59e0b":"#10b981",Y.style.border="3px solid white",Y.style.boxShadow="0 0 15px rgba(239, 68, 68, 0.8)",Y.style.display="flex",Y.style.alignItems="center",Y.style.justifyContent="center",Y.style.fontSize="12px",Y.style.fontWeight="bold",Y.style.color="white",Y.textContent="!";const te=new Gf.Marker(Y).setLngLat([H.lng,H.lat]).addTo(F);R.current.push(te)}),!Z.current&&t.length>0)){const H=new Gf.LngLatBounds;t.forEach(Y=>{Number.isFinite(Y.lat)&&Number.isFinite(Y.lng)&&H.extend([Y.lng,Y.lat])}),e&&Number.isFinite(e.lat)&&Number.isFinite(e.lng)&&H.extend([e.lng,e.lat]),H.isEmpty()||(F.fitBounds(H,{padding:60,maxZoom:16,duration:0}),Z.current=!0)}},[t,y,e]),W.jsxs("div",{className:"relative w-full rounded-lg overflow-hidden",style:{height:r},children:[w||k?W.jsx("div",{className:"w-full h-full flex items-center justify-center bg-slate-700 text-slate-200 text-sm px-4 text-center",children:w?"Map is not configured. Set VITE_MAPBOX_TOKEN.":k}):W.jsx("div",{ref:l,className:"w-full h-full"}),W.jsx("style",{children:`
        .mapboxgl-popup-content {
          background: #1e293b;
          color: white;
          border-radius: 8px;
          padding: 12px;
        }
        .mapboxgl-popup-tip {
          border-top-color: #1e293b;
        }
      `})]})}function F8({events:e,sosEvent:t,sosId:r}){const[n,o]=re.useState([]),[l,h]=re.useState(!1);re.useEffect(()=>{const A=typeof r=="string"?r:(r==null?void 0:r.id)||null;A&&(h(!0),Yo.getSOSEventHistory(String(A)).then(k=>{o(k)}).catch(k=>{console.error("Failed to fetch SOS events:",k)}).finally(()=>{h(!1)}))},[r]);let f=[];n.length>0?f=n.map(A=>({type:A.type,timestamp:A.timestamp,data:A.meta,risk_value:A.risk_value})):e&&e.length>0?f=e:t&&(f=[{type:"sos_triggered",timestamp:t.created_at,data:{triggerType:t.trigger_type,riskScore:t.risk_score}},...t.status==="acknowledged"||t.status==="resolved"?[{type:t.status,timestamp:t.updated_at,data:{}}]:[]]);const s=A=>{switch(A){case"sos_triggered":return"";case"ai_risk":return"";case"zone_entered":return"";case"acknowledged":return"";case"resolved":return"";default:return""}},y=A=>{switch(A){case"sos_triggered":return"bg-red-500";case"ai_risk":return"bg-blue-500";case"zone_entered":return"bg-yellow-500";case"acknowledged":return"bg-green-500";case"resolved":return"bg-emerald-500";default:return"bg-gray-500"}},b=(A,k,M)=>{switch(A){case"sos_triggered":{const R=(k==null?void 0:k.trigger_type)||(k==null?void 0:k.triggerType),j=M??(k==null?void 0:k.riskScore)??(k==null?void 0:k.risk_value),L=j!=null;return`SOS ${R==="ai"?"Auto-Triggered":"Manually Triggered"}${L?` (Risk: ${typeof j=="number"?j.toFixed(1):j})`:""}`}case"ai_risk":return`AI Risk Level Changed${M!=null?` (Risk: ${M.toFixed(1)})`:""}`;case"zone_entered":{if(k!=null&&k.normal_zone)return"User is outside all predefined risk zones (Normal area)";const R=(k==null?void 0:k.zoneName)||(k==null?void 0:k.zone_name)||"Unknown";return`Entered ${(k==null?void 0:k.zoneType)||(k==null?void 0:k.zone_type)||((k==null?void 0:k.type)==="high"?"high-risk":"low-risk")} zone: ${R}`}case"acknowledged":return k!=null&&k.security_email?`Security Acknowledged by ${k.security_email}`:"Security Acknowledged";case"resolved":return k!=null&&k.security_email?`Security Resolved by ${k.security_email}`:"Security Resolved";default:return"Event"}},w=A=>{const k=new Date(A);return Number.isNaN(k.getTime())?A:k.toLocaleString()};return l?W.jsx("div",{className:"text-center py-8 text-slate-400",children:"Loading events..."}):f.length===0?W.jsx("div",{className:"text-center py-8 text-slate-400",children:"No events to display"}):W.jsxs("div",{className:"relative",children:[W.jsx("div",{className:"absolute left-4 top-0 bottom-0 w-0.5 bg-slate-700"}),W.jsx("div",{className:"space-y-6",children:f.map((A,k)=>W.jsxs("div",{className:"relative flex items-start gap-4",children:[W.jsx("div",{className:`relative z-10 flex items-center justify-center w-8 h-8 rounded-full ${y(A.type)} text-white text-sm`,children:s(A.type)}),W.jsxs("div",{className:"flex-1 pt-1",children:[W.jsx("div",{className:"text-white font-medium",children:b(A.type,A.data,A.risk_value)}),W.jsx("div",{className:"text-slate-400 text-sm mt-1",children:w(A.timestamp)})]})]},k))})]})}function Vae(e){const{snapshot:t,audioInputs:r,motionInputs:n,location:o,time:l}=e,h=[];if(r){const s=Math.round(r.rms*100);t.audio.score>20?h.push(`Loud audio spike detected (${s} dB)`):t.audio.score>10?h.push(`Moderate audio activity (${s} dB)`):h.push(`Normal audio levels (${s} dB)`)}if(n){const s=n.accelerationMagnitude.toFixed(1);t.motion.score>15?h.push(`Sudden jerk motion (${s}g)`):t.motion.score>8?h.push(`Moderate motion detected (${s}g)`):h.push(`Normal movement (${s}g)`)}if(o!=null&&o.zoneName){const s=o.zoneName.toLowerCase().includes("high")?"high-risk":"low-risk";h.push(`Inside ${s} zone: ${o.zoneName}`)}else o!=null&&o.isNormalZone?h.push("User is outside all predefined risk zones (normal area)"):o!=null&&o.lat&&(o!=null&&o.lng)&&h.push(`Location: ${o.lat.toFixed(4)}, ${o.lng.toFixed(4)}`);if(l){const s=l.getHours();s>=0&&s<4?h.push("Night-time multiplier applied"):s>=20&&s<24?h.push("Evening-time multiplier applied"):s>=4&&s<6?h.push("Early morning multiplier applied"):h.push("Daytime multiplier applied")}const f=t.level==="high"?"High Risk":t.level==="medium"?"Medium Risk":"Low Risk";return h.push(` Final Score: ${t.total.toFixed(0)}/100 (${f})`),h}function Gae(){var Ec,Ja,Ac;const{user:e,logout:t}=Uu(),{enabled:r,fetchStatus:n,toggle:o}=zse(),[l,h]=re.useState([]),[f,s]=re.useState({rms:0,pitch:0,pitchVariance:0,spikeCount:0,stress:0}),[y,b]=re.useState({acceleration:0,accelerationMagnitude:0,jitter:0,shake:0,intensity:0}),[w,A]=re.useState(DC(f,y)),[k,M]=re.useState(!1),[R,j]=re.useState(""),[L,z]=re.useState(!1),[B,Z]=re.useState(null),[F,H]=re.useState(0),[Y,te]=re.useState(null),[pe,ue]=re.useState([]),[Ee,Oe]=re.useState([]),[je,Ge]=re.useState(!1),[Ze,Ye]=re.useState([]),[tt,ze]=re.useState([]),[De,ut]=re.useState(0),[ht,at]=re.useState(null),[Lt,$t]=re.useState(!1),[Tr,Br]=re.useState(!1),[cn,Vr]=re.useState(null),[Dt,Jt]=re.useState(null),[rr,Le]=re.useState(!1),[qt,Tt]=re.useState(null),St=re.useRef(null),Et=re.useRef(!1),Ft=re.useRef(!1),un=re.useRef(f),Gr=re.useRef(y),hn=re.useRef(w.total),zi=re.useRef(null),jn=re.useRef(null),oo=re.useRef(null),Zi=re.useRef(null),so=re.useRef([]),[Ha,Ol]=re.useState(!1),[Bi,as]=re.useState(!1),[Ka,ao]=re.useState(null),[zn,Za]=re.useState(null),[Ms,Ao]=re.useState([]),[No,ls]=re.useState(!1),[cs,Xa]=re.useState(void 0),[ve,ee]=re.useState(""),ne=Fu();re.useEffect(()=>()=>{tt.forEach(rt=>URL.revokeObjectURL(rt))},[tt]);const ye=()=>{tt.forEach(rt=>URL.revokeObjectURL(rt)),Ye([]),ze([]),ut(0),at(null)},Se=()=>{Ge(!0),at(null)},Me=()=>{Ge(!1),ye()},Ne=()=>{Ge(!1)},Be=()=>{St.current&&(clearInterval(St.current),St.current=null),Et.current=!1,Tt(null),at(null),Ge(!0)},ke=rt=>{if(!rt||rt.length===0)return;at(null);const Ct=Array.from(rt).slice(0,5),nr=Ct.map(Xt=>URL.createObjectURL(Xt));Ye(Ct),ze(nr),ut(0)},qe=rt=>{at(null);const Ct=URL.createObjectURL(rt);Ye(nr=>[...nr,rt].slice(0,5)),ze(nr=>[...nr,Ct].slice(0,5)),ut(nr=>Math.min(nr+1,4))},xt=()=>{try{Zi.current=null,so.current=[],Le(!1);const rt=oo.current;rt&&rt.getTracks().forEach(Ct=>Ct.stop()),oo.current=null,jn.current&&(jn.current.srcObject=null)}catch{}},wt=()=>{xt(),Br(!1),Vr(null),Jt(null)},gt=async rt=>{var nr;if(Jt(null),Vr(rt),Br(!0),!window.isSecureContext){Jt("Camera requires HTTPS (or localhost).");return}if(!((nr=navigator.mediaDevices)==null?void 0:nr.getUserMedia)){Jt("Camera not supported in this browser.");return}try{const Xt=await navigator.mediaDevices.getUserMedia({video:{facingMode:{ideal:"environment"}},audio:rt==="video"});oo.current=Xt,jn.current&&(jn.current.srcObject=Xt,jn.current.play().catch(()=>{}))}catch(Xt){Jt((Xt==null?void 0:Xt.message)||"Failed to access camera.")}},or=async()=>{const rt=jn.current;if(!rt)return;const Ct=rt.videoWidth||1280,nr=rt.videoHeight||720,Xt=document.createElement("canvas");Xt.width=Ct,Xt.height=nr;const Ut=Xt.getContext("2d");Ut&&(Ut.drawImage(rt,0,0,Ct,nr),Xt.toBlob(tr=>{if(!tr)return;const Dr=new File([tr],`photo_${Date.now()}.jpg`,{type:"image/jpeg"});qe(Dr),wt()},"image/jpeg",.92))},mr=()=>{const rt=oo.current;if(!rt||rr)return;const nr=["video/webm;codecs=vp9,opus","video/webm;codecs=vp8,opus","video/webm"].find(Xt=>{var Ut,tr;return(tr=(Ut=window.MediaRecorder)==null?void 0:Ut.isTypeSupported)==null?void 0:tr.call(Ut,Xt)});try{const Xt=new MediaRecorder(rt,nr?{mimeType:nr}:void 0);so.current=[],Xt.ondataavailable=Ut=>{Ut.data&&Ut.data.size>0&&so.current.push(Ut.data)},Xt.onstop=()=>{const Ut=new Blob(so.current,{type:Xt.mimeType||"video/webm"}),tr=new File([Ut],`video_${Date.now()}.webm`,{type:Ut.type||"video/webm"});qe(tr),wt()},Zi.current=Xt,Xt.start(),Le(!0)}catch(Xt){Jt((Xt==null?void 0:Xt.message)||"Failed to start recording.")}},sr=()=>{const rt=Zi.current;if(rt&&rt.state!=="inactive")try{rt.stop()}catch{}},gr=rt=>rt.replace(/[^a-zA-Z0-9._-]/g,"_"),vr=async()=>{var rt,Ct;if(!(e!=null&&e.id)){at("You must be logged in to send media.");return}if(Ze.length===0){at("Please attach a photo or video first.");return}if(!Ft.current){Ft.current=!0,$t(!0),at(null);try{const nr="sos-attachment",Xt=Array.from(new Set([nr,"sos-attachment","sos-attachments"].filter(Boolean))),Ut=Xt[0]||"sos-attachment",tr=[];for(const Dr of Ze){const Si=gr(Dr.name||"upload"),Xe=`${e.id}/${Date.now()}_${Si}`;let Ti=Ut,en=Xe;const Nn=async Ni=>kp.storage.from(Ni).upload(en,Dr,{contentType:Dr.type||void 0,upsert:!1});let Is=await Nn(Ti);if(Is.error){const Ni=((rt=Is.error)==null?void 0:rt.message)||"";if(/bucket.*not.*found/i.test(Ni)){const Qa=Xt.find(Bd=>Bd!==Ti);Qa&&(Ti=Qa,Is=await Nn(Ti))}en=`${e.id}/${Date.now()}_${Math.random().toString(16).slice(2)}_${Si}`,Is=await kp.storage.from(Ti).upload(en,Dr,{contentType:Dr.type||void 0,upsert:!1})}if(Is.error){const Ni=((Ct=Is.error)==null?void 0:Ct.message)||"";throw/bucket.*not.*found/i.test(Ni)?new Error(`Supabase Storage bucket not found. Tried: ${Xt.map(Qa=>`"${Qa}"`).join(", ")}. Set VITE_SUPABASE_STORAGE_BUCKET to your existing bucket name (e.g. "sos-attachment"), then restart the frontend dev server.`):new Error(Is.error.message||"Upload failed")}tr.push(en)}await Yo.createSOS({risk_score:w.total,factors:{audio:w.audio.score,motion:w.motion.score,time:w.time.score,location:w.location.score},location:Y||void 0,trigger_type:"manual",attachments:tr}),Tt(null),St.current&&(clearInterval(St.current),St.current=null),Et.current=!1,Ge(!1),ye(),Bn()}catch(nr){at((nr==null?void 0:nr.message)||"Failed to send media."),Ft.current=!1,Tt(null),St.current&&(clearInterval(St.current),St.current=null),Et.current=!1,Ge(!0)}finally{$t(!1)}}},dn=()=>{if(!(e!=null&&e.id)){at("You must be logged in to send media.");return}if(Ze.length===0){at("Please attach a photo or video first.");return}Ft.current=!1,at(null),Tt(10),Ne()},An=()=>{St.current&&(clearInterval(St.current),St.current=null),Et.current=!1,Tt(null),vr()};re.useEffect(()=>{if(qt===null){St.current&&(clearInterval(St.current),St.current=null),Et.current=!1;return}if(qt<=0){St.current&&(clearInterval(St.current),St.current=null),Et.current=!1,Tt(null),vr();return}return!Et.current&&qt>0&&(Et.current=!0,St.current=setInterval(()=>{Tt(rt=>rt===null||rt<=0?(Et.current=!1,St.current&&(clearInterval(St.current),St.current=null),0):rt-1)},1e3)),()=>{qt===null&&St.current&&(clearInterval(St.current),St.current=null,Et.current=!1)}},[qt]),re.useEffect(()=>{(e==null?void 0:e.role)==="security"&&ne("/security")},[e,ne]),re.useEffect(()=>{n(),Bn();const rt=localStorage.getItem("accessToken");return rt&&fw(rt),()=>{const Ct=Op();Ct&&Ct.disconnect()}},[]),re.useEffect(()=>{$8.getRiskZones().then(rt=>{ue(rt)}).catch(()=>{ue([])})},[]),re.useEffect(()=>{var Xt;if(!Y||!Number.isFinite(Y.lat)||!Number.isFinite(Y.lng)||pe.length===0)return;const rt=Pn({lat:Y.lat,lng:Y.lng}),Ct=(rt==null?void 0:rt.id)||null,nr=((Xt=Y.matchedZone)==null?void 0:Xt.id)||null;Ct!==nr&&te({lat:Y.lat,lng:Y.lng,matchedZone:rt?{id:rt.id,name:rt.name,type:rt.type}:void 0,isNormalZone:!rt})},[pe]);const hi=(rt,Ct)=>{const nr=rt.lng,Xt=rt.lat;let Ut=!1;for(let tr=0,Dr=Ct.length-1;tr<Ct.length;Dr=tr++){const Si=Ct[tr][0],Xe=Ct[tr][1],Ti=Ct[Dr][0],en=Ct[Dr][1];Xe>Xt!=en>Xt&&nr<(Ti-Si)*(Xt-Xe)/(en-Xe)+Si&&(Ut=!Ut)}return Ut},Pn=rt=>{const Ct=pe.filter(Xt=>{var tr,Dr;const Ut=(Dr=(tr=Xt==null?void 0:Xt.polygon)==null?void 0:tr.coordinates)==null?void 0:Dr[0];return!Ut||Ut.length<3?!1:hi(rt,Ut)});return Ct.find(Xt=>Xt.type==="high")||Ct[0]||null},$o=rt=>{const Ct=Pn(rt);te({...rt,matchedZone:Ct?{id:Ct.id,name:Ct.name,type:Ct.type}:void 0,isNormalZone:!Ct})};re.useEffect(()=>{un.current=f},[f]),re.useEffect(()=>{Gr.current=y},[y]),re.useEffect(()=>{hn.current=w.total},[w.total]),re.useEffect(()=>{if(!(e!=null&&e.id))return;const rt=setInterval(()=>{const Ct=Op();!Ct||!Ct.connected||Ct.emit("live_feed",{userId:e.id,audio:{rms:un.current.rms,pitch:un.current.pitch,stress:un.current.stress},motion:{acceleration:Gr.current.acceleration,shake:Gr.current.shake},totalRisk:hn.current})},500);return()=>{clearInterval(rt)}},[e==null?void 0:e.id]),re.useEffect(()=>{if(!Ha||!zn)return;const rt=localStorage.getItem("accessToken");if(!rt)return;const Ct=fw(rt);Ct.emit("join_sos",zn),Ct.emit("join_sos_chat",zn);const nr=tr=>{!tr||tr.sos_id!==zn||Ao(Dr=>Dr.some(Si=>Si.id===tr.id)?Dr:[...Dr,tr])},Xt=tr=>{!tr||tr.sosId!==zn||ao(tr.error||"Failed to send message")},Ut=async tr=>{var Dr;if(!(!tr||String(tr.id)!==String(zn))&&(tr.status==="resolved"&&ls(!0),tr.status==="acknowledged"&&!cs))try{const Si=await Yo.getSOSChatById(zn);Xa((Dr=Si==null?void 0:Si.chat)==null?void 0:Dr.security_email)}catch{}};return Ct.on("chat:message",nr),Ct.on("chat:error",Xt),Ct.on("sos-updated",Ut),Ct.on("sos_status_update",Ut),()=>{Ct.off("chat:message",nr),Ct.off("chat:error",Xt),Ct.off("sos-updated",Ut),Ct.off("sos_status_update",Ut),Ct.emit("leave_sos",zn),Ct.emit("leave_sos_chat",zn)}},[Ha,zn,cs]),re.useEffect(()=>{(async()=>{try{const Ct=new b8;await Ct.initialize(),Ct.setPresentationMode(!1),Z(Ct);const nr=new w8;if(nr.isSupported()){await nr.initialize();const Xt=tr=>{const Dr=nr.handleMotionEvent(tr);b(Dr)};window.addEventListener("devicemotion",Xt);const Ut=setInterval(()=>{const tr=Ct.getAudioData();s(tr)},200);return()=>{Ct.stop(),nr.stop(),window.removeEventListener("devicemotion",Xt),clearInterval(Ut)}}else Ct.stop()}catch(Ct){console.error("Failed to initialize sensors:",Ct)}})()},[]),re.useEffect(()=>{B&&B.setPresentationMode(r)},[r,B]),re.useEffect(()=>{var Ct;const rt=DC(f,y,{...Y||{},presentationMode:r});A(rt),Oe(Vae({snapshot:rt,audioInputs:{rms:f.rms,pitchVariance:f.pitchVariance,spikeCount:f.spikeCount},motionInputs:{accelerationMagnitude:y.accelerationMagnitude,jitter:y.jitter},location:Y?{lat:Y.lat,lng:Y.lng,zoneName:(Ct=Y.matchedZone)==null?void 0:Ct.name,isNormalZone:Y.isNormalZone}:void 0,time:new Date}))},[f,y,Y,r]),re.useEffect(()=>{if(!w||!w.total||L)return;const rt=Date.now();rt-F<1e4||w.level==="high"&&Use(w.total)&&(z(!0),H(rt))},[w,r,L,F]);const Bn=async()=>{try{const rt=await Yo.getSOSEvents({limit:7});h(rt)}catch(rt){console.error("Failed to load SOS history:",rt)}},wi=async()=>{var rt,Ct,nr,Xt;Ol(!0),as(!0),ao(null),Ao([]),Za(null),ls(!1),Xa(void 0);try{const Ut=await Yo.getRecentSOSChat(),tr=String(((rt=Ut==null?void 0:Ut.sos)==null?void 0:rt.id)||"");Za(tr||null),Ao(Array.isArray(Ut==null?void 0:Ut.messages)?Ut.messages:[]),ls(!!(Ut!=null&&Ut.read_only)),Xa((Ct=Ut==null?void 0:Ut.chat)==null?void 0:Ct.security_email)}catch(Ut){const tr=((Xt=(nr=Ut==null?void 0:Ut.response)==null?void 0:nr.data)==null?void 0:Xt.error)||(Ut==null?void 0:Ut.message)||"Failed to load chat";ao(tr)}finally{as(!1)}},Ya=()=>{Ol(!1),ao(null),ee("")},jd=async()=>{var nr,Xt;if(!zn)return;const rt=ve.trim();if(!rt||No)return;ao(null);const Ct=Op();if(Ct&&Ct.connected){Ct.emit("chat:send",{sosId:zn,message:rt}),ee("");return}try{const Ut=await Yo.sendSOSChatMessage(zn,rt);Ao(tr=>tr.some(Dr=>Dr.id===Ut.id)?tr:[...tr,Ut]),ee("")}catch(Ut){const tr=((Xt=(nr=Ut==null?void 0:Ut.response)==null?void 0:nr.data)==null?void 0:Xt.error)||(Ut==null?void 0:Ut.message)||"Failed to send message";ao(tr)}},zd=async()=>{try{await o(!r,R),M(!1),j("")}catch(rt){alert(rt.message)}},Mr=[{name:"Audio",value:w.audio.score,max:35,color:w.audio.score>20?"danger":"safe"},{name:"Motion",value:w.motion.score,max:25,color:w.motion.score>15?"danger":"safe"},{name:"Time",value:w.time.score,max:20,color:w.time.score>12?"warning":"safe"},{name:"Location",value:w.location.score,max:20,color:w.location.score>15?"warning":"safe"},{name:"Total",value:w.total,max:100,color:w.level==="high"?"danger":w.level==="medium"?"warning":"safe"}];return W.jsxs("div",{className:"min-h-screen aurora-gradient p-6",children:[W.jsxs("div",{className:"max-w-7xl mx-auto space-y-6",children:[W.jsxs("div",{className:"glass-panel px-6 py-4 flex justify-between items-center",children:[W.jsxs("div",{children:[W.jsx("h1",{className:"text-2xl font-bold aurora-text",children:"Student Dashboard"}),W.jsxs("p",{className:"text-sm text-muted-foreground",children:["Welcome, ",e==null?void 0:e.email]})]}),W.jsxs("div",{className:"flex gap-4",children:[W.jsx("button",{onClick:()=>M(!0),className:"px-4 py-2 bg-secondary/60 hover:bg-secondary/80 text-foreground rounded-lg transition-colors border border-border/50",children:" Settings"}),W.jsx("button",{onClick:t,className:"px-4 py-2 bg-secondary/60 hover:bg-secondary/80 text-foreground rounded-lg transition-colors border border-border/50",children:"Logout"})]})]}),W.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[W.jsxs("div",{className:"lg:col-span-1 glass-panel-critical p-6 flex flex-col items-center justify-center",children:[W.jsx("h2",{className:"text-xl font-semibold text-foreground mb-4 text-center w-full",children:"Emergency SOS"}),W.jsx(Vse,{location:Y,onSOSTriggered:()=>{Bn(),z(!1),H(Date.now())},triggerType:L?"ai":void 0,onCancelAuto:()=>{z(!1),H(Date.now())}}),W.jsx("button",{type:"button",onClick:Se,className:"mt-5 w-full px-4 py-2 bg-secondary/60 hover:bg-secondary/80 text-foreground rounded-lg transition-colors border border-border/50",children:"Send Photo / Video"})]}),W.jsxs("div",{className:"lg:col-span-2 glass-panel p-6",children:[W.jsx("h2",{className:"text-xl font-semibold text-foreground mb-4",children:"Live Risk Assessment"}),W.jsxs("div",{className:"space-y-4",children:[Mr.map(rt=>W.jsxs("div",{children:[W.jsxs("div",{className:"flex justify-between mb-1",children:[W.jsx("span",{className:"text-muted-foreground",children:rt.name}),W.jsxs("span",{className:`font-semibold ${rt.color==="danger"?"text-danger":rt.color==="warning"?"text-warning":"text-safe"}`,children:[rt.value.toFixed(1)," / ",rt.max]})]}),W.jsx("div",{className:"w-full bg-secondary/60 rounded-full h-3",children:W.jsx("div",{className:`h-3 rounded-full transition-all duration-300 ${rt.color==="danger"?"bg-danger":rt.color==="warning"?"bg-warning":"bg-safe"}`,style:{width:`${rt.value/rt.max*100}%`}})})]},rt.name)),W.jsx("div",{className:"mt-4 p-4 bg-secondary/50 border border-border/50 rounded-lg",children:W.jsxs("div",{className:"flex justify-between items-center",children:[W.jsx("span",{className:"text-muted-foreground",children:"Risk Level"}),W.jsx("span",{className:`text-xl font-bold ${w.level==="high"?"text-danger":w.level==="medium"?"text-warning":"text-safe"}`,children:w.level.toUpperCase()})]})})]})]})]}),W.jsxs("div",{className:"mt-6 grid grid-cols-1 lg:grid-cols-2 gap-6",children:[W.jsxs("div",{className:"glass-panel p-6",children:[W.jsx("h2",{className:"text-xl font-semibold text-foreground mb-4",children:"Live Location & Risk Zones"}),W.jsx(uI,{userLocation:Y,height:"400px",onLocationUpdate:$o})]}),W.jsxs("div",{className:"glass-panel p-6",children:[W.jsxs("div",{className:"flex items-center justify-between gap-4 mb-4",children:[W.jsx("h2",{className:"text-xl font-semibold text-foreground",children:"Event Timeline"}),W.jsx("button",{type:"button",onClick:wi,disabled:l.length===0,className:"px-4 py-2 bg-secondary/60 hover:bg-secondary/80 text-foreground rounded-lg transition-colors border border-border/50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Chat"})]}),l.length>0&&((Ec=l[0])!=null&&Ec.id)?W.jsx(F8,{sosId:String(l[0].id),sosEvent:l[0]}):W.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No events to display"})]})]}),Ee.length>0&&W.jsxs("div",{className:"mt-6 glass-panel p-6",children:[W.jsx("h2",{className:"text-xl font-semibold text-foreground mb-4",children:"AI Risk Explanation"}),W.jsx("div",{className:"space-y-2",children:Ee.map((rt,Ct)=>W.jsx("div",{className:`text-muted-foreground ${rt.startsWith("")?"font-bold text-foreground text-lg mt-2":""}`,children:rt},Ct))})]}),W.jsxs("div",{className:"mt-6 glass-panel p-6",children:[W.jsx("h2",{className:"text-xl font-semibold text-foreground mb-4",children:"Last 7 Days History"}),l.length===0?W.jsx("p",{className:"text-muted-foreground",children:"No SOS events in the last 7 days"}):W.jsx("div",{className:"overflow-x-auto",children:W.jsxs("table",{className:"w-full text-left",children:[W.jsx("thead",{children:W.jsxs("tr",{className:"border-b border-border/60",children:[W.jsx("th",{className:"pb-2 text-muted-foreground",children:"Date"}),W.jsx("th",{className:"pb-2 text-muted-foreground",children:"Risk Score"}),W.jsx("th",{className:"pb-2 text-muted-foreground",children:"Trigger"}),W.jsx("th",{className:"pb-2 text-muted-foreground",children:"Status"})]})}),W.jsx("tbody",{children:l.map(rt=>W.jsxs("tr",{className:"border-b border-border/40",children:[W.jsx("td",{className:"py-2 text-muted-foreground",children:new Date(rt.created_at).toLocaleString()}),W.jsx("td",{className:"py-2 text-foreground font-semibold",children:rt.risk_score.toFixed(1)}),W.jsx("td",{className:"py-2 text-muted-foreground",children:rt.trigger_type.charAt(0).toUpperCase()+rt.trigger_type.slice(1)}),W.jsx("td",{className:"py-2",children:W.jsx("span",{className:`px-2 py-1 rounded text-xs ${rt.status==="resolved"?"bg-safe/20 text-safe":rt.status==="acknowledged"?"bg-warning/20 text-warning":"bg-danger/20 text-danger"}`,children:rt.status})})]},rt.id))})]})})]})]}),k&&W.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:W.jsxs("div",{className:"glass-panel p-6 max-w-md w-full mx-4",children:[W.jsx("h3",{className:"text-xl font-semibold text-foreground mb-4",children:"Presentation Mode"}),W.jsxs("div",{className:"space-y-4",children:[W.jsxs("div",{children:[W.jsx("label",{className:"block text-sm font-medium text-muted-foreground mb-2",children:"Password"}),W.jsx("input",{type:"password",value:R,onChange:rt=>j(rt.target.value),className:"w-full px-4 py-2 bg-secondary/60 border border-border/50 rounded-lg text-foreground",placeholder:"Enter password"})]}),W.jsxs("div",{className:"flex gap-4",children:[W.jsx("button",{onClick:()=>M(!1),className:"flex-1 px-4 py-2 bg-secondary/60 hover:bg-secondary/80 text-foreground rounded-lg border border-border/50",children:"Cancel"}),W.jsx("button",{onClick:zd,className:"flex-1 px-4 py-2 bg-primary/80 hover:bg-primary text-primary-foreground rounded-lg border border-primary/30",children:r?"Disable":"Enable"})]})]})]})}),je&&W.jsx("div",{className:"fixed inset-0 bg-black/60 flex items-center justify-center z-50",children:W.jsxs("div",{className:"glass-panel p-6 max-w-2xl w-full mx-4",children:[W.jsxs("div",{className:"flex items-start justify-between gap-4",children:[W.jsxs("div",{children:[W.jsx("h3",{className:"text-xl font-semibold text-foreground",children:"Send Media"}),W.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Attach or record a photo/video, then send it to Security."})]}),W.jsx("button",{type:"button",onClick:Me,className:"px-3 py-2 bg-secondary/60 hover:bg-secondary/80 text-foreground rounded-lg border border-border/50",disabled:Lt,children:"Close"})]}),W.jsxs("div",{className:"mt-5 grid grid-cols-1 md:grid-cols-5 gap-4",children:[W.jsxs("div",{className:"md:col-span-2 space-y-3",children:[W.jsx("button",{type:"button",className:"w-full px-4 py-2 bg-secondary/60 hover:bg-secondary/80 text-foreground rounded-lg border border-border/50",onClick:()=>{var rt;return(rt=zi.current)==null?void 0:rt.click()},disabled:Lt,children:"Attach File"}),W.jsx("button",{type:"button",className:"w-full px-4 py-2 bg-secondary/60 hover:bg-secondary/80 text-foreground rounded-lg border border-border/50",onClick:()=>gt("photo"),disabled:Lt,children:"Take Photo"}),W.jsx("button",{type:"button",className:"w-full px-4 py-2 bg-secondary/60 hover:bg-secondary/80 text-foreground rounded-lg border border-border/50",onClick:()=>gt("video"),disabled:Lt,children:"Record Video"}),W.jsx("input",{ref:zi,type:"file",className:"hidden",accept:"image/*,video/*",multiple:!0,onChange:rt=>ke(rt.target.files)}),W.jsx("input",{type:"file",className:"hidden",accept:"image/*,video/*",multiple:!0,onChange:rt=>ke(rt.target.files)}),Ze.length>0?W.jsxs("div",{className:"rounded-lg border border-border/40 bg-secondary/40 p-3",children:[W.jsx("div",{className:"text-sm text-muted-foreground",children:"Selected"}),W.jsx("div",{className:"mt-2 space-y-2",children:Ze.map((rt,Ct)=>W.jsxs("button",{type:"button",className:`w-full text-left px-3 py-2 rounded-md border transition-colors ${Ct===De?"bg-secondary/70 border-border/70":"bg-secondary/40 border-border/40 hover:bg-secondary/60"}`,onClick:()=>ut(Ct),disabled:Lt,children:[W.jsx("div",{className:"text-foreground text-sm truncate",children:rt.name}),W.jsxs("div",{className:"text-muted-foreground text-xs",children:[(rt.size/1024/1024).toFixed(2)," MB"]})]},`${rt.name}-${Ct}`))})]}):W.jsx("div",{className:"text-sm text-muted-foreground",children:"No file selected."})]}),W.jsxs("div",{className:"md:col-span-3",children:[W.jsxs("div",{className:"rounded-xl border border-border/40 bg-secondary/30 overflow-hidden",children:[W.jsx("div",{className:"px-4 py-3 border-b border-border/40",children:W.jsx("div",{className:"text-sm font-semibold text-foreground",children:"Preview"})}),W.jsx("div",{className:"p-4",children:tt[De]?(Ac=(Ja=Ze[De])==null?void 0:Ja.type)!=null&&Ac.startsWith("video/")?W.jsx("video",{src:tt[De],controls:!0,className:"w-full max-h-[360px] rounded-lg bg-black"}):W.jsx("img",{src:tt[De],alt:"Preview",className:"w-full max-h-[360px] object-contain rounded-lg bg-black/20"}):W.jsx("div",{className:"text-sm text-muted-foreground",children:"Select a photo or video to preview it here."})})]}),ht?W.jsx("div",{className:"mt-4 rounded-lg border border-destructive/40 bg-destructive/15 px-4 py-3 text-sm text-destructive-foreground",children:ht}):null,W.jsxs("div",{className:"mt-5 flex gap-3 justify-end",children:[W.jsx("button",{type:"button",onClick:Me,className:"px-5 py-2 bg-secondary/60 hover:bg-secondary/80 text-foreground rounded-lg border border-border/50",disabled:Lt,children:"Cancel"}),W.jsx("button",{type:"button",onClick:dn,className:"px-5 py-2 bg-primary/80 hover:bg-primary text-primary-foreground rounded-lg border border-primary/30 disabled:opacity-50 disabled:cursor-not-allowed",disabled:Lt||Ze.length===0,children:Lt?"Sending":"Send"})]})]})]})]})}),W.jsx(S8,{isOpen:qt!==null,countdown:qt!==null?qt:0,triggerType:"manual",onSendNow:An,onCancel:Be}),Ha&&W.jsx("div",{className:"fixed inset-0 bg-black/60 flex items-center justify-center z-50",children:W.jsxs("div",{className:"glass-panel p-6 max-w-2xl w-full mx-4",children:[W.jsxs("div",{className:"flex items-start justify-between gap-4",children:[W.jsxs("div",{children:[W.jsx("h3",{className:"text-xl font-semibold text-foreground",children:"SOS Chat"}),W.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:cs?`Connected to: ${cs}`:"Waiting for Security to acknowledge"})]}),W.jsx("button",{type:"button",onClick:Ya,className:"px-3 py-2 bg-secondary/60 hover:bg-secondary/80 text-foreground rounded-lg border border-border/50",children:"Close"})]}),Bi?W.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Loading chat"}):Ka?W.jsx("div",{className:"mt-4 text-sm text-danger",children:Ka}):null,W.jsx("div",{className:"mt-4 rounded-lg border border-border/40 bg-secondary/30 h-[360px] overflow-y-auto p-4 space-y-3",children:Ms.length===0?W.jsx("div",{className:"text-muted-foreground text-sm",children:"No messages yet."}):Ms.map(rt=>W.jsxs("div",{className:"rounded-lg bg-secondary/40 border border-border/40 p-3",children:[W.jsxs("div",{className:"text-xs text-muted-foreground",children:[rt.sender_email||rt.sender_id,"  ",new Date(rt.created_at).toLocaleString()]}),W.jsx("div",{className:"text-foreground mt-1 whitespace-pre-wrap",children:rt.message})]},rt.id))}),W.jsxs("div",{className:"mt-4 flex gap-3",children:[W.jsx("input",{value:ve,onChange:rt=>ee(rt.target.value),placeholder:No?"Chat is read-only (resolved)":"Type a message",disabled:No||Bi||!zn,className:"flex-1 px-4 py-3 rounded-lg border border-border bg-card/50 text-foreground backdrop-blur-sm focus:outline-none focus:border-primary/50 disabled:opacity-60",onKeyDown:rt=>{rt.key==="Enter"&&(rt.preventDefault(),jd())}}),W.jsx("button",{type:"button",onClick:jd,disabled:No||Bi||!zn||!ve.trim(),className:"px-5 py-3 bg-primary/80 hover:bg-primary text-primary-foreground rounded-lg border border-primary/30 disabled:opacity-50 disabled:cursor-not-allowed",children:"Send"})]})]})}),Tr?W.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-[99998]",children:W.jsxs("div",{className:"glass-panel p-5 max-w-2xl w-full mx-4",children:[W.jsxs("div",{className:"flex items-center justify-between gap-4",children:[W.jsxs("div",{children:[W.jsx("h3",{className:"text-lg font-semibold text-foreground",children:cn==="video"?"Record Video":"Take Photo"}),W.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Allow camera permission when prompted."})]}),W.jsx("button",{type:"button",onClick:wt,className:"px-3 py-2 bg-secondary/60 hover:bg-secondary/80 text-foreground rounded-lg border border-border/50",children:"Close"})]}),W.jsx("div",{className:"mt-4 rounded-xl overflow-hidden border border-border/40 bg-black",children:W.jsx("video",{ref:jn,playsInline:!0,muted:!0,className:"w-full max-h-[420px] object-contain"})}),Dt?W.jsx("div",{className:"mt-4 rounded-lg border border-destructive/40 bg-destructive/15 px-4 py-3 text-sm text-destructive-foreground",children:Dt}):null,W.jsx("div",{className:"mt-5 flex gap-3 justify-end",children:cn==="photo"?W.jsx("button",{type:"button",onClick:or,className:"px-5 py-2 bg-primary/80 hover:bg-primary text-primary-foreground rounded-lg border border-primary/30",children:"Capture"}):W.jsx(W.Fragment,{children:rr?W.jsx("button",{type:"button",onClick:sr,className:"px-5 py-2 bg-danger hover:bg-red-600 text-white rounded-lg border border-danger/30",children:"Stop"}):W.jsx("button",{type:"button",onClick:mr,className:"px-5 py-2 bg-primary/80 hover:bg-primary text-primary-foreground rounded-lg border border-primary/30",children:"Start Recording"})})})]})}):null,Lt?W.jsx("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center z-[99999]",children:W.jsxs("div",{className:"glass-panel p-6 w-[92%] max-w-sm text-center",children:[W.jsx("div",{className:"text-lg font-semibold text-foreground",children:"Uploading"}),W.jsx("div",{className:"mt-2 text-sm text-muted-foreground",children:"Please wait while we send your media to Security."})]})}):null]})}function Wae(){const{user:e,logout:t}=Uu(),[r,n]=re.useState([]),[o,l]=re.useState(!0),h=Fu();re.useEffect(()=>{if((e==null?void 0:e.role)!=="security"){h("/dashboard");return}f();const w=localStorage.getItem("accessToken");if(w){const A=fw(w),k=M=>{n(R=>{var B;const j=R.findIndex(Z=>Z.id===M.id);if(j===-1)return[M,...R];const L={...R[j],...M,email:M.email||R[j].email,attachment_urls:(M==null?void 0:M.attachment_urls)??((B=R[j])==null?void 0:B.attachment_urls)},z=R.slice();return z.splice(j,1),[L,...z]})};return A.on("new_sos_alert",M=>{k(M),s()}),A.on("sos:created",M=>{k(M)}),A.on("sos-updated",M=>{k(M)}),A.on("sos_status_update",M=>{n(R=>R.map(j=>j.id===M.id?{...j,...M,email:M.email||j.email}:j))}),()=>{A.off("new_sos_alert"),A.off("sos:created"),A.off("sos-updated"),A.disconnect()}}},[e,h]);const f=async()=>{try{const w=await Yo.getSOSEvents({status:"new",limit:50});n(w)}catch(w){console.error("Failed to load alerts:",w)}finally{l(!1)}},s=()=>{var R,j;const w=((j=(R=import.meta)==null?void 0:R.env)==null?void 0:j.BASE_URL)||"/",A=w.endsWith("/")?w:`${w}/`,k=[`${A}security-alert.mp3`,`${A}security-alert.wav`,`${A}security-alert.ogg`,`${A}no-test.mp3`],M=L=>{if(L>=k.length){const B=new Audio("data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2/LDciUFLIHO8tiJNwgZaLvt559NEAxQp+PwtmMcBjiR1/LMeSwFJHfH8N2QQAoUXrTp66hVFApGn+DyvmwhBTGH0fPTgjMGHm7A7+OZURAJR6Tg8sBtJAU0h9Hz04IzBh5uwO/jmVEQCUek4PLAbSQFNIbR89OCMwYebsDv45lREAlHpODywG0kBTSG0fPTgjMGHm7A7+OZURAJR6Tg8sBtJAU0htHz04IzBh5uwO/jmVEQCUek4PLAbSQFNIbR89OCMwYebsDv45lREAlHpODywG0kBTQ=");B.volume=.5,B.play().catch(()=>{});return}const z=new Audio(k[L]);z.volume=.6,z.play().catch(()=>{M(L+1)}),z.onerror=()=>M(L+1)};M(0)},y=w=>w>=50?"text-danger":w>=25?"text-warning":"text-safe",b=w=>w>=50?"HIGH":w>=25?"MEDIUM":"LOW";return W.jsxs("div",{className:"min-h-screen aurora-gradient p-6 relative",children:[W.jsx("div",{className:"aurora-bg"}),W.jsxs("div",{className:"max-w-7xl mx-auto relative z-10",children:[W.jsxs("div",{className:"glass-panel border-b border-border/50 px-6 py-4 flex justify-between items-center mb-8",children:[W.jsxs("div",{children:[W.jsx("h1",{className:"text-2xl font-bold aurora-text",children:"Security Command Center"}),W.jsxs("p",{className:"text-sm text-muted-foreground",children:["Welcome, ",e==null?void 0:e.email]})]}),W.jsxs("div",{className:"flex gap-4",children:[W.jsx(Qs,{to:"/security/analytics",className:"px-4 py-2 bg-secondary/60 hover:bg-secondary/80 text-foreground rounded-lg transition-colors border border-border/50",children:"Analytics"}),W.jsx(Qs,{to:"/security/history",className:"px-4 py-2 bg-secondary/60 hover:bg-secondary/80 text-foreground rounded-lg transition-colors border border-border/50",children:"History"}),W.jsx("button",{onClick:t,className:"px-4 py-2 bg-secondary/60 hover:bg-secondary/80 text-foreground rounded-lg transition-colors border border-border/50",children:"Logout"})]})]}),W.jsxs("div",{className:"mb-6 map-container p-6",children:[W.jsx("h2",{className:"text-xl font-semibold text-foreground mb-4",children:"Live Map & SOS Locations"}),W.jsx(uI,{sosMarkers:r.filter(w=>{var A,k;return typeof((A=w.location)==null?void 0:A.lat)=="number"&&typeof((k=w.location)==null?void 0:k.lng)=="number"}).map(w=>({id:w.id,lat:w.location.lat,lng:w.location.lng,riskScore:w.risk_score})),height:"400px"})]}),W.jsxs("div",{className:"glass-panel p-6",children:[W.jsx("h2",{className:"text-xl font-semibold text-foreground mb-4",children:"Live Alerts"}),o?W.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Loading alerts..."}):r.length===0?W.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No active alerts"}):W.jsx("div",{className:"space-y-4",children:r.map(w=>W.jsx(Qs,{to:`/security/alert/${w.id}`,className:"block bg-secondary/40 hover:bg-secondary/60 rounded-lg p-4 transition-colors border border-border/40",children:W.jsxs("div",{className:"flex justify-between items-start",children:[W.jsxs("div",{className:"flex-1",children:[W.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[W.jsx("span",{className:`text-2xl font-bold ${y(w.risk_score)}`,children:w.risk_score.toFixed(1)}),W.jsx("span",{className:`px-3 py-1 rounded text-xs font-semibold ${w.risk_score>=50?"bg-danger/20 text-danger":w.risk_score>=25?"bg-warning/20 text-warning":"bg-safe/20 text-safe"}`,children:b(w.risk_score)}),Array.isArray(w.attachments)&&w.attachments.length>0?W.jsx("span",{className:"px-2 py-1 rounded text-xs font-semibold bg-aurora-cyan/15 text-aurora-cyan border border-aurora-cyan/30",children:"MEDIA"}):null,W.jsx("span",{className:"text-muted-foreground text-sm",children:w.trigger_type.charAt(0).toUpperCase()+w.trigger_type.slice(1)})]}),W.jsx("p",{className:"text-muted-foreground text-sm",children:new Date(w.created_at).toLocaleString()}),W.jsxs("p",{className:"text-muted-foreground text-sm",children:["User: ",w.email||w.user_id||"Unknown sender"]})]}),W.jsx("div",{className:"text-right",children:W.jsx("span",{className:`px-3 py-1 rounded text-xs font-semibold ${w.status==="resolved"?"bg-safe/20 text-safe":w.status==="acknowledged"?"bg-warning/20 text-warning":"bg-danger/20 text-danger"}`,children:w.status.toUpperCase()})})]})},w.id))})]})]})]})}var qae=Array.isArray,ss=qae,Hae=typeof zy=="object"&&zy&&zy.Object===Object&&zy,U8=Hae,Kae=U8,Zae=typeof self=="object"&&self&&self.Object===Object&&self,Xae=Kae||Zae||Function("return this")(),kl=Xae,Yae=kl,Jae=Yae.Symbol,U_=Jae,T3=U_,V8=Object.prototype,Qae=V8.hasOwnProperty,ele=V8.toString,Py=T3?T3.toStringTag:void 0;function tle(e){var t=Qae.call(e,Py),r=e[Py];try{e[Py]=void 0;var n=!0}catch{}var o=ele.call(e);return n&&(t?e[Py]=r:delete e[Py]),o}var rle=tle,nle=Object.prototype,ile=nle.toString;function ole(e){return ile.call(e)}var sle=ole,E3=U_,ale=rle,lle=sle,cle="[object Null]",ule="[object Undefined]",A3=E3?E3.toStringTag:void 0;function hle(e){return e==null?e===void 0?ule:cle:A3&&A3 in Object(e)?ale(e):lle(e)}var wc=hle;function dle(e){return e!=null&&typeof e=="object"}var Sc=dle,fle=wc,ple=Sc,mle="[object Symbol]";function gle(e){return typeof e=="symbol"||ple(e)&&fle(e)==mle}var Cm=gle,yle=ss,vle=Cm,_le=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,xle=/^\w*$/;function ble(e,t){if(yle(e))return!1;var r=typeof e;return r=="number"||r=="symbol"||r=="boolean"||e==null||vle(e)?!0:xle.test(e)||!_le.test(e)||t!=null&&e in Object(t)}var hI=ble;function wle(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var Gu=wle;const km=mn(Gu);var Sle=wc,Tle=Gu,Ele="[object AsyncFunction]",Ale="[object Function]",Ple="[object GeneratorFunction]",Cle="[object Proxy]";function kle(e){if(!Tle(e))return!1;var t=Sle(e);return t==Ale||t==Ple||t==Ele||t==Cle}var dI=kle;const Ar=mn(dI);var Ole=kl,Mle=Ole["__core-js_shared__"],Ile=Mle,wA=Ile,P3=function(){var e=/[^.]+$/.exec(wA&&wA.keys&&wA.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function Rle(e){return!!P3&&P3 in e}var Dle=Rle,Lle=Function.prototype,jle=Lle.toString;function zle(e){if(e!=null){try{return jle.call(e)}catch{}try{return e+""}catch{}}return""}var G8=zle,Ble=dI,Nle=Dle,$le=Gu,Fle=G8,Ule=/[\\^$.*+?()[\]{}|]/g,Vle=/^\[object .+?Constructor\]$/,Gle=Function.prototype,Wle=Object.prototype,qle=Gle.toString,Hle=Wle.hasOwnProperty,Kle=RegExp("^"+qle.call(Hle).replace(Ule,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Zle(e){if(!$le(e)||Nle(e))return!1;var t=Ble(e)?Kle:Vle;return t.test(Fle(e))}var Xle=Zle;function Yle(e,t){return e==null?void 0:e[t]}var Jle=Yle,Qle=Xle,ece=Jle;function tce(e,t){var r=ece(e,t);return Qle(r)?r:void 0}var Od=tce,rce=Od,nce=rce(Object,"create"),K1=nce,C3=K1;function ice(){this.__data__=C3?C3(null):{},this.size=0}var oce=ice;function sce(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var ace=sce,lce=K1,cce="__lodash_hash_undefined__",uce=Object.prototype,hce=uce.hasOwnProperty;function dce(e){var t=this.__data__;if(lce){var r=t[e];return r===cce?void 0:r}return hce.call(t,e)?t[e]:void 0}var fce=dce,pce=K1,mce=Object.prototype,gce=mce.hasOwnProperty;function yce(e){var t=this.__data__;return pce?t[e]!==void 0:gce.call(t,e)}var vce=yce,_ce=K1,xce="__lodash_hash_undefined__";function bce(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=_ce&&t===void 0?xce:t,this}var wce=bce,Sce=oce,Tce=ace,Ece=fce,Ace=vce,Pce=wce;function Om(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Om.prototype.clear=Sce;Om.prototype.delete=Tce;Om.prototype.get=Ece;Om.prototype.has=Ace;Om.prototype.set=Pce;var Cce=Om;function kce(){this.__data__=[],this.size=0}var Oce=kce;function Mce(e,t){return e===t||e!==e&&t!==t}var fI=Mce,Ice=fI;function Rce(e,t){for(var r=e.length;r--;)if(Ice(e[r][0],t))return r;return-1}var Z1=Rce,Dce=Z1,Lce=Array.prototype,jce=Lce.splice;function zce(e){var t=this.__data__,r=Dce(t,e);if(r<0)return!1;var n=t.length-1;return r==n?t.pop():jce.call(t,r,1),--this.size,!0}var Bce=zce,Nce=Z1;function $ce(e){var t=this.__data__,r=Nce(t,e);return r<0?void 0:t[r][1]}var Fce=$ce,Uce=Z1;function Vce(e){return Uce(this.__data__,e)>-1}var Gce=Vce,Wce=Z1;function qce(e,t){var r=this.__data__,n=Wce(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this}var Hce=qce,Kce=Oce,Zce=Bce,Xce=Fce,Yce=Gce,Jce=Hce;function Mm(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Mm.prototype.clear=Kce;Mm.prototype.delete=Zce;Mm.prototype.get=Xce;Mm.prototype.has=Yce;Mm.prototype.set=Jce;var X1=Mm,Qce=Od,eue=kl,tue=Qce(eue,"Map"),pI=tue,k3=Cce,rue=X1,nue=pI;function iue(){this.size=0,this.__data__={hash:new k3,map:new(nue||rue),string:new k3}}var oue=iue;function sue(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}var aue=sue,lue=aue;function cue(e,t){var r=e.__data__;return lue(t)?r[typeof t=="string"?"string":"hash"]:r.map}var Y1=cue,uue=Y1;function hue(e){var t=uue(this,e).delete(e);return this.size-=t?1:0,t}var due=hue,fue=Y1;function pue(e){return fue(this,e).get(e)}var mue=pue,gue=Y1;function yue(e){return gue(this,e).has(e)}var vue=yue,_ue=Y1;function xue(e,t){var r=_ue(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this}var bue=xue,wue=oue,Sue=due,Tue=mue,Eue=vue,Aue=bue;function Im(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Im.prototype.clear=wue;Im.prototype.delete=Sue;Im.prototype.get=Tue;Im.prototype.has=Eue;Im.prototype.set=Aue;var mI=Im,W8=mI,Pue="Expected a function";function gI(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError(Pue);var r=function(){var n=arguments,o=t?t.apply(this,n):n[0],l=r.cache;if(l.has(o))return l.get(o);var h=e.apply(this,n);return r.cache=l.set(o,h)||l,h};return r.cache=new(gI.Cache||W8),r}gI.Cache=W8;var q8=gI;const Cue=mn(q8);var kue=q8,Oue=500;function Mue(e){var t=kue(e,function(n){return r.size===Oue&&r.clear(),n}),r=t.cache;return t}var Iue=Mue,Rue=Iue,Due=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Lue=/\\(\\)?/g,jue=Rue(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(Due,function(r,n,o,l){t.push(o?l.replace(Lue,"$1"):n||r)}),t}),zue=jue;function Bue(e,t){for(var r=-1,n=e==null?0:e.length,o=Array(n);++r<n;)o[r]=t(e[r],r,e);return o}var yI=Bue,O3=U_,Nue=yI,$ue=ss,Fue=Cm,M3=O3?O3.prototype:void 0,I3=M3?M3.toString:void 0;function H8(e){if(typeof e=="string")return e;if($ue(e))return Nue(e,H8)+"";if(Fue(e))return I3?I3.call(e):"";var t=e+"";return t=="0"&&1/e==-1/0?"-0":t}var Uue=H8,Vue=Uue;function Gue(e){return e==null?"":Vue(e)}var K8=Gue,Wue=ss,que=hI,Hue=zue,Kue=K8;function Zue(e,t){return Wue(e)?e:que(e,t)?[e]:Hue(Kue(e))}var Z8=Zue,Xue=Cm;function Yue(e){if(typeof e=="string"||Xue(e))return e;var t=e+"";return t=="0"&&1/e==-1/0?"-0":t}var J1=Yue,Jue=Z8,Que=J1;function ehe(e,t){t=Jue(t,e);for(var r=0,n=t.length;e!=null&&r<n;)e=e[Que(t[r++])];return r&&r==n?e:void 0}var vI=ehe,the=vI;function rhe(e,t,r){var n=e==null?void 0:the(e,t);return n===void 0?r:n}var X8=rhe;const ta=mn(X8);function nhe(e){return e==null}var ihe=nhe;const wr=mn(ihe);var ohe=wc,she=ss,ahe=Sc,lhe="[object String]";function che(e){return typeof e=="string"||!she(e)&&ahe(e)&&ohe(e)==lhe}var uhe=che;const bd=mn(uhe);var Y8={exports:{}},gn={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _I=Symbol.for("react.element"),xI=Symbol.for("react.portal"),Q1=Symbol.for("react.fragment"),eS=Symbol.for("react.strict_mode"),tS=Symbol.for("react.profiler"),rS=Symbol.for("react.provider"),nS=Symbol.for("react.context"),hhe=Symbol.for("react.server_context"),iS=Symbol.for("react.forward_ref"),oS=Symbol.for("react.suspense"),sS=Symbol.for("react.suspense_list"),aS=Symbol.for("react.memo"),lS=Symbol.for("react.lazy"),dhe=Symbol.for("react.offscreen"),J8;J8=Symbol.for("react.module.reference");function oa(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case _I:switch(e=e.type,e){case Q1:case tS:case eS:case oS:case sS:return e;default:switch(e=e&&e.$$typeof,e){case hhe:case nS:case iS:case lS:case aS:case rS:return e;default:return t}}case xI:return t}}}gn.ContextConsumer=nS;gn.ContextProvider=rS;gn.Element=_I;gn.ForwardRef=iS;gn.Fragment=Q1;gn.Lazy=lS;gn.Memo=aS;gn.Portal=xI;gn.Profiler=tS;gn.StrictMode=eS;gn.Suspense=oS;gn.SuspenseList=sS;gn.isAsyncMode=function(){return!1};gn.isConcurrentMode=function(){return!1};gn.isContextConsumer=function(e){return oa(e)===nS};gn.isContextProvider=function(e){return oa(e)===rS};gn.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===_I};gn.isForwardRef=function(e){return oa(e)===iS};gn.isFragment=function(e){return oa(e)===Q1};gn.isLazy=function(e){return oa(e)===lS};gn.isMemo=function(e){return oa(e)===aS};gn.isPortal=function(e){return oa(e)===xI};gn.isProfiler=function(e){return oa(e)===tS};gn.isStrictMode=function(e){return oa(e)===eS};gn.isSuspense=function(e){return oa(e)===oS};gn.isSuspenseList=function(e){return oa(e)===sS};gn.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===Q1||e===tS||e===eS||e===oS||e===sS||e===dhe||typeof e=="object"&&e!==null&&(e.$$typeof===lS||e.$$typeof===aS||e.$$typeof===rS||e.$$typeof===nS||e.$$typeof===iS||e.$$typeof===J8||e.getModuleId!==void 0)};gn.typeOf=oa;Y8.exports=gn;var fhe=Y8.exports,phe=wc,mhe=Sc,ghe="[object Number]";function yhe(e){return typeof e=="number"||mhe(e)&&phe(e)==ghe}var Q8=yhe;const vhe=mn(Q8);var _he=Q8;function xhe(e){return _he(e)&&e!=+e}var bhe=xhe;const Rm=mn(bhe);var $a=function(t){return t===0?0:t>0?1:-1},rd=function(t){return bd(t)&&t.indexOf("%")===t.length-1},It=function(t){return vhe(t)&&!Rm(t)},whe=function(t){return wr(t)},Di=function(t){return It(t)||bd(t)},She=0,Md=function(t){var r=++She;return"".concat(t||"").concat(r)},wd=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!It(t)&&!bd(t))return n;var l;if(rd(t)){var h=t.indexOf("%");l=r*parseFloat(t.slice(0,h))/100}else l=+t;return Rm(l)&&(l=n),o&&l>r&&(l=r),l},pu=function(t){if(!t)return null;var r=Object.keys(t);return r&&r.length?t[r[0]]:null},The=function(t){if(!Array.isArray(t))return!1;for(var r=t.length,n={},o=0;o<r;o++)if(!n[t[o]])n[t[o]]=!0;else return!0;return!1},li=function(t,r){return It(t)&&It(r)?function(n){return t+n*(r-t)}:function(){return r}};function pw(e,t,r){return!e||!e.length?null:e.find(function(n){return n&&(typeof t=="function"?t(n):ta(n,t))===r})}var Ehe=function(t){if(!t||!t.length)return null;for(var r=t.length,n=0,o=0,l=0,h=0,f=1/0,s=-1/0,y=0,b=0,w=0;w<r;w++)y=t[w].cx||0,b=t[w].cy||0,n+=y,o+=b,l+=y*b,h+=y*y,f=Math.min(f,y),s=Math.max(s,y);var A=r*h!==n*n?(r*l-n*o)/(r*h-n*n):0;return{xmin:f,xmax:s,a:A,b:(o-A*n)/r}},Ahe=function(t,r){return It(t)&&It(r)?t-r:bd(t)&&bd(r)?t.localeCompare(r):t instanceof Date&&r instanceof Date?t.getTime()-r.getTime():String(t).localeCompare(String(r))};function Mp(e,t){for(var r in e)if({}.hasOwnProperty.call(e,r)&&(!{}.hasOwnProperty.call(t,r)||e[r]!==t[r]))return!1;for(var n in t)if({}.hasOwnProperty.call(t,n)&&!{}.hasOwnProperty.call(e,n))return!1;return!0}function FC(e){"@babel/helpers - typeof";return FC=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},FC(e)}var Phe=["viewBox","children"],Che=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],R3=["points","pathLength"],SA={svg:Phe,polygon:R3,polyline:R3},bI=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"],mw=function(t,r){if(!t||typeof t=="function"||typeof t=="boolean")return null;var n=t;if(re.isValidElement(t)&&(n=t.props),!km(n))return null;var o={};return Object.keys(n).forEach(function(l){bI.includes(l)&&(o[l]=r||function(h){return n[l](n,h)})}),o},khe=function(t,r,n){return function(o){return t(r,n,o),null}},qv=function(t,r,n){if(!km(t)||FC(t)!=="object")return null;var o=null;return Object.keys(t).forEach(function(l){var h=t[l];bI.includes(l)&&typeof h=="function"&&(o||(o={}),o[l]=khe(h,r,n))}),o},Ohe=["children"],Mhe=["children"];function D3(e,t){if(e==null)return{};var r=Ihe(e,t),n,o;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(o=0;o<l.length;o++)n=l[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Ihe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function UC(e){"@babel/helpers - typeof";return UC=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},UC(e)}var L3={click:"onClick",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",mouseout:"onMouseOut",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",touchcancel:"onTouchCancel",touchend:"onTouchEnd",touchmove:"onTouchMove",touchstart:"onTouchStart",contextmenu:"onContextMenu",dblclick:"onDoubleClick"},sc=function(t){return typeof t=="string"?t:t?t.displayName||t.name||"Component":""},j3=null,TA=null,wI=function e(t){if(t===j3&&Array.isArray(TA))return TA;var r=[];return re.Children.forEach(t,function(n){wr(n)||(fhe.isFragment(n)?r=r.concat(e(n.props.children)):r.push(n))}),TA=r,j3=t,r};function os(e,t){var r=[],n=[];return Array.isArray(t)?n=t.map(function(o){return sc(o)}):n=[sc(t)],wI(e).forEach(function(o){var l=ta(o,"type.displayName")||ta(o,"type.name");n.indexOf(l)!==-1&&r.push(o)}),r}function bs(e,t){var r=os(e,t);return r&&r[0]}var z3=function(t){if(!t||!t.props)return!1;var r=t.props,n=r.width,o=r.height;return!(!It(n)||n<=0||!It(o)||o<=0)},Rhe=["a","altGlyph","altGlyphDef","altGlyphItem","animate","animateColor","animateMotion","animateTransform","circle","clipPath","color-profile","cursor","defs","desc","ellipse","feBlend","feColormatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","font","font-face","font-face-format","font-face-name","font-face-url","foreignObject","g","glyph","glyphRef","hkern","image","line","lineGradient","marker","mask","metadata","missing-glyph","mpath","path","pattern","polygon","polyline","radialGradient","rect","script","set","stop","style","svg","switch","symbol","text","textPath","title","tref","tspan","use","view","vkern"],Dhe=function(t){return t&&t.type&&bd(t.type)&&Rhe.indexOf(t.type)>=0},eG=function(t){return t&&UC(t)==="object"&&"clipDot"in t},Lhe=function(t,r,n,o){var l,h=(l=SA==null?void 0:SA[o])!==null&&l!==void 0?l:[];return r.startsWith("data-")||!Ar(t)&&(o&&h.includes(r)||Che.includes(r))||n&&bI.includes(r)},Sr=function(t,r,n){if(!t||typeof t=="function"||typeof t=="boolean")return null;var o=t;if(re.isValidElement(t)&&(o=t.props),!km(o))return null;var l={};return Object.keys(o).forEach(function(h){var f;Lhe((f=o)===null||f===void 0?void 0:f[h],h,r,n)&&(l[h]=o[h])}),l},VC=function e(t,r){if(t===r)return!0;var n=re.Children.count(t);if(n!==re.Children.count(r))return!1;if(n===0)return!0;if(n===1)return B3(Array.isArray(t)?t[0]:t,Array.isArray(r)?r[0]:r);for(var o=0;o<n;o++){var l=t[o],h=r[o];if(Array.isArray(l)||Array.isArray(h)){if(!e(l,h))return!1}else if(!B3(l,h))return!1}return!0},B3=function(t,r){if(wr(t)&&wr(r))return!0;if(!wr(t)&&!wr(r)){var n=t.props||{},o=n.children,l=D3(n,Ohe),h=r.props||{},f=h.children,s=D3(h,Mhe);return o&&f?Mp(l,s)&&VC(o,f):!o&&!f?Mp(l,s):!1}return!1},N3=function(t,r){var n=[],o={};return wI(t).forEach(function(l,h){if(Dhe(l))n.push(l);else if(l){var f=sc(l.type),s=r[f]||{},y=s.handler,b=s.once;if(y&&(!b||!o[f])){var w=y(l,f,h);n.push(w),o[f]=!0}}}),n},jhe=function(t){var r=t&&t.type;return r&&L3[r]?L3[r]:null},zhe=function(t,r){return wI(r).indexOf(t)},Bhe=["children","width","height","viewBox","className","style","title","desc"];function GC(){return GC=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},GC.apply(this,arguments)}function Nhe(e,t){if(e==null)return{};var r=$he(e,t),n,o;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(o=0;o<l.length;o++)n=l[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function $he(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function WC(e){var t=e.children,r=e.width,n=e.height,o=e.viewBox,l=e.className,h=e.style,f=e.title,s=e.desc,y=Nhe(e,Bhe),b=o||{width:r,height:n,x:0,y:0},w=zr("recharts-surface",l);return Ce.createElement("svg",GC({},Sr(y,!0,"svg"),{className:w,width:r,height:n,style:h,viewBox:"".concat(b.x," ").concat(b.y," ").concat(b.width," ").concat(b.height)}),Ce.createElement("title",null,f),Ce.createElement("desc",null,s),t)}var Fhe=["children","className"];function qC(){return qC=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},qC.apply(this,arguments)}function Uhe(e,t){if(e==null)return{};var r=Vhe(e,t),n,o;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(o=0;o<l.length;o++)n=l[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Vhe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var sn=Ce.forwardRef(function(e,t){var r=e.children,n=e.className,o=Uhe(e,Fhe),l=zr("recharts-layer",n);return Ce.createElement("g",qC({className:l},Sr(o,!0),{ref:t}),r)}),ac=function(t,r){for(var n=arguments.length,o=new Array(n>2?n-2:0),l=2;l<n;l++)o[l-2]=arguments[l]};function Ghe(e,t,r){var n=-1,o=e.length;t<0&&(t=-t>o?0:o+t),r=r>o?o:r,r<0&&(r+=o),o=t>r?0:r-t>>>0,t>>>=0;for(var l=Array(o);++n<o;)l[n]=e[n+t];return l}var Whe=Ghe,qhe=Whe;function Hhe(e,t,r){var n=e.length;return r=r===void 0?n:r,!t&&r>=n?e:qhe(e,t,r)}var Khe=Hhe,Zhe="\\ud800-\\udfff",Xhe="\\u0300-\\u036f",Yhe="\\ufe20-\\ufe2f",Jhe="\\u20d0-\\u20ff",Qhe=Xhe+Yhe+Jhe,ede="\\ufe0e\\ufe0f",tde="\\u200d",rde=RegExp("["+tde+Zhe+Qhe+ede+"]");function nde(e){return rde.test(e)}var tG=nde;function ide(e){return e.split("")}var ode=ide,rG="\\ud800-\\udfff",sde="\\u0300-\\u036f",ade="\\ufe20-\\ufe2f",lde="\\u20d0-\\u20ff",cde=sde+ade+lde,ude="\\ufe0e\\ufe0f",hde="["+rG+"]",HC="["+cde+"]",KC="\\ud83c[\\udffb-\\udfff]",dde="(?:"+HC+"|"+KC+")",nG="[^"+rG+"]",iG="(?:\\ud83c[\\udde6-\\uddff]){2}",oG="[\\ud800-\\udbff][\\udc00-\\udfff]",fde="\\u200d",sG=dde+"?",aG="["+ude+"]?",pde="(?:"+fde+"(?:"+[nG,iG,oG].join("|")+")"+aG+sG+")*",mde=aG+sG+pde,gde="(?:"+[nG+HC+"?",HC,iG,oG,hde].join("|")+")",yde=RegExp(KC+"(?="+KC+")|"+gde+mde,"g");function vde(e){return e.match(yde)||[]}var _de=vde,xde=ode,bde=tG,wde=_de;function Sde(e){return bde(e)?wde(e):xde(e)}var Tde=Sde,Ede=Khe,Ade=tG,Pde=Tde,Cde=K8;function kde(e){return function(t){t=Cde(t);var r=Ade(t)?Pde(t):void 0,n=r?r[0]:t.charAt(0),o=r?Ede(r,1).join(""):t.slice(1);return n[e]()+o}}var Ode=kde,Mde=Ode,Ide=Mde("toUpperCase"),Rde=Ide;const cS=mn(Rde);function Tn(e){return function(){return e}}const lG=Math.cos,gw=Math.sin,qa=Math.sqrt,yw=Math.PI,uS=2*yw,ZC=Math.PI,XC=2*ZC,Vh=1e-6,Dde=XC-Vh;function cG(e){this._+=e[0];for(let t=1,r=e.length;t<r;++t)this._+=arguments[t]+e[t]}function Lde(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return cG;const r=10**t;return function(n){this._+=n[0];for(let o=1,l=n.length;o<l;++o)this._+=Math.round(arguments[o]*r)/r+n[o]}}class jde{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?cG:Lde(t)}moveTo(t,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,r){this._append`L${this._x1=+t},${this._y1=+r}`}quadraticCurveTo(t,r,n,o){this._append`Q${+t},${+r},${this._x1=+n},${this._y1=+o}`}bezierCurveTo(t,r,n,o,l,h){this._append`C${+t},${+r},${+n},${+o},${this._x1=+l},${this._y1=+h}`}arcTo(t,r,n,o,l){if(t=+t,r=+r,n=+n,o=+o,l=+l,l<0)throw new Error(`negative radius: ${l}`);let h=this._x1,f=this._y1,s=n-t,y=o-r,b=h-t,w=f-r,A=b*b+w*w;if(this._x1===null)this._append`M${this._x1=t},${this._y1=r}`;else if(A>Vh)if(!(Math.abs(w*s-y*b)>Vh)||!l)this._append`L${this._x1=t},${this._y1=r}`;else{let k=n-h,M=o-f,R=s*s+y*y,j=k*k+M*M,L=Math.sqrt(R),z=Math.sqrt(A),B=l*Math.tan((ZC-Math.acos((R+A-j)/(2*L*z)))/2),Z=B/z,F=B/L;Math.abs(Z-1)>Vh&&this._append`L${t+Z*b},${r+Z*w}`,this._append`A${l},${l},0,0,${+(w*k>b*M)},${this._x1=t+F*s},${this._y1=r+F*y}`}}arc(t,r,n,o,l,h){if(t=+t,r=+r,n=+n,h=!!h,n<0)throw new Error(`negative radius: ${n}`);let f=n*Math.cos(o),s=n*Math.sin(o),y=t+f,b=r+s,w=1^h,A=h?o-l:l-o;this._x1===null?this._append`M${y},${b}`:(Math.abs(this._x1-y)>Vh||Math.abs(this._y1-b)>Vh)&&this._append`L${y},${b}`,n&&(A<0&&(A=A%XC+XC),A>Dde?this._append`A${n},${n},0,1,${w},${t-f},${r-s}A${n},${n},0,1,${w},${this._x1=y},${this._y1=b}`:A>Vh&&this._append`A${n},${n},0,${+(A>=ZC)},${w},${this._x1=t+n*Math.cos(l)},${this._y1=r+n*Math.sin(l)}`)}rect(t,r,n,o){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}h${n=+n}v${+o}h${-n}Z`}toString(){return this._}}function SI(e){let t=3;return e.digits=function(r){if(!arguments.length)return t;if(r==null)t=null;else{const n=Math.floor(r);if(!(n>=0))throw new RangeError(`invalid digits: ${r}`);t=n}return e},()=>new jde(t)}function TI(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function uG(e){this._context=e}uG.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function hS(e){return new uG(e)}function hG(e){return e[0]}function dG(e){return e[1]}function fG(e,t){var r=Tn(!0),n=null,o=hS,l=null,h=SI(f);e=typeof e=="function"?e:e===void 0?hG:Tn(e),t=typeof t=="function"?t:t===void 0?dG:Tn(t);function f(s){var y,b=(s=TI(s)).length,w,A=!1,k;for(n==null&&(l=o(k=h())),y=0;y<=b;++y)!(y<b&&r(w=s[y],y,s))===A&&((A=!A)?l.lineStart():l.lineEnd()),A&&l.point(+e(w,y,s),+t(w,y,s));if(k)return l=null,k+""||null}return f.x=function(s){return arguments.length?(e=typeof s=="function"?s:Tn(+s),f):e},f.y=function(s){return arguments.length?(t=typeof s=="function"?s:Tn(+s),f):t},f.defined=function(s){return arguments.length?(r=typeof s=="function"?s:Tn(!!s),f):r},f.curve=function(s){return arguments.length?(o=s,n!=null&&(l=o(n)),f):o},f.context=function(s){return arguments.length?(s==null?n=l=null:l=o(n=s),f):n},f}function Wx(e,t,r){var n=null,o=Tn(!0),l=null,h=hS,f=null,s=SI(y);e=typeof e=="function"?e:e===void 0?hG:Tn(+e),t=typeof t=="function"?t:Tn(t===void 0?0:+t),r=typeof r=="function"?r:r===void 0?dG:Tn(+r);function y(w){var A,k,M,R=(w=TI(w)).length,j,L=!1,z,B=new Array(R),Z=new Array(R);for(l==null&&(f=h(z=s())),A=0;A<=R;++A){if(!(A<R&&o(j=w[A],A,w))===L)if(L=!L)k=A,f.areaStart(),f.lineStart();else{for(f.lineEnd(),f.lineStart(),M=A-1;M>=k;--M)f.point(B[M],Z[M]);f.lineEnd(),f.areaEnd()}L&&(B[A]=+e(j,A,w),Z[A]=+t(j,A,w),f.point(n?+n(j,A,w):B[A],r?+r(j,A,w):Z[A]))}if(z)return f=null,z+""||null}function b(){return fG().defined(o).curve(h).context(l)}return y.x=function(w){return arguments.length?(e=typeof w=="function"?w:Tn(+w),n=null,y):e},y.x0=function(w){return arguments.length?(e=typeof w=="function"?w:Tn(+w),y):e},y.x1=function(w){return arguments.length?(n=w==null?null:typeof w=="function"?w:Tn(+w),y):n},y.y=function(w){return arguments.length?(t=typeof w=="function"?w:Tn(+w),r=null,y):t},y.y0=function(w){return arguments.length?(t=typeof w=="function"?w:Tn(+w),y):t},y.y1=function(w){return arguments.length?(r=w==null?null:typeof w=="function"?w:Tn(+w),y):r},y.lineX0=y.lineY0=function(){return b().x(e).y(t)},y.lineY1=function(){return b().x(e).y(r)},y.lineX1=function(){return b().x(n).y(t)},y.defined=function(w){return arguments.length?(o=typeof w=="function"?w:Tn(!!w),y):o},y.curve=function(w){return arguments.length?(h=w,l!=null&&(f=h(l)),y):h},y.context=function(w){return arguments.length?(w==null?l=f=null:f=h(l=w),y):l},y}class pG{constructor(t,r){this._context=t,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,r){switch(t=+t,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,r):this._context.moveTo(t,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,r,t,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,t,this._y0,t,r);break}}this._x0=t,this._y0=r}}function zde(e){return new pG(e,!0)}function Bde(e){return new pG(e,!1)}const EI={draw(e,t){const r=qa(t/yw);e.moveTo(r,0),e.arc(0,0,r,0,uS)}},Nde={draw(e,t){const r=qa(t/5)/2;e.moveTo(-3*r,-r),e.lineTo(-r,-r),e.lineTo(-r,-3*r),e.lineTo(r,-3*r),e.lineTo(r,-r),e.lineTo(3*r,-r),e.lineTo(3*r,r),e.lineTo(r,r),e.lineTo(r,3*r),e.lineTo(-r,3*r),e.lineTo(-r,r),e.lineTo(-3*r,r),e.closePath()}},mG=qa(1/3),$de=mG*2,Fde={draw(e,t){const r=qa(t/$de),n=r*mG;e.moveTo(0,-r),e.lineTo(n,0),e.lineTo(0,r),e.lineTo(-n,0),e.closePath()}},Ude={draw(e,t){const r=qa(t),n=-r/2;e.rect(n,n,r,r)}},Vde=.8908130915292852,gG=gw(yw/10)/gw(7*yw/10),Gde=gw(uS/10)*gG,Wde=-lG(uS/10)*gG,qde={draw(e,t){const r=qa(t*Vde),n=Gde*r,o=Wde*r;e.moveTo(0,-r),e.lineTo(n,o);for(let l=1;l<5;++l){const h=uS*l/5,f=lG(h),s=gw(h);e.lineTo(s*r,-f*r),e.lineTo(f*n-s*o,s*n+f*o)}e.closePath()}},EA=qa(3),Hde={draw(e,t){const r=-qa(t/(EA*3));e.moveTo(0,r*2),e.lineTo(-EA*r,-r),e.lineTo(EA*r,-r),e.closePath()}},Fs=-.5,Us=qa(3)/2,YC=1/qa(12),Kde=(YC/2+1)*3,Zde={draw(e,t){const r=qa(t/Kde),n=r/2,o=r*YC,l=n,h=r*YC+r,f=-l,s=h;e.moveTo(n,o),e.lineTo(l,h),e.lineTo(f,s),e.lineTo(Fs*n-Us*o,Us*n+Fs*o),e.lineTo(Fs*l-Us*h,Us*l+Fs*h),e.lineTo(Fs*f-Us*s,Us*f+Fs*s),e.lineTo(Fs*n+Us*o,Fs*o-Us*n),e.lineTo(Fs*l+Us*h,Fs*h-Us*l),e.lineTo(Fs*f+Us*s,Fs*s-Us*f),e.closePath()}};function Xde(e,t){let r=null,n=SI(o);e=typeof e=="function"?e:Tn(e||EI),t=typeof t=="function"?t:Tn(t===void 0?64:+t);function o(){let l;if(r||(r=l=n()),e.apply(this,arguments).draw(r,+t.apply(this,arguments)),l)return r=null,l+""||null}return o.type=function(l){return arguments.length?(e=typeof l=="function"?l:Tn(l),o):e},o.size=function(l){return arguments.length?(t=typeof l=="function"?l:Tn(+l),o):t},o.context=function(l){return arguments.length?(r=l??null,o):r},o}function vw(){}function _w(e,t,r){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+r)/6)}function yG(e){this._context=e}yG.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:_w(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:_w(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function Yde(e){return new yG(e)}function vG(e){this._context=e}vG.prototype={areaStart:vw,areaEnd:vw,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:_w(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function Jde(e){return new vG(e)}function _G(e){this._context=e}_G.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+e)/6,n=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(r,n):this._context.moveTo(r,n);break;case 3:this._point=4;default:_w(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function Qde(e){return new _G(e)}function xG(e){this._context=e}xG.prototype={areaStart:vw,areaEnd:vw,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function efe(e){return new xG(e)}function $3(e){return e<0?-1:1}function F3(e,t,r){var n=e._x1-e._x0,o=t-e._x1,l=(e._y1-e._y0)/(n||o<0&&-0),h=(r-e._y1)/(o||n<0&&-0),f=(l*o+h*n)/(n+o);return($3(l)+$3(h))*Math.min(Math.abs(l),Math.abs(h),.5*Math.abs(f))||0}function U3(e,t){var r=e._x1-e._x0;return r?(3*(e._y1-e._y0)/r-t)/2:t}function AA(e,t,r){var n=e._x0,o=e._y0,l=e._x1,h=e._y1,f=(l-n)/3;e._context.bezierCurveTo(n+f,o+f*t,l-f,h-f*r,l,h)}function xw(e){this._context=e}xw.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:AA(this,this._t0,U3(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var r=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,AA(this,U3(this,r=F3(this,e,t)),r);break;default:AA(this,this._t0,r=F3(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=r}}};function bG(e){this._context=new wG(e)}(bG.prototype=Object.create(xw.prototype)).point=function(e,t){xw.prototype.point.call(this,t,e)};function wG(e){this._context=e}wG.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,r,n,o,l){this._context.bezierCurveTo(t,e,n,r,l,o)}};function tfe(e){return new xw(e)}function rfe(e){return new bG(e)}function SG(e){this._context=e}SG.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,r=e.length;if(r)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),r===2)this._context.lineTo(e[1],t[1]);else for(var n=V3(e),o=V3(t),l=0,h=1;h<r;++l,++h)this._context.bezierCurveTo(n[0][l],o[0][l],n[1][l],o[1][l],e[h],t[h]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function V3(e){var t,r=e.length-1,n,o=new Array(r),l=new Array(r),h=new Array(r);for(o[0]=0,l[0]=2,h[0]=e[0]+2*e[1],t=1;t<r-1;++t)o[t]=1,l[t]=4,h[t]=4*e[t]+2*e[t+1];for(o[r-1]=2,l[r-1]=7,h[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)n=o[t]/l[t-1],l[t]-=n,h[t]-=n*h[t-1];for(o[r-1]=h[r-1]/l[r-1],t=r-2;t>=0;--t)o[t]=(h[t]-o[t+1])/l[t];for(l[r-1]=(e[r]+o[r-1])/2,t=0;t<r-1;++t)l[t]=2*e[t+1]-o[t+1];return[o,l]}function nfe(e){return new SG(e)}function dS(e,t){this._context=e,this._t=t}dS.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var r=this._x*(1-this._t)+e*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,t)}break}}this._x=e,this._y=t}};function ife(e){return new dS(e,.5)}function ofe(e){return new dS(e,0)}function sfe(e){return new dS(e,1)}function Gp(e,t){if((h=e.length)>1)for(var r=1,n,o,l=e[t[0]],h,f=l.length;r<h;++r)for(o=l,l=e[t[r]],n=0;n<f;++n)l[n][1]+=l[n][0]=isNaN(o[n][1])?o[n][0]:o[n][1]}function JC(e){for(var t=e.length,r=new Array(t);--t>=0;)r[t]=t;return r}function afe(e,t){return e[t]}function lfe(e){const t=[];return t.key=e,t}function cfe(){var e=Tn([]),t=JC,r=Gp,n=afe;function o(l){var h=Array.from(e.apply(this,arguments),lfe),f,s=h.length,y=-1,b;for(const w of l)for(f=0,++y;f<s;++f)(h[f][y]=[0,+n(w,h[f].key,y,l)]).data=w;for(f=0,b=TI(t(h));f<s;++f)h[b[f]].index=f;return r(h,b),h}return o.keys=function(l){return arguments.length?(e=typeof l=="function"?l:Tn(Array.from(l)),o):e},o.value=function(l){return arguments.length?(n=typeof l=="function"?l:Tn(+l),o):n},o.order=function(l){return arguments.length?(t=l==null?JC:typeof l=="function"?l:Tn(Array.from(l)),o):t},o.offset=function(l){return arguments.length?(r=l??Gp,o):r},o}function ufe(e,t){if((n=e.length)>0){for(var r,n,o=0,l=e[0].length,h;o<l;++o){for(h=r=0;r<n;++r)h+=e[r][o][1]||0;if(h)for(r=0;r<n;++r)e[r][o][1]/=h}Gp(e,t)}}function hfe(e,t){if((o=e.length)>0){for(var r=0,n=e[t[0]],o,l=n.length;r<l;++r){for(var h=0,f=0;h<o;++h)f+=e[h][r][1]||0;n[r][1]+=n[r][0]=-f/2}Gp(e,t)}}function dfe(e,t){if(!(!((h=e.length)>0)||!((l=(o=e[t[0]]).length)>0))){for(var r=0,n=1,o,l,h;n<l;++n){for(var f=0,s=0,y=0;f<h;++f){for(var b=e[t[f]],w=b[n][1]||0,A=b[n-1][1]||0,k=(w-A)/2,M=0;M<f;++M){var R=e[t[M]],j=R[n][1]||0,L=R[n-1][1]||0;k+=j-L}s+=w,y+=k*w}o[n-1][1]+=o[n-1][0]=r,s&&(r-=y/s)}o[n-1][1]+=o[n-1][0]=r,Gp(e,t)}}function Hv(e){"@babel/helpers - typeof";return Hv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hv(e)}var ffe=["type","size","sizeType"];function QC(){return QC=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},QC.apply(this,arguments)}function G3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function W3(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?G3(Object(r),!0).forEach(function(n){pfe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):G3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function pfe(e,t,r){return t=mfe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function mfe(e){var t=gfe(e,"string");return Hv(t)=="symbol"?t:t+""}function gfe(e,t){if(Hv(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Hv(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function yfe(e,t){if(e==null)return{};var r=vfe(e,t),n,o;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(o=0;o<l.length;o++)n=l[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function vfe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var TG={symbolCircle:EI,symbolCross:Nde,symbolDiamond:Fde,symbolSquare:Ude,symbolStar:qde,symbolTriangle:Hde,symbolWye:Zde},_fe=Math.PI/180,xfe=function(t){var r="symbol".concat(cS(t));return TG[r]||EI},bfe=function(t,r,n){if(r==="area")return t;switch(n){case"cross":return 5*t*t/9;case"diamond":return .5*t*t/Math.sqrt(3);case"square":return t*t;case"star":{var o=18*_fe;return 1.25*t*t*(Math.tan(o)-Math.tan(o*2)*Math.pow(Math.tan(o),2))}case"triangle":return Math.sqrt(3)*t*t/4;case"wye":return(21-10*Math.sqrt(3))*t*t/8;default:return Math.PI*t*t/4}},wfe=function(t,r){TG["symbol".concat(cS(t))]=r},fS=function(t){var r=t.type,n=r===void 0?"circle":r,o=t.size,l=o===void 0?64:o,h=t.sizeType,f=h===void 0?"area":h,s=yfe(t,ffe),y=W3(W3({},s),{},{type:n,size:l,sizeType:f}),b=function(){var j=xfe(n),L=Xde().type(j).size(bfe(l,f,n));return L()},w=y.className,A=y.cx,k=y.cy,M=Sr(y,!0);return A===+A&&k===+k&&l===+l?Ce.createElement("path",QC({},M,{className:zr("recharts-symbols",w),transform:"translate(".concat(A,", ").concat(k,")"),d:b()})):null};fS.registerSymbol=wfe;function Wp(e){"@babel/helpers - typeof";return Wp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wp(e)}function ek(){return ek=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ek.apply(this,arguments)}function q3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function Sfe(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?q3(Object(r),!0).forEach(function(n){Kv(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):q3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Tfe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Efe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,AG(n.key),n)}}function Afe(e,t,r){return t&&Efe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Pfe(e,t,r){return t=bw(t),Cfe(e,EG()?Reflect.construct(t,r||[],bw(e).constructor):t.apply(e,r))}function Cfe(e,t){if(t&&(Wp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return kfe(e)}function kfe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function EG(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(EG=function(){return!!e})()}function bw(e){return bw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},bw(e)}function Ofe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&tk(e,t)}function tk(e,t){return tk=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},tk(e,t)}function Kv(e,t,r){return t=AG(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function AG(e){var t=Mfe(e,"string");return Wp(t)=="symbol"?t:t+""}function Mfe(e,t){if(Wp(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Wp(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Vs=32,AI=function(e){function t(){return Tfe(this,t),Pfe(this,t,arguments)}return Ofe(t,e),Afe(t,[{key:"renderIcon",value:function(n){var o=this.props.inactiveColor,l=Vs/2,h=Vs/6,f=Vs/3,s=n.inactive?o:n.color;if(n.type==="plainline")return Ce.createElement("line",{strokeWidth:4,fill:"none",stroke:s,strokeDasharray:n.payload.strokeDasharray,x1:0,y1:l,x2:Vs,y2:l,className:"recharts-legend-icon"});if(n.type==="line")return Ce.createElement("path",{strokeWidth:4,fill:"none",stroke:s,d:"M0,".concat(l,"h").concat(f,`
            A`).concat(h,",").concat(h,",0,1,1,").concat(2*f,",").concat(l,`
            H`).concat(Vs,"M").concat(2*f,",").concat(l,`
            A`).concat(h,",").concat(h,",0,1,1,").concat(f,",").concat(l),className:"recharts-legend-icon"});if(n.type==="rect")return Ce.createElement("path",{stroke:"none",fill:s,d:"M0,".concat(Vs/8,"h").concat(Vs,"v").concat(Vs*3/4,"h").concat(-Vs,"z"),className:"recharts-legend-icon"});if(Ce.isValidElement(n.legendIcon)){var y=Sfe({},n);return delete y.legendIcon,Ce.cloneElement(n.legendIcon,y)}return Ce.createElement(fS,{fill:s,cx:l,cy:l,size:Vs,sizeType:"diameter",type:n.type})}},{key:"renderItems",value:function(){var n=this,o=this.props,l=o.payload,h=o.iconSize,f=o.layout,s=o.formatter,y=o.inactiveColor,b={x:0,y:0,width:Vs,height:Vs},w={display:f==="horizontal"?"inline-block":"block",marginRight:10},A={display:"inline-block",verticalAlign:"middle",marginRight:4};return l.map(function(k,M){var R=k.formatter||s,j=zr(Kv(Kv({"recharts-legend-item":!0},"legend-item-".concat(M),!0),"inactive",k.inactive));if(k.type==="none")return null;var L=Ar(k.value)?null:k.value;ac(!Ar(k.value),`The name property is also required when using a function for the dataKey of a chart's cartesian components. Ex: <Bar name="Name of my Data"/>`);var z=k.inactive?y:k.color;return Ce.createElement("li",ek({className:j,style:w,key:"legend-item-".concat(M)},qv(n.props,k,M)),Ce.createElement(WC,{width:h,height:h,viewBox:b,style:A},n.renderIcon(k)),Ce.createElement("span",{className:"recharts-legend-item-text",style:{color:z}},R?R(L,k,M):L))})}},{key:"render",value:function(){var n=this.props,o=n.payload,l=n.layout,h=n.align;if(!o||!o.length)return null;var f={padding:0,margin:0,textAlign:l==="horizontal"?h:"left"};return Ce.createElement("ul",{className:"recharts-default-legend",style:f},this.renderItems())}}])}(re.PureComponent);Kv(AI,"displayName","Legend");Kv(AI,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"middle",inactiveColor:"#ccc"});var Ife=X1;function Rfe(){this.__data__=new Ife,this.size=0}var Dfe=Rfe;function Lfe(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r}var jfe=Lfe;function zfe(e){return this.__data__.get(e)}var Bfe=zfe;function Nfe(e){return this.__data__.has(e)}var $fe=Nfe,Ffe=X1,Ufe=pI,Vfe=mI,Gfe=200;function Wfe(e,t){var r=this.__data__;if(r instanceof Ffe){var n=r.__data__;if(!Ufe||n.length<Gfe-1)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new Vfe(n)}return r.set(e,t),this.size=r.size,this}var qfe=Wfe,Hfe=X1,Kfe=Dfe,Zfe=jfe,Xfe=Bfe,Yfe=$fe,Jfe=qfe;function Dm(e){var t=this.__data__=new Hfe(e);this.size=t.size}Dm.prototype.clear=Kfe;Dm.prototype.delete=Zfe;Dm.prototype.get=Xfe;Dm.prototype.has=Yfe;Dm.prototype.set=Jfe;var PG=Dm,Qfe="__lodash_hash_undefined__";function epe(e){return this.__data__.set(e,Qfe),this}var tpe=epe;function rpe(e){return this.__data__.has(e)}var npe=rpe,ipe=mI,ope=tpe,spe=npe;function ww(e){var t=-1,r=e==null?0:e.length;for(this.__data__=new ipe;++t<r;)this.add(e[t])}ww.prototype.add=ww.prototype.push=ope;ww.prototype.has=spe;var CG=ww;function ape(e,t){for(var r=-1,n=e==null?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1}var kG=ape;function lpe(e,t){return e.has(t)}var OG=lpe,cpe=CG,upe=kG,hpe=OG,dpe=1,fpe=2;function ppe(e,t,r,n,o,l){var h=r&dpe,f=e.length,s=t.length;if(f!=s&&!(h&&s>f))return!1;var y=l.get(e),b=l.get(t);if(y&&b)return y==t&&b==e;var w=-1,A=!0,k=r&fpe?new cpe:void 0;for(l.set(e,t),l.set(t,e);++w<f;){var M=e[w],R=t[w];if(n)var j=h?n(R,M,w,t,e,l):n(M,R,w,e,t,l);if(j!==void 0){if(j)continue;A=!1;break}if(k){if(!upe(t,function(L,z){if(!hpe(k,z)&&(M===L||o(M,L,r,n,l)))return k.push(z)})){A=!1;break}}else if(!(M===R||o(M,R,r,n,l))){A=!1;break}}return l.delete(e),l.delete(t),A}var MG=ppe,mpe=kl,gpe=mpe.Uint8Array,ype=gpe;function vpe(e){var t=-1,r=Array(e.size);return e.forEach(function(n,o){r[++t]=[o,n]}),r}var _pe=vpe;function xpe(e){var t=-1,r=Array(e.size);return e.forEach(function(n){r[++t]=n}),r}var PI=xpe,H3=U_,K3=ype,bpe=fI,wpe=MG,Spe=_pe,Tpe=PI,Epe=1,Ape=2,Ppe="[object Boolean]",Cpe="[object Date]",kpe="[object Error]",Ope="[object Map]",Mpe="[object Number]",Ipe="[object RegExp]",Rpe="[object Set]",Dpe="[object String]",Lpe="[object Symbol]",jpe="[object ArrayBuffer]",zpe="[object DataView]",Z3=H3?H3.prototype:void 0,PA=Z3?Z3.valueOf:void 0;function Bpe(e,t,r,n,o,l,h){switch(r){case zpe:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case jpe:return!(e.byteLength!=t.byteLength||!l(new K3(e),new K3(t)));case Ppe:case Cpe:case Mpe:return bpe(+e,+t);case kpe:return e.name==t.name&&e.message==t.message;case Ipe:case Dpe:return e==t+"";case Ope:var f=Spe;case Rpe:var s=n&Epe;if(f||(f=Tpe),e.size!=t.size&&!s)return!1;var y=h.get(e);if(y)return y==t;n|=Ape,h.set(e,t);var b=wpe(f(e),f(t),n,o,l,h);return h.delete(e),b;case Lpe:if(PA)return PA.call(e)==PA.call(t)}return!1}var Npe=Bpe;function $pe(e,t){for(var r=-1,n=t.length,o=e.length;++r<n;)e[o+r]=t[r];return e}var IG=$pe,Fpe=IG,Upe=ss;function Vpe(e,t,r){var n=t(e);return Upe(e)?n:Fpe(n,r(e))}var Gpe=Vpe;function Wpe(e,t){for(var r=-1,n=e==null?0:e.length,o=0,l=[];++r<n;){var h=e[r];t(h,r,e)&&(l[o++]=h)}return l}var qpe=Wpe;function Hpe(){return[]}var Kpe=Hpe,Zpe=qpe,Xpe=Kpe,Ype=Object.prototype,Jpe=Ype.propertyIsEnumerable,X3=Object.getOwnPropertySymbols,Qpe=X3?function(e){return e==null?[]:(e=Object(e),Zpe(X3(e),function(t){return Jpe.call(e,t)}))}:Xpe,eme=Qpe;function tme(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}var rme=tme,nme=wc,ime=Sc,ome="[object Arguments]";function sme(e){return ime(e)&&nme(e)==ome}var ame=sme,Y3=ame,lme=Sc,RG=Object.prototype,cme=RG.hasOwnProperty,ume=RG.propertyIsEnumerable,hme=Y3(function(){return arguments}())?Y3:function(e){return lme(e)&&cme.call(e,"callee")&&!ume.call(e,"callee")},CI=hme,Sw={exports:{}};function dme(){return!1}var fme=dme;Sw.exports;(function(e,t){var r=kl,n=fme,o=t&&!t.nodeType&&t,l=o&&!0&&e&&!e.nodeType&&e,h=l&&l.exports===o,f=h?r.Buffer:void 0,s=f?f.isBuffer:void 0,y=s||n;e.exports=y})(Sw,Sw.exports);var DG=Sw.exports,pme=9007199254740991,mme=/^(?:0|[1-9]\d*)$/;function gme(e,t){var r=typeof e;return t=t??pme,!!t&&(r=="number"||r!="symbol"&&mme.test(e))&&e>-1&&e%1==0&&e<t}var kI=gme,yme=9007199254740991;function vme(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=yme}var OI=vme,_me=wc,xme=OI,bme=Sc,wme="[object Arguments]",Sme="[object Array]",Tme="[object Boolean]",Eme="[object Date]",Ame="[object Error]",Pme="[object Function]",Cme="[object Map]",kme="[object Number]",Ome="[object Object]",Mme="[object RegExp]",Ime="[object Set]",Rme="[object String]",Dme="[object WeakMap]",Lme="[object ArrayBuffer]",jme="[object DataView]",zme="[object Float32Array]",Bme="[object Float64Array]",Nme="[object Int8Array]",$me="[object Int16Array]",Fme="[object Int32Array]",Ume="[object Uint8Array]",Vme="[object Uint8ClampedArray]",Gme="[object Uint16Array]",Wme="[object Uint32Array]",In={};In[zme]=In[Bme]=In[Nme]=In[$me]=In[Fme]=In[Ume]=In[Vme]=In[Gme]=In[Wme]=!0;In[wme]=In[Sme]=In[Lme]=In[Tme]=In[jme]=In[Eme]=In[Ame]=In[Pme]=In[Cme]=In[kme]=In[Ome]=In[Mme]=In[Ime]=In[Rme]=In[Dme]=!1;function qme(e){return bme(e)&&xme(e.length)&&!!In[_me(e)]}var Hme=qme;function Kme(e){return function(t){return e(t)}}var LG=Kme,Tw={exports:{}};Tw.exports;(function(e,t){var r=U8,n=t&&!t.nodeType&&t,o=n&&!0&&e&&!e.nodeType&&e,l=o&&o.exports===n,h=l&&r.process,f=function(){try{var s=o&&o.require&&o.require("util").types;return s||h&&h.binding&&h.binding("util")}catch{}}();e.exports=f})(Tw,Tw.exports);var Zme=Tw.exports,Xme=Hme,Yme=LG,J3=Zme,Q3=J3&&J3.isTypedArray,Jme=Q3?Yme(Q3):Xme,jG=Jme,Qme=rme,ege=CI,tge=ss,rge=DG,nge=kI,ige=jG,oge=Object.prototype,sge=oge.hasOwnProperty;function age(e,t){var r=tge(e),n=!r&&ege(e),o=!r&&!n&&rge(e),l=!r&&!n&&!o&&ige(e),h=r||n||o||l,f=h?Qme(e.length,String):[],s=f.length;for(var y in e)(t||sge.call(e,y))&&!(h&&(y=="length"||o&&(y=="offset"||y=="parent")||l&&(y=="buffer"||y=="byteLength"||y=="byteOffset")||nge(y,s)))&&f.push(y);return f}var lge=age,cge=Object.prototype;function uge(e){var t=e&&e.constructor,r=typeof t=="function"&&t.prototype||cge;return e===r}var hge=uge;function dge(e,t){return function(r){return e(t(r))}}var zG=dge,fge=zG,pge=fge(Object.keys,Object),mge=pge,gge=hge,yge=mge,vge=Object.prototype,_ge=vge.hasOwnProperty;function xge(e){if(!gge(e))return yge(e);var t=[];for(var r in Object(e))_ge.call(e,r)&&r!="constructor"&&t.push(r);return t}var bge=xge,wge=dI,Sge=OI;function Tge(e){return e!=null&&Sge(e.length)&&!wge(e)}var V_=Tge,Ege=lge,Age=bge,Pge=V_;function Cge(e){return Pge(e)?Ege(e):Age(e)}var pS=Cge,kge=Gpe,Oge=eme,Mge=pS;function Ige(e){return kge(e,Mge,Oge)}var Rge=Ige,eN=Rge,Dge=1,Lge=Object.prototype,jge=Lge.hasOwnProperty;function zge(e,t,r,n,o,l){var h=r&Dge,f=eN(e),s=f.length,y=eN(t),b=y.length;if(s!=b&&!h)return!1;for(var w=s;w--;){var A=f[w];if(!(h?A in t:jge.call(t,A)))return!1}var k=l.get(e),M=l.get(t);if(k&&M)return k==t&&M==e;var R=!0;l.set(e,t),l.set(t,e);for(var j=h;++w<s;){A=f[w];var L=e[A],z=t[A];if(n)var B=h?n(z,L,A,t,e,l):n(L,z,A,e,t,l);if(!(B===void 0?L===z||o(L,z,r,n,l):B)){R=!1;break}j||(j=A=="constructor")}if(R&&!j){var Z=e.constructor,F=t.constructor;Z!=F&&"constructor"in e&&"constructor"in t&&!(typeof Z=="function"&&Z instanceof Z&&typeof F=="function"&&F instanceof F)&&(R=!1)}return l.delete(e),l.delete(t),R}var Bge=zge,Nge=Od,$ge=kl,Fge=Nge($ge,"DataView"),Uge=Fge,Vge=Od,Gge=kl,Wge=Vge(Gge,"Promise"),qge=Wge,Hge=Od,Kge=kl,Zge=Hge(Kge,"Set"),BG=Zge,Xge=Od,Yge=kl,Jge=Xge(Yge,"WeakMap"),Qge=Jge,rk=Uge,nk=pI,ik=qge,ok=BG,sk=Qge,NG=wc,Lm=G8,tN="[object Map]",eye="[object Object]",rN="[object Promise]",nN="[object Set]",iN="[object WeakMap]",oN="[object DataView]",tye=Lm(rk),rye=Lm(nk),nye=Lm(ik),iye=Lm(ok),oye=Lm(sk),Gh=NG;(rk&&Gh(new rk(new ArrayBuffer(1)))!=oN||nk&&Gh(new nk)!=tN||ik&&Gh(ik.resolve())!=rN||ok&&Gh(new ok)!=nN||sk&&Gh(new sk)!=iN)&&(Gh=function(e){var t=NG(e),r=t==eye?e.constructor:void 0,n=r?Lm(r):"";if(n)switch(n){case tye:return oN;case rye:return tN;case nye:return rN;case iye:return nN;case oye:return iN}return t});var sye=Gh,CA=PG,aye=MG,lye=Npe,cye=Bge,sN=sye,aN=ss,lN=DG,uye=jG,hye=1,cN="[object Arguments]",uN="[object Array]",qx="[object Object]",dye=Object.prototype,hN=dye.hasOwnProperty;function fye(e,t,r,n,o,l){var h=aN(e),f=aN(t),s=h?uN:sN(e),y=f?uN:sN(t);s=s==cN?qx:s,y=y==cN?qx:y;var b=s==qx,w=y==qx,A=s==y;if(A&&lN(e)){if(!lN(t))return!1;h=!0,b=!1}if(A&&!b)return l||(l=new CA),h||uye(e)?aye(e,t,r,n,o,l):lye(e,t,s,r,n,o,l);if(!(r&hye)){var k=b&&hN.call(e,"__wrapped__"),M=w&&hN.call(t,"__wrapped__");if(k||M){var R=k?e.value():e,j=M?t.value():t;return l||(l=new CA),o(R,j,r,n,l)}}return A?(l||(l=new CA),cye(e,t,r,n,o,l)):!1}var pye=fye,mye=pye,dN=Sc;function $G(e,t,r,n,o){return e===t?!0:e==null||t==null||!dN(e)&&!dN(t)?e!==e&&t!==t:mye(e,t,r,n,$G,o)}var MI=$G,gye=PG,yye=MI,vye=1,_ye=2;function xye(e,t,r,n){var o=r.length,l=o,h=!n;if(e==null)return!l;for(e=Object(e);o--;){var f=r[o];if(h&&f[2]?f[1]!==e[f[0]]:!(f[0]in e))return!1}for(;++o<l;){f=r[o];var s=f[0],y=e[s],b=f[1];if(h&&f[2]){if(y===void 0&&!(s in e))return!1}else{var w=new gye;if(n)var A=n(y,b,s,e,t,w);if(!(A===void 0?yye(b,y,vye|_ye,n,w):A))return!1}}return!0}var bye=xye,wye=Gu;function Sye(e){return e===e&&!wye(e)}var FG=Sye,Tye=FG,Eye=pS;function Aye(e){for(var t=Eye(e),r=t.length;r--;){var n=t[r],o=e[n];t[r]=[n,o,Tye(o)]}return t}var Pye=Aye;function Cye(e,t){return function(r){return r==null?!1:r[e]===t&&(t!==void 0||e in Object(r))}}var UG=Cye,kye=bye,Oye=Pye,Mye=UG;function Iye(e){var t=Oye(e);return t.length==1&&t[0][2]?Mye(t[0][0],t[0][1]):function(r){return r===e||kye(r,e,t)}}var Rye=Iye;function Dye(e,t){return e!=null&&t in Object(e)}var Lye=Dye,jye=Z8,zye=CI,Bye=ss,Nye=kI,$ye=OI,Fye=J1;function Uye(e,t,r){t=jye(t,e);for(var n=-1,o=t.length,l=!1;++n<o;){var h=Fye(t[n]);if(!(l=e!=null&&r(e,h)))break;e=e[h]}return l||++n!=o?l:(o=e==null?0:e.length,!!o&&$ye(o)&&Nye(h,o)&&(Bye(e)||zye(e)))}var Vye=Uye,Gye=Lye,Wye=Vye;function qye(e,t){return e!=null&&Wye(e,t,Gye)}var Hye=qye,Kye=MI,Zye=X8,Xye=Hye,Yye=hI,Jye=FG,Qye=UG,eve=J1,tve=1,rve=2;function nve(e,t){return Yye(e)&&Jye(t)?Qye(eve(e),t):function(r){var n=Zye(r,e);return n===void 0&&n===t?Xye(r,e):Kye(t,n,tve|rve)}}var ive=nve;function ove(e){return e}var jm=ove;function sve(e){return function(t){return t==null?void 0:t[e]}}var ave=sve,lve=vI;function cve(e){return function(t){return lve(t,e)}}var uve=cve,hve=ave,dve=uve,fve=hI,pve=J1;function mve(e){return fve(e)?hve(pve(e)):dve(e)}var gve=mve,yve=Rye,vve=ive,_ve=jm,xve=ss,bve=gve;function wve(e){return typeof e=="function"?e:e==null?_ve:typeof e=="object"?xve(e)?vve(e[0],e[1]):yve(e):bve(e)}var Wu=wve;function Sve(e,t,r,n){for(var o=e.length,l=r+(n?1:-1);n?l--:++l<o;)if(t(e[l],l,e))return l;return-1}var VG=Sve;function Tve(e){return e!==e}var Eve=Tve;function Ave(e,t,r){for(var n=r-1,o=e.length;++n<o;)if(e[n]===t)return n;return-1}var Pve=Ave,Cve=VG,kve=Eve,Ove=Pve;function Mve(e,t,r){return t===t?Ove(e,t,r):Cve(e,kve,r)}var Ive=Mve,Rve=Ive;function Dve(e,t){var r=e==null?0:e.length;return!!r&&Rve(e,t,0)>-1}var Lve=Dve;function jve(e,t,r){for(var n=-1,o=e==null?0:e.length;++n<o;)if(r(t,e[n]))return!0;return!1}var zve=jve;function Bve(){}var Nve=Bve,kA=BG,$ve=Nve,Fve=PI,Uve=1/0,Vve=kA&&1/Fve(new kA([,-0]))[1]==Uve?function(e){return new kA(e)}:$ve,Gve=Vve,Wve=CG,qve=Lve,Hve=zve,Kve=OG,Zve=Gve,Xve=PI,Yve=200;function Jve(e,t,r){var n=-1,o=qve,l=e.length,h=!0,f=[],s=f;if(r)h=!1,o=Hve;else if(l>=Yve){var y=t?null:Zve(e);if(y)return Xve(y);h=!1,o=Kve,s=new Wve}else s=t?[]:f;e:for(;++n<l;){var b=e[n],w=t?t(b):b;if(b=r||b!==0?b:0,h&&w===w){for(var A=s.length;A--;)if(s[A]===w)continue e;t&&s.push(w),f.push(b)}else o(s,w,r)||(s!==f&&s.push(w),f.push(b))}return f}var Qve=Jve,e_e=Wu,t_e=Qve;function r_e(e,t){return e&&e.length?t_e(e,e_e(t)):[]}var n_e=r_e;const fN=mn(n_e);function GG(e,t,r){return t===!0?fN(e,r):Ar(t)?fN(e,t):e}function qp(e){"@babel/helpers - typeof";return qp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qp(e)}var i_e=["ref"];function pN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function Zl(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?pN(Object(r),!0).forEach(function(n){mS(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):pN(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function o_e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function mN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,qG(n.key),n)}}function s_e(e,t,r){return t&&mN(e.prototype,t),r&&mN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function a_e(e,t,r){return t=Ew(t),l_e(e,WG()?Reflect.construct(t,r||[],Ew(e).constructor):t.apply(e,r))}function l_e(e,t){if(t&&(qp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return c_e(e)}function c_e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function WG(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(WG=function(){return!!e})()}function Ew(e){return Ew=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ew(e)}function u_e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ak(e,t)}function ak(e,t){return ak=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},ak(e,t)}function mS(e,t,r){return t=qG(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function qG(e){var t=h_e(e,"string");return qp(t)=="symbol"?t:t+""}function h_e(e,t){if(qp(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(qp(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function d_e(e,t){if(e==null)return{};var r=f_e(e,t),n,o;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(o=0;o<l.length;o++)n=l[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function f_e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function p_e(e){return e.value}function m_e(e,t){if(Ce.isValidElement(e))return Ce.cloneElement(e,t);if(typeof e=="function")return Ce.createElement(e,t);t.ref;var r=d_e(t,i_e);return Ce.createElement(AI,r)}var gN=1,hd=function(e){function t(){var r;o_e(this,t);for(var n=arguments.length,o=new Array(n),l=0;l<n;l++)o[l]=arguments[l];return r=a_e(this,t,[].concat(o)),mS(r,"lastBoundingBox",{width:-1,height:-1}),r}return u_e(t,e),s_e(t,[{key:"componentDidMount",value:function(){this.updateBBox()}},{key:"componentDidUpdate",value:function(){this.updateBBox()}},{key:"getBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var n=this.wrapperNode.getBoundingClientRect();return n.height=this.wrapperNode.offsetHeight,n.width=this.wrapperNode.offsetWidth,n}return null}},{key:"updateBBox",value:function(){var n=this.props.onBBoxUpdate,o=this.getBBox();o?(Math.abs(o.width-this.lastBoundingBox.width)>gN||Math.abs(o.height-this.lastBoundingBox.height)>gN)&&(this.lastBoundingBox.width=o.width,this.lastBoundingBox.height=o.height,n&&n(o)):(this.lastBoundingBox.width!==-1||this.lastBoundingBox.height!==-1)&&(this.lastBoundingBox.width=-1,this.lastBoundingBox.height=-1,n&&n(null))}},{key:"getBBoxSnapshot",value:function(){return this.lastBoundingBox.width>=0&&this.lastBoundingBox.height>=0?Zl({},this.lastBoundingBox):{width:0,height:0}}},{key:"getDefaultPosition",value:function(n){var o=this.props,l=o.layout,h=o.align,f=o.verticalAlign,s=o.margin,y=o.chartWidth,b=o.chartHeight,w,A;if(!n||(n.left===void 0||n.left===null)&&(n.right===void 0||n.right===null))if(h==="center"&&l==="vertical"){var k=this.getBBoxSnapshot();w={left:((y||0)-k.width)/2}}else w=h==="right"?{right:s&&s.right||0}:{left:s&&s.left||0};if(!n||(n.top===void 0||n.top===null)&&(n.bottom===void 0||n.bottom===null))if(f==="middle"){var M=this.getBBoxSnapshot();A={top:((b||0)-M.height)/2}}else A=f==="bottom"?{bottom:s&&s.bottom||0}:{top:s&&s.top||0};return Zl(Zl({},w),A)}},{key:"render",value:function(){var n=this,o=this.props,l=o.content,h=o.width,f=o.height,s=o.wrapperStyle,y=o.payloadUniqBy,b=o.payload,w=Zl(Zl({position:"absolute",width:h||"auto",height:f||"auto"},this.getDefaultPosition(s)),s);return Ce.createElement("div",{className:"recharts-legend-wrapper",style:w,ref:function(k){n.wrapperNode=k}},m_e(l,Zl(Zl({},this.props),{},{payload:GG(b,y,p_e)})))}}],[{key:"getWithHeight",value:function(n,o){var l=Zl(Zl({},this.defaultProps),n.props),h=l.layout;return h==="vertical"&&It(n.props.height)?{height:n.props.height}:h==="horizontal"?{width:n.props.width||o}:null}}])}(re.PureComponent);mS(hd,"displayName","Legend");mS(hd,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"bottom"});var yN=U_,g_e=CI,y_e=ss,vN=yN?yN.isConcatSpreadable:void 0;function v_e(e){return y_e(e)||g_e(e)||!!(vN&&e&&e[vN])}var __e=v_e,x_e=IG,b_e=__e;function HG(e,t,r,n,o){var l=-1,h=e.length;for(r||(r=b_e),o||(o=[]);++l<h;){var f=e[l];t>0&&r(f)?t>1?HG(f,t-1,r,n,o):x_e(o,f):n||(o[o.length]=f)}return o}var KG=HG;function w_e(e){return function(t,r,n){for(var o=-1,l=Object(t),h=n(t),f=h.length;f--;){var s=h[e?f:++o];if(r(l[s],s,l)===!1)break}return t}}var S_e=w_e,T_e=S_e,E_e=T_e(),A_e=E_e,P_e=A_e,C_e=pS;function k_e(e,t){return e&&P_e(e,t,C_e)}var ZG=k_e,O_e=V_;function M_e(e,t){return function(r,n){if(r==null)return r;if(!O_e(r))return e(r,n);for(var o=r.length,l=t?o:-1,h=Object(r);(t?l--:++l<o)&&n(h[l],l,h)!==!1;);return r}}var I_e=M_e,R_e=ZG,D_e=I_e,L_e=D_e(R_e),II=L_e,j_e=II,z_e=V_;function B_e(e,t){var r=-1,n=z_e(e)?Array(e.length):[];return j_e(e,function(o,l,h){n[++r]=t(o,l,h)}),n}var XG=B_e;function N_e(e,t){var r=e.length;for(e.sort(t);r--;)e[r]=e[r].value;return e}var $_e=N_e,_N=Cm;function F_e(e,t){if(e!==t){var r=e!==void 0,n=e===null,o=e===e,l=_N(e),h=t!==void 0,f=t===null,s=t===t,y=_N(t);if(!f&&!y&&!l&&e>t||l&&h&&s&&!f&&!y||n&&h&&s||!r&&s||!o)return 1;if(!n&&!l&&!y&&e<t||y&&r&&o&&!n&&!l||f&&r&&o||!h&&o||!s)return-1}return 0}var U_e=F_e,V_e=U_e;function G_e(e,t,r){for(var n=-1,o=e.criteria,l=t.criteria,h=o.length,f=r.length;++n<h;){var s=V_e(o[n],l[n]);if(s){if(n>=f)return s;var y=r[n];return s*(y=="desc"?-1:1)}}return e.index-t.index}var W_e=G_e,OA=yI,q_e=vI,H_e=Wu,K_e=XG,Z_e=$_e,X_e=LG,Y_e=W_e,J_e=jm,Q_e=ss;function e0e(e,t,r){t.length?t=OA(t,function(l){return Q_e(l)?function(h){return q_e(h,l.length===1?l[0]:l)}:l}):t=[J_e];var n=-1;t=OA(t,X_e(H_e));var o=K_e(e,function(l,h,f){var s=OA(t,function(y){return y(l)});return{criteria:s,index:++n,value:l}});return Z_e(o,function(l,h){return Y_e(l,h,r)})}var t0e=e0e;function r0e(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}var n0e=r0e,i0e=n0e,xN=Math.max;function o0e(e,t,r){return t=xN(t===void 0?e.length-1:t,0),function(){for(var n=arguments,o=-1,l=xN(n.length-t,0),h=Array(l);++o<l;)h[o]=n[t+o];o=-1;for(var f=Array(t+1);++o<t;)f[o]=n[o];return f[t]=r(h),i0e(e,this,f)}}var s0e=o0e;function a0e(e){return function(){return e}}var l0e=a0e,c0e=Od,u0e=function(){try{var e=c0e(Object,"defineProperty");return e({},"",{}),e}catch{}}(),YG=u0e,h0e=l0e,bN=YG,d0e=jm,f0e=bN?function(e,t){return bN(e,"toString",{configurable:!0,enumerable:!1,value:h0e(t),writable:!0})}:d0e,p0e=f0e,m0e=800,g0e=16,y0e=Date.now;function v0e(e){var t=0,r=0;return function(){var n=y0e(),o=g0e-(n-r);if(r=n,o>0){if(++t>=m0e)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}var _0e=v0e,x0e=p0e,b0e=_0e,w0e=b0e(x0e),S0e=w0e,T0e=jm,E0e=s0e,A0e=S0e;function P0e(e,t){return A0e(E0e(e,t,T0e),e+"")}var C0e=P0e,k0e=fI,O0e=V_,M0e=kI,I0e=Gu;function R0e(e,t,r){if(!I0e(r))return!1;var n=typeof t;return(n=="number"?O0e(r)&&M0e(t,r.length):n=="string"&&t in r)?k0e(r[t],e):!1}var gS=R0e,D0e=KG,L0e=t0e,j0e=C0e,wN=gS,z0e=j0e(function(e,t){if(e==null)return[];var r=t.length;return r>1&&wN(e,t[0],t[1])?t=[]:r>2&&wN(t[0],t[1],t[2])&&(t=[t[0]]),L0e(e,D0e(t,1),[])}),B0e=z0e;const RI=mn(B0e);function Zv(e){"@babel/helpers - typeof";return Zv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zv(e)}function lk(){return lk=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},lk.apply(this,arguments)}function N0e(e,t){return V0e(e)||U0e(e,t)||F0e(e,t)||$0e()}function $0e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function F0e(e,t){if(e){if(typeof e=="string")return SN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return SN(e,t)}}function SN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function U0e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,l,h,f=[],s=!0,y=!1;try{if(l=(r=r.call(e)).next,t!==0)for(;!(s=(n=l.call(r)).done)&&(f.push(n.value),f.length!==t);s=!0);}catch(b){y=!0,o=b}finally{try{if(!s&&r.return!=null&&(h=r.return(),Object(h)!==h))return}finally{if(y)throw o}}return f}}function V0e(e){if(Array.isArray(e))return e}function TN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function MA(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?TN(Object(r),!0).forEach(function(n){G0e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):TN(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function G0e(e,t,r){return t=W0e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function W0e(e){var t=q0e(e,"string");return Zv(t)=="symbol"?t:t+""}function q0e(e,t){if(Zv(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Zv(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function H0e(e){return Array.isArray(e)&&Di(e[0])&&Di(e[1])?e.join(" ~ "):e}var K0e=function(t){var r=t.separator,n=r===void 0?" : ":r,o=t.contentStyle,l=o===void 0?{}:o,h=t.itemStyle,f=h===void 0?{}:h,s=t.labelStyle,y=s===void 0?{}:s,b=t.payload,w=t.formatter,A=t.itemSorter,k=t.wrapperClassName,M=t.labelClassName,R=t.label,j=t.labelFormatter,L=t.accessibilityLayer,z=L===void 0?!1:L,B=function(){if(b&&b.length){var Oe={padding:0,margin:0},je=(A?RI(b,A):b).map(function(Ge,Ze){if(Ge.type==="none")return null;var Ye=MA({display:"block",paddingTop:4,paddingBottom:4,color:Ge.color||"#000"},f),tt=Ge.formatter||w||H0e,ze=Ge.value,De=Ge.name,ut=ze,ht=De;if(tt&&ut!=null&&ht!=null){var at=tt(ze,De,Ge,Ze,b);if(Array.isArray(at)){var Lt=N0e(at,2);ut=Lt[0],ht=Lt[1]}else ut=at}return Ce.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(Ze),style:Ye},Di(ht)?Ce.createElement("span",{className:"recharts-tooltip-item-name"},ht):null,Di(ht)?Ce.createElement("span",{className:"recharts-tooltip-item-separator"},n):null,Ce.createElement("span",{className:"recharts-tooltip-item-value"},ut),Ce.createElement("span",{className:"recharts-tooltip-item-unit"},Ge.unit||""))});return Ce.createElement("ul",{className:"recharts-tooltip-item-list",style:Oe},je)}return null},Z=MA({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},l),F=MA({margin:0},y),H=!wr(R),Y=H?R:"",te=zr("recharts-default-tooltip",k),pe=zr("recharts-tooltip-label",M);H&&j&&b!==void 0&&b!==null&&(Y=j(R,b));var ue=z?{role:"status","aria-live":"assertive"}:{};return Ce.createElement("div",lk({className:te,style:Z},ue),Ce.createElement("p",{className:pe,style:F},Ce.isValidElement(Y)?Y:"".concat(Y)),B())};function Xv(e){"@babel/helpers - typeof";return Xv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xv(e)}function Hx(e,t,r){return t=Z0e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Z0e(e){var t=X0e(e,"string");return Xv(t)=="symbol"?t:t+""}function X0e(e,t){if(Xv(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Xv(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Cy="recharts-tooltip-wrapper",Y0e={visibility:"hidden"};function J0e(e){var t=e.coordinate,r=e.translateX,n=e.translateY;return zr(Cy,Hx(Hx(Hx(Hx({},"".concat(Cy,"-right"),It(r)&&t&&It(t.x)&&r>=t.x),"".concat(Cy,"-left"),It(r)&&t&&It(t.x)&&r<t.x),"".concat(Cy,"-bottom"),It(n)&&t&&It(t.y)&&n>=t.y),"".concat(Cy,"-top"),It(n)&&t&&It(t.y)&&n<t.y))}function EN(e){var t=e.allowEscapeViewBox,r=e.coordinate,n=e.key,o=e.offsetTopLeft,l=e.position,h=e.reverseDirection,f=e.tooltipDimension,s=e.viewBox,y=e.viewBoxDimension;if(l&&It(l[n]))return l[n];var b=r[n]-f-o,w=r[n]+o;if(t[n])return h[n]?b:w;if(h[n]){var A=b,k=s[n];return A<k?Math.max(w,s[n]):Math.max(b,s[n])}var M=w+f,R=s[n]+y;return M>R?Math.max(b,s[n]):Math.max(w,s[n])}function Q0e(e){var t=e.translateX,r=e.translateY,n=e.useTranslate3d;return{transform:n?"translate3d(".concat(t,"px, ").concat(r,"px, 0)"):"translate(".concat(t,"px, ").concat(r,"px)")}}function exe(e){var t=e.allowEscapeViewBox,r=e.coordinate,n=e.offsetTopLeft,o=e.position,l=e.reverseDirection,h=e.tooltipBox,f=e.useTranslate3d,s=e.viewBox,y,b,w;return h.height>0&&h.width>0&&r?(b=EN({allowEscapeViewBox:t,coordinate:r,key:"x",offsetTopLeft:n,position:o,reverseDirection:l,tooltipDimension:h.width,viewBox:s,viewBoxDimension:s.width}),w=EN({allowEscapeViewBox:t,coordinate:r,key:"y",offsetTopLeft:n,position:o,reverseDirection:l,tooltipDimension:h.height,viewBox:s,viewBoxDimension:s.height}),y=Q0e({translateX:b,translateY:w,useTranslate3d:f})):y=Y0e,{cssProperties:y,cssClasses:J0e({translateX:b,translateY:w,coordinate:r})}}function Hp(e){"@babel/helpers - typeof";return Hp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hp(e)}function AN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function PN(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?AN(Object(r),!0).forEach(function(n){uk(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):AN(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function txe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function rxe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,QG(n.key),n)}}function nxe(e,t,r){return t&&rxe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function ixe(e,t,r){return t=Aw(t),oxe(e,JG()?Reflect.construct(t,r||[],Aw(e).constructor):t.apply(e,r))}function oxe(e,t){if(t&&(Hp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return sxe(e)}function sxe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function JG(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(JG=function(){return!!e})()}function Aw(e){return Aw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Aw(e)}function axe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ck(e,t)}function ck(e,t){return ck=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},ck(e,t)}function uk(e,t,r){return t=QG(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function QG(e){var t=lxe(e,"string");return Hp(t)=="symbol"?t:t+""}function lxe(e,t){if(Hp(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Hp(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var CN=1,cxe=function(e){function t(){var r;txe(this,t);for(var n=arguments.length,o=new Array(n),l=0;l<n;l++)o[l]=arguments[l];return r=ixe(this,t,[].concat(o)),uk(r,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0},lastBoundingBox:{width:-1,height:-1}}),uk(r,"handleKeyDown",function(h){if(h.key==="Escape"){var f,s,y,b;r.setState({dismissed:!0,dismissedAtCoordinate:{x:(f=(s=r.props.coordinate)===null||s===void 0?void 0:s.x)!==null&&f!==void 0?f:0,y:(y=(b=r.props.coordinate)===null||b===void 0?void 0:b.y)!==null&&y!==void 0?y:0}})}}),r}return axe(t,e),nxe(t,[{key:"updateBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var n=this.wrapperNode.getBoundingClientRect();(Math.abs(n.width-this.state.lastBoundingBox.width)>CN||Math.abs(n.height-this.state.lastBoundingBox.height)>CN)&&this.setState({lastBoundingBox:{width:n.width,height:n.height}})}else(this.state.lastBoundingBox.width!==-1||this.state.lastBoundingBox.height!==-1)&&this.setState({lastBoundingBox:{width:-1,height:-1}})}},{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleKeyDown),this.updateBBox()}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeyDown)}},{key:"componentDidUpdate",value:function(){var n,o;this.props.active&&this.updateBBox(),this.state.dismissed&&(((n=this.props.coordinate)===null||n===void 0?void 0:n.x)!==this.state.dismissedAtCoordinate.x||((o=this.props.coordinate)===null||o===void 0?void 0:o.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}},{key:"render",value:function(){var n=this,o=this.props,l=o.active,h=o.allowEscapeViewBox,f=o.animationDuration,s=o.animationEasing,y=o.children,b=o.coordinate,w=o.hasPayload,A=o.isAnimationActive,k=o.offset,M=o.position,R=o.reverseDirection,j=o.useTranslate3d,L=o.viewBox,z=o.wrapperStyle,B=exe({allowEscapeViewBox:h,coordinate:b,offsetTopLeft:k,position:M,reverseDirection:R,tooltipBox:this.state.lastBoundingBox,useTranslate3d:j,viewBox:L}),Z=B.cssClasses,F=B.cssProperties,H=PN(PN({transition:A&&l?"transform ".concat(f,"ms ").concat(s):void 0},F),{},{pointerEvents:"none",visibility:!this.state.dismissed&&l&&w?"visible":"hidden",position:"absolute",top:0,left:0},z);return Ce.createElement("div",{tabIndex:-1,className:Z,style:H,ref:function(te){n.wrapperNode=te}},y)}}])}(re.PureComponent),uxe=function(){return!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout)},qu={isSsr:uxe()};function Kp(e){"@babel/helpers - typeof";return Kp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Kp(e)}function kN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function ON(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?kN(Object(r),!0).forEach(function(n){DI(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):kN(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function hxe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function dxe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,tW(n.key),n)}}function fxe(e,t,r){return t&&dxe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function pxe(e,t,r){return t=Pw(t),mxe(e,eW()?Reflect.construct(t,r||[],Pw(e).constructor):t.apply(e,r))}function mxe(e,t){if(t&&(Kp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return gxe(e)}function gxe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function eW(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(eW=function(){return!!e})()}function Pw(e){return Pw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Pw(e)}function yxe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&hk(e,t)}function hk(e,t){return hk=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},hk(e,t)}function DI(e,t,r){return t=tW(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function tW(e){var t=vxe(e,"string");return Kp(t)=="symbol"?t:t+""}function vxe(e,t){if(Kp(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Kp(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _xe(e){return e.dataKey}function xxe(e,t){return Ce.isValidElement(e)?Ce.cloneElement(e,t):typeof e=="function"?Ce.createElement(e,t):Ce.createElement(K0e,t)}var ws=function(e){function t(){return hxe(this,t),pxe(this,t,arguments)}return yxe(t,e),fxe(t,[{key:"render",value:function(){var n=this,o=this.props,l=o.active,h=o.allowEscapeViewBox,f=o.animationDuration,s=o.animationEasing,y=o.content,b=o.coordinate,w=o.filterNull,A=o.isAnimationActive,k=o.offset,M=o.payload,R=o.payloadUniqBy,j=o.position,L=o.reverseDirection,z=o.useTranslate3d,B=o.viewBox,Z=o.wrapperStyle,F=M??[];w&&F.length&&(F=GG(M.filter(function(Y){return Y.value!=null&&(Y.hide!==!0||n.props.includeHidden)}),R,_xe));var H=F.length>0;return Ce.createElement(cxe,{allowEscapeViewBox:h,animationDuration:f,animationEasing:s,isAnimationActive:A,active:l,coordinate:b,hasPayload:H,offset:k,position:j,reverseDirection:L,useTranslate3d:z,viewBox:B,wrapperStyle:Z},xxe(y,ON(ON({},this.props),{},{payload:F})))}}])}(re.PureComponent);DI(ws,"displayName","Tooltip");DI(ws,"defaultProps",{accessibilityLayer:!1,allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",contentStyle:{},coordinate:{x:0,y:0},cursor:!0,cursorStyle:{},filterNull:!0,isAnimationActive:!qu.isSsr,itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,viewBox:{x:0,y:0,height:0,width:0},wrapperStyle:{}});var bxe=kl,wxe=function(){return bxe.Date.now()},Sxe=wxe,Txe=/\s/;function Exe(e){for(var t=e.length;t--&&Txe.test(e.charAt(t)););return t}var Axe=Exe,Pxe=Axe,Cxe=/^\s+/;function kxe(e){return e&&e.slice(0,Pxe(e)+1).replace(Cxe,"")}var Oxe=kxe,Mxe=Oxe,MN=Gu,Ixe=Cm,IN=NaN,Rxe=/^[-+]0x[0-9a-f]+$/i,Dxe=/^0b[01]+$/i,Lxe=/^0o[0-7]+$/i,jxe=parseInt;function zxe(e){if(typeof e=="number")return e;if(Ixe(e))return IN;if(MN(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=MN(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=Mxe(e);var r=Dxe.test(e);return r||Lxe.test(e)?jxe(e.slice(2),r?2:8):Rxe.test(e)?IN:+e}var rW=zxe,Bxe=Gu,IA=Sxe,RN=rW,Nxe="Expected a function",$xe=Math.max,Fxe=Math.min;function Uxe(e,t,r){var n,o,l,h,f,s,y=0,b=!1,w=!1,A=!0;if(typeof e!="function")throw new TypeError(Nxe);t=RN(t)||0,Bxe(r)&&(b=!!r.leading,w="maxWait"in r,l=w?$xe(RN(r.maxWait)||0,t):l,A="trailing"in r?!!r.trailing:A);function k(H){var Y=n,te=o;return n=o=void 0,y=H,h=e.apply(te,Y),h}function M(H){return y=H,f=setTimeout(L,t),b?k(H):h}function R(H){var Y=H-s,te=H-y,pe=t-Y;return w?Fxe(pe,l-te):pe}function j(H){var Y=H-s,te=H-y;return s===void 0||Y>=t||Y<0||w&&te>=l}function L(){var H=IA();if(j(H))return z(H);f=setTimeout(L,R(H))}function z(H){return f=void 0,A&&n?k(H):(n=o=void 0,h)}function B(){f!==void 0&&clearTimeout(f),y=0,n=s=o=f=void 0}function Z(){return f===void 0?h:z(IA())}function F(){var H=IA(),Y=j(H);if(n=arguments,o=this,s=H,Y){if(f===void 0)return M(s);if(w)return clearTimeout(f),f=setTimeout(L,t),k(s)}return f===void 0&&(f=setTimeout(L,t)),h}return F.cancel=B,F.flush=Z,F}var Vxe=Uxe,Gxe=Vxe,Wxe=Gu,qxe="Expected a function";function Hxe(e,t,r){var n=!0,o=!0;if(typeof e!="function")throw new TypeError(qxe);return Wxe(r)&&(n="leading"in r?!!r.leading:n,o="trailing"in r?!!r.trailing:o),Gxe(e,t,{leading:n,maxWait:t,trailing:o})}var Kxe=Hxe;const nW=mn(Kxe);function Yv(e){"@babel/helpers - typeof";return Yv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Yv(e)}function DN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function Kx(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?DN(Object(r),!0).forEach(function(n){Zxe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):DN(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Zxe(e,t,r){return t=Xxe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Xxe(e){var t=Yxe(e,"string");return Yv(t)=="symbol"?t:t+""}function Yxe(e,t){if(Yv(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Yv(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Jxe(e,t){return rbe(e)||tbe(e,t)||ebe(e,t)||Qxe()}function Qxe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ebe(e,t){if(e){if(typeof e=="string")return LN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return LN(e,t)}}function LN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function tbe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,l,h,f=[],s=!0,y=!1;try{if(l=(r=r.call(e)).next,t!==0)for(;!(s=(n=l.call(r)).done)&&(f.push(n.value),f.length!==t);s=!0);}catch(b){y=!0,o=b}finally{try{if(!s&&r.return!=null&&(h=r.return(),Object(h)!==h))return}finally{if(y)throw o}}return f}}function rbe(e){if(Array.isArray(e))return e}var Cb=re.forwardRef(function(e,t){var r=e.aspect,n=e.initialDimension,o=n===void 0?{width:-1,height:-1}:n,l=e.width,h=l===void 0?"100%":l,f=e.height,s=f===void 0?"100%":f,y=e.minWidth,b=y===void 0?0:y,w=e.minHeight,A=e.maxHeight,k=e.children,M=e.debounce,R=M===void 0?0:M,j=e.id,L=e.className,z=e.onResize,B=e.style,Z=B===void 0?{}:B,F=re.useRef(null),H=re.useRef();H.current=z,re.useImperativeHandle(t,function(){return Object.defineProperty(F.current,"current",{get:function(){return console.warn("The usage of ref.current.current is deprecated and will no longer be supported."),F.current},configurable:!0})});var Y=re.useState({containerWidth:o.width,containerHeight:o.height}),te=Jxe(Y,2),pe=te[0],ue=te[1],Ee=re.useCallback(function(je,Ge){ue(function(Ze){var Ye=Math.round(je),tt=Math.round(Ge);return Ze.containerWidth===Ye&&Ze.containerHeight===tt?Ze:{containerWidth:Ye,containerHeight:tt}})},[]);re.useEffect(function(){var je=function(De){var ut,ht=De[0].contentRect,at=ht.width,Lt=ht.height;Ee(at,Lt),(ut=H.current)===null||ut===void 0||ut.call(H,at,Lt)};R>0&&(je=nW(je,R,{trailing:!0,leading:!1}));var Ge=new ResizeObserver(je),Ze=F.current.getBoundingClientRect(),Ye=Ze.width,tt=Ze.height;return Ee(Ye,tt),Ge.observe(F.current),function(){Ge.disconnect()}},[Ee,R]);var Oe=re.useMemo(function(){var je=pe.containerWidth,Ge=pe.containerHeight;if(je<0||Ge<0)return null;ac(rd(h)||rd(s),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,h,s),ac(!r||r>0,"The aspect(%s) must be greater than zero.",r);var Ze=rd(h)?je:h,Ye=rd(s)?Ge:s;r&&r>0&&(Ze?Ye=Ze/r:Ye&&(Ze=Ye*r),A&&Ye>A&&(Ye=A)),ac(Ze>0||Ye>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,Ze,Ye,h,s,b,w,r);var tt=!Array.isArray(k)&&sc(k.type).endsWith("Chart");return Ce.Children.map(k,function(ze){return Ce.isValidElement(ze)?re.cloneElement(ze,Kx({width:Ze,height:Ye},tt?{style:Kx({height:"100%",width:"100%",maxHeight:Ye,maxWidth:Ze},ze.props.style)}:{})):ze})},[r,k,s,A,w,b,pe,h]);return Ce.createElement("div",{id:j?"".concat(j):void 0,className:zr("recharts-responsive-container",L),style:Kx(Kx({},Z),{},{width:h,height:s,minWidth:b,minHeight:w,maxHeight:A}),ref:F},Oe)}),LI=function(t){return null};LI.displayName="Cell";function Jv(e){"@babel/helpers - typeof";return Jv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Jv(e)}function jN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function dk(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?jN(Object(r),!0).forEach(function(n){nbe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):jN(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function nbe(e,t,r){return t=ibe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ibe(e){var t=obe(e,"string");return Jv(t)=="symbol"?t:t+""}function obe(e,t){if(Jv(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Jv(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Wf={widthCache:{},cacheCount:0},sbe=2e3,abe={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},zN="recharts_measurement_span";function lbe(e){var t=dk({},e);return Object.keys(t).forEach(function(r){t[r]||delete t[r]}),t}var lv=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t==null||qu.isSsr)return{width:0,height:0};var n=lbe(r),o=JSON.stringify({text:t,copyStyle:n});if(Wf.widthCache[o])return Wf.widthCache[o];try{var l=document.getElementById(zN);l||(l=document.createElement("span"),l.setAttribute("id",zN),l.setAttribute("aria-hidden","true"),document.body.appendChild(l));var h=dk(dk({},abe),n);Object.assign(l.style,h),l.textContent="".concat(t);var f=l.getBoundingClientRect(),s={width:f.width,height:f.height};return Wf.widthCache[o]=s,++Wf.cacheCount>sbe&&(Wf.cacheCount=0,Wf.widthCache={}),s}catch{return{width:0,height:0}}},cbe=function(t){return{top:t.top+window.scrollY-document.documentElement.clientTop,left:t.left+window.scrollX-document.documentElement.clientLeft}};function Qv(e){"@babel/helpers - typeof";return Qv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qv(e)}function Cw(e,t){return fbe(e)||dbe(e,t)||hbe(e,t)||ube()}function ube(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function hbe(e,t){if(e){if(typeof e=="string")return BN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return BN(e,t)}}function BN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function dbe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,l,h,f=[],s=!0,y=!1;try{if(l=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=l.call(r)).done)&&(f.push(n.value),f.length!==t);s=!0);}catch(b){y=!0,o=b}finally{try{if(!s&&r.return!=null&&(h=r.return(),Object(h)!==h))return}finally{if(y)throw o}}return f}}function fbe(e){if(Array.isArray(e))return e}function pbe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function NN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,gbe(n.key),n)}}function mbe(e,t,r){return t&&NN(e.prototype,t),r&&NN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function gbe(e){var t=ybe(e,"string");return Qv(t)=="symbol"?t:t+""}function ybe(e,t){if(Qv(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Qv(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var $N=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,FN=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,vbe=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,_be=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,iW={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},xbe=Object.keys(iW),gp="NaN";function bbe(e,t){return e*iW[t]}var Zx=function(){function e(t,r){pbe(this,e),this.num=t,this.unit=r,this.num=t,this.unit=r,Number.isNaN(t)&&(this.unit=""),r!==""&&!vbe.test(r)&&(this.num=NaN,this.unit=""),xbe.includes(r)&&(this.num=bbe(t,r),this.unit="px")}return mbe(e,[{key:"add",value:function(r){return this.unit!==r.unit?new e(NaN,""):new e(this.num+r.num,this.unit)}},{key:"subtract",value:function(r){return this.unit!==r.unit?new e(NaN,""):new e(this.num-r.num,this.unit)}},{key:"multiply",value:function(r){return this.unit!==""&&r.unit!==""&&this.unit!==r.unit?new e(NaN,""):new e(this.num*r.num,this.unit||r.unit)}},{key:"divide",value:function(r){return this.unit!==""&&r.unit!==""&&this.unit!==r.unit?new e(NaN,""):new e(this.num/r.num,this.unit||r.unit)}},{key:"toString",value:function(){return"".concat(this.num).concat(this.unit)}},{key:"isNaN",value:function(){return Number.isNaN(this.num)}}],[{key:"parse",value:function(r){var n,o=(n=_be.exec(r))!==null&&n!==void 0?n:[],l=Cw(o,3),h=l[1],f=l[2];return new e(parseFloat(h),f??"")}}])}();function oW(e){if(e.includes(gp))return gp;for(var t=e;t.includes("*")||t.includes("/");){var r,n=(r=$N.exec(t))!==null&&r!==void 0?r:[],o=Cw(n,4),l=o[1],h=o[2],f=o[3],s=Zx.parse(l??""),y=Zx.parse(f??""),b=h==="*"?s.multiply(y):s.divide(y);if(b.isNaN())return gp;t=t.replace($N,b.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var w,A=(w=FN.exec(t))!==null&&w!==void 0?w:[],k=Cw(A,4),M=k[1],R=k[2],j=k[3],L=Zx.parse(M??""),z=Zx.parse(j??""),B=R==="+"?L.add(z):L.subtract(z);if(B.isNaN())return gp;t=t.replace(FN,B.toString())}return t}var UN=/\(([^()]*)\)/;function wbe(e){for(var t=e;t.includes("(");){var r=UN.exec(t),n=Cw(r,2),o=n[1];t=t.replace(UN,oW(o))}return t}function Sbe(e){var t=e.replace(/\s+/g,"");return t=wbe(t),t=oW(t),t}function Tbe(e){try{return Sbe(e)}catch{return gp}}function RA(e){var t=Tbe(e.slice(5,-1));return t===gp?"":t}var Ebe=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],Abe=["dx","dy","angle","className","breakAll"];function fk(){return fk=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},fk.apply(this,arguments)}function VN(e,t){if(e==null)return{};var r=Pbe(e,t),n,o;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(o=0;o<l.length;o++)n=l[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Pbe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function GN(e,t){return Mbe(e)||Obe(e,t)||kbe(e,t)||Cbe()}function Cbe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function kbe(e,t){if(e){if(typeof e=="string")return WN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return WN(e,t)}}function WN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Obe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,l,h,f=[],s=!0,y=!1;try{if(l=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=l.call(r)).done)&&(f.push(n.value),f.length!==t);s=!0);}catch(b){y=!0,o=b}finally{try{if(!s&&r.return!=null&&(h=r.return(),Object(h)!==h))return}finally{if(y)throw o}}return f}}function Mbe(e){if(Array.isArray(e))return e}var sW=/[ \f\n\r\t\v\u2028\u2029]+/,aW=function(t){var r=t.children,n=t.breakAll,o=t.style;try{var l=[];wr(r)||(n?l=r.toString().split(""):l=r.toString().split(sW));var h=l.map(function(s){return{word:s,width:lv(s,o).width}}),f=n?0:lv("",o).width;return{wordsWithComputedWidth:h,spaceWidth:f}}catch{return null}},Ibe=function(t,r,n,o,l){var h=t.maxLines,f=t.children,s=t.style,y=t.breakAll,b=It(h),w=f,A=function(){var Ze=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Ze.reduce(function(Ye,tt){var ze=tt.word,De=tt.width,ut=Ye[Ye.length-1];if(ut&&(o==null||l||ut.width+De+n<Number(o)))ut.words.push(ze),ut.width+=De+n;else{var ht={words:[ze],width:De};Ye.push(ht)}return Ye},[])},k=A(r),M=function(Ze){return Ze.reduce(function(Ye,tt){return Ye.width>tt.width?Ye:tt})};if(!b)return k;for(var R="",j=function(Ze){var Ye=w.slice(0,Ze),tt=aW({breakAll:y,style:s,children:Ye+R}).wordsWithComputedWidth,ze=A(tt),De=ze.length>h||M(ze).width>Number(o);return[De,ze]},L=0,z=w.length-1,B=0,Z;L<=z&&B<=w.length-1;){var F=Math.floor((L+z)/2),H=F-1,Y=j(H),te=GN(Y,2),pe=te[0],ue=te[1],Ee=j(F),Oe=GN(Ee,1),je=Oe[0];if(!pe&&!je&&(L=F+1),pe&&je&&(z=F-1),!pe&&je){Z=ue;break}B++}return Z||k},qN=function(t){var r=wr(t)?[]:t.toString().split(sW);return[{words:r}]},Rbe=function(t){var r=t.width,n=t.scaleToFit,o=t.children,l=t.style,h=t.breakAll,f=t.maxLines;if((r||n)&&!qu.isSsr){var s,y,b=aW({breakAll:h,children:o,style:l});if(b){var w=b.wordsWithComputedWidth,A=b.spaceWidth;s=w,y=A}else return qN(o);return Ibe({breakAll:h,children:o,maxLines:f,style:l},s,y,r,n)}return qN(o)},HN="#808080",kw=function(t){var r=t.x,n=r===void 0?0:r,o=t.y,l=o===void 0?0:o,h=t.lineHeight,f=h===void 0?"1em":h,s=t.capHeight,y=s===void 0?"0.71em":s,b=t.scaleToFit,w=b===void 0?!1:b,A=t.textAnchor,k=A===void 0?"start":A,M=t.verticalAnchor,R=M===void 0?"end":M,j=t.fill,L=j===void 0?HN:j,z=VN(t,Ebe),B=re.useMemo(function(){return Rbe({breakAll:z.breakAll,children:z.children,maxLines:z.maxLines,scaleToFit:w,style:z.style,width:z.width})},[z.breakAll,z.children,z.maxLines,w,z.style,z.width]),Z=z.dx,F=z.dy,H=z.angle,Y=z.className,te=z.breakAll,pe=VN(z,Abe);if(!Di(n)||!Di(l))return null;var ue=n+(It(Z)?Z:0),Ee=l+(It(F)?F:0),Oe;switch(R){case"start":Oe=RA("calc(".concat(y,")"));break;case"middle":Oe=RA("calc(".concat((B.length-1)/2," * -").concat(f," + (").concat(y," / 2))"));break;default:Oe=RA("calc(".concat(B.length-1," * -").concat(f,")"));break}var je=[];if(w){var Ge=B[0].width,Ze=z.width;je.push("scale(".concat((It(Ze)?Ze/Ge:1)/Ge,")"))}return H&&je.push("rotate(".concat(H,", ").concat(ue,", ").concat(Ee,")")),je.length&&(pe.transform=je.join(" ")),Ce.createElement("text",fk({},Sr(pe,!0),{x:ue,y:Ee,className:zr("recharts-text",Y),textAnchor:k,fill:L.includes("url")?HN:L}),B.map(function(Ye,tt){var ze=Ye.words.join(te?"":" ");return Ce.createElement("tspan",{x:ue,dy:tt===0?Oe:f,key:"".concat(ze,"-").concat(tt)},ze)}))};function Iu(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function Dbe(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function jI(e){let t,r,n;e.length!==2?(t=Iu,r=(f,s)=>Iu(e(f),s),n=(f,s)=>e(f)-s):(t=e===Iu||e===Dbe?e:Lbe,r=e,n=e);function o(f,s,y=0,b=f.length){if(y<b){if(t(s,s)!==0)return b;do{const w=y+b>>>1;r(f[w],s)<0?y=w+1:b=w}while(y<b)}return y}function l(f,s,y=0,b=f.length){if(y<b){if(t(s,s)!==0)return b;do{const w=y+b>>>1;r(f[w],s)<=0?y=w+1:b=w}while(y<b)}return y}function h(f,s,y=0,b=f.length){const w=o(f,s,y,b-1);return w>y&&n(f[w-1],s)>-n(f[w],s)?w-1:w}return{left:o,center:h,right:l}}function Lbe(){return 0}function lW(e){return e===null?NaN:+e}function*jbe(e,t){for(let r of e)r!=null&&(r=+r)>=r&&(yield r)}const zbe=jI(Iu),G_=zbe.right;jI(lW).center;class KN extends Map{constructor(t,r=$be){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),t!=null)for(const[n,o]of t)this.set(n,o)}get(t){return super.get(ZN(this,t))}has(t){return super.has(ZN(this,t))}set(t,r){return super.set(Bbe(this,t),r)}delete(t){return super.delete(Nbe(this,t))}}function ZN({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):r}function Bbe({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):(e.set(n,r),r)}function Nbe({_intern:e,_key:t},r){const n=t(r);return e.has(n)&&(r=e.get(n),e.delete(n)),r}function $be(e){return e!==null&&typeof e=="object"?e.valueOf():e}function Fbe(e=Iu){if(e===Iu)return cW;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,r)=>{const n=e(t,r);return n||n===0?n:(e(r,r)===0)-(e(t,t)===0)}}function cW(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const Ube=Math.sqrt(50),Vbe=Math.sqrt(10),Gbe=Math.sqrt(2);function Ow(e,t,r){const n=(t-e)/Math.max(0,r),o=Math.floor(Math.log10(n)),l=n/Math.pow(10,o),h=l>=Ube?10:l>=Vbe?5:l>=Gbe?2:1;let f,s,y;return o<0?(y=Math.pow(10,-o)/h,f=Math.round(e*y),s=Math.round(t*y),f/y<e&&++f,s/y>t&&--s,y=-y):(y=Math.pow(10,o)*h,f=Math.round(e/y),s=Math.round(t/y),f*y<e&&++f,s*y>t&&--s),s<f&&.5<=r&&r<2?Ow(e,t,r*2):[f,s,y]}function pk(e,t,r){if(t=+t,e=+e,r=+r,!(r>0))return[];if(e===t)return[e];const n=t<e,[o,l,h]=n?Ow(t,e,r):Ow(e,t,r);if(!(l>=o))return[];const f=l-o+1,s=new Array(f);if(n)if(h<0)for(let y=0;y<f;++y)s[y]=(l-y)/-h;else for(let y=0;y<f;++y)s[y]=(l-y)*h;else if(h<0)for(let y=0;y<f;++y)s[y]=(o+y)/-h;else for(let y=0;y<f;++y)s[y]=(o+y)*h;return s}function mk(e,t,r){return t=+t,e=+e,r=+r,Ow(e,t,r)[2]}function gk(e,t,r){t=+t,e=+e,r=+r;const n=t<e,o=n?mk(t,e,r):mk(e,t,r);return(n?-1:1)*(o<0?1/-o:o)}function XN(e,t){let r;for(const n of e)n!=null&&(r<n||r===void 0&&n>=n)&&(r=n);return r}function YN(e,t){let r;for(const n of e)n!=null&&(r>n||r===void 0&&n>=n)&&(r=n);return r}function uW(e,t,r=0,n=1/0,o){if(t=Math.floor(t),r=Math.floor(Math.max(0,r)),n=Math.floor(Math.min(e.length-1,n)),!(r<=t&&t<=n))return e;for(o=o===void 0?cW:Fbe(o);n>r;){if(n-r>600){const s=n-r+1,y=t-r+1,b=Math.log(s),w=.5*Math.exp(2*b/3),A=.5*Math.sqrt(b*w*(s-w)/s)*(y-s/2<0?-1:1),k=Math.max(r,Math.floor(t-y*w/s+A)),M=Math.min(n,Math.floor(t+(s-y)*w/s+A));uW(e,t,k,M,o)}const l=e[t];let h=r,f=n;for(ky(e,r,t),o(e[n],l)>0&&ky(e,r,n);h<f;){for(ky(e,h,f),++h,--f;o(e[h],l)<0;)++h;for(;o(e[f],l)>0;)--f}o(e[r],l)===0?ky(e,r,f):(++f,ky(e,f,n)),f<=t&&(r=f+1),t<=f&&(n=f-1)}return e}function ky(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}function Wbe(e,t,r){if(e=Float64Array.from(jbe(e)),!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return YN(e);if(t>=1)return XN(e);var n,o=(n-1)*t,l=Math.floor(o),h=XN(uW(e,l).subarray(0,l+1)),f=YN(e.subarray(l+1));return h+(f-h)*(o-l)}}function qbe(e,t,r=lW){if(!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return+r(e[0],0,e);if(t>=1)return+r(e[n-1],n-1,e);var n,o=(n-1)*t,l=Math.floor(o),h=+r(e[l],l,e),f=+r(e[l+1],l+1,e);return h+(f-h)*(o-l)}}function Hbe(e,t,r){e=+e,t=+t,r=(o=arguments.length)<2?(t=e,e=0,1):o<3?1:+r;for(var n=-1,o=Math.max(0,Math.ceil((t-e)/r))|0,l=new Array(o);++n<o;)l[n]=e+n*r;return l}function sa(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function Tc(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const yk=Symbol("implicit");function zI(){var e=new KN,t=[],r=[],n=yk;function o(l){let h=e.get(l);if(h===void 0){if(n!==yk)return n;e.set(l,h=t.push(l)-1)}return r[h%r.length]}return o.domain=function(l){if(!arguments.length)return t.slice();t=[],e=new KN;for(const h of l)e.has(h)||e.set(h,t.push(h)-1);return o},o.range=function(l){return arguments.length?(r=Array.from(l),o):r.slice()},o.unknown=function(l){return arguments.length?(n=l,o):n},o.copy=function(){return zI(t,r).unknown(n)},sa.apply(o,arguments),o}function e_(){var e=zI().unknown(void 0),t=e.domain,r=e.range,n=0,o=1,l,h,f=!1,s=0,y=0,b=.5;delete e.unknown;function w(){var A=t().length,k=o<n,M=k?o:n,R=k?n:o;l=(R-M)/Math.max(1,A-s+y*2),f&&(l=Math.floor(l)),M+=(R-M-l*(A-s))*b,h=l*(1-s),f&&(M=Math.round(M),h=Math.round(h));var j=Hbe(A).map(function(L){return M+l*L});return r(k?j.reverse():j)}return e.domain=function(A){return arguments.length?(t(A),w()):t()},e.range=function(A){return arguments.length?([n,o]=A,n=+n,o=+o,w()):[n,o]},e.rangeRound=function(A){return[n,o]=A,n=+n,o=+o,f=!0,w()},e.bandwidth=function(){return h},e.step=function(){return l},e.round=function(A){return arguments.length?(f=!!A,w()):f},e.padding=function(A){return arguments.length?(s=Math.min(1,y=+A),w()):s},e.paddingInner=function(A){return arguments.length?(s=Math.min(1,A),w()):s},e.paddingOuter=function(A){return arguments.length?(y=+A,w()):y},e.align=function(A){return arguments.length?(b=Math.max(0,Math.min(1,A)),w()):b},e.copy=function(){return e_(t(),[n,o]).round(f).paddingInner(s).paddingOuter(y).align(b)},sa.apply(w(),arguments)}function hW(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return hW(t())},e}function cv(){return hW(e_.apply(null,arguments).paddingInner(1))}function BI(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function dW(e,t){var r=Object.create(e.prototype);for(var n in t)r[n]=t[n];return r}function W_(){}var t_=.7,Mw=1/t_,Ip="\\s*([+-]?\\d+)\\s*",r_="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",wl="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Kbe=/^#([0-9a-f]{3,8})$/,Zbe=new RegExp(`^rgb\\(${Ip},${Ip},${Ip}\\)$`),Xbe=new RegExp(`^rgb\\(${wl},${wl},${wl}\\)$`),Ybe=new RegExp(`^rgba\\(${Ip},${Ip},${Ip},${r_}\\)$`),Jbe=new RegExp(`^rgba\\(${wl},${wl},${wl},${r_}\\)$`),Qbe=new RegExp(`^hsl\\(${r_},${wl},${wl}\\)$`),ewe=new RegExp(`^hsla\\(${r_},${wl},${wl},${r_}\\)$`),JN={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};BI(W_,n_,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:QN,formatHex:QN,formatHex8:twe,formatHsl:rwe,formatRgb:e$,toString:e$});function QN(){return this.rgb().formatHex()}function twe(){return this.rgb().formatHex8()}function rwe(){return fW(this).formatHsl()}function e$(){return this.rgb().formatRgb()}function n_(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=Kbe.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?t$(t):r===3?new Qo(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?Xx(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?Xx(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=Zbe.exec(e))?new Qo(t[1],t[2],t[3],1):(t=Xbe.exec(e))?new Qo(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=Ybe.exec(e))?Xx(t[1],t[2],t[3],t[4]):(t=Jbe.exec(e))?Xx(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=Qbe.exec(e))?i$(t[1],t[2]/100,t[3]/100,1):(t=ewe.exec(e))?i$(t[1],t[2]/100,t[3]/100,t[4]):JN.hasOwnProperty(e)?t$(JN[e]):e==="transparent"?new Qo(NaN,NaN,NaN,0):null}function t$(e){return new Qo(e>>16&255,e>>8&255,e&255,1)}function Xx(e,t,r,n){return n<=0&&(e=t=r=NaN),new Qo(e,t,r,n)}function nwe(e){return e instanceof W_||(e=n_(e)),e?(e=e.rgb(),new Qo(e.r,e.g,e.b,e.opacity)):new Qo}function vk(e,t,r,n){return arguments.length===1?nwe(e):new Qo(e,t,r,n??1)}function Qo(e,t,r,n){this.r=+e,this.g=+t,this.b=+r,this.opacity=+n}BI(Qo,vk,dW(W_,{brighter(e){return e=e==null?Mw:Math.pow(Mw,e),new Qo(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?t_:Math.pow(t_,e),new Qo(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Qo(dd(this.r),dd(this.g),dd(this.b),Iw(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:r$,formatHex:r$,formatHex8:iwe,formatRgb:n$,toString:n$}));function r$(){return`#${nd(this.r)}${nd(this.g)}${nd(this.b)}`}function iwe(){return`#${nd(this.r)}${nd(this.g)}${nd(this.b)}${nd((isNaN(this.opacity)?1:this.opacity)*255)}`}function n$(){const e=Iw(this.opacity);return`${e===1?"rgb(":"rgba("}${dd(this.r)}, ${dd(this.g)}, ${dd(this.b)}${e===1?")":`, ${e})`}`}function Iw(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function dd(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function nd(e){return e=dd(e),(e<16?"0":"")+e.toString(16)}function i$(e,t,r,n){return n<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new Na(e,t,r,n)}function fW(e){if(e instanceof Na)return new Na(e.h,e.s,e.l,e.opacity);if(e instanceof W_||(e=n_(e)),!e)return new Na;if(e instanceof Na)return e;e=e.rgb();var t=e.r/255,r=e.g/255,n=e.b/255,o=Math.min(t,r,n),l=Math.max(t,r,n),h=NaN,f=l-o,s=(l+o)/2;return f?(t===l?h=(r-n)/f+(r<n)*6:r===l?h=(n-t)/f+2:h=(t-r)/f+4,f/=s<.5?l+o:2-l-o,h*=60):f=s>0&&s<1?0:h,new Na(h,f,s,e.opacity)}function owe(e,t,r,n){return arguments.length===1?fW(e):new Na(e,t,r,n??1)}function Na(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}BI(Na,owe,dW(W_,{brighter(e){return e=e==null?Mw:Math.pow(Mw,e),new Na(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?t_:Math.pow(t_,e),new Na(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*t,o=2*r-n;return new Qo(DA(e>=240?e-240:e+120,o,n),DA(e,o,n),DA(e<120?e+240:e-120,o,n),this.opacity)},clamp(){return new Na(o$(this.h),Yx(this.s),Yx(this.l),Iw(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=Iw(this.opacity);return`${e===1?"hsl(":"hsla("}${o$(this.h)}, ${Yx(this.s)*100}%, ${Yx(this.l)*100}%${e===1?")":`, ${e})`}`}}));function o$(e){return e=(e||0)%360,e<0?e+360:e}function Yx(e){return Math.max(0,Math.min(1,e||0))}function DA(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}const NI=e=>()=>e;function swe(e,t){return function(r){return e+r*t}}function awe(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(n){return Math.pow(e+n*t,r)}}function lwe(e){return(e=+e)==1?pW:function(t,r){return r-t?awe(t,r,e):NI(isNaN(t)?r:t)}}function pW(e,t){var r=t-e;return r?swe(e,r):NI(isNaN(e)?t:e)}const s$=function e(t){var r=lwe(t);function n(o,l){var h=r((o=vk(o)).r,(l=vk(l)).r),f=r(o.g,l.g),s=r(o.b,l.b),y=pW(o.opacity,l.opacity);return function(b){return o.r=h(b),o.g=f(b),o.b=s(b),o.opacity=y(b),o+""}}return n.gamma=e,n}(1);function cwe(e,t){t||(t=[]);var r=e?Math.min(t.length,e.length):0,n=t.slice(),o;return function(l){for(o=0;o<r;++o)n[o]=e[o]*(1-l)+t[o]*l;return n}}function uwe(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function hwe(e,t){var r=t?t.length:0,n=e?Math.min(r,e.length):0,o=new Array(n),l=new Array(r),h;for(h=0;h<n;++h)o[h]=zm(e[h],t[h]);for(;h<r;++h)l[h]=t[h];return function(f){for(h=0;h<n;++h)l[h]=o[h](f);return l}}function dwe(e,t){var r=new Date;return e=+e,t=+t,function(n){return r.setTime(e*(1-n)+t*n),r}}function Rw(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}function fwe(e,t){var r={},n={},o;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(o in t)o in e?r[o]=zm(e[o],t[o]):n[o]=t[o];return function(l){for(o in r)n[o]=r[o](l);return n}}var _k=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,LA=new RegExp(_k.source,"g");function pwe(e){return function(){return e}}function mwe(e){return function(t){return e(t)+""}}function gwe(e,t){var r=_k.lastIndex=LA.lastIndex=0,n,o,l,h=-1,f=[],s=[];for(e=e+"",t=t+"";(n=_k.exec(e))&&(o=LA.exec(t));)(l=o.index)>r&&(l=t.slice(r,l),f[h]?f[h]+=l:f[++h]=l),(n=n[0])===(o=o[0])?f[h]?f[h]+=o:f[++h]=o:(f[++h]=null,s.push({i:h,x:Rw(n,o)})),r=LA.lastIndex;return r<t.length&&(l=t.slice(r),f[h]?f[h]+=l:f[++h]=l),f.length<2?s[0]?mwe(s[0].x):pwe(t):(t=s.length,function(y){for(var b=0,w;b<t;++b)f[(w=s[b]).i]=w.x(y);return f.join("")})}function zm(e,t){var r=typeof t,n;return t==null||r==="boolean"?NI(t):(r==="number"?Rw:r==="string"?(n=n_(t))?(t=n,s$):gwe:t instanceof n_?s$:t instanceof Date?dwe:uwe(t)?cwe:Array.isArray(t)?hwe:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?fwe:Rw)(e,t)}function $I(e,t){return e=+e,t=+t,function(r){return Math.round(e*(1-r)+t*r)}}function ywe(e,t){t===void 0&&(t=e,e=zm);for(var r=0,n=t.length-1,o=t[0],l=new Array(n<0?0:n);r<n;)l[r]=e(o,o=t[++r]);return function(h){var f=Math.max(0,Math.min(n-1,Math.floor(h*=n)));return l[f](h-f)}}function vwe(e){return function(){return e}}function Dw(e){return+e}var a$=[0,1];function Lo(e){return e}function xk(e,t){return(t-=e=+e)?function(r){return(r-e)/t}:vwe(isNaN(t)?NaN:.5)}function _we(e,t){var r;return e>t&&(r=e,e=t,t=r),function(n){return Math.max(e,Math.min(t,n))}}function xwe(e,t,r){var n=e[0],o=e[1],l=t[0],h=t[1];return o<n?(n=xk(o,n),l=r(h,l)):(n=xk(n,o),l=r(l,h)),function(f){return l(n(f))}}function bwe(e,t,r){var n=Math.min(e.length,t.length)-1,o=new Array(n),l=new Array(n),h=-1;for(e[n]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++h<n;)o[h]=xk(e[h],e[h+1]),l[h]=r(t[h],t[h+1]);return function(f){var s=G_(e,f,1,n)-1;return l[s](o[s](f))}}function q_(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function yS(){var e=a$,t=a$,r=zm,n,o,l,h=Lo,f,s,y;function b(){var A=Math.min(e.length,t.length);return h!==Lo&&(h=_we(e[0],e[A-1])),f=A>2?bwe:xwe,s=y=null,w}function w(A){return A==null||isNaN(A=+A)?l:(s||(s=f(e.map(n),t,r)))(n(h(A)))}return w.invert=function(A){return h(o((y||(y=f(t,e.map(n),Rw)))(A)))},w.domain=function(A){return arguments.length?(e=Array.from(A,Dw),b()):e.slice()},w.range=function(A){return arguments.length?(t=Array.from(A),b()):t.slice()},w.rangeRound=function(A){return t=Array.from(A),r=$I,b()},w.clamp=function(A){return arguments.length?(h=A?!0:Lo,b()):h!==Lo},w.interpolate=function(A){return arguments.length?(r=A,b()):r},w.unknown=function(A){return arguments.length?(l=A,w):l},function(A,k){return n=A,o=k,b()}}function FI(){return yS()(Lo,Lo)}function wwe(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function Lw(e,t){if((r=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var r,n=e.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+e.slice(r+1)]}function Zp(e){return e=Lw(Math.abs(e)),e?e[1]:NaN}function Swe(e,t){return function(r,n){for(var o=r.length,l=[],h=0,f=e[0],s=0;o>0&&f>0&&(s+f+1>n&&(f=Math.max(1,n-s)),l.push(r.substring(o-=f,o+f)),!((s+=f+1)>n));)f=e[h=(h+1)%e.length];return l.reverse().join(t)}}function Twe(e){return function(t){return t.replace(/[0-9]/g,function(r){return e[+r]})}}var Ewe=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function i_(e){if(!(t=Ewe.exec(e)))throw new Error("invalid format: "+e);var t;return new UI({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}i_.prototype=UI.prototype;function UI(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}UI.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function Awe(e){e:for(var t=e.length,r=1,n=-1,o;r<t;++r)switch(e[r]){case".":n=o=r;break;case"0":n===0&&(n=r),o=r;break;default:if(!+e[r])break e;n>0&&(n=0);break}return n>0?e.slice(0,n)+e.slice(o+1):e}var mW;function Pwe(e,t){var r=Lw(e,t);if(!r)return e+"";var n=r[0],o=r[1],l=o-(mW=Math.max(-8,Math.min(8,Math.floor(o/3)))*3)+1,h=n.length;return l===h?n:l>h?n+new Array(l-h+1).join("0"):l>0?n.slice(0,l)+"."+n.slice(l):"0."+new Array(1-l).join("0")+Lw(e,Math.max(0,t+l-1))[0]}function l$(e,t){var r=Lw(e,t);if(!r)return e+"";var n=r[0],o=r[1];return o<0?"0."+new Array(-o).join("0")+n:n.length>o+1?n.slice(0,o+1)+"."+n.slice(o+1):n+new Array(o-n.length+2).join("0")}const c$={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:wwe,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>l$(e*100,t),r:l$,s:Pwe,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function u$(e){return e}var h$=Array.prototype.map,d$=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function Cwe(e){var t=e.grouping===void 0||e.thousands===void 0?u$:Swe(h$.call(e.grouping,Number),e.thousands+""),r=e.currency===void 0?"":e.currency[0]+"",n=e.currency===void 0?"":e.currency[1]+"",o=e.decimal===void 0?".":e.decimal+"",l=e.numerals===void 0?u$:Twe(h$.call(e.numerals,String)),h=e.percent===void 0?"%":e.percent+"",f=e.minus===void 0?"":e.minus+"",s=e.nan===void 0?"NaN":e.nan+"";function y(w){w=i_(w);var A=w.fill,k=w.align,M=w.sign,R=w.symbol,j=w.zero,L=w.width,z=w.comma,B=w.precision,Z=w.trim,F=w.type;F==="n"?(z=!0,F="g"):c$[F]||(B===void 0&&(B=12),Z=!0,F="g"),(j||A==="0"&&k==="=")&&(j=!0,A="0",k="=");var H=R==="$"?r:R==="#"&&/[boxX]/.test(F)?"0"+F.toLowerCase():"",Y=R==="$"?n:/[%p]/.test(F)?h:"",te=c$[F],pe=/[defgprs%]/.test(F);B=B===void 0?6:/[gprs]/.test(F)?Math.max(1,Math.min(21,B)):Math.max(0,Math.min(20,B));function ue(Ee){var Oe=H,je=Y,Ge,Ze,Ye;if(F==="c")je=te(Ee)+je,Ee="";else{Ee=+Ee;var tt=Ee<0||1/Ee<0;if(Ee=isNaN(Ee)?s:te(Math.abs(Ee),B),Z&&(Ee=Awe(Ee)),tt&&+Ee==0&&M!=="+"&&(tt=!1),Oe=(tt?M==="("?M:f:M==="-"||M==="("?"":M)+Oe,je=(F==="s"?d$[8+mW/3]:"")+je+(tt&&M==="("?")":""),pe){for(Ge=-1,Ze=Ee.length;++Ge<Ze;)if(Ye=Ee.charCodeAt(Ge),48>Ye||Ye>57){je=(Ye===46?o+Ee.slice(Ge+1):Ee.slice(Ge))+je,Ee=Ee.slice(0,Ge);break}}}z&&!j&&(Ee=t(Ee,1/0));var ze=Oe.length+Ee.length+je.length,De=ze<L?new Array(L-ze+1).join(A):"";switch(z&&j&&(Ee=t(De+Ee,De.length?L-je.length:1/0),De=""),k){case"<":Ee=Oe+Ee+je+De;break;case"=":Ee=Oe+De+Ee+je;break;case"^":Ee=De.slice(0,ze=De.length>>1)+Oe+Ee+je+De.slice(ze);break;default:Ee=De+Oe+Ee+je;break}return l(Ee)}return ue.toString=function(){return w+""},ue}function b(w,A){var k=y((w=i_(w),w.type="f",w)),M=Math.max(-8,Math.min(8,Math.floor(Zp(A)/3)))*3,R=Math.pow(10,-M),j=d$[8+M/3];return function(L){return k(R*L)+j}}return{format:y,formatPrefix:b}}var Jx,VI,gW;kwe({thousands:",",grouping:[3],currency:["$",""]});function kwe(e){return Jx=Cwe(e),VI=Jx.format,gW=Jx.formatPrefix,Jx}function Owe(e){return Math.max(0,-Zp(Math.abs(e)))}function Mwe(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Zp(t)/3)))*3-Zp(Math.abs(e)))}function Iwe(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,Zp(t)-Zp(e))+1}function yW(e,t,r,n){var o=gk(e,t,r),l;switch(n=i_(n??",f"),n.type){case"s":{var h=Math.max(Math.abs(e),Math.abs(t));return n.precision==null&&!isNaN(l=Mwe(o,h))&&(n.precision=l),gW(n,h)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(l=Iwe(o,Math.max(Math.abs(e),Math.abs(t))))&&(n.precision=l-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(l=Owe(o))&&(n.precision=l-(n.type==="%")*2);break}}return VI(n)}function Hu(e){var t=e.domain;return e.ticks=function(r){var n=t();return pk(n[0],n[n.length-1],r??10)},e.tickFormat=function(r,n){var o=t();return yW(o[0],o[o.length-1],r??10,n)},e.nice=function(r){r==null&&(r=10);var n=t(),o=0,l=n.length-1,h=n[o],f=n[l],s,y,b=10;for(f<h&&(y=h,h=f,f=y,y=o,o=l,l=y);b-- >0;){if(y=mk(h,f,r),y===s)return n[o]=h,n[l]=f,t(n);if(y>0)h=Math.floor(h/y)*y,f=Math.ceil(f/y)*y;else if(y<0)h=Math.ceil(h*y)/y,f=Math.floor(f*y)/y;else break;s=y}return e},e}function jw(){var e=FI();return e.copy=function(){return q_(e,jw())},sa.apply(e,arguments),Hu(e)}function vW(e){var t;function r(n){return n==null||isNaN(n=+n)?t:n}return r.invert=r,r.domain=r.range=function(n){return arguments.length?(e=Array.from(n,Dw),r):e.slice()},r.unknown=function(n){return arguments.length?(t=n,r):t},r.copy=function(){return vW(e).unknown(t)},e=arguments.length?Array.from(e,Dw):[0,1],Hu(r)}function _W(e,t){e=e.slice();var r=0,n=e.length-1,o=e[r],l=e[n],h;return l<o&&(h=r,r=n,n=h,h=o,o=l,l=h),e[r]=t.floor(o),e[n]=t.ceil(l),e}function f$(e){return Math.log(e)}function p$(e){return Math.exp(e)}function Rwe(e){return-Math.log(-e)}function Dwe(e){return-Math.exp(-e)}function Lwe(e){return isFinite(e)?+("1e"+e):e<0?0:e}function jwe(e){return e===10?Lwe:e===Math.E?Math.exp:t=>Math.pow(e,t)}function zwe(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function m$(e){return(t,r)=>-e(-t,r)}function GI(e){const t=e(f$,p$),r=t.domain;let n=10,o,l;function h(){return o=zwe(n),l=jwe(n),r()[0]<0?(o=m$(o),l=m$(l),e(Rwe,Dwe)):e(f$,p$),t}return t.base=function(f){return arguments.length?(n=+f,h()):n},t.domain=function(f){return arguments.length?(r(f),h()):r()},t.ticks=f=>{const s=r();let y=s[0],b=s[s.length-1];const w=b<y;w&&([y,b]=[b,y]);let A=o(y),k=o(b),M,R;const j=f==null?10:+f;let L=[];if(!(n%1)&&k-A<j){if(A=Math.floor(A),k=Math.ceil(k),y>0){for(;A<=k;++A)for(M=1;M<n;++M)if(R=A<0?M/l(-A):M*l(A),!(R<y)){if(R>b)break;L.push(R)}}else for(;A<=k;++A)for(M=n-1;M>=1;--M)if(R=A>0?M/l(-A):M*l(A),!(R<y)){if(R>b)break;L.push(R)}L.length*2<j&&(L=pk(y,b,j))}else L=pk(A,k,Math.min(k-A,j)).map(l);return w?L.reverse():L},t.tickFormat=(f,s)=>{if(f==null&&(f=10),s==null&&(s=n===10?"s":","),typeof s!="function"&&(!(n%1)&&(s=i_(s)).precision==null&&(s.trim=!0),s=VI(s)),f===1/0)return s;const y=Math.max(1,n*f/t.ticks().length);return b=>{let w=b/l(Math.round(o(b)));return w*n<n-.5&&(w*=n),w<=y?s(b):""}},t.nice=()=>r(_W(r(),{floor:f=>l(Math.floor(o(f))),ceil:f=>l(Math.ceil(o(f)))})),t}function xW(){const e=GI(yS()).domain([1,10]);return e.copy=()=>q_(e,xW()).base(e.base()),sa.apply(e,arguments),e}function g$(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function y$(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function WI(e){var t=1,r=e(g$(t),y$(t));return r.constant=function(n){return arguments.length?e(g$(t=+n),y$(t)):t},Hu(r)}function bW(){var e=WI(yS());return e.copy=function(){return q_(e,bW()).constant(e.constant())},sa.apply(e,arguments)}function v$(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function Bwe(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function Nwe(e){return e<0?-e*e:e*e}function qI(e){var t=e(Lo,Lo),r=1;function n(){return r===1?e(Lo,Lo):r===.5?e(Bwe,Nwe):e(v$(r),v$(1/r))}return t.exponent=function(o){return arguments.length?(r=+o,n()):r},Hu(t)}function HI(){var e=qI(yS());return e.copy=function(){return q_(e,HI()).exponent(e.exponent())},sa.apply(e,arguments),e}function $we(){return HI.apply(null,arguments).exponent(.5)}function _$(e){return Math.sign(e)*e*e}function Fwe(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function wW(){var e=FI(),t=[0,1],r=!1,n;function o(l){var h=Fwe(e(l));return isNaN(h)?n:r?Math.round(h):h}return o.invert=function(l){return e.invert(_$(l))},o.domain=function(l){return arguments.length?(e.domain(l),o):e.domain()},o.range=function(l){return arguments.length?(e.range((t=Array.from(l,Dw)).map(_$)),o):t.slice()},o.rangeRound=function(l){return o.range(l).round(!0)},o.round=function(l){return arguments.length?(r=!!l,o):r},o.clamp=function(l){return arguments.length?(e.clamp(l),o):e.clamp()},o.unknown=function(l){return arguments.length?(n=l,o):n},o.copy=function(){return wW(e.domain(),t).round(r).clamp(e.clamp()).unknown(n)},sa.apply(o,arguments),Hu(o)}function SW(){var e=[],t=[],r=[],n;function o(){var h=0,f=Math.max(1,t.length);for(r=new Array(f-1);++h<f;)r[h-1]=qbe(e,h/f);return l}function l(h){return h==null||isNaN(h=+h)?n:t[G_(r,h)]}return l.invertExtent=function(h){var f=t.indexOf(h);return f<0?[NaN,NaN]:[f>0?r[f-1]:e[0],f<r.length?r[f]:e[e.length-1]]},l.domain=function(h){if(!arguments.length)return e.slice();e=[];for(let f of h)f!=null&&!isNaN(f=+f)&&e.push(f);return e.sort(Iu),o()},l.range=function(h){return arguments.length?(t=Array.from(h),o()):t.slice()},l.unknown=function(h){return arguments.length?(n=h,l):n},l.quantiles=function(){return r.slice()},l.copy=function(){return SW().domain(e).range(t).unknown(n)},sa.apply(l,arguments)}function TW(){var e=0,t=1,r=1,n=[.5],o=[0,1],l;function h(s){return s!=null&&s<=s?o[G_(n,s,0,r)]:l}function f(){var s=-1;for(n=new Array(r);++s<r;)n[s]=((s+1)*t-(s-r)*e)/(r+1);return h}return h.domain=function(s){return arguments.length?([e,t]=s,e=+e,t=+t,f()):[e,t]},h.range=function(s){return arguments.length?(r=(o=Array.from(s)).length-1,f()):o.slice()},h.invertExtent=function(s){var y=o.indexOf(s);return y<0?[NaN,NaN]:y<1?[e,n[0]]:y>=r?[n[r-1],t]:[n[y-1],n[y]]},h.unknown=function(s){return arguments.length&&(l=s),h},h.thresholds=function(){return n.slice()},h.copy=function(){return TW().domain([e,t]).range(o).unknown(l)},sa.apply(Hu(h),arguments)}function EW(){var e=[.5],t=[0,1],r,n=1;function o(l){return l!=null&&l<=l?t[G_(e,l,0,n)]:r}return o.domain=function(l){return arguments.length?(e=Array.from(l),n=Math.min(e.length,t.length-1),o):e.slice()},o.range=function(l){return arguments.length?(t=Array.from(l),n=Math.min(e.length,t.length-1),o):t.slice()},o.invertExtent=function(l){var h=t.indexOf(l);return[e[h-1],e[h]]},o.unknown=function(l){return arguments.length?(r=l,o):r},o.copy=function(){return EW().domain(e).range(t).unknown(r)},sa.apply(o,arguments)}const jA=new Date,zA=new Date;function ji(e,t,r,n){function o(l){return e(l=arguments.length===0?new Date:new Date(+l)),l}return o.floor=l=>(e(l=new Date(+l)),l),o.ceil=l=>(e(l=new Date(l-1)),t(l,1),e(l),l),o.round=l=>{const h=o(l),f=o.ceil(l);return l-h<f-l?h:f},o.offset=(l,h)=>(t(l=new Date(+l),h==null?1:Math.floor(h)),l),o.range=(l,h,f)=>{const s=[];if(l=o.ceil(l),f=f==null?1:Math.floor(f),!(l<h)||!(f>0))return s;let y;do s.push(y=new Date(+l)),t(l,f),e(l);while(y<l&&l<h);return s},o.filter=l=>ji(h=>{if(h>=h)for(;e(h),!l(h);)h.setTime(h-1)},(h,f)=>{if(h>=h)if(f<0)for(;++f<=0;)for(;t(h,-1),!l(h););else for(;--f>=0;)for(;t(h,1),!l(h););}),r&&(o.count=(l,h)=>(jA.setTime(+l),zA.setTime(+h),e(jA),e(zA),Math.floor(r(jA,zA))),o.every=l=>(l=Math.floor(l),!isFinite(l)||!(l>0)?null:l>1?o.filter(n?h=>n(h)%l===0:h=>o.count(0,h)%l===0):o)),o}const zw=ji(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);zw.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?ji(t=>{t.setTime(Math.floor(t/e)*e)},(t,r)=>{t.setTime(+t+r*e)},(t,r)=>(r-t)/e):zw);zw.range;const tc=1e3,Ys=tc*60,rc=Ys*60,mc=rc*24,KI=mc*7,x$=mc*30,BA=mc*365,id=ji(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*tc)},(e,t)=>(t-e)/tc,e=>e.getUTCSeconds());id.range;const ZI=ji(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*tc)},(e,t)=>{e.setTime(+e+t*Ys)},(e,t)=>(t-e)/Ys,e=>e.getMinutes());ZI.range;const XI=ji(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*Ys)},(e,t)=>(t-e)/Ys,e=>e.getUTCMinutes());XI.range;const YI=ji(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*tc-e.getMinutes()*Ys)},(e,t)=>{e.setTime(+e+t*rc)},(e,t)=>(t-e)/rc,e=>e.getHours());YI.range;const JI=ji(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*rc)},(e,t)=>(t-e)/rc,e=>e.getUTCHours());JI.range;const H_=ji(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Ys)/mc,e=>e.getDate()-1);H_.range;const vS=ji(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/mc,e=>e.getUTCDate()-1);vS.range;const AW=ji(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/mc,e=>Math.floor(e/mc));AW.range;function Id(e){return ji(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,r)=>{t.setDate(t.getDate()+r*7)},(t,r)=>(r-t-(r.getTimezoneOffset()-t.getTimezoneOffset())*Ys)/KI)}const _S=Id(0),Bw=Id(1),Uwe=Id(2),Vwe=Id(3),Xp=Id(4),Gwe=Id(5),Wwe=Id(6);_S.range;Bw.range;Uwe.range;Vwe.range;Xp.range;Gwe.range;Wwe.range;function Rd(e){return ji(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCDate(t.getUTCDate()+r*7)},(t,r)=>(r-t)/KI)}const xS=Rd(0),Nw=Rd(1),qwe=Rd(2),Hwe=Rd(3),Yp=Rd(4),Kwe=Rd(5),Zwe=Rd(6);xS.range;Nw.range;qwe.range;Hwe.range;Yp.range;Kwe.range;Zwe.range;const QI=ji(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());QI.range;const eR=ji(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());eR.range;const gc=ji(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());gc.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:ji(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,r)=>{t.setFullYear(t.getFullYear()+r*e)});gc.range;const yc=ji(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());yc.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:ji(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCFullYear(t.getUTCFullYear()+r*e)});yc.range;function PW(e,t,r,n,o,l){const h=[[id,1,tc],[id,5,5*tc],[id,15,15*tc],[id,30,30*tc],[l,1,Ys],[l,5,5*Ys],[l,15,15*Ys],[l,30,30*Ys],[o,1,rc],[o,3,3*rc],[o,6,6*rc],[o,12,12*rc],[n,1,mc],[n,2,2*mc],[r,1,KI],[t,1,x$],[t,3,3*x$],[e,1,BA]];function f(y,b,w){const A=b<y;A&&([y,b]=[b,y]);const k=w&&typeof w.range=="function"?w:s(y,b,w),M=k?k.range(y,+b+1):[];return A?M.reverse():M}function s(y,b,w){const A=Math.abs(b-y)/w,k=jI(([,,j])=>j).right(h,A);if(k===h.length)return e.every(gk(y/BA,b/BA,w));if(k===0)return zw.every(Math.max(gk(y,b,w),1));const[M,R]=h[A/h[k-1][2]<h[k][2]/A?k-1:k];return M.every(R)}return[f,s]}const[Xwe,Ywe]=PW(yc,eR,xS,AW,JI,XI),[Jwe,Qwe]=PW(gc,QI,_S,H_,YI,ZI);function NA(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function $A(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function Oy(e,t,r){return{y:e,m:t,d:r,H:0,M:0,S:0,L:0}}function e1e(e){var t=e.dateTime,r=e.date,n=e.time,o=e.periods,l=e.days,h=e.shortDays,f=e.months,s=e.shortMonths,y=My(o),b=Iy(o),w=My(l),A=Iy(l),k=My(h),M=Iy(h),R=My(f),j=Iy(f),L=My(s),z=Iy(s),B={a:tt,A:ze,b:De,B:ut,c:null,d:A$,e:A$,f:S1e,g:R1e,G:L1e,H:x1e,I:b1e,j:w1e,L:CW,m:T1e,M:E1e,p:ht,q:at,Q:k$,s:O$,S:A1e,u:P1e,U:C1e,V:k1e,w:O1e,W:M1e,x:null,X:null,y:I1e,Y:D1e,Z:j1e,"%":C$},Z={a:Lt,A:$t,b:Tr,B:Br,c:null,d:P$,e:P$,f:$1e,g:X1e,G:J1e,H:z1e,I:B1e,j:N1e,L:OW,m:F1e,M:U1e,p:cn,q:Vr,Q:k$,s:O$,S:V1e,u:G1e,U:W1e,V:q1e,w:H1e,W:K1e,x:null,X:null,y:Z1e,Y:Y1e,Z:Q1e,"%":C$},F={a:ue,A:Ee,b:Oe,B:je,c:Ge,d:T$,e:T$,f:g1e,g:S$,G:w$,H:E$,I:E$,j:d1e,L:m1e,m:h1e,M:f1e,p:pe,q:u1e,Q:v1e,s:_1e,S:p1e,u:o1e,U:s1e,V:a1e,w:i1e,W:l1e,x:Ze,X:Ye,y:S$,Y:w$,Z:c1e,"%":y1e};B.x=H(r,B),B.X=H(n,B),B.c=H(t,B),Z.x=H(r,Z),Z.X=H(n,Z),Z.c=H(t,Z);function H(Dt,Jt){return function(rr){var Le=[],qt=-1,Tt=0,St=Dt.length,Et,Ft,un;for(rr instanceof Date||(rr=new Date(+rr));++qt<St;)Dt.charCodeAt(qt)===37&&(Le.push(Dt.slice(Tt,qt)),(Ft=b$[Et=Dt.charAt(++qt)])!=null?Et=Dt.charAt(++qt):Ft=Et==="e"?" ":"0",(un=Jt[Et])&&(Et=un(rr,Ft)),Le.push(Et),Tt=qt+1);return Le.push(Dt.slice(Tt,qt)),Le.join("")}}function Y(Dt,Jt){return function(rr){var Le=Oy(1900,void 0,1),qt=te(Le,Dt,rr+="",0),Tt,St;if(qt!=rr.length)return null;if("Q"in Le)return new Date(Le.Q);if("s"in Le)return new Date(Le.s*1e3+("L"in Le?Le.L:0));if(Jt&&!("Z"in Le)&&(Le.Z=0),"p"in Le&&(Le.H=Le.H%12+Le.p*12),Le.m===void 0&&(Le.m="q"in Le?Le.q:0),"V"in Le){if(Le.V<1||Le.V>53)return null;"w"in Le||(Le.w=1),"Z"in Le?(Tt=$A(Oy(Le.y,0,1)),St=Tt.getUTCDay(),Tt=St>4||St===0?Nw.ceil(Tt):Nw(Tt),Tt=vS.offset(Tt,(Le.V-1)*7),Le.y=Tt.getUTCFullYear(),Le.m=Tt.getUTCMonth(),Le.d=Tt.getUTCDate()+(Le.w+6)%7):(Tt=NA(Oy(Le.y,0,1)),St=Tt.getDay(),Tt=St>4||St===0?Bw.ceil(Tt):Bw(Tt),Tt=H_.offset(Tt,(Le.V-1)*7),Le.y=Tt.getFullYear(),Le.m=Tt.getMonth(),Le.d=Tt.getDate()+(Le.w+6)%7)}else("W"in Le||"U"in Le)&&("w"in Le||(Le.w="u"in Le?Le.u%7:"W"in Le?1:0),St="Z"in Le?$A(Oy(Le.y,0,1)).getUTCDay():NA(Oy(Le.y,0,1)).getDay(),Le.m=0,Le.d="W"in Le?(Le.w+6)%7+Le.W*7-(St+5)%7:Le.w+Le.U*7-(St+6)%7);return"Z"in Le?(Le.H+=Le.Z/100|0,Le.M+=Le.Z%100,$A(Le)):NA(Le)}}function te(Dt,Jt,rr,Le){for(var qt=0,Tt=Jt.length,St=rr.length,Et,Ft;qt<Tt;){if(Le>=St)return-1;if(Et=Jt.charCodeAt(qt++),Et===37){if(Et=Jt.charAt(qt++),Ft=F[Et in b$?Jt.charAt(qt++):Et],!Ft||(Le=Ft(Dt,rr,Le))<0)return-1}else if(Et!=rr.charCodeAt(Le++))return-1}return Le}function pe(Dt,Jt,rr){var Le=y.exec(Jt.slice(rr));return Le?(Dt.p=b.get(Le[0].toLowerCase()),rr+Le[0].length):-1}function ue(Dt,Jt,rr){var Le=k.exec(Jt.slice(rr));return Le?(Dt.w=M.get(Le[0].toLowerCase()),rr+Le[0].length):-1}function Ee(Dt,Jt,rr){var Le=w.exec(Jt.slice(rr));return Le?(Dt.w=A.get(Le[0].toLowerCase()),rr+Le[0].length):-1}function Oe(Dt,Jt,rr){var Le=L.exec(Jt.slice(rr));return Le?(Dt.m=z.get(Le[0].toLowerCase()),rr+Le[0].length):-1}function je(Dt,Jt,rr){var Le=R.exec(Jt.slice(rr));return Le?(Dt.m=j.get(Le[0].toLowerCase()),rr+Le[0].length):-1}function Ge(Dt,Jt,rr){return te(Dt,t,Jt,rr)}function Ze(Dt,Jt,rr){return te(Dt,r,Jt,rr)}function Ye(Dt,Jt,rr){return te(Dt,n,Jt,rr)}function tt(Dt){return h[Dt.getDay()]}function ze(Dt){return l[Dt.getDay()]}function De(Dt){return s[Dt.getMonth()]}function ut(Dt){return f[Dt.getMonth()]}function ht(Dt){return o[+(Dt.getHours()>=12)]}function at(Dt){return 1+~~(Dt.getMonth()/3)}function Lt(Dt){return h[Dt.getUTCDay()]}function $t(Dt){return l[Dt.getUTCDay()]}function Tr(Dt){return s[Dt.getUTCMonth()]}function Br(Dt){return f[Dt.getUTCMonth()]}function cn(Dt){return o[+(Dt.getUTCHours()>=12)]}function Vr(Dt){return 1+~~(Dt.getUTCMonth()/3)}return{format:function(Dt){var Jt=H(Dt+="",B);return Jt.toString=function(){return Dt},Jt},parse:function(Dt){var Jt=Y(Dt+="",!1);return Jt.toString=function(){return Dt},Jt},utcFormat:function(Dt){var Jt=H(Dt+="",Z);return Jt.toString=function(){return Dt},Jt},utcParse:function(Dt){var Jt=Y(Dt+="",!0);return Jt.toString=function(){return Dt},Jt}}}var b$={"-":"",_:" ",0:"0"},Ki=/^\s*\d+/,t1e=/^%/,r1e=/[\\^$*+?|[\]().{}]/g;function Qr(e,t,r){var n=e<0?"-":"",o=(n?-e:e)+"",l=o.length;return n+(l<r?new Array(r-l+1).join(t)+o:o)}function n1e(e){return e.replace(r1e,"\\$&")}function My(e){return new RegExp("^(?:"+e.map(n1e).join("|")+")","i")}function Iy(e){return new Map(e.map((t,r)=>[t.toLowerCase(),r]))}function i1e(e,t,r){var n=Ki.exec(t.slice(r,r+1));return n?(e.w=+n[0],r+n[0].length):-1}function o1e(e,t,r){var n=Ki.exec(t.slice(r,r+1));return n?(e.u=+n[0],r+n[0].length):-1}function s1e(e,t,r){var n=Ki.exec(t.slice(r,r+2));return n?(e.U=+n[0],r+n[0].length):-1}function a1e(e,t,r){var n=Ki.exec(t.slice(r,r+2));return n?(e.V=+n[0],r+n[0].length):-1}function l1e(e,t,r){var n=Ki.exec(t.slice(r,r+2));return n?(e.W=+n[0],r+n[0].length):-1}function w$(e,t,r){var n=Ki.exec(t.slice(r,r+4));return n?(e.y=+n[0],r+n[0].length):-1}function S$(e,t,r){var n=Ki.exec(t.slice(r,r+2));return n?(e.y=+n[0]+(+n[0]>68?1900:2e3),r+n[0].length):-1}function c1e(e,t,r){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(r,r+6));return n?(e.Z=n[1]?0:-(n[2]+(n[3]||"00")),r+n[0].length):-1}function u1e(e,t,r){var n=Ki.exec(t.slice(r,r+1));return n?(e.q=n[0]*3-3,r+n[0].length):-1}function h1e(e,t,r){var n=Ki.exec(t.slice(r,r+2));return n?(e.m=n[0]-1,r+n[0].length):-1}function T$(e,t,r){var n=Ki.exec(t.slice(r,r+2));return n?(e.d=+n[0],r+n[0].length):-1}function d1e(e,t,r){var n=Ki.exec(t.slice(r,r+3));return n?(e.m=0,e.d=+n[0],r+n[0].length):-1}function E$(e,t,r){var n=Ki.exec(t.slice(r,r+2));return n?(e.H=+n[0],r+n[0].length):-1}function f1e(e,t,r){var n=Ki.exec(t.slice(r,r+2));return n?(e.M=+n[0],r+n[0].length):-1}function p1e(e,t,r){var n=Ki.exec(t.slice(r,r+2));return n?(e.S=+n[0],r+n[0].length):-1}function m1e(e,t,r){var n=Ki.exec(t.slice(r,r+3));return n?(e.L=+n[0],r+n[0].length):-1}function g1e(e,t,r){var n=Ki.exec(t.slice(r,r+6));return n?(e.L=Math.floor(n[0]/1e3),r+n[0].length):-1}function y1e(e,t,r){var n=t1e.exec(t.slice(r,r+1));return n?r+n[0].length:-1}function v1e(e,t,r){var n=Ki.exec(t.slice(r));return n?(e.Q=+n[0],r+n[0].length):-1}function _1e(e,t,r){var n=Ki.exec(t.slice(r));return n?(e.s=+n[0],r+n[0].length):-1}function A$(e,t){return Qr(e.getDate(),t,2)}function x1e(e,t){return Qr(e.getHours(),t,2)}function b1e(e,t){return Qr(e.getHours()%12||12,t,2)}function w1e(e,t){return Qr(1+H_.count(gc(e),e),t,3)}function CW(e,t){return Qr(e.getMilliseconds(),t,3)}function S1e(e,t){return CW(e,t)+"000"}function T1e(e,t){return Qr(e.getMonth()+1,t,2)}function E1e(e,t){return Qr(e.getMinutes(),t,2)}function A1e(e,t){return Qr(e.getSeconds(),t,2)}function P1e(e){var t=e.getDay();return t===0?7:t}function C1e(e,t){return Qr(_S.count(gc(e)-1,e),t,2)}function kW(e){var t=e.getDay();return t>=4||t===0?Xp(e):Xp.ceil(e)}function k1e(e,t){return e=kW(e),Qr(Xp.count(gc(e),e)+(gc(e).getDay()===4),t,2)}function O1e(e){return e.getDay()}function M1e(e,t){return Qr(Bw.count(gc(e)-1,e),t,2)}function I1e(e,t){return Qr(e.getFullYear()%100,t,2)}function R1e(e,t){return e=kW(e),Qr(e.getFullYear()%100,t,2)}function D1e(e,t){return Qr(e.getFullYear()%1e4,t,4)}function L1e(e,t){var r=e.getDay();return e=r>=4||r===0?Xp(e):Xp.ceil(e),Qr(e.getFullYear()%1e4,t,4)}function j1e(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Qr(t/60|0,"0",2)+Qr(t%60,"0",2)}function P$(e,t){return Qr(e.getUTCDate(),t,2)}function z1e(e,t){return Qr(e.getUTCHours(),t,2)}function B1e(e,t){return Qr(e.getUTCHours()%12||12,t,2)}function N1e(e,t){return Qr(1+vS.count(yc(e),e),t,3)}function OW(e,t){return Qr(e.getUTCMilliseconds(),t,3)}function $1e(e,t){return OW(e,t)+"000"}function F1e(e,t){return Qr(e.getUTCMonth()+1,t,2)}function U1e(e,t){return Qr(e.getUTCMinutes(),t,2)}function V1e(e,t){return Qr(e.getUTCSeconds(),t,2)}function G1e(e){var t=e.getUTCDay();return t===0?7:t}function W1e(e,t){return Qr(xS.count(yc(e)-1,e),t,2)}function MW(e){var t=e.getUTCDay();return t>=4||t===0?Yp(e):Yp.ceil(e)}function q1e(e,t){return e=MW(e),Qr(Yp.count(yc(e),e)+(yc(e).getUTCDay()===4),t,2)}function H1e(e){return e.getUTCDay()}function K1e(e,t){return Qr(Nw.count(yc(e)-1,e),t,2)}function Z1e(e,t){return Qr(e.getUTCFullYear()%100,t,2)}function X1e(e,t){return e=MW(e),Qr(e.getUTCFullYear()%100,t,2)}function Y1e(e,t){return Qr(e.getUTCFullYear()%1e4,t,4)}function J1e(e,t){var r=e.getUTCDay();return e=r>=4||r===0?Yp(e):Yp.ceil(e),Qr(e.getUTCFullYear()%1e4,t,4)}function Q1e(){return"+0000"}function C$(){return"%"}function k$(e){return+e}function O$(e){return Math.floor(+e/1e3)}var qf,IW,RW;eSe({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function eSe(e){return qf=e1e(e),IW=qf.format,qf.parse,RW=qf.utcFormat,qf.utcParse,qf}function tSe(e){return new Date(e)}function rSe(e){return e instanceof Date?+e:+new Date(+e)}function tR(e,t,r,n,o,l,h,f,s,y){var b=FI(),w=b.invert,A=b.domain,k=y(".%L"),M=y(":%S"),R=y("%I:%M"),j=y("%I %p"),L=y("%a %d"),z=y("%b %d"),B=y("%B"),Z=y("%Y");function F(H){return(s(H)<H?k:f(H)<H?M:h(H)<H?R:l(H)<H?j:n(H)<H?o(H)<H?L:z:r(H)<H?B:Z)(H)}return b.invert=function(H){return new Date(w(H))},b.domain=function(H){return arguments.length?A(Array.from(H,rSe)):A().map(tSe)},b.ticks=function(H){var Y=A();return e(Y[0],Y[Y.length-1],H??10)},b.tickFormat=function(H,Y){return Y==null?F:y(Y)},b.nice=function(H){var Y=A();return(!H||typeof H.range!="function")&&(H=t(Y[0],Y[Y.length-1],H??10)),H?A(_W(Y,H)):b},b.copy=function(){return q_(b,tR(e,t,r,n,o,l,h,f,s,y))},b}function nSe(){return sa.apply(tR(Jwe,Qwe,gc,QI,_S,H_,YI,ZI,id,IW).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function iSe(){return sa.apply(tR(Xwe,Ywe,yc,eR,xS,vS,JI,XI,id,RW).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function bS(){var e=0,t=1,r,n,o,l,h=Lo,f=!1,s;function y(w){return w==null||isNaN(w=+w)?s:h(o===0?.5:(w=(l(w)-r)*o,f?Math.max(0,Math.min(1,w)):w))}y.domain=function(w){return arguments.length?([e,t]=w,r=l(e=+e),n=l(t=+t),o=r===n?0:1/(n-r),y):[e,t]},y.clamp=function(w){return arguments.length?(f=!!w,y):f},y.interpolator=function(w){return arguments.length?(h=w,y):h};function b(w){return function(A){var k,M;return arguments.length?([k,M]=A,h=w(k,M),y):[h(0),h(1)]}}return y.range=b(zm),y.rangeRound=b($I),y.unknown=function(w){return arguments.length?(s=w,y):s},function(w){return l=w,r=w(e),n=w(t),o=r===n?0:1/(n-r),y}}function Ku(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function DW(){var e=Hu(bS()(Lo));return e.copy=function(){return Ku(e,DW())},Tc.apply(e,arguments)}function LW(){var e=GI(bS()).domain([1,10]);return e.copy=function(){return Ku(e,LW()).base(e.base())},Tc.apply(e,arguments)}function jW(){var e=WI(bS());return e.copy=function(){return Ku(e,jW()).constant(e.constant())},Tc.apply(e,arguments)}function rR(){var e=qI(bS());return e.copy=function(){return Ku(e,rR()).exponent(e.exponent())},Tc.apply(e,arguments)}function oSe(){return rR.apply(null,arguments).exponent(.5)}function zW(){var e=[],t=Lo;function r(n){if(n!=null&&!isNaN(n=+n))return t((G_(e,n,1)-1)/(e.length-1))}return r.domain=function(n){if(!arguments.length)return e.slice();e=[];for(let o of n)o!=null&&!isNaN(o=+o)&&e.push(o);return e.sort(Iu),r},r.interpolator=function(n){return arguments.length?(t=n,r):t},r.range=function(){return e.map((n,o)=>t(o/(e.length-1)))},r.quantiles=function(n){return Array.from({length:n+1},(o,l)=>Wbe(e,l/n))},r.copy=function(){return zW(t).domain(e)},Tc.apply(r,arguments)}function wS(){var e=0,t=.5,r=1,n=1,o,l,h,f,s,y=Lo,b,w=!1,A;function k(R){return isNaN(R=+R)?A:(R=.5+((R=+b(R))-l)*(n*R<n*l?f:s),y(w?Math.max(0,Math.min(1,R)):R))}k.domain=function(R){return arguments.length?([e,t,r]=R,o=b(e=+e),l=b(t=+t),h=b(r=+r),f=o===l?0:.5/(l-o),s=l===h?0:.5/(h-l),n=l<o?-1:1,k):[e,t,r]},k.clamp=function(R){return arguments.length?(w=!!R,k):w},k.interpolator=function(R){return arguments.length?(y=R,k):y};function M(R){return function(j){var L,z,B;return arguments.length?([L,z,B]=j,y=ywe(R,[L,z,B]),k):[y(0),y(.5),y(1)]}}return k.range=M(zm),k.rangeRound=M($I),k.unknown=function(R){return arguments.length?(A=R,k):A},function(R){return b=R,o=R(e),l=R(t),h=R(r),f=o===l?0:.5/(l-o),s=l===h?0:.5/(h-l),n=l<o?-1:1,k}}function BW(){var e=Hu(wS()(Lo));return e.copy=function(){return Ku(e,BW())},Tc.apply(e,arguments)}function NW(){var e=GI(wS()).domain([.1,1,10]);return e.copy=function(){return Ku(e,NW()).base(e.base())},Tc.apply(e,arguments)}function $W(){var e=WI(wS());return e.copy=function(){return Ku(e,$W()).constant(e.constant())},Tc.apply(e,arguments)}function nR(){var e=qI(wS());return e.copy=function(){return Ku(e,nR()).exponent(e.exponent())},Tc.apply(e,arguments)}function sSe(){return nR.apply(null,arguments).exponent(.5)}const M$=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:e_,scaleDiverging:BW,scaleDivergingLog:NW,scaleDivergingPow:nR,scaleDivergingSqrt:sSe,scaleDivergingSymlog:$W,scaleIdentity:vW,scaleImplicit:yk,scaleLinear:jw,scaleLog:xW,scaleOrdinal:zI,scalePoint:cv,scalePow:HI,scaleQuantile:SW,scaleQuantize:TW,scaleRadial:wW,scaleSequential:DW,scaleSequentialLog:LW,scaleSequentialPow:rR,scaleSequentialQuantile:zW,scaleSequentialSqrt:oSe,scaleSequentialSymlog:jW,scaleSqrt:$we,scaleSymlog:bW,scaleThreshold:EW,scaleTime:nSe,scaleUtc:iSe,tickFormat:yW},Symbol.toStringTag,{value:"Module"}));var aSe=Cm;function lSe(e,t,r){for(var n=-1,o=e.length;++n<o;){var l=e[n],h=t(l);if(h!=null&&(f===void 0?h===h&&!aSe(h):r(h,f)))var f=h,s=l}return s}var FW=lSe;function cSe(e,t){return e>t}var uSe=cSe,hSe=FW,dSe=uSe,fSe=jm;function pSe(e){return e&&e.length?hSe(e,fSe,dSe):void 0}var mSe=pSe;const _u=mn(mSe);function gSe(e,t){return e<t}var ySe=gSe,vSe=FW,_Se=ySe,xSe=jm;function bSe(e){return e&&e.length?vSe(e,xSe,_Se):void 0}var wSe=bSe;const SS=mn(wSe);var SSe=yI,TSe=Wu,ESe=XG,ASe=ss;function PSe(e,t){var r=ASe(e)?SSe:ESe;return r(e,TSe(t))}var CSe=PSe,kSe=KG,OSe=CSe;function MSe(e,t){return kSe(OSe(e,t),1)}var ISe=MSe;const RSe=mn(ISe);var DSe=MI;function LSe(e,t){return DSe(e,t)}var jSe=LSe;const Sd=mn(jSe);var Bm=1e9,zSe={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},oR,Vn=!0,ia="[DecimalError] ",fd=ia+"Invalid argument: ",iR=ia+"Exponent out of range: ",Nm=Math.floor,Wh=Math.pow,BSe=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,Es,Wi=1e7,Rn=7,UW=9007199254740991,$w=Nm(UW/Rn),Kt={};Kt.absoluteValue=Kt.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};Kt.comparedTo=Kt.cmp=function(e){var t,r,n,o,l=this;if(e=new l.constructor(e),l.s!==e.s)return l.s||-e.s;if(l.e!==e.e)return l.e>e.e^l.s<0?1:-1;for(n=l.d.length,o=e.d.length,t=0,r=n<o?n:o;t<r;++t)if(l.d[t]!==e.d[t])return l.d[t]>e.d[t]^l.s<0?1:-1;return n===o?0:n>o^l.s<0?1:-1};Kt.decimalPlaces=Kt.dp=function(){var e=this,t=e.d.length-1,r=(t-e.e)*Rn;if(t=e.d[t],t)for(;t%10==0;t/=10)r--;return r<0?0:r};Kt.dividedBy=Kt.div=function(e){return lc(this,new this.constructor(e))};Kt.dividedToIntegerBy=Kt.idiv=function(e){var t=this,r=t.constructor;return bn(lc(t,new r(e),0,1),r.precision)};Kt.equals=Kt.eq=function(e){return!this.cmp(e)};Kt.exponent=function(){return bi(this)};Kt.greaterThan=Kt.gt=function(e){return this.cmp(e)>0};Kt.greaterThanOrEqualTo=Kt.gte=function(e){return this.cmp(e)>=0};Kt.isInteger=Kt.isint=function(){return this.e>this.d.length-2};Kt.isNegative=Kt.isneg=function(){return this.s<0};Kt.isPositive=Kt.ispos=function(){return this.s>0};Kt.isZero=function(){return this.s===0};Kt.lessThan=Kt.lt=function(e){return this.cmp(e)<0};Kt.lessThanOrEqualTo=Kt.lte=function(e){return this.cmp(e)<1};Kt.logarithm=Kt.log=function(e){var t,r=this,n=r.constructor,o=n.precision,l=o+5;if(e===void 0)e=new n(10);else if(e=new n(e),e.s<1||e.eq(Es))throw Error(ia+"NaN");if(r.s<1)throw Error(ia+(r.s?"NaN":"-Infinity"));return r.eq(Es)?new n(0):(Vn=!1,t=lc(o_(r,l),o_(e,l),l),Vn=!0,bn(t,o))};Kt.minus=Kt.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?WW(t,e):VW(t,(e.s=-e.s,e))};Kt.modulo=Kt.mod=function(e){var t,r=this,n=r.constructor,o=n.precision;if(e=new n(e),!e.s)throw Error(ia+"NaN");return r.s?(Vn=!1,t=lc(r,e,0,1).times(e),Vn=!0,r.minus(t)):bn(new n(r),o)};Kt.naturalExponential=Kt.exp=function(){return GW(this)};Kt.naturalLogarithm=Kt.ln=function(){return o_(this)};Kt.negated=Kt.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};Kt.plus=Kt.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?VW(t,e):WW(t,(e.s=-e.s,e))};Kt.precision=Kt.sd=function(e){var t,r,n,o=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(fd+e);if(t=bi(o)+1,n=o.d.length-1,r=n*Rn+1,n=o.d[n],n){for(;n%10==0;n/=10)r--;for(n=o.d[0];n>=10;n/=10)r++}return e&&t>r?t:r};Kt.squareRoot=Kt.sqrt=function(){var e,t,r,n,o,l,h,f=this,s=f.constructor;if(f.s<1){if(!f.s)return new s(0);throw Error(ia+"NaN")}for(e=bi(f),Vn=!1,o=Math.sqrt(+f),o==0||o==1/0?(t=ml(f.d),(t.length+e)%2==0&&(t+="0"),o=Math.sqrt(t),e=Nm((e+1)/2)-(e<0||e%2),o==1/0?t="5e"+e:(t=o.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),n=new s(t)):n=new s(o.toString()),r=s.precision,o=h=r+3;;)if(l=n,n=l.plus(lc(f,l,h+2)).times(.5),ml(l.d).slice(0,h)===(t=ml(n.d)).slice(0,h)){if(t=t.slice(h-3,h+1),o==h&&t=="4999"){if(bn(l,r+1,0),l.times(l).eq(f)){n=l;break}}else if(t!="9999")break;h+=4}return Vn=!0,bn(n,r)};Kt.times=Kt.mul=function(e){var t,r,n,o,l,h,f,s,y,b=this,w=b.constructor,A=b.d,k=(e=new w(e)).d;if(!b.s||!e.s)return new w(0);for(e.s*=b.s,r=b.e+e.e,s=A.length,y=k.length,s<y&&(l=A,A=k,k=l,h=s,s=y,y=h),l=[],h=s+y,n=h;n--;)l.push(0);for(n=y;--n>=0;){for(t=0,o=s+n;o>n;)f=l[o]+k[n]*A[o-n-1]+t,l[o--]=f%Wi|0,t=f/Wi|0;l[o]=(l[o]+t)%Wi|0}for(;!l[--h];)l.pop();return t?++r:l.shift(),e.d=l,e.e=r,Vn?bn(e,w.precision):e};Kt.toDecimalPlaces=Kt.todp=function(e,t){var r=this,n=r.constructor;return r=new n(r),e===void 0?r:(Cl(e,0,Bm),t===void 0?t=n.rounding:Cl(t,0,8),bn(r,e+bi(r)+1,t))};Kt.toExponential=function(e,t){var r,n=this,o=n.constructor;return e===void 0?r=Td(n,!0):(Cl(e,0,Bm),t===void 0?t=o.rounding:Cl(t,0,8),n=bn(new o(n),e+1,t),r=Td(n,!0,e+1)),r};Kt.toFixed=function(e,t){var r,n,o=this,l=o.constructor;return e===void 0?Td(o):(Cl(e,0,Bm),t===void 0?t=l.rounding:Cl(t,0,8),n=bn(new l(o),e+bi(o)+1,t),r=Td(n.abs(),!1,e+bi(n)+1),o.isneg()&&!o.isZero()?"-"+r:r)};Kt.toInteger=Kt.toint=function(){var e=this,t=e.constructor;return bn(new t(e),bi(e)+1,t.rounding)};Kt.toNumber=function(){return+this};Kt.toPower=Kt.pow=function(e){var t,r,n,o,l,h,f=this,s=f.constructor,y=12,b=+(e=new s(e));if(!e.s)return new s(Es);if(f=new s(f),!f.s){if(e.s<1)throw Error(ia+"Infinity");return f}if(f.eq(Es))return f;if(n=s.precision,e.eq(Es))return bn(f,n);if(t=e.e,r=e.d.length-1,h=t>=r,l=f.s,h){if((r=b<0?-b:b)<=UW){for(o=new s(Es),t=Math.ceil(n/Rn+4),Vn=!1;r%2&&(o=o.times(f),R$(o.d,t)),r=Nm(r/2),r!==0;)f=f.times(f),R$(f.d,t);return Vn=!0,e.s<0?new s(Es).div(o):bn(o,n)}}else if(l<0)throw Error(ia+"NaN");return l=l<0&&e.d[Math.max(t,r)]&1?-1:1,f.s=1,Vn=!1,o=e.times(o_(f,n+y)),Vn=!0,o=GW(o),o.s=l,o};Kt.toPrecision=function(e,t){var r,n,o=this,l=o.constructor;return e===void 0?(r=bi(o),n=Td(o,r<=l.toExpNeg||r>=l.toExpPos)):(Cl(e,1,Bm),t===void 0?t=l.rounding:Cl(t,0,8),o=bn(new l(o),e,t),r=bi(o),n=Td(o,e<=r||r<=l.toExpNeg,e)),n};Kt.toSignificantDigits=Kt.tosd=function(e,t){var r=this,n=r.constructor;return e===void 0?(e=n.precision,t=n.rounding):(Cl(e,1,Bm),t===void 0?t=n.rounding:Cl(t,0,8)),bn(new n(r),e,t)};Kt.toString=Kt.valueOf=Kt.val=Kt.toJSON=Kt[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=bi(e),r=e.constructor;return Td(e,t<=r.toExpNeg||t>=r.toExpPos)};function VW(e,t){var r,n,o,l,h,f,s,y,b=e.constructor,w=b.precision;if(!e.s||!t.s)return t.s||(t=new b(e)),Vn?bn(t,w):t;if(s=e.d,y=t.d,h=e.e,o=t.e,s=s.slice(),l=h-o,l){for(l<0?(n=s,l=-l,f=y.length):(n=y,o=h,f=s.length),h=Math.ceil(w/Rn),f=h>f?h+1:f+1,l>f&&(l=f,n.length=1),n.reverse();l--;)n.push(0);n.reverse()}for(f=s.length,l=y.length,f-l<0&&(l=f,n=y,y=s,s=n),r=0;l;)r=(s[--l]=s[l]+y[l]+r)/Wi|0,s[l]%=Wi;for(r&&(s.unshift(r),++o),f=s.length;s[--f]==0;)s.pop();return t.d=s,t.e=o,Vn?bn(t,w):t}function Cl(e,t,r){if(e!==~~e||e<t||e>r)throw Error(fd+e)}function ml(e){var t,r,n,o=e.length-1,l="",h=e[0];if(o>0){for(l+=h,t=1;t<o;t++)n=e[t]+"",r=Rn-n.length,r&&(l+=uu(r)),l+=n;h=e[t],n=h+"",r=Rn-n.length,r&&(l+=uu(r))}else if(h===0)return"0";for(;h%10===0;)h/=10;return l+h}var lc=function(){function e(n,o){var l,h=0,f=n.length;for(n=n.slice();f--;)l=n[f]*o+h,n[f]=l%Wi|0,h=l/Wi|0;return h&&n.unshift(h),n}function t(n,o,l,h){var f,s;if(l!=h)s=l>h?1:-1;else for(f=s=0;f<l;f++)if(n[f]!=o[f]){s=n[f]>o[f]?1:-1;break}return s}function r(n,o,l){for(var h=0;l--;)n[l]-=h,h=n[l]<o[l]?1:0,n[l]=h*Wi+n[l]-o[l];for(;!n[0]&&n.length>1;)n.shift()}return function(n,o,l,h){var f,s,y,b,w,A,k,M,R,j,L,z,B,Z,F,H,Y,te,pe=n.constructor,ue=n.s==o.s?1:-1,Ee=n.d,Oe=o.d;if(!n.s)return new pe(n);if(!o.s)throw Error(ia+"Division by zero");for(s=n.e-o.e,Y=Oe.length,F=Ee.length,k=new pe(ue),M=k.d=[],y=0;Oe[y]==(Ee[y]||0);)++y;if(Oe[y]>(Ee[y]||0)&&--s,l==null?z=l=pe.precision:h?z=l+(bi(n)-bi(o))+1:z=l,z<0)return new pe(0);if(z=z/Rn+2|0,y=0,Y==1)for(b=0,Oe=Oe[0],z++;(y<F||b)&&z--;y++)B=b*Wi+(Ee[y]||0),M[y]=B/Oe|0,b=B%Oe|0;else{for(b=Wi/(Oe[0]+1)|0,b>1&&(Oe=e(Oe,b),Ee=e(Ee,b),Y=Oe.length,F=Ee.length),Z=Y,R=Ee.slice(0,Y),j=R.length;j<Y;)R[j++]=0;te=Oe.slice(),te.unshift(0),H=Oe[0],Oe[1]>=Wi/2&&++H;do b=0,f=t(Oe,R,Y,j),f<0?(L=R[0],Y!=j&&(L=L*Wi+(R[1]||0)),b=L/H|0,b>1?(b>=Wi&&(b=Wi-1),w=e(Oe,b),A=w.length,j=R.length,f=t(w,R,A,j),f==1&&(b--,r(w,Y<A?te:Oe,A))):(b==0&&(f=b=1),w=Oe.slice()),A=w.length,A<j&&w.unshift(0),r(R,w,j),f==-1&&(j=R.length,f=t(Oe,R,Y,j),f<1&&(b++,r(R,Y<j?te:Oe,j))),j=R.length):f===0&&(b++,R=[0]),M[y++]=b,f&&R[0]?R[j++]=Ee[Z]||0:(R=[Ee[Z]],j=1);while((Z++<F||R[0]!==void 0)&&z--)}return M[0]||M.shift(),k.e=s,bn(k,h?l+bi(k)+1:l)}}();function GW(e,t){var r,n,o,l,h,f,s=0,y=0,b=e.constructor,w=b.precision;if(bi(e)>16)throw Error(iR+bi(e));if(!e.s)return new b(Es);for(Vn=!1,f=w,h=new b(.03125);e.abs().gte(.1);)e=e.times(h),y+=5;for(n=Math.log(Wh(2,y))/Math.LN10*2+5|0,f+=n,r=o=l=new b(Es),b.precision=f;;){if(o=bn(o.times(e),f),r=r.times(++s),h=l.plus(lc(o,r,f)),ml(h.d).slice(0,f)===ml(l.d).slice(0,f)){for(;y--;)l=bn(l.times(l),f);return b.precision=w,t==null?(Vn=!0,bn(l,w)):l}l=h}}function bi(e){for(var t=e.e*Rn,r=e.d[0];r>=10;r/=10)t++;return t}function FA(e,t,r){if(t>e.LN10.sd())throw Vn=!0,r&&(e.precision=r),Error(ia+"LN10 precision limit exceeded");return bn(new e(e.LN10),t)}function uu(e){for(var t="";e--;)t+="0";return t}function o_(e,t){var r,n,o,l,h,f,s,y,b,w=1,A=10,k=e,M=k.d,R=k.constructor,j=R.precision;if(k.s<1)throw Error(ia+(k.s?"NaN":"-Infinity"));if(k.eq(Es))return new R(0);if(t==null?(Vn=!1,y=j):y=t,k.eq(10))return t==null&&(Vn=!0),FA(R,y);if(y+=A,R.precision=y,r=ml(M),n=r.charAt(0),l=bi(k),Math.abs(l)<15e14){for(;n<7&&n!=1||n==1&&r.charAt(1)>3;)k=k.times(e),r=ml(k.d),n=r.charAt(0),w++;l=bi(k),n>1?(k=new R("0."+r),l++):k=new R(n+"."+r.slice(1))}else return s=FA(R,y+2,j).times(l+""),k=o_(new R(n+"."+r.slice(1)),y-A).plus(s),R.precision=j,t==null?(Vn=!0,bn(k,j)):k;for(f=h=k=lc(k.minus(Es),k.plus(Es),y),b=bn(k.times(k),y),o=3;;){if(h=bn(h.times(b),y),s=f.plus(lc(h,new R(o),y)),ml(s.d).slice(0,y)===ml(f.d).slice(0,y))return f=f.times(2),l!==0&&(f=f.plus(FA(R,y+2,j).times(l+""))),f=lc(f,new R(w),y),R.precision=j,t==null?(Vn=!0,bn(f,j)):f;f=s,o+=2}}function I$(e,t){var r,n,o;for((r=t.indexOf("."))>-1&&(t=t.replace(".","")),(n=t.search(/e/i))>0?(r<0&&(r=n),r+=+t.slice(n+1),t=t.substring(0,n)):r<0&&(r=t.length),n=0;t.charCodeAt(n)===48;)++n;for(o=t.length;t.charCodeAt(o-1)===48;)--o;if(t=t.slice(n,o),t){if(o-=n,r=r-n-1,e.e=Nm(r/Rn),e.d=[],n=(r+1)%Rn,r<0&&(n+=Rn),n<o){for(n&&e.d.push(+t.slice(0,n)),o-=Rn;n<o;)e.d.push(+t.slice(n,n+=Rn));t=t.slice(n),n=Rn-t.length}else n-=o;for(;n--;)t+="0";if(e.d.push(+t),Vn&&(e.e>$w||e.e<-$w))throw Error(iR+r)}else e.s=0,e.e=0,e.d=[0];return e}function bn(e,t,r){var n,o,l,h,f,s,y,b,w=e.d;for(h=1,l=w[0];l>=10;l/=10)h++;if(n=t-h,n<0)n+=Rn,o=t,y=w[b=0];else{if(b=Math.ceil((n+1)/Rn),l=w.length,b>=l)return e;for(y=l=w[b],h=1;l>=10;l/=10)h++;n%=Rn,o=n-Rn+h}if(r!==void 0&&(l=Wh(10,h-o-1),f=y/l%10|0,s=t<0||w[b+1]!==void 0||y%l,s=r<4?(f||s)&&(r==0||r==(e.s<0?3:2)):f>5||f==5&&(r==4||s||r==6&&(n>0?o>0?y/Wh(10,h-o):0:w[b-1])%10&1||r==(e.s<0?8:7))),t<1||!w[0])return s?(l=bi(e),w.length=1,t=t-l-1,w[0]=Wh(10,(Rn-t%Rn)%Rn),e.e=Nm(-t/Rn)||0):(w.length=1,w[0]=e.e=e.s=0),e;if(n==0?(w.length=b,l=1,b--):(w.length=b+1,l=Wh(10,Rn-n),w[b]=o>0?(y/Wh(10,h-o)%Wh(10,o)|0)*l:0),s)for(;;)if(b==0){(w[0]+=l)==Wi&&(w[0]=1,++e.e);break}else{if(w[b]+=l,w[b]!=Wi)break;w[b--]=0,l=1}for(n=w.length;w[--n]===0;)w.pop();if(Vn&&(e.e>$w||e.e<-$w))throw Error(iR+bi(e));return e}function WW(e,t){var r,n,o,l,h,f,s,y,b,w,A=e.constructor,k=A.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new A(e),Vn?bn(t,k):t;if(s=e.d,w=t.d,n=t.e,y=e.e,s=s.slice(),h=y-n,h){for(b=h<0,b?(r=s,h=-h,f=w.length):(r=w,n=y,f=s.length),o=Math.max(Math.ceil(k/Rn),f)+2,h>o&&(h=o,r.length=1),r.reverse(),o=h;o--;)r.push(0);r.reverse()}else{for(o=s.length,f=w.length,b=o<f,b&&(f=o),o=0;o<f;o++)if(s[o]!=w[o]){b=s[o]<w[o];break}h=0}for(b&&(r=s,s=w,w=r,t.s=-t.s),f=s.length,o=w.length-f;o>0;--o)s[f++]=0;for(o=w.length;o>h;){if(s[--o]<w[o]){for(l=o;l&&s[--l]===0;)s[l]=Wi-1;--s[l],s[o]+=Wi}s[o]-=w[o]}for(;s[--f]===0;)s.pop();for(;s[0]===0;s.shift())--n;return s[0]?(t.d=s,t.e=n,Vn?bn(t,k):t):new A(0)}function Td(e,t,r){var n,o=bi(e),l=ml(e.d),h=l.length;return t?(r&&(n=r-h)>0?l=l.charAt(0)+"."+l.slice(1)+uu(n):h>1&&(l=l.charAt(0)+"."+l.slice(1)),l=l+(o<0?"e":"e+")+o):o<0?(l="0."+uu(-o-1)+l,r&&(n=r-h)>0&&(l+=uu(n))):o>=h?(l+=uu(o+1-h),r&&(n=r-o-1)>0&&(l=l+"."+uu(n))):((n=o+1)<h&&(l=l.slice(0,n)+"."+l.slice(n)),r&&(n=r-h)>0&&(o+1===h&&(l+="."),l+=uu(n))),e.s<0?"-"+l:l}function R$(e,t){if(e.length>t)return e.length=t,!0}function qW(e){var t,r,n;function o(l){var h=this;if(!(h instanceof o))return new o(l);if(h.constructor=o,l instanceof o){h.s=l.s,h.e=l.e,h.d=(l=l.d)?l.slice():l;return}if(typeof l=="number"){if(l*0!==0)throw Error(fd+l);if(l>0)h.s=1;else if(l<0)l=-l,h.s=-1;else{h.s=0,h.e=0,h.d=[0];return}if(l===~~l&&l<1e7){h.e=0,h.d=[l];return}return I$(h,l.toString())}else if(typeof l!="string")throw Error(fd+l);if(l.charCodeAt(0)===45?(l=l.slice(1),h.s=-1):h.s=1,BSe.test(l))I$(h,l);else throw Error(fd+l)}if(o.prototype=Kt,o.ROUND_UP=0,o.ROUND_DOWN=1,o.ROUND_CEIL=2,o.ROUND_FLOOR=3,o.ROUND_HALF_UP=4,o.ROUND_HALF_DOWN=5,o.ROUND_HALF_EVEN=6,o.ROUND_HALF_CEIL=7,o.ROUND_HALF_FLOOR=8,o.clone=qW,o.config=o.set=NSe,e===void 0&&(e={}),e)for(n=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<n.length;)e.hasOwnProperty(r=n[t++])||(e[r]=this[r]);return o.config(e),o}function NSe(e){if(!e||typeof e!="object")throw Error(ia+"Object expected");var t,r,n,o=["precision",1,Bm,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<o.length;t+=3)if((n=e[r=o[t]])!==void 0)if(Nm(n)===n&&n>=o[t+1]&&n<=o[t+2])this[r]=n;else throw Error(fd+r+": "+n);if((n=e[r="LN10"])!==void 0)if(n==Math.LN10)this[r]=new this(n);else throw Error(fd+r+": "+n);return this}var oR=qW(zSe);Es=new oR(1);const _n=oR;function $Se(e){return GSe(e)||VSe(e)||USe(e)||FSe()}function FSe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function USe(e,t){if(e){if(typeof e=="string")return bk(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return bk(e,t)}}function VSe(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function GSe(e){if(Array.isArray(e))return bk(e)}function bk(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var WSe=function(t){return t},HW={},KW=function(t){return t===HW},D$=function(t){return function r(){return arguments.length===0||arguments.length===1&&KW(arguments.length<=0?void 0:arguments[0])?r:t.apply(void 0,arguments)}},qSe=function e(t,r){return t===1?r:D$(function(){for(var n=arguments.length,o=new Array(n),l=0;l<n;l++)o[l]=arguments[l];var h=o.filter(function(f){return f!==HW}).length;return h>=t?r.apply(void 0,o):e(t-h,D$(function(){for(var f=arguments.length,s=new Array(f),y=0;y<f;y++)s[y]=arguments[y];var b=o.map(function(w){return KW(w)?s.shift():w});return r.apply(void 0,$Se(b).concat(s))}))})},TS=function(t){return qSe(t.length,t)},wk=function(t,r){for(var n=[],o=t;o<r;++o)n[o-t]=o;return n},HSe=TS(function(e,t){return Array.isArray(t)?t.map(e):Object.keys(t).map(function(r){return t[r]}).map(e)}),KSe=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];if(!r.length)return WSe;var o=r.reverse(),l=o[0],h=o.slice(1);return function(){return h.reduce(function(f,s){return s(f)},l.apply(void 0,arguments))}},Sk=function(t){return Array.isArray(t)?t.reverse():t.split("").reverse.join("")},ZW=function(t){var r=null,n=null;return function(){for(var o=arguments.length,l=new Array(o),h=0;h<o;h++)l[h]=arguments[h];return r&&l.every(function(f,s){return f===r[s]})||(r=l,n=t.apply(void 0,l)),n}};function ZSe(e){var t;return e===0?t=1:t=Math.floor(new _n(e).abs().log(10).toNumber())+1,t}function XSe(e,t,r){for(var n=new _n(e),o=0,l=[];n.lt(t)&&o<1e5;)l.push(n.toNumber()),n=n.add(r),o++;return l}var YSe=TS(function(e,t,r){var n=+e,o=+t;return n+r*(o-n)}),JSe=TS(function(e,t,r){var n=t-+e;return n=n||1/0,(r-e)/n}),QSe=TS(function(e,t,r){var n=t-+e;return n=n||1/0,Math.max(0,Math.min(1,(r-e)/n))});const ES={rangeStep:XSe,getDigitCount:ZSe,interpolateNumber:YSe,uninterpolateNumber:JSe,uninterpolateTruncation:QSe};function Tk(e){return rTe(e)||tTe(e)||XW(e)||eTe()}function eTe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function tTe(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function rTe(e){if(Array.isArray(e))return Ek(e)}function s_(e,t){return oTe(e)||iTe(e,t)||XW(e,t)||nTe()}function nTe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function XW(e,t){if(e){if(typeof e=="string")return Ek(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Ek(e,t)}}function Ek(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function iTe(e,t){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(e)))){var r=[],n=!0,o=!1,l=void 0;try{for(var h=e[Symbol.iterator](),f;!(n=(f=h.next()).done)&&(r.push(f.value),!(t&&r.length===t));n=!0);}catch(s){o=!0,l=s}finally{try{!n&&h.return!=null&&h.return()}finally{if(o)throw l}}return r}}function oTe(e){if(Array.isArray(e))return e}function YW(e){var t=s_(e,2),r=t[0],n=t[1],o=r,l=n;return r>n&&(o=n,l=r),[o,l]}function JW(e,t,r){if(e.lte(0))return new _n(0);var n=ES.getDigitCount(e.toNumber()),o=new _n(10).pow(n),l=e.div(o),h=n!==1?.05:.1,f=new _n(Math.ceil(l.div(h).toNumber())).add(r).mul(h),s=f.mul(o);return t?s:new _n(Math.ceil(s))}function sTe(e,t,r){var n=1,o=new _n(e);if(!o.isint()&&r){var l=Math.abs(e);l<1?(n=new _n(10).pow(ES.getDigitCount(e)-1),o=new _n(Math.floor(o.div(n).toNumber())).mul(n)):l>1&&(o=new _n(Math.floor(e)))}else e===0?o=new _n(Math.floor((t-1)/2)):r||(o=new _n(Math.floor(e)));var h=Math.floor((t-1)/2),f=KSe(HSe(function(s){return o.add(new _n(s-h).mul(n)).toNumber()}),wk);return f(0,t)}function QW(e,t,r,n){var o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((t-e)/(r-1)))return{step:new _n(0),tickMin:new _n(0),tickMax:new _n(0)};var l=JW(new _n(t).sub(e).div(r-1),n,o),h;e<=0&&t>=0?h=new _n(0):(h=new _n(e).add(t).div(2),h=h.sub(new _n(h).mod(l)));var f=Math.ceil(h.sub(e).div(l).toNumber()),s=Math.ceil(new _n(t).sub(h).div(l).toNumber()),y=f+s+1;return y>r?QW(e,t,r,n,o+1):(y<r&&(s=t>0?s+(r-y):s,f=t>0?f:f+(r-y)),{step:l,tickMin:h.sub(new _n(f).mul(l)),tickMax:h.add(new _n(s).mul(l))})}function aTe(e){var t=s_(e,2),r=t[0],n=t[1],o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,h=Math.max(o,2),f=YW([r,n]),s=s_(f,2),y=s[0],b=s[1];if(y===-1/0||b===1/0){var w=b===1/0?[y].concat(Tk(wk(0,o-1).map(function(){return 1/0}))):[].concat(Tk(wk(0,o-1).map(function(){return-1/0})),[b]);return r>n?Sk(w):w}if(y===b)return sTe(y,o,l);var A=QW(y,b,h,l),k=A.step,M=A.tickMin,R=A.tickMax,j=ES.rangeStep(M,R.add(new _n(.1).mul(k)),k);return r>n?Sk(j):j}function lTe(e,t){var r=s_(e,2),n=r[0],o=r[1],l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,h=YW([n,o]),f=s_(h,2),s=f[0],y=f[1];if(s===-1/0||y===1/0)return[n,o];if(s===y)return[s];var b=Math.max(t,2),w=JW(new _n(y).sub(s).div(b-1),l,0),A=[].concat(Tk(ES.rangeStep(new _n(s),new _n(y).sub(new _n(.99).mul(w)),w)),[y]);return n>o?Sk(A):A}var cTe=ZW(aTe),uTe=ZW(lTe),hTe="Invariant failed";function Ed(e,t){throw new Error(hTe)}var dTe=["offset","layout","width","dataKey","data","dataPointFormatter","xAxis","yAxis"];function Jp(e){"@babel/helpers - typeof";return Jp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Jp(e)}function Fw(){return Fw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Fw.apply(this,arguments)}function fTe(e,t){return yTe(e)||gTe(e,t)||mTe(e,t)||pTe()}function pTe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function mTe(e,t){if(e){if(typeof e=="string")return L$(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return L$(e,t)}}function L$(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function gTe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,l,h,f=[],s=!0,y=!1;try{if(l=(r=r.call(e)).next,t!==0)for(;!(s=(n=l.call(r)).done)&&(f.push(n.value),f.length!==t);s=!0);}catch(b){y=!0,o=b}finally{try{if(!s&&r.return!=null&&(h=r.return(),Object(h)!==h))return}finally{if(y)throw o}}return f}}function yTe(e){if(Array.isArray(e))return e}function vTe(e,t){if(e==null)return{};var r=_Te(e,t),n,o;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(o=0;o<l.length;o++)n=l[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function _Te(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function xTe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function bTe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,rq(n.key),n)}}function wTe(e,t,r){return t&&bTe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function STe(e,t,r){return t=Uw(t),TTe(e,eq()?Reflect.construct(t,r||[],Uw(e).constructor):t.apply(e,r))}function TTe(e,t){if(t&&(Jp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ETe(e)}function ETe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function eq(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(eq=function(){return!!e})()}function Uw(e){return Uw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Uw(e)}function ATe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ak(e,t)}function Ak(e,t){return Ak=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},Ak(e,t)}function tq(e,t,r){return t=rq(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function rq(e){var t=PTe(e,"string");return Jp(t)=="symbol"?t:t+""}function PTe(e,t){if(Jp(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Jp(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var $m=function(e){function t(){return xTe(this,t),STe(this,t,arguments)}return ATe(t,e),wTe(t,[{key:"render",value:function(){var n=this.props,o=n.offset,l=n.layout,h=n.width,f=n.dataKey,s=n.data,y=n.dataPointFormatter,b=n.xAxis,w=n.yAxis,A=vTe(n,dTe),k=Sr(A,!1);this.props.direction==="x"&&b.type!=="number"&&Ed();var M=s.map(function(R){var j=y(R,f),L=j.x,z=j.y,B=j.value,Z=j.errorVal;if(!Z)return null;var F=[],H,Y;if(Array.isArray(Z)){var te=fTe(Z,2);H=te[0],Y=te[1]}else H=Y=Z;if(l==="vertical"){var pe=b.scale,ue=z+o,Ee=ue+h,Oe=ue-h,je=pe(B-H),Ge=pe(B+Y);F.push({x1:Ge,y1:Ee,x2:Ge,y2:Oe}),F.push({x1:je,y1:ue,x2:Ge,y2:ue}),F.push({x1:je,y1:Ee,x2:je,y2:Oe})}else if(l==="horizontal"){var Ze=w.scale,Ye=L+o,tt=Ye-h,ze=Ye+h,De=Ze(B-H),ut=Ze(B+Y);F.push({x1:tt,y1:ut,x2:ze,y2:ut}),F.push({x1:Ye,y1:De,x2:Ye,y2:ut}),F.push({x1:tt,y1:De,x2:ze,y2:De})}return Ce.createElement(sn,Fw({className:"recharts-errorBar",key:"bar-".concat(F.map(function(ht){return"".concat(ht.x1,"-").concat(ht.x2,"-").concat(ht.y1,"-").concat(ht.y2)}))},k),F.map(function(ht){return Ce.createElement("line",Fw({},ht,{key:"line-".concat(ht.x1,"-").concat(ht.x2,"-").concat(ht.y1,"-").concat(ht.y2)}))}))});return Ce.createElement(sn,{className:"recharts-errorBars"},M)}}])}(Ce.Component);tq($m,"defaultProps",{stroke:"black",strokeWidth:1.5,width:5,offset:0,layout:"horizontal"});tq($m,"displayName","ErrorBar");function a_(e){"@babel/helpers - typeof";return a_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a_(e)}function j$(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function Bh(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?j$(Object(r),!0).forEach(function(n){CTe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):j$(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function CTe(e,t,r){return t=kTe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function kTe(e){var t=OTe(e,"string");return a_(t)=="symbol"?t:t+""}function OTe(e,t){if(a_(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(a_(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var nq=function(t){var r=t.children,n=t.formattedGraphicalItems,o=t.legendWidth,l=t.legendContent,h=bs(r,hd);if(!h)return null;var f=hd.defaultProps,s=f!==void 0?Bh(Bh({},f),h.props):{},y;return h.props&&h.props.payload?y=h.props&&h.props.payload:l==="children"?y=(n||[]).reduce(function(b,w){var A=w.item,k=w.props,M=k.sectors||k.data||[];return b.concat(M.map(function(R){return{type:h.props.iconType||A.props.legendType,value:R.name,color:R.fill,payload:R}}))},[]):y=(n||[]).map(function(b){var w=b.item,A=w.type.defaultProps,k=A!==void 0?Bh(Bh({},A),w.props):{},M=k.dataKey,R=k.name,j=k.legendType,L=k.hide;return{inactive:L,dataKey:M,type:s.iconType||j||"square",color:sR(w),value:R||M,payload:k}}),Bh(Bh(Bh({},s),hd.getWithHeight(h,o)),{},{payload:y,item:h})};function l_(e){"@babel/helpers - typeof";return l_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},l_(e)}function z$(e){return DTe(e)||RTe(e)||ITe(e)||MTe()}function MTe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ITe(e,t){if(e){if(typeof e=="string")return Pk(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Pk(e,t)}}function RTe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function DTe(e){if(Array.isArray(e))return Pk(e)}function Pk(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function B$(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function si(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?B$(Object(r),!0).forEach(function(n){Rp(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):B$(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Rp(e,t,r){return t=LTe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function LTe(e){var t=jTe(e,"string");return l_(t)=="symbol"?t:t+""}function jTe(e,t){if(l_(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(l_(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Li(e,t,r){return wr(e)||wr(t)?r:Di(t)?ta(e,t,r):Ar(t)?t(e):r}function uv(e,t,r,n){var o=RSe(e,function(f){return Li(f,t)});if(r==="number"){var l=o.filter(function(f){return It(f)||parseFloat(f)});return l.length?[SS(l),_u(l)]:[1/0,-1/0]}var h=n?o.filter(function(f){return!wr(f)}):o;return h.map(function(f){return Di(f)||f instanceof Date?f:""})}var zTe=function(t){var r,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],o=arguments.length>2?arguments[2]:void 0,l=arguments.length>3?arguments[3]:void 0,h=-1,f=(r=n==null?void 0:n.length)!==null&&r!==void 0?r:0;if(f<=1)return 0;if(l&&l.axisType==="angleAxis"&&Math.abs(Math.abs(l.range[1]-l.range[0])-360)<=1e-6)for(var s=l.range,y=0;y<f;y++){var b=y>0?o[y-1].coordinate:o[f-1].coordinate,w=o[y].coordinate,A=y>=f-1?o[0].coordinate:o[y+1].coordinate,k=void 0;if($a(w-b)!==$a(A-w)){var M=[];if($a(A-w)===$a(s[1]-s[0])){k=A;var R=w+s[1]-s[0];M[0]=Math.min(R,(R+b)/2),M[1]=Math.max(R,(R+b)/2)}else{k=b;var j=A+s[1]-s[0];M[0]=Math.min(w,(j+w)/2),M[1]=Math.max(w,(j+w)/2)}var L=[Math.min(w,(k+w)/2),Math.max(w,(k+w)/2)];if(t>L[0]&&t<=L[1]||t>=M[0]&&t<=M[1]){h=o[y].index;break}}else{var z=Math.min(b,A),B=Math.max(b,A);if(t>(z+w)/2&&t<=(B+w)/2){h=o[y].index;break}}}else for(var Z=0;Z<f;Z++)if(Z===0&&t<=(n[Z].coordinate+n[Z+1].coordinate)/2||Z>0&&Z<f-1&&t>(n[Z].coordinate+n[Z-1].coordinate)/2&&t<=(n[Z].coordinate+n[Z+1].coordinate)/2||Z===f-1&&t>(n[Z].coordinate+n[Z-1].coordinate)/2){h=n[Z].index;break}return h},sR=function(t){var r,n=t,o=n.type.displayName,l=(r=t.type)!==null&&r!==void 0&&r.defaultProps?si(si({},t.type.defaultProps),t.props):t.props,h=l.stroke,f=l.fill,s;switch(o){case"Line":s=h;break;case"Area":case"Radar":s=h&&h!=="none"?h:f;break;default:s=f;break}return s},BTe=function(t){var r=t.barSize,n=t.totalSize,o=t.stackGroups,l=o===void 0?{}:o;if(!l)return{};for(var h={},f=Object.keys(l),s=0,y=f.length;s<y;s++)for(var b=l[f[s]].stackGroups,w=Object.keys(b),A=0,k=w.length;A<k;A++){var M=b[w[A]],R=M.items,j=M.cateAxisId,L=R.filter(function(Y){return sc(Y.type).indexOf("Bar")>=0});if(L&&L.length){var z=L[0].type.defaultProps,B=z!==void 0?si(si({},z),L[0].props):L[0].props,Z=B.barSize,F=B[j];h[F]||(h[F]=[]);var H=wr(Z)?r:Z;h[F].push({item:L[0],stackList:L.slice(1),barSize:wr(H)?void 0:wd(H,n,0)})}}return h},NTe=function(t){var r=t.barGap,n=t.barCategoryGap,o=t.bandSize,l=t.sizeList,h=l===void 0?[]:l,f=t.maxBarSize,s=h.length;if(s<1)return null;var y=wd(r,o,0,!0),b,w=[];if(h[0].barSize===+h[0].barSize){var A=!1,k=o/s,M=h.reduce(function(Z,F){return Z+F.barSize||0},0);M+=(s-1)*y,M>=o&&(M-=(s-1)*y,y=0),M>=o&&k>0&&(A=!0,k*=.9,M=s*k);var R=(o-M)/2>>0,j={offset:R-y,size:0};b=h.reduce(function(Z,F){var H={item:F.item,position:{offset:j.offset+j.size+y,size:A?k:F.barSize}},Y=[].concat(z$(Z),[H]);return j=Y[Y.length-1].position,F.stackList&&F.stackList.length&&F.stackList.forEach(function(te){Y.push({item:te,position:j})}),Y},w)}else{var L=wd(n,o,0,!0);o-2*L-(s-1)*y<=0&&(y=0);var z=(o-2*L-(s-1)*y)/s;z>1&&(z>>=0);var B=f===+f?Math.min(z,f):z;b=h.reduce(function(Z,F,H){var Y=[].concat(z$(Z),[{item:F.item,position:{offset:L+(z+y)*H+(z-B)/2,size:B}}]);return F.stackList&&F.stackList.length&&F.stackList.forEach(function(te){Y.push({item:te,position:Y[Y.length-1].position})}),Y},w)}return b},$Te=function(t,r,n,o){var l=n.children,h=n.width,f=n.margin,s=h-(f.left||0)-(f.right||0),y=nq({children:l,legendWidth:s});if(y){var b=o||{},w=b.width,A=b.height,k=y.align,M=y.verticalAlign,R=y.layout;if((R==="vertical"||R==="horizontal"&&M==="middle")&&k!=="center"&&It(t[k]))return si(si({},t),{},Rp({},k,t[k]+(w||0)));if((R==="horizontal"||R==="vertical"&&k==="center")&&M!=="middle"&&It(t[M]))return si(si({},t),{},Rp({},M,t[M]+(A||0)))}return t},FTe=function(t,r,n){return wr(r)?!0:t==="horizontal"?r==="yAxis":t==="vertical"||n==="x"?r==="xAxis":n==="y"?r==="yAxis":!0},iq=function(t,r,n,o,l){var h=r.props.children,f=os(h,$m).filter(function(y){return FTe(o,l,y.props.direction)});if(f&&f.length){var s=f.map(function(y){return y.props.dataKey});return t.reduce(function(y,b){var w=Li(b,n);if(wr(w))return y;var A=Array.isArray(w)?[SS(w),_u(w)]:[w,w],k=s.reduce(function(M,R){var j=Li(b,R,0),L=A[0]-Math.abs(Array.isArray(j)?j[0]:j),z=A[1]+Math.abs(Array.isArray(j)?j[1]:j);return[Math.min(L,M[0]),Math.max(z,M[1])]},[1/0,-1/0]);return[Math.min(k[0],y[0]),Math.max(k[1],y[1])]},[1/0,-1/0])}return null},UTe=function(t,r,n,o,l){var h=r.map(function(f){return iq(t,f,n,l,o)}).filter(function(f){return!wr(f)});return h&&h.length?h.reduce(function(f,s){return[Math.min(f[0],s[0]),Math.max(f[1],s[1])]},[1/0,-1/0]):null},oq=function(t,r,n,o,l){var h=r.map(function(s){var y=s.props.dataKey;return n==="number"&&y&&iq(t,s,y,o)||uv(t,y,n,l)});if(n==="number")return h.reduce(function(s,y){return[Math.min(s[0],y[0]),Math.max(s[1],y[1])]},[1/0,-1/0]);var f={};return h.reduce(function(s,y){for(var b=0,w=y.length;b<w;b++)f[y[b]]||(f[y[b]]=!0,s.push(y[b]));return s},[])},sq=function(t,r){return t==="horizontal"&&r==="xAxis"||t==="vertical"&&r==="yAxis"||t==="centric"&&r==="angleAxis"||t==="radial"&&r==="radiusAxis"},aq=function(t,r,n,o){if(o)return t.map(function(s){return s.coordinate});var l,h,f=t.map(function(s){return s.coordinate===r&&(l=!0),s.coordinate===n&&(h=!0),s.coordinate});return l||f.push(r),h||f.push(n),f},nc=function(t,r,n){if(!t)return null;var o=t.scale,l=t.duplicateDomain,h=t.type,f=t.range,s=t.realScaleType==="scaleBand"?o.bandwidth()/2:2,y=(r||n)&&h==="category"&&o.bandwidth?o.bandwidth()/s:0;if(y=t.axisType==="angleAxis"&&(f==null?void 0:f.length)>=2?$a(f[0]-f[1])*2*y:y,r&&(t.ticks||t.niceTicks)){var b=(t.ticks||t.niceTicks).map(function(w){var A=l?l.indexOf(w):w;return{coordinate:o(A)+y,value:w,offset:y}});return b.filter(function(w){return!Rm(w.coordinate)})}return t.isCategorical&&t.categoricalDomain?t.categoricalDomain.map(function(w,A){return{coordinate:o(w)+y,value:w,index:A,offset:y}}):o.ticks&&!n?o.ticks(t.tickCount).map(function(w){return{coordinate:o(w)+y,value:w,offset:y}}):o.domain().map(function(w,A){return{coordinate:o(w)+y,value:l?l[w]:w,index:A,offset:y}})},UA=new WeakMap,Qx=function(t,r){if(typeof r!="function")return t;UA.has(t)||UA.set(t,new WeakMap);var n=UA.get(t);if(n.has(r))return n.get(r);var o=function(){t.apply(void 0,arguments),r.apply(void 0,arguments)};return n.set(r,o),o},VTe=function(t,r,n){var o=t.scale,l=t.type,h=t.layout,f=t.axisType;if(o==="auto")return h==="radial"&&f==="radiusAxis"?{scale:e_(),realScaleType:"band"}:h==="radial"&&f==="angleAxis"?{scale:jw(),realScaleType:"linear"}:l==="category"&&r&&(r.indexOf("LineChart")>=0||r.indexOf("AreaChart")>=0||r.indexOf("ComposedChart")>=0&&!n)?{scale:cv(),realScaleType:"point"}:l==="category"?{scale:e_(),realScaleType:"band"}:{scale:jw(),realScaleType:"linear"};if(bd(o)){var s="scale".concat(cS(o));return{scale:(M$[s]||cv)(),realScaleType:M$[s]?s:"point"}}return Ar(o)?{scale:o}:{scale:cv(),realScaleType:"point"}},N$=1e-4,GTe=function(t){var r=t.domain();if(!(!r||r.length<=2)){var n=r.length,o=t.range(),l=Math.min(o[0],o[1])-N$,h=Math.max(o[0],o[1])+N$,f=t(r[0]),s=t(r[n-1]);(f<l||f>h||s<l||s>h)&&t.domain([r[0],r[n-1]])}},WTe=function(t,r){if(!t)return null;for(var n=0,o=t.length;n<o;n++)if(t[n].item===r)return t[n].position;return null},qTe=function(t,r){if(!r||r.length!==2||!It(r[0])||!It(r[1]))return t;var n=Math.min(r[0],r[1]),o=Math.max(r[0],r[1]),l=[t[0],t[1]];return(!It(t[0])||t[0]<n)&&(l[0]=n),(!It(t[1])||t[1]>o)&&(l[1]=o),l[0]>o&&(l[0]=o),l[1]<n&&(l[1]=n),l},HTe=function(t){var r=t.length;if(!(r<=0))for(var n=0,o=t[0].length;n<o;++n)for(var l=0,h=0,f=0;f<r;++f){var s=Rm(t[f][n][1])?t[f][n][0]:t[f][n][1];s>=0?(t[f][n][0]=l,t[f][n][1]=l+s,l=t[f][n][1]):(t[f][n][0]=h,t[f][n][1]=h+s,h=t[f][n][1])}},KTe=function(t){var r=t.length;if(!(r<=0))for(var n=0,o=t[0].length;n<o;++n)for(var l=0,h=0;h<r;++h){var f=Rm(t[h][n][1])?t[h][n][0]:t[h][n][1];f>=0?(t[h][n][0]=l,t[h][n][1]=l+f,l=t[h][n][1]):(t[h][n][0]=0,t[h][n][1]=0)}},ZTe={sign:HTe,expand:ufe,none:Gp,silhouette:hfe,wiggle:dfe,positive:KTe},XTe=function(t,r,n){var o=r.map(function(f){return f.props.dataKey}),l=ZTe[n],h=cfe().keys(o).value(function(f,s){return+Li(f,s,0)}).order(JC).offset(l);return h(t)},YTe=function(t,r,n,o,l,h){if(!t)return null;var f=h?r.reverse():r,s={},y=f.reduce(function(w,A){var k,M=(k=A.type)!==null&&k!==void 0&&k.defaultProps?si(si({},A.type.defaultProps),A.props):A.props,R=M.stackId,j=M.hide;if(j)return w;var L=M[n],z=w[L]||{hasStack:!1,stackGroups:{}};if(Di(R)){var B=z.stackGroups[R]||{numericAxisId:n,cateAxisId:o,items:[]};B.items.push(A),z.hasStack=!0,z.stackGroups[R]=B}else z.stackGroups[Md("_stackId_")]={numericAxisId:n,cateAxisId:o,items:[A]};return si(si({},w),{},Rp({},L,z))},s),b={};return Object.keys(y).reduce(function(w,A){var k=y[A];if(k.hasStack){var M={};k.stackGroups=Object.keys(k.stackGroups).reduce(function(R,j){var L=k.stackGroups[j];return si(si({},R),{},Rp({},j,{numericAxisId:n,cateAxisId:o,items:L.items,stackedData:XTe(t,L.items,l)}))},M)}return si(si({},w),{},Rp({},A,k))},b)},JTe=function(t,r){var n=r.realScaleType,o=r.type,l=r.tickCount,h=r.originalDomain,f=r.allowDecimals,s=n||r.scale;if(s!=="auto"&&s!=="linear")return null;if(l&&o==="number"&&h&&(h[0]==="auto"||h[1]==="auto")){var y=t.domain();if(!y.length)return null;var b=cTe(y,l,f);return t.domain([SS(b),_u(b)]),{niceTicks:b}}if(l&&o==="number"){var w=t.domain(),A=uTe(w,l,f);return{niceTicks:A}}return null};function Qp(e){var t=e.axis,r=e.ticks,n=e.bandSize,o=e.entry,l=e.index,h=e.dataKey;if(t.type==="category"){if(!t.allowDuplicatedCategory&&t.dataKey&&!wr(o[t.dataKey])){var f=pw(r,"value",o[t.dataKey]);if(f)return f.coordinate+n/2}return r[l]?r[l].coordinate+n/2:null}var s=Li(o,wr(h)?t.dataKey:h);return wr(s)?null:t.scale(s)}var $$=function(t){var r=t.axis,n=t.ticks,o=t.offset,l=t.bandSize,h=t.entry,f=t.index;if(r.type==="category")return n[f]?n[f].coordinate+o:null;var s=Li(h,r.dataKey,r.domain[f]);return wr(s)?null:r.scale(s)-l/2+o},QTe=function(t){var r=t.numericAxis,n=r.scale.domain();if(r.type==="number"){var o=Math.min(n[0],n[1]),l=Math.max(n[0],n[1]);return o<=0&&l>=0?0:l<0?l:o}return n[0]},eEe=function(t,r){var n,o=(n=t.type)!==null&&n!==void 0&&n.defaultProps?si(si({},t.type.defaultProps),t.props):t.props,l=o.stackId;if(Di(l)){var h=r[l];if(h){var f=h.items.indexOf(t);return f>=0?h.stackedData[f]:null}}return null},tEe=function(t){return t.reduce(function(r,n){return[SS(n.concat([r[0]]).filter(It)),_u(n.concat([r[1]]).filter(It))]},[1/0,-1/0])},lq=function(t,r,n){return Object.keys(t).reduce(function(o,l){var h=t[l],f=h.stackedData,s=f.reduce(function(y,b){var w=tEe(b.slice(r,n+1));return[Math.min(y[0],w[0]),Math.max(y[1],w[1])]},[1/0,-1/0]);return[Math.min(s[0],o[0]),Math.max(s[1],o[1])]},[1/0,-1/0]).map(function(o){return o===1/0||o===-1/0?0:o})},F$=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,U$=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,Ck=function(t,r,n){if(Ar(t))return t(r,n);if(!Array.isArray(t))return r;var o=[];if(It(t[0]))o[0]=n?t[0]:Math.min(t[0],r[0]);else if(F$.test(t[0])){var l=+F$.exec(t[0])[1];o[0]=r[0]-l}else Ar(t[0])?o[0]=t[0](r[0]):o[0]=r[0];if(It(t[1]))o[1]=n?t[1]:Math.max(t[1],r[1]);else if(U$.test(t[1])){var h=+U$.exec(t[1])[1];o[1]=r[1]+h}else Ar(t[1])?o[1]=t[1](r[1]):o[1]=r[1];return o},Vw=function(t,r,n){if(t&&t.scale&&t.scale.bandwidth){var o=t.scale.bandwidth();if(!n||o>0)return o}if(t&&r&&r.length>=2){for(var l=RI(r,function(w){return w.coordinate}),h=1/0,f=1,s=l.length;f<s;f++){var y=l[f],b=l[f-1];h=Math.min((y.coordinate||0)-(b.coordinate||0),h)}return h===1/0?0:h}return n?void 0:0},V$=function(t,r,n){return!t||!t.length||Sd(t,ta(n,"type.defaultProps.domain"))?r:t},cq=function(t,r){var n=t.type.defaultProps?si(si({},t.type.defaultProps),t.props):t.props,o=n.dataKey,l=n.name,h=n.unit,f=n.formatter,s=n.tooltipType,y=n.chartType,b=n.hide;return si(si({},Sr(t,!1)),{},{dataKey:o,unit:h,formatter:f,name:l||o,color:sR(t),value:Li(r,o),type:s,payload:r,chartType:y,hide:b})};function c_(e){"@babel/helpers - typeof";return c_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},c_(e)}function G$(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function W$(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?G$(Object(r),!0).forEach(function(n){rEe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):G$(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function rEe(e,t,r){return t=nEe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function nEe(e){var t=iEe(e,"string");return c_(t)=="symbol"?t:t+""}function iEe(e,t){if(c_(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(c_(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Gw=Math.PI/180,oEe=function(t){return t*180/Math.PI},ro=function(t,r,n,o){return{x:t+Math.cos(-Gw*o)*n,y:r+Math.sin(-Gw*o)*n}},sEe=function(t,r){var n=t.x,o=t.y,l=r.x,h=r.y;return Math.sqrt(Math.pow(n-l,2)+Math.pow(o-h,2))},aEe=function(t,r){var n=t.x,o=t.y,l=r.cx,h=r.cy,f=sEe({x:n,y:o},{x:l,y:h});if(f<=0)return{radius:f};var s=(n-l)/f,y=Math.acos(s);return o>h&&(y=2*Math.PI-y),{radius:f,angle:oEe(y),angleInRadian:y}},lEe=function(t){var r=t.startAngle,n=t.endAngle,o=Math.floor(r/360),l=Math.floor(n/360),h=Math.min(o,l);return{startAngle:r-h*360,endAngle:n-h*360}},cEe=function(t,r){var n=r.startAngle,o=r.endAngle,l=Math.floor(n/360),h=Math.floor(o/360),f=Math.min(l,h);return t+f*360},q$=function(t,r){var n=t.x,o=t.y,l=aEe({x:n,y:o},r),h=l.radius,f=l.angle,s=r.innerRadius,y=r.outerRadius;if(h<s||h>y)return!1;if(h===0)return!0;var b=lEe(r),w=b.startAngle,A=b.endAngle,k=f,M;if(w<=A){for(;k>A;)k-=360;for(;k<w;)k+=360;M=k>=w&&k<=A}else{for(;k>w;)k-=360;for(;k<A;)k+=360;M=k>=A&&k<=w}return M?W$(W$({},r),{},{radius:h,angle:cEe(k,r)}):null};function u_(e){"@babel/helpers - typeof";return u_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u_(e)}var uEe=["offset"];function hEe(e){return mEe(e)||pEe(e)||fEe(e)||dEe()}function dEe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function fEe(e,t){if(e){if(typeof e=="string")return kk(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return kk(e,t)}}function pEe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function mEe(e){if(Array.isArray(e))return kk(e)}function kk(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function gEe(e,t){if(e==null)return{};var r=yEe(e,t),n,o;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(o=0;o<l.length;o++)n=l[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function yEe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function H$(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function ki(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?H$(Object(r),!0).forEach(function(n){vEe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):H$(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function vEe(e,t,r){return t=_Ee(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _Ee(e){var t=xEe(e,"string");return u_(t)=="symbol"?t:t+""}function xEe(e,t){if(u_(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(u_(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function h_(){return h_=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},h_.apply(this,arguments)}var bEe=function(t){var r=t.value,n=t.formatter,o=wr(t.children)?r:t.children;return Ar(n)?n(o):o},wEe=function(t,r){var n=$a(r-t),o=Math.min(Math.abs(r-t),360);return n*o},SEe=function(t,r,n){var o=t.position,l=t.viewBox,h=t.offset,f=t.className,s=l,y=s.cx,b=s.cy,w=s.innerRadius,A=s.outerRadius,k=s.startAngle,M=s.endAngle,R=s.clockWise,j=(w+A)/2,L=wEe(k,M),z=L>=0?1:-1,B,Z;o==="insideStart"?(B=k+z*h,Z=R):o==="insideEnd"?(B=M-z*h,Z=!R):o==="end"&&(B=M+z*h,Z=R),Z=L<=0?Z:!Z;var F=ro(y,b,j,B),H=ro(y,b,j,B+(Z?1:-1)*359),Y="M".concat(F.x,",").concat(F.y,`
    A`).concat(j,",").concat(j,",0,1,").concat(Z?0:1,`,
    `).concat(H.x,",").concat(H.y),te=wr(t.id)?Md("recharts-radial-line-"):t.id;return Ce.createElement("text",h_({},n,{dominantBaseline:"central",className:zr("recharts-radial-bar-label",f)}),Ce.createElement("defs",null,Ce.createElement("path",{id:te,d:Y})),Ce.createElement("textPath",{xlinkHref:"#".concat(te)},r))},TEe=function(t){var r=t.viewBox,n=t.offset,o=t.position,l=r,h=l.cx,f=l.cy,s=l.innerRadius,y=l.outerRadius,b=l.startAngle,w=l.endAngle,A=(b+w)/2;if(o==="outside"){var k=ro(h,f,y+n,A),M=k.x,R=k.y;return{x:M,y:R,textAnchor:M>=h?"start":"end",verticalAnchor:"middle"}}if(o==="center")return{x:h,y:f,textAnchor:"middle",verticalAnchor:"middle"};if(o==="centerTop")return{x:h,y:f,textAnchor:"middle",verticalAnchor:"start"};if(o==="centerBottom")return{x:h,y:f,textAnchor:"middle",verticalAnchor:"end"};var j=(s+y)/2,L=ro(h,f,j,A),z=L.x,B=L.y;return{x:z,y:B,textAnchor:"middle",verticalAnchor:"middle"}},EEe=function(t){var r=t.viewBox,n=t.parentViewBox,o=t.offset,l=t.position,h=r,f=h.x,s=h.y,y=h.width,b=h.height,w=b>=0?1:-1,A=w*o,k=w>0?"end":"start",M=w>0?"start":"end",R=y>=0?1:-1,j=R*o,L=R>0?"end":"start",z=R>0?"start":"end";if(l==="top"){var B={x:f+y/2,y:s-w*o,textAnchor:"middle",verticalAnchor:k};return ki(ki({},B),n?{height:Math.max(s-n.y,0),width:y}:{})}if(l==="bottom"){var Z={x:f+y/2,y:s+b+A,textAnchor:"middle",verticalAnchor:M};return ki(ki({},Z),n?{height:Math.max(n.y+n.height-(s+b),0),width:y}:{})}if(l==="left"){var F={x:f-j,y:s+b/2,textAnchor:L,verticalAnchor:"middle"};return ki(ki({},F),n?{width:Math.max(F.x-n.x,0),height:b}:{})}if(l==="right"){var H={x:f+y+j,y:s+b/2,textAnchor:z,verticalAnchor:"middle"};return ki(ki({},H),n?{width:Math.max(n.x+n.width-H.x,0),height:b}:{})}var Y=n?{width:y,height:b}:{};return l==="insideLeft"?ki({x:f+j,y:s+b/2,textAnchor:z,verticalAnchor:"middle"},Y):l==="insideRight"?ki({x:f+y-j,y:s+b/2,textAnchor:L,verticalAnchor:"middle"},Y):l==="insideTop"?ki({x:f+y/2,y:s+A,textAnchor:"middle",verticalAnchor:M},Y):l==="insideBottom"?ki({x:f+y/2,y:s+b-A,textAnchor:"middle",verticalAnchor:k},Y):l==="insideTopLeft"?ki({x:f+j,y:s+A,textAnchor:z,verticalAnchor:M},Y):l==="insideTopRight"?ki({x:f+y-j,y:s+A,textAnchor:L,verticalAnchor:M},Y):l==="insideBottomLeft"?ki({x:f+j,y:s+b-A,textAnchor:z,verticalAnchor:k},Y):l==="insideBottomRight"?ki({x:f+y-j,y:s+b-A,textAnchor:L,verticalAnchor:k},Y):km(l)&&(It(l.x)||rd(l.x))&&(It(l.y)||rd(l.y))?ki({x:f+wd(l.x,y),y:s+wd(l.y,b),textAnchor:"end",verticalAnchor:"end"},Y):ki({x:f+y/2,y:s+b/2,textAnchor:"middle",verticalAnchor:"middle"},Y)},AEe=function(t){return"cx"in t&&It(t.cx)};function bo(e){var t=e.offset,r=t===void 0?5:t,n=gEe(e,uEe),o=ki({offset:r},n),l=o.viewBox,h=o.position,f=o.value,s=o.children,y=o.content,b=o.className,w=b===void 0?"":b,A=o.textBreakAll;if(!l||wr(f)&&wr(s)&&!re.isValidElement(y)&&!Ar(y))return null;if(re.isValidElement(y))return re.cloneElement(y,o);var k;if(Ar(y)){if(k=re.createElement(y,o),re.isValidElement(k))return k}else k=bEe(o);var M=AEe(l),R=Sr(o,!0);if(M&&(h==="insideStart"||h==="insideEnd"||h==="end"))return SEe(o,k,R);var j=M?TEe(o):EEe(o);return Ce.createElement(kw,h_({className:zr("recharts-label",w)},R,j,{breakAll:A}),k)}bo.displayName="Label";var uq=function(t){var r=t.cx,n=t.cy,o=t.angle,l=t.startAngle,h=t.endAngle,f=t.r,s=t.radius,y=t.innerRadius,b=t.outerRadius,w=t.x,A=t.y,k=t.top,M=t.left,R=t.width,j=t.height,L=t.clockWise,z=t.labelViewBox;if(z)return z;if(It(R)&&It(j)){if(It(w)&&It(A))return{x:w,y:A,width:R,height:j};if(It(k)&&It(M))return{x:k,y:M,width:R,height:j}}return It(w)&&It(A)?{x:w,y:A,width:0,height:0}:It(r)&&It(n)?{cx:r,cy:n,startAngle:l||o||0,endAngle:h||o||0,innerRadius:y||0,outerRadius:b||s||f||0,clockWise:L}:t.viewBox?t.viewBox:{}},PEe=function(t,r){return t?t===!0?Ce.createElement(bo,{key:"label-implicit",viewBox:r}):Di(t)?Ce.createElement(bo,{key:"label-implicit",viewBox:r,value:t}):re.isValidElement(t)?t.type===bo?re.cloneElement(t,{key:"label-implicit",viewBox:r}):Ce.createElement(bo,{key:"label-implicit",content:t,viewBox:r}):Ar(t)?Ce.createElement(bo,{key:"label-implicit",content:t,viewBox:r}):km(t)?Ce.createElement(bo,h_({viewBox:r},t,{key:"label-implicit"})):null:null},CEe=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!t||!t.children&&n&&!t.label)return null;var o=t.children,l=uq(t),h=os(o,bo).map(function(s,y){return re.cloneElement(s,{viewBox:r||l,key:"label-".concat(y)})});if(!n)return h;var f=PEe(t.label,r||l);return[f].concat(hEe(h))};bo.parseViewBox=uq;bo.renderCallByParent=CEe;function kEe(e){var t=e==null?0:e.length;return t?e[t-1]:void 0}var OEe=kEe;const MEe=mn(OEe);function d_(e){"@babel/helpers - typeof";return d_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},d_(e)}var IEe=["valueAccessor"],REe=["data","dataKey","clockWise","id","textBreakAll"];function DEe(e){return BEe(e)||zEe(e)||jEe(e)||LEe()}function LEe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function jEe(e,t){if(e){if(typeof e=="string")return Ok(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Ok(e,t)}}function zEe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function BEe(e){if(Array.isArray(e))return Ok(e)}function Ok(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Ww(){return Ww=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ww.apply(this,arguments)}function K$(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function Z$(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?K$(Object(r),!0).forEach(function(n){NEe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):K$(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function NEe(e,t,r){return t=$Ee(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function $Ee(e){var t=FEe(e,"string");return d_(t)=="symbol"?t:t+""}function FEe(e,t){if(d_(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(d_(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function X$(e,t){if(e==null)return{};var r=UEe(e,t),n,o;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(o=0;o<l.length;o++)n=l[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function UEe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var VEe=function(t){return Array.isArray(t.value)?MEe(t.value):t.value};function Sl(e){var t=e.valueAccessor,r=t===void 0?VEe:t,n=X$(e,IEe),o=n.data,l=n.dataKey,h=n.clockWise,f=n.id,s=n.textBreakAll,y=X$(n,REe);return!o||!o.length?null:Ce.createElement(sn,{className:"recharts-label-list"},o.map(function(b,w){var A=wr(l)?r(b,w):Li(b&&b.payload,l),k=wr(f)?{}:{id:"".concat(f,"-").concat(w)};return Ce.createElement(bo,Ww({},Sr(b,!0),y,k,{parentViewBox:b.parentViewBox,value:A,textBreakAll:s,viewBox:bo.parseViewBox(wr(h)?b:Z$(Z$({},b),{},{clockWise:h})),key:"label-".concat(w),index:w}))}))}Sl.displayName="LabelList";function GEe(e,t){return e?e===!0?Ce.createElement(Sl,{key:"labelList-implicit",data:t}):Ce.isValidElement(e)||Ar(e)?Ce.createElement(Sl,{key:"labelList-implicit",data:t,content:e}):km(e)?Ce.createElement(Sl,Ww({data:t},e,{key:"labelList-implicit"})):null:null}function WEe(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!e||!e.children&&r&&!e.label)return null;var n=e.children,o=os(n,Sl).map(function(h,f){return re.cloneElement(h,{data:t,key:"labelList-".concat(f)})});if(!r)return o;var l=GEe(e.label,t);return[l].concat(DEe(o))}Sl.renderCallByParent=WEe;function f_(e){"@babel/helpers - typeof";return f_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},f_(e)}function Mk(){return Mk=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Mk.apply(this,arguments)}function Y$(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function J$(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Y$(Object(r),!0).forEach(function(n){qEe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Y$(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function qEe(e,t,r){return t=HEe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function HEe(e){var t=KEe(e,"string");return f_(t)=="symbol"?t:t+""}function KEe(e,t){if(f_(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(f_(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ZEe=function(t,r){var n=$a(r-t),o=Math.min(Math.abs(r-t),359.999);return n*o},eb=function(t){var r=t.cx,n=t.cy,o=t.radius,l=t.angle,h=t.sign,f=t.isExternal,s=t.cornerRadius,y=t.cornerIsExternal,b=s*(f?1:-1)+o,w=Math.asin(s/b)/Gw,A=y?l:l+h*w,k=ro(r,n,b,A),M=ro(r,n,o,A),R=y?l-h*w:l,j=ro(r,n,b*Math.cos(w*Gw),R);return{center:k,circleTangency:M,lineTangency:j,theta:w}},hq=function(t){var r=t.cx,n=t.cy,o=t.innerRadius,l=t.outerRadius,h=t.startAngle,f=t.endAngle,s=ZEe(h,f),y=h+s,b=ro(r,n,l,h),w=ro(r,n,l,y),A="M ".concat(b.x,",").concat(b.y,`
    A `).concat(l,",").concat(l,`,0,
    `).concat(+(Math.abs(s)>180),",").concat(+(h>y),`,
    `).concat(w.x,",").concat(w.y,`
  `);if(o>0){var k=ro(r,n,o,h),M=ro(r,n,o,y);A+="L ".concat(M.x,",").concat(M.y,`
            A `).concat(o,",").concat(o,`,0,
            `).concat(+(Math.abs(s)>180),",").concat(+(h<=y),`,
            `).concat(k.x,",").concat(k.y," Z")}else A+="L ".concat(r,",").concat(n," Z");return A},XEe=function(t){var r=t.cx,n=t.cy,o=t.innerRadius,l=t.outerRadius,h=t.cornerRadius,f=t.forceCornerRadius,s=t.cornerIsExternal,y=t.startAngle,b=t.endAngle,w=$a(b-y),A=eb({cx:r,cy:n,radius:l,angle:y,sign:w,cornerRadius:h,cornerIsExternal:s}),k=A.circleTangency,M=A.lineTangency,R=A.theta,j=eb({cx:r,cy:n,radius:l,angle:b,sign:-w,cornerRadius:h,cornerIsExternal:s}),L=j.circleTangency,z=j.lineTangency,B=j.theta,Z=s?Math.abs(y-b):Math.abs(y-b)-R-B;if(Z<0)return f?"M ".concat(M.x,",").concat(M.y,`
        a`).concat(h,",").concat(h,",0,0,1,").concat(h*2,`,0
        a`).concat(h,",").concat(h,",0,0,1,").concat(-h*2,`,0
      `):hq({cx:r,cy:n,innerRadius:o,outerRadius:l,startAngle:y,endAngle:b});var F="M ".concat(M.x,",").concat(M.y,`
    A`).concat(h,",").concat(h,",0,0,").concat(+(w<0),",").concat(k.x,",").concat(k.y,`
    A`).concat(l,",").concat(l,",0,").concat(+(Z>180),",").concat(+(w<0),",").concat(L.x,",").concat(L.y,`
    A`).concat(h,",").concat(h,",0,0,").concat(+(w<0),",").concat(z.x,",").concat(z.y,`
  `);if(o>0){var H=eb({cx:r,cy:n,radius:o,angle:y,sign:w,isExternal:!0,cornerRadius:h,cornerIsExternal:s}),Y=H.circleTangency,te=H.lineTangency,pe=H.theta,ue=eb({cx:r,cy:n,radius:o,angle:b,sign:-w,isExternal:!0,cornerRadius:h,cornerIsExternal:s}),Ee=ue.circleTangency,Oe=ue.lineTangency,je=ue.theta,Ge=s?Math.abs(y-b):Math.abs(y-b)-pe-je;if(Ge<0&&h===0)return"".concat(F,"L").concat(r,",").concat(n,"Z");F+="L".concat(Oe.x,",").concat(Oe.y,`
      A`).concat(h,",").concat(h,",0,0,").concat(+(w<0),",").concat(Ee.x,",").concat(Ee.y,`
      A`).concat(o,",").concat(o,",0,").concat(+(Ge>180),",").concat(+(w>0),",").concat(Y.x,",").concat(Y.y,`
      A`).concat(h,",").concat(h,",0,0,").concat(+(w<0),",").concat(te.x,",").concat(te.y,"Z")}else F+="L".concat(r,",").concat(n,"Z");return F},YEe={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},dq=function(t){var r=J$(J$({},YEe),t),n=r.cx,o=r.cy,l=r.innerRadius,h=r.outerRadius,f=r.cornerRadius,s=r.forceCornerRadius,y=r.cornerIsExternal,b=r.startAngle,w=r.endAngle,A=r.className;if(h<l||b===w)return null;var k=zr("recharts-sector",A),M=h-l,R=wd(f,M,0,!0),j;return R>0&&Math.abs(b-w)<360?j=XEe({cx:n,cy:o,innerRadius:l,outerRadius:h,cornerRadius:Math.min(R,M/2),forceCornerRadius:s,cornerIsExternal:y,startAngle:b,endAngle:w}):j=hq({cx:n,cy:o,innerRadius:l,outerRadius:h,startAngle:b,endAngle:w}),Ce.createElement("path",Mk({},Sr(r,!0),{className:k,d:j,role:"img"}))};function p_(e){"@babel/helpers - typeof";return p_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},p_(e)}function Ik(){return Ik=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ik.apply(this,arguments)}function Q$(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function eF(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Q$(Object(r),!0).forEach(function(n){JEe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Q$(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function JEe(e,t,r){return t=QEe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function QEe(e){var t=eAe(e,"string");return p_(t)=="symbol"?t:t+""}function eAe(e,t){if(p_(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(p_(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var tF={curveBasisClosed:Jde,curveBasisOpen:Qde,curveBasis:Yde,curveBumpX:zde,curveBumpY:Bde,curveLinearClosed:efe,curveLinear:hS,curveMonotoneX:tfe,curveMonotoneY:rfe,curveNatural:nfe,curveStep:ife,curveStepAfter:sfe,curveStepBefore:ofe},tb=function(t){return t.x===+t.x&&t.y===+t.y},Ry=function(t){return t.x},Dy=function(t){return t.y},tAe=function(t,r){if(Ar(t))return t;var n="curve".concat(cS(t));return(n==="curveMonotone"||n==="curveBump")&&r?tF["".concat(n).concat(r==="vertical"?"Y":"X")]:tF[n]||hS},rAe=function(t){var r=t.type,n=r===void 0?"linear":r,o=t.points,l=o===void 0?[]:o,h=t.baseLine,f=t.layout,s=t.connectNulls,y=s===void 0?!1:s,b=tAe(n,f),w=y?l.filter(function(R){return tb(R)}):l,A;if(Array.isArray(h)){var k=y?h.filter(function(R){return tb(R)}):h,M=w.map(function(R,j){return eF(eF({},R),{},{base:k[j]})});return f==="vertical"?A=Wx().y(Dy).x1(Ry).x0(function(R){return R.base.x}):A=Wx().x(Ry).y1(Dy).y0(function(R){return R.base.y}),A.defined(tb).curve(b),A(M)}return f==="vertical"&&It(h)?A=Wx().y(Dy).x1(Ry).x0(h):It(h)?A=Wx().x(Ry).y1(Dy).y0(h):A=fG().x(Ry).y(Dy),A.defined(tb).curve(b),A(w)},pd=function(t){var r=t.className,n=t.points,o=t.path,l=t.pathRef;if((!n||!n.length)&&!o)return null;var h=n&&n.length?rAe(t):o;return re.createElement("path",Ik({},Sr(t,!1),mw(t),{className:zr("recharts-curve",r),d:h,ref:l}))},fq={exports:{}},nAe="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",iAe=nAe,oAe=iAe;function pq(){}function mq(){}mq.resetWarningCache=pq;var sAe=function(){function e(n,o,l,h,f,s){if(s!==oAe){var y=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw y.name="Invariant Violation",y}}e.isRequired=e;function t(){return e}var r={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:mq,resetWarningCache:pq};return r.PropTypes=r,r};fq.exports=sAe();var aAe=fq.exports;const ln=mn(aAe),{getOwnPropertyNames:lAe,getOwnPropertySymbols:cAe}=Object,{hasOwnProperty:uAe}=Object.prototype;function VA(e,t){return function(n,o,l){return e(n,o,l)&&t(n,o,l)}}function rb(e){return function(r,n,o){if(!r||!n||typeof r!="object"||typeof n!="object")return e(r,n,o);const{cache:l}=o,h=l.get(r),f=l.get(n);if(h&&f)return h===n&&f===r;l.set(r,n),l.set(n,r);const s=e(r,n,o);return l.delete(r),l.delete(n),s}}function hAe(e){return e!=null?e[Symbol.toStringTag]:void 0}function rF(e){return lAe(e).concat(cAe(e))}const dAe=Object.hasOwn||((e,t)=>uAe.call(e,t));function Dd(e,t){return e===t||!e&&!t&&e!==e&&t!==t}const fAe="__v",pAe="__o",mAe="_owner",{getOwnPropertyDescriptor:nF,keys:iF}=Object;function gAe(e,t){return e.byteLength===t.byteLength&&qw(new Uint8Array(e),new Uint8Array(t))}function yAe(e,t,r){let n=e.length;if(t.length!==n)return!1;for(;n-- >0;)if(!r.equals(e[n],t[n],n,n,e,t,r))return!1;return!0}function vAe(e,t){return e.byteLength===t.byteLength&&qw(new Uint8Array(e.buffer,e.byteOffset,e.byteLength),new Uint8Array(t.buffer,t.byteOffset,t.byteLength))}function _Ae(e,t){return Dd(e.getTime(),t.getTime())}function xAe(e,t){return e.name===t.name&&e.message===t.message&&e.cause===t.cause&&e.stack===t.stack}function bAe(e,t){return e===t}function oF(e,t,r){const n=e.size;if(n!==t.size)return!1;if(!n)return!0;const o=new Array(n),l=e.entries();let h,f,s=0;for(;(h=l.next())&&!h.done;){const y=t.entries();let b=!1,w=0;for(;(f=y.next())&&!f.done;){if(o[w]){w++;continue}const A=h.value,k=f.value;if(r.equals(A[0],k[0],s,w,e,t,r)&&r.equals(A[1],k[1],A[0],k[0],e,t,r)){b=o[w]=!0;break}w++}if(!b)return!1;s++}return!0}const wAe=Dd;function SAe(e,t,r){const n=iF(e);let o=n.length;if(iF(t).length!==o)return!1;for(;o-- >0;)if(!gq(e,t,r,n[o]))return!1;return!0}function Ly(e,t,r){const n=rF(e);let o=n.length;if(rF(t).length!==o)return!1;let l,h,f;for(;o-- >0;)if(l=n[o],!gq(e,t,r,l)||(h=nF(e,l),f=nF(t,l),(h||f)&&(!h||!f||h.configurable!==f.configurable||h.enumerable!==f.enumerable||h.writable!==f.writable)))return!1;return!0}function TAe(e,t){return Dd(e.valueOf(),t.valueOf())}function EAe(e,t){return e.source===t.source&&e.flags===t.flags}function sF(e,t,r){const n=e.size;if(n!==t.size)return!1;if(!n)return!0;const o=new Array(n),l=e.values();let h,f;for(;(h=l.next())&&!h.done;){const s=t.values();let y=!1,b=0;for(;(f=s.next())&&!f.done;){if(!o[b]&&r.equals(h.value,f.value,h.value,f.value,e,t,r)){y=o[b]=!0;break}b++}if(!y)return!1}return!0}function qw(e,t){let r=e.byteLength;if(t.byteLength!==r||e.byteOffset!==t.byteOffset)return!1;for(;r-- >0;)if(e[r]!==t[r])return!1;return!0}function AAe(e,t){return e.hostname===t.hostname&&e.pathname===t.pathname&&e.protocol===t.protocol&&e.port===t.port&&e.hash===t.hash&&e.username===t.username&&e.password===t.password}function gq(e,t,r,n){return(n===mAe||n===pAe||n===fAe)&&(e.$$typeof||t.$$typeof)?!0:dAe(t,n)&&r.equals(e[n],t[n],n,n,e,t,r)}const PAe="[object ArrayBuffer]",CAe="[object Arguments]",kAe="[object Boolean]",OAe="[object DataView]",MAe="[object Date]",IAe="[object Error]",RAe="[object Map]",DAe="[object Number]",LAe="[object Object]",jAe="[object RegExp]",zAe="[object Set]",BAe="[object String]",NAe={"[object Int8Array]":!0,"[object Uint8Array]":!0,"[object Uint8ClampedArray]":!0,"[object Int16Array]":!0,"[object Uint16Array]":!0,"[object Int32Array]":!0,"[object Uint32Array]":!0,"[object Float16Array]":!0,"[object Float32Array]":!0,"[object Float64Array]":!0,"[object BigInt64Array]":!0,"[object BigUint64Array]":!0},$Ae="[object URL]",FAe=Object.prototype.toString;function UAe({areArrayBuffersEqual:e,areArraysEqual:t,areDataViewsEqual:r,areDatesEqual:n,areErrorsEqual:o,areFunctionsEqual:l,areMapsEqual:h,areNumbersEqual:f,areObjectsEqual:s,arePrimitiveWrappersEqual:y,areRegExpsEqual:b,areSetsEqual:w,areTypedArraysEqual:A,areUrlsEqual:k,unknownTagComparators:M}){return function(j,L,z){if(j===L)return!0;if(j==null||L==null)return!1;const B=typeof j;if(B!==typeof L)return!1;if(B!=="object")return B==="number"?f(j,L,z):B==="function"?l(j,L,z):!1;const Z=j.constructor;if(Z!==L.constructor)return!1;if(Z===Object)return s(j,L,z);if(Array.isArray(j))return t(j,L,z);if(Z===Date)return n(j,L,z);if(Z===RegExp)return b(j,L,z);if(Z===Map)return h(j,L,z);if(Z===Set)return w(j,L,z);const F=FAe.call(j);if(F===MAe)return n(j,L,z);if(F===jAe)return b(j,L,z);if(F===RAe)return h(j,L,z);if(F===zAe)return w(j,L,z);if(F===LAe)return typeof j.then!="function"&&typeof L.then!="function"&&s(j,L,z);if(F===$Ae)return k(j,L,z);if(F===IAe)return o(j,L,z);if(F===CAe)return s(j,L,z);if(NAe[F])return A(j,L,z);if(F===PAe)return e(j,L,z);if(F===OAe)return r(j,L,z);if(F===kAe||F===DAe||F===BAe)return y(j,L,z);if(M){let H=M[F];if(!H){const Y=hAe(j);Y&&(H=M[Y])}if(H)return H(j,L,z)}return!1}}function VAe({circular:e,createCustomConfig:t,strict:r}){let n={areArrayBuffersEqual:gAe,areArraysEqual:r?Ly:yAe,areDataViewsEqual:vAe,areDatesEqual:_Ae,areErrorsEqual:xAe,areFunctionsEqual:bAe,areMapsEqual:r?VA(oF,Ly):oF,areNumbersEqual:wAe,areObjectsEqual:r?Ly:SAe,arePrimitiveWrappersEqual:TAe,areRegExpsEqual:EAe,areSetsEqual:r?VA(sF,Ly):sF,areTypedArraysEqual:r?VA(qw,Ly):qw,areUrlsEqual:AAe,unknownTagComparators:void 0};if(t&&(n=Object.assign({},n,t(n))),e){const o=rb(n.areArraysEqual),l=rb(n.areMapsEqual),h=rb(n.areObjectsEqual),f=rb(n.areSetsEqual);n=Object.assign({},n,{areArraysEqual:o,areMapsEqual:l,areObjectsEqual:h,areSetsEqual:f})}return n}function GAe(e){return function(t,r,n,o,l,h,f){return e(t,r,f)}}function WAe({circular:e,comparator:t,createState:r,equals:n,strict:o}){if(r)return function(f,s){const{cache:y=e?new WeakMap:void 0,meta:b}=r();return t(f,s,{cache:y,equals:n,meta:b,strict:o})};if(e)return function(f,s){return t(f,s,{cache:new WeakMap,equals:n,meta:void 0,strict:o})};const l={cache:void 0,equals:n,meta:void 0,strict:o};return function(f,s){return t(f,s,l)}}const qAe=Zu();Zu({strict:!0});Zu({circular:!0});Zu({circular:!0,strict:!0});Zu({createInternalComparator:()=>Dd});Zu({strict:!0,createInternalComparator:()=>Dd});Zu({circular:!0,createInternalComparator:()=>Dd});Zu({circular:!0,createInternalComparator:()=>Dd,strict:!0});function Zu(e={}){const{circular:t=!1,createInternalComparator:r,createState:n,strict:o=!1}=e,l=VAe(e),h=UAe(l),f=r?r(h):GAe(h);return WAe({circular:t,comparator:h,createState:n,equals:f,strict:o})}function HAe(e){typeof requestAnimationFrame<"u"&&requestAnimationFrame(e)}function aF(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=-1,n=function o(l){r<0&&(r=l),l-r>t?(e(l),r=-1):HAe(o)};requestAnimationFrame(n)}function Rk(e){"@babel/helpers - typeof";return Rk=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rk(e)}function KAe(e){return JAe(e)||YAe(e)||XAe(e)||ZAe()}function ZAe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function XAe(e,t){if(e){if(typeof e=="string")return lF(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return lF(e,t)}}function lF(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function YAe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function JAe(e){if(Array.isArray(e))return e}function QAe(){var e={},t=function(){return null},r=!1,n=function o(l){if(!r){if(Array.isArray(l)){if(!l.length)return;var h=l,f=KAe(h),s=f[0],y=f.slice(1);if(typeof s=="number"){aF(o.bind(null,y),s);return}o(s),aF(o.bind(null,y));return}Rk(l)==="object"&&(e=l,t(e)),typeof l=="function"&&l()}};return{stop:function(){r=!0},start:function(l){r=!1,n(l)},subscribe:function(l){return t=l,function(){t=function(){return null}}}}}function m_(e){"@babel/helpers - typeof";return m_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},m_(e)}function cF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function uF(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?cF(Object(r),!0).forEach(function(n){yq(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):cF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function yq(e,t,r){return t=ePe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ePe(e){var t=tPe(e,"string");return m_(t)==="symbol"?t:String(t)}function tPe(e,t){if(m_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(m_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var rPe=function(t,r){return[Object.keys(t),Object.keys(r)].reduce(function(n,o){return n.filter(function(l){return o.includes(l)})})},nPe=function(t){return t},iPe=function(t){return t.replace(/([A-Z])/g,function(r){return"-".concat(r.toLowerCase())})},hv=function(t,r){return Object.keys(r).reduce(function(n,o){return uF(uF({},n),{},yq({},o,t(o,r[o])))},{})},hF=function(t,r,n){return t.map(function(o){return"".concat(iPe(o)," ").concat(r,"ms ").concat(n)}).join(",")};function oPe(e,t){return lPe(e)||aPe(e,t)||vq(e,t)||sPe()}function sPe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function aPe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,l,h,f=[],s=!0,y=!1;try{if(l=(r=r.call(e)).next,t!==0)for(;!(s=(n=l.call(r)).done)&&(f.push(n.value),f.length!==t);s=!0);}catch(b){y=!0,o=b}finally{try{if(!s&&r.return!=null&&(h=r.return(),Object(h)!==h))return}finally{if(y)throw o}}return f}}function lPe(e){if(Array.isArray(e))return e}function cPe(e){return dPe(e)||hPe(e)||vq(e)||uPe()}function uPe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function vq(e,t){if(e){if(typeof e=="string")return Dk(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Dk(e,t)}}function hPe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function dPe(e){if(Array.isArray(e))return Dk(e)}function Dk(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Hw=1e-4,_q=function(t,r){return[0,3*t,3*r-6*t,3*t-3*r+1]},xq=function(t,r){return t.map(function(n,o){return n*Math.pow(r,o)}).reduce(function(n,o){return n+o})},dF=function(t,r){return function(n){var o=_q(t,r);return xq(o,n)}},fPe=function(t,r){return function(n){var o=_q(t,r),l=[].concat(cPe(o.map(function(h,f){return h*f}).slice(1)),[0]);return xq(l,n)}},fF=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var o=r[0],l=r[1],h=r[2],f=r[3];if(r.length===1)switch(r[0]){case"linear":o=0,l=0,h=1,f=1;break;case"ease":o=.25,l=.1,h=.25,f=1;break;case"ease-in":o=.42,l=0,h=1,f=1;break;case"ease-out":o=.42,l=0,h=.58,f=1;break;case"ease-in-out":o=0,l=0,h=.58,f=1;break;default:{var s=r[0].split("(");if(s[0]==="cubic-bezier"&&s[1].split(")")[0].split(",").length===4){var y=s[1].split(")")[0].split(",").map(function(j){return parseFloat(j)}),b=oPe(y,4);o=b[0],l=b[1],h=b[2],f=b[3]}}}var w=dF(o,h),A=dF(l,f),k=fPe(o,h),M=function(L){return L>1?1:L<0?0:L},R=function(L){for(var z=L>1?1:L,B=z,Z=0;Z<8;++Z){var F=w(B)-z,H=k(B);if(Math.abs(F-z)<Hw||H<Hw)return A(B);B=M(B-F/H)}return A(B)};return R.isStepper=!1,R},pPe=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.stiff,n=r===void 0?100:r,o=t.damping,l=o===void 0?8:o,h=t.dt,f=h===void 0?17:h,s=function(b,w,A){var k=-(b-w)*n,M=A*l,R=A+(k-M)*f/1e3,j=A*f/1e3+b;return Math.abs(j-w)<Hw&&Math.abs(R)<Hw?[w,0]:[j,R]};return s.isStepper=!0,s.dt=f,s},mPe=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var o=r[0];if(typeof o=="string")switch(o){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return fF(o);case"spring":return pPe();default:if(o.split("(")[0]==="cubic-bezier")return fF(o)}return typeof o=="function"?o:null};function g_(e){"@babel/helpers - typeof";return g_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},g_(e)}function pF(e){return vPe(e)||yPe(e)||bq(e)||gPe()}function gPe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function yPe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function vPe(e){if(Array.isArray(e))return jk(e)}function mF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function Qi(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?mF(Object(r),!0).forEach(function(n){Lk(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):mF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Lk(e,t,r){return t=_Pe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _Pe(e){var t=xPe(e,"string");return g_(t)==="symbol"?t:String(t)}function xPe(e,t){if(g_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(g_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function bPe(e,t){return TPe(e)||SPe(e,t)||bq(e,t)||wPe()}function wPe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function bq(e,t){if(e){if(typeof e=="string")return jk(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return jk(e,t)}}function jk(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function SPe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,l,h,f=[],s=!0,y=!1;try{if(l=(r=r.call(e)).next,t!==0)for(;!(s=(n=l.call(r)).done)&&(f.push(n.value),f.length!==t);s=!0);}catch(b){y=!0,o=b}finally{try{if(!s&&r.return!=null&&(h=r.return(),Object(h)!==h))return}finally{if(y)throw o}}return f}}function TPe(e){if(Array.isArray(e))return e}var Kw=function(t,r,n){return t+(r-t)*n},zk=function(t){var r=t.from,n=t.to;return r!==n},EPe=function e(t,r,n){var o=hv(function(l,h){if(zk(h)){var f=t(h.from,h.to,h.velocity),s=bPe(f,2),y=s[0],b=s[1];return Qi(Qi({},h),{},{from:y,velocity:b})}return h},r);return n<1?hv(function(l,h){return zk(h)?Qi(Qi({},h),{},{velocity:Kw(h.velocity,o[l].velocity,n),from:Kw(h.from,o[l].from,n)}):h},r):e(t,o,n-1)};const APe=function(e,t,r,n,o){var l=rPe(e,t),h=l.reduce(function(j,L){return Qi(Qi({},j),{},Lk({},L,[e[L],t[L]]))},{}),f=l.reduce(function(j,L){return Qi(Qi({},j),{},Lk({},L,{from:e[L],velocity:0,to:t[L]}))},{}),s=-1,y,b,w=function(){return null},A=function(){return hv(function(L,z){return z.from},f)},k=function(){return!Object.values(f).filter(zk).length},M=function(L){y||(y=L);var z=L-y,B=z/r.dt;f=EPe(r,f,B),o(Qi(Qi(Qi({},e),t),A())),y=L,k()||(s=requestAnimationFrame(w))},R=function(L){b||(b=L);var z=(L-b)/n,B=hv(function(F,H){return Kw.apply(void 0,pF(H).concat([r(z)]))},h);if(o(Qi(Qi(Qi({},e),t),B)),z<1)s=requestAnimationFrame(w);else{var Z=hv(function(F,H){return Kw.apply(void 0,pF(H).concat([r(1)]))},h);o(Qi(Qi(Qi({},e),t),Z))}};return w=r.isStepper?M:R,function(){return requestAnimationFrame(w),function(){cancelAnimationFrame(s)}}};function em(e){"@babel/helpers - typeof";return em=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},em(e)}var PPe=["children","begin","duration","attributeName","easing","isActive","steps","from","to","canBegin","onAnimationEnd","shouldReAnimate","onAnimationReStart"];function CPe(e,t){if(e==null)return{};var r=kPe(e,t),n,o;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(o=0;o<l.length;o++)n=l[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function kPe(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,l;for(l=0;l<n.length;l++)o=n[l],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function GA(e){return RPe(e)||IPe(e)||MPe(e)||OPe()}function OPe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function MPe(e,t){if(e){if(typeof e=="string")return Bk(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Bk(e,t)}}function IPe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function RPe(e){if(Array.isArray(e))return Bk(e)}function Bk(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function gF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function Aa(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?gF(Object(r),!0).forEach(function(n){qy(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):gF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function qy(e,t,r){return t=wq(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function DPe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function LPe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,wq(n.key),n)}}function jPe(e,t,r){return t&&LPe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function wq(e){var t=zPe(e,"string");return em(t)==="symbol"?t:String(t)}function zPe(e,t){if(em(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(em(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function BPe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Nk(e,t)}function Nk(e,t){return Nk=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},Nk(e,t)}function NPe(e){var t=$Pe();return function(){var n=Zw(e),o;if(t){var l=Zw(this).constructor;o=Reflect.construct(n,arguments,l)}else o=n.apply(this,arguments);return $k(this,o)}}function $k(e,t){if(t&&(em(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Fk(e)}function Fk(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function $Pe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Zw(e){return Zw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Zw(e)}var Ga=function(e){BPe(r,e);var t=NPe(r);function r(n,o){var l;DPe(this,r),l=t.call(this,n,o);var h=l.props,f=h.isActive,s=h.attributeName,y=h.from,b=h.to,w=h.steps,A=h.children,k=h.duration;if(l.handleStyleChange=l.handleStyleChange.bind(Fk(l)),l.changeStyle=l.changeStyle.bind(Fk(l)),!f||k<=0)return l.state={style:{}},typeof A=="function"&&(l.state={style:b}),$k(l);if(w&&w.length)l.state={style:w[0].style};else if(y){if(typeof A=="function")return l.state={style:y},$k(l);l.state={style:s?qy({},s,y):y}}else l.state={style:{}};return l}return jPe(r,[{key:"componentDidMount",value:function(){var o=this.props,l=o.isActive,h=o.canBegin;this.mounted=!0,!(!l||!h)&&this.runAnimation(this.props)}},{key:"componentDidUpdate",value:function(o){var l=this.props,h=l.isActive,f=l.canBegin,s=l.attributeName,y=l.shouldReAnimate,b=l.to,w=l.from,A=this.state.style;if(f){if(!h){var k={style:s?qy({},s,b):b};this.state&&A&&(s&&A[s]!==b||!s&&A!==b)&&this.setState(k);return}if(!(qAe(o.to,b)&&o.canBegin&&o.isActive)){var M=!o.canBegin||!o.isActive;this.manager&&this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation();var R=M||y?w:o.to;if(this.state&&A){var j={style:s?qy({},s,R):R};(s&&A[s]!==R||!s&&A!==R)&&this.setState(j)}this.runAnimation(Aa(Aa({},this.props),{},{from:R,begin:0}))}}}},{key:"componentWillUnmount",value:function(){this.mounted=!1;var o=this.props.onAnimationEnd;this.unSubscribe&&this.unSubscribe(),this.manager&&(this.manager.stop(),this.manager=null),this.stopJSAnimation&&this.stopJSAnimation(),o&&o()}},{key:"handleStyleChange",value:function(o){this.changeStyle(o)}},{key:"changeStyle",value:function(o){this.mounted&&this.setState({style:o})}},{key:"runJSAnimation",value:function(o){var l=this,h=o.from,f=o.to,s=o.duration,y=o.easing,b=o.begin,w=o.onAnimationEnd,A=o.onAnimationStart,k=APe(h,f,mPe(y),s,this.changeStyle),M=function(){l.stopJSAnimation=k()};this.manager.start([A,b,M,s,w])}},{key:"runStepAnimation",value:function(o){var l=this,h=o.steps,f=o.begin,s=o.onAnimationStart,y=h[0],b=y.style,w=y.duration,A=w===void 0?0:w,k=function(R,j,L){if(L===0)return R;var z=j.duration,B=j.easing,Z=B===void 0?"ease":B,F=j.style,H=j.properties,Y=j.onAnimationEnd,te=L>0?h[L-1]:j,pe=H||Object.keys(F);if(typeof Z=="function"||Z==="spring")return[].concat(GA(R),[l.runJSAnimation.bind(l,{from:te.style,to:F,duration:z,easing:Z}),z]);var ue=hF(pe,z,Z),Ee=Aa(Aa(Aa({},te.style),F),{},{transition:ue});return[].concat(GA(R),[Ee,z,Y]).filter(nPe)};return this.manager.start([s].concat(GA(h.reduce(k,[b,Math.max(A,f)])),[o.onAnimationEnd]))}},{key:"runAnimation",value:function(o){this.manager||(this.manager=QAe());var l=o.begin,h=o.duration,f=o.attributeName,s=o.to,y=o.easing,b=o.onAnimationStart,w=o.onAnimationEnd,A=o.steps,k=o.children,M=this.manager;if(this.unSubscribe=M.subscribe(this.handleStyleChange),typeof y=="function"||typeof k=="function"||y==="spring"){this.runJSAnimation(o);return}if(A.length>1){this.runStepAnimation(o);return}var R=f?qy({},f,s):s,j=hF(Object.keys(R),h,y);M.start([b,l,Aa(Aa({},R),{},{transition:j}),h,w])}},{key:"render",value:function(){var o=this.props,l=o.children;o.begin;var h=o.duration;o.attributeName,o.easing;var f=o.isActive;o.steps,o.from,o.to,o.canBegin,o.onAnimationEnd,o.shouldReAnimate,o.onAnimationReStart;var s=CPe(o,PPe),y=re.Children.count(l),b=this.state.style;if(typeof l=="function")return l(b);if(!f||y===0||h<=0)return l;var w=function(k){var M=k.props,R=M.style,j=R===void 0?{}:R,L=M.className,z=re.cloneElement(k,Aa(Aa({},s),{},{style:Aa(Aa({},j),b),className:L}));return z};return y===1?w(re.Children.only(l)):Ce.createElement("div",null,re.Children.map(l,function(A){return w(A)}))}}]),r}(re.PureComponent);Ga.displayName="Animate";Ga.defaultProps={begin:0,duration:1e3,from:"",to:"",attributeName:"",easing:"ease",isActive:!0,canBegin:!0,steps:[],onAnimationEnd:function(){},onAnimationStart:function(){}};Ga.propTypes={from:ln.oneOfType([ln.object,ln.string]),to:ln.oneOfType([ln.object,ln.string]),attributeName:ln.string,duration:ln.number,begin:ln.number,easing:ln.oneOfType([ln.string,ln.func]),steps:ln.arrayOf(ln.shape({duration:ln.number.isRequired,style:ln.object.isRequired,easing:ln.oneOfType([ln.oneOf(["ease","ease-in","ease-out","ease-in-out","linear"]),ln.func]),properties:ln.arrayOf("string"),onAnimationEnd:ln.func})),children:ln.oneOfType([ln.node,ln.func]),isActive:ln.bool,canBegin:ln.bool,onAnimationEnd:ln.func,shouldReAnimate:ln.bool,onAnimationStart:ln.func,onAnimationReStart:ln.func};function y_(e){"@babel/helpers - typeof";return y_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},y_(e)}function Xw(){return Xw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Xw.apply(this,arguments)}function FPe(e,t){return WPe(e)||GPe(e,t)||VPe(e,t)||UPe()}function UPe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function VPe(e,t){if(e){if(typeof e=="string")return yF(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return yF(e,t)}}function yF(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function GPe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,l,h,f=[],s=!0,y=!1;try{if(l=(r=r.call(e)).next,t!==0)for(;!(s=(n=l.call(r)).done)&&(f.push(n.value),f.length!==t);s=!0);}catch(b){y=!0,o=b}finally{try{if(!s&&r.return!=null&&(h=r.return(),Object(h)!==h))return}finally{if(y)throw o}}return f}}function WPe(e){if(Array.isArray(e))return e}function vF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function _F(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?vF(Object(r),!0).forEach(function(n){qPe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):vF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function qPe(e,t,r){return t=HPe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function HPe(e){var t=KPe(e,"string");return y_(t)=="symbol"?t:t+""}function KPe(e,t){if(y_(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(y_(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var xF=function(t,r,n,o,l){var h=Math.min(Math.abs(n)/2,Math.abs(o)/2),f=o>=0?1:-1,s=n>=0?1:-1,y=o>=0&&n>=0||o<0&&n<0?1:0,b;if(h>0&&l instanceof Array){for(var w=[0,0,0,0],A=0,k=4;A<k;A++)w[A]=l[A]>h?h:l[A];b="M".concat(t,",").concat(r+f*w[0]),w[0]>0&&(b+="A ".concat(w[0],",").concat(w[0],",0,0,").concat(y,",").concat(t+s*w[0],",").concat(r)),b+="L ".concat(t+n-s*w[1],",").concat(r),w[1]>0&&(b+="A ".concat(w[1],",").concat(w[1],",0,0,").concat(y,`,
        `).concat(t+n,",").concat(r+f*w[1])),b+="L ".concat(t+n,",").concat(r+o-f*w[2]),w[2]>0&&(b+="A ".concat(w[2],",").concat(w[2],",0,0,").concat(y,`,
        `).concat(t+n-s*w[2],",").concat(r+o)),b+="L ".concat(t+s*w[3],",").concat(r+o),w[3]>0&&(b+="A ".concat(w[3],",").concat(w[3],",0,0,").concat(y,`,
        `).concat(t,",").concat(r+o-f*w[3])),b+="Z"}else if(h>0&&l===+l&&l>0){var M=Math.min(h,l);b="M ".concat(t,",").concat(r+f*M,`
            A `).concat(M,",").concat(M,",0,0,").concat(y,",").concat(t+s*M,",").concat(r,`
            L `).concat(t+n-s*M,",").concat(r,`
            A `).concat(M,",").concat(M,",0,0,").concat(y,",").concat(t+n,",").concat(r+f*M,`
            L `).concat(t+n,",").concat(r+o-f*M,`
            A `).concat(M,",").concat(M,",0,0,").concat(y,",").concat(t+n-s*M,",").concat(r+o,`
            L `).concat(t+s*M,",").concat(r+o,`
            A `).concat(M,",").concat(M,",0,0,").concat(y,",").concat(t,",").concat(r+o-f*M," Z")}else b="M ".concat(t,",").concat(r," h ").concat(n," v ").concat(o," h ").concat(-n," Z");return b},ZPe=function(t,r){if(!t||!r)return!1;var n=t.x,o=t.y,l=r.x,h=r.y,f=r.width,s=r.height;if(Math.abs(f)>0&&Math.abs(s)>0){var y=Math.min(l,l+f),b=Math.max(l,l+f),w=Math.min(h,h+s),A=Math.max(h,h+s);return n>=y&&n<=b&&o>=w&&o<=A}return!1},XPe={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},aR=function(t){var r=_F(_F({},XPe),t),n=re.useRef(),o=re.useState(-1),l=FPe(o,2),h=l[0],f=l[1];re.useEffect(function(){if(n.current&&n.current.getTotalLength)try{var Z=n.current.getTotalLength();Z&&f(Z)}catch{}},[]);var s=r.x,y=r.y,b=r.width,w=r.height,A=r.radius,k=r.className,M=r.animationEasing,R=r.animationDuration,j=r.animationBegin,L=r.isAnimationActive,z=r.isUpdateAnimationActive;if(s!==+s||y!==+y||b!==+b||w!==+w||b===0||w===0)return null;var B=zr("recharts-rectangle",k);return z?Ce.createElement(Ga,{canBegin:h>0,from:{width:b,height:w,x:s,y},to:{width:b,height:w,x:s,y},duration:R,animationEasing:M,isActive:z},function(Z){var F=Z.width,H=Z.height,Y=Z.x,te=Z.y;return Ce.createElement(Ga,{canBegin:h>0,from:"0px ".concat(h===-1?1:h,"px"),to:"".concat(h,"px 0px"),attributeName:"strokeDasharray",begin:j,duration:R,isActive:L,easing:M},Ce.createElement("path",Xw({},Sr(r,!0),{className:B,d:xF(Y,te,F,H,A),ref:n})))}):Ce.createElement("path",Xw({},Sr(r,!0),{className:B,d:xF(s,y,b,w,A)}))};function Uk(){return Uk=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Uk.apply(this,arguments)}var AS=function(t){var r=t.cx,n=t.cy,o=t.r,l=t.className,h=zr("recharts-dot",l);return r===+r&&n===+n&&o===+o?re.createElement("circle",Uk({},Sr(t,!1),mw(t),{className:h,cx:r,cy:n,r:o})):null};function v_(e){"@babel/helpers - typeof";return v_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},v_(e)}var YPe=["x","y","top","left","width","height","className"];function Vk(){return Vk=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Vk.apply(this,arguments)}function bF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function JPe(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?bF(Object(r),!0).forEach(function(n){QPe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):bF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function QPe(e,t,r){return t=eCe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function eCe(e){var t=tCe(e,"string");return v_(t)=="symbol"?t:t+""}function tCe(e,t){if(v_(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(v_(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function rCe(e,t){if(e==null)return{};var r=nCe(e,t),n,o;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(o=0;o<l.length;o++)n=l[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function nCe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var iCe=function(t,r,n,o,l,h){return"M".concat(t,",").concat(l,"v").concat(o,"M").concat(h,",").concat(r,"h").concat(n)},oCe=function(t){var r=t.x,n=r===void 0?0:r,o=t.y,l=o===void 0?0:o,h=t.top,f=h===void 0?0:h,s=t.left,y=s===void 0?0:s,b=t.width,w=b===void 0?0:b,A=t.height,k=A===void 0?0:A,M=t.className,R=rCe(t,YPe),j=JPe({x:n,y:l,top:f,left:y,width:w,height:k},R);return!It(n)||!It(l)||!It(w)||!It(k)||!It(f)||!It(y)?null:Ce.createElement("path",Vk({},Sr(j,!0),{className:zr("recharts-cross",M),d:iCe(n,l,w,k,f,y)}))},sCe=zG,aCe=sCe(Object.getPrototypeOf,Object),lCe=aCe,cCe=wc,uCe=lCe,hCe=Sc,dCe="[object Object]",fCe=Function.prototype,pCe=Object.prototype,Sq=fCe.toString,mCe=pCe.hasOwnProperty,gCe=Sq.call(Object);function yCe(e){if(!hCe(e)||cCe(e)!=dCe)return!1;var t=uCe(e);if(t===null)return!0;var r=mCe.call(t,"constructor")&&t.constructor;return typeof r=="function"&&r instanceof r&&Sq.call(r)==gCe}var vCe=yCe;const _Ce=mn(vCe);var xCe=wc,bCe=Sc,wCe="[object Boolean]";function SCe(e){return e===!0||e===!1||bCe(e)&&xCe(e)==wCe}var TCe=SCe;const ECe=mn(TCe);function __(e){"@babel/helpers - typeof";return __=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},__(e)}function Yw(){return Yw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Yw.apply(this,arguments)}function ACe(e,t){return OCe(e)||kCe(e,t)||CCe(e,t)||PCe()}function PCe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function CCe(e,t){if(e){if(typeof e=="string")return wF(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return wF(e,t)}}function wF(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function kCe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,l,h,f=[],s=!0,y=!1;try{if(l=(r=r.call(e)).next,t!==0)for(;!(s=(n=l.call(r)).done)&&(f.push(n.value),f.length!==t);s=!0);}catch(b){y=!0,o=b}finally{try{if(!s&&r.return!=null&&(h=r.return(),Object(h)!==h))return}finally{if(y)throw o}}return f}}function OCe(e){if(Array.isArray(e))return e}function SF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function TF(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?SF(Object(r),!0).forEach(function(n){MCe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):SF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function MCe(e,t,r){return t=ICe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ICe(e){var t=RCe(e,"string");return __(t)=="symbol"?t:t+""}function RCe(e,t){if(__(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(__(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var EF=function(t,r,n,o,l){var h=n-o,f;return f="M ".concat(t,",").concat(r),f+="L ".concat(t+n,",").concat(r),f+="L ".concat(t+n-h/2,",").concat(r+l),f+="L ".concat(t+n-h/2-o,",").concat(r+l),f+="L ".concat(t,",").concat(r," Z"),f},DCe={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},LCe=function(t){var r=TF(TF({},DCe),t),n=re.useRef(),o=re.useState(-1),l=ACe(o,2),h=l[0],f=l[1];re.useEffect(function(){if(n.current&&n.current.getTotalLength)try{var B=n.current.getTotalLength();B&&f(B)}catch{}},[]);var s=r.x,y=r.y,b=r.upperWidth,w=r.lowerWidth,A=r.height,k=r.className,M=r.animationEasing,R=r.animationDuration,j=r.animationBegin,L=r.isUpdateAnimationActive;if(s!==+s||y!==+y||b!==+b||w!==+w||A!==+A||b===0&&w===0||A===0)return null;var z=zr("recharts-trapezoid",k);return L?Ce.createElement(Ga,{canBegin:h>0,from:{upperWidth:0,lowerWidth:0,height:A,x:s,y},to:{upperWidth:b,lowerWidth:w,height:A,x:s,y},duration:R,animationEasing:M,isActive:L},function(B){var Z=B.upperWidth,F=B.lowerWidth,H=B.height,Y=B.x,te=B.y;return Ce.createElement(Ga,{canBegin:h>0,from:"0px ".concat(h===-1?1:h,"px"),to:"".concat(h,"px 0px"),attributeName:"strokeDasharray",begin:j,duration:R,easing:M},Ce.createElement("path",Yw({},Sr(r,!0),{className:z,d:EF(Y,te,Z,F,H),ref:n})))}):Ce.createElement("g",null,Ce.createElement("path",Yw({},Sr(r,!0),{className:z,d:EF(s,y,b,w,A)})))},jCe=["option","shapeType","propTransformer","activeClassName","isActive"];function x_(e){"@babel/helpers - typeof";return x_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},x_(e)}function zCe(e,t){if(e==null)return{};var r=BCe(e,t),n,o;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(o=0;o<l.length;o++)n=l[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function BCe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function AF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function Jw(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?AF(Object(r),!0).forEach(function(n){NCe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):AF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function NCe(e,t,r){return t=$Ce(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function $Ce(e){var t=FCe(e,"string");return x_(t)=="symbol"?t:t+""}function FCe(e,t){if(x_(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(x_(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function UCe(e,t){return Jw(Jw({},t),e)}function VCe(e,t){return e==="symbols"}function PF(e){var t=e.shapeType,r=e.elementProps;switch(t){case"rectangle":return Ce.createElement(aR,r);case"trapezoid":return Ce.createElement(LCe,r);case"sector":return Ce.createElement(dq,r);case"symbols":if(VCe(t))return Ce.createElement(fS,r);break;default:return null}}function GCe(e){return re.isValidElement(e)?e.props:e}function Gk(e){var t=e.option,r=e.shapeType,n=e.propTransformer,o=n===void 0?UCe:n,l=e.activeClassName,h=l===void 0?"recharts-active-shape":l,f=e.isActive,s=zCe(e,jCe),y;if(re.isValidElement(t))y=re.cloneElement(t,Jw(Jw({},s),GCe(t)));else if(Ar(t))y=t(s);else if(_Ce(t)&&!ECe(t)){var b=o(t,s);y=Ce.createElement(PF,{shapeType:r,elementProps:b})}else{var w=s;y=Ce.createElement(PF,{shapeType:r,elementProps:w})}return f?Ce.createElement(sn,{className:h},y):y}function PS(e,t){return t!=null&&"trapezoids"in e.props}function CS(e,t){return t!=null&&"sectors"in e.props}function b_(e,t){return t!=null&&"points"in e.props}function WCe(e,t){var r,n,o=e.x===(t==null||(r=t.labelViewBox)===null||r===void 0?void 0:r.x)||e.x===t.x,l=e.y===(t==null||(n=t.labelViewBox)===null||n===void 0?void 0:n.y)||e.y===t.y;return o&&l}function qCe(e,t){var r=e.endAngle===t.endAngle,n=e.startAngle===t.startAngle;return r&&n}function HCe(e,t){var r=e.x===t.x,n=e.y===t.y,o=e.z===t.z;return r&&n&&o}function KCe(e,t){var r;return PS(e,t)?r=WCe:CS(e,t)?r=qCe:b_(e,t)&&(r=HCe),r}function ZCe(e,t){var r;return PS(e,t)?r="trapezoids":CS(e,t)?r="sectors":b_(e,t)&&(r="points"),r}function XCe(e,t){if(PS(e,t)){var r;return(r=t.tooltipPayload)===null||r===void 0||(r=r[0])===null||r===void 0||(r=r.payload)===null||r===void 0?void 0:r.payload}if(CS(e,t)){var n;return(n=t.tooltipPayload)===null||n===void 0||(n=n[0])===null||n===void 0||(n=n.payload)===null||n===void 0?void 0:n.payload}return b_(e,t)?t.payload:{}}function YCe(e){var t=e.activeTooltipItem,r=e.graphicalItem,n=e.itemData,o=ZCe(r,t),l=XCe(r,t),h=n.filter(function(s,y){var b=Sd(l,s),w=r.props[o].filter(function(M){var R=KCe(r,t);return R(M,t)}),A=r.props[o].indexOf(w[w.length-1]),k=y===A;return b&&k}),f=n.indexOf(h[h.length-1]);return f}var JCe=Math.ceil,QCe=Math.max;function eke(e,t,r,n){for(var o=-1,l=QCe(JCe((t-e)/(r||1)),0),h=Array(l);l--;)h[n?l:++o]=e,e+=r;return h}var tke=eke,rke=rW,CF=1/0,nke=17976931348623157e292;function ike(e){if(!e)return e===0?e:0;if(e=rke(e),e===CF||e===-CF){var t=e<0?-1:1;return t*nke}return e===e?e:0}var Tq=ike,oke=tke,ske=gS,WA=Tq;function ake(e){return function(t,r,n){return n&&typeof n!="number"&&ske(t,r,n)&&(r=n=void 0),t=WA(t),r===void 0?(r=t,t=0):r=WA(r),n=n===void 0?t<r?1:-1:WA(n),oke(t,r,n,e)}}var lke=ake,cke=lke,uke=cke(),hke=uke;const Qw=mn(hke);function w_(e){"@babel/helpers - typeof";return w_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},w_(e)}function kF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function OF(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?kF(Object(r),!0).forEach(function(n){Eq(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):kF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Eq(e,t,r){return t=dke(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function dke(e){var t=fke(e,"string");return w_(t)=="symbol"?t:t+""}function fke(e,t){if(w_(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(w_(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var pke=["Webkit","Moz","O","ms"],mke=function(t,r){var n=t.replace(/(\w)/,function(l){return l.toUpperCase()}),o=pke.reduce(function(l,h){return OF(OF({},l),{},Eq({},h+n,r))},{});return o[t]=r,o};function tm(e){"@babel/helpers - typeof";return tm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tm(e)}function e1(){return e1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},e1.apply(this,arguments)}function MF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function qA(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?MF(Object(r),!0).forEach(function(n){_s(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):MF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function gke(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function IF(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Pq(n.key),n)}}function yke(e,t,r){return t&&IF(e.prototype,t),r&&IF(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function vke(e,t,r){return t=t1(t),_ke(e,Aq()?Reflect.construct(t,r||[],t1(e).constructor):t.apply(e,r))}function _ke(e,t){if(t&&(tm(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return xke(e)}function xke(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Aq(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Aq=function(){return!!e})()}function t1(e){return t1=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},t1(e)}function bke(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Wk(e,t)}function Wk(e,t){return Wk=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},Wk(e,t)}function _s(e,t,r){return t=Pq(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Pq(e){var t=wke(e,"string");return tm(t)=="symbol"?t:t+""}function wke(e,t){if(tm(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(tm(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Ske=function(t){var r=t.data,n=t.startIndex,o=t.endIndex,l=t.x,h=t.width,f=t.travellerWidth;if(!r||!r.length)return{};var s=r.length,y=cv().domain(Qw(0,s)).range([l,l+h-f]),b=y.domain().map(function(w){return y(w)});return{isTextActive:!1,isSlideMoving:!1,isTravellerMoving:!1,isTravellerFocused:!1,startX:y(n),endX:y(o),scale:y,scaleValues:b}},RF=function(t){return t.changedTouches&&!!t.changedTouches.length},rm=function(e){function t(r){var n;return gke(this,t),n=vke(this,t,[r]),_s(n,"handleDrag",function(o){n.leaveTimer&&(clearTimeout(n.leaveTimer),n.leaveTimer=null),n.state.isTravellerMoving?n.handleTravellerMove(o):n.state.isSlideMoving&&n.handleSlideDrag(o)}),_s(n,"handleTouchMove",function(o){o.changedTouches!=null&&o.changedTouches.length>0&&n.handleDrag(o.changedTouches[0])}),_s(n,"handleDragEnd",function(){n.setState({isTravellerMoving:!1,isSlideMoving:!1},function(){var o=n.props,l=o.endIndex,h=o.onDragEnd,f=o.startIndex;h==null||h({endIndex:l,startIndex:f})}),n.detachDragEndListener()}),_s(n,"handleLeaveWrapper",function(){(n.state.isTravellerMoving||n.state.isSlideMoving)&&(n.leaveTimer=window.setTimeout(n.handleDragEnd,n.props.leaveTimeOut))}),_s(n,"handleEnterSlideOrTraveller",function(){n.setState({isTextActive:!0})}),_s(n,"handleLeaveSlideOrTraveller",function(){n.setState({isTextActive:!1})}),_s(n,"handleSlideDragStart",function(o){var l=RF(o)?o.changedTouches[0]:o;n.setState({isTravellerMoving:!1,isSlideMoving:!0,slideMoveStartX:l.pageX}),n.attachDragEndListener()}),n.travellerDragStartHandlers={startX:n.handleTravellerDragStart.bind(n,"startX"),endX:n.handleTravellerDragStart.bind(n,"endX")},n.state={},n}return bke(t,e),yke(t,[{key:"componentWillUnmount",value:function(){this.leaveTimer&&(clearTimeout(this.leaveTimer),this.leaveTimer=null),this.detachDragEndListener()}},{key:"getIndex",value:function(n){var o=n.startX,l=n.endX,h=this.state.scaleValues,f=this.props,s=f.gap,y=f.data,b=y.length-1,w=Math.min(o,l),A=Math.max(o,l),k=t.getIndexInRange(h,w),M=t.getIndexInRange(h,A);return{startIndex:k-k%s,endIndex:M===b?b:M-M%s}}},{key:"getTextOfTick",value:function(n){var o=this.props,l=o.data,h=o.tickFormatter,f=o.dataKey,s=Li(l[n],f,n);return Ar(h)?h(s,n):s}},{key:"attachDragEndListener",value:function(){window.addEventListener("mouseup",this.handleDragEnd,!0),window.addEventListener("touchend",this.handleDragEnd,!0),window.addEventListener("mousemove",this.handleDrag,!0)}},{key:"detachDragEndListener",value:function(){window.removeEventListener("mouseup",this.handleDragEnd,!0),window.removeEventListener("touchend",this.handleDragEnd,!0),window.removeEventListener("mousemove",this.handleDrag,!0)}},{key:"handleSlideDrag",value:function(n){var o=this.state,l=o.slideMoveStartX,h=o.startX,f=o.endX,s=this.props,y=s.x,b=s.width,w=s.travellerWidth,A=s.startIndex,k=s.endIndex,M=s.onChange,R=n.pageX-l;R>0?R=Math.min(R,y+b-w-f,y+b-w-h):R<0&&(R=Math.max(R,y-h,y-f));var j=this.getIndex({startX:h+R,endX:f+R});(j.startIndex!==A||j.endIndex!==k)&&M&&M(j),this.setState({startX:h+R,endX:f+R,slideMoveStartX:n.pageX})}},{key:"handleTravellerDragStart",value:function(n,o){var l=RF(o)?o.changedTouches[0]:o;this.setState({isSlideMoving:!1,isTravellerMoving:!0,movingTravellerId:n,brushMoveStartX:l.pageX}),this.attachDragEndListener()}},{key:"handleTravellerMove",value:function(n){var o=this.state,l=o.brushMoveStartX,h=o.movingTravellerId,f=o.endX,s=o.startX,y=this.state[h],b=this.props,w=b.x,A=b.width,k=b.travellerWidth,M=b.onChange,R=b.gap,j=b.data,L={startX:this.state.startX,endX:this.state.endX},z=n.pageX-l;z>0?z=Math.min(z,w+A-k-y):z<0&&(z=Math.max(z,w-y)),L[h]=y+z;var B=this.getIndex(L),Z=B.startIndex,F=B.endIndex,H=function(){var te=j.length-1;return h==="startX"&&(f>s?Z%R===0:F%R===0)||f<s&&F===te||h==="endX"&&(f>s?F%R===0:Z%R===0)||f>s&&F===te};this.setState(_s(_s({},h,y+z),"brushMoveStartX",n.pageX),function(){M&&H()&&M(B)})}},{key:"handleTravellerMoveKeyboard",value:function(n,o){var l=this,h=this.state,f=h.scaleValues,s=h.startX,y=h.endX,b=this.state[o],w=f.indexOf(b);if(w!==-1){var A=w+n;if(!(A===-1||A>=f.length)){var k=f[A];o==="startX"&&k>=y||o==="endX"&&k<=s||this.setState(_s({},o,k),function(){l.props.onChange(l.getIndex({startX:l.state.startX,endX:l.state.endX}))})}}}},{key:"renderBackground",value:function(){var n=this.props,o=n.x,l=n.y,h=n.width,f=n.height,s=n.fill,y=n.stroke;return Ce.createElement("rect",{stroke:y,fill:s,x:o,y:l,width:h,height:f})}},{key:"renderPanorama",value:function(){var n=this.props,o=n.x,l=n.y,h=n.width,f=n.height,s=n.data,y=n.children,b=n.padding,w=re.Children.only(y);return w?Ce.cloneElement(w,{x:o,y:l,width:h,height:f,margin:b,compact:!0,data:s}):null}},{key:"renderTravellerLayer",value:function(n,o){var l,h,f=this,s=this.props,y=s.y,b=s.travellerWidth,w=s.height,A=s.traveller,k=s.ariaLabel,M=s.data,R=s.startIndex,j=s.endIndex,L=Math.max(n,this.props.x),z=qA(qA({},Sr(this.props,!1)),{},{x:L,y,width:b,height:w}),B=k||"Min value: ".concat((l=M[R])===null||l===void 0?void 0:l.name,", Max value: ").concat((h=M[j])===null||h===void 0?void 0:h.name);return Ce.createElement(sn,{tabIndex:0,role:"slider","aria-label":B,"aria-valuenow":n,className:"recharts-brush-traveller",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.travellerDragStartHandlers[o],onTouchStart:this.travellerDragStartHandlers[o],onKeyDown:function(F){["ArrowLeft","ArrowRight"].includes(F.key)&&(F.preventDefault(),F.stopPropagation(),f.handleTravellerMoveKeyboard(F.key==="ArrowRight"?1:-1,o))},onFocus:function(){f.setState({isTravellerFocused:!0})},onBlur:function(){f.setState({isTravellerFocused:!1})},style:{cursor:"col-resize"}},t.renderTraveller(A,z))}},{key:"renderSlide",value:function(n,o){var l=this.props,h=l.y,f=l.height,s=l.stroke,y=l.travellerWidth,b=Math.min(n,o)+y,w=Math.max(Math.abs(o-n)-y,0);return Ce.createElement("rect",{className:"recharts-brush-slide",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.handleSlideDragStart,onTouchStart:this.handleSlideDragStart,style:{cursor:"move"},stroke:"none",fill:s,fillOpacity:.2,x:b,y:h,width:w,height:f})}},{key:"renderText",value:function(){var n=this.props,o=n.startIndex,l=n.endIndex,h=n.y,f=n.height,s=n.travellerWidth,y=n.stroke,b=this.state,w=b.startX,A=b.endX,k=5,M={pointerEvents:"none",fill:y};return Ce.createElement(sn,{className:"recharts-brush-texts"},Ce.createElement(kw,e1({textAnchor:"end",verticalAnchor:"middle",x:Math.min(w,A)-k,y:h+f/2},M),this.getTextOfTick(o)),Ce.createElement(kw,e1({textAnchor:"start",verticalAnchor:"middle",x:Math.max(w,A)+s+k,y:h+f/2},M),this.getTextOfTick(l)))}},{key:"render",value:function(){var n=this.props,o=n.data,l=n.className,h=n.children,f=n.x,s=n.y,y=n.width,b=n.height,w=n.alwaysShowText,A=this.state,k=A.startX,M=A.endX,R=A.isTextActive,j=A.isSlideMoving,L=A.isTravellerMoving,z=A.isTravellerFocused;if(!o||!o.length||!It(f)||!It(s)||!It(y)||!It(b)||y<=0||b<=0)return null;var B=zr("recharts-brush",l),Z=Ce.Children.count(h)===1,F=mke("userSelect","none");return Ce.createElement(sn,{className:B,onMouseLeave:this.handleLeaveWrapper,onTouchMove:this.handleTouchMove,style:F},this.renderBackground(),Z&&this.renderPanorama(),this.renderSlide(k,M),this.renderTravellerLayer(k,"startX"),this.renderTravellerLayer(M,"endX"),(R||j||L||z||w)&&this.renderText())}}],[{key:"renderDefaultTraveller",value:function(n){var o=n.x,l=n.y,h=n.width,f=n.height,s=n.stroke,y=Math.floor(l+f/2)-1;return Ce.createElement(Ce.Fragment,null,Ce.createElement("rect",{x:o,y:l,width:h,height:f,fill:s,stroke:"none"}),Ce.createElement("line",{x1:o+1,y1:y,x2:o+h-1,y2:y,fill:"none",stroke:"#fff"}),Ce.createElement("line",{x1:o+1,y1:y+2,x2:o+h-1,y2:y+2,fill:"none",stroke:"#fff"}))}},{key:"renderTraveller",value:function(n,o){var l;return Ce.isValidElement(n)?l=Ce.cloneElement(n,o):Ar(n)?l=n(o):l=t.renderDefaultTraveller(o),l}},{key:"getDerivedStateFromProps",value:function(n,o){var l=n.data,h=n.width,f=n.x,s=n.travellerWidth,y=n.updateId,b=n.startIndex,w=n.endIndex;if(l!==o.prevData||y!==o.prevUpdateId)return qA({prevData:l,prevTravellerWidth:s,prevUpdateId:y,prevX:f,prevWidth:h},l&&l.length?Ske({data:l,width:h,x:f,travellerWidth:s,startIndex:b,endIndex:w}):{scale:null,scaleValues:null});if(o.scale&&(h!==o.prevWidth||f!==o.prevX||s!==o.prevTravellerWidth)){o.scale.range([f,f+h-s]);var A=o.scale.domain().map(function(k){return o.scale(k)});return{prevData:l,prevTravellerWidth:s,prevUpdateId:y,prevX:f,prevWidth:h,startX:o.scale(n.startIndex),endX:o.scale(n.endIndex),scaleValues:A}}return null}},{key:"getIndexInRange",value:function(n,o){for(var l=n.length,h=0,f=l-1;f-h>1;){var s=Math.floor((h+f)/2);n[s]>o?f=s:h=s}return o>=n[f]?f:h}}])}(re.PureComponent);_s(rm,"displayName","Brush");_s(rm,"defaultProps",{height:40,travellerWidth:5,gap:1,fill:"#fff",stroke:"#666",padding:{top:1,right:1,bottom:1,left:1},leaveTimeOut:1e3,alwaysShowText:!1});var Tke=II;function Eke(e,t){var r;return Tke(e,function(n,o,l){return r=t(n,o,l),!r}),!!r}var Ake=Eke,Pke=kG,Cke=Wu,kke=Ake,Oke=ss,Mke=gS;function Ike(e,t,r){var n=Oke(e)?Pke:kke;return r&&Mke(e,t,r)&&(t=void 0),n(e,Cke(t))}var Rke=Ike;const Dke=mn(Rke);var Tl=function(t,r){var n=t.alwaysShow,o=t.ifOverflow;return n&&(o="extendDomain"),o===r},DF=YG;function Lke(e,t,r){t=="__proto__"&&DF?DF(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}var jke=Lke,zke=jke,Bke=ZG,Nke=Wu;function $ke(e,t){var r={};return t=Nke(t),Bke(e,function(n,o,l){zke(r,o,t(n,o,l))}),r}var Fke=$ke;const Uke=mn(Fke);function Vke(e,t){for(var r=-1,n=e==null?0:e.length;++r<n;)if(!t(e[r],r,e))return!1;return!0}var Gke=Vke,Wke=II;function qke(e,t){var r=!0;return Wke(e,function(n,o,l){return r=!!t(n,o,l),r}),r}var Hke=qke,Kke=Gke,Zke=Hke,Xke=Wu,Yke=ss,Jke=gS;function Qke(e,t,r){var n=Yke(e)?Kke:Zke;return r&&Jke(e,t,r)&&(t=void 0),n(e,Xke(t))}var eOe=Qke;const Cq=mn(eOe);var tOe=["x","y"];function S_(e){"@babel/helpers - typeof";return S_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},S_(e)}function qk(){return qk=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},qk.apply(this,arguments)}function LF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function jy(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?LF(Object(r),!0).forEach(function(n){rOe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):LF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function rOe(e,t,r){return t=nOe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function nOe(e){var t=iOe(e,"string");return S_(t)=="symbol"?t:t+""}function iOe(e,t){if(S_(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(S_(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function oOe(e,t){if(e==null)return{};var r=sOe(e,t),n,o;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(o=0;o<l.length;o++)n=l[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function sOe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function aOe(e,t){var r=e.x,n=e.y,o=oOe(e,tOe),l="".concat(r),h=parseInt(l,10),f="".concat(n),s=parseInt(f,10),y="".concat(t.height||o.height),b=parseInt(y,10),w="".concat(t.width||o.width),A=parseInt(w,10);return jy(jy(jy(jy(jy({},t),o),h?{x:h}:{}),s?{y:s}:{}),{},{height:b,width:A,name:t.name,radius:t.radius})}function jF(e){return Ce.createElement(Gk,qk({shapeType:"rectangle",propTransformer:aOe,activeClassName:"recharts-active-bar"},e))}var lOe=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return function(n,o){if(typeof t=="number")return t;var l=It(n)||whe(n);return l?t(n,o):(l||Ed(),r)}},cOe=["value","background"],kq;function nm(e){"@babel/helpers - typeof";return nm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nm(e)}function uOe(e,t){if(e==null)return{};var r=hOe(e,t),n,o;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(o=0;o<l.length;o++)n=l[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function hOe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function r1(){return r1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},r1.apply(this,arguments)}function zF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function gi(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?zF(Object(r),!0).forEach(function(n){xu(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):zF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function dOe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function BF(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Mq(n.key),n)}}function fOe(e,t,r){return t&&BF(e.prototype,t),r&&BF(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function pOe(e,t,r){return t=n1(t),mOe(e,Oq()?Reflect.construct(t,r||[],n1(e).constructor):t.apply(e,r))}function mOe(e,t){if(t&&(nm(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return gOe(e)}function gOe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Oq(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Oq=function(){return!!e})()}function n1(e){return n1=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},n1(e)}function yOe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Hk(e,t)}function Hk(e,t){return Hk=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},Hk(e,t)}function xu(e,t,r){return t=Mq(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Mq(e){var t=vOe(e,"string");return nm(t)=="symbol"?t:t+""}function vOe(e,t){if(nm(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(nm(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var vc=function(e){function t(){var r;dOe(this,t);for(var n=arguments.length,o=new Array(n),l=0;l<n;l++)o[l]=arguments[l];return r=pOe(this,t,[].concat(o)),xu(r,"state",{isAnimationFinished:!1}),xu(r,"id",Md("recharts-bar-")),xu(r,"handleAnimationEnd",function(){var h=r.props.onAnimationEnd;r.setState({isAnimationFinished:!0}),h&&h()}),xu(r,"handleAnimationStart",function(){var h=r.props.onAnimationStart;r.setState({isAnimationFinished:!1}),h&&h()}),r}return yOe(t,e),fOe(t,[{key:"renderRectanglesStatically",value:function(n){var o=this,l=this.props,h=l.shape,f=l.dataKey,s=l.activeIndex,y=l.activeBar,b=Sr(this.props,!1);return n&&n.map(function(w,A){var k=A===s,M=k?y:h,R=gi(gi(gi({},b),w),{},{isActive:k,option:M,index:A,dataKey:f,onAnimationStart:o.handleAnimationStart,onAnimationEnd:o.handleAnimationEnd});return Ce.createElement(sn,r1({className:"recharts-bar-rectangle"},qv(o.props,w,A),{key:"rectangle-".concat(w==null?void 0:w.x,"-").concat(w==null?void 0:w.y,"-").concat(w==null?void 0:w.value,"-").concat(A)}),Ce.createElement(jF,R))})}},{key:"renderRectanglesWithAnimation",value:function(){var n=this,o=this.props,l=o.data,h=o.layout,f=o.isAnimationActive,s=o.animationBegin,y=o.animationDuration,b=o.animationEasing,w=o.animationId,A=this.state.prevData;return Ce.createElement(Ga,{begin:s,duration:y,isActive:f,easing:b,from:{t:0},to:{t:1},key:"bar-".concat(w),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(k){var M=k.t,R=l.map(function(j,L){var z=A&&A[L];if(z){var B=li(z.x,j.x),Z=li(z.y,j.y),F=li(z.width,j.width),H=li(z.height,j.height);return gi(gi({},j),{},{x:B(M),y:Z(M),width:F(M),height:H(M)})}if(h==="horizontal"){var Y=li(0,j.height),te=Y(M);return gi(gi({},j),{},{y:j.y+j.height-te,height:te})}var pe=li(0,j.width),ue=pe(M);return gi(gi({},j),{},{width:ue})});return Ce.createElement(sn,null,n.renderRectanglesStatically(R))})}},{key:"renderRectangles",value:function(){var n=this.props,o=n.data,l=n.isAnimationActive,h=this.state.prevData;return l&&o&&o.length&&(!h||!Sd(h,o))?this.renderRectanglesWithAnimation():this.renderRectanglesStatically(o)}},{key:"renderBackground",value:function(){var n=this,o=this.props,l=o.data,h=o.dataKey,f=o.activeIndex,s=Sr(this.props.background,!1);return l.map(function(y,b){y.value;var w=y.background,A=uOe(y,cOe);if(!w)return null;var k=gi(gi(gi(gi(gi({},A),{},{fill:"#eee"},w),s),qv(n.props,y,b)),{},{onAnimationStart:n.handleAnimationStart,onAnimationEnd:n.handleAnimationEnd,dataKey:h,index:b,className:"recharts-bar-background-rectangle"});return Ce.createElement(jF,r1({key:"background-bar-".concat(b),option:n.props.background,isActive:b===f},k))})}},{key:"renderErrorBar",value:function(n,o){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var l=this.props,h=l.data,f=l.xAxis,s=l.yAxis,y=l.layout,b=l.children,w=os(b,$m);if(!w)return null;var A=y==="vertical"?h[0].height/2:h[0].width/2,k=function(j,L){var z=Array.isArray(j.value)?j.value[1]:j.value;return{x:j.x,y:j.y,value:z,errorVal:Li(j,L)}},M={clipPath:n?"url(#clipPath-".concat(o,")"):null};return Ce.createElement(sn,M,w.map(function(R){return Ce.cloneElement(R,{key:"error-bar-".concat(o,"-").concat(R.props.dataKey),data:h,xAxis:f,yAxis:s,layout:y,offset:A,dataPointFormatter:k})}))}},{key:"render",value:function(){var n=this.props,o=n.hide,l=n.data,h=n.className,f=n.xAxis,s=n.yAxis,y=n.left,b=n.top,w=n.width,A=n.height,k=n.isAnimationActive,M=n.background,R=n.id;if(o||!l||!l.length)return null;var j=this.state.isAnimationFinished,L=zr("recharts-bar",h),z=f&&f.allowDataOverflow,B=s&&s.allowDataOverflow,Z=z||B,F=wr(R)?this.id:R;return Ce.createElement(sn,{className:L},z||B?Ce.createElement("defs",null,Ce.createElement("clipPath",{id:"clipPath-".concat(F)},Ce.createElement("rect",{x:z?y:y-w/2,y:B?b:b-A/2,width:z?w:w*2,height:B?A:A*2}))):null,Ce.createElement(sn,{className:"recharts-bar-rectangles",clipPath:Z?"url(#clipPath-".concat(F,")"):null},M?this.renderBackground():null,this.renderRectangles()),this.renderErrorBar(Z,F),(!k||j)&&Sl.renderCallByParent(this.props,l))}}],[{key:"getDerivedStateFromProps",value:function(n,o){return n.animationId!==o.prevAnimationId?{prevAnimationId:n.animationId,curData:n.data,prevData:o.curData}:n.data!==o.curData?{curData:n.data}:null}}])}(re.PureComponent);kq=vc;xu(vc,"displayName","Bar");xu(vc,"defaultProps",{xAxisId:0,yAxisId:0,legendType:"rect",minPointSize:0,hide:!1,data:[],layout:"vertical",activeBar:!1,isAnimationActive:!qu.isSsr,animationBegin:0,animationDuration:400,animationEasing:"ease"});xu(vc,"getComposedData",function(e){var t=e.props,r=e.item,n=e.barPosition,o=e.bandSize,l=e.xAxis,h=e.yAxis,f=e.xAxisTicks,s=e.yAxisTicks,y=e.stackedData,b=e.dataStartIndex,w=e.displayedData,A=e.offset,k=WTe(n,r);if(!k)return null;var M=t.layout,R=r.type.defaultProps,j=R!==void 0?gi(gi({},R),r.props):r.props,L=j.dataKey,z=j.children,B=j.minPointSize,Z=M==="horizontal"?h:l,F=y?Z.scale.domain():null,H=QTe({numericAxis:Z}),Y=os(z,LI),te=w.map(function(pe,ue){var Ee,Oe,je,Ge,Ze,Ye;y?Ee=qTe(y[b+ue],F):(Ee=Li(pe,L),Array.isArray(Ee)||(Ee=[H,Ee]));var tt=lOe(B,kq.defaultProps.minPointSize)(Ee[1],ue);if(M==="horizontal"){var ze,De=[h.scale(Ee[0]),h.scale(Ee[1])],ut=De[0],ht=De[1];Oe=$$({axis:l,ticks:f,bandSize:o,offset:k.offset,entry:pe,index:ue}),je=(ze=ht??ut)!==null&&ze!==void 0?ze:void 0,Ge=k.size;var at=ut-ht;if(Ze=Number.isNaN(at)?0:at,Ye={x:Oe,y:h.y,width:Ge,height:h.height},Math.abs(tt)>0&&Math.abs(Ze)<Math.abs(tt)){var Lt=$a(Ze||tt)*(Math.abs(tt)-Math.abs(Ze));je-=Lt,Ze+=Lt}}else{var $t=[l.scale(Ee[0]),l.scale(Ee[1])],Tr=$t[0],Br=$t[1];if(Oe=Tr,je=$$({axis:h,ticks:s,bandSize:o,offset:k.offset,entry:pe,index:ue}),Ge=Br-Tr,Ze=k.size,Ye={x:l.x,y:je,width:l.width,height:Ze},Math.abs(tt)>0&&Math.abs(Ge)<Math.abs(tt)){var cn=$a(Ge||tt)*(Math.abs(tt)-Math.abs(Ge));Ge+=cn}}return gi(gi(gi({},pe),{},{x:Oe,y:je,width:Ge,height:Ze,value:y?Ee:Ee[1],payload:pe,background:Ye},Y&&Y[ue]&&Y[ue].props),{},{tooltipPayload:[cq(r,pe)],tooltipPosition:{x:Oe+Ge/2,y:je+Ze/2}})});return gi({data:te,layout:M},A)});function T_(e){"@babel/helpers - typeof";return T_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},T_(e)}function _Oe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function NF(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Iq(n.key),n)}}function xOe(e,t,r){return t&&NF(e.prototype,t),r&&NF(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function $F(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function ja(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?$F(Object(r),!0).forEach(function(n){kS(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$F(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function kS(e,t,r){return t=Iq(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Iq(e){var t=bOe(e,"string");return T_(t)=="symbol"?t:t+""}function bOe(e,t){if(T_(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(T_(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var lR=function(t,r,n,o,l){var h=t.width,f=t.height,s=t.layout,y=t.children,b=Object.keys(r),w={left:n.left,leftMirror:n.left,right:h-n.right,rightMirror:h-n.right,top:n.top,topMirror:n.top,bottom:f-n.bottom,bottomMirror:f-n.bottom},A=!!bs(y,vc);return b.reduce(function(k,M){var R=r[M],j=R.orientation,L=R.domain,z=R.padding,B=z===void 0?{}:z,Z=R.mirror,F=R.reversed,H="".concat(j).concat(Z?"Mirror":""),Y,te,pe,ue,Ee;if(R.type==="number"&&(R.padding==="gap"||R.padding==="no-gap")){var Oe=L[1]-L[0],je=1/0,Ge=R.categoricalDomain.sort(Ahe);if(Ge.forEach(function($t,Tr){Tr>0&&(je=Math.min(($t||0)-(Ge[Tr-1]||0),je))}),Number.isFinite(je)){var Ze=je/Oe,Ye=R.layout==="vertical"?n.height:n.width;if(R.padding==="gap"&&(Y=Ze*Ye/2),R.padding==="no-gap"){var tt=wd(t.barCategoryGap,Ze*Ye),ze=Ze*Ye/2;Y=ze-tt-(ze-tt)/Ye*tt}}}o==="xAxis"?te=[n.left+(B.left||0)+(Y||0),n.left+n.width-(B.right||0)-(Y||0)]:o==="yAxis"?te=s==="horizontal"?[n.top+n.height-(B.bottom||0),n.top+(B.top||0)]:[n.top+(B.top||0)+(Y||0),n.top+n.height-(B.bottom||0)-(Y||0)]:te=R.range,F&&(te=[te[1],te[0]]);var De=VTe(R,l,A),ut=De.scale,ht=De.realScaleType;ut.domain(L).range(te),GTe(ut);var at=JTe(ut,ja(ja({},R),{},{realScaleType:ht}));o==="xAxis"?(Ee=j==="top"&&!Z||j==="bottom"&&Z,pe=n.left,ue=w[H]-Ee*R.height):o==="yAxis"&&(Ee=j==="left"&&!Z||j==="right"&&Z,pe=w[H]-Ee*R.width,ue=n.top);var Lt=ja(ja(ja({},R),at),{},{realScaleType:ht,x:pe,y:ue,scale:ut,width:o==="xAxis"?n.width:R.width,height:o==="yAxis"?n.height:R.height});return Lt.bandSize=Vw(Lt,at),!R.hide&&o==="xAxis"?w[H]+=(Ee?-1:1)*Lt.height:R.hide||(w[H]+=(Ee?-1:1)*Lt.width),ja(ja({},k),{},kS({},M,Lt))},{})},Rq=function(t,r){var n=t.x,o=t.y,l=r.x,h=r.y;return{x:Math.min(n,l),y:Math.min(o,h),width:Math.abs(l-n),height:Math.abs(h-o)}},wOe=function(t){var r=t.x1,n=t.y1,o=t.x2,l=t.y2;return Rq({x:r,y:n},{x:o,y:l})},Dq=function(){function e(t){_Oe(this,e),this.scale=t}return xOe(e,[{key:"domain",get:function(){return this.scale.domain}},{key:"range",get:function(){return this.scale.range}},{key:"rangeMin",get:function(){return this.range()[0]}},{key:"rangeMax",get:function(){return this.range()[1]}},{key:"bandwidth",get:function(){return this.scale.bandwidth}},{key:"apply",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=n.bandAware,l=n.position;if(r!==void 0){if(l)switch(l){case"start":return this.scale(r);case"middle":{var h=this.bandwidth?this.bandwidth()/2:0;return this.scale(r)+h}case"end":{var f=this.bandwidth?this.bandwidth():0;return this.scale(r)+f}default:return this.scale(r)}if(o){var s=this.bandwidth?this.bandwidth()/2:0;return this.scale(r)+s}return this.scale(r)}}},{key:"isInRange",value:function(r){var n=this.range(),o=n[0],l=n[n.length-1];return o<=l?r>=o&&r<=l:r>=l&&r<=o}}],[{key:"create",value:function(r){return new e(r)}}])}();kS(Dq,"EPS",1e-4);var cR=function(t){var r=Object.keys(t).reduce(function(n,o){return ja(ja({},n),{},kS({},o,Dq.create(t[o])))},{});return ja(ja({},r),{},{apply:function(o){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},h=l.bandAware,f=l.position;return Uke(o,function(s,y){return r[y].apply(s,{bandAware:h,position:f})})},isInRange:function(o){return Cq(o,function(l,h){return r[h].isInRange(l)})}})};function SOe(e){return(e%180+180)%180}var TOe=function(t){var r=t.width,n=t.height,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,l=SOe(o),h=l*Math.PI/180,f=Math.atan(n/r),s=h>f&&h<Math.PI-f?n/Math.sin(h):r/Math.cos(h);return Math.abs(s)},EOe=Wu,AOe=V_,POe=pS;function COe(e){return function(t,r,n){var o=Object(t);if(!AOe(t)){var l=EOe(r);t=POe(t),r=function(f){return l(o[f],f,o)}}var h=e(t,r,n);return h>-1?o[l?t[h]:h]:void 0}}var kOe=COe,OOe=Tq;function MOe(e){var t=OOe(e),r=t%1;return t===t?r?t-r:t:0}var IOe=MOe,ROe=VG,DOe=Wu,LOe=IOe,jOe=Math.max;function zOe(e,t,r){var n=e==null?0:e.length;if(!n)return-1;var o=r==null?0:LOe(r);return o<0&&(o=jOe(n+o,0)),ROe(e,DOe(t),o)}var BOe=zOe,NOe=kOe,$Oe=BOe,FOe=NOe($Oe),UOe=FOe;const VOe=mn(UOe);var GOe=Cue(function(e){return{x:e.left,y:e.top,width:e.width,height:e.height}},function(e){return["l",e.left,"t",e.top,"w",e.width,"h",e.height].join("")}),uR=re.createContext(void 0),hR=re.createContext(void 0),Lq=re.createContext(void 0),jq=re.createContext({}),zq=re.createContext(void 0),Bq=re.createContext(0),Nq=re.createContext(0),FF=function(t){var r=t.state,n=r.xAxisMap,o=r.yAxisMap,l=r.offset,h=t.clipPathId,f=t.children,s=t.width,y=t.height,b=GOe(l);return Ce.createElement(uR.Provider,{value:n},Ce.createElement(hR.Provider,{value:o},Ce.createElement(jq.Provider,{value:l},Ce.createElement(Lq.Provider,{value:b},Ce.createElement(zq.Provider,{value:h},Ce.createElement(Bq.Provider,{value:y},Ce.createElement(Nq.Provider,{value:s},f)))))))},WOe=function(){return re.useContext(zq)},$q=function(t){var r=re.useContext(uR);r==null&&Ed();var n=r[t];return n==null&&Ed(),n},qOe=function(){var t=re.useContext(uR);return pu(t)},HOe=function(){var t=re.useContext(hR),r=VOe(t,function(n){return Cq(n.domain,Number.isFinite)});return r||pu(t)},Fq=function(t){var r=re.useContext(hR);r==null&&Ed();var n=r[t];return n==null&&Ed(),n},KOe=function(){var t=re.useContext(Lq);return t},ZOe=function(){return re.useContext(jq)},dR=function(){return re.useContext(Nq)},fR=function(){return re.useContext(Bq)};function im(e){"@babel/helpers - typeof";return im=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},im(e)}function XOe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function YOe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Vq(n.key),n)}}function JOe(e,t,r){return t&&YOe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function QOe(e,t,r){return t=i1(t),eMe(e,Uq()?Reflect.construct(t,r||[],i1(e).constructor):t.apply(e,r))}function eMe(e,t){if(t&&(im(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return tMe(e)}function tMe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Uq(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Uq=function(){return!!e})()}function i1(e){return i1=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},i1(e)}function rMe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Kk(e,t)}function Kk(e,t){return Kk=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},Kk(e,t)}function UF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function VF(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?UF(Object(r),!0).forEach(function(n){pR(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):UF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function pR(e,t,r){return t=Vq(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Vq(e){var t=nMe(e,"string");return im(t)=="symbol"?t:t+""}function nMe(e,t){if(im(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(im(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function iMe(e,t){return lMe(e)||aMe(e,t)||sMe(e,t)||oMe()}function oMe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function sMe(e,t){if(e){if(typeof e=="string")return GF(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return GF(e,t)}}function GF(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function aMe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,l,h,f=[],s=!0,y=!1;try{if(l=(r=r.call(e)).next,t!==0)for(;!(s=(n=l.call(r)).done)&&(f.push(n.value),f.length!==t);s=!0);}catch(b){y=!0,o=b}finally{try{if(!s&&r.return!=null&&(h=r.return(),Object(h)!==h))return}finally{if(y)throw o}}return f}}function lMe(e){if(Array.isArray(e))return e}function Zk(){return Zk=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Zk.apply(this,arguments)}var cMe=function(t,r){var n;return Ce.isValidElement(t)?n=Ce.cloneElement(t,r):Ar(t)?n=t(r):n=Ce.createElement("line",Zk({},r,{className:"recharts-reference-line-line"})),n},uMe=function(t,r,n,o,l,h,f,s,y){var b=l.x,w=l.y,A=l.width,k=l.height;if(n){var M=y.y,R=t.y.apply(M,{position:h});if(Tl(y,"discard")&&!t.y.isInRange(R))return null;var j=[{x:b+A,y:R},{x:b,y:R}];return s==="left"?j.reverse():j}if(r){var L=y.x,z=t.x.apply(L,{position:h});if(Tl(y,"discard")&&!t.x.isInRange(z))return null;var B=[{x:z,y:w+k},{x:z,y:w}];return f==="top"?B.reverse():B}if(o){var Z=y.segment,F=Z.map(function(H){return t.apply(H,{position:h})});return Tl(y,"discard")&&Dke(F,function(H){return!t.isInRange(H)})?null:F}return null};function hMe(e){var t=e.x,r=e.y,n=e.segment,o=e.xAxisId,l=e.yAxisId,h=e.shape,f=e.className,s=e.alwaysShow,y=WOe(),b=$q(o),w=Fq(l),A=KOe();if(!y||!A)return null;ac(s===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var k=cR({x:b.scale,y:w.scale}),M=Di(t),R=Di(r),j=n&&n.length===2,L=uMe(k,M,R,j,A,e.position,b.orientation,w.orientation,e);if(!L)return null;var z=iMe(L,2),B=z[0],Z=B.x,F=B.y,H=z[1],Y=H.x,te=H.y,pe=Tl(e,"hidden")?"url(#".concat(y,")"):void 0,ue=VF(VF({clipPath:pe},Sr(e,!0)),{},{x1:Z,y1:F,x2:Y,y2:te});return Ce.createElement(sn,{className:zr("recharts-reference-line",f)},cMe(h,ue),bo.renderCallByParent(e,wOe({x1:Z,y1:F,x2:Y,y2:te})))}var mR=function(e){function t(){return XOe(this,t),QOe(this,t,arguments)}return rMe(t,e),JOe(t,[{key:"render",value:function(){return Ce.createElement(hMe,this.props)}}])}(Ce.Component);pR(mR,"displayName","ReferenceLine");pR(mR,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,fill:"none",stroke:"#ccc",fillOpacity:1,strokeWidth:1,position:"middle"});function Xk(){return Xk=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Xk.apply(this,arguments)}function om(e){"@babel/helpers - typeof";return om=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},om(e)}function WF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function qF(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?WF(Object(r),!0).forEach(function(n){OS(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):WF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function dMe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function fMe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Wq(n.key),n)}}function pMe(e,t,r){return t&&fMe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function mMe(e,t,r){return t=o1(t),gMe(e,Gq()?Reflect.construct(t,r||[],o1(e).constructor):t.apply(e,r))}function gMe(e,t){if(t&&(om(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return yMe(e)}function yMe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Gq(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Gq=function(){return!!e})()}function o1(e){return o1=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},o1(e)}function vMe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Yk(e,t)}function Yk(e,t){return Yk=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},Yk(e,t)}function OS(e,t,r){return t=Wq(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Wq(e){var t=_Me(e,"string");return om(t)=="symbol"?t:t+""}function _Me(e,t){if(om(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(om(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var xMe=function(t){var r=t.x,n=t.y,o=t.xAxis,l=t.yAxis,h=cR({x:o.scale,y:l.scale}),f=h.apply({x:r,y:n},{bandAware:!0});return Tl(t,"discard")&&!h.isInRange(f)?null:f},MS=function(e){function t(){return dMe(this,t),mMe(this,t,arguments)}return vMe(t,e),pMe(t,[{key:"render",value:function(){var n=this.props,o=n.x,l=n.y,h=n.r,f=n.alwaysShow,s=n.clipPathId,y=Di(o),b=Di(l);if(ac(f===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.'),!y||!b)return null;var w=xMe(this.props);if(!w)return null;var A=w.x,k=w.y,M=this.props,R=M.shape,j=M.className,L=Tl(this.props,"hidden")?"url(#".concat(s,")"):void 0,z=qF(qF({clipPath:L},Sr(this.props,!0)),{},{cx:A,cy:k});return Ce.createElement(sn,{className:zr("recharts-reference-dot",j)},t.renderDot(R,z),bo.renderCallByParent(this.props,{x:A-h,y:k-h,width:2*h,height:2*h}))}}])}(Ce.Component);OS(MS,"displayName","ReferenceDot");OS(MS,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#fff",stroke:"#ccc",fillOpacity:1,strokeWidth:1});OS(MS,"renderDot",function(e,t){var r;return Ce.isValidElement(e)?r=Ce.cloneElement(e,t):Ar(e)?r=e(t):r=Ce.createElement(AS,Xk({},t,{cx:t.cx,cy:t.cy,className:"recharts-reference-dot-dot"})),r});function Jk(){return Jk=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Jk.apply(this,arguments)}function sm(e){"@babel/helpers - typeof";return sm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sm(e)}function HF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function KF(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?HF(Object(r),!0).forEach(function(n){IS(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):HF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function bMe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function wMe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Hq(n.key),n)}}function SMe(e,t,r){return t&&wMe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function TMe(e,t,r){return t=s1(t),EMe(e,qq()?Reflect.construct(t,r||[],s1(e).constructor):t.apply(e,r))}function EMe(e,t){if(t&&(sm(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return AMe(e)}function AMe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function qq(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(qq=function(){return!!e})()}function s1(e){return s1=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},s1(e)}function PMe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Qk(e,t)}function Qk(e,t){return Qk=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},Qk(e,t)}function IS(e,t,r){return t=Hq(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Hq(e){var t=CMe(e,"string");return sm(t)=="symbol"?t:t+""}function CMe(e,t){if(sm(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(sm(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var kMe=function(t,r,n,o,l){var h=l.x1,f=l.x2,s=l.y1,y=l.y2,b=l.xAxis,w=l.yAxis;if(!b||!w)return null;var A=cR({x:b.scale,y:w.scale}),k={x:t?A.x.apply(h,{position:"start"}):A.x.rangeMin,y:n?A.y.apply(s,{position:"start"}):A.y.rangeMin},M={x:r?A.x.apply(f,{position:"end"}):A.x.rangeMax,y:o?A.y.apply(y,{position:"end"}):A.y.rangeMax};return Tl(l,"discard")&&(!A.isInRange(k)||!A.isInRange(M))?null:Rq(k,M)},RS=function(e){function t(){return bMe(this,t),TMe(this,t,arguments)}return PMe(t,e),SMe(t,[{key:"render",value:function(){var n=this.props,o=n.x1,l=n.x2,h=n.y1,f=n.y2,s=n.className,y=n.alwaysShow,b=n.clipPathId;ac(y===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var w=Di(o),A=Di(l),k=Di(h),M=Di(f),R=this.props.shape;if(!w&&!A&&!k&&!M&&!R)return null;var j=kMe(w,A,k,M,this.props);if(!j&&!R)return null;var L=Tl(this.props,"hidden")?"url(#".concat(b,")"):void 0;return Ce.createElement(sn,{className:zr("recharts-reference-area",s)},t.renderRect(R,KF(KF({clipPath:L},Sr(this.props,!0)),j)),bo.renderCallByParent(this.props,j))}}])}(Ce.Component);IS(RS,"displayName","ReferenceArea");IS(RS,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#ccc",fillOpacity:.5,stroke:"none",strokeWidth:1});IS(RS,"renderRect",function(e,t){var r;return Ce.isValidElement(e)?r=Ce.cloneElement(e,t):Ar(e)?r=e(t):r=Ce.createElement(aR,Jk({},t,{className:"recharts-reference-area-rect"})),r});function Kq(e,t,r){if(t<1)return[];if(t===1&&r===void 0)return e;for(var n=[],o=0;o<e.length;o+=t)n.push(e[o]);return n}function OMe(e,t,r){var n={width:e.width+t.width,height:e.height+t.height};return TOe(n,r)}function MMe(e,t,r){var n=r==="width",o=e.x,l=e.y,h=e.width,f=e.height;return t===1?{start:n?o:l,end:n?o+h:l+f}:{start:n?o+h:l+f,end:n?o:l}}function a1(e,t,r,n,o){if(e*t<e*n||e*t>e*o)return!1;var l=r();return e*(t-e*l/2-n)>=0&&e*(t+e*l/2-o)<=0}function IMe(e,t){return Kq(e,t+1)}function RMe(e,t,r,n,o){for(var l=(n||[]).slice(),h=t.start,f=t.end,s=0,y=1,b=h,w=function(){var M=n==null?void 0:n[s];if(M===void 0)return{v:Kq(n,y)};var R=s,j,L=function(){return j===void 0&&(j=r(M,R)),j},z=M.coordinate,B=s===0||a1(e,z,L,b,f);B||(s=0,b=h,y+=1),B&&(b=z+e*(L()/2+o),s+=y)},A;y<=l.length;)if(A=w(),A)return A.v;return[]}function E_(e){"@babel/helpers - typeof";return E_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},E_(e)}function ZF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function _o(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ZF(Object(r),!0).forEach(function(n){DMe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ZF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function DMe(e,t,r){return t=LMe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function LMe(e){var t=jMe(e,"string");return E_(t)=="symbol"?t:t+""}function jMe(e,t){if(E_(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(E_(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function zMe(e,t,r,n,o){for(var l=(n||[]).slice(),h=l.length,f=t.start,s=t.end,y=function(A){var k=l[A],M,R=function(){return M===void 0&&(M=r(k,A)),M};if(A===h-1){var j=e*(k.coordinate+e*R()/2-s);l[A]=k=_o(_o({},k),{},{tickCoord:j>0?k.coordinate-j*e:k.coordinate})}else l[A]=k=_o(_o({},k),{},{tickCoord:k.coordinate});var L=a1(e,k.tickCoord,R,f,s);L&&(s=k.tickCoord-e*(R()/2+o),l[A]=_o(_o({},k),{},{isShow:!0}))},b=h-1;b>=0;b--)y(b);return l}function BMe(e,t,r,n,o,l){var h=(n||[]).slice(),f=h.length,s=t.start,y=t.end;if(l){var b=n[f-1],w=r(b,f-1),A=e*(b.coordinate+e*w/2-y);h[f-1]=b=_o(_o({},b),{},{tickCoord:A>0?b.coordinate-A*e:b.coordinate});var k=a1(e,b.tickCoord,function(){return w},s,y);k&&(y=b.tickCoord-e*(w/2+o),h[f-1]=_o(_o({},b),{},{isShow:!0}))}for(var M=l?f-1:f,R=function(z){var B=h[z],Z,F=function(){return Z===void 0&&(Z=r(B,z)),Z};if(z===0){var H=e*(B.coordinate-e*F()/2-s);h[z]=B=_o(_o({},B),{},{tickCoord:H<0?B.coordinate-H*e:B.coordinate})}else h[z]=B=_o(_o({},B),{},{tickCoord:B.coordinate});var Y=a1(e,B.tickCoord,F,s,y);Y&&(s=B.tickCoord+e*(F()/2+o),h[z]=_o(_o({},B),{},{isShow:!0}))},j=0;j<M;j++)R(j);return h}function gR(e,t,r){var n=e.tick,o=e.ticks,l=e.viewBox,h=e.minTickGap,f=e.orientation,s=e.interval,y=e.tickFormatter,b=e.unit,w=e.angle;if(!o||!o.length||!n)return[];if(It(s)||qu.isSsr)return IMe(o,typeof s=="number"&&It(s)?s:0);var A=[],k=f==="top"||f==="bottom"?"width":"height",M=b&&k==="width"?lv(b,{fontSize:t,letterSpacing:r}):{width:0,height:0},R=function(B,Z){var F=Ar(y)?y(B.value,Z):B.value;return k==="width"?OMe(lv(F,{fontSize:t,letterSpacing:r}),M,w):lv(F,{fontSize:t,letterSpacing:r})[k]},j=o.length>=2?$a(o[1].coordinate-o[0].coordinate):1,L=MMe(l,j,k);return s==="equidistantPreserveStart"?RMe(j,L,R,o,h):(s==="preserveStart"||s==="preserveStartEnd"?A=BMe(j,L,R,o,h,s==="preserveStartEnd"):A=zMe(j,L,R,o,h),A.filter(function(z){return z.isShow}))}var NMe=["viewBox"],$Me=["viewBox"],FMe=["ticks"];function am(e){"@babel/helpers - typeof";return am=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},am(e)}function yp(){return yp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},yp.apply(this,arguments)}function XF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function Ci(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?XF(Object(r),!0).forEach(function(n){yR(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):XF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function HA(e,t){if(e==null)return{};var r=UMe(e,t),n,o;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(o=0;o<l.length;o++)n=l[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function UMe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function VMe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function YF(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Xq(n.key),n)}}function GMe(e,t,r){return t&&YF(e.prototype,t),r&&YF(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function WMe(e,t,r){return t=l1(t),qMe(e,Zq()?Reflect.construct(t,r||[],l1(e).constructor):t.apply(e,r))}function qMe(e,t){if(t&&(am(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return HMe(e)}function HMe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Zq(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Zq=function(){return!!e})()}function l1(e){return l1=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},l1(e)}function KMe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&eO(e,t)}function eO(e,t){return eO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},eO(e,t)}function yR(e,t,r){return t=Xq(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Xq(e){var t=ZMe(e,"string");return am(t)=="symbol"?t:t+""}function ZMe(e,t){if(am(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(am(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Fm=function(e){function t(r){var n;return VMe(this,t),n=WMe(this,t,[r]),n.state={fontSize:"",letterSpacing:""},n}return KMe(t,e),GMe(t,[{key:"shouldComponentUpdate",value:function(n,o){var l=n.viewBox,h=HA(n,NMe),f=this.props,s=f.viewBox,y=HA(f,$Me);return!Mp(l,s)||!Mp(h,y)||!Mp(o,this.state)}},{key:"componentDidMount",value:function(){var n=this.layerReference;if(n){var o=n.getElementsByClassName("recharts-cartesian-axis-tick-value")[0];o&&this.setState({fontSize:window.getComputedStyle(o).fontSize,letterSpacing:window.getComputedStyle(o).letterSpacing})}}},{key:"getTickLineCoord",value:function(n){var o=this.props,l=o.x,h=o.y,f=o.width,s=o.height,y=o.orientation,b=o.tickSize,w=o.mirror,A=o.tickMargin,k,M,R,j,L,z,B=w?-1:1,Z=n.tickSize||b,F=It(n.tickCoord)?n.tickCoord:n.coordinate;switch(y){case"top":k=M=n.coordinate,j=h+ +!w*s,R=j-B*Z,z=R-B*A,L=F;break;case"left":R=j=n.coordinate,M=l+ +!w*f,k=M-B*Z,L=k-B*A,z=F;break;case"right":R=j=n.coordinate,M=l+ +w*f,k=M+B*Z,L=k+B*A,z=F;break;default:k=M=n.coordinate,j=h+ +w*s,R=j+B*Z,z=R+B*A,L=F;break}return{line:{x1:k,y1:R,x2:M,y2:j},tick:{x:L,y:z}}}},{key:"getTickTextAnchor",value:function(){var n=this.props,o=n.orientation,l=n.mirror,h;switch(o){case"left":h=l?"start":"end";break;case"right":h=l?"end":"start";break;default:h="middle";break}return h}},{key:"getTickVerticalAnchor",value:function(){var n=this.props,o=n.orientation,l=n.mirror,h="end";switch(o){case"left":case"right":h="middle";break;case"top":h=l?"start":"end";break;default:h=l?"end":"start";break}return h}},{key:"renderAxisLine",value:function(){var n=this.props,o=n.x,l=n.y,h=n.width,f=n.height,s=n.orientation,y=n.mirror,b=n.axisLine,w=Ci(Ci(Ci({},Sr(this.props,!1)),Sr(b,!1)),{},{fill:"none"});if(s==="top"||s==="bottom"){var A=+(s==="top"&&!y||s==="bottom"&&y);w=Ci(Ci({},w),{},{x1:o,y1:l+A*f,x2:o+h,y2:l+A*f})}else{var k=+(s==="left"&&!y||s==="right"&&y);w=Ci(Ci({},w),{},{x1:o+k*h,y1:l,x2:o+k*h,y2:l+f})}return Ce.createElement("line",yp({},w,{className:zr("recharts-cartesian-axis-line",ta(b,"className"))}))}},{key:"renderTicks",value:function(n,o,l){var h=this,f=this.props,s=f.tickLine,y=f.stroke,b=f.tick,w=f.tickFormatter,A=f.unit,k=gR(Ci(Ci({},this.props),{},{ticks:n}),o,l),M=this.getTickTextAnchor(),R=this.getTickVerticalAnchor(),j=Sr(this.props,!1),L=Sr(b,!1),z=Ci(Ci({},j),{},{fill:"none"},Sr(s,!1)),B=k.map(function(Z,F){var H=h.getTickLineCoord(Z),Y=H.line,te=H.tick,pe=Ci(Ci(Ci(Ci({textAnchor:M,verticalAnchor:R},j),{},{stroke:"none",fill:y},L),te),{},{index:F,payload:Z,visibleTicksCount:k.length,tickFormatter:w});return Ce.createElement(sn,yp({className:"recharts-cartesian-axis-tick",key:"tick-".concat(Z.value,"-").concat(Z.coordinate,"-").concat(Z.tickCoord)},qv(h.props,Z,F)),s&&Ce.createElement("line",yp({},z,Y,{className:zr("recharts-cartesian-axis-tick-line",ta(s,"className"))})),b&&t.renderTickItem(b,pe,"".concat(Ar(w)?w(Z.value,F):Z.value).concat(A||"")))});return Ce.createElement("g",{className:"recharts-cartesian-axis-ticks"},B)}},{key:"render",value:function(){var n=this,o=this.props,l=o.axisLine,h=o.width,f=o.height,s=o.ticksGenerator,y=o.className,b=o.hide;if(b)return null;var w=this.props,A=w.ticks,k=HA(w,FMe),M=A;return Ar(s)&&(M=A&&A.length>0?s(this.props):s(k)),h<=0||f<=0||!M||!M.length?null:Ce.createElement(sn,{className:zr("recharts-cartesian-axis",y),ref:function(j){n.layerReference=j}},l&&this.renderAxisLine(),this.renderTicks(M,this.state.fontSize,this.state.letterSpacing),bo.renderCallByParent(this.props))}}],[{key:"renderTickItem",value:function(n,o,l){var h,f=zr(o.className,"recharts-cartesian-axis-tick-value");return Ce.isValidElement(n)?h=Ce.cloneElement(n,Ci(Ci({},o),{},{className:f})):Ar(n)?h=n(Ci(Ci({},o),{},{className:f})):h=Ce.createElement(kw,yp({},o,{className:"recharts-cartesian-axis-tick-value"}),l),h}}])}(re.Component);yR(Fm,"displayName","CartesianAxis");yR(Fm,"defaultProps",{x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"});var XMe=["x1","y1","x2","y2","key"],YMe=["offset"];function Ad(e){"@babel/helpers - typeof";return Ad=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ad(e)}function JF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function wo(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?JF(Object(r),!0).forEach(function(n){JMe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):JF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function JMe(e,t,r){return t=QMe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function QMe(e){var t=eIe(e,"string");return Ad(t)=="symbol"?t:t+""}function eIe(e,t){if(Ad(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Ad(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function od(){return od=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},od.apply(this,arguments)}function QF(e,t){if(e==null)return{};var r=tIe(e,t),n,o;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(o=0;o<l.length;o++)n=l[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function tIe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var rIe=function(t){var r=t.fill;if(!r||r==="none")return null;var n=t.fillOpacity,o=t.x,l=t.y,h=t.width,f=t.height,s=t.ry;return Ce.createElement("rect",{x:o,y:l,ry:s,width:h,height:f,stroke:"none",fill:r,fillOpacity:n,className:"recharts-cartesian-grid-bg"})};function Yq(e,t){var r;if(Ce.isValidElement(e))r=Ce.cloneElement(e,t);else if(Ar(e))r=e(t);else{var n=t.x1,o=t.y1,l=t.x2,h=t.y2,f=t.key,s=QF(t,XMe),y=Sr(s,!1);y.offset;var b=QF(y,YMe);r=Ce.createElement("line",od({},b,{x1:n,y1:o,x2:l,y2:h,fill:"none",key:f}))}return r}function nIe(e){var t=e.x,r=e.width,n=e.horizontal,o=n===void 0?!0:n,l=e.horizontalPoints;if(!o||!l||!l.length)return null;var h=l.map(function(f,s){var y=wo(wo({},e),{},{x1:t,y1:f,x2:t+r,y2:f,key:"line-".concat(s),index:s});return Yq(o,y)});return Ce.createElement("g",{className:"recharts-cartesian-grid-horizontal"},h)}function iIe(e){var t=e.y,r=e.height,n=e.vertical,o=n===void 0?!0:n,l=e.verticalPoints;if(!o||!l||!l.length)return null;var h=l.map(function(f,s){var y=wo(wo({},e),{},{x1:f,y1:t,x2:f,y2:t+r,key:"line-".concat(s),index:s});return Yq(o,y)});return Ce.createElement("g",{className:"recharts-cartesian-grid-vertical"},h)}function oIe(e){var t=e.horizontalFill,r=e.fillOpacity,n=e.x,o=e.y,l=e.width,h=e.height,f=e.horizontalPoints,s=e.horizontal,y=s===void 0?!0:s;if(!y||!t||!t.length)return null;var b=f.map(function(A){return Math.round(A+o-o)}).sort(function(A,k){return A-k});o!==b[0]&&b.unshift(0);var w=b.map(function(A,k){var M=!b[k+1],R=M?o+h-A:b[k+1]-A;if(R<=0)return null;var j=k%t.length;return Ce.createElement("rect",{key:"react-".concat(k),y:A,x:n,height:R,width:l,stroke:"none",fill:t[j],fillOpacity:r,className:"recharts-cartesian-grid-bg"})});return Ce.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},w)}function sIe(e){var t=e.vertical,r=t===void 0?!0:t,n=e.verticalFill,o=e.fillOpacity,l=e.x,h=e.y,f=e.width,s=e.height,y=e.verticalPoints;if(!r||!n||!n.length)return null;var b=y.map(function(A){return Math.round(A+l-l)}).sort(function(A,k){return A-k});l!==b[0]&&b.unshift(0);var w=b.map(function(A,k){var M=!b[k+1],R=M?l+f-A:b[k+1]-A;if(R<=0)return null;var j=k%n.length;return Ce.createElement("rect",{key:"react-".concat(k),x:A,y:h,width:R,height:s,stroke:"none",fill:n[j],fillOpacity:o,className:"recharts-cartesian-grid-bg"})});return Ce.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},w)}var aIe=function(t,r){var n=t.xAxis,o=t.width,l=t.height,h=t.offset;return aq(gR(wo(wo(wo({},Fm.defaultProps),n),{},{ticks:nc(n,!0),viewBox:{x:0,y:0,width:o,height:l}})),h.left,h.left+h.width,r)},lIe=function(t,r){var n=t.yAxis,o=t.width,l=t.height,h=t.offset;return aq(gR(wo(wo(wo({},Fm.defaultProps),n),{},{ticks:nc(n,!0),viewBox:{x:0,y:0,width:o,height:l}})),h.top,h.top+h.height,r)},Hf={horizontal:!0,vertical:!0,stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[]};function dv(e){var t,r,n,o,l,h,f=dR(),s=fR(),y=ZOe(),b=wo(wo({},e),{},{stroke:(t=e.stroke)!==null&&t!==void 0?t:Hf.stroke,fill:(r=e.fill)!==null&&r!==void 0?r:Hf.fill,horizontal:(n=e.horizontal)!==null&&n!==void 0?n:Hf.horizontal,horizontalFill:(o=e.horizontalFill)!==null&&o!==void 0?o:Hf.horizontalFill,vertical:(l=e.vertical)!==null&&l!==void 0?l:Hf.vertical,verticalFill:(h=e.verticalFill)!==null&&h!==void 0?h:Hf.verticalFill,x:It(e.x)?e.x:y.left,y:It(e.y)?e.y:y.top,width:It(e.width)?e.width:y.width,height:It(e.height)?e.height:y.height}),w=b.x,A=b.y,k=b.width,M=b.height,R=b.syncWithTicks,j=b.horizontalValues,L=b.verticalValues,z=qOe(),B=HOe();if(!It(k)||k<=0||!It(M)||M<=0||!It(w)||w!==+w||!It(A)||A!==+A)return null;var Z=b.verticalCoordinatesGenerator||aIe,F=b.horizontalCoordinatesGenerator||lIe,H=b.horizontalPoints,Y=b.verticalPoints;if((!H||!H.length)&&Ar(F)){var te=j&&j.length,pe=F({yAxis:B?wo(wo({},B),{},{ticks:te?j:B.ticks}):void 0,width:f,height:s,offset:y},te?!0:R);ac(Array.isArray(pe),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(Ad(pe),"]")),Array.isArray(pe)&&(H=pe)}if((!Y||!Y.length)&&Ar(Z)){var ue=L&&L.length,Ee=Z({xAxis:z?wo(wo({},z),{},{ticks:ue?L:z.ticks}):void 0,width:f,height:s,offset:y},ue?!0:R);ac(Array.isArray(Ee),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(Ad(Ee),"]")),Array.isArray(Ee)&&(Y=Ee)}return Ce.createElement("g",{className:"recharts-cartesian-grid"},Ce.createElement(rIe,{fill:b.fill,fillOpacity:b.fillOpacity,x:b.x,y:b.y,width:b.width,height:b.height,ry:b.ry}),Ce.createElement(nIe,od({},b,{offset:y,horizontalPoints:H,xAxis:z,yAxis:B})),Ce.createElement(iIe,od({},b,{offset:y,verticalPoints:Y,xAxis:z,yAxis:B})),Ce.createElement(oIe,od({},b,{horizontalPoints:H})),Ce.createElement(sIe,od({},b,{verticalPoints:Y})))}dv.displayName="CartesianGrid";var cIe=["type","layout","connectNulls","ref"],uIe=["key"];function lm(e){"@babel/helpers - typeof";return lm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},lm(e)}function e4(e,t){if(e==null)return{};var r=hIe(e,t),n,o;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(o=0;o<l.length;o++)n=l[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function hIe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function fv(){return fv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},fv.apply(this,arguments)}function t4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function vs(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?t4(Object(r),!0).forEach(function(n){za(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):t4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Kf(e){return mIe(e)||pIe(e)||fIe(e)||dIe()}function dIe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function fIe(e,t){if(e){if(typeof e=="string")return tO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return tO(e,t)}}function pIe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function mIe(e){if(Array.isArray(e))return tO(e)}function tO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function gIe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r4(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Qq(n.key),n)}}function yIe(e,t,r){return t&&r4(e.prototype,t),r&&r4(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function vIe(e,t,r){return t=c1(t),_Ie(e,Jq()?Reflect.construct(t,r||[],c1(e).constructor):t.apply(e,r))}function _Ie(e,t){if(t&&(lm(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return xIe(e)}function xIe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Jq(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Jq=function(){return!!e})()}function c1(e){return c1=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},c1(e)}function bIe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&rO(e,t)}function rO(e,t){return rO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},rO(e,t)}function za(e,t,r){return t=Qq(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Qq(e){var t=wIe(e,"string");return lm(t)=="symbol"?t:t+""}function wIe(e,t){if(lm(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(lm(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var El=function(e){function t(){var r;gIe(this,t);for(var n=arguments.length,o=new Array(n),l=0;l<n;l++)o[l]=arguments[l];return r=vIe(this,t,[].concat(o)),za(r,"state",{isAnimationFinished:!0,totalLength:0}),za(r,"generateSimpleStrokeDasharray",function(h,f){return"".concat(f,"px ").concat(h-f,"px")}),za(r,"getStrokeDasharray",function(h,f,s){var y=s.reduce(function(L,z){return L+z});if(!y)return r.generateSimpleStrokeDasharray(f,h);for(var b=Math.floor(h/y),w=h%y,A=f-h,k=[],M=0,R=0;M<s.length;R+=s[M],++M)if(R+s[M]>w){k=[].concat(Kf(s.slice(0,M)),[w-R]);break}var j=k.length%2===0?[0,A]:[A];return[].concat(Kf(t.repeat(s,b)),Kf(k),j).map(function(L){return"".concat(L,"px")}).join(", ")}),za(r,"id",Md("recharts-line-")),za(r,"pathRef",function(h){r.mainCurve=h}),za(r,"handleAnimationEnd",function(){r.setState({isAnimationFinished:!0}),r.props.onAnimationEnd&&r.props.onAnimationEnd()}),za(r,"handleAnimationStart",function(){r.setState({isAnimationFinished:!1}),r.props.onAnimationStart&&r.props.onAnimationStart()}),r}return bIe(t,e),yIe(t,[{key:"componentDidMount",value:function(){if(this.props.isAnimationActive){var n=this.getTotalLength();this.setState({totalLength:n})}}},{key:"componentDidUpdate",value:function(){if(this.props.isAnimationActive){var n=this.getTotalLength();n!==this.state.totalLength&&this.setState({totalLength:n})}}},{key:"getTotalLength",value:function(){var n=this.mainCurve;try{return n&&n.getTotalLength&&n.getTotalLength()||0}catch{return 0}}},{key:"renderErrorBar",value:function(n,o){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var l=this.props,h=l.points,f=l.xAxis,s=l.yAxis,y=l.layout,b=l.children,w=os(b,$m);if(!w)return null;var A=function(R,j){return{x:R.x,y:R.y,value:R.value,errorVal:Li(R.payload,j)}},k={clipPath:n?"url(#clipPath-".concat(o,")"):null};return Ce.createElement(sn,k,w.map(function(M){return Ce.cloneElement(M,{key:"bar-".concat(M.props.dataKey),data:h,xAxis:f,yAxis:s,layout:y,dataPointFormatter:A})}))}},{key:"renderDots",value:function(n,o,l){var h=this.props.isAnimationActive;if(h&&!this.state.isAnimationFinished)return null;var f=this.props,s=f.dot,y=f.points,b=f.dataKey,w=Sr(this.props,!1),A=Sr(s,!0),k=y.map(function(R,j){var L=vs(vs(vs({key:"dot-".concat(j),r:3},w),A),{},{index:j,cx:R.x,cy:R.y,value:R.value,dataKey:b,payload:R.payload,points:y});return t.renderDotItem(s,L)}),M={clipPath:n?"url(#clipPath-".concat(o?"":"dots-").concat(l,")"):null};return Ce.createElement(sn,fv({className:"recharts-line-dots",key:"dots"},M),k)}},{key:"renderCurveStatically",value:function(n,o,l,h){var f=this.props,s=f.type,y=f.layout,b=f.connectNulls;f.ref;var w=e4(f,cIe),A=vs(vs(vs({},Sr(w,!0)),{},{fill:"none",className:"recharts-line-curve",clipPath:o?"url(#clipPath-".concat(l,")"):null,points:n},h),{},{type:s,layout:y,connectNulls:b});return Ce.createElement(pd,fv({},A,{pathRef:this.pathRef}))}},{key:"renderCurveWithAnimation",value:function(n,o){var l=this,h=this.props,f=h.points,s=h.strokeDasharray,y=h.isAnimationActive,b=h.animationBegin,w=h.animationDuration,A=h.animationEasing,k=h.animationId,M=h.animateNewValues,R=h.width,j=h.height,L=this.state,z=L.prevPoints,B=L.totalLength;return Ce.createElement(Ga,{begin:b,duration:w,isActive:y,easing:A,from:{t:0},to:{t:1},key:"line-".concat(k),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(Z){var F=Z.t;if(z){var H=z.length/f.length,Y=f.map(function(Oe,je){var Ge=Math.floor(je*H);if(z[Ge]){var Ze=z[Ge],Ye=li(Ze.x,Oe.x),tt=li(Ze.y,Oe.y);return vs(vs({},Oe),{},{x:Ye(F),y:tt(F)})}if(M){var ze=li(R*2,Oe.x),De=li(j/2,Oe.y);return vs(vs({},Oe),{},{x:ze(F),y:De(F)})}return vs(vs({},Oe),{},{x:Oe.x,y:Oe.y})});return l.renderCurveStatically(Y,n,o)}var te=li(0,B),pe=te(F),ue;if(s){var Ee="".concat(s).split(/[,\s]+/gim).map(function(Oe){return parseFloat(Oe)});ue=l.getStrokeDasharray(pe,B,Ee)}else ue=l.generateSimpleStrokeDasharray(B,pe);return l.renderCurveStatically(f,n,o,{strokeDasharray:ue})})}},{key:"renderCurve",value:function(n,o){var l=this.props,h=l.points,f=l.isAnimationActive,s=this.state,y=s.prevPoints,b=s.totalLength;return f&&h&&h.length&&(!y&&b>0||!Sd(y,h))?this.renderCurveWithAnimation(n,o):this.renderCurveStatically(h,n,o)}},{key:"render",value:function(){var n,o=this.props,l=o.hide,h=o.dot,f=o.points,s=o.className,y=o.xAxis,b=o.yAxis,w=o.top,A=o.left,k=o.width,M=o.height,R=o.isAnimationActive,j=o.id;if(l||!f||!f.length)return null;var L=this.state.isAnimationFinished,z=f.length===1,B=zr("recharts-line",s),Z=y&&y.allowDataOverflow,F=b&&b.allowDataOverflow,H=Z||F,Y=wr(j)?this.id:j,te=(n=Sr(h,!1))!==null&&n!==void 0?n:{r:3,strokeWidth:2},pe=te.r,ue=pe===void 0?3:pe,Ee=te.strokeWidth,Oe=Ee===void 0?2:Ee,je=eG(h)?h:{},Ge=je.clipDot,Ze=Ge===void 0?!0:Ge,Ye=ue*2+Oe;return Ce.createElement(sn,{className:B},Z||F?Ce.createElement("defs",null,Ce.createElement("clipPath",{id:"clipPath-".concat(Y)},Ce.createElement("rect",{x:Z?A:A-k/2,y:F?w:w-M/2,width:Z?k:k*2,height:F?M:M*2})),!Ze&&Ce.createElement("clipPath",{id:"clipPath-dots-".concat(Y)},Ce.createElement("rect",{x:A-Ye/2,y:w-Ye/2,width:k+Ye,height:M+Ye}))):null,!z&&this.renderCurve(H,Y),this.renderErrorBar(H,Y),(z||h)&&this.renderDots(H,Ze,Y),(!R||L)&&Sl.renderCallByParent(this.props,f))}}],[{key:"getDerivedStateFromProps",value:function(n,o){return n.animationId!==o.prevAnimationId?{prevAnimationId:n.animationId,curPoints:n.points,prevPoints:o.curPoints}:n.points!==o.curPoints?{curPoints:n.points}:null}},{key:"repeat",value:function(n,o){for(var l=n.length%2!==0?[].concat(Kf(n),[0]):n,h=[],f=0;f<o;++f)h=[].concat(Kf(h),Kf(l));return h}},{key:"renderDotItem",value:function(n,o){var l;if(Ce.isValidElement(n))l=Ce.cloneElement(n,o);else if(Ar(n))l=n(o);else{var h=o.key,f=e4(o,uIe),s=zr("recharts-line-dot",typeof n!="boolean"?n.className:"");l=Ce.createElement(AS,fv({key:h},f,{className:s}))}return l}}])}(re.PureComponent);za(El,"displayName","Line");za(El,"defaultProps",{xAxisId:0,yAxisId:0,connectNulls:!1,activeDot:!0,dot:!0,legendType:"line",stroke:"#3182bd",strokeWidth:1,fill:"#fff",points:[],isAnimationActive:!qu.isSsr,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",hide:!1,label:!1});za(El,"getComposedData",function(e){var t=e.props,r=e.xAxis,n=e.yAxis,o=e.xAxisTicks,l=e.yAxisTicks,h=e.dataKey,f=e.bandSize,s=e.displayedData,y=e.offset,b=t.layout,w=s.map(function(A,k){var M=Li(A,h);return b==="horizontal"?{x:Qp({axis:r,ticks:o,bandSize:f,entry:A,index:k}),y:wr(M)?null:n.scale(M),value:M,payload:A}:{x:wr(M)?null:r.scale(M),y:Qp({axis:n,ticks:l,bandSize:f,entry:A,index:k}),value:M,payload:A}});return vs({points:w,layout:b},y)});var SIe=["layout","type","stroke","connectNulls","isRange","ref"],TIe=["key"],eH;function cm(e){"@babel/helpers - typeof";return cm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cm(e)}function tH(e,t){if(e==null)return{};var r=EIe(e,t),n,o;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(o=0;o<l.length;o++)n=l[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function EIe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function sd(){return sd=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},sd.apply(this,arguments)}function n4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function su(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?n4(Object(r),!0).forEach(function(n){gl(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function AIe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i4(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,nH(n.key),n)}}function PIe(e,t,r){return t&&i4(e.prototype,t),r&&i4(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function CIe(e,t,r){return t=u1(t),kIe(e,rH()?Reflect.construct(t,r||[],u1(e).constructor):t.apply(e,r))}function kIe(e,t){if(t&&(cm(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return OIe(e)}function OIe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function rH(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(rH=function(){return!!e})()}function u1(e){return u1=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},u1(e)}function MIe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&nO(e,t)}function nO(e,t){return nO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},nO(e,t)}function gl(e,t,r){return t=nH(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function nH(e){var t=IIe(e,"string");return cm(t)=="symbol"?t:t+""}function IIe(e,t){if(cm(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(cm(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Ld=function(e){function t(){var r;AIe(this,t);for(var n=arguments.length,o=new Array(n),l=0;l<n;l++)o[l]=arguments[l];return r=CIe(this,t,[].concat(o)),gl(r,"state",{isAnimationFinished:!0}),gl(r,"id",Md("recharts-area-")),gl(r,"handleAnimationEnd",function(){var h=r.props.onAnimationEnd;r.setState({isAnimationFinished:!0}),Ar(h)&&h()}),gl(r,"handleAnimationStart",function(){var h=r.props.onAnimationStart;r.setState({isAnimationFinished:!1}),Ar(h)&&h()}),r}return MIe(t,e),PIe(t,[{key:"renderDots",value:function(n,o,l){var h=this.props.isAnimationActive,f=this.state.isAnimationFinished;if(h&&!f)return null;var s=this.props,y=s.dot,b=s.points,w=s.dataKey,A=Sr(this.props,!1),k=Sr(y,!0),M=b.map(function(j,L){var z=su(su(su({key:"dot-".concat(L),r:3},A),k),{},{index:L,cx:j.x,cy:j.y,dataKey:w,value:j.value,payload:j.payload,points:b});return t.renderDotItem(y,z)}),R={clipPath:n?"url(#clipPath-".concat(o?"":"dots-").concat(l,")"):null};return Ce.createElement(sn,sd({className:"recharts-area-dots"},R),M)}},{key:"renderHorizontalRect",value:function(n){var o=this.props,l=o.baseLine,h=o.points,f=o.strokeWidth,s=h[0].x,y=h[h.length-1].x,b=n*Math.abs(s-y),w=_u(h.map(function(A){return A.y||0}));return It(l)&&typeof l=="number"?w=Math.max(l,w):l&&Array.isArray(l)&&l.length&&(w=Math.max(_u(l.map(function(A){return A.y||0})),w)),It(w)?Ce.createElement("rect",{x:s<y?s:s-b,y:0,width:b,height:Math.floor(w+(f?parseInt("".concat(f),10):1))}):null}},{key:"renderVerticalRect",value:function(n){var o=this.props,l=o.baseLine,h=o.points,f=o.strokeWidth,s=h[0].y,y=h[h.length-1].y,b=n*Math.abs(s-y),w=_u(h.map(function(A){return A.x||0}));return It(l)&&typeof l=="number"?w=Math.max(l,w):l&&Array.isArray(l)&&l.length&&(w=Math.max(_u(l.map(function(A){return A.x||0})),w)),It(w)?Ce.createElement("rect",{x:0,y:s<y?s:s-b,width:w+(f?parseInt("".concat(f),10):1),height:Math.floor(b)}):null}},{key:"renderClipRect",value:function(n){var o=this.props.layout;return o==="vertical"?this.renderVerticalRect(n):this.renderHorizontalRect(n)}},{key:"renderAreaStatically",value:function(n,o,l,h){var f=this.props,s=f.layout,y=f.type,b=f.stroke,w=f.connectNulls,A=f.isRange;f.ref;var k=tH(f,SIe);return Ce.createElement(sn,{clipPath:l?"url(#clipPath-".concat(h,")"):null},Ce.createElement(pd,sd({},Sr(k,!0),{points:n,connectNulls:w,type:y,baseLine:o,layout:s,stroke:"none",className:"recharts-area-area"})),b!=="none"&&Ce.createElement(pd,sd({},Sr(this.props,!1),{className:"recharts-area-curve",layout:s,type:y,connectNulls:w,fill:"none",points:n})),b!=="none"&&A&&Ce.createElement(pd,sd({},Sr(this.props,!1),{className:"recharts-area-curve",layout:s,type:y,connectNulls:w,fill:"none",points:o})))}},{key:"renderAreaWithAnimation",value:function(n,o){var l=this,h=this.props,f=h.points,s=h.baseLine,y=h.isAnimationActive,b=h.animationBegin,w=h.animationDuration,A=h.animationEasing,k=h.animationId,M=this.state,R=M.prevPoints,j=M.prevBaseLine;return Ce.createElement(Ga,{begin:b,duration:w,isActive:y,easing:A,from:{t:0},to:{t:1},key:"area-".concat(k),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(L){var z=L.t;if(R){var B=R.length/f.length,Z=f.map(function(te,pe){var ue=Math.floor(pe*B);if(R[ue]){var Ee=R[ue],Oe=li(Ee.x,te.x),je=li(Ee.y,te.y);return su(su({},te),{},{x:Oe(z),y:je(z)})}return te}),F;if(It(s)&&typeof s=="number"){var H=li(j,s);F=H(z)}else if(wr(s)||Rm(s)){var Y=li(j,0);F=Y(z)}else F=s.map(function(te,pe){var ue=Math.floor(pe*B);if(j[ue]){var Ee=j[ue],Oe=li(Ee.x,te.x),je=li(Ee.y,te.y);return su(su({},te),{},{x:Oe(z),y:je(z)})}return te});return l.renderAreaStatically(Z,F,n,o)}return Ce.createElement(sn,null,Ce.createElement("defs",null,Ce.createElement("clipPath",{id:"animationClipPath-".concat(o)},l.renderClipRect(z))),Ce.createElement(sn,{clipPath:"url(#animationClipPath-".concat(o,")")},l.renderAreaStatically(f,s,n,o)))})}},{key:"renderArea",value:function(n,o){var l=this.props,h=l.points,f=l.baseLine,s=l.isAnimationActive,y=this.state,b=y.prevPoints,w=y.prevBaseLine,A=y.totalLength;return s&&h&&h.length&&(!b&&A>0||!Sd(b,h)||!Sd(w,f))?this.renderAreaWithAnimation(n,o):this.renderAreaStatically(h,f,n,o)}},{key:"render",value:function(){var n,o=this.props,l=o.hide,h=o.dot,f=o.points,s=o.className,y=o.top,b=o.left,w=o.xAxis,A=o.yAxis,k=o.width,M=o.height,R=o.isAnimationActive,j=o.id;if(l||!f||!f.length)return null;var L=this.state.isAnimationFinished,z=f.length===1,B=zr("recharts-area",s),Z=w&&w.allowDataOverflow,F=A&&A.allowDataOverflow,H=Z||F,Y=wr(j)?this.id:j,te=(n=Sr(h,!1))!==null&&n!==void 0?n:{r:3,strokeWidth:2},pe=te.r,ue=pe===void 0?3:pe,Ee=te.strokeWidth,Oe=Ee===void 0?2:Ee,je=eG(h)?h:{},Ge=je.clipDot,Ze=Ge===void 0?!0:Ge,Ye=ue*2+Oe;return Ce.createElement(sn,{className:B},Z||F?Ce.createElement("defs",null,Ce.createElement("clipPath",{id:"clipPath-".concat(Y)},Ce.createElement("rect",{x:Z?b:b-k/2,y:F?y:y-M/2,width:Z?k:k*2,height:F?M:M*2})),!Ze&&Ce.createElement("clipPath",{id:"clipPath-dots-".concat(Y)},Ce.createElement("rect",{x:b-Ye/2,y:y-Ye/2,width:k+Ye,height:M+Ye}))):null,z?null:this.renderArea(H,Y),(h||z)&&this.renderDots(H,Ze,Y),(!R||L)&&Sl.renderCallByParent(this.props,f))}}],[{key:"getDerivedStateFromProps",value:function(n,o){return n.animationId!==o.prevAnimationId?{prevAnimationId:n.animationId,curPoints:n.points,curBaseLine:n.baseLine,prevPoints:o.curPoints,prevBaseLine:o.curBaseLine}:n.points!==o.curPoints||n.baseLine!==o.curBaseLine?{curPoints:n.points,curBaseLine:n.baseLine}:null}}])}(re.PureComponent);eH=Ld;gl(Ld,"displayName","Area");gl(Ld,"defaultProps",{stroke:"#3182bd",fill:"#3182bd",fillOpacity:.6,xAxisId:0,yAxisId:0,legendType:"line",connectNulls:!1,points:[],dot:!1,activeDot:!0,hide:!1,isAnimationActive:!qu.isSsr,animationBegin:0,animationDuration:1500,animationEasing:"ease"});gl(Ld,"getBaseValue",function(e,t,r,n){var o=e.layout,l=e.baseValue,h=t.props.baseValue,f=h??l;if(It(f)&&typeof f=="number")return f;var s=o==="horizontal"?n:r,y=s.scale.domain();if(s.type==="number"){var b=Math.max(y[0],y[1]),w=Math.min(y[0],y[1]);return f==="dataMin"?w:f==="dataMax"||b<0?b:Math.max(Math.min(y[0],y[1]),0)}return f==="dataMin"?y[0]:f==="dataMax"?y[1]:y[0]});gl(Ld,"getComposedData",function(e){var t=e.props,r=e.item,n=e.xAxis,o=e.yAxis,l=e.xAxisTicks,h=e.yAxisTicks,f=e.bandSize,s=e.dataKey,y=e.stackedData,b=e.dataStartIndex,w=e.displayedData,A=e.offset,k=t.layout,M=y&&y.length,R=eH.getBaseValue(t,r,n,o),j=k==="horizontal",L=!1,z=w.map(function(Z,F){var H;M?H=y[b+F]:(H=Li(Z,s),Array.isArray(H)?L=!0:H=[R,H]);var Y=H[1]==null||M&&Li(Z,s)==null;return j?{x:Qp({axis:n,ticks:l,bandSize:f,entry:Z,index:F}),y:Y?null:o.scale(H[1]),value:H,payload:Z}:{x:Y?null:n.scale(H[1]),y:Qp({axis:o,ticks:h,bandSize:f,entry:Z,index:F}),value:H,payload:Z}}),B;return M||L?B=z.map(function(Z){var F=Array.isArray(Z.value)?Z.value[0]:null;return j?{x:Z.x,y:F!=null&&Z.y!=null?o.scale(F):null}:{x:F!=null?n.scale(F):null,y:Z.y}}):B=j?o.scale(R):n.scale(R),su({points:z,baseLine:B,layout:k,isRange:L},A)});gl(Ld,"renderDotItem",function(e,t){var r;if(Ce.isValidElement(e))r=Ce.cloneElement(e,t);else if(Ar(e))r=e(t);else{var n=zr("recharts-area-dot",typeof e!="boolean"?e.className:""),o=t.key,l=tH(t,TIe);r=Ce.createElement(AS,sd({},l,{key:o,className:n}))}return r});function um(e){"@babel/helpers - typeof";return um=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},um(e)}function RIe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function DIe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,sH(n.key),n)}}function LIe(e,t,r){return t&&DIe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function jIe(e,t,r){return t=h1(t),zIe(e,iH()?Reflect.construct(t,r||[],h1(e).constructor):t.apply(e,r))}function zIe(e,t){if(t&&(um(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return BIe(e)}function BIe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function iH(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(iH=function(){return!!e})()}function h1(e){return h1=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},h1(e)}function NIe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&iO(e,t)}function iO(e,t){return iO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},iO(e,t)}function oH(e,t,r){return t=sH(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function sH(e){var t=$Ie(e,"string");return um(t)=="symbol"?t:t+""}function $Ie(e,t){if(um(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(um(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var DS=function(e){function t(){return RIe(this,t),jIe(this,t,arguments)}return NIe(t,e),LIe(t,[{key:"render",value:function(){return null}}])}(re.Component);oH(DS,"displayName","ZAxis");oH(DS,"defaultProps",{zAxisId:0,range:[64,64],scale:"auto",type:"number"});var FIe=["option","isActive"];function pv(){return pv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},pv.apply(this,arguments)}function UIe(e,t){if(e==null)return{};var r=VIe(e,t),n,o;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(o=0;o<l.length;o++)n=l[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function VIe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function GIe(e){var t=e.option,r=e.isActive,n=UIe(e,FIe);return typeof t=="string"?re.createElement(Gk,pv({option:re.createElement(fS,pv({type:t},n)),isActive:r,shapeType:"symbols"},n)):re.createElement(Gk,pv({option:t,isActive:r,shapeType:"symbols"},n))}function hm(e){"@babel/helpers - typeof";return hm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hm(e)}function mv(){return mv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},mv.apply(this,arguments)}function o4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function Ws(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?o4(Object(r),!0).forEach(function(n){bu(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function WIe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s4(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,lH(n.key),n)}}function qIe(e,t,r){return t&&s4(e.prototype,t),r&&s4(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function HIe(e,t,r){return t=d1(t),KIe(e,aH()?Reflect.construct(t,r||[],d1(e).constructor):t.apply(e,r))}function KIe(e,t){if(t&&(hm(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ZIe(e)}function ZIe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function aH(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(aH=function(){return!!e})()}function d1(e){return d1=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},d1(e)}function XIe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&oO(e,t)}function oO(e,t){return oO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},oO(e,t)}function bu(e,t,r){return t=lH(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function lH(e){var t=YIe(e,"string");return hm(t)=="symbol"?t:t+""}function YIe(e,t){if(hm(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(hm(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var LS=function(e){function t(){var r;WIe(this,t);for(var n=arguments.length,o=new Array(n),l=0;l<n;l++)o[l]=arguments[l];return r=HIe(this,t,[].concat(o)),bu(r,"state",{isAnimationFinished:!1}),bu(r,"handleAnimationEnd",function(){r.setState({isAnimationFinished:!0})}),bu(r,"handleAnimationStart",function(){r.setState({isAnimationFinished:!1})}),bu(r,"id",Md("recharts-scatter-")),r}return XIe(t,e),qIe(t,[{key:"renderSymbolsStatically",value:function(n){var o=this,l=this.props,h=l.shape,f=l.activeShape,s=l.activeIndex,y=Sr(this.props,!1);return n.map(function(b,w){var A=s===w,k=A?f:h,M=Ws(Ws({},y),b);return Ce.createElement(sn,mv({className:"recharts-scatter-symbol",key:"symbol-".concat(b==null?void 0:b.cx,"-").concat(b==null?void 0:b.cy,"-").concat(b==null?void 0:b.size,"-").concat(w)},qv(o.props,b,w),{role:"img"}),Ce.createElement(GIe,mv({option:k,isActive:A,key:"symbol-".concat(w)},M)))})}},{key:"renderSymbolsWithAnimation",value:function(){var n=this,o=this.props,l=o.points,h=o.isAnimationActive,f=o.animationBegin,s=o.animationDuration,y=o.animationEasing,b=o.animationId,w=this.state.prevPoints;return Ce.createElement(Ga,{begin:f,duration:s,isActive:h,easing:y,from:{t:0},to:{t:1},key:"pie-".concat(b),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(A){var k=A.t,M=l.map(function(R,j){var L=w&&w[j];if(L){var z=li(L.cx,R.cx),B=li(L.cy,R.cy),Z=li(L.size,R.size);return Ws(Ws({},R),{},{cx:z(k),cy:B(k),size:Z(k)})}var F=li(0,R.size);return Ws(Ws({},R),{},{size:F(k)})});return Ce.createElement(sn,null,n.renderSymbolsStatically(M))})}},{key:"renderSymbols",value:function(){var n=this.props,o=n.points,l=n.isAnimationActive,h=this.state.prevPoints;return l&&o&&o.length&&(!h||!Sd(h,o))?this.renderSymbolsWithAnimation():this.renderSymbolsStatically(o)}},{key:"renderErrorBar",value:function(){var n=this.props.isAnimationActive;if(n&&!this.state.isAnimationFinished)return null;var o=this.props,l=o.points,h=o.xAxis,f=o.yAxis,s=o.children,y=os(s,$m);return y?y.map(function(b,w){var A=b.props,k=A.direction,M=A.dataKey;return Ce.cloneElement(b,{key:"".concat(k,"-").concat(M,"-").concat(l[w]),data:l,xAxis:h,yAxis:f,layout:k==="x"?"vertical":"horizontal",dataPointFormatter:function(j,L){return{x:j.cx,y:j.cy,value:k==="x"?+j.node.x:+j.node.y,errorVal:Li(j,L)}}})}):null}},{key:"renderLine",value:function(){var n=this.props,o=n.points,l=n.line,h=n.lineType,f=n.lineJointType,s=Sr(this.props,!1),y=Sr(l,!1),b,w;if(h==="joint")b=o.map(function(B){return{x:B.cx,y:B.cy}});else if(h==="fitting"){var A=Ehe(o),k=A.xmin,M=A.xmax,R=A.a,j=A.b,L=function(Z){return R*Z+j};b=[{x:k,y:L(k)},{x:M,y:L(M)}]}var z=Ws(Ws(Ws({},s),{},{fill:"none",stroke:s&&s.fill},y),{},{points:b});return Ce.isValidElement(l)?w=Ce.cloneElement(l,z):Ar(l)?w=l(z):w=Ce.createElement(pd,mv({},z,{type:f})),Ce.createElement(sn,{className:"recharts-scatter-line",key:"recharts-scatter-line"},w)}},{key:"render",value:function(){var n=this.props,o=n.hide,l=n.points,h=n.line,f=n.className,s=n.xAxis,y=n.yAxis,b=n.left,w=n.top,A=n.width,k=n.height,M=n.id,R=n.isAnimationActive;if(o||!l||!l.length)return null;var j=this.state.isAnimationFinished,L=zr("recharts-scatter",f),z=s&&s.allowDataOverflow,B=y&&y.allowDataOverflow,Z=z||B,F=wr(M)?this.id:M;return Ce.createElement(sn,{className:L,clipPath:Z?"url(#clipPath-".concat(F,")"):null},z||B?Ce.createElement("defs",null,Ce.createElement("clipPath",{id:"clipPath-".concat(F)},Ce.createElement("rect",{x:z?b:b-A/2,y:B?w:w-k/2,width:z?A:A*2,height:B?k:k*2}))):null,h&&this.renderLine(),this.renderErrorBar(),Ce.createElement(sn,{key:"recharts-scatter-symbols"},this.renderSymbols()),(!R||j)&&Sl.renderCallByParent(this.props,l))}}],[{key:"getDerivedStateFromProps",value:function(n,o){return n.animationId!==o.prevAnimationId?{prevAnimationId:n.animationId,curPoints:n.points,prevPoints:o.curPoints}:n.points!==o.curPoints?{curPoints:n.points}:null}}])}(re.PureComponent);bu(LS,"displayName","Scatter");bu(LS,"defaultProps",{xAxisId:0,yAxisId:0,zAxisId:0,legendType:"circle",lineType:"joint",lineJointType:"linear",data:[],shape:"circle",hide:!1,isAnimationActive:!qu.isSsr,animationBegin:0,animationDuration:400,animationEasing:"linear"});bu(LS,"getComposedData",function(e){var t=e.xAxis,r=e.yAxis,n=e.zAxis,o=e.item,l=e.displayedData,h=e.xAxisTicks,f=e.yAxisTicks,s=e.offset,y=o.props.tooltipType,b=os(o.props.children,LI),w=wr(t.dataKey)?o.props.dataKey:t.dataKey,A=wr(r.dataKey)?o.props.dataKey:r.dataKey,k=n&&n.dataKey,M=n?n.range:DS.defaultProps.range,R=M&&M[0],j=t.scale.bandwidth?t.scale.bandwidth():0,L=r.scale.bandwidth?r.scale.bandwidth():0,z=l.map(function(B,Z){var F=Li(B,w),H=Li(B,A),Y=!wr(k)&&Li(B,k)||"-",te=[{name:wr(t.dataKey)?o.props.name:t.name||t.dataKey,unit:t.unit||"",value:F,payload:B,dataKey:w,type:y},{name:wr(r.dataKey)?o.props.name:r.name||r.dataKey,unit:r.unit||"",value:H,payload:B,dataKey:A,type:y}];Y!=="-"&&te.push({name:n.name||n.dataKey,unit:n.unit||"",value:Y,payload:B,dataKey:k,type:y});var pe=Qp({axis:t,ticks:h,bandSize:j,entry:B,index:Z,dataKey:w}),ue=Qp({axis:r,ticks:f,bandSize:L,entry:B,index:Z,dataKey:A}),Ee=Y!=="-"?n.scale(Y):R,Oe=Math.sqrt(Math.max(Ee,0)/Math.PI);return Ws(Ws({},B),{},{cx:pe,cy:ue,x:pe-Oe,y:ue-Oe,xAxis:t,yAxis:r,zAxis:n,width:2*Oe,height:2*Oe,size:Ee,node:{x:F,y:H,z:Y},tooltipPayload:te,tooltipPosition:{x:pe,y:ue},payload:B},b&&b[Z]&&b[Z].props)});return Ws({points:z},s)});function dm(e){"@babel/helpers - typeof";return dm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},dm(e)}function JIe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function QIe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,hH(n.key),n)}}function eRe(e,t,r){return t&&QIe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function tRe(e,t,r){return t=f1(t),rRe(e,cH()?Reflect.construct(t,r||[],f1(e).constructor):t.apply(e,r))}function rRe(e,t){if(t&&(dm(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return nRe(e)}function nRe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function cH(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(cH=function(){return!!e})()}function f1(e){return f1=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},f1(e)}function iRe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&sO(e,t)}function sO(e,t){return sO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},sO(e,t)}function uH(e,t,r){return t=hH(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function hH(e){var t=oRe(e,"string");return dm(t)=="symbol"?t:t+""}function oRe(e,t){if(dm(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(dm(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function aO(){return aO=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},aO.apply(this,arguments)}function sRe(e){var t=e.xAxisId,r=dR(),n=fR(),o=$q(t);return o==null?null:re.createElement(Fm,aO({},o,{className:zr("recharts-".concat(o.axisType," ").concat(o.axisType),o.className),viewBox:{x:0,y:0,width:r,height:n},ticksGenerator:function(h){return nc(h,!0)}}))}var cc=function(e){function t(){return JIe(this,t),tRe(this,t,arguments)}return iRe(t,e),eRe(t,[{key:"render",value:function(){return re.createElement(sRe,this.props)}}])}(re.Component);uH(cc,"displayName","XAxis");uH(cc,"defaultProps",{allowDecimals:!0,hide:!1,orientation:"bottom",width:0,height:30,mirror:!1,xAxisId:0,tickCount:5,type:"category",padding:{left:0,right:0},allowDataOverflow:!1,scale:"auto",reversed:!1,allowDuplicatedCategory:!0});function fm(e){"@babel/helpers - typeof";return fm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fm(e)}function aRe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function lRe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,pH(n.key),n)}}function cRe(e,t,r){return t&&lRe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function uRe(e,t,r){return t=p1(t),hRe(e,dH()?Reflect.construct(t,r||[],p1(e).constructor):t.apply(e,r))}function hRe(e,t){if(t&&(fm(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return dRe(e)}function dRe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function dH(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(dH=function(){return!!e})()}function p1(e){return p1=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},p1(e)}function fRe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&lO(e,t)}function lO(e,t){return lO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},lO(e,t)}function fH(e,t,r){return t=pH(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function pH(e){var t=pRe(e,"string");return fm(t)=="symbol"?t:t+""}function pRe(e,t){if(fm(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(fm(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function cO(){return cO=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},cO.apply(this,arguments)}var mRe=function(t){var r=t.yAxisId,n=dR(),o=fR(),l=Fq(r);return l==null?null:re.createElement(Fm,cO({},l,{className:zr("recharts-".concat(l.axisType," ").concat(l.axisType),l.className),viewBox:{x:0,y:0,width:n,height:o},ticksGenerator:function(f){return nc(f,!0)}}))},yl=function(e){function t(){return aRe(this,t),uRe(this,t,arguments)}return fRe(t,e),cRe(t,[{key:"render",value:function(){return re.createElement(mRe,this.props)}}])}(re.Component);fH(yl,"displayName","YAxis");fH(yl,"defaultProps",{allowDuplicatedCategory:!0,allowDecimals:!0,hide:!1,orientation:"left",width:60,height:0,mirror:!1,yAxisId:0,tickCount:5,type:"number",padding:{top:0,bottom:0},allowDataOverflow:!1,scale:"auto",reversed:!1});function a4(e){return _Re(e)||vRe(e)||yRe(e)||gRe()}function gRe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function yRe(e,t){if(e){if(typeof e=="string")return uO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return uO(e,t)}}function vRe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function _Re(e){if(Array.isArray(e))return uO(e)}function uO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var hO=function(t,r,n,o,l){var h=os(t,mR),f=os(t,MS),s=[].concat(a4(h),a4(f)),y=os(t,RS),b="".concat(o,"Id"),w=o[0],A=r;if(s.length&&(A=s.reduce(function(R,j){if(j.props[b]===n&&Tl(j.props,"extendDomain")&&It(j.props[w])){var L=j.props[w];return[Math.min(R[0],L),Math.max(R[1],L)]}return R},A)),y.length){var k="".concat(w,"1"),M="".concat(w,"2");A=y.reduce(function(R,j){if(j.props[b]===n&&Tl(j.props,"extendDomain")&&It(j.props[k])&&It(j.props[M])){var L=j.props[k],z=j.props[M];return[Math.min(R[0],L,z),Math.max(R[1],L,z)]}return R},A)}return l&&l.length&&(A=l.reduce(function(R,j){return It(j)?[Math.min(R[0],j),Math.max(R[1],j)]:R},A)),A},mH={exports:{}};(function(e){var t=Object.prototype.hasOwnProperty,r="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1));function o(s,y,b){this.fn=s,this.context=y,this.once=b||!1}function l(s,y,b,w,A){if(typeof b!="function")throw new TypeError("The listener must be a function");var k=new o(b,w||s,A),M=r?r+y:y;return s._events[M]?s._events[M].fn?s._events[M]=[s._events[M],k]:s._events[M].push(k):(s._events[M]=k,s._eventsCount++),s}function h(s,y){--s._eventsCount===0?s._events=new n:delete s._events[y]}function f(){this._events=new n,this._eventsCount=0}f.prototype.eventNames=function(){var y=[],b,w;if(this._eventsCount===0)return y;for(w in b=this._events)t.call(b,w)&&y.push(r?w.slice(1):w);return Object.getOwnPropertySymbols?y.concat(Object.getOwnPropertySymbols(b)):y},f.prototype.listeners=function(y){var b=r?r+y:y,w=this._events[b];if(!w)return[];if(w.fn)return[w.fn];for(var A=0,k=w.length,M=new Array(k);A<k;A++)M[A]=w[A].fn;return M},f.prototype.listenerCount=function(y){var b=r?r+y:y,w=this._events[b];return w?w.fn?1:w.length:0},f.prototype.emit=function(y,b,w,A,k,M){var R=r?r+y:y;if(!this._events[R])return!1;var j=this._events[R],L=arguments.length,z,B;if(j.fn){switch(j.once&&this.removeListener(y,j.fn,void 0,!0),L){case 1:return j.fn.call(j.context),!0;case 2:return j.fn.call(j.context,b),!0;case 3:return j.fn.call(j.context,b,w),!0;case 4:return j.fn.call(j.context,b,w,A),!0;case 5:return j.fn.call(j.context,b,w,A,k),!0;case 6:return j.fn.call(j.context,b,w,A,k,M),!0}for(B=1,z=new Array(L-1);B<L;B++)z[B-1]=arguments[B];j.fn.apply(j.context,z)}else{var Z=j.length,F;for(B=0;B<Z;B++)switch(j[B].once&&this.removeListener(y,j[B].fn,void 0,!0),L){case 1:j[B].fn.call(j[B].context);break;case 2:j[B].fn.call(j[B].context,b);break;case 3:j[B].fn.call(j[B].context,b,w);break;case 4:j[B].fn.call(j[B].context,b,w,A);break;default:if(!z)for(F=1,z=new Array(L-1);F<L;F++)z[F-1]=arguments[F];j[B].fn.apply(j[B].context,z)}}return!0},f.prototype.on=function(y,b,w){return l(this,y,b,w,!1)},f.prototype.once=function(y,b,w){return l(this,y,b,w,!0)},f.prototype.removeListener=function(y,b,w,A){var k=r?r+y:y;if(!this._events[k])return this;if(!b)return h(this,k),this;var M=this._events[k];if(M.fn)M.fn===b&&(!A||M.once)&&(!w||M.context===w)&&h(this,k);else{for(var R=0,j=[],L=M.length;R<L;R++)(M[R].fn!==b||A&&!M[R].once||w&&M[R].context!==w)&&j.push(M[R]);j.length?this._events[k]=j.length===1?j[0]:j:h(this,k)}return this},f.prototype.removeAllListeners=function(y){var b;return y?(b=r?r+y:y,this._events[b]&&h(this,b)):(this._events=new n,this._eventsCount=0),this},f.prototype.off=f.prototype.removeListener,f.prototype.addListener=f.prototype.on,f.prefixed=r,f.EventEmitter=f,e.exports=f})(mH);var xRe=mH.exports;const bRe=mn(xRe);var KA=new bRe,ZA="recharts.syncMouseEvents";function A_(e){"@babel/helpers - typeof";return A_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},A_(e)}function wRe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function SRe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,gH(n.key),n)}}function TRe(e,t,r){return t&&SRe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function XA(e,t,r){return t=gH(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function gH(e){var t=ERe(e,"string");return A_(t)=="symbol"?t:t+""}function ERe(e,t){if(A_(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(A_(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var ARe=function(){function e(){wRe(this,e),XA(this,"activeIndex",0),XA(this,"coordinateList",[]),XA(this,"layout","horizontal")}return TRe(e,[{key:"setDetails",value:function(r){var n,o=r.coordinateList,l=o===void 0?null:o,h=r.container,f=h===void 0?null:h,s=r.layout,y=s===void 0?null:s,b=r.offset,w=b===void 0?null:b,A=r.mouseHandlerCallback,k=A===void 0?null:A;this.coordinateList=(n=l??this.coordinateList)!==null&&n!==void 0?n:[],this.container=f??this.container,this.layout=y??this.layout,this.offset=w??this.offset,this.mouseHandlerCallback=k??this.mouseHandlerCallback,this.activeIndex=Math.min(Math.max(this.activeIndex,0),this.coordinateList.length-1)}},{key:"focus",value:function(){this.spoofMouse()}},{key:"keyboardEvent",value:function(r){if(this.coordinateList.length!==0)switch(r.key){case"ArrowRight":{if(this.layout!=="horizontal")return;this.activeIndex=Math.min(this.activeIndex+1,this.coordinateList.length-1),this.spoofMouse();break}case"ArrowLeft":{if(this.layout!=="horizontal")return;this.activeIndex=Math.max(this.activeIndex-1,0),this.spoofMouse();break}}}},{key:"setIndex",value:function(r){this.activeIndex=r}},{key:"spoofMouse",value:function(){var r,n;if(this.layout==="horizontal"&&this.coordinateList.length!==0){var o=this.container.getBoundingClientRect(),l=o.x,h=o.y,f=o.height,s=this.coordinateList[this.activeIndex].coordinate,y=((r=window)===null||r===void 0?void 0:r.scrollX)||0,b=((n=window)===null||n===void 0?void 0:n.scrollY)||0,w=l+s+y,A=h+this.offset.top+f/2+b;this.mouseHandlerCallback({pageX:w,pageY:A})}}}])}();function PRe(e,t,r){if(r==="number"&&t===!0&&Array.isArray(e)){var n=e==null?void 0:e[0],o=e==null?void 0:e[1];if(n&&o&&It(n)&&It(o))return!0}return!1}function CRe(e,t,r,n){var o=n/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-o:r.left+.5,y:e==="horizontal"?r.top+.5:t.y-o,width:e==="horizontal"?n:r.width-1,height:e==="horizontal"?r.height-1:n}}function yH(e){var t=e.cx,r=e.cy,n=e.radius,o=e.startAngle,l=e.endAngle,h=ro(t,r,n,o),f=ro(t,r,n,l);return{points:[h,f],cx:t,cy:r,radius:n,startAngle:o,endAngle:l}}function kRe(e,t,r){var n,o,l,h;if(e==="horizontal")n=t.x,l=n,o=r.top,h=r.top+r.height;else if(e==="vertical")o=t.y,h=o,n=r.left,l=r.left+r.width;else if(t.cx!=null&&t.cy!=null)if(e==="centric"){var f=t.cx,s=t.cy,y=t.innerRadius,b=t.outerRadius,w=t.angle,A=ro(f,s,y,w),k=ro(f,s,b,w);n=A.x,o=A.y,l=k.x,h=k.y}else return yH(t);return[{x:n,y:o},{x:l,y:h}]}function P_(e){"@babel/helpers - typeof";return P_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},P_(e)}function l4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function nb(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?l4(Object(r),!0).forEach(function(n){ORe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ORe(e,t,r){return t=MRe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function MRe(e){var t=IRe(e,"string");return P_(t)=="symbol"?t:t+""}function IRe(e,t){if(P_(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(P_(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function RRe(e){var t,r,n=e.element,o=e.tooltipEventType,l=e.isActive,h=e.activeCoordinate,f=e.activePayload,s=e.offset,y=e.activeTooltipIndex,b=e.tooltipAxisBandSize,w=e.layout,A=e.chartName,k=(t=n.props.cursor)!==null&&t!==void 0?t:(r=n.type.defaultProps)===null||r===void 0?void 0:r.cursor;if(!n||!k||!l||!h||A!=="ScatterChart"&&o!=="axis")return null;var M,R=pd;if(A==="ScatterChart")M=h,R=oCe;else if(A==="BarChart")M=CRe(w,h,s,b),R=aR;else if(w==="radial"){var j=yH(h),L=j.cx,z=j.cy,B=j.radius,Z=j.startAngle,F=j.endAngle;M={cx:L,cy:z,startAngle:Z,endAngle:F,innerRadius:B,outerRadius:B},R=dq}else M={points:kRe(w,h,s)},R=pd;var H=nb(nb(nb(nb({stroke:"#ccc",pointerEvents:"none"},s),M),Sr(k,!1)),{},{payload:f,payloadIndex:y,className:zr("recharts-tooltip-cursor",k.className)});return re.isValidElement(k)?re.cloneElement(k,H):re.createElement(R,H)}var DRe=["item"],LRe=["children","className","width","height","style","compact","title","desc"];function pm(e){"@babel/helpers - typeof";return pm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pm(e)}function vp(){return vp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},vp.apply(this,arguments)}function c4(e,t){return BRe(e)||zRe(e,t)||_H(e,t)||jRe()}function jRe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function zRe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,l,h,f=[],s=!0,y=!1;try{if(l=(r=r.call(e)).next,t!==0)for(;!(s=(n=l.call(r)).done)&&(f.push(n.value),f.length!==t);s=!0);}catch(b){y=!0,o=b}finally{try{if(!s&&r.return!=null&&(h=r.return(),Object(h)!==h))return}finally{if(y)throw o}}return f}}function BRe(e){if(Array.isArray(e))return e}function u4(e,t){if(e==null)return{};var r=NRe(e,t),n,o;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(o=0;o<l.length;o++)n=l[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function NRe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function $Re(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function FRe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,xH(n.key),n)}}function URe(e,t,r){return t&&FRe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function VRe(e,t,r){return t=m1(t),GRe(e,vH()?Reflect.construct(t,r||[],m1(e).constructor):t.apply(e,r))}function GRe(e,t){if(t&&(pm(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return WRe(e)}function WRe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function vH(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(vH=function(){return!!e})()}function m1(e){return m1=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},m1(e)}function qRe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&dO(e,t)}function dO(e,t){return dO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},dO(e,t)}function mm(e){return ZRe(e)||KRe(e)||_H(e)||HRe()}function HRe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _H(e,t){if(e){if(typeof e=="string")return fO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return fO(e,t)}}function KRe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function ZRe(e){if(Array.isArray(e))return fO(e)}function fO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function h4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function ct(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?h4(Object(r),!0).forEach(function(n){dr(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):h4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function dr(e,t,r){return t=xH(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function xH(e){var t=XRe(e,"string");return pm(t)=="symbol"?t:t+""}function XRe(e,t){if(pm(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(pm(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var YRe={xAxis:["bottom","top"],yAxis:["left","right"]},JRe={width:"100%",height:"100%"},bH={x:0,y:0};function ib(e){return e}var QRe=function(t,r){return r==="horizontal"?t.x:r==="vertical"?t.y:r==="centric"?t.angle:t.radius},eDe=function(t,r,n,o){var l=r.find(function(b){return b&&b.index===n});if(l){if(t==="horizontal")return{x:l.coordinate,y:o.y};if(t==="vertical")return{x:o.x,y:l.coordinate};if(t==="centric"){var h=l.coordinate,f=o.radius;return ct(ct(ct({},o),ro(o.cx,o.cy,f,h)),{},{angle:h,radius:f})}var s=l.coordinate,y=o.angle;return ct(ct(ct({},o),ro(o.cx,o.cy,s,y)),{},{angle:y,radius:s})}return bH},jS=function(t,r){var n=r.graphicalItems,o=r.dataStartIndex,l=r.dataEndIndex,h=(n??[]).reduce(function(f,s){var y=s.props.data;return y&&y.length?[].concat(mm(f),mm(y)):f},[]);return h.length>0?h:t&&t.length&&It(o)&&It(l)?t.slice(o,l+1):[]};function wH(e){return e==="number"?[0,"auto"]:void 0}var pO=function(t,r,n,o){var l=t.graphicalItems,h=t.tooltipAxis,f=jS(r,t);return n<0||!l||!l.length||n>=f.length?null:l.reduce(function(s,y){var b,w=(b=y.props.data)!==null&&b!==void 0?b:r;w&&t.dataStartIndex+t.dataEndIndex!==0&&t.dataEndIndex-t.dataStartIndex>=n&&(w=w.slice(t.dataStartIndex,t.dataEndIndex+1));var A;if(h.dataKey&&!h.allowDuplicatedCategory){var k=w===void 0?f:w;A=pw(k,h.dataKey,o)}else A=w&&w[n]||f[n];return A?[].concat(mm(s),[cq(y,A)]):s},[])},d4=function(t,r,n,o){var l=o||{x:t.chartX,y:t.chartY},h=QRe(l,n),f=t.orderedTooltipTicks,s=t.tooltipAxis,y=t.tooltipTicks,b=zTe(h,f,y,s);if(b>=0&&y){var w=y[b]&&y[b].value,A=pO(t,r,b,w),k=eDe(n,f,b,l);return{activeTooltipIndex:b,activeLabel:w,activePayload:A,activeCoordinate:k}}return null},tDe=function(t,r){var n=r.axes,o=r.graphicalItems,l=r.axisType,h=r.axisIdKey,f=r.stackGroups,s=r.dataStartIndex,y=r.dataEndIndex,b=t.layout,w=t.children,A=t.stackOffset,k=sq(b,l);return n.reduce(function(M,R){var j,L=R.type.defaultProps!==void 0?ct(ct({},R.type.defaultProps),R.props):R.props,z=L.type,B=L.dataKey,Z=L.allowDataOverflow,F=L.allowDuplicatedCategory,H=L.scale,Y=L.ticks,te=L.includeHidden,pe=L[h];if(M[pe])return M;var ue=jS(t.data,{graphicalItems:o.filter(function(at){var Lt,$t=h in at.props?at.props[h]:(Lt=at.type.defaultProps)===null||Lt===void 0?void 0:Lt[h];return $t===pe}),dataStartIndex:s,dataEndIndex:y}),Ee=ue.length,Oe,je,Ge;PRe(L.domain,Z,z)&&(Oe=Ck(L.domain,null,Z),k&&(z==="number"||H!=="auto")&&(Ge=uv(ue,B,"category")));var Ze=wH(z);if(!Oe||Oe.length===0){var Ye,tt=(Ye=L.domain)!==null&&Ye!==void 0?Ye:Ze;if(B){if(Oe=uv(ue,B,z),z==="category"&&k){var ze=The(Oe);F&&ze?(je=Oe,Oe=Qw(0,Ee)):F||(Oe=V$(tt,Oe,R).reduce(function(at,Lt){return at.indexOf(Lt)>=0?at:[].concat(mm(at),[Lt])},[]))}else if(z==="category")F?Oe=Oe.filter(function(at){return at!==""&&!wr(at)}):Oe=V$(tt,Oe,R).reduce(function(at,Lt){return at.indexOf(Lt)>=0||Lt===""||wr(Lt)?at:[].concat(mm(at),[Lt])},[]);else if(z==="number"){var De=UTe(ue,o.filter(function(at){var Lt,$t,Tr=h in at.props?at.props[h]:(Lt=at.type.defaultProps)===null||Lt===void 0?void 0:Lt[h],Br="hide"in at.props?at.props.hide:($t=at.type.defaultProps)===null||$t===void 0?void 0:$t.hide;return Tr===pe&&(te||!Br)}),B,l,b);De&&(Oe=De)}k&&(z==="number"||H!=="auto")&&(Ge=uv(ue,B,"category"))}else k?Oe=Qw(0,Ee):f&&f[pe]&&f[pe].hasStack&&z==="number"?Oe=A==="expand"?[0,1]:lq(f[pe].stackGroups,s,y):Oe=oq(ue,o.filter(function(at){var Lt=h in at.props?at.props[h]:at.type.defaultProps[h],$t="hide"in at.props?at.props.hide:at.type.defaultProps.hide;return Lt===pe&&(te||!$t)}),z,b,!0);if(z==="number")Oe=hO(w,Oe,pe,l,Y),tt&&(Oe=Ck(tt,Oe,Z));else if(z==="category"&&tt){var ut=tt,ht=Oe.every(function(at){return ut.indexOf(at)>=0});ht&&(Oe=ut)}}return ct(ct({},M),{},dr({},pe,ct(ct({},L),{},{axisType:l,domain:Oe,categoricalDomain:Ge,duplicateDomain:je,originalDomain:(j=L.domain)!==null&&j!==void 0?j:Ze,isCategorical:k,layout:b})))},{})},rDe=function(t,r){var n=r.graphicalItems,o=r.Axis,l=r.axisType,h=r.axisIdKey,f=r.stackGroups,s=r.dataStartIndex,y=r.dataEndIndex,b=t.layout,w=t.children,A=jS(t.data,{graphicalItems:n,dataStartIndex:s,dataEndIndex:y}),k=A.length,M=sq(b,l),R=-1;return n.reduce(function(j,L){var z=L.type.defaultProps!==void 0?ct(ct({},L.type.defaultProps),L.props):L.props,B=z[h],Z=wH("number");if(!j[B]){R++;var F;return M?F=Qw(0,k):f&&f[B]&&f[B].hasStack?(F=lq(f[B].stackGroups,s,y),F=hO(w,F,B,l)):(F=Ck(Z,oq(A,n.filter(function(H){var Y,te,pe=h in H.props?H.props[h]:(Y=H.type.defaultProps)===null||Y===void 0?void 0:Y[h],ue="hide"in H.props?H.props.hide:(te=H.type.defaultProps)===null||te===void 0?void 0:te.hide;return pe===B&&!ue}),"number",b),o.defaultProps.allowDataOverflow),F=hO(w,F,B,l)),ct(ct({},j),{},dr({},B,ct(ct({axisType:l},o.defaultProps),{},{hide:!0,orientation:ta(YRe,"".concat(l,".").concat(R%2),null),domain:F,originalDomain:Z,isCategorical:M,layout:b})))}return j},{})},nDe=function(t,r){var n=r.axisType,o=n===void 0?"xAxis":n,l=r.AxisComp,h=r.graphicalItems,f=r.stackGroups,s=r.dataStartIndex,y=r.dataEndIndex,b=t.children,w="".concat(o,"Id"),A=os(b,l),k={};return A&&A.length?k=tDe(t,{axes:A,graphicalItems:h,axisType:o,axisIdKey:w,stackGroups:f,dataStartIndex:s,dataEndIndex:y}):h&&h.length&&(k=rDe(t,{Axis:l,graphicalItems:h,axisType:o,axisIdKey:w,stackGroups:f,dataStartIndex:s,dataEndIndex:y})),k},iDe=function(t){var r=pu(t),n=nc(r,!1,!0);return{tooltipTicks:n,orderedTooltipTicks:RI(n,function(o){return o.coordinate}),tooltipAxis:r,tooltipAxisBandSize:Vw(r,n)}},f4=function(t){var r=t.children,n=t.defaultShowTooltip,o=bs(r,rm),l=0,h=0;return t.data&&t.data.length!==0&&(h=t.data.length-1),o&&o.props&&(o.props.startIndex>=0&&(l=o.props.startIndex),o.props.endIndex>=0&&(h=o.props.endIndex)),{chartX:0,chartY:0,dataStartIndex:l,dataEndIndex:h,activeTooltipIndex:-1,isTooltipActive:!!n}},oDe=function(t){return!t||!t.length?!1:t.some(function(r){var n=sc(r&&r.type);return n&&n.indexOf("Bar")>=0})},p4=function(t){return t==="horizontal"?{numericAxisName:"yAxis",cateAxisName:"xAxis"}:t==="vertical"?{numericAxisName:"xAxis",cateAxisName:"yAxis"}:t==="centric"?{numericAxisName:"radiusAxis",cateAxisName:"angleAxis"}:{numericAxisName:"angleAxis",cateAxisName:"radiusAxis"}},sDe=function(t,r){var n=t.props,o=t.graphicalItems,l=t.xAxisMap,h=l===void 0?{}:l,f=t.yAxisMap,s=f===void 0?{}:f,y=n.width,b=n.height,w=n.children,A=n.margin||{},k=bs(w,rm),M=bs(w,hd),R=Object.keys(s).reduce(function(F,H){var Y=s[H],te=Y.orientation;return!Y.mirror&&!Y.hide?ct(ct({},F),{},dr({},te,F[te]+Y.width)):F},{left:A.left||0,right:A.right||0}),j=Object.keys(h).reduce(function(F,H){var Y=h[H],te=Y.orientation;return!Y.mirror&&!Y.hide?ct(ct({},F),{},dr({},te,ta(F,"".concat(te))+Y.height)):F},{top:A.top||0,bottom:A.bottom||0}),L=ct(ct({},j),R),z=L.bottom;k&&(L.bottom+=k.props.height||rm.defaultProps.height),M&&r&&(L=$Te(L,o,n,r));var B=y-L.left-L.right,Z=b-L.top-L.bottom;return ct(ct({brushBottom:z},L),{},{width:Math.max(B,0),height:Math.max(Z,0)})},aDe=function(t,r){if(r==="xAxis")return t[r].width;if(r==="yAxis")return t[r].height},vR=function(t){var r=t.chartName,n=t.GraphicalChild,o=t.defaultTooltipEventType,l=o===void 0?"axis":o,h=t.validateTooltipEventTypes,f=h===void 0?["axis"]:h,s=t.axisComponents,y=t.legendContent,b=t.formatAxisMap,w=t.defaultProps,A=function(L,z){var B=z.graphicalItems,Z=z.stackGroups,F=z.offset,H=z.updateId,Y=z.dataStartIndex,te=z.dataEndIndex,pe=L.barSize,ue=L.layout,Ee=L.barGap,Oe=L.barCategoryGap,je=L.maxBarSize,Ge=p4(ue),Ze=Ge.numericAxisName,Ye=Ge.cateAxisName,tt=oDe(B),ze=[];return B.forEach(function(De,ut){var ht=jS(L.data,{graphicalItems:[De],dataStartIndex:Y,dataEndIndex:te}),at=De.type.defaultProps!==void 0?ct(ct({},De.type.defaultProps),De.props):De.props,Lt=at.dataKey,$t=at.maxBarSize,Tr=at["".concat(Ze,"Id")],Br=at["".concat(Ye,"Id")],cn={},Vr=s.reduce(function(zi,jn){var oo=z["".concat(jn.axisType,"Map")],Zi=at["".concat(jn.axisType,"Id")];oo&&oo[Zi]||jn.axisType==="zAxis"||Ed();var so=oo[Zi];return ct(ct({},zi),{},dr(dr({},jn.axisType,so),"".concat(jn.axisType,"Ticks"),nc(so)))},cn),Dt=Vr[Ye],Jt=Vr["".concat(Ye,"Ticks")],rr=Z&&Z[Tr]&&Z[Tr].hasStack&&eEe(De,Z[Tr].stackGroups),Le=sc(De.type).indexOf("Bar")>=0,qt=Vw(Dt,Jt),Tt=[],St=tt&&BTe({barSize:pe,stackGroups:Z,totalSize:aDe(Vr,Ye)});if(Le){var Et,Ft,un=wr($t)?je:$t,Gr=(Et=(Ft=Vw(Dt,Jt,!0))!==null&&Ft!==void 0?Ft:un)!==null&&Et!==void 0?Et:0;Tt=NTe({barGap:Ee,barCategoryGap:Oe,bandSize:Gr!==qt?Gr:qt,sizeList:St[Br],maxBarSize:un}),Gr!==qt&&(Tt=Tt.map(function(zi){return ct(ct({},zi),{},{position:ct(ct({},zi.position),{},{offset:zi.position.offset-Gr/2})})}))}var hn=De&&De.type&&De.type.getComposedData;hn&&ze.push({props:ct(ct({},hn(ct(ct({},Vr),{},{displayedData:ht,props:L,dataKey:Lt,item:De,bandSize:qt,barPosition:Tt,offset:F,stackedData:rr,layout:ue,dataStartIndex:Y,dataEndIndex:te}))),{},dr(dr(dr({key:De.key||"item-".concat(ut)},Ze,Vr[Ze]),Ye,Vr[Ye]),"animationId",H)),childIndex:zhe(De,L.children),item:De})}),ze},k=function(L,z){var B=L.props,Z=L.dataStartIndex,F=L.dataEndIndex,H=L.updateId;if(!z3({props:B}))return null;var Y=B.children,te=B.layout,pe=B.stackOffset,ue=B.data,Ee=B.reverseStackOrder,Oe=p4(te),je=Oe.numericAxisName,Ge=Oe.cateAxisName,Ze=os(Y,n),Ye=YTe(ue,Ze,"".concat(je,"Id"),"".concat(Ge,"Id"),pe,Ee),tt=s.reduce(function(at,Lt){var $t="".concat(Lt.axisType,"Map");return ct(ct({},at),{},dr({},$t,nDe(B,ct(ct({},Lt),{},{graphicalItems:Ze,stackGroups:Lt.axisType===je&&Ye,dataStartIndex:Z,dataEndIndex:F}))))},{}),ze=sDe(ct(ct({},tt),{},{props:B,graphicalItems:Ze}),z==null?void 0:z.legendBBox);Object.keys(tt).forEach(function(at){tt[at]=b(B,tt[at],ze,at.replace("Map",""),r)});var De=tt["".concat(Ge,"Map")],ut=iDe(De),ht=A(B,ct(ct({},tt),{},{dataStartIndex:Z,dataEndIndex:F,updateId:H,graphicalItems:Ze,stackGroups:Ye,offset:ze}));return ct(ct({formattedGraphicalItems:ht,graphicalItems:Ze,offset:ze,stackGroups:Ye},ut),tt)},M=function(j){function L(z){var B,Z,F;return $Re(this,L),F=VRe(this,L,[z]),dr(F,"eventEmitterSymbol",Symbol("rechartsEventEmitter")),dr(F,"accessibilityManager",new ARe),dr(F,"handleLegendBBoxUpdate",function(H){if(H){var Y=F.state,te=Y.dataStartIndex,pe=Y.dataEndIndex,ue=Y.updateId;F.setState(ct({legendBBox:H},k({props:F.props,dataStartIndex:te,dataEndIndex:pe,updateId:ue},ct(ct({},F.state),{},{legendBBox:H}))))}}),dr(F,"handleReceiveSyncEvent",function(H,Y,te){if(F.props.syncId===H){if(te===F.eventEmitterSymbol&&typeof F.props.syncMethod!="function")return;F.applySyncEvent(Y)}}),dr(F,"handleBrushChange",function(H){var Y=H.startIndex,te=H.endIndex;if(Y!==F.state.dataStartIndex||te!==F.state.dataEndIndex){var pe=F.state.updateId;F.setState(function(){return ct({dataStartIndex:Y,dataEndIndex:te},k({props:F.props,dataStartIndex:Y,dataEndIndex:te,updateId:pe},F.state))}),F.triggerSyncEvent({dataStartIndex:Y,dataEndIndex:te})}}),dr(F,"handleMouseEnter",function(H){var Y=F.getMouseInfo(H);if(Y){var te=ct(ct({},Y),{},{isTooltipActive:!0});F.setState(te),F.triggerSyncEvent(te);var pe=F.props.onMouseEnter;Ar(pe)&&pe(te,H)}}),dr(F,"triggeredAfterMouseMove",function(H){var Y=F.getMouseInfo(H),te=Y?ct(ct({},Y),{},{isTooltipActive:!0}):{isTooltipActive:!1};F.setState(te),F.triggerSyncEvent(te);var pe=F.props.onMouseMove;Ar(pe)&&pe(te,H)}),dr(F,"handleItemMouseEnter",function(H){F.setState(function(){return{isTooltipActive:!0,activeItem:H,activePayload:H.tooltipPayload,activeCoordinate:H.tooltipPosition||{x:H.cx,y:H.cy}}})}),dr(F,"handleItemMouseLeave",function(){F.setState(function(){return{isTooltipActive:!1}})}),dr(F,"handleMouseMove",function(H){H.persist(),F.throttleTriggeredAfterMouseMove(H)}),dr(F,"handleMouseLeave",function(H){F.throttleTriggeredAfterMouseMove.cancel();var Y={isTooltipActive:!1};F.setState(Y),F.triggerSyncEvent(Y);var te=F.props.onMouseLeave;Ar(te)&&te(Y,H)}),dr(F,"handleOuterEvent",function(H){var Y=jhe(H),te=ta(F.props,"".concat(Y));if(Y&&Ar(te)){var pe,ue;/.*touch.*/i.test(Y)?ue=F.getMouseInfo(H.changedTouches[0]):ue=F.getMouseInfo(H),te((pe=ue)!==null&&pe!==void 0?pe:{},H)}}),dr(F,"handleClick",function(H){var Y=F.getMouseInfo(H);if(Y){var te=ct(ct({},Y),{},{isTooltipActive:!0});F.setState(te),F.triggerSyncEvent(te);var pe=F.props.onClick;Ar(pe)&&pe(te,H)}}),dr(F,"handleMouseDown",function(H){var Y=F.props.onMouseDown;if(Ar(Y)){var te=F.getMouseInfo(H);Y(te,H)}}),dr(F,"handleMouseUp",function(H){var Y=F.props.onMouseUp;if(Ar(Y)){var te=F.getMouseInfo(H);Y(te,H)}}),dr(F,"handleTouchMove",function(H){H.changedTouches!=null&&H.changedTouches.length>0&&F.throttleTriggeredAfterMouseMove(H.changedTouches[0])}),dr(F,"handleTouchStart",function(H){H.changedTouches!=null&&H.changedTouches.length>0&&F.handleMouseDown(H.changedTouches[0])}),dr(F,"handleTouchEnd",function(H){H.changedTouches!=null&&H.changedTouches.length>0&&F.handleMouseUp(H.changedTouches[0])}),dr(F,"handleDoubleClick",function(H){var Y=F.props.onDoubleClick;if(Ar(Y)){var te=F.getMouseInfo(H);Y(te,H)}}),dr(F,"handleContextMenu",function(H){var Y=F.props.onContextMenu;if(Ar(Y)){var te=F.getMouseInfo(H);Y(te,H)}}),dr(F,"triggerSyncEvent",function(H){F.props.syncId!==void 0&&KA.emit(ZA,F.props.syncId,H,F.eventEmitterSymbol)}),dr(F,"applySyncEvent",function(H){var Y=F.props,te=Y.layout,pe=Y.syncMethod,ue=F.state.updateId,Ee=H.dataStartIndex,Oe=H.dataEndIndex;if(H.dataStartIndex!==void 0||H.dataEndIndex!==void 0)F.setState(ct({dataStartIndex:Ee,dataEndIndex:Oe},k({props:F.props,dataStartIndex:Ee,dataEndIndex:Oe,updateId:ue},F.state)));else if(H.activeTooltipIndex!==void 0){var je=H.chartX,Ge=H.chartY,Ze=H.activeTooltipIndex,Ye=F.state,tt=Ye.offset,ze=Ye.tooltipTicks;if(!tt)return;if(typeof pe=="function")Ze=pe(ze,H);else if(pe==="value"){Ze=-1;for(var De=0;De<ze.length;De++)if(ze[De].value===H.activeLabel){Ze=De;break}}var ut=ct(ct({},tt),{},{x:tt.left,y:tt.top}),ht=Math.min(je,ut.x+ut.width),at=Math.min(Ge,ut.y+ut.height),Lt=ze[Ze]&&ze[Ze].value,$t=pO(F.state,F.props.data,Ze),Tr=ze[Ze]?{x:te==="horizontal"?ze[Ze].coordinate:ht,y:te==="horizontal"?at:ze[Ze].coordinate}:bH;F.setState(ct(ct({},H),{},{activeLabel:Lt,activeCoordinate:Tr,activePayload:$t,activeTooltipIndex:Ze}))}else F.setState(H)}),dr(F,"renderCursor",function(H){var Y,te=F.state,pe=te.isTooltipActive,ue=te.activeCoordinate,Ee=te.activePayload,Oe=te.offset,je=te.activeTooltipIndex,Ge=te.tooltipAxisBandSize,Ze=F.getTooltipEventType(),Ye=(Y=H.props.active)!==null&&Y!==void 0?Y:pe,tt=F.props.layout,ze=H.key||"_recharts-cursor";return Ce.createElement(RRe,{key:ze,activeCoordinate:ue,activePayload:Ee,activeTooltipIndex:je,chartName:r,element:H,isActive:Ye,layout:tt,offset:Oe,tooltipAxisBandSize:Ge,tooltipEventType:Ze})}),dr(F,"renderPolarAxis",function(H,Y,te){var pe=ta(H,"type.axisType"),ue=ta(F.state,"".concat(pe,"Map")),Ee=H.type.defaultProps,Oe=Ee!==void 0?ct(ct({},Ee),H.props):H.props,je=ue&&ue[Oe["".concat(pe,"Id")]];return re.cloneElement(H,ct(ct({},je),{},{className:zr(pe,je.className),key:H.key||"".concat(Y,"-").concat(te),ticks:nc(je,!0)}))}),dr(F,"renderPolarGrid",function(H){var Y=H.props,te=Y.radialLines,pe=Y.polarAngles,ue=Y.polarRadius,Ee=F.state,Oe=Ee.radiusAxisMap,je=Ee.angleAxisMap,Ge=pu(Oe),Ze=pu(je),Ye=Ze.cx,tt=Ze.cy,ze=Ze.innerRadius,De=Ze.outerRadius;return re.cloneElement(H,{polarAngles:Array.isArray(pe)?pe:nc(Ze,!0).map(function(ut){return ut.coordinate}),polarRadius:Array.isArray(ue)?ue:nc(Ge,!0).map(function(ut){return ut.coordinate}),cx:Ye,cy:tt,innerRadius:ze,outerRadius:De,key:H.key||"polar-grid",radialLines:te})}),dr(F,"renderLegend",function(){var H=F.state.formattedGraphicalItems,Y=F.props,te=Y.children,pe=Y.width,ue=Y.height,Ee=F.props.margin||{},Oe=pe-(Ee.left||0)-(Ee.right||0),je=nq({children:te,formattedGraphicalItems:H,legendWidth:Oe,legendContent:y});if(!je)return null;var Ge=je.item,Ze=u4(je,DRe);return re.cloneElement(Ge,ct(ct({},Ze),{},{chartWidth:pe,chartHeight:ue,margin:Ee,onBBoxUpdate:F.handleLegendBBoxUpdate}))}),dr(F,"renderTooltip",function(){var H,Y=F.props,te=Y.children,pe=Y.accessibilityLayer,ue=bs(te,ws);if(!ue)return null;var Ee=F.state,Oe=Ee.isTooltipActive,je=Ee.activeCoordinate,Ge=Ee.activePayload,Ze=Ee.activeLabel,Ye=Ee.offset,tt=(H=ue.props.active)!==null&&H!==void 0?H:Oe;return re.cloneElement(ue,{viewBox:ct(ct({},Ye),{},{x:Ye.left,y:Ye.top}),active:tt,label:Ze,payload:tt?Ge:[],coordinate:je,accessibilityLayer:pe})}),dr(F,"renderBrush",function(H){var Y=F.props,te=Y.margin,pe=Y.data,ue=F.state,Ee=ue.offset,Oe=ue.dataStartIndex,je=ue.dataEndIndex,Ge=ue.updateId;return re.cloneElement(H,{key:H.key||"_recharts-brush",onChange:Qx(F.handleBrushChange,H.props.onChange),data:pe,x:It(H.props.x)?H.props.x:Ee.left,y:It(H.props.y)?H.props.y:Ee.top+Ee.height+Ee.brushBottom-(te.bottom||0),width:It(H.props.width)?H.props.width:Ee.width,startIndex:Oe,endIndex:je,updateId:"brush-".concat(Ge)})}),dr(F,"renderReferenceElement",function(H,Y,te){if(!H)return null;var pe=F,ue=pe.clipPathId,Ee=F.state,Oe=Ee.xAxisMap,je=Ee.yAxisMap,Ge=Ee.offset,Ze=H.type.defaultProps||{},Ye=H.props,tt=Ye.xAxisId,ze=tt===void 0?Ze.xAxisId:tt,De=Ye.yAxisId,ut=De===void 0?Ze.yAxisId:De;return re.cloneElement(H,{key:H.key||"".concat(Y,"-").concat(te),xAxis:Oe[ze],yAxis:je[ut],viewBox:{x:Ge.left,y:Ge.top,width:Ge.width,height:Ge.height},clipPathId:ue})}),dr(F,"renderActivePoints",function(H){var Y=H.item,te=H.activePoint,pe=H.basePoint,ue=H.childIndex,Ee=H.isRange,Oe=[],je=Y.props.key,Ge=Y.item.type.defaultProps!==void 0?ct(ct({},Y.item.type.defaultProps),Y.item.props):Y.item.props,Ze=Ge.activeDot,Ye=Ge.dataKey,tt=ct(ct({index:ue,dataKey:Ye,cx:te.x,cy:te.y,r:4,fill:sR(Y.item),strokeWidth:2,stroke:"#fff",payload:te.payload,value:te.value},Sr(Ze,!1)),mw(Ze));return Oe.push(L.renderActiveDot(Ze,tt,"".concat(je,"-activePoint-").concat(ue))),pe?Oe.push(L.renderActiveDot(Ze,ct(ct({},tt),{},{cx:pe.x,cy:pe.y}),"".concat(je,"-basePoint-").concat(ue))):Ee&&Oe.push(null),Oe}),dr(F,"renderGraphicChild",function(H,Y,te){var pe=F.filterFormatItem(H,Y,te);if(!pe)return null;var ue=F.getTooltipEventType(),Ee=F.state,Oe=Ee.isTooltipActive,je=Ee.tooltipAxis,Ge=Ee.activeTooltipIndex,Ze=Ee.activeLabel,Ye=F.props.children,tt=bs(Ye,ws),ze=pe.props,De=ze.points,ut=ze.isRange,ht=ze.baseLine,at=pe.item.type.defaultProps!==void 0?ct(ct({},pe.item.type.defaultProps),pe.item.props):pe.item.props,Lt=at.activeDot,$t=at.hide,Tr=at.activeBar,Br=at.activeShape,cn=!!(!$t&&Oe&&tt&&(Lt||Tr||Br)),Vr={};ue!=="axis"&&tt&&tt.props.trigger==="click"?Vr={onClick:Qx(F.handleItemMouseEnter,H.props.onClick)}:ue!=="axis"&&(Vr={onMouseLeave:Qx(F.handleItemMouseLeave,H.props.onMouseLeave),onMouseEnter:Qx(F.handleItemMouseEnter,H.props.onMouseEnter)});var Dt=re.cloneElement(H,ct(ct({},pe.props),Vr));function Jt(jn){return typeof je.dataKey=="function"?je.dataKey(jn.payload):null}if(cn)if(Ge>=0){var rr,Le;if(je.dataKey&&!je.allowDuplicatedCategory){var qt=typeof je.dataKey=="function"?Jt:"payload.".concat(je.dataKey.toString());rr=pw(De,qt,Ze),Le=ut&&ht&&pw(ht,qt,Ze)}else rr=De==null?void 0:De[Ge],Le=ut&&ht&&ht[Ge];if(Br||Tr){var Tt=H.props.activeIndex!==void 0?H.props.activeIndex:Ge;return[re.cloneElement(H,ct(ct(ct({},pe.props),Vr),{},{activeIndex:Tt})),null,null]}if(!wr(rr))return[Dt].concat(mm(F.renderActivePoints({item:pe,activePoint:rr,basePoint:Le,childIndex:Ge,isRange:ut})))}else{var St,Et=(St=F.getItemByXY(F.state.activeCoordinate))!==null&&St!==void 0?St:{graphicalItem:Dt},Ft=Et.graphicalItem,un=Ft.item,Gr=un===void 0?H:un,hn=Ft.childIndex,zi=ct(ct(ct({},pe.props),Vr),{},{activeIndex:hn});return[re.cloneElement(Gr,zi),null,null]}return ut?[Dt,null,null]:[Dt,null]}),dr(F,"renderCustomized",function(H,Y,te){return re.cloneElement(H,ct(ct({key:"recharts-customized-".concat(te)},F.props),F.state))}),dr(F,"renderMap",{CartesianGrid:{handler:ib,once:!0},ReferenceArea:{handler:F.renderReferenceElement},ReferenceLine:{handler:ib},ReferenceDot:{handler:F.renderReferenceElement},XAxis:{handler:ib},YAxis:{handler:ib},Brush:{handler:F.renderBrush,once:!0},Bar:{handler:F.renderGraphicChild},Line:{handler:F.renderGraphicChild},Area:{handler:F.renderGraphicChild},Radar:{handler:F.renderGraphicChild},RadialBar:{handler:F.renderGraphicChild},Scatter:{handler:F.renderGraphicChild},Pie:{handler:F.renderGraphicChild},Funnel:{handler:F.renderGraphicChild},Tooltip:{handler:F.renderCursor,once:!0},PolarGrid:{handler:F.renderPolarGrid,once:!0},PolarAngleAxis:{handler:F.renderPolarAxis},PolarRadiusAxis:{handler:F.renderPolarAxis},Customized:{handler:F.renderCustomized}}),F.clipPathId="".concat((B=z.id)!==null&&B!==void 0?B:Md("recharts"),"-clip"),F.throttleTriggeredAfterMouseMove=nW(F.triggeredAfterMouseMove,(Z=z.throttleDelay)!==null&&Z!==void 0?Z:1e3/60),F.state={},F}return qRe(L,j),URe(L,[{key:"componentDidMount",value:function(){var B,Z;this.addListener(),this.accessibilityManager.setDetails({container:this.container,offset:{left:(B=this.props.margin.left)!==null&&B!==void 0?B:0,top:(Z=this.props.margin.top)!==null&&Z!==void 0?Z:0},coordinateList:this.state.tooltipTicks,mouseHandlerCallback:this.triggeredAfterMouseMove,layout:this.props.layout}),this.displayDefaultTooltip()}},{key:"displayDefaultTooltip",value:function(){var B=this.props,Z=B.children,F=B.data,H=B.height,Y=B.layout,te=bs(Z,ws);if(te){var pe=te.props.defaultIndex;if(!(typeof pe!="number"||pe<0||pe>this.state.tooltipTicks.length-1)){var ue=this.state.tooltipTicks[pe]&&this.state.tooltipTicks[pe].value,Ee=pO(this.state,F,pe,ue),Oe=this.state.tooltipTicks[pe].coordinate,je=(this.state.offset.top+H)/2,Ge=Y==="horizontal",Ze=Ge?{x:Oe,y:je}:{y:Oe,x:je},Ye=this.state.formattedGraphicalItems.find(function(ze){var De=ze.item;return De.type.name==="Scatter"});Ye&&(Ze=ct(ct({},Ze),Ye.props.points[pe].tooltipPosition),Ee=Ye.props.points[pe].tooltipPayload);var tt={activeTooltipIndex:pe,isTooltipActive:!0,activeLabel:ue,activePayload:Ee,activeCoordinate:Ze};this.setState(tt),this.renderCursor(te),this.accessibilityManager.setIndex(pe)}}}},{key:"getSnapshotBeforeUpdate",value:function(B,Z){if(!this.props.accessibilityLayer)return null;if(this.state.tooltipTicks!==Z.tooltipTicks&&this.accessibilityManager.setDetails({coordinateList:this.state.tooltipTicks}),this.props.layout!==B.layout&&this.accessibilityManager.setDetails({layout:this.props.layout}),this.props.margin!==B.margin){var F,H;this.accessibilityManager.setDetails({offset:{left:(F=this.props.margin.left)!==null&&F!==void 0?F:0,top:(H=this.props.margin.top)!==null&&H!==void 0?H:0}})}return null}},{key:"componentDidUpdate",value:function(B){VC([bs(B.children,ws)],[bs(this.props.children,ws)])||this.displayDefaultTooltip()}},{key:"componentWillUnmount",value:function(){this.removeListener(),this.throttleTriggeredAfterMouseMove.cancel()}},{key:"getTooltipEventType",value:function(){var B=bs(this.props.children,ws);if(B&&typeof B.props.shared=="boolean"){var Z=B.props.shared?"axis":"item";return f.indexOf(Z)>=0?Z:l}return l}},{key:"getMouseInfo",value:function(B){if(!this.container)return null;var Z=this.container,F=Z.getBoundingClientRect(),H=cbe(F),Y={chartX:Math.round(B.pageX-H.left),chartY:Math.round(B.pageY-H.top)},te=F.width/Z.offsetWidth||1,pe=this.inRange(Y.chartX,Y.chartY,te);if(!pe)return null;var ue=this.state,Ee=ue.xAxisMap,Oe=ue.yAxisMap,je=this.getTooltipEventType(),Ge=d4(this.state,this.props.data,this.props.layout,pe);if(je!=="axis"&&Ee&&Oe){var Ze=pu(Ee).scale,Ye=pu(Oe).scale,tt=Ze&&Ze.invert?Ze.invert(Y.chartX):null,ze=Ye&&Ye.invert?Ye.invert(Y.chartY):null;return ct(ct({},Y),{},{xValue:tt,yValue:ze},Ge)}return Ge?ct(ct({},Y),Ge):null}},{key:"inRange",value:function(B,Z){var F=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,H=this.props.layout,Y=B/F,te=Z/F;if(H==="horizontal"||H==="vertical"){var pe=this.state.offset,ue=Y>=pe.left&&Y<=pe.left+pe.width&&te>=pe.top&&te<=pe.top+pe.height;return ue?{x:Y,y:te}:null}var Ee=this.state,Oe=Ee.angleAxisMap,je=Ee.radiusAxisMap;if(Oe&&je){var Ge=pu(Oe);return q$({x:Y,y:te},Ge)}return null}},{key:"parseEventsOfWrapper",value:function(){var B=this.props.children,Z=this.getTooltipEventType(),F=bs(B,ws),H={};F&&Z==="axis"&&(F.props.trigger==="click"?H={onClick:this.handleClick}:H={onMouseEnter:this.handleMouseEnter,onDoubleClick:this.handleDoubleClick,onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,onTouchMove:this.handleTouchMove,onTouchStart:this.handleTouchStart,onTouchEnd:this.handleTouchEnd,onContextMenu:this.handleContextMenu});var Y=mw(this.props,this.handleOuterEvent);return ct(ct({},Y),H)}},{key:"addListener",value:function(){KA.on(ZA,this.handleReceiveSyncEvent)}},{key:"removeListener",value:function(){KA.removeListener(ZA,this.handleReceiveSyncEvent)}},{key:"filterFormatItem",value:function(B,Z,F){for(var H=this.state.formattedGraphicalItems,Y=0,te=H.length;Y<te;Y++){var pe=H[Y];if(pe.item===B||pe.props.key===B.key||Z===sc(pe.item.type)&&F===pe.childIndex)return pe}return null}},{key:"renderClipPath",value:function(){var B=this.clipPathId,Z=this.state.offset,F=Z.left,H=Z.top,Y=Z.height,te=Z.width;return Ce.createElement("defs",null,Ce.createElement("clipPath",{id:B},Ce.createElement("rect",{x:F,y:H,height:Y,width:te})))}},{key:"getXScales",value:function(){var B=this.state.xAxisMap;return B?Object.entries(B).reduce(function(Z,F){var H=c4(F,2),Y=H[0],te=H[1];return ct(ct({},Z),{},dr({},Y,te.scale))},{}):null}},{key:"getYScales",value:function(){var B=this.state.yAxisMap;return B?Object.entries(B).reduce(function(Z,F){var H=c4(F,2),Y=H[0],te=H[1];return ct(ct({},Z),{},dr({},Y,te.scale))},{}):null}},{key:"getXScaleByAxisId",value:function(B){var Z;return(Z=this.state.xAxisMap)===null||Z===void 0||(Z=Z[B])===null||Z===void 0?void 0:Z.scale}},{key:"getYScaleByAxisId",value:function(B){var Z;return(Z=this.state.yAxisMap)===null||Z===void 0||(Z=Z[B])===null||Z===void 0?void 0:Z.scale}},{key:"getItemByXY",value:function(B){var Z=this.state,F=Z.formattedGraphicalItems,H=Z.activeItem;if(F&&F.length)for(var Y=0,te=F.length;Y<te;Y++){var pe=F[Y],ue=pe.props,Ee=pe.item,Oe=Ee.type.defaultProps!==void 0?ct(ct({},Ee.type.defaultProps),Ee.props):Ee.props,je=sc(Ee.type);if(je==="Bar"){var Ge=(ue.data||[]).find(function(ze){return ZPe(B,ze)});if(Ge)return{graphicalItem:pe,payload:Ge}}else if(je==="RadialBar"){var Ze=(ue.data||[]).find(function(ze){return q$(B,ze)});if(Ze)return{graphicalItem:pe,payload:Ze}}else if(PS(pe,H)||CS(pe,H)||b_(pe,H)){var Ye=YCe({graphicalItem:pe,activeTooltipItem:H,itemData:Oe.data}),tt=Oe.activeIndex===void 0?Ye:Oe.activeIndex;return{graphicalItem:ct(ct({},pe),{},{childIndex:tt}),payload:b_(pe,H)?Oe.data[Ye]:pe.props.data[Ye]}}}return null}},{key:"render",value:function(){var B=this;if(!z3(this))return null;var Z=this.props,F=Z.children,H=Z.className,Y=Z.width,te=Z.height,pe=Z.style,ue=Z.compact,Ee=Z.title,Oe=Z.desc,je=u4(Z,LRe),Ge=Sr(je,!1);if(ue)return Ce.createElement(FF,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},Ce.createElement(WC,vp({},Ge,{width:Y,height:te,title:Ee,desc:Oe}),this.renderClipPath(),N3(F,this.renderMap)));if(this.props.accessibilityLayer){var Ze,Ye;Ge.tabIndex=(Ze=this.props.tabIndex)!==null&&Ze!==void 0?Ze:0,Ge.role=(Ye=this.props.role)!==null&&Ye!==void 0?Ye:"application",Ge.onKeyDown=function(ze){B.accessibilityManager.keyboardEvent(ze)},Ge.onFocus=function(){B.accessibilityManager.focus()}}var tt=this.parseEventsOfWrapper();return Ce.createElement(FF,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},Ce.createElement("div",vp({className:zr("recharts-wrapper",H),style:ct({position:"relative",cursor:"default",width:Y,height:te},pe)},tt,{ref:function(De){B.container=De}}),Ce.createElement(WC,vp({},Ge,{width:Y,height:te,title:Ee,desc:Oe,style:JRe}),this.renderClipPath(),N3(F,this.renderMap)),this.renderLegend(),this.renderTooltip()))}}])}(re.Component);dr(M,"displayName",r),dr(M,"defaultProps",ct({layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:{top:5,right:5,bottom:5,left:5},reverseStackOrder:!1,syncMethod:"index"},w)),dr(M,"getDerivedStateFromProps",function(j,L){var z=j.dataKey,B=j.data,Z=j.children,F=j.width,H=j.height,Y=j.layout,te=j.stackOffset,pe=j.margin,ue=L.dataStartIndex,Ee=L.dataEndIndex;if(L.updateId===void 0){var Oe=f4(j);return ct(ct(ct({},Oe),{},{updateId:0},k(ct(ct({props:j},Oe),{},{updateId:0}),L)),{},{prevDataKey:z,prevData:B,prevWidth:F,prevHeight:H,prevLayout:Y,prevStackOffset:te,prevMargin:pe,prevChildren:Z})}if(z!==L.prevDataKey||B!==L.prevData||F!==L.prevWidth||H!==L.prevHeight||Y!==L.prevLayout||te!==L.prevStackOffset||!Mp(pe,L.prevMargin)){var je=f4(j),Ge={chartX:L.chartX,chartY:L.chartY,isTooltipActive:L.isTooltipActive},Ze=ct(ct({},d4(L,B,Y)),{},{updateId:L.updateId+1}),Ye=ct(ct(ct({},je),Ge),Ze);return ct(ct(ct({},Ye),k(ct({props:j},Ye),L)),{},{prevDataKey:z,prevData:B,prevWidth:F,prevHeight:H,prevLayout:Y,prevStackOffset:te,prevMargin:pe,prevChildren:Z})}if(!VC(Z,L.prevChildren)){var tt,ze,De,ut,ht=bs(Z,rm),at=ht&&(tt=(ze=ht.props)===null||ze===void 0?void 0:ze.startIndex)!==null&&tt!==void 0?tt:ue,Lt=ht&&(De=(ut=ht.props)===null||ut===void 0?void 0:ut.endIndex)!==null&&De!==void 0?De:Ee,$t=at!==ue||Lt!==Ee,Tr=!wr(B),Br=Tr&&!$t?L.updateId:L.updateId+1;return ct(ct({updateId:Br},k(ct(ct({props:j},L),{},{updateId:Br,dataStartIndex:at,dataEndIndex:Lt}),L)),{},{prevChildren:Z,dataStartIndex:at,dataEndIndex:Lt})}return null}),dr(M,"renderActiveDot",function(j,L,z){var B;return re.isValidElement(j)?B=re.cloneElement(j,L):Ar(j)?B=j(L):B=Ce.createElement(AS,L),Ce.createElement(sn,{className:"recharts-active-dot",key:z},B)});var R=re.forwardRef(function(L,z){return Ce.createElement(M,vp({},L,{ref:z}))});return R.displayName=M.displayName,R},SH=vR({chartName:"LineChart",GraphicalChild:El,axisComponents:[{axisType:"xAxis",AxisComp:cc},{axisType:"yAxis",AxisComp:yl}],formatAxisMap:lR}),lDe=vR({chartName:"BarChart",GraphicalChild:vc,defaultTooltipEventType:"axis",validateTooltipEventTypes:["axis","item"],axisComponents:[{axisType:"xAxis",AxisComp:cc},{axisType:"yAxis",AxisComp:yl}],formatAxisMap:lR}),cDe=vR({chartName:"ComposedChart",GraphicalChild:[El,Ld,vc,LS],axisComponents:[{axisType:"xAxis",AxisComp:cc},{axisType:"yAxis",AxisComp:yl},{axisType:"zAxis",AxisComp:DS}],formatAxisMap:lR});function uDe(){var at,Lt,$t,Tr,Br,cn,Vr,Dt,Jt,rr;const{id:e}=rY(),t=Fu(),{user:r}=Uu(),[n,o]=re.useState(null),[l,h]=re.useState(!0),[f,s]=re.useState([]),[y,b]=re.useState(!1),[w,A]=re.useState([]),[k]=re.useState(!1),M=Array.isArray(n==null?void 0:n.attachments)?n.attachments:[],[R,j]=re.useState(!1),[L,z]=re.useState(null),[B,Z]=re.useState(!1),[F,H]=re.useState(!1),[Y,te]=re.useState(void 0),[pe,ue]=re.useState([]),[Ee,Oe]=re.useState(""),je=re.useRef(null),Ge=async()=>{var Le,qt,Tt,St;if(e&&r){j(!0),z(null);try{const Et=await Yo.getSOSChatById(e);Z(!1),ue(Array.isArray(Et==null?void 0:Et.messages)?Et.messages:[]),H(!!(Et!=null&&Et.read_only)),te((Le=Et==null?void 0:Et.chat)==null?void 0:Le.security_email);const Ft=Op();if(Ft)if(Ft.connected)Ft.emit("join_sos_chat",e);else{const un=()=>{Ft.emit("join_sos_chat",e),Ft.off("connect",un)};Ft.on("connect",un)}}catch(Et){if(((qt=Et==null?void 0:Et.response)==null?void 0:qt.status)===403){Z(!0);return}const un=((St=(Tt=Et==null?void 0:Et.response)==null?void 0:Tt.data)==null?void 0:St.error)||(Et==null?void 0:Et.message)||"Failed to load chat";z(un)}finally{j(!1)}}};re.useEffect(()=>{je.current=(n==null?void 0:n.user_id)||null},[n==null?void 0:n.user_id]),re.useEffect(()=>{if(!e)return;Ye();const Le=localStorage.getItem("accessToken");if(Le){const qt=fw(Le);return qt.emit("join_sos",e),qt.on("live_feed",Tt=>{s(St=>{const Et=je.current;return Et&&(Tt!=null&&Tt.userId)&&Tt.userId!==Et?St:[...St.slice(-50),Tt]})}),qt.on("sos_status_update",Tt=>{Tt.id===e&&o(St=>St?{...St,...Tt,attachment_urls:(Tt==null?void 0:Tt.attachment_urls)??(St==null?void 0:St.attachment_urls)}:Tt)}),qt.on("sos-updated",Tt=>{Tt.id===e&&o(St=>St?{...St,...Tt,attachment_urls:(Tt==null?void 0:Tt.attachment_urls)??(St==null?void 0:St.attachment_urls)}:Tt)}),()=>{qt.off("live_feed"),qt.off("sos_status_update"),qt.off("sos-updated"),qt.emit("leave_sos",e)}}},[e]),re.useEffect(()=>{const Le=n==null?void 0:n.attachment_urls;if(!n||!Array.isArray(Le)){A([]);return}A(Le)},[n==null?void 0:n.id,n==null?void 0:n.attachment_urls]),re.useEffect(()=>{if(e&&r)return Z(!1),ue([]),te(void 0),Ge(),()=>{const Le=Op();Le&&Le.connected&&Le.emit("leave_sos_chat",e)}},[e,r==null?void 0:r.id]),re.useEffect(()=>{e&&r&&r.role==="security"&&(n==null?void 0:n.status)==="acknowledged"&&(!B&&Y||Ge())},[n==null?void 0:n.status,B,Y,e,r==null?void 0:r.id,r==null?void 0:r.role]),re.useEffect(()=>{(n==null?void 0:n.status)==="resolved"&&H(!0)},[n==null?void 0:n.status]),re.useEffect(()=>{if(!e)return;const Le=Op();if(!Le)return;const qt=St=>{!St||String(St.sos_id)!==String(e)||ue(Et=>Et.some(Ft=>Ft.id===St.id)?Et:[...Et,St])},Tt=St=>{!St||String(St.sosId)!==String(e)||z(St.error||"Failed to send message")};return Le.on("chat:message",qt),Le.on("chat:error",Tt),()=>{Le.off("chat:message",qt),Le.off("chat:error",Tt)}},[e]);const Ze=async()=>{var qt,Tt;if(!e)return;const Le=Ee.trim();if(Le&&!(F||(n==null?void 0:n.status)==="resolved")){z(null);try{const St=await Yo.sendSOSChatMessage(e,Le);ue(Et=>Et.some(Ft=>Ft.id===St.id)?Et:[...Et,St]),Oe(""),await Ge()}catch(St){const Et=((Tt=(qt=St==null?void 0:St.response)==null?void 0:qt.data)==null?void 0:Tt.error)||(St==null?void 0:St.message)||"Failed to send message";z(Et)}}},Ye=async()=>{if(e)try{const Le=await Yo.getSOSById(e);o(Le)}catch(Le){console.error("Failed to load alert:",Le)}finally{h(!1)}},tt=async Le=>{var qt,Tt,St,Et;if(e){if((r==null?void 0:r.role)!=="security"){const Ft=document.createElement("div");Ft.className="fixed top-4 right-4 bg-red-500 text-white px-6 py-3 rounded-lg shadow-lg z-50",Ft.textContent="Only security personnel can update status",document.body.appendChild(Ft),setTimeout(()=>{Ft.remove()},3e3);return}try{b(!0);const Ft=await Yo.updateStatus(e,Le);o(hn=>hn?{...hn,...Ft,attachment_urls:(Ft==null?void 0:Ft.attachment_urls)??(hn==null?void 0:hn.attachment_urls)}:Ft),Le==="acknowledged"&&await Ge();const un=Le==="acknowledged"?"Alert acknowledged successfully":"Alert marked as resolved",Gr=document.createElement("div");Gr.className="fixed top-4 right-4 bg-green-500 text-white px-6 py-3 rounded-lg shadow-lg z-50",Gr.textContent=un,document.body.appendChild(Gr),setTimeout(()=>{Gr.remove()},3e3)}catch(Ft){console.error("Failed to update status:",Ft);const un=((Tt=(qt=Ft==null?void 0:Ft.response)==null?void 0:qt.data)==null?void 0:Tt.error)||((Et=(St=Ft==null?void 0:Ft.response)==null?void 0:St.data)==null?void 0:Et.message)||(Ft==null?void 0:Ft.message)||"Failed to update status",Gr=document.createElement("div");Gr.className="fixed top-4 right-4 bg-red-500 text-white px-6 py-3 rounded-lg shadow-lg z-50",Gr.textContent=un,document.body.appendChild(Gr),setTimeout(()=>{Gr.remove()},3e3)}finally{b(!1)}}};if(l)return W.jsxs("div",{className:"min-h-screen aurora-gradient flex items-center justify-center relative",children:[W.jsx("div",{className:"aurora-bg"}),W.jsx("div",{className:"glass-panel p-6 text-muted-foreground relative z-10",children:"Loading..."})]});if(!n)return W.jsxs("div",{className:"min-h-screen aurora-gradient flex items-center justify-center relative",children:[W.jsx("div",{className:"aurora-bg"}),W.jsx("div",{className:"glass-panel p-6 text-muted-foreground relative z-10",children:"Alert not found"})]});const ze=f.map((Le,qt)=>{var Tt,St;return{time:qt,risk:Le.totalRisk,audio:((Tt=Le.audio)==null?void 0:Tt.stress)*35||0,motion:((St=Le.motion)==null?void 0:St.intensity)*25||0}}),De=(at=n.location)==null?void 0:at.lat,ut=(Lt=n.location)==null?void 0:Lt.lng,ht=typeof De=="number"&&typeof ut=="number";return W.jsxs("div",{className:"min-h-screen aurora-gradient p-6 relative",children:[W.jsx("div",{className:"aurora-bg"}),W.jsxs("div",{className:"max-w-7xl mx-auto relative z-10",children:[W.jsxs("div",{className:"glass-panel border-b border-border/50 px-6 py-4 flex justify-between items-center mb-8",children:[W.jsx(Qs,{to:"/security",className:"text-aurora-cyan hover:opacity-80 transition-opacity",children:" Back to Alerts"}),W.jsx("button",{onClick:()=>t("/security"),className:"px-4 py-2 bg-secondary/60 hover:bg-secondary/80 text-foreground rounded-lg transition-colors border border-border/50",children:"Close"})]}),W.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[W.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[W.jsxs("div",{className:"glass-panel p-6",children:[W.jsxs("div",{className:"flex justify-between items-start mb-4",children:[W.jsxs("div",{children:[W.jsxs("h2",{className:"text-2xl font-bold text-foreground mb-2",children:["Risk Score: ",n.risk_score.toFixed(1)]}),W.jsxs("p",{className:"text-muted-foreground",children:["User: ",n.email]}),W.jsx("p",{className:"text-muted-foreground",children:new Date(n.created_at).toLocaleString()})]}),W.jsx("span",{className:`px-4 py-2 rounded font-semibold ${n.status==="resolved"?"bg-safe/20 text-safe":n.status==="acknowledged"?"bg-warning/20 text-warning":"bg-danger/20 text-danger"}`,children:n.status.toUpperCase()})]}),W.jsxs("div",{className:"grid grid-cols-2 gap-4 mt-6",children:[W.jsxs("div",{className:"bg-secondary/40 border border-border/40 rounded p-4",children:[W.jsx("div",{className:"text-muted-foreground text-sm mb-1",children:"Audio Stress"}),W.jsx("div",{className:"text-2xl font-bold text-foreground",children:n.factors.audio.toFixed(1)})]}),W.jsxs("div",{className:"bg-secondary/40 border border-border/40 rounded p-4",children:[W.jsx("div",{className:"text-muted-foreground text-sm mb-1",children:"Motion Intensity"}),W.jsx("div",{className:"text-2xl font-bold text-foreground",children:n.factors.motion.toFixed(1)})]}),W.jsxs("div",{className:"bg-secondary/40 border border-border/40 rounded p-4",children:[W.jsx("div",{className:"text-muted-foreground text-sm mb-1",children:"Time Risk"}),W.jsx("div",{className:"text-2xl font-bold text-foreground",children:n.factors.time.toFixed(1)})]}),W.jsxs("div",{className:"bg-secondary/40 border border-border/40 rounded p-4",children:[W.jsx("div",{className:"text-muted-foreground text-sm mb-1",children:"Location Risk"}),W.jsx("div",{className:"text-2xl font-bold text-foreground",children:n.factors.location.toFixed(1)})]})]}),n.status!=="resolved"&&W.jsxs("div",{className:"mt-6 flex gap-4",children:[n.status==="new"&&W.jsx("button",{onClick:()=>tt("acknowledged"),disabled:y||(r==null?void 0:r.role)!=="security",className:"px-6 py-2 bg-warning hover:bg-yellow-600 text-white rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Acknowledge"}),W.jsx("button",{onClick:()=>tt("resolved"),disabled:y||(r==null?void 0:r.role)!=="security",className:"px-6 py-2 bg-safe hover:bg-green-600 text-white rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Mark Resolved"})]})]}),M.length>0||k?W.jsxs("div",{className:"glass-panel p-6",children:[W.jsxs("div",{className:"flex items-center justify-between gap-4",children:[W.jsx("h3",{className:"text-xl font-semibold text-foreground",children:"Media Attachments"}),W.jsx("div",{className:"text-sm text-muted-foreground",children:k?"Loading":`${M.length} file(s)`})]}),w.length===0?W.jsxs("div",{className:"mt-4 text-sm text-muted-foreground",children:["Attachments were included, but a preview could not be generated. If this persists, add a Storage SELECT policy for bucket ",W.jsx("span",{className:"font-semibold",children:"sos-attachment"})," (authenticated users) so Security can create signed URLs."]}):W.jsx("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-2 gap-4",children:w.map((Le,qt)=>{const Tt=M[qt]||"",St=/\.(mp4|webm|mov|m4v|ogg)(\?|$)/i.test(Tt);return W.jsxs("div",{className:"rounded-xl border border-border/40 bg-secondary/30 overflow-hidden",children:[W.jsx("div",{className:"px-4 py-3 border-b border-border/40",children:W.jsx("div",{className:"text-sm font-semibold text-foreground truncate",children:Tt||`Attachment ${qt+1}`})}),W.jsx("div",{className:"p-3",children:St?W.jsx("video",{src:Le,controls:!0,className:"w-full max-h-[360px] rounded-lg bg-black"}):W.jsx("img",{src:Le,alt:"Attachment",className:"w-full max-h-[360px] object-contain rounded-lg bg-black/20"})})]},Le)})})]}):null,f.length>0&&W.jsxs("div",{className:"glass-panel p-6",children:[W.jsx("h3",{className:"text-xl font-semibold text-foreground mb-4",children:"Live Risk Timeline"}),W.jsx(Cb,{width:"100%",height:300,children:W.jsxs(SH,{data:ze,children:[W.jsx(dv,{strokeDasharray:"3 3",stroke:"#475569"}),W.jsx(cc,{dataKey:"time",stroke:"#94a3b8"}),W.jsx(yl,{stroke:"#94a3b8"}),W.jsx(ws,{contentStyle:{backgroundColor:"rgba(15, 23, 42, 0.9)",border:"1px solid rgba(148, 163, 184, 0.2)"}}),W.jsx(El,{type:"monotone",dataKey:"risk",stroke:"#ef4444",strokeWidth:2}),W.jsx(El,{type:"monotone",dataKey:"audio",stroke:"#f59e0b",strokeWidth:1}),W.jsx(El,{type:"monotone",dataKey:"motion",stroke:"#10b981",strokeWidth:1})]})})]})]}),W.jsxs("div",{className:"space-y-6",children:[W.jsxs("div",{className:"map-container p-6",children:[W.jsx("h3",{className:"text-xl font-semibold text-foreground mb-4",children:"Location"}),W.jsx("div",{className:"text-muted-foreground mb-4",children:ht?W.jsxs(W.Fragment,{children:[W.jsxs("div",{children:["Latitude: ",De]}),W.jsxs("div",{children:["Longitude: ",ut]})]}):W.jsx("div",{children:"No coordinates available"})}),W.jsx(uI,{sosMarkers:ht?[{id:n.id,lat:De,lng:ut,riskScore:n.risk_score}]:[],height:"300px",enableGeolocation:!1})]}),W.jsxs("div",{className:"glass-panel p-6",children:[W.jsx("h3",{className:"text-xl font-semibold text-foreground mb-4",children:"Event Timeline"}),W.jsx(F8,{sosId:n.id,sosEvent:n})]}),W.jsxs("div",{className:"glass-panel p-6",children:[W.jsxs("div",{className:"flex items-center justify-between gap-4",children:[W.jsx("h3",{className:"text-xl font-semibold text-foreground",children:"Chat"}),W.jsx("div",{className:"text-xs text-muted-foreground",children:F||n.status==="resolved"?"Read-only":"Live"})]}),W.jsx("div",{className:"mt-1 text-sm text-muted-foreground",children:Y?`Responder: ${Y}`:"Responder: (unassigned)"}),R?W.jsx("div",{className:"text-center py-6 text-muted-foreground",children:"Loading chat"}):B?W.jsx("div",{className:"mt-3 text-sm text-muted-foreground",children:"Only the assigned security responder can access this chat."}):L?W.jsx("div",{className:"mt-3 text-sm text-danger",children:L}):null,W.jsx("div",{className:"mt-4 rounded-lg border border-border/40 bg-secondary/30 h-[260px] overflow-y-auto p-4 space-y-3",children:pe.length===0?W.jsx("div",{className:"text-muted-foreground text-sm",children:"No messages yet."}):pe.map(Le=>W.jsxs("div",{className:"rounded-lg bg-secondary/40 border border-border/40 p-3",children:[W.jsxs("div",{className:"text-xs text-muted-foreground",children:[Le.sender_email||Le.sender_id,"  ",new Date(Le.created_at).toLocaleString()]}),W.jsx("div",{className:"text-foreground mt-1 whitespace-pre-wrap",children:Le.message})]},Le.id))}),W.jsxs("div",{className:"mt-4 flex gap-3",children:[W.jsx("input",{value:Ee,onChange:Le=>Oe(Le.target.value),placeholder:F||n.status==="resolved"?"Chat is read-only (resolved)":"Type a message",disabled:B||R||F||n.status==="resolved",className:"flex-1 px-4 py-3 rounded-lg border border-border bg-card/50 text-foreground backdrop-blur-sm focus:outline-none focus:border-primary/50 disabled:opacity-60",onKeyDown:Le=>{Le.key==="Enter"&&(Le.preventDefault(),Ze())}}),W.jsx("button",{type:"button",onClick:Ze,disabled:B||R||F||n.status==="resolved"||!Ee.trim(),className:"px-5 py-3 bg-primary/80 hover:bg-primary text-primary-foreground rounded-lg border border-primary/30 disabled:opacity-50 disabled:cursor-not-allowed",children:"Send"})]})]}),f.length>0&&W.jsxs("div",{className:"glass-panel p-6",children:[W.jsx("h3",{className:"text-xl font-semibold text-foreground mb-4",children:"Live Feed"}),W.jsxs("div",{className:"space-y-3",children:[W.jsxs("div",{children:[W.jsx("div",{className:"text-muted-foreground text-sm mb-1",children:"Current Risk"}),W.jsx("div",{className:"text-2xl font-bold text-foreground",children:((Tr=($t=f[f.length-1])==null?void 0:$t.totalRisk)==null?void 0:Tr.toFixed(1))||"N/A"})]}),W.jsxs("div",{children:[W.jsx("div",{className:"text-muted-foreground text-sm mb-1",children:"Audio RMS"}),W.jsx("div",{className:"text-lg text-foreground",children:((Vr=(cn=(Br=f[f.length-1])==null?void 0:Br.audio)==null?void 0:cn.rms)==null?void 0:Vr.toFixed(2))||"N/A"})]}),W.jsxs("div",{children:[W.jsx("div",{className:"text-muted-foreground text-sm mb-1",children:"Motion"}),W.jsx("div",{className:"text-lg text-foreground",children:((rr=(Jt=(Dt=f[f.length-1])==null?void 0:Dt.motion)==null?void 0:Jt.acceleration)==null?void 0:rr.toFixed(2))||"N/A"})]})]})]})]})]})]})]})}function hDe({value:e,onChange:t,options:r,placeholder:n="Select",className:o,buttonClassName:l,menuClassName:h}){const f=re.useId(),s=re.useRef(null),y=re.useRef(null),b=re.useRef(null),[w,A]=re.useState(!1),[k,M]=re.useState(null),R=re.useMemo(()=>{var L;return((L=r.find(z=>z.value===e))==null?void 0:L.label)??""},[r,e]);re.useEffect(()=>{const L=z=>{const B=z.target;s.current&&s.current.contains(B)||b.current&&b.current.contains(B)||A(!1)};return window.addEventListener("pointerdown",L),()=>window.removeEventListener("pointerdown",L)},[]),re.useEffect(()=>{if(!w)return;const L=()=>{const z=y.current;if(!z)return;const B=z.getBoundingClientRect();M({left:B.left,top:B.bottom+8,width:B.width})};return L(),window.addEventListener("resize",L),window.addEventListener("scroll",L,!0),()=>{window.removeEventListener("resize",L),window.removeEventListener("scroll",L,!0)}},[w]);const j=R||n;return W.jsxs("div",{ref:s,className:Mo("relative",o),children:[W.jsxs("button",{type:"button","aria-haspopup":"listbox","aria-expanded":w,"aria-controls":f,onClick:()=>A(L=>!L),ref:y,className:Mo("w-52 px-4 py-2 bg-secondary/60 border border-border/50 rounded-lg text-foreground","inline-flex items-center justify-between gap-3","transition-colors hover:bg-secondary/80","focus:outline-none focus:ring-2 focus:ring-primary/50 focus:ring-offset-2 focus:ring-offset-background",l),children:[W.jsx("span",{className:Mo("truncate",R?"text-foreground":"text-muted-foreground"),children:j}),W.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none","aria-hidden":"true",className:Mo("transition-transform",w?"rotate-180":"rotate-0"),children:W.jsx("path",{d:"M6 9l6 6 6-6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})]}),w&&k?cM.createPortal(W.jsx("div",{ref:b,id:f,role:"listbox",className:Mo("z-[99999]",h),style:{position:"fixed",left:k.left,top:k.top,width:k.width},children:W.jsx("div",{className:Mo("glass-panel overflow-hidden","border border-border/60"),children:W.jsx("div",{className:"p-1",children:r.map(L=>{const z=L.value===e;return W.jsx("button",{type:"button",role:"option","aria-selected":z,onClick:()=>{t(L.value),A(!1)},className:Mo("w-full text-left px-3 py-2 rounded-md","transition-colors",z?"bg-secondary/70 text-foreground border border-border/50":"text-muted-foreground hover:bg-secondary/50 hover:text-foreground"),children:L.label},L.value)})})})}),document.body):null]})}function dDe(){const{user:e,logout:t}=Uu(),[r,n]=re.useState([]),[o,l]=re.useState(!0),[h,f]=re.useState({status:"",limit:100}),s=Fu();re.useEffect(()=>{if((e==null?void 0:e.role)!=="security"){s("/dashboard");return}y()},[h,e,s]);const y=async()=>{try{l(!0);const A=await Yo.getSOSEvents({status:h.status||void 0,limit:h.limit});n(A)}catch(A){console.error("Failed to load history:",A)}finally{l(!1)}},b=async()=>{var A,k;if(window.confirm("Are you sure you want to clear all SOS history? This action cannot be undone."))try{const M=await Yo.clearHistory();alert(`History cleared successfully. Deleted ${M.deleted} events.`),n([])}catch(M){alert(`Failed to clear history: ${((k=(A=M.response)==null?void 0:A.data)==null?void 0:k.error)||M.message}`)}},w=A=>A>=50?"text-danger":A>=25?"text-warning":"text-safe";return W.jsxs("div",{className:"min-h-screen aurora-gradient p-6 relative",children:[W.jsx("div",{className:"aurora-bg"}),W.jsxs("div",{className:"max-w-7xl mx-auto relative z-10",children:[W.jsxs("div",{className:"glass-panel border-b border-border/50 px-6 py-4 flex justify-between items-center mb-8",children:[W.jsxs("div",{children:[W.jsx("h1",{className:"text-2xl font-bold aurora-text",children:"Alert History"}),W.jsx("p",{className:"text-sm text-muted-foreground",children:"All SOS events"})]}),W.jsxs("div",{className:"flex gap-4",children:[W.jsx(Qs,{to:"/security",className:"px-4 py-2 bg-secondary/60 hover:bg-secondary/80 text-foreground rounded-lg transition-colors border border-border/50",children:"Back to Dashboard"}),W.jsx("button",{onClick:t,className:"px-4 py-2 bg-secondary/60 hover:bg-secondary/80 text-foreground rounded-lg transition-colors border border-border/50",children:"Logout"})]})]}),W.jsx("div",{className:"glass-panel p-4 mb-6",children:W.jsxs("div",{className:"flex gap-4 items-center justify-between",children:[W.jsx("div",{className:"flex gap-4",children:W.jsx(hDe,{value:h.status,onChange:A=>f({...h,status:A}),options:[{value:"",label:"All Status"},{value:"new",label:"New"},{value:"acknowledged",label:"Acknowledged"},{value:"resolved",label:"Resolved"}]})}),W.jsx("button",{onClick:b,className:"px-4 py-2 bg-danger hover:bg-red-600 text-white rounded-lg transition-colors font-semibold",children:"Clear History"})]})}),W.jsx("div",{className:"glass-panel p-6",children:o?W.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Loading..."}):r.length===0?W.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No events found"}):W.jsx("div",{className:"overflow-x-auto",children:W.jsxs("table",{className:"w-full text-left",children:[W.jsx("thead",{children:W.jsxs("tr",{className:"border-b border-border/60",children:[W.jsx("th",{className:"pb-3 text-muted-foreground",children:"Date"}),W.jsx("th",{className:"pb-3 text-muted-foreground",children:"Risk Score"}),W.jsx("th",{className:"pb-3 text-muted-foreground",children:"Trigger"}),W.jsx("th",{className:"pb-3 text-muted-foreground",children:"Status"}),W.jsx("th",{className:"pb-3 text-muted-foreground",children:"Actions"})]})}),W.jsx("tbody",{children:r.map(A=>W.jsxs("tr",{className:"border-b border-border/40 hover:bg-secondary/30",children:[W.jsx("td",{className:"py-3 text-muted-foreground",children:new Date(A.created_at).toLocaleString()}),W.jsx("td",{className:`py-3 font-bold ${w(A.risk_score)}`,children:A.risk_score.toFixed(1)}),W.jsx("td",{className:"py-3 text-muted-foreground",children:A.trigger_type.charAt(0).toUpperCase()+A.trigger_type.slice(1)}),W.jsx("td",{className:"py-3",children:W.jsx("span",{className:`px-2 py-1 rounded text-xs ${A.status==="resolved"?"bg-safe/20 text-safe":A.status==="acknowledged"?"bg-warning/20 text-warning":"bg-danger/20 text-danger"}`,children:A.status})}),W.jsx("td",{className:"py-3",children:W.jsx(Qs,{to:`/security/alert/${A.id}`,className:"text-aurora-cyan hover:opacity-80 transition-opacity",children:"View"})})]},A.id))})]})})})]})]})}const fDe={async getWeeklyAlerts(){return(await Gi.get("/analytics/alerts/week")).data}};function YA({title:e,subtitle:t,children:r}){return W.jsxs(Do.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.35,ease:"easeOut"},className:"rounded-2xl bg-background/55 backdrop-blur border border-border/40 shadow-[0_10px_30px_rgba(0,0,0,0.25)]",children:[W.jsx("div",{className:"px-5 pt-5 pb-4",children:W.jsx("div",{className:"flex items-start justify-between gap-4",children:W.jsxs("div",{className:"min-w-0",children:[W.jsx("h2",{className:"text-base sm:text-lg font-semibold text-foreground leading-tight",children:e}),t?W.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground mt-1",children:t}):null]})})}),W.jsx("div",{className:"px-3 pb-4",children:r})]})}function JA({active:e,payload:t,label:r}){return!e||!t||t.length===0?null:W.jsxs("div",{className:"rounded-xl border border-border/60 bg-background/95 backdrop-blur px-3 py-2 shadow-lg",children:[W.jsx("div",{className:"text-sm font-semibold text-foreground",children:r}),W.jsx("div",{className:"mt-1 space-y-1",children:t.filter(n=>n&&n.value!==void 0).map(n=>W.jsxs("div",{className:"flex items-center justify-between gap-6 text-sm",children:[W.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[W.jsx("span",{className:"inline-block h-2.5 w-2.5 rounded-sm",style:{background:n.color}}),W.jsx("span",{className:"text-muted-foreground truncate",children:n.name||n.dataKey})]}),W.jsx("span",{className:"text-foreground tabular-nums",children:Number(n.value).toLocaleString()})]},n.dataKey))})]})}function pDe(){const{user:e,logout:t}=Uu(),[r,n]=re.useState(null),[o,l]=re.useState(!0);re.useEffect(()=>{h()},[]);const h=async()=>{try{const y=await fDe.getWeeklyAlerts();n(y)}catch(y){console.error("Failed to load analytics:",y)}finally{l(!1)}};if(o)return W.jsxs("div",{className:"min-h-screen aurora-gradient p-6 relative",children:[W.jsx("div",{className:"aurora-bg"}),W.jsx("div",{className:"max-w-7xl mx-auto relative z-10",children:W.jsx("div",{className:"glass-panel p-6 text-center text-muted-foreground",children:"Loading analytics..."})})]});if(!r)return W.jsxs("div",{className:"min-h-screen aurora-gradient p-6 relative",children:[W.jsx("div",{className:"aurora-bg"}),W.jsx("div",{className:"max-w-7xl mx-auto relative z-10",children:W.jsx("div",{className:"glass-panel p-6 text-center text-muted-foreground",children:"Failed to load analytics"})})]});const f=r.labels.map((y,b)=>({day:y,sos:r.sos[b],ai:r.ai[b]})),s={sos:"hsl(var(--destructive))",ai:"hsl(var(--aurora-cyan))",grid:"hsl(var(--border))",tick:"hsl(var(--muted-foreground))"};return W.jsxs("div",{className:"min-h-screen aurora-gradient p-6 relative",children:[W.jsx("div",{className:"aurora-bg"}),W.jsxs("div",{className:"max-w-7xl mx-auto relative z-10",children:[W.jsxs("div",{className:"glass-panel border-b border-border/50 px-6 py-4 flex justify-between items-center mb-8",children:[W.jsxs("div",{children:[W.jsx("h1",{className:"text-2xl font-bold aurora-text",children:"Analytics Dashboard"}),W.jsxs("p",{className:"text-sm text-muted-foreground",children:["Weekly alert statistics",e!=null&&e.email?`  ${e.email}`:""]})]}),W.jsxs("div",{className:"flex gap-4",children:[W.jsx(Qs,{to:"/security",className:"px-4 py-2 bg-secondary/60 hover:bg-secondary/80 text-foreground rounded-lg transition-colors border border-border/50",children:"Back to Dashboard"}),W.jsx("button",{onClick:t,className:"px-4 py-2 bg-secondary/60 hover:bg-secondary/80 text-foreground rounded-lg transition-colors border border-border/50",children:"Logout"})]})]}),W.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 sm:gap-6 mb-8",children:[W.jsxs("div",{className:"rounded-2xl bg-background/55 backdrop-blur border border-border/40 px-5 py-4 shadow-[0_10px_30px_rgba(0,0,0,0.22)]",children:[W.jsx("h3",{className:"text-muted-foreground text-xs sm:text-sm",children:"Total SOS This Week"}),W.jsx("p",{className:"mt-2 text-3xl sm:text-4xl font-semibold text-foreground tabular-nums",children:r.kpis.totalSOS})]}),W.jsxs("div",{className:"rounded-2xl bg-background/55 backdrop-blur border border-border/40 px-5 py-4 shadow-[0_10px_30px_rgba(0,0,0,0.22)]",children:[W.jsx("h3",{className:"text-muted-foreground text-xs sm:text-sm",children:"Peak Day"}),W.jsx("p",{className:"mt-2 text-3xl sm:text-4xl font-semibold text-foreground truncate",children:r.kpis.peakDay})]}),W.jsxs("div",{className:"rounded-2xl bg-background/55 backdrop-blur border border-border/40 px-5 py-4 shadow-[0_10px_30px_rgba(0,0,0,0.22)]",children:[W.jsx("h3",{className:"text-muted-foreground text-xs sm:text-sm",children:"Highest AI Risk Count"}),W.jsx("p",{className:"mt-2 text-3xl sm:text-4xl font-semibold text-foreground tabular-nums",children:r.kpis.highestAIRisk})]})]}),W.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 sm:gap-6 mb-6",children:[W.jsx(YA,{title:"SOS Alerts",subtitle:"Count per day",children:W.jsx(Cb,{width:"100%",height:260,children:W.jsxs(lDe,{data:f,margin:{top:6,right:10,left:4,bottom:0},children:[W.jsx(dv,{vertical:!1,stroke:s.grid,opacity:.25}),W.jsx(cc,{dataKey:"day",axisLine:!1,tickLine:!1,tick:{fill:s.tick,fontSize:12}}),W.jsx(yl,{axisLine:!1,tickLine:!1,tick:{fill:s.tick,fontSize:12},width:34}),W.jsx(ws,{content:W.jsx(JA,{}),cursor:{fill:"rgba(135, 235, 173, 0.08)"},wrapperStyle:{outline:"none"}}),W.jsx(vc,{dataKey:"sos",name:"SOS",fill:s.sos,radius:4,barSize:24})]})})}),W.jsx(YA,{title:"AI Risk Spikes",subtitle:"Detected spikes per day",children:W.jsx(Cb,{width:"100%",height:260,children:W.jsxs(SH,{data:f,margin:{top:6,right:10,left:4,bottom:0},children:[W.jsx(dv,{vertical:!1,stroke:s.grid,opacity:.25}),W.jsx(cc,{dataKey:"day",axisLine:!1,tickLine:!1,tick:{fill:s.tick,fontSize:12}}),W.jsx(yl,{axisLine:!1,tickLine:!1,tick:{fill:s.tick,fontSize:12},width:34}),W.jsx(ws,{content:W.jsx(JA,{}),cursor:{stroke:"rgba(37, 246, 228, 0.25)",strokeWidth:1},wrapperStyle:{outline:"none"}}),W.jsx(El,{type:"monotone",dataKey:"ai",name:"AI",stroke:s.ai,strokeWidth:2.25,dot:!1,activeDot:{r:4,fill:s.ai,stroke:"hsl(var(--background))",strokeWidth:2}})]})})})]}),W.jsx(YA,{title:"SOS vs AI",subtitle:"Comparison view",children:W.jsx(Cb,{width:"100%",height:340,children:W.jsxs(cDe,{data:f,margin:{top:8,right:22,left:8,bottom:0},children:[W.jsx(dv,{vertical:!1,stroke:s.grid,opacity:.25}),W.jsx(cc,{dataKey:"day",axisLine:!1,tickLine:!1,tick:{fill:s.tick,fontSize:12}}),W.jsx(yl,{yAxisId:"left",axisLine:!1,tickLine:!1,tick:{fill:s.tick,fontSize:12},width:34}),W.jsx(yl,{yAxisId:"right",orientation:"right",axisLine:!1,tickLine:!1,tick:{fill:s.tick,fontSize:12},width:34}),W.jsx(ws,{content:W.jsx(JA,{}),wrapperStyle:{outline:"none"}}),W.jsx(hd,{verticalAlign:"top",align:"right",iconType:"square",wrapperStyle:{paddingBottom:8,color:"hsl(var(--muted-foreground))",fontSize:12}}),W.jsx(vc,{yAxisId:"left",dataKey:"sos",name:"SOS",fill:s.sos,radius:4,barSize:20}),W.jsx(El,{yAxisId:"right",type:"monotone",dataKey:"ai",name:"AI",stroke:s.ai,strokeWidth:2.25,dot:!1,activeDot:{r:4,fill:s.ai,stroke:"hsl(var(--background))",strokeWidth:2}})]})})})]})]})}function mDe(){const{checkAuth:e,isAuthenticated:t}=Uu();return re.useEffect(()=>{e()},[e]),W.jsx(EY,{children:W.jsxs(vY,{children:[W.jsx(Pa,{path:"/login",element:t?W.jsx(qh,{to:"/"}):W.jsx(Qne,{})}),W.jsx(Pa,{path:"/register",element:t?W.jsx(qh,{to:"/"}):W.jsx(Dse,{})}),W.jsx(Pa,{path:"/verify",element:t?W.jsx(qh,{to:"/"}):W.jsx(Lse,{})}),W.jsx(Pa,{path:"/verify-complete",element:t?W.jsx(qh,{to:"/"}):W.jsx(jse,{})}),W.jsx(Pa,{path:"/",element:W.jsx(zf,{children:W.jsx(qh,{to:"/dashboard",replace:!0})})}),W.jsx(Pa,{path:"/dashboard",element:W.jsx(zf,{children:W.jsx(Gae,{})})}),W.jsx(Pa,{path:"/security",element:W.jsx(zf,{allowedRoles:["security"],children:W.jsx(Wae,{})})}),W.jsx(Pa,{path:"/security/alert/:id",element:W.jsx(zf,{allowedRoles:["security"],children:W.jsx(uDe,{})})}),W.jsx(Pa,{path:"/security/history",element:W.jsx(zf,{allowedRoles:["security"],children:W.jsx(dDe,{})})}),W.jsx(Pa,{path:"/security/analytics",element:W.jsx(zf,{allowedRoles:["security"],children:W.jsx(pDe,{})})})]})})}QA.createRoot(document.getElementById("root")).render(W.jsx(Ce.StrictMode,{children:W.jsx(mDe,{})}));
