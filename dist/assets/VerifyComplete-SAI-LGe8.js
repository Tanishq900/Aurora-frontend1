import{r as a,d as p,j as e,L as f}from"./index-BWRs-o60.js";import{s as n}from"./supabaseClient-DLv9Iivt.js";function j(){const[l,t]=a.useState("verifying"),[u,o]=a.useState(""),i=p();return a.useEffect(()=>{(async()=>{var c;try{const s=new URLSearchParams(i.hash.substring(1)),d=s.get("access_token"),b=s.get("type"),m=new URLSearchParams(i.search),h=m.get("token"),g=m.get("type");if(d&&b==="email"){const{data:{session:r},error:x}=await n.auth.setSession({access_token:d,refresh_token:s.get("refresh_token")||""});if(x)throw x;if(r!=null&&r.user)t("verified");else throw new Error("Failed to establish session")}else if(h&&g==="email"){const{error:r}=await n.auth.verifyOtp({token_hash:h,type:"email"});if(r)throw r;t("verified")}else{const{data:{session:r}}=await n.auth.getSession();(c=r==null?void 0:r.user)!=null&&c.email_confirmed_at||r!=null&&r.user?t("verified"):(o("Verification link is invalid or expired. Please request a new verification email."),t("error"))}}catch(s){console.error("Verification error:",s),o(s.message||"Verification failed. Please try again or request a new verification email."),t("error")}})()},[i]),l==="verifying"?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-slate-900 to-slate-800 px-4",children:e.jsx("div",{className:"max-w-md w-full bg-slate-800 rounded-lg shadow-xl p-8",children:e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-500 mx-auto mb-4"}),e.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"Verifying Email"}),e.jsx("p",{className:"text-slate-400",children:"Please wait while we verify your email..."})]})})}):l==="error"?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-slate-900 to-slate-800 px-4",children:e.jsxs("div",{className:"max-w-md w-full bg-slate-800 rounded-lg shadow-xl p-8",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"Verification Failed"}),e.jsx("p",{className:"text-red-400 mb-4",children:u})]}),e.jsx("div",{className:"mt-6 text-center space-y-4",children:e.jsx(f,{to:"/register",className:"inline-block bg-primary-600 hover:bg-primary-700 text-white font-semibold py-2 px-6 rounded-lg transition-colors",children:"Back to Register"})})]})}):e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-slate-900 to-slate-800 px-4",children:e.jsxs("div",{className:"max-w-md w-full bg-slate-800 rounded-lg shadow-xl p-8",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"Email Verified"}),e.jsx("p",{className:"text-slate-400",children:"Hurray! Your email has been verified. You may now log in."})]}),e.jsx("div",{className:"mt-6 text-center",children:e.jsx(f,{to:"/login",className:"inline-block bg-primary-600 hover:bg-primary-700 text-white font-semibold py-2 px-6 rounded-lg transition-colors",children:"Go to Login"})})]})})}export{j as default};
